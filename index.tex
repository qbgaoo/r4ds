% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
  letterpaper,
]{book}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{5}
% Make \paragraph and \subparagraph free-standing
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[skins,breakable]{tcolorbox}}
\@ifpackageloaded{fontawesome5}{}{\usepackage{fontawesome5}}
\definecolor{quarto-callout-color}{HTML}{909090}
\definecolor{quarto-callout-note-color}{HTML}{0758E5}
\definecolor{quarto-callout-important-color}{HTML}{CC1914}
\definecolor{quarto-callout-warning-color}{HTML}{EB9113}
\definecolor{quarto-callout-tip-color}{HTML}{00A047}
\definecolor{quarto-callout-caution-color}{HTML}{FC5300}
\definecolor{quarto-callout-color-frame}{HTML}{acacac}
\definecolor{quarto-callout-note-color-frame}{HTML}{4582ec}
\definecolor{quarto-callout-important-color-frame}{HTML}{d9534f}
\definecolor{quarto-callout-warning-color-frame}{HTML}{f0ad4e}
\definecolor{quarto-callout-tip-color-frame}{HTML}{02b875}
\definecolor{quarto-callout-caution-color-frame}{HTML}{fd7e14}
\makeatother
\makeatletter
\@ifpackageloaded{bookmark}{}{\usepackage{bookmark}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{ç›® å½•}
\else
  \newcommand\contentsname{ç›® å½•}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{å›¾ç´¢å¼•}
\else
  \newcommand\listfigurename{å›¾ç´¢å¼•}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{è¡¨ç´¢å¼•}
\else
  \newcommand\listtablename{è¡¨ç´¢å¼•}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{å›¾}
\else
  \newcommand\figurename{å›¾}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{è¡¨}
\else
  \newcommand\tablename{è¡¨}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{åˆ—è¡¨}
\newcommand*\listoflistings{\listof{codelisting}{åˆ—è¡¨ç´¢å¼•}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Ræ•°æ®ç§‘å­¦ (ç¬¬äºŒç‰ˆ)},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Ræ•°æ®ç§‘å­¦ (ç¬¬äºŒç‰ˆ)}
\author{}
\date{}

\begin{document}
\frontmatter
\maketitle

\renewcommand*\contentsname{ç›® å½•}
{
\setcounter{tocdepth}{2}
\tableofcontents
}
\mainmatter
\bookmarksetup{startatroot}

\chapter*{æ¬¢è¿è¯­}\label{ux6b22ux8fceux8bed}
\addcontentsline{toc}{chapter}{æ¬¢è¿è¯­}

\markboth{æ¬¢è¿è¯­}{æ¬¢è¿è¯­}

è¿™æ˜¯ \textbf{``R æ•°æ®ç§‘å­¦''}ç¬¬äºŒç‰ˆã€‚
è¿™æœ¬ä¹¦å°†å‘Šè¯‰ä½ å¦‚ä½•ç”¨Rä»äº‹æ•°æ®ç§‘å­¦ï¼šä½ å°†å­¦åˆ°å¦‚ä½•æŠŠæ•°æ®å¯¼å…¥Rï¼Œå¹¶å°†å…¶å˜æ¢ä¸ºæœ€æœ‰ç”¨çš„ç»“æ„ï¼Œè¿˜æœ‰æ•°æ®è½¬æ¢å’Œå¯è§†åŒ–ã€‚

åœ¨è¿™æœ¬ä¹¦ä¸­ä½ å°†æ‰¾åˆ°æ•°æ®ç§‘å­¦çš„ä¸€ç³»åˆ—å®è·µæŠ€èƒ½ã€‚æ­£
å¦‚åŒ–å­¦å®¶å­¦ä¹ å¦‚ä½•æ¸…æ´—è¯•ç®¡å’Œé…ç½®å®éªŒå®¤ä¸€æ ·ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•æ¸…æ´—æ•°æ®å’Œç»˜åˆ¶å›¾è¡¨ä»¥åŠå…¶ä»–è®¸å¤šäº‹æƒ…ï¼Œè¿™äº›æŠ€èƒ½ä½¿æ•°æ®ç§‘å­¦å¾—ä»¥è¿›è¡Œã€‚åœ¨
è¿™é‡Œä½ å°†ä¼šæ‰¾åˆ°åˆ©ç”¨Rè¿›è¡Œè¿™äº›æ“ä½œçš„æœ€ä½³æ–¹æ³•ã€‚ä½ 
å°†å­¦ä¼šå¦‚ä½•åˆ©ç”¨å›¾å½¢çš„è¯­æ³•ã€ç¼–ç¨‹æ–‡æ¡£å’Œå¯å¤ç°ç ”ç©¶æ¥èŠ‚çœæ—¶é—´ï¼Œè¿˜å°†å­¦ä¹ å¦‚ä½•ç®¡ç†è®¤çŸ¥èµ„æºï¼Œä»¥ä¾¿åœ¨æ¸…æ´—ã€å¯è§†åŒ–å’Œæ¢ç´¢æ•°æ®æ—¶æ›´å®¹æ˜“å‘ç°æ–°çŸ¥è¯†ã€‚

æ ¹æ®\href{https://creativecommons.org/licenses/by-nc-nd/3.0/us/}{CC
BY-NC-ND 3.0}æˆæƒï¼Œè¯¥ç½‘ç«™æ˜¯ä¸”å°†æ°¸è¿œæ˜¯å…è´¹çš„ã€‚å¦‚
æœä½ æƒ³è¦è¿™æœ¬ä¹¦çš„çº¸è´¨ç‰ˆï¼Œä½ å¯ä»¥é€šè¿‡\href{https://www.amazon.com/dp/1492097403?&tag=hadlwick-20}{Amazon}è®¢è´­ã€‚å¦‚
æœä½ å› ä¸ºèƒ½å…è´¹é˜…è¯»è¿™æœ¬ä¹¦è€Œå¿ƒå­˜æ„Ÿæ¿€ï¼Œå¹¶å¸Œæœ›æœ‰æ‰€å›é¦ˆï¼Œè¯·å‘\href{https://www.doc.govt.nz/kakapo-donate}{KÄkÄpÅ
Recovery}ææ¬¾ã€‚
\href{https://www.youtube.com/watch?v=9T1vfsHYiKY}{kÄkÄpÅ}ï¼ˆå‡ºç°åœ¨å°é¢çš„è¿™ç§é¸Ÿï¼‰æ˜¯æ–°è¥¿å…°ç‰¹æœ‰çš„ä¸€ç§æ¿’å±é¹¦é¹‰ï¼Œç›®å‰ä»…å‰©248åªã€‚

å¦‚æœä½ ä¼šè¯´å…¶ä»–è¯­è¨€ï¼Œä½ å¯èƒ½ä¼šå¯¹ç¬¬äºŒç‰ˆçš„å…è´¹ç¿»è¯‘ç‰ˆæ„Ÿå…´è¶£ï¼š

\begin{itemize}
\tightlist
\item
  \href{http://es.r4ds.hadley.nz}{ä¸­æ–‡}
\end{itemize}

ä½ å¯ä»¥åœ¨\url{https://mine-cetinkaya-rundel.github.io/r4ds-solutions}æ‰¾åˆ°ä¹¦ä¸­ä¹ é¢˜çš„å‚è€ƒç­”æ¡ˆã€‚

è¯·æ³¨æ„ï¼Œæœ¬ä¹¦é‡‡ç”¨äº†è´¡çŒ®è€…è¡Œä¸ºå‡†åˆ™ï¼ˆ\href{https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html}{Contributor
Code of Conduct}ï¼‰ã€‚å¦‚ æœæ‚¨æ„¿æ„ä¸ºè¿™æœ¬ä¹¦åšå‡ºè´¡çŒ®ï¼Œè¡¨ç¤ºæ‚¨åŒæ„éµå®ˆå…¶æ¡æ¬¾ã€‚

\section*{è‡´è°¢}\label{ux81f4ux8c22}
\addcontentsline{toc}{section}{è‡´è°¢}

\markright{è‡´è°¢}

æœ¬ä¹¦ç”± \url{https://www.netlify.com}
æ‰˜ç®¡ï¼Œæ„Ÿè°¢ä»–ä»¬å¯¹å¼€æºè½¯ä»¶å’Œç¤¾åŒºçš„æ”¯æŒã€‚

\bookmarksetup{startatroot}

\chapter*{åºè¨€}\label{ux5e8fux8a00}
\addcontentsline{toc}{chapter}{åºè¨€}

\markboth{åºè¨€}{åºè¨€}

æ¬¢è¿æ¥åˆ° ``R æ•°æ®ç§‘å­¦ï¼ˆç¬¬äºŒç‰ˆï¼‰''ï¼
è¯¥ç‰ˆåœ¨ç¬¬ä¸€ç‰ˆçš„åŸºç¡€ä¸Šåšäº†ä¸€äº›é‡è¦ä¿®è®¢ï¼Œåˆ é™¤äº†æˆ‘ä»¬è®¤ä¸ºä¸å†æœ‰ç”¨çš„å†…å®¹ï¼Œå¢åŠ äº†åŸæœ¬æ‰“ç®—å†™è¿›ç¬¬ä¸€ç‰ˆçš„å†…å®¹ï¼Œå¹¶å¯¹æ–‡æœ¬å’Œä»£ç è¿›è¡Œäº†æ•´ä½“æ›´æ–°ï¼Œä»¥åæ˜ æœ€ä½³å®è·µä¸­çš„å˜åŒ–ã€‚åŒ
æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¾ˆé«˜å…´è¿æ¥ä¸€ä½æ–°çš„åˆè‘—è€…Mine
Ã‡etinkaya-Rundelï¼Œä»–æ˜¯ä¸€ä½è‘—åçš„æ•°æ®ç§‘å­¦æ•™è‚²å·¥ä½œè€…ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬åœ¨Posit(å‰èº«ä¸ºRStudio)å…¬å¸çš„ä¸€ä½åŒäº‹ã€‚

ä»¥ä¸‹æ˜¯è¿™äº›é‡è¦å˜åŒ–çš„æ¦‚è¿°ï¼š

\begin{itemize}
\item
  æœ¬ä¹¦ç¬¬ä¸€éƒ¨åˆ†å·²æ›´åä¸º``å…¨å±€æ¸¸æˆ'' ï¼ˆWhole gameï¼‰ã€‚è¿™
  éƒ¨åˆ†çš„ç›®çš„æ˜¯åœ¨æ·±å…¥ç»†èŠ‚ä¹‹å‰å…ˆä¸ºè¯»è€…æä¾›æ•°æ®ç§‘å­¦``å…¨å±€æ¸¸æˆ''
  çš„å¤§è‡´æƒ…å†µã€‚
\item
  æœ¬ä¹¦ç¬¬äºŒéƒ¨åˆ†ç§°ä¸º``å¯è§†åŒ–''ï¼ˆVisualizeï¼‰ã€‚å’Œ
  ç¬¬ä¸€ç‰ˆç›¸æ¯”ï¼Œè¿™éƒ¨åˆ†å¯¹æ•°æ®å¯è§†åŒ–å·¥å…·å’Œæœ€ä½³å®è·µè¿›è¡Œäº†æ›´ä¸ºå…¨é¢çš„ä»‹ç»ã€‚è™½
  ç„¶è¦è·å–æ‰€æœ‰è¯¦ç»†ä¿¡æ¯ä»éœ€å‚è€ƒåä¸º
  \href{http://ggplot2-book.org/}{ggplot2}çš„ä¹¦,
  ä½†ç¬¬äºŒç‰ˆå·²æ¶µç›–äº†å¾ˆå¤šæœ€é‡è¦çš„å¯è§†åŒ–æŠ€æœ¯ã€‚
\item
  æœ¬ä¹¦ç¬¬ä¸‰éƒ¨åˆ†ç§°ä¸º``è½¬æ¢''ï¼ˆTransformï¼‰ã€‚è¿™
  éƒ¨åˆ†å¢åŠ äº†å…³äºæ•°å­—ã€é€»è¾‘å‘é‡å’Œç¼ºå¤±å€¼çš„æ–°ç« èŠ‚ï¼Œè¿™äº›ä¹‹å‰éƒ½æ˜¯æ•°æ®è½¬æ¢ç« èŠ‚çš„ä¸€éƒ¨åˆ†ï¼Œä½†ç°åœ¨éœ€è¦æ›´å¤šçš„ç¯‡å¹…æ¥è¦†ç›–æ‰€æœ‰ç»†èŠ‚ã€‚
\item
  æœ¬ä¹¦ç¬¬å››éƒ¨åˆ†ç§°ä¸º``å¯¼å…¥''ï¼ˆImportï¼‰ã€‚è¿™
  æ˜¯ä¸€ç»„æ–°ç« èŠ‚ï¼ŒåŒ…æ‹¬è¯»å–çº¯æ–‡æœ¬æ–‡ä»¶å’Œç”µå­è¡¨æ ¼ï¼Œä»æ•°æ®åº“ä¸­è·å–æ•°æ®ã€å¤„ç†å¤§æ•°æ®ã€å°†å±‚æ¬¡ç»“æ„æ•°æ®è½¬æ¢ä¸ºçŸ©å½¢æ•°æ®ï¼Œä»¥åŠä»ç½‘ç«™æŠ“å–æ•°æ®ã€‚
\item
  ``ç¼–ç¨‹''ï¼ˆProgramï¼‰éƒ¨åˆ†ä¿æŒä¸å˜ï¼Œä½†å·²è¢«ä»å¤´è‡³å°¾é‡å†™ï¼Œèšç„¦äºå‡½æ•°ç¼–å†™å’Œè¿­ä»£çš„æœ€é‡è¦éƒ¨åˆ†ã€‚å‡½
  æ•°ç¼–å†™ç°åœ¨åŒ…å«äº†å¦‚ä½•å°è£…tidyverseå‡½æ•°ï¼ˆå¤„ç†tidyè¯„ä¼°çš„æŒ‘æˆ˜ï¼‰çš„è¯¦ç»†ä¿¡æ¯ï¼Œå› ä¸ºè¿™åœ¨è¿‡å»å‡ å¹´ä¸­å˜å¾—æ›´å®¹æ˜“ã€æ›´é‡è¦ã€‚æˆ‘
  ä»¬è¿˜å¢åŠ äº†ä¸€ä¸ªbase
  åŒ…é‡è¦å‡½æ•°çš„æ–°ç« èŠ‚ï¼Œè¿™äº›å‡½æ•°ä½ å¯èƒ½åœ¨å®é™…é‡åˆ°çš„Rä»£ç ä¸­çœ‹åˆ°ã€‚
\item
  ``å»ºæ¨¡''ï¼ˆModelingï¼‰éƒ¨åˆ†å·²è¢«åˆ é™¤ã€‚æˆ‘
  ä»¬ä¹‹å‰æ²¡æœ‰è¶³å¤Ÿçš„ç¯‡å¹…æ¥å…¨é¢æ·±å…¥åœ°è®²è§£å»ºæ¨¡ï¼Œä½†ç°åœ¨å·²ç»æœ‰æ›´å¥½çš„èµ„æºå¯ä¾›é€‰æ‹©ã€‚æˆ‘
  ä»¬ä¸€èˆ¬æ¨èä½¿ç”¨\href{https://www.tidymodels.org/}{tidymodels}
  åŒ…ï¼Œå¹¶æ¨èé˜…è¯»ç”±Max Kuhnå’ŒJulia
  Silgeæ’°å†™çš„\href{https://www.tmwr.org/}{Tidy Modeling with R}ä¸€ä¹¦ã€‚
\item
  ``äº¤æµ''ï¼ˆCommunicateï¼‰éƒ¨åˆ†ä¾ç„¶ä¿ç•™ï¼Œä½†å·²å…¨é¢æ›´æ–°ã€‚æœ¬
  ä¹¦ç¬¬äºŒç‰ˆåˆ©ç”¨\href{https://quarto.org/}{Quarto}ç¼–å†™ï¼Œè€Œä¸æ˜¯R
  Markdownï¼ŒQuartoè¢«çœ‹ä½œæ˜¯æ›´å…·åº”ç”¨å‰æ™¯çš„å·¥å…·ã€‚
\end{itemize}

\bookmarksetup{startatroot}

\chapter*{å¼•è¨€}\label{sec-intro}
\addcontentsline{toc}{chapter}{å¼•è¨€}

\markboth{å¼•è¨€}{å¼•è¨€}

æ•°æ®ç§‘å­¦æ˜¯ä¸€é—¨æ¿€åŠ¨äººå¿ƒçš„å­¦ç§‘ï¼Œå®ƒå…è®¸ä½ å°†åŸå§‹æ•°æ®è½¬åŒ–ä¸ºç†è§£ã€æ´å¯ŸåŠ›å’ŒçŸ¥è¯†ã€‚ã€Š
Ræ•°æ®ç§‘å­¦ã€‹çš„ç›®æ ‡æ˜¯å¸®åŠ©ä½ å­¦ä¹ Rä¸­æœ€é‡è¦çš„å·¥å…·ï¼Œè¿™äº›å·¥å…·å°†ä½¿ä½ èƒ½å¤Ÿé«˜æ•ˆä¸”å¯å¤ç°åœ°è¿›è¡Œæ•°æ®ç§‘å­¦å·¥ä½œï¼Œå¹¶åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­äº«å—ä¹è¶£ğŸ˜Šã€‚è¯»
å®Œè¿™æœ¬ä¹¦åï¼Œä½ å°†æ‹¥æœ‰è¿ç”¨Ræœ€ä½³éƒ¨åˆ†æ¥åº”å¯¹å„ç§æ•°æ®ç§‘å­¦æŒ‘æˆ˜çš„å·¥å…·ã€‚

\section*{ä½ å°†å­¦åˆ°ä»€ä¹ˆ}\label{ux4f60ux5c06ux5b66ux5230ux4ec0ux4e48}
\addcontentsline{toc}{section}{ä½ å°†å­¦åˆ°ä»€ä¹ˆ}

\markright{ä½ å°†å­¦åˆ°ä»€ä¹ˆ}

æ•°æ®ç§‘å­¦èŒƒå›´å¹¿é˜”ï¼Œä¸å¯èƒ½é€šè¿‡è¯»ä¸€æœ¬ä¹¦å°±å®Œå…¨æŒæ¡ã€‚æœ¬
ä¹¦çš„ç›®çš„æ—¨åœ¨ä¸ºä½ å­¦ä¹ Rè¿™ä¸ªé‡è¦å·¥å…·æä¾›åšå®å’Œè¶³å¤Ÿçš„åŸºç¡€çŸ¥è¯†ï¼Œä»¥ä¾¿åœ¨å¿…è¦æ—¶å¯ä»¥æ‰¾åˆ°è¿›ä¸€æ­¥å­¦ä¹ çš„èµ„æºã€‚å…¸
å‹çš„æ•°æ®ç§‘å­¦é¡¹ç›®åŒ…å«çš„æ­¥éª¤å¤§è‡´å¦‚ å›¾~\ref{fig-ds-diagram} æ‰€ç¤ºã€‚

\begin{figure}

\centering{

\includegraphics[width=5.57in,height=\textheight]{diagrams/data-science/base.png}

}

\caption{\label{fig-ds-diagram}åœ¨æ•°æ®ç§‘å­¦è¿‡ç¨‹æ¨¡å‹ä¸­ï¼Œé¦–å…ˆè¿›è¡Œæ•°æ®å¯¼å…¥å’Œæ•´ç†ã€‚æ¥ä¸‹æ¥ï¼Œé€šè¿‡è¿­ä»£å¾ªç¯çš„è½¬æ¢ã€
å¯è§†åŒ–å’Œå»ºæ¨¡æ¥ç†è§£æ•°æ®ã€‚æœ€åï¼Œé€šè¿‡ä¸ä»–äººäº¤æµç»“æœæ¥å®Œæˆæ•´ä¸ªè¿‡ç¨‹ã€‚}

\end{figure}%

é¦–å…ˆï¼Œå¿…é¡»å°†æ•°æ®å¯¼å…¥ (\textbf{import} ) Rä¸­ã€‚
è¿™é€šå¸¸æ„å‘³ç€ä½ éœ€è¦ä»æ–‡ä»¶ã€æ•°æ®åº“æˆ–Webåº”ç”¨ç¨‹åºæ¥å£ (API)
ä¸­è·å–æ•°æ®ï¼Œå¹¶å°†å…¶åŠ è½½åˆ°Rçš„ä¸€ä¸ªæ•°æ®æ¡†ä¸­ã€‚å¦‚
æœæ— æ³•å°†æ•°æ®å¯¼å…¥Rï¼Œå°±æ— æ³•åœ¨å…¶ä¸Šå¼€å±•æ•°æ®ç§‘å­¦å·¥ä½œï¼

ä¸€æ—¦å¯¼å…¥äº†æ•°æ®ï¼Œè¿˜éœ€å¯¹å…¶è¿›è¡Œæ•´é½ (\textbf{tidy})ã€‚æ•´
é½æ•°æ®æ„å‘³ç€ä»¥ç»Ÿä¸€çš„å½¢å¼å­˜å‚¨æ•°æ®ï¼Œä½¿æ•°æ®é›†çš„è¯­ä¹‰ä¸å…¶å­˜å‚¨æ–¹å¼ç›¸åŒ¹é…ã€‚ç®€
è€Œè¨€ä¹‹ï¼Œå½“æ•°æ®æ•´é½æ—¶ï¼Œæ¯ä¸€åˆ—éƒ½æ˜¯ä¸€ä¸ªå˜é‡ï¼Œæ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªè§‚æµ‹å€¼ã€‚æ•´
é½çš„æ•°æ®å¾ˆé‡è¦ï¼Œå› ä¸ºç»“æ„ä¸€è‡´ä½¿ä½ å¯ä»¥å°†ç²¾åŠ›é›†ä¸­åœ¨å›ç­”æœ‰å…³æ•°æ®çš„é—®é¢˜ä¸Šï¼Œè€Œä¸æ˜¯åŠªåŠ›å°†æ•°æ®è½¬æ¢æˆé€‚åˆä¸åŒåŠŸèƒ½çš„æ­£ç¡®å½¢å¼ã€‚

å½“æ•°æ®æ•´é½å®Œæˆåï¼Œé€šå¸¸ä¸‹ä¸€æ­¥æ˜¯æ•°æ®è½¬æ¢ (\textbf{transform})ã€‚è½¬
æ¢åŒ…æ‹¬ç¼©å°æ„Ÿå…´è¶£çš„è§‚å¯Ÿå€¼çš„èŒƒå›´(å¦‚ä¸€ä¸ªåŸå¸‚çš„æ‰€æœ‰äººæˆ–å»å¹´çš„æ‰€æœ‰æ•°æ®)ã€æ ¹æ®ç°æœ‰å˜é‡åˆ›å»ºæ–°å˜é‡(å¦‚æ ¹æ®è·ç¦»å’Œæ—¶é—´è®¡ç®—é€Ÿåº¦)ï¼Œä»¥åŠè®¡ç®—ä¸€ç»„æ•°æ®çš„ç»Ÿè®¡é‡(å¦‚è®¡æ•°æˆ–å¹³å‡å€¼)ã€‚æ•´
é½å’Œè½¬æ¢ç»Ÿç§°ä¸ºæ•°æ®æ¸…æ´— (wrangling)
å› ä¸ºå°†æ•°æ®ä»¥è‡ªç„¶çš„å½¢å¼å¤„ç†é€šå¸¸æ„Ÿè§‰åƒæ˜¯ä¸€åœºæˆ˜æ–—!

å½“æœ‰äº†ç”±æ‰€éœ€å˜é‡ç»„æˆçš„æ•´é½æ•°æ®åï¼Œå°±å¯åˆ©ç”¨ä¸¤ä¸ªä¸»è¦çš„çŸ¥è¯†ç”Ÿæˆå¼•æ“:å¯è§†åŒ–å’Œå»ºæ¨¡ã€‚å®ƒ
ä»¬çš„ä¼˜ç¼ºç‚¹äº’è¡¥ï¼Œå› æ­¤ä»»ä½•æ•°æ®åˆ†æéƒ½å¯åå¤åˆ©ç”¨å®ƒä»¬ã€‚

å¯è§†åŒ– (\textbf{Visualization}) æ˜¯ä¸€é¡¹åŸºæœ¬çš„äººç±»æ´»åŠ¨ã€‚ä¸€
ä¸ªå¥½çš„å¯è§†åŒ–ä¼šæ˜¾ç¤ºä½ æ²¡æœ‰é¢„æ–™åˆ°çš„ä¸œè¥¿ï¼Œæˆ–è€…æå‡ºå…³äºæ•°æ®çš„æ–°é—®é¢˜ã€‚ä¸€
ä¸ªå¥½çš„å¯è§†åŒ–è¿˜å¯èƒ½æš—ç¤ºä½ é—®é”™äº†é—®é¢˜ï¼Œæˆ–è€…ä½ éœ€è¦æ”¶é›†ä¸åŒçš„æ•°æ®ã€‚å¯
è§†åŒ–å¯èƒ½ä¼šè®©ä½ æ„Ÿåˆ°æƒŠè®¶ï¼Œä½†å®ƒä»¬çš„æ‰©å±•æ€§å¹¶ä¸å¼ºï¼Œå› ä¸ºå®ƒä»¬éœ€è¦äººæ¥è§£é‡Šã€‚

å»ºæ¨¡ (\textbf{Models}) æ˜¯å¯¹å¯è§†åŒ–çš„è¡¥å……ã€‚ä¸€
æ—¦ä½ çš„é—®é¢˜è¶³å¤Ÿç²¾å‡†ï¼Œä½ å°±å¯ä»¥ç”¨ä¸€ä¸ªæ¨¡å‹æ¥å›ç­”ã€‚æ¨¡
å‹åŸºæœ¬ä¸Šæ˜¯æ•°å­¦æˆ–è®¡ç®—å·¥å…·ï¼Œå› æ­¤å®ƒä»¬é€šå¸¸å…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§ã€‚å³
ä½¿æ¨¡å‹æ‰©å±•æ€§ä¸ä½³ï¼Œä¹°æ›´å¤šçš„ç”µè„‘é€šå¸¸æ¯”ä¹°æ›´å¤šçš„å¤§è„‘è¦ä¾¿å®œï¼ä½†
æ¯ä¸ªæ¨¡å‹éƒ½éœ€è¦åšå‡è®¾ï¼Œè€Œä¸”å°±å…¶æœ¬è´¨è€Œè¨€ï¼Œæ¨¡å‹ä¸èƒ½è´¨ç–‘è‡ªå·±çš„å‡è®¾ã€‚è¿™
æ„å‘³ç€ä¸€ä¸ªæ¨¡å‹ä¸èƒ½ä»æ ¹æœ¬ä¸Šç»™ä½ å¸¦æ¥æƒŠå–œã€‚

æ•°æ®ç§‘å­¦çš„æœ€åä¸€æ­¥æ˜¯äº¤æµ
(\textbf{communication})ï¼Œè¿™æ˜¯æ¯ä¸ªæ•°æ®åˆ†æé¡¹ç›®ä¸­ç»å¯¹é‡è¦çš„æ­¥éª¤ã€‚é™¤
éä½ èƒ½å¤Ÿä¸ä»–äººäº¤æµä½ çš„ç»“æœï¼Œå¦åˆ™æ— è®ºæ¨¡å‹å’Œå¯è§†åŒ–å¦‚ä½•å¸®åŠ©ä½ å¾ˆå¥½åœ°ç†è§£æ•°æ®éƒ½æ— è¶³è½»é‡ã€‚

å›´ç»•æ‰€æœ‰è¿™äº›å·¥å…·çš„æ˜¯ç¼–ç¨‹ (\textbf{programming})ã€‚ç¼–
ç¨‹æ˜¯ä¸€ç§ç»¼åˆå·¥å…·ï¼Œåœ¨æ•°æ®ç§‘å­¦é¡¹ç›®çš„å‡ ä¹æ¯ä¸ªéƒ¨åˆ†éƒ½è¦ç”¨åˆ°ã€‚è¦
æˆä¸ºä¸€åæˆåŠŸçš„æ•°æ®ç§‘å­¦å®¶ï¼Œä½ ä¸éœ€è¦æˆä¸ºä¸€åä¸“ä¸šçš„ç¨‹åºå‘˜ï¼Œä½†æ˜¯å­¦ä¹ æ›´å¤šçš„ç¼–ç¨‹çŸ¥è¯†æ˜¯å€¼å¾—çš„ï¼Œå› ä¸ºæˆä¸ºä¸€åå¥½çš„ç¨‹åºå‘˜å¯ä»¥è®©ä½ è§£å†³å¸¸è§„é—®é¢˜è‡ªåŠ¨åŒ–ï¼Œå¹¶ä½¿è§£å†³æ–°é—®é¢˜å˜å¾—æ›´è½»æ¾ã€‚

ä½ å°†åœ¨æ¯ä¸ªæ•°æ®ç§‘å­¦é¡¹ç›®ä¸­ç”¨åˆ°è¿™äº›å·¥å…·ï¼Œä½†å¯¹å¤§å¤šæ•°é¡¹ç›®æ¥è¯´è¿™äº›å·¥å…·è¿˜ä¸å¤Ÿã€‚è¿™
é‡Œæœ‰ä¸€ä¸ªå¤§è‡´çš„80/20è§„åˆ™ï¼šä½ å¯ä»¥ä½¿ç”¨ä½ åœ¨æœ¬ä¹¦ä¸­å­¦åˆ°çš„å·¥å…·æ¥è§£å†³é¡¹ç›®ä¸­å¤§çº¦80\%çš„é—®é¢˜ï¼Œä½†å‰©ä¸‹çš„20\%éœ€è¦å…¶ä»–å·¥å…·æ¥å¤„ç†ã€‚åœ¨
æœ¬ä¹¦ä¸­æˆ‘ä»¬å°†ä¸ºä½ æä¾›äº†è§£æ›´å¤šä¿¡æ¯çš„èµ„æºã€‚

\section*{æœ¬ä¹¦çš„ç»„ç»‡ç»“æ„}\label{ux672cux4e66ux7684ux7ec4ux7ec7ux7ed3ux6784}
\addcontentsline{toc}{section}{æœ¬ä¹¦çš„ç»„ç»‡ç»“æ„}

\markright{æœ¬ä¹¦çš„ç»„ç»‡ç»“æ„}

å‰é¢å…³äºæ•°æ®ç§‘å­¦å·¥å…·çš„æè¿°å¤§è‡´ä¸Šæ˜¯æŒ‰ç…§æ•°æ®åˆ†æä¸­ä½¿ç”¨çš„é¡ºåºç»„ç»‡çš„
(å½“ç„¶ï¼Œä½ ä¼šå¤šæ¬¡é‡å¤è¿™ä¸ªè¿‡ç¨‹)ã€‚ç„¶
è€Œï¼Œæ ¹æ®æˆ‘ä»¬çš„ç»éªŒï¼Œé¦–å…ˆå­¦ä¹ æ•°æ®å¯¼å…¥å’Œæ•´ç†æ˜¯æ¬¡ä¼˜çš„ï¼Œå› ä¸º80\%çš„æ—¶é—´æ˜¯å¸¸è§„çš„ä¸”æ— èŠçš„ï¼Œè€Œå¦å¤–20\%çš„æ—¶é—´æ˜¯ä¸å¯»å¸¸ä¸”ä»¤äººæ²®ä¸§çš„ã€‚è¿™
ä¸æ˜¯å­¦ä¹ æ–°å­¦ç§‘çš„å¥½èµ·ç‚¹ï¼ç›¸
åï¼Œæˆ‘ä»¬å°†ä»å·²ç»å¯¼å…¥å’Œæ•´ç†çš„æ•°æ®çš„å¯è§†åŒ–å’Œè½¬æ¢å¼€å§‹ã€‚è¿™
æ ·ï¼Œå½“ä½ å¤„ç†å’Œæ•´ç†è‡ªå·±çš„æ•°æ®æ—¶ï¼Œä½ çš„åŠ¨åŠ›å°±ä¼šä¿æŒé«˜æ¶¨ï¼Œå› ä¸ºä½ çŸ¥é“ç—›è‹¦æ˜¯å€¼å¾—çš„ã€‚

åœ¨æ¯ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°½é‡éµå¾ªä¸€ä¸ªä¸€è‡´çš„æ¨¡å¼ï¼šä»ä¸€äº›é¼“èˆäººå¿ƒçš„ä¾‹å­å¼€å§‹ï¼Œè®©ä½ å¯ä»¥çœ‹åˆ°æ›´å¤§çš„å›¾æ™¯ï¼Œç„¶åå†æ·±å…¥åˆ°ç»†èŠ‚ä¸­ã€‚ä¹¦
ä¸­çš„æ¯ä¸€éƒ¨åˆ†éƒ½é…æœ‰ç»ƒä¹ æ¥å¸®åŠ©ä½ ç»ƒä¹ æ‰€å­¦çš„çŸ¥è¯†ã€‚è™½
ç„¶è·³è¿‡ç»ƒä¹ å¾ˆæœ‰è¯±æƒ‘åŠ›ï¼Œä½†æ²¡æœ‰æ¯”åœ¨å®é™…é—®é¢˜ä¸Šç»ƒä¹ æ›´å¥½çš„å­¦ä¹ æ–¹æ³•äº†ã€‚

\section*{å­¦ä¸åˆ°çš„å†…å®¹}\label{ux5b66ux4e0dux5230ux7684ux5185ux5bb9}
\addcontentsline{toc}{section}{å­¦ä¸åˆ°çš„å†…å®¹}

\markright{å­¦ä¸åˆ°çš„å†…å®¹}

æœ‰å‡ ä¸ªé‡è¦çš„ä¸»é¢˜è¿™æœ¬ä¹¦æ²¡æœ‰æ¶‰åŠã€‚æˆ‘
ä»¬è®¤ä¸ºåšæŒä¸æ‡ˆåœ°ä¸“æ³¨äºæœ€åŸºæœ¬çš„ä¸œè¥¿æ˜¯å¾ˆé‡è¦çš„ï¼Œè¿™æ ·ä½ å°±èƒ½å°½å¿«å¼€å§‹è¡ŒåŠ¨ã€‚è¿™
ä¹Ÿè¡¨æ˜è¿™æœ¬ä¹¦ä¸å¯èƒ½æ¶µç›–æ¯ä¸€ä¸ªé‡è¦ä¸»é¢˜ã€‚

\subsection*{å»ºæ¨¡}\label{ux5efaux6a21}
\addcontentsline{toc}{subsection}{å»ºæ¨¡}

å¯¹äºæ•°æ®ç§‘å­¦æ¥è¯´å»ºæ¨¡æ˜¯éå¸¸é‡è¦çš„ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„ä¸»é¢˜ã€‚è€Œ
ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´åœ¨è¿™é‡Œç»™äºˆå®ƒåº”æœ‰çš„ç¯‡å¹…ã€‚è¦
äº†è§£æ›´å¤šå…³äºå»ºæ¨¡çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬å¼ºçƒˆæ¨èç”±æˆ‘ä»¬çš„åŒäº‹Max Kuhnå’ŒJulia
Silgeçš„ç¼–å†™çš„\href{https://www.tmwr.org}{Tidy Modeling with R} ã€‚æœ¬
ä¹¦å°†å‘ä½ ä»‹ç»tidymodelsåŒ…å®¶æ—ï¼Œæ­£å¦‚ä½ ä»åç§°ä¸­çŒœåˆ°çš„é‚£æ ·ï¼Œå®ƒä¸æˆ‘ä»¬åœ¨æœ¬ä¹¦ä¸­ä½¿ç”¨çš„tidyverseåŒ…å…±äº«è®¸å¤šçº¦å®šã€‚

\subsection*{å¤§æ•°æ®}\label{ux5927ux6570ux636e}
\addcontentsline{toc}{subsection}{å¤§æ•°æ®}

æœ¬ä¹¦ä¸»è¦å…³æ³¨å°å‹å†…å­˜æ•°æ®é›†ã€‚è¿™
æ˜¯ä¸€ä¸ªæ­£ç¡®çš„èµ·ç‚¹ï¼Œå› ä¸ºåªæœ‰åœ¨ä½ å…·å¤‡å¤„ç†å°æ•°æ®çš„ç»éªŒåï¼Œæ‰èƒ½å¤„ç†å¤§æ•°æ®ã€‚æœ¬
ä¹¦å¤§éƒ¨åˆ†å†…å®¹æ‰€æä¾›çš„å·¥å…·éƒ½å¯ä»¥ç”¨æ¥è½»æ¾å¤„ç†æ•°ç™¾å…†å­—èŠ‚çš„æ•°æ®ï¼Œç¨åŠ æ³¨æ„å®ƒä»¬ç”šè‡³å¯ä»¥å¤„ç†å‡ GBçš„æ•°æ®ã€‚æˆ‘
ä»¬è¿˜å°†å‘ä½ å±•ç¤ºå¦‚ä½•ä»æ•°æ®åº“å’Œ\emph{Parquet}æ–‡ä»¶ä¸­è·å–æ•°æ®ï¼Œè¿™ä¸¤ç§æ–‡ä»¶é€šå¸¸ç”¨äºå­˜å‚¨å¤§æ•°æ®ã€‚ä½ 
ä¸ä¸€å®šèƒ½å¤Ÿå¤„ç†æ•´ä¸ªæ•°æ®é›†ï¼Œä½†è¿™ä¸æ˜¯é—®é¢˜ï¼Œå› ä¸ºä½ åªéœ€è¦ä¸€ä¸ªå­é›†æˆ–è€…å­æ ·æœ¬æ¥å›ç­”ä½ æ„Ÿå…´è¶£çš„é—®é¢˜ã€‚

å¦‚æœä½ ç»å¸¸éœ€è¦å¤„ç†æ›´å¤§çš„æ•°æ® (æ¯”å¦‚è¯´10-100GB)ï¼Œæˆ‘ä»¬å»ºè®®ä½ è¿›ä¸€æ­¥äº†è§£
\href{https://github.com/Rdatatable/data.table}{data.table}ã€‚æˆ‘
ä»¬åœ¨è¿™é‡Œä¸åšè®²è§£ï¼Œå› ä¸ºå®ƒä½¿ç”¨çš„æ¥å£ä¸tidyverseä¸åŒï¼Œéœ€è¦å­¦ä¹ ä¸€äº›ä¸åŒçš„çº¦å®šã€‚ç„¶
è€Œå®ƒçš„é€Ÿåº¦éå¸¸å¿«ï¼Œå¦‚æœä½ æ­£åœ¨å¤„ç†å¤§æ•°æ®ï¼Œé‚£ä¹ˆå®ƒçš„ä¼˜å¼‚æ€§èƒ½è¡¨ç°å€¼å¾—ä½ æŠ•å…¥ä¸€äº›æ—¶é—´æ¥å­¦ä¹ å®ƒã€‚

\subsection*{Pythonã€Juliaå’Œå…¶ä»–ç¼–ç¨‹è¯­è¨€}\label{pythonjuliaux548cux5176ux4ed6ux7f16ux7a0bux8bedux8a00}
\addcontentsline{toc}{subsection}{Pythonã€Juliaå’Œå…¶ä»–ç¼–ç¨‹è¯­è¨€}

åœ¨è¿™æœ¬ä¹¦ä¸­ï¼Œä½ ä¸ä¼šå­¦åˆ°ä»»ä½•å…³äºPythonã€Juliaæˆ–å…¶ä»–å¯¹æ•°æ®ç§‘å­¦æœ‰ç”¨çš„ç¼–ç¨‹è¯­è¨€çš„çŸ¥è¯†ã€‚è¿™
å¹¶ä¸æ˜¯å› ä¸ºæˆ‘ä»¬è®¤ä¸ºè¿™äº›å·¥å…·ä¸å¥½ï¼Œå®ƒä»¬å¾ˆä¼˜ç§€ï¼åœ¨
å®è·µä¸­ï¼Œå¤§å¤šæ•°æ•°æ®ç§‘å­¦å›¢é˜Ÿä½¿ç”¨æ··åˆè¯­è¨€ï¼Œé€šå¸¸è‡³å°‘æ˜¯Rå’ŒPythonã€‚ä½†
æˆ‘ä»¬åšä¿¡ï¼Œæœ€å¥½ä¸€æ¬¡åªæŒæ¡ä¸€ç§å·¥å…·ï¼ŒRå°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚

\section*{é¢„å¤‡çŸ¥è¯†}\label{ux9884ux5907ux77e5ux8bc6}
\addcontentsline{toc}{section}{é¢„å¤‡çŸ¥è¯†}

\markright{é¢„å¤‡çŸ¥è¯†}

ä¸ºäº†è®©ä½ ä»è¿™æœ¬ä¹¦ä¸­è·å¾—æœ€å¤§çš„æ”¶ç›Šï¼Œæˆ‘ä»¬å¯¹ä½ å·²ç»çŸ¥é“çš„å†…å®¹åšäº†ä¸€äº›å‡è®¾ã€‚ä½ 
åº”è¯¥å¯¹æ•°å­—æœ‰ä¸€å®šçš„äº†è§£ï¼Œå¦‚æœä½ å·²ç»æœ‰ä¸€äº›åŸºæœ¬çš„ç¼–ç¨‹ç»éªŒï¼Œé‚£å°†ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚å¦‚
æœä½ ä»¥å‰ä»æœªç¼–è¿‡ç¨‹ï¼Œä½ ä¼šå‘ç°Garrettç¼–å†™çš„\href{https://rstudio-education.github.io/hopr/}{Hands
on Programming with R} æ˜¯è¿™æœ¬ä¹¦çš„ä¸€ä¸ªæœ‰ç›Šè¡¥å……ã€‚

è¿è¡Œè¿™æœ¬ä¹¦ä¸­çš„ä»£ç ï¼Œä½ éœ€è¦å››æ ·ä¸œè¥¿ï¼šRã€RStudioï¼Œä¸€ä¸ªåä¸ºtidyverseçš„RåŒ…é›†åˆä»¥åŠå…¶ä»–å‡ ä¸ªåŒ…ã€‚åŒ…
æ˜¯å¯é‡ç°Rä»£ç çš„åŸºæœ¬å•å…ƒã€‚å®ƒ
ä»¬åŒ…æ‹¬å¯é‡ç”¨çš„å‡½æ•°ã€æè¿°å¦‚ä½•ä½¿ç”¨å®ƒä»¬çš„æ–‡æ¡£ä»¥åŠæ ·æœ¬æ•°æ®ã€‚

\subsection*{R}\label{r}
\addcontentsline{toc}{subsection}{R}

è¦ä¸‹è½½Rï¼Œè¯·è®¿é—®CRAN (the \textbf{c}omprehensive \textbf{R}
\textbf{a}rchive \textbf{n}etwork) \url{https://cloud.r-project.org}ã€‚R
æ–°çš„ä¸»è¦ç‰ˆæœ¬æ¯å¹´å‘å¸ƒä¸€æ¬¡ï¼Œä¹Ÿä¼šå‘å¸ƒ2-3ä¸ªæ¬¡è¦ç‰ˆæœ¬ï¼Œå»ºè®®å®šæœŸæ›´æ–°ã€‚å‡
çº§å¯èƒ½ä¼šæœ‰ç‚¹éº»çƒ¦ï¼Œç‰¹åˆ«æ˜¯ä¸»è¦ç‰ˆæœ¬ï¼Œéœ€è¦ä½ é‡æ–°å®‰è£…æ‰€æœ‰çš„åŒ…ï¼Œä½†æ˜¯æ‹–å»¶åªä¼šè®©æƒ…å†µå˜å¾—æ›´ç³Ÿã€‚æˆ‘
ä»¬å»ºè®®æœ¬ä¹¦ä½¿ç”¨R4.2.0æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚

\subsection*{RStudio}\label{rstudio}
\addcontentsline{toc}{subsection}{RStudio}

RStudio æ˜¯ä¸€ä¸ªç”¨äºç¼–ç¨‹çš„é›†æˆå¼€å‘ç¯å¢ƒï¼Œä½ å¯ä»¥ä»
\url{https://posit.co/download/rstudio-desktop/}ä¸‹è½½ã€‚\\
RStudioæ¯å¹´æ›´æ–°å‡ æ¬¡ï¼Œå½“æ–°ç‰ˆæœ¬å‘å¸ƒæ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨é€šçŸ¥ä½ ï¼Œæ‰€ä»¥ä¸éœ€è¦å®šæœŸæŸ¥çœ‹ï¼Œä½†æœ€å¥½å®šæœŸå‡çº§ï¼Œä»¥åˆ©ç”¨æœ€æ–°å’Œæœ€å¼ºå¤§çš„åŠŸèƒ½ã€‚å¯¹
äºè¿™æœ¬ä¹¦ï¼Œè¯·ç¡®ä¿ä½ è‡³å°‘æœ‰RStudio 2022.02.0ç‰ˆæœ¬ã€‚

å½“ä½ å¯åŠ¨RStudioåï¼Œå¦‚ å›¾~\ref{fig-rstudio-console}
ï¼Œåœ¨ç•Œé¢ä¸­ä½ ä¼šçœ‹åˆ°ä¸¤ä¸ªå…³é”®åŒºåŸŸï¼šæ§åˆ¶å°é¢æ¿å’Œè¾“å‡ºé¢æ¿ã€‚ç°
åœ¨ä½ éœ€è¦çŸ¥é“çš„æ˜¯ï¼Œä½ åœ¨æ§åˆ¶å°é¢æ¿ä¸­è¾“å…¥Rä»£ç ï¼Œç„¶åæŒ‰å›è½¦é”®æ¥è¿è¡Œå®ƒã€‚éš
ç€æˆ‘ä»¬çš„é€æ­¥æ·±å…¥ï¼Œä½ ä¼šå­¦åˆ°æ›´å¤š\footnote{If you'd like a comprehensive
  overview of all of RStudio's features, see the RStudio User Guide at
  \url{https://docs.posit.co/ide/user}.}ã€‚

\begin{figure}

\centering{

\includegraphics[width=5.41in,height=\textheight]{diagrams/rstudio/console.png}

}

\caption{\label{fig-rstudio-console}RStudio IDE
æœ‰ä¸¤ä¸ªå…³é”®åŒºåŸŸï¼šåœ¨å·¦ä¾§çš„æ§åˆ¶å°é¢æ¿ä¸­è¾“å…¥Rä»£ç ï¼Œ
åœ¨å³ä¾§çš„è¾“å‡ºé¢æ¿ä¸­æŸ¥çœ‹å›¾å½¢ã€‚}

\end{figure}%

\subsection*{Tidyverse}\label{tidyverse}
\addcontentsline{toc}{subsection}{Tidyverse}

ä½ è¿˜éœ€è¦å®‰è£…ä¸€äº›RåŒ…ã€‚R
åŒ…æ˜¯å‡½æ•°ã€æ•°æ®å’Œæ–‡æ¡£çš„é›†åˆï¼Œå®ƒæ‰©å±•äº†åŸºç¡€Rçš„åŠŸèƒ½ã€‚ä½¿
ç”¨åŒ…æ˜¯æˆåŠŸä½¿ç”¨Rçš„å…³é”®ã€‚ä½ 
åœ¨æœ¬ä¹¦ä¸­å­¦ä¹ çš„å¤§å¤šæ•°åŒ…éƒ½æ˜¯æ‰€è°“tidyverseçš„ä¸€éƒ¨åˆ†ã€‚t
idyverseä¸­çš„æ‰€æœ‰åŒ…éƒ½å…±äº«æ•°æ®å’ŒRç¼–ç¨‹çš„å…±åŒç†å¿µï¼Œå¹¶è¢«ç²¾å¿ƒå®‰æ’åœ¨ä¸€èµ·ååŒå·¥ä½œã€‚

ä½ å¯ä»¥ä½¿ç”¨ä¸€è¡Œä»£ç å®‰è£…å®Œæ•´çš„tidyverseåŒ…ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"tidyverse"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

åœ¨ä½ çš„è®¡ç®—æœºä¸Šï¼Œåœ¨æ§åˆ¶å°ä¸­é”®å…¥è¿™è¡Œä»£ç ï¼Œç„¶åæŒ‰enteré”®è¿è¡Œå®ƒï¼ŒRå°†ä»CRANä¸‹è½½è½¯ä»¶åŒ…å¹¶å®‰è£…åˆ°ä½ çš„è®¡ç®—æœºä¸Šã€‚

åœ¨ä½¿ç”¨\texttt{library()}åŠ è½½åŒ…ä¹‹å‰ï¼Œä½ æ— æ³•ä½¿ç”¨åŒ…ä¸­çš„å‡½æ•°ã€å¯¹è±¡æˆ–å¸®åŠ©æ–‡ä»¶ã€‚ä¸€
æ—¦å®‰è£…äº†ä¸€ä¸ªåŒ…ï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{library()} æ¥åŠ è½½å®ƒï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\CommentTok{\#\textgreater{} {-}{-} Attaching core tidyverse packages {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} tidyverse 2.0.0 {-}{-}}
\CommentTok{\#\textgreater{} v dplyr     1.1.4     v readr     2.1.5}
\CommentTok{\#\textgreater{} v forcats   1.0.0     v stringr   1.5.1}
\CommentTok{\#\textgreater{} v ggplot2   3.5.0     v tibble    3.2.1}
\CommentTok{\#\textgreater{} v lubridate 1.9.3     v tidyr     1.3.1}
\CommentTok{\#\textgreater{} v purrr     1.0.2     }
\CommentTok{\#\textgreater{} {-}{-} Conflicts {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} tidyverse\_conflicts() {-}{-}}
\CommentTok{\#\textgreater{} x dplyr::filter() masks stats::filter()}
\CommentTok{\#\textgreater{} x dplyr::lag()    masks stats::lag()}
\CommentTok{\#\textgreater{} i Use the conflicted package (\textless{}http://conflicted.r{-}lib.org/\textgreater{}) to force all conflicts to become errors}
\end{Highlighting}
\end{Shaded}

è¿™å‘Šè¯‰ä½ ï¼ŒtidyverseåŠ è½½äº†9ä¸ªåŒ…:
dplyrã€forcatsã€ggplot2ã€lubridã€purrrã€readerã€stringrã€tibbleå’Œtidyrã€‚å®ƒ
ä»¬è¢«è®¤ä¸ºæ˜¯tidyverseçš„æ ¸å¿ƒï¼Œå› ä¸ºå‡ ä¹åœ¨æ‰€æœ‰æ•°æ®åˆ†æä¸­éƒ½ä¼šç”¨åˆ°å®ƒä»¬ã€‚

tidyverseä¸­çš„åŒ…å˜åŒ–ç›¸å½“é¢‘ç¹ã€‚å¯
ä»¥é€šè¿‡è¿è¡Œ\texttt{tidyverse\_update()}æŸ¥çœ‹æ˜¯å¦æœ‰å¯ç”¨çš„æ›´æ–°ã€‚

\subsection*{å…¶ä»–åŒ…}\label{ux5176ux4ed6ux5305}
\addcontentsline{toc}{subsection}{å…¶ä»–åŒ…}

è¿˜æœ‰è®¸å¤šå…¶ä»–ä¼˜ç§€çš„è½¯ä»¶åŒ…ï¼Œå®ƒä»¬ä¸æ˜¯tidyverseçš„ä¸€éƒ¨åˆ†ï¼Œå› ä¸ºå®ƒä»¬è§£å†³äº†ä¸åŒé¢†åŸŸçš„é—®é¢˜ï¼Œæˆ–è€…æ˜¯ç”¨ä¸åŒçš„åŸºæœ¬åŸåˆ™è®¾è®¡çš„ã€‚è¿™
ä¸ä¼šè®©å®ƒä»¬å˜å¾—æ›´å¥½æˆ–æ›´ç³Ÿï¼Œè¿™åªä¼šè®©å®ƒä»¬ä¸ä¼—ä¸åŒã€‚æ¢ å¥è¯è¯´ï¼Œå¯¹
tidyverseçš„è¡¥å……ä¸æ˜¯messyverseï¼Œè€Œæ˜¯ç”±ç›¸äº’å…³è”çš„åŒ…ç»„æˆçš„è®¸å¤šå…¶ä»–universesã€‚éš
ç€ä½ ä½¿ç”¨Rå¤„ç†æ›´å¤šçš„æ•°æ®ç§‘å­¦é¡¹ç›®ï¼Œä½ å°†å­¦ä¹ æ–°çš„åŒ…å’Œæ–°çš„æ•°æ®æ€è€ƒæ–¹å¼ã€‚

åœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è®¸å¤šæ¥è‡ªtidyverseä¹‹å¤–çš„åŒ…ã€‚ä¾‹
å¦‚ä»¥ä¸‹çš„åŒ…ä¸ºæˆ‘ä»¬åœ¨å­¦ä¹ Rçš„è¿‡ç¨‹ä¸­æä¾›äº†æœ‰è¶£çš„æ•°æ®é›†ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}
  \FunctionTok{c}\NormalTok{(}\StringTok{"arrow"}\NormalTok{, }\StringTok{"babynames"}\NormalTok{, }\StringTok{"curl"}\NormalTok{, }\StringTok{"duckdb"}\NormalTok{, }\StringTok{"gapminder"}\NormalTok{, }
    \StringTok{"ggrepel"}\NormalTok{, }\StringTok{"ggridges"}\NormalTok{, }\StringTok{"ggthemes"}\NormalTok{, }\StringTok{"hexbin"}\NormalTok{, }\StringTok{"janitor"}\NormalTok{, }\StringTok{"Lahman"}\NormalTok{, }
    \StringTok{"leaflet"}\NormalTok{, }\StringTok{"maps"}\NormalTok{, }\StringTok{"nycflights13"}\NormalTok{, }\StringTok{"openxlsx"}\NormalTok{, }\StringTok{"palmerpenguins"}\NormalTok{, }
    \StringTok{"repurrrsive"}\NormalTok{, }\StringTok{"tidymodels"}\NormalTok{, }\StringTok{"writexl"}\NormalTok{)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬è¿˜å°†ä½¿ç”¨ä¸€äº›å…¶ä»–åŒ…ä½œä¸ºå•ç‹¬çš„ç¤ºä¾‹ã€‚ä½ 
ç°åœ¨ä¸éœ€è¦å®‰è£…å®ƒä»¬ï¼Œåªè¦è®°ä½æ¯å½“ä½ çœ‹åˆ°è¿™æ ·çš„é”™è¯¯æ—¶ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggrepel)}
\CommentTok{\#\textgreater{} Error in library(ggrepel) : there is no package called â€˜ggrepelâ€™}
\end{Highlighting}
\end{Shaded}

ä½ éœ€è¦è¿è¡Œ \texttt{install.packages("ggrepel")} æ¥å®‰è£…è¿™ä¸ªåŒ…ã€‚

\section*{è¿è¡ŒRä»£ç }\label{ux8fd0ux884crux4ee3ux7801}
\addcontentsline{toc}{section}{è¿è¡ŒRä»£ç }

\markright{è¿è¡ŒRä»£ç }

å‰ä¸€èŠ‚å‘ä½ å±•ç¤ºäº†å‡ ä¸ªè¿è¡ŒRä»£ç çš„ç¤ºä¾‹ï¼Œä¹¦ä¸­çš„ä»£ç çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1} \SpecialCharTok{+} \DecValTok{2}
\CommentTok{\#\textgreater{} [1] 3}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ åœ¨æœ¬åœ°æ§åˆ¶å°ä¸­è¿è¡Œç›¸åŒçš„ä»£ç ï¼Œå®ƒçœ‹èµ·æ¥åƒè¿™æ ·:

\begin{verbatim}
> 1 + 2
[1] 3
\end{verbatim}

æœ‰ä¸¤ä¸ªä¸»è¦åŒºåˆ«ï¼šåœ¨æ§åˆ¶å°ä¸­ï¼Œä½ åœ¨\texttt{\textgreater{}}ä¹‹åé”®å…¥ï¼Œ\texttt{\textgreater{}}ç§°ä¸ºæç¤ºç¬¦ã€‚æˆ‘
ä»¬åœ¨ä¹¦ä¸­æ²¡æœ‰æ˜¾ç¤ºæç¤ºç¬¦ã€‚åœ¨
æœ¬ä¹¦ä¸­ï¼Œè¾“å‡ºç”¨\texttt{\#\textgreater{}}æ³¨é‡Šæ‰ã€‚åœ¨
æ§åˆ¶å°ä¸­ï¼Œå®ƒç›´æ¥å‡ºç°åœ¨ä»£ç ä¹‹åã€‚è¿™
ä¸¤ä¸ªåŒºåˆ«æ„å‘³ç€ï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯ç”µå­ä¹¦ï¼Œä½ å¯ä»¥è½»æ¾åœ°ä»ä¹¦ä¸­å¤åˆ¶ä»£ç å¹¶å°†å…¶ç²˜è´´åˆ°æ§åˆ¶å°ã€‚

åœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€è‡´çš„çº¦å®šæ¥å¼•ç”¨ä»£ç ï¼š

\begin{itemize}
\item
  å‡½æ•°ç”¨ä»£ç å­—ä½“æ˜¾ç¤ºï¼Œåé¢è·Ÿç€åœ†æ‹¬å·ï¼Œå¦‚ \texttt{sum()} æˆ–
  \texttt{mean()}ï¼›
\item
  å…¶ä»–Rå¯¹è±¡ (ä¾‹å¦‚æ•°æ®æˆ–å‡½æ•°å‚æ•°) ç”¨ä»£ç å­—ä½“ï¼Œæ²¡æœ‰åœ†æ‹¬å·, å¦‚
  \texttt{flights} æˆ– \texttt{x}.
\item
  æœ‰æ—¶ï¼Œä¸ºäº†æ˜ç¡®å¯¹è±¡æ¥è‡ªå“ªä¸ªåŒ…ï¼Œto make it clear which package an object
  comes from, æˆ‘ä»¬ä½¿ç”¨åŒ…ååé¢åŠ ä¸¤ä¸ªå†’å·ï¼Œå¦‚ \texttt{dplyr::mutate()} æˆ–
  \texttt{nycflights13::flights}ã€‚è¿™ ä¹Ÿæ˜¯æœ‰æ•ˆçš„Rä»£ç ã€‚
\end{itemize}

\section*{è‡´è°¢}\label{ux81f4ux8c22-1}
\addcontentsline{toc}{section}{è‡´è°¢}

\markright{è‡´è°¢}

è¿™æœ¬ä¹¦ä¸ä»…ä»…æ˜¯Hadleyã€æˆ‘å’ŒGarrettçš„ä½œå“ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ä¸Rç¤¾åŒºè®¸å¤šäºº(é¢å¯¹é¢å’Œåœ¨çº¿)å¤šæ¬¡äº¤è°ˆçš„ç»“æœã€‚é
å¸¸æ„Ÿè°¢ä¸ä½ ä»¬æ‰€æœ‰äººçš„äº¤æµï¼Œéå¸¸æ„Ÿè°¢!

è¿™æœ¬ä¹¦æ˜¯å…¬å¼€ç¼–å†™çš„ï¼Œè®¸å¤šäººé€šè¿‡æ‹‰å–è¯·æ±‚ï¼ˆpull
requestsï¼‰åšå‡ºäº†è´¡çŒ®ã€‚ç‰¹åˆ«æ„Ÿè°¢é€šè¿‡GitHubæ‹‰å–è¯·æ±‚çš„259 ä½è´¡çŒ®è€…
(æŒ‰ç”¨æˆ·åå­—æ¯é¡ºåº): @a-rosenberg, Tim Becker (@a2800276), Abinash
Satapathy (@Abinashbunty), Adam Gruer (@adam-gruer), adi pradhan
(@adidoit), A. s. (@Adrianzo), Aep Hidyatuloh (@aephidayatuloh), Andrea
Gilardi (@agila5), Ajay Deonarine (@ajay-d), @AlanFeder, Daihe Sui
(@alansuidaihe), @alberto-agudo, @AlbertRapp, @aleloi, pete (@alonzi),
Alex (@ALShum), Andrew M. (@amacfarland), Andrew Landgraf (@andland),
@andyhuynh92, Angela Li (@angela-li), Antti Rask (@AnttiRask), LOU Xun
(@aquarhead), @ariespirgel, @august-18, Michael Henry (@aviast), Azza
Ahmed (@azzaea), Steven Moran (@bambooforest), Brian G. Barkley
(@BarkleyBG), Mara Averick (@batpigandme), Oluwafemi OYEDELE (@BB1464),
Brent Brewington (@bbrewington), Bill Behrman (@behrman), Ben Herbertson
(@benherbertson), Ben Marwick (@benmarwick), Ben Steinberg
(@bensteinberg), Benjamin Yeh (@bentyeh), Betul Turkoglu
(@betulturkoglu), Brandon Greenwell (@bgreenwell), Bianca Peterson
(@BinxiePeterson), Birger Niklas (@BirgerNi), Brett Klamer (@bklamer),
@boardtc, Christian (@c-hoh), Caddy (@caddycarine), Camille V Leonard
(@camillevleonard), @canovasjm, Cedric Batailler (@cedricbatailler),
Christina Wei (@christina-wei), Christian Mongeau (@chrMongeau), Cooper
Morris (@coopermor), Colin Gillespie (@csgillespie), Rademeyer Vermaak
(@csrvermaak), Chloe Thierstein (@cthierst), Chris Saunders (@ctsa),
Abhinav Singh (@curious-abhinav), Curtis Alexander (@curtisalexander),
Christian G. Warden (@cwarden), Charlotte Wickham (@cwickham), Kenny
Darrell (@darrkj), David Kane (@davidkane9), David (@davidrsch), David
Rubinger (@davidrubinger), David Clark (@DDClark), Derwin McGeary
(@derwinmcgeary), Daniel Gromer (@dgromer), @Divider85, @djbirke,
Danielle Navarro (@djnavarro), Russell Shean (@DOH-RPS1303), Zhuoer Dong
(@dongzhuoer), Devin Pastoor (@dpastoor), @DSGeoff, Devarshi Thakkar
(@dthakkar09), Julian During (@duju211), Dylan Cashman (@dylancashman),
Dirk Eddelbuettel (@eddelbuettel), Edwin Thoen (@EdwinTh), Ahmed
El-Gabbas (@elgabbas), Henry Webel (@enryH), Ercan Karadas (@ercan7),
Eric Kitaif (@EricKit), Eric Watt (@ericwatt), Erik Erhardt
(@erikerhardt), Etienne B. Racine (@etiennebr), Everett Robinson
(@evjrob), @fellennert, Flemming Miguel (@flemmingmiguel), Floris
Vanderhaeghe (@florisvdh), @funkybluehen, @gabrivera, Garrick Aden-Buie
(@gadenbuie), Peter Ganong (@ganong123), Gerome Meyer (@GeroVanMi), Gleb
Ebert (@gl-eb), Josh Goldberg (@GoldbergData), bahadir cankardes
(@gridgrad), Gustav W Delius (@gustavdelius), Hao Chen (@hao-trivago),
Harris McGehee (@harrismcgehee), @hendrikweisser, Hengni Cai
(@hengnicai), Iain (@Iain-S), Ian Sealy (@iansealy), Ian Lyttle
(@ijlyttle), Ivan Krukov (@ivan-krukov), Jacob Kaplan (@jacobkap), Jazz
Weisman (@jazzlw), John Blischak (@jdblischak), John D. Storey
(@jdstorey), Gregory Jefferis (@jefferis), Jeffrey Stevens
(@JeffreyRStevens), è’‹é›¨è’™ (@JeldorPKU), Jennifer (Jenny) Bryan
(@jennybc), Jen Ren (@jenren), Jeroen Janssens (@jeroenjanssens),
@jeromecholewa, Janet Wesner (@jilmun), Jim Hester (@jimhester), JJ Chen
(@jjchern), Jacek Kolacz (@jkolacz), Joanne Jang (@joannejang),
@johannes4998, John Sears (@johnsears), @jonathanflint, Jon Calder
(@jonmcalder), Jonathan Page (@jonpage), Jon Harmon (@jonthegeek),
JooYoung Seo (@jooyoungseo), Justinas Petuchovas (@jpetuchovas), Jordan
(@jrdnbradford), Jeffrey Arnold (@jrnold), Jose Roberto Ayala Solares
(@jroberayalas), Joyce Robbins (@jtr13), @juandering, Julia Stewart
Lowndes (@jules32), Sonja (@kaetschap), Kara Woo (@karawoo), Katrin
Leinweber (@katrinleinweber), Karandeep Singh (@kdpsingh), Kevin Perese
(@kevinxperese), Kevin Ferris (@kferris10), Kirill Sevastyanenko
(@kirillseva), Jonathan Kitt (@KittJonathan), @koalabearski, Kirill
MÃ¼ller (@krlmlr), RafaÅ‚ Kucharski (@kucharsky), Kevin Wright (@kwstat),
Noah Landesberg (@landesbergn), Lawrence Wu (@lawwu), @lindbrook, Luke W
Johnston (@lwjohnst86), Kara de la Marck (@MarckK), Kunal Marwaha
(@marwahaha), Matan Hakim (@matanhakim), Matthias Liew (@MatthiasLiew),
Matt Wittbrodt (@MattWittbrodt), Mauro Lepore (@maurolepore), Mark
Beveridge (@mbeveridge), @mcewenkhundi, mcsnowface, PhD (@mcsnowface),
Matt Herman (@mfherman), Michael Boerman (@michaelboerman), Mitsuo
Shiota (@mitsuoxv), Matthew Hendrickson (@mjhendrickson), @MJMarshall,
Misty Knight-Finley (@mkfin7), Mohammed Hamdy (@mmhamdy), Maxim Nazarov
(@mnazarov), Maria Paula Caldas (@mpaulacaldas), Mustafa Ascha
(@mustafaascha), Nelson Areal (@nareal), Nate Olson (@nate-d-olson),
Nathanael (@nateaff), @nattalides, Ned Western (@NedJWestern), Nick
Clark (@nickclark1000), @nickelas, Nirmal Patel (@nirmalpatel), Nischal
Shrestha (@nischalshrestha), Nicholas Tierney (@njtierney), Jakub
Nowosad (@Nowosad), Nick Pullen (@nstjhp), @olivier6088, Olivier
Cailloux (@oliviercailloux), Robin Penfold (@p0bs), Pablo E. Garcia
(@pabloedug), Paul Adamson (@padamson), Penelope Y (@penelopeysm), Peter
Hurford (@peterhurford), Peter Baumgartner (@petzi53), Patrick Kennedy
(@pkq), Pooya Taherkhani (@pooyataher), Y. Yu (@PursuitOfDataScience),
Radu Grosu (@radugrosu), Ranae Dietzel (@Ranae), Ralph Straumann
(@rastrau), Rayna M Harris (@raynamharris), @ReeceGoding, Robin
Gertenbach (@rgertenbach), Jajo (@RIngyao), Riva Quiroga (@rivaquiroga),
Richard Knight (@RJHKnight), Richard Zijdeman (@rlzijdeman),
@robertchu03, Robin Kohrs (@RobinKohrs), Robin (@Robinlovelace), Emily
Robinson (@robinsones), Rob Tenorio (@robtenorio), Rod Mazloomi
(@RodAli), Rohan Alexander (@RohanAlexander), Romero Morais
(@RomeroBarata), Albert Y. Kim (@rudeboybert), Saghir (@saghirb), Hojjat
Salmasian (@salmasian), Jonas (@sauercrowd), Vebash Naidoo
(@sciencificity), Seamus McKinsey (@seamus-mckinsey), @seanpwilliams,
Luke Smith (@seasmith), Matthew Sedaghatfar (@sedaghatfar), Sebastian
Kraus (@sekR4), Sam Firke (@sfirke), Shannon Ellis (@ShanEllis),
@shoili, Christian Heinrich (@Shurakai), S'busiso Mkhondwane
(@sibusiso16), SM Raiyyan (@sm-raiyyan), Jakob Krigovsky (@sonicdoe),
Stephan Koenig (@stephan-koenig), Stephen Balogun (@stephenbalogun),
Steven M. Mortimer (@StevenMMortimer), StÃ©phane Guillou (@stragu), Sulgi
Kim (@sulgik), Sergiusz Bleja (@svenski), Tal Galili (@talgalili), Alec
Fisher (@Taurenamo), Todd Gerarden (@tgerarden), Tom Godfrey
(@thomasggodfrey), Tim Broderick (@timbroderick), Tim Waterhouse
(@timwaterhouse), TJ Mahr (@tjmahr), Thomas Klebel (@tklebel), Tom Prior
(@tomjamesprior), Terence Teo (@tteo), @twgardner2, Ulrik Lyngs
(@ulyngs), Shinya Uryu (@uribo), Martin Van der Linden
(@vanderlindenma), Walter Somerville (@waltersom), @werkstattcodes, Will
Beasley (@wibeasley), Yihui Xie (@yihui), Yiming (Paul) Li (@yimingli),
@yingxingwu, Hiroaki Yutani (@yutannihilation), Yu Yu Aung (@yuyu-aung),
Zach Bogart (@zachbogart), @zeal626, Zeki Akyol (@zekiakyol).

\section*{ç‰ˆæƒ}\label{ux7248ux6743}
\addcontentsline{toc}{section}{ç‰ˆæƒ}

\markright{ç‰ˆæƒ}

æœ¬ä¹¦çš„åœ¨çº¿ç‰ˆæœ¬è®¿é—®
\url{https://r4ds.hadley.nz}ï¼Œåœ¨çº¸è´¨ä¹¦å°åˆ·æœŸé—´æœ¬ä¹¦å°†ç»§ç»­å‘å±•ã€‚æœ¬
ä¹¦çš„æºä»£ç å¯åœ¨ \url{https://github.com/hadley/r4ds}è·å–ã€‚ æœ¬ä¹¦ç”±
\href{https://quarto.org}{Quarto}æä¾›æ”¯æŒï¼Œè¿™ä½¿å¾—ç¼–å†™ç»“åˆäº†æ–‡æœ¬å’Œå¯æ‰§è¡Œä»£ç çš„ä¹¦å˜å¾—å¾ˆå®¹æ˜“ã€‚

\part{å…¨è²Œæ¦‚è§ˆ}

æœ¬ä¹¦è¿™ä¸€éƒ¨åˆ†çš„ç›®çš„æ˜¯è®©ä½ å¿«é€Ÿæµè§ˆæ•°æ®ç§‘å­¦çš„ä¸»è¦å·¥å…·ï¼š\textbf{å¯¼å…¥}ã€\textbf{æ•´ç†}ã€\textbf{è½¬æ¢}å’Œ\textbf{å¯è§†åŒ–}æ•°æ®ï¼Œå¦‚
å›¾~\ref{fig-ds-whole-game} æ‰€ç¤ºã€‚æˆ‘
ä»¬å°†å‘ä½ å±•ç¤ºæ•°æ®ç§‘å­¦çš„``å…¨è²Œ''ï¼Œä¸ºä½ æä¾›å„ä¸»è¦éƒ¨åˆ†çš„è¶³å¤Ÿå†…å®¹ï¼Œä»¥ä¾¿ä½ èƒ½å¤Ÿå¤„ç†çœŸå®
(å°½ç®¡å¯èƒ½ç®€å•) çš„æ•°æ®é›†ã€‚æœ¬
ä¹¦åé¢çš„éƒ¨åˆ†å°†æ·±å…¥æ¢è®¨è¿™äº›ä¸»é¢˜ï¼Œä»è€Œå¢åŠ ä½ è§£å†³æ•°æ®ç§‘å­¦æŒ‘æˆ˜çš„èŒƒå›´ã€‚

\begin{figure}

\centering{

\includegraphics[width=5.57in,height=\textheight]{diagrams/data-science/whole-game.png}

}

\caption{\label{fig-ds-whole-game}åœ¨æœ¬ä¹¦çš„è¿™ä¸€èŠ‚ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•å¯¼å…¥ã€æ•´é½ã€è½¬æ¢å’Œå¯è§†åŒ–æ•°æ®ï¼›ç¼–ç¨‹è´¯ç©¿äºå„ä¸ªè¿‡ç¨‹ã€‚}

\end{figure}%

æ•°æ®ç§‘å­¦å·¥å…·åŒ…å«å››ç« å†…å®¹ï¼š

\begin{itemize}
\item
  å¯è§†åŒ–æ˜¯å­¦ä¹ Rç¼–ç¨‹éå¸¸å¥½çš„èµ·ç‚¹ï¼Œå› ä¸ºå®ƒçš„å›æŠ¥æ˜¯å¦‚æ­¤æ˜æ˜¾ï¼šä½ å¯ä»¥åˆ¶ä½œä¼˜é›…ä¸”ä¿¡æ¯ä¸°å¯Œçš„å›¾å½¢ï¼Œä»¥å¸®åŠ©ä½ ç†è§£æ•°æ®ã€‚åœ¨
  ç« èŠ‚~\ref{sec-data-visualization}
  ä¸­ï¼Œä½ å°†æ·±å…¥äº†è§£å¯è§†åŒ–ï¼Œå­¦ä¹ ggplot2å›¾å½¢çš„åŸºæœ¬ç»“æ„ï¼Œä»¥åŠå°†æ•°æ®è½¬æ¢ä¸ºå›¾å½¢çš„å¼ºå¤§æŠ€æœ¯ã€‚
\item
  ä»…ä»…å¯è§†åŒ–é€šå¸¸æ˜¯ä¸å¤Ÿçš„ï¼Œå› æ­¤åœ¨ ç« èŠ‚~\ref{sec-data-transform}
  ä¸­ï¼Œä½ å°†å­¦ä¹ å…³é”®å‡½æ•°ï¼Œè¿™äº›å…³é”®å‡½æ•°å…è®¸ä½ é€‰æ‹©é‡è¦å˜é‡ã€ç­›é€‰å…³é”®è§‚æµ‹å€¼ã€åˆ›å»ºæ–°å˜é‡å’Œè®¡ç®—æ±‡æ€»ç»Ÿè®¡é‡ã€‚
\item
  åœ¨ ç« èŠ‚~\ref{sec-data-tidy} ä¸­ï¼Œ
  ä½ å°†å­¦ä¹ æ•´ç†æ•°æ®ï¼Œè¿™æ˜¯ä¸€ç§è‡´çš„æ•°æ®å­˜å‚¨æ–¹å¼ï¼Œå¯ä»¥ä½¿æ•°æ®è½¬æ¢ã€å¯è§†åŒ–å’Œå»ºæ¨¡æ›´å®¹æ˜“ã€‚ä½ 
  å°†äº†è§£å…¶åŸºæœ¬åŸç†ï¼Œä»¥åŠå¦‚ä½•å°†æ•°æ®æ•´ç†æˆæ•´é½çš„å½¢å¼ã€‚
\item
  åœ¨è½¬æ¢å’Œå¯è§†åŒ–æ•°æ®ä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦å°†æ•°æ®å¯¼å…¥Rã€‚åœ¨
  ç« èŠ‚~\ref{sec-data-import} ä¸­å°†å­¦ä¹ æŠŠ\texttt{.csv}
  æ–‡ä»¶å¯¼å…¥Rçš„åŸºç¡€çŸ¥è¯†ã€‚
\end{itemize}

åœ¨è¿™äº›ç« èŠ‚ä¸­ï¼Œè¿˜æœ‰å¦å¤–å››ç« æ˜¯å…³äºRå·¥ä½œæµç¨‹çš„ã€‚ åœ¨
ç« èŠ‚~\ref{sec-workflow-basics}ï¼Œç« èŠ‚~\ref{sec-workflow-style} å’Œ
ç« èŠ‚~\ref{sec-workflow-scripts-projects}
ä¸­ï¼Œä½ å°†å­¦ä¹ ç¼–å†™å’Œç»„ç»‡Rä»£ç çš„è‰¯å¥½å·¥ä½œæµç¨‹ã€‚ä»
é•¿è¿œæ¥çœ‹è¿™ä¼šè®©ä½ æ›´å®¹æ˜“å–å¾—æˆåŠŸï¼Œå› ä¸ºå®ƒä»¬å°†ä¸ºä½ æä¾›åœ¨å¤„ç†å®é™…é¡¹ç›®æ—¶ä¿æŒæ¡ç†æ¸…æ™°çš„å·¥å…·ã€‚æœ€
åï¼Œç« èŠ‚~\ref{sec-workflow-getting-help} å°†æ•™ä½ å¦‚ä½•è·å¾—å¸®åŠ©å¹¶ç»§ç»­å­¦ä¹ ã€‚

\chapter{æ•°æ®å¯è§†åŒ–}\label{sec-data-visualization}

\section{å¼•è¨€}\label{ux5f15ux8a00}

\begin{quote}
``ç®€å•çš„å›¾è¡¨æ¯”ä»»ä½•å…¶ä»–å·¥å…·éƒ½èƒ½ç»™æ•°æ®åˆ†æå¸ˆå¸¦æ¥æ›´å¤šçš„ä¿¡æ¯.''

--- John Tukey
\end{quote}

Rè™½ç„¶æœ‰å‡ ä¸ªåˆ¶å›¾ç³»ç»Ÿ, ä½†ggplot2æ˜¯æœ€ä¼˜é›…ã€åŠŸèƒ½æœ€å¤šçš„ä¸€ä¸ªç³»ç»Ÿã€‚
ggplot2å®ç°äº†æè¿°å’Œæ„å»ºå›¾å½¢çš„è¿è´¯ç³»ç»Ÿï¼Œå³\textbf{å›¾å½¢çš„è¯­æ³•}ã€‚åŸº
äºggplot2ï¼Œé€šè¿‡å­¦ä¹ ä¸€ä¸ªç³»ç»Ÿå¹¶å°†å…¶åº”ç”¨äºè®¸å¤šåœ°æ–¹ï¼Œä½ å¯ä»¥åšæ›´å¤šçš„äº‹æƒ…è€Œä¸”é€Ÿåº¦æ›´å¿«ã€‚

æœ¬ç« å°†å‘Šè¯‰ä½ å¦‚ä½•åˆ©ç”¨\textbf{ggplot2}å¯è§†åŒ–æ•°æ®ã€‚æˆ‘
ä»¬å°†é¦–å…ˆåˆ›å»ºä¸€ä¸ªç®€å•çš„æ•£ç‚¹å›¾ï¼Œå¹¶ç”¨å®ƒå¼•å…¥ggplot2çš„åŸºæœ¬æ„å»ºæ¨¡å—ï¼Œç¾å­¦æ˜ å°„å’Œå‡ ä½•å¯¹è±¡ã€‚ç„¶
åå°†å¼•å¯¼ä½ å¯è§†åŒ–å•ä¸ªå˜é‡çš„åˆ†å¸ƒä»¥åŠå¯è§†åŒ–ä¸¤ä¸ªæˆ–å¤šä¸ªå˜é‡ä¹‹é—´çš„å…³ç³»ã€‚æœ€
åï¼Œä¿å­˜æ‰€åšçš„å›¾å’Œä¸€äº›æ•…éšœæ’é™¤æç¤ºã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6}

æœ¬ç« é‡ç‚¹ä»‹ç»ggplot2ï¼Œ å®ƒæ˜¯tidyverseçš„æ ¸å¿ƒåŒ…ä¹‹ä¸€ã€‚è¦
è®¿é—®æœ¬ç« ä¸­ä½¿ç”¨çš„æ•°æ®é›†ã€å¸®åŠ©é¡µå’Œå‡½æ•°ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤åŠ è½½tidyverseï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\CommentTok{\#\textgreater{} {-}{-} Attaching core tidyverse packages {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} tidyverse 2.0.0 {-}{-}}
\CommentTok{\#\textgreater{} v dplyr     1.1.4     v readr     2.1.5}
\CommentTok{\#\textgreater{} v forcats   1.0.0     v stringr   1.5.1}
\CommentTok{\#\textgreater{} v ggplot2   3.5.0     v tibble    3.2.1}
\CommentTok{\#\textgreater{} v lubridate 1.9.3     v tidyr     1.3.1}
\CommentTok{\#\textgreater{} v purrr     1.0.2     }
\CommentTok{\#\textgreater{} {-}{-} Conflicts {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} tidyverse\_conflicts() {-}{-}}
\CommentTok{\#\textgreater{} x dplyr::filter() masks stats::filter()}
\CommentTok{\#\textgreater{} x dplyr::lag()    masks stats::lag()}
\CommentTok{\#\textgreater{} i Use the conflicted package (\textless{}http://conflicted.r{-}lib.org/\textgreater{}) to force all conflicts to become errors}
\end{Highlighting}
\end{Shaded}

è¿™ä¸€è¡Œä»£ç å°†åŠ è½½ tidyverseï¼Œè¿™æ˜¯åœ¨å‡ ä¹æ‰€æœ‰æ•°æ®åˆ†æä¸­éƒ½ä¼šç”¨åˆ°çš„åŒ…ã€‚å®ƒ
è¿˜å‘Šè¯‰æ‚¨tidyverseä¸­çš„å“ªäº›å‡½æ•°ä¸base
Rä¸­çš„å‡½æ•°å†²çªï¼ˆæˆ–è€…ä¸æ‚¨å¯èƒ½åŠ è½½çš„å…¶ä»–åŒ…å†²çªï¼‰\footnote{ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨å†²çªåŒ…ï¼ˆconflicted
  packageï¼‰æ¥æ¶ˆé™¤è¯¥æ¶ˆæ¯ï¼Œå¹¶æŒ‰éœ€å¼ºåˆ¶è§£å†³å†²çªï¼Œè¿™åœ¨ä½ åŠ è½½æ›´å¤šåŒ…æ—¶å˜å¾—å°¤ä¸ºé‡è¦ã€‚å¯
  ä»¥åœ¨\href{https://conflicted.r-lib.org/}{https://conflicted.r-lib.org}ä¸Šäº†è§£æ›´å¤šå…³äºæ­¤çš„ä¿¡æ¯ã€‚}ã€‚

å¦‚æœè¿è¡Œè¿™æ®µä»£ç å¾—åˆ°äº†é”™è¯¯ä¿¡æ¯ï¼Œ\texttt{there\ is\ no\ package\ called\ \textquotesingle{}tidyverse\textquotesingle{}}ï¼Œä½ éœ€è¦å…ˆå®‰è£…å®ƒï¼Œç„¶åå†æ¬¡è¿è¡Œ\texttt{library()}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"tidyverse"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

æ¯ä¸ªåŒ…åªéœ€è¦å®‰è£…ä¸€æ¬¡ï¼Œä½†æ¯æ¬¡å¯åŠ¨æ–°ä¼šè¯æ—¶éƒ½éœ€è¦åŠ è½½å®ƒã€‚

é™¤äº†tidyverse,
æˆ‘ä»¬è¿˜ä¼šç”¨åˆ°\textbf{palmerpenguins}åŒ…ï¼Œå…¶ä¸­åŒ…å«\texttt{penguins}æ•°æ®é›†ï¼Œè®°å½•äº†Palmerç¾¤å²›ä¸‰ä¸ªå²›å±¿ä¸Šä¼é¹…çš„èº«ä½“æµ‹é‡æ•°æ®ï¼Œä»¥åŠggthemesåŒ…ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªè‰²ç›²å®‰å…¨è°ƒè‰²æ¿ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(palmerpenguins)}
\FunctionTok{library}\NormalTok{(ggthemes)}
\end{Highlighting}
\end{Shaded}

\section{ç¬¬ä¸€æ­¥}\label{ux7b2cux4e00ux6b65}

é•¿é³ä¼é¹…çš„ä½“é‡æ˜¯æ¯”çŸ­é³ä¼é¹…çš„ä½“é‡å¤§è¿˜æ˜¯å°ï¼Ÿä½ 
å¯èƒ½å·²ç»æœ‰äº†ç­”æ¡ˆï¼Œä½†è¯•ç€è®©ä½ çš„ç­”æ¡ˆæ›´ç²¾ç¡®ã€‚é³
é•¿å’Œä½“é‡ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿæ­£ ç›¸å…³è¿˜æ˜¯è´Ÿç›¸å…³ï¼Ÿçº¿ æ€§çš„è¿˜æ˜¯éçº¿æ€§çš„ï¼Ÿè¿™
ç§å…³ç³»ä¼šå› ä¼é¹…çš„ç§ç±»è€Œå¼‚å—ï¼Ÿä¼ é¹…ç”Ÿæ´»çš„å²›å±¿ä¸åŒä¼šæœ‰å½±å“å—ï¼Ÿè®©
æˆ‘ä»¬åˆ›å»ºå¯è§†åŒ–å›¾å½¢æ¥å›ç­”è¿™äº›é—®é¢˜ã€‚

\subsection{\texorpdfstring{\texttt{penguins}
æ•°æ®æ¡†}{penguins æ•°æ®æ¡†}}\label{penguins-ux6570ux636eux6846}

æ‚¨å¯ä»¥ä½¿ç”¨åŒ…palmerpenguinsï¼ˆ\texttt{palmerpenguins::penguins}ï¼‰ä¸­çš„\texttt{penguins}æ•°æ®æ¡†æ¶æ¥æµ‹è¯•ä½ å¯¹è¿™äº›é—®é¢˜çš„ç­”æ¡ˆã€‚æ•°
æ®æ¡†æ¶æ˜¯å˜é‡(åˆ—)å’Œè§‚æµ‹(è¡Œ)çš„çŸ©å½¢é›†åˆã€‚\texttt{p} \texttt{enguins}
æ”¶å½•äº†344 æ¡è§‚æµ‹ï¼Œç”±Kristen
Gormanåšå£«å’Œå—æç§‘è€ƒç«™å¸•å°”é»˜ç«™æ”¶é›†å¹¶æä¾›\footnote{Horst AM, Hill AP,
  Gorman KB (2020). palmerpenguins: Palmer Archipelago (Antarctica)
  penguin data. R package version 0.1.0.
  \url{https://allisonhorst.github.io/palmerpenguins/}. doi:
  10.5281/zenodo.3960218.}ã€‚

ä¸ºäº†ä½¿è®¨è®ºæ›´å®¹æ˜“ï¼Œè®©æˆ‘ä»¬å®šä¹‰ä¸€äº›æœ¯è¯­ï¼š

\begin{itemize}
\item
  \textbf{å˜é‡}ï¼šå˜é‡æ˜¯å¯ä»¥æµ‹é‡çš„æ•°é‡ã€è´¨é‡æˆ–å±æ€§ã€‚
\item
  \textbf{å€¼}ï¼šå€¼æ˜¯ä½ æµ‹é‡ä¸€ä¸ªå˜é‡æ—¶çš„çŠ¶æ€ï¼Œä¸€ä¸ªå˜é‡çš„å€¼å¯èƒ½ä¼šéšç€æµ‹é‡çš„ä¸åŒè€Œå˜åŒ–ã€‚
\item
  \textbf{è§‚æµ‹}ï¼šè§‚æµ‹æ˜¯åœ¨ç›¸ä¼¼æ¡ä»¶ä¸‹è¿›è¡Œçš„ä¸€ç»„æµ‹é‡ï¼ˆé€šå¸¸åœ¨ç›¸åŒçš„æ—¶é—´å’Œç›¸åŒçš„å¯¹è±¡ä¸Šè¿›è¡Œï¼‰ã€‚ä¸€
  ä¸ªè§‚æµ‹ä¼šåŒ…å«å‡ ä¸ªå€¼ï¼Œæ¯ä¸ªå€¼ä¸ä¸åŒçš„å˜é‡ç›¸å…³è”ã€‚æˆ‘
  ä»¬æœ‰æ—¶å°†ä¸€ä¸ªè§‚æµ‹ç§°ä¸ºä¸€ä¸ªæ•°æ®ç‚¹ã€‚
\item
  \textbf{è¡¨æ ¼æ•°æ®}ï¼šè¡¨æ ¼æ•°æ®æ˜¯ä¸€ç»„å€¼ï¼Œæ¯ä¸ªå€¼ä¸ä¸€ä¸ªå˜é‡å’Œä¸€ä¸ªè§‚æµ‹ç›¸å…³ã€‚å¦‚
  æœå°†æ¯ä¸ªå€¼æ”¾åœ¨è‡ªå·±çš„``å•å…ƒæ ¼''ä¸­ï¼Œå°†æ¯ä¸ªå˜é‡æ”¾åœ¨è‡ªå·±çš„åˆ—ä¸­ï¼Œå°†æ¯ä¸ªè§‚æµ‹æ”¾åœ¨è‡ªå·±çš„è¡Œä¸­ï¼Œåˆ™è¡¨æ ¼æ•°æ®æ˜¯æ•´æ´çš„ã€‚
\end{itemize}

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå˜é‡æŒ‡çš„æ˜¯æ‰€æœ‰ä¼é¹…çš„ä¸€ä¸ªå±æ€§ï¼Œè€Œè§‚æµ‹å€¼æŒ‡çš„æ˜¯å•ä¸ªä¼é¹…çš„æ‰€æœ‰å±æ€§ã€‚

åœ¨æ§åˆ¶å°ä¸­é”®å…¥æ•°æ®æ¡†çš„åç§°ï¼ŒRä¼šè¾“å‡ºå…¶å†…å®¹çš„é¢„è§ˆã€‚éœ€
è¦æ³¨æ„çš„æ˜¯è¿™ä¸ªé¢„è§ˆçš„é¡¶éƒ¨æ˜¾ç¤ºæœ‰\texttt{tibble} ã€‚åœ¨
tidyverseä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ç§°ä¸º\textbf{tibbles}çš„ç‰¹æ®Šæ•°æ®æ¡†ï¼Œéšåä½ å°†äº†è§£åˆ°æ›´å¤šã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins}
\CommentTok{\#\textgreater{} \# A tibble: 344 x 8}
\CommentTok{\#\textgreater{}   species island    bill\_length\_mm bill\_depth\_mm flipper\_length\_mm}
\CommentTok{\#\textgreater{}   \textless{}fct\textgreater{}   \textless{}fct\textgreater{}              \textless{}dbl\textgreater{}         \textless{}dbl\textgreater{}             \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 Adelie  Torgersen           39.1          18.7               181}
\CommentTok{\#\textgreater{} 2 Adelie  Torgersen           39.5          17.4               186}
\CommentTok{\#\textgreater{} 3 Adelie  Torgersen           40.3          18                 195}
\CommentTok{\#\textgreater{} 4 Adelie  Torgersen           NA            NA                  NA}
\CommentTok{\#\textgreater{} 5 Adelie  Torgersen           36.7          19.3               193}
\CommentTok{\#\textgreater{} 6 Adelie  Torgersen           39.3          20.6               190}
\CommentTok{\#\textgreater{} \# i 338 more rows}
\CommentTok{\#\textgreater{} \# i 3 more variables: body\_mass\_g \textless{}int\textgreater{}, sex \textless{}fct\textgreater{}, year \textless{}int\textgreater{}}
\end{Highlighting}
\end{Shaded}

è¿™ä¸ªæ•°æ®æ¡†åŒ…å« 8 åˆ—ã€‚å¦‚
æœä½¿ç”¨\texttt{glimpse()}ï¼Œä½ å¯ä»¥çœ‹åˆ°æ‰€æœ‰å˜é‡å’Œæ¯ä¸ªå˜é‡çš„å‰å‡ ä¸ªè§‚å¯Ÿå€¼ã€‚å¦‚
æœä½ åœ¨ä½¿ç”¨RStudioï¼Œè¿è¡Œ\texttt{View(penguins)}ä¼šæ‰“å¼€ä¸€ä¸ªäº¤äº’å¼æ•°æ®é¢„è§ˆå™¨ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{glimpse}\NormalTok{(penguins)}
\CommentTok{\#\textgreater{} Rows: 344}
\CommentTok{\#\textgreater{} Columns: 8}
\CommentTok{\#\textgreater{} $ species           \textless{}fct\textgreater{} Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, A\textasciitilde{}}
\CommentTok{\#\textgreater{} $ island            \textless{}fct\textgreater{} Torgersen, Torgersen, Torgersen, Torgersen, Torge\textasciitilde{}}
\CommentTok{\#\textgreater{} $ bill\_length\_mm    \textless{}dbl\textgreater{} 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.\textasciitilde{}}
\CommentTok{\#\textgreater{} $ bill\_depth\_mm     \textless{}dbl\textgreater{} 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.\textasciitilde{}}
\CommentTok{\#\textgreater{} $ flipper\_length\_mm \textless{}int\textgreater{} 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, \textasciitilde{}}
\CommentTok{\#\textgreater{} $ body\_mass\_g       \textless{}int\textgreater{} 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 347\textasciitilde{}}
\CommentTok{\#\textgreater{} $ sex               \textless{}fct\textgreater{} male, female, female, NA, female, male, female, m\textasciitilde{}}
\CommentTok{\#\textgreater{} $ year              \textless{}int\textgreater{} 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2\textasciitilde{}}
\end{Highlighting}
\end{Shaded}

\texttt{penguins} ä¸­çš„å˜é‡åŒ…æ‹¬ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \texttt{species}ï¼šä¼é¹…çš„ç§ç±»ï¼ˆAdelie, Chinstrap, or Gentooï¼‰
\item
  \texttt{flipper\_length\_mm}: ä¼é¹…é³çš„é•¿åº¦ï¼Œä»¥æ¯«ç±³ä¸ºå•ä½
\item
  \texttt{body\_mass\_g}: ä¼é¹…çš„ä½“é‡ï¼Œä»¥å…‹ä¸ºå•ä½ã€‚
\end{enumerate}

è¦äº†è§£æ›´å¤šå…³äº\texttt{penguins}çš„ä¿¡æ¯ï¼Œå¯ä»¥è¿è¡Œ\texttt{?penguins}æ‰“å¼€å¸®åŠ©é¡µé¢ã€‚

\subsection{æœ€ç»ˆç›®æ ‡}\label{sec-ultimate-goal}

æœ¬ç« çš„æœ€ç»ˆç›®æ ‡æ˜¯åœ¨è€ƒè™‘ä¼é¹…ç§ç±»çš„æƒ…å†µä¸‹é‡å»ºå±•ç¤ºä¼é¹…é³é•¿å’Œä½“é‡ä¹‹é—´å…³ç³»çš„è§†å›¾ã€‚

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-7-1.pdf}

\subsection{æ„å»ºggplot}\label{ux6784ux5efaggplot}

æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥é‡å»ºè¿™ä¸ªå›¾ã€‚

åˆ©ç”¨ggplot2åŒ…çš„å‡½æ•°\texttt{ggplot()}ç»˜å›¾ã€‚é¦–
å…ˆå®šä¹‰ä¸€ä¸ªç»˜å›¾å¯¹è±¡ï¼Œç„¶åå‘å…¶æ·»åŠ \textbf{å›¾å±‚}ã€‚
\texttt{ggplot()}çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åœ¨å›¾ä¸­ä½¿ç”¨çš„æ•°æ®é›†ï¼Œå› æ­¤\texttt{ggplot(data\ =\ penguins)}åˆ›å»ºäº†ä¸€ä¸ªç©ºå›¾ï¼Œç”¨äºæ˜¾ç¤º\texttt{penguins}æ•°æ®ï¼Œä½†ç”±äºæˆ‘ä»¬è¿˜æ²¡æœ‰å‘Šè¯‰å®ƒå¦‚ä½•å¯è§†åŒ–å®ƒï¼Œæ‰€ä»¥ç°åœ¨å®ƒæ˜¯ç©ºçš„ã€‚è¿™
ä¸æ˜¯ä¸€ä¸ªå¯ä»¥è®©äººåŠ¨å¿ƒçš„å›¾ï¼Œä½†ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€å—ç©ºç™½ç”»å¸ƒï¼Œä½ å¯ä»¥åœ¨ä¸Šé¢ç”»å‡ºå‰©ä¸‹çš„å›¾å±‚ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ penguins)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-8-1.pdf}

æ¥ä¸‹æ¥ï¼Œéœ€è¦å‘Šè¯‰\texttt{ggplot()}å¦‚ä½•å°†æ•°æ®ä¸­çš„ä¿¡æ¯ä»¥è§†è§‰æ–¹å¼å‘ˆç°ã€‚
\texttt{ggplot()}å‡½æ•°çš„\texttt{mapping}
å‚æ•°å®šä¹‰äº†æ•°æ®é›†ä¸­çš„å˜é‡å¦‚ä½•æ˜ å°„åˆ°å›¾è¡¨çš„è§†è§‰å±æ€§ï¼ˆ\textbf{aesthetics}ï¼‰ã€‚
\texttt{mapping}å‚æ•°æ€»æ˜¯åœ¨\texttt{aes()}å‡½æ•°ä¸­å®šä¹‰ï¼Œè€Œ\texttt{aes()}çš„\texttt{x}å’Œ\texttt{y}å‚æ•°åˆ™æŒ‡å®šäº†å“ªäº›å˜é‡æ˜ å°„åˆ°xè½´å’Œyè½´ä¸Šã€‚ç°
åœ¨ï¼Œæˆ‘ä»¬åªå°†é³é•¿æ˜ å°„åˆ°\texttt{x}è½´çš„ç¾å­¦å±æ€§ä¸Šï¼Œå°†ä½“é‡æ˜ å°„åˆ°\texttt{y}è½´çš„ç¾å­¦å±æ€§ä¸Šã€‚g
gplot2ä¼šåœ¨æ•°æ®å‚æ•°ä¸­æŸ¥æ‰¾æ˜ å°„çš„å˜é‡ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­å°±æ˜¯\texttt{penguins}ã€‚

ä¸‹å›¾æ˜¾ç¤ºäº†æ·»åŠ è¿™äº›æ˜ å°„çš„ç»“æœã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}
  \AttributeTok{data =}\NormalTok{ penguins,}
  \AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-9-1.pdf}

ç©ºç”»å¸ƒç°åœ¨æœ‰äº†æ›´å¤šæ„é€ ï¼Œæˆ‘ä»¬å·²æ¸…æ¥šçŸ¥é“é³çš„é•¿åº¦åœ¨å“ªé‡Œæ˜¾ç¤ºï¼ˆxè½´ï¼‰ï¼Œèº«ä½“è´¨é‡åœ¨å“ªé‡Œæ˜¾ç¤ºï¼ˆyè½´ï¼‰ã€‚ä½†
\texttt{penguins}æœ¬èº«è¿˜æ²¡æœ‰å‡ºç°åœ¨å›¾ä¸­ã€‚è¿™
æ˜¯å› ä¸ºåœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰æ˜ç¡®è¯´æ˜å¦‚ä½•åœ¨å›¾ä¸Šè¡¨ç¤ºæ¥è‡ªæ•°æ®æ¡†æ¶çš„è§‚æµ‹ã€‚

ä¸ºæ­¤æˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ª\textbf{geom}ï¼ˆå‡ ä½•å¯¹è±¡ï¼‰ï¼Œgeomæ˜¯ä¸€ä¸ªç”¨æ¥è¡¨ç¤ºæ•°æ®çš„å›¾å½¢ã€‚è¿™
äº›geomåœ¨ggplot2ä¸­ä½¿ç”¨ä»¥\texttt{geom\_}å¼€å¤´çš„å‡½æ•°ã€‚æˆ‘
ä»¬é€šå¸¸åˆ©ç”¨å›¾ä½¿ç”¨çš„geomç±»å‹æ¥æç»˜å›¾å½¢ã€‚ä¾‹
å¦‚ï¼Œæ¡å½¢å›¾ä½¿ç”¨\texttt{geom\_bar()}ï¼ŒæŠ˜çº¿å›¾ä½¿ç”¨\texttt{geom\_line()}ï¼Œç®±å½¢å›¾ä½¿ç”¨\texttt{geom\_boxplot()}ï¼Œæ•£ç‚¹å›¾ä½¿ç”¨\texttt{geom\_point()}ï¼Œç­‰ç­‰ã€‚

å‡½æ•°\texttt{geom\_point()}ä¸ºå›¾æ·»åŠ äº†ä¸€ä¸ªç‚¹å›¾å±‚ï¼Œä»è€Œåˆ›å»ºäº†æ•£ç‚¹å›¾ã€‚g
gplot2é™„å¸¦äº†è®¸å¤šgeomå‡½æ•°ï¼Œæ¯ä¸ªå‡½æ•°éƒ½ä¸ºç»˜å›¾æ·»åŠ ä¸åŒç±»å‹çš„å±‚ã€‚
ä½ å°†åœ¨ä¹¦ä¸­å­¦åˆ°å¾ˆå¤šgeomï¼Œç‰¹åˆ«æ˜¯åœ¨ ç« èŠ‚~\ref{sec-layers} ä¸­ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}
  \AttributeTok{data =}\NormalTok{ penguins,}
  \AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g)}
\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\CommentTok{\#\textgreater{} Warning: Removed 2 rows containing missing values or values outside the scale range}
\CommentTok{\#\textgreater{} (\textasciigrave{}geom\_point()\textasciigrave{}).}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-10-1.pdf}

ç°åœ¨æˆ‘ä»¬å¾—åˆ°äº†ä¸€äº›æˆ‘ä»¬å¯èƒ½è®¤ä¸ºæ˜¯``æ•£ç‚¹å›¾''çš„ä¸œè¥¿ï¼Œä½†è¿™è¿˜ä¸æ˜¯æˆ‘ä»¬çš„``æœ€ç»ˆç›®æ ‡''ã€‚ä½†
åˆ©ç”¨è¿™ä¸ªå›¾å¯ä»¥å¼€å§‹å›ç­”å½“åˆæ¿€å‘æˆ‘ä»¬æ¢ç´¢å…´è¶£çš„é—®é¢˜ï¼š``é³é•¿å’Œä½“é‡ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆ?''
è¿™ç§å…³ç³»ä¼¼ä¹æ˜¯æ­£çš„ï¼ˆéšç€é³çš„é•¿åº¦å¢åŠ ä½“é‡ä¹Ÿä¼šå¢åŠ ï¼‰ï¼Œå‘ˆçº¿æ€§ï¼ˆè¿™äº›ç‚¹èšé›†åœ¨ä¸€æ¡ç›´çº¿ä¸Šï¼Œè€Œä¸æ˜¯ä¸€æ¡æ›²çº¿ï¼‰ï¼Œä¸”çº¿æ€§å…³ç³»æ¯”è¾ƒå¼ºï¼ˆåœ¨è¿™æ ·ä¸€æ¡ç›´çº¿å‘¨å›´æ²¡æœ‰å¤ªå¤šçš„å‘æ•£ç‚¹)ã€‚å°±ä½“é‡è€Œè¨€ï¼Œè„šè¹¼è¾ƒé•¿çš„ä¼é¹…é€šå¸¸ä½“å‹è¾ƒå¤§ã€‚

åœ¨æ·»åŠ æ›´å¤šå›¾å±‚åˆ°è¿™ä¸ªå›¾ä¹‹å‰ï¼Œè®©æˆ‘ä»¬æš‚åœä¸€ä¸‹ï¼Œå›é¡¾ä¸€ä¸‹æˆ‘ä»¬å¾—åˆ°çš„è­¦å‘Šä¿¡æ¯ï¼š

\begin{quote}
Removed 2 rows containing missing values (\texttt{geom\_point()}).
\end{quote}

æˆ‘ä»¬çœ‹åˆ°è¿™æ¡ä¿¡æ¯æ˜¯å› ä¸ºæˆ‘ä»¬çš„æ•°æ®é›†ä¸­æœ‰ä¸¤åªä¼é¹…ç¼ºå°‘ä½“é‡å’Œï¼ˆæˆ–ï¼‰é³é•¿å€¼ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸¤ä¸ªå€¼ï¼Œggplot2æ— æ³•åœ¨å›¾ä¸Šè¡¨ç¤ºå®ƒä»¬ã€‚åƒ
Rä¸€æ ·ï¼Œggplot2ä¹Ÿç§‰æ‰¿è¿™æ ·ä¸€ç§ç†å¿µï¼šç¼ºå¤±å€¼æ°¸è¿œä¸åº”è¯¥æ— å£°åœ°æ¶ˆå¤±ã€‚è¿™
ç§ç±»å‹çš„è­¦å‘Šå¯èƒ½æ˜¯ä½ åœ¨å¤„ç†å®é™…æ•°æ®æ—¶æœ€å¸¸è§çš„è­¦å‘Šç±»å‹ä¹‹ä¸€ã€‚ç¼º
å¤±å€¼æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„é—®é¢˜ï¼Œä½ å°†åœ¨æœ¬ä¹¦ä¸­äº†è§£æ›´å¤šå…³äºå®ƒä»¬çš„ä¿¡æ¯ï¼Œç‰¹åˆ«æ˜¯åœ¨
ç« èŠ‚~\ref{sec-missing-values} ä¸­ã€‚å¯¹
äºæœ¬ç« å‰©ä¸‹çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†å¿½ç•¥è¿™ä¸ªè­¦å‘Šï¼Œè¿™æ ·å®ƒå°±ä¸ä¼šå‡ºç°åœ¨æˆ‘ä»¬åˆ¶ä½œçš„æ¯ä¸ªå›¾çš„æ—è¾¹ã€‚

\subsection{æ·»åŠ ç¾å­¦å’Œå›¾å±‚}\label{sec-adding-aesthetics-layers}

æ•£ç‚¹å›¾å¯¹äºå±•ç¤ºä¸¤ä¸ªæ•°å€¼å˜é‡ä¹‹é—´çš„å…³ç³»éå¸¸æœ‰ç”¨ï¼Œä½†æ˜¯å¯¹äºä¸¤ä¸ªå˜é‡ä¹‹é—´ä»»ä½•æ˜æ˜¾çš„å…³ç³»éƒ½åº”æŒæ€€ç–‘æ€åº¦ï¼Œå¹¶è¯¢é—®æ˜¯å¦æœ‰å…¶ä»–å˜é‡å¯ä»¥è§£é‡Šæˆ–æ”¹å˜è¿™ç§æ˜æ˜¾å…³ç³»çš„æ€§è´¨ï¼Œè¿™æ€»æ˜¯ä¸€ä¸ªå¥½çš„æ€è·¯ã€‚ä¾‹
å¦‚ï¼Œä¸åŒç‰©ç§çš„é³é•¿å’Œä½“é‡çš„å…³ç³»æ˜¯å¦æœ‰æ‰€ä¸åŒï¼Ÿè®©
æˆ‘ä»¬å°†ç‰©ç§çº³å…¥å›¾ä¸­ï¼Œçœ‹çœ‹è¿™æ˜¯å¦èƒ½æ­ç¤ºå‡ºè¿™äº›å˜é‡ä¹‹é—´æ˜æ˜¾å…³ç³»çš„ä»»ä½•é¢å¤–è§è§£ã€‚æˆ‘
ä»¬é€šè¿‡ä½¿ç”¨ä¸åŒé¢œè‰²çš„ç‚¹ä»£è¡¨ä¸åŒç‰©ç§æ¥å®ç°è¿™ä¸€ç‚¹ã€‚

ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ç¾å­¦è¿˜æ˜¯geomï¼Ÿå¦‚
æœä½ çŒœæµ‹æ˜¯å‡½æ•°\texttt{aes()}
å†…çš„ç¾å­¦æ˜ å°„ï¼Œé‚£ä¹ˆè¡¨æ˜ä½ å·²ç»æŒæ¡äº†ä½¿ç”¨ggplot2è¿›è¡Œæ•°æ®å¯è§†åŒ–çš„æ–¹æ³•ï¼
å¦‚æœä¸æ˜¯è¿™æ ·ä¹Ÿä¸ç”¨æ‹…å¿ƒï¼Œ
åœ¨æœ¬ä¹¦ä¸­ä½ å°†åˆ¶ä½œæ›´å¤šçš„ggplotå›¾ï¼Œåœ¨åˆ¶å›¾çš„è¿‡ç¨‹ä¸­æœ‰å¾ˆå¤šæœºä¼šéªŒè¯ä½ çš„ç›´è§‰ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}
  \AttributeTok{data =}\NormalTok{ penguins,}
  \AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g, }\AttributeTok{color =}\NormalTok{ species)}
\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-11-1.pdf}

å½“åˆ†ç±»å˜é‡è¢«æ˜ å°„åˆ°ç¾å­¦ä¸Šæ—¶ï¼Œggplot2å°†è‡ªåŠ¨ä¸ºå˜é‡çš„æ¯ä¸ªæ°´å¹³ï¼ˆä¸‰ä¸ªç‰©ç§ä¸­çš„ä¸€ä¸ªï¼‰åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„ç¾å­¦å€¼ï¼ˆè¿™é‡Œæ˜¯æŸç§é¢œè‰²ï¼‰ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸º\textbf{scaling}ã€‚g
gplot2è¿˜å°†æ·»åŠ ä¸€ä¸ªå›¾ä¾‹ï¼Œè§£é‡Šå“ªäº›å€¼å¯¹åº”äºå“ªäº›æ°´å¹³ã€‚

ç°åœ¨è®©æˆ‘ä»¬å†æ·»åŠ ä¸€å±‚ï¼šä¸€æ¡æ˜¾ç¤ºä½“é‡å’Œé³é•¿ä¹‹é—´å…³ç³»çš„å¹³æ»‘æ›²çº¿ã€‚åœ¨
ç»§ç»­ä¹‹å‰è¯·å‚è€ƒä¸Šé¢çš„ä»£ç ï¼Œå¹¶è€ƒè™‘å¦‚ä½•å°†å…¶æ·»åŠ åˆ°ç°æœ‰çš„å›¾ä¸­ã€‚

ç”±äºè¿™æ˜¯ä¸€ä¸ªä»£è¡¨æ•°æ®çš„æ–°geomï¼Œæˆ‘ä»¬å°†åœ¨æˆ‘ä»¬çš„ç‚¹å‡ ä½•ä¸Šæ·»åŠ ä¸€ä¸ªæ–°çš„geomä½œä¸ºå›¾å±‚ï¼š\texttt{geom\_smooth()}ã€‚æˆ‘
ä»¬å°†æŒ‡å®šåŸºäº\texttt{method\ =\ "lm"}çš„çº¿æ€§æ¨¡å‹ï¼ˆ\texttt{l}inear
\texttt{m}odelï¼‰ç»˜åˆ¶æœ€ä½³æ‹Ÿåˆç›´çº¿ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}
  \AttributeTok{data =}\NormalTok{ penguins,}
  \AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g, }\AttributeTok{color =}\NormalTok{ species)}
\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"lm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-12-1.pdf}

æˆ‘ä»¬å·²ç»æˆåŠŸåœ°æ·»åŠ äº†ç›´çº¿ï¼Œä½†æ˜¯è¿™ä¸ªå›¾å’Œç¬¬ å°èŠ‚~\ref{sec-ultimate-goal}
èŠ‚ä¸­çš„å›¾çœ‹èµ·æ¥å¹¶ä¸åƒï¼Œé‚£é‡Œçš„å›¾å½¢æ•´ä¸ªæ•°æ®é›†åªæœ‰ä¸€æ¡ç›´çº¿ï¼Œè€Œè¿™é‡Œæ¯ä¸ªç‰©ç§éƒ½æœ‰å•ç‹¬çš„ä¸€æ¡ç›´çº¿ã€‚

åœ¨\texttt{ggplot()}ä¸­å®šä¹‰çš„ç¾å­¦æ˜ å°„ï¼ˆaesthetic
mappingsï¼‰åœ¨å…¨å±€çº§åˆ«æ—¶ï¼Œä¼šè¢«ä¼ é€’åˆ°å›¾çš„æ¯ä¸€ä¸ªåç»­çš„å‡ ä½•å±‚ï¼ˆgeom
layersï¼‰ã€‚ç„¶ è€Œï¼Œggplot2 ä¸­çš„æ¯ä¸ªgeomå‡½æ•°ä¹Ÿå¯ä»¥æ¥å—ä¸€ä¸ªæ˜ å°„å‚æ•°ï¼ˆmapping
argumentï¼‰ï¼Œè¿™å…è®¸åœ¨å±€éƒ¨çº§åˆ«å®šä¹‰ç¾å­¦æ˜ å°„ï¼Œè¿™äº›æ˜ å°„ä¼šæ·»åŠ åˆ°ä»å…¨å±€çº§åˆ«ç»§æ‰¿çš„æ˜ å°„ä¸­ã€‚ç”±
äºæˆ‘ä»¬å¸Œæœ›ç‚¹ï¼ˆpointsï¼‰çš„é¢œè‰²åŸºäºç‰©ç§ï¼ˆspeciesï¼‰æ¥è®¾ç½®ï¼Œä½†ä¸æƒ³ä¸ºå®ƒä»¬å°†çº¿ï¼ˆlinesï¼‰åˆ†å¼€ï¼Œæˆ‘ä»¬åº”è¯¥åªåœ¨\texttt{geom\_point()}ä¸­æŒ‡å®š\texttt{color\ =\ species}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}
  \AttributeTok{data =}\NormalTok{ penguins,}
  \AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g)}
\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ species)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"lm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-13-1.pdf}

ç§!æˆ‘ ä»¬æœ‰äº†ä¸€äº›çœ‹èµ·æ¥å¾ˆåƒæˆ‘ä»¬æœ€ç»ˆç›®æ ‡çš„ä¸œè¥¿ï¼Œå°½ç®¡å®ƒè¿˜ä¸å®Œç¾ã€‚æˆ‘
ä»¬ä»ç„¶éœ€è¦ä¸ºæ¯ç§ä¼é¹…ä½¿ç”¨ä¸åŒçš„å½¢çŠ¶ï¼Œå¹¶æ”¹è¿›æ ‡ç­¾ã€‚

åœ¨å›¾è¡¨ä¸Šä»…ä½¿ç”¨é¢œè‰²æ¥è¡¨ç¤ºä¿¡æ¯é€šå¸¸ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œå› ä¸ºç”±äºè‰²ç›²æˆ–å…¶ä»–è‰²è§‰å·®å¼‚ï¼Œäººä»¬å¯¹é¢œè‰²çš„æ„ŸçŸ¥ä¼šæœ‰æ‰€ä¸åŒã€‚å› 
æ­¤ï¼Œé™¤äº†é¢œè‰²ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å°†\texttt{ç‰©ç§}æ˜ å°„åˆ°\texttt{å½¢çŠ¶}ç¾å­¦ä¸Šã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}
  \AttributeTok{data =}\NormalTok{ penguins,}
  \AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g)}
\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ species, }\AttributeTok{shape =}\NormalTok{ species)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"lm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-14-1.pdf}

æ³¨æ„ï¼Œå›¾ä¾‹ä¹Ÿä¼šè‡ªåŠ¨æ›´æ–°ä»¥åæ˜ ç‚¹çš„ä¸åŒå½¢çŠ¶ã€‚

æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨\texttt{labs()}å‡½æ•°åœ¨ä¸€ä¸ªæ–°çš„å±‚ä¸­æ”¹è¿›å›¾çš„æ ‡ç­¾ã€‚\texttt{l}
\texttt{abs()}å‡½æ•°çš„ä¸€äº›å‚æ•°å«ä¹‰æ˜¯ä¸è¨€è‡ªæ˜çš„ï¼š\texttt{title}ç”¨äºæ·»åŠ æ ‡é¢˜ï¼Œ\texttt{subtitle}ç”¨äºæ·»åŠ å‰¯æ ‡é¢˜ã€‚å…¶
ä»–å‚æ•°ä¸ç¾å­¦æ˜ å°„ç›¸å¯¹åº”ï¼Œ\texttt{x}æ˜¯xè½´çš„æ ‡ç­¾ï¼Œ\texttt{y}æ˜¯yè½´çš„æ ‡ç­¾ï¼Œè€Œ\texttt{color}å’Œ\texttt{shape}åˆ™å®šä¹‰äº†å›¾ä¾‹ä¸­çš„æ ‡ç­¾ã€‚æ­¤
å¤–ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¥è‡ªggthemesåŒ…çš„\texttt{scale\_color\_colorblind()}å‡½æ•°æ¥æ”¹è¿›é¢œè‰²è°ƒè‰²æ¿ï¼Œä»¥ç¡®ä¿å®ƒå¯¹è‰²ç›²ç”¨æˆ·ä¹Ÿæ˜¯å®‰å…¨çš„ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}
  \AttributeTok{data =}\NormalTok{ penguins,}
  \AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g)}
\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ species, }\AttributeTok{shape =}\NormalTok{ species)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"lm"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Body mass and flipper length"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"Dimensions for Adelie, Chinstrap, and Gentoo Penguins"}\NormalTok{,}
    \AttributeTok{x =} \StringTok{"Flipper length (mm)"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Body mass (g)"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"Species"}\NormalTok{, }\AttributeTok{shape =} \StringTok{"Species"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_colorblind}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-15-1.pdf}

æˆ‘ä»¬ç»ˆäºæœ‰äº†ä¸€ä¸ªå®Œå…¨ç¬¦åˆæˆ‘ä»¬``æœ€ç»ˆç›®æ ‡''çš„å›¾å½¢!

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \texttt{penguins}æœ‰å¤šå°‘è¡Œï¼Ÿå¤š å°‘åˆ—ï¼Ÿ
\item
  æ•°æ®æ¡† \texttt{penguins} ä¸­çš„ \texttt{bill\_depth\_mm}å˜é‡æ˜¯ä»€ä¹ˆï¼Ÿé˜…
  è¯» \texttt{?penguins} çš„å¸®åŠ©æ–‡ä»¶åæ‰¾åˆ°ç­”æ¡ˆï¼›
\item
  åˆ¶ä½œ \texttt{bill\_depth\_mm} å’Œ \texttt{bill\_length\_mm}
  çš„æ•£ç‚¹å›¾ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ›å»ºä¸€ä¸ªæ•£ç‚¹å›¾ï¼Œyè½´ä¸º\texttt{bill\_depth\_mm},
  xè½´ä¸º\texttt{bill\_length\_mm}ã€‚æ è¿°è¿™ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„å…³ç³»ï¼›
\item
  å¦‚æœä½ åšä¸€ä¸ª\texttt{species}ä¸\texttt{bill\_depth\_mm}çš„æ•£ç‚¹å›¾ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä»€
  ä¹ˆå‡ ä½•å¯¹è±¡æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Ÿ
\item
  ä¸ºä»€ä¹ˆä¸‹é¢çš„ä»£ç ä¼šç»™å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå¦‚ä½•ä¿®å¤å®ƒ?

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ penguins) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}
\item
  \texttt{na.rm}å‚æ•°åœ¨\texttt{geom\_point()}ä¸­èµ·ä»€ä¹ˆä½œç”¨ï¼Ÿè¿™
  ä¸ªå‚æ•°çš„é»˜è®¤å€¼æ˜¯ä»€ä¹ˆï¼Ÿåˆ›
  å»ºä¸€ä¸ªæ•£ç‚¹å›¾ï¼Œå¹¶åœ¨å…¶ä¸­å°†è¿™ä¸ªå‚æ•°è®¾ç½®ä¸º\texttt{TRUE}ã€‚
\item
  åœ¨ä½ ä¹‹å‰ç»ƒä¹ çš„å›¾ä¸­æ·»åŠ ä»¥ä¸‹æ ‡é¢˜ï¼š``æ•°æ®æ¥è‡ª palmerpenguins åŒ…ã€‚''
  æç¤ºï¼šæŸ¥çœ‹\texttt{labs()}å‡½æ•°çš„æ–‡æ¡£ã€‚
\item
  é‡æ–°åˆ›å»ºä»¥ä¸‹å¯è§†åŒ–ã€‚\texttt{b}
  \texttt{ill\_depth\_mm}åº”è¯¥æ˜ å°„åˆ°å“ªä¸ªç¾å­¦å±æ€§ä¸Šï¼Ÿå®ƒ
  åº”è¯¥åœ¨å…¨å±€çº§åˆ«æ˜ å°„è¿˜æ˜¯åœ¨å‡ ä½•å¯¹è±¡çº§åˆ«æ˜ å°„ï¼Ÿ

  \includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-17-1.pdf}
\item
  åœ¨å¤´è„‘ä¸­è¿è¡Œè¿™æ®µä»£ç ï¼Œé¢„æµ‹è¾“å‡ºå°†æ˜¯ä»€ä¹ˆæ ·å­ï¼›ç„¶ååœ¨Rä¸­è¿è¡Œä»£ç å¹¶æ£€æŸ¥ä½ çš„é¢„æµ‹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}
  \AttributeTok{data =}\NormalTok{ penguins,}
  \AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g, }\AttributeTok{color =}\NormalTok{ island)}
\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  è¿™ä¸¤å¼ å›¾çœ‹èµ·æ¥ä¼šä¸åŒå—ï¼Ÿä¸º ä»€ä¹ˆç›¸åŒ/ä¸ºä»€ä¹ˆä¸åŒï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}
  \AttributeTok{data =}\NormalTok{ penguins,}
  \AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g)}
\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{()}

\FunctionTok{ggplot}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}
    \AttributeTok{data =}\NormalTok{ penguins,}
    \AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g)}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}
    \AttributeTok{data =}\NormalTok{ penguins,}
    \AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{ggplot2 è°ƒç”¨}\label{sec-ggplot2-calls}

éšç€ä»å…¥é—¨éƒ¨åˆ†å­¦ä¹ çš„æ·±å…¥ï¼Œæˆ‘ä»¬å°†è¿‡æ¸¡åˆ°æ›´ç®€æ´çš„ ggplot2 ä»£ç è¡¨è¾¾å¼ã€‚åˆ°
ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»éå¸¸æ˜ç¡®äº†ï¼Œç®€åŒ–ä»£ç å¯¹ä½ çš„å­¦ä¹ æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}
  \AttributeTok{data =}\NormalTok{ penguins,}
  \AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g)}
\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

é€šå¸¸ï¼Œå‡½æ•°çš„å‰ä¸€ä¸¤ä¸ªå‚æ•°éå¸¸é‡è¦ï¼Œä½ åº”è¯¥ç‰¢è®°å®ƒä»¬ã€‚åœ¨
\texttt{ggplot()}ä¸­ï¼Œå‰ä¸¤ä¸ªå‚æ•°æ˜¯\texttt{data}å’Œ\texttt{mapping}ï¼Œåœ¨æœ¬ä¹¦çš„å‰©ä½™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†ä¸å†æä¾›è¿™äº›å‚æ•°çš„åç§°ã€‚è¿™
æ ·æ—¢èŠ‚çœæ‰“å­—æ—¶é—´ï¼Œåˆå¯é€šè¿‡å‡å°‘é¢å¤–æ–‡å­—ï¼Œæ›´å®¹æ˜“åœ°çœ‹å‡ºä¸åŒå›¾ä¹‹é—´çš„å·®å¼‚ã€‚è¿™
æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç¼–ç¨‹å…³æ³¨ç‚¹ï¼Œæˆ‘ä»¬å°†åœ¨ ç« èŠ‚~\ref{sec-functions}
ä¸­å†æ¬¡è®¨è®ºã€‚

å°†å‰é¢çš„å›¾æ›´ç®€æ´åœ°é‡å†™ä¸ºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

åœ¨å°†æ¥ï¼Œæ‚¨è¿˜å°†äº†è§£ç®¡é“\texttt{\textbar{}\textgreater{}}ï¼Œå®ƒå°†å…è®¸ä½ ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºè¯¥å›¾å½¢:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\section{å¯è§†åŒ–åˆ†å¸ƒ}\label{ux53efux89c6ux5316ux5206ux5e03}

å¦‚ä½•å¯è§†åŒ–å˜é‡çš„åˆ†å¸ƒå–å†³äºå˜é‡çš„ç±»å‹ï¼šåˆ†ç±»è¿˜æ˜¯æ•°å€¼ã€‚

\subsection{åˆ†ç±»å˜é‡}\label{ux5206ux7c7bux53d8ux91cf}

å¦‚æœä¸€ä¸ªå˜é‡åªèƒ½å–ä¸€å°ç»„å€¼ä¸­çš„ä¸€ä¸ªï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯åˆ†ç±»å˜é‡ã€‚è¦
æ£€æŸ¥åˆ†ç±»å˜é‡çš„åˆ†å¸ƒï¼Œå¯ä»¥ä½¿ç”¨æ¡å½¢å›¾ã€‚æ¡
å½¢å›¾çš„é«˜åº¦æ˜¾ç¤ºäº†æ¯ä¸ª\texttt{x}å€¼çš„è§‚æµ‹æ¬¡æ•°ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ species)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-23-1.pdf}

åœ¨å…·æœ‰éæœ‰åºæ°´å¹³çš„åˆ†ç±»å˜é‡çš„æ¡å½¢å›¾ä¸­ï¼Œå¦‚ä¸Šé¢æåˆ°çš„ä¼é¹…\textbf{ç‰©ç§}ï¼Œé€šå¸¸æ›´å¯å–æ€è·¯çš„æ˜¯æ ¹æ®å®ƒä»¬çš„é¢‘ç‡é‡æ–°æ’åºæ¡å½¢å›¾ã€‚è¿™
æ ·åšéœ€è¦å°†å˜é‡è½¬æ¢ä¸ºå› å­(Rå¦‚ä½•å¤„ç†åˆ†ç±»æ•°æ®)ï¼Œç„¶åé‡æ–°æ’åºè¯¥å› å­çš„æ°´å¹³ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{fct\_infreq}\NormalTok{(species))) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-24-1.pdf}

æ‚¨å°†åœ¨@sec-factors
ä¸­å­¦åˆ°æ›´å¤šå…³äºå› å­å’Œå¤„ç†å› å­çš„å‡½æ•°ï¼ˆå¦‚ä¸Šé¢ç”¨åˆ°çš„\texttt{fct\_infreq()}ï¼‰ã€‚

\subsection{æ•°å€¼å˜é‡}\label{ux6570ux503cux53d8ux91cf}

å¦‚æœä¸€ä¸ªå˜é‡å¯ä»¥åœ¨ä¸€ä¸ªå¤§çš„æ•°å€¼èŒƒå›´å†…å–å€¼ï¼Œå¹¶ä¸”å¯¹è¿™äº›æ•°å€¼è¿›è¡ŒåŠ ã€å‡æˆ–å–å¹³å‡æ•°æ˜¯æœ‰æ„ä¹‰çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡å°±æ˜¯æ•°å€¼å‹ï¼ˆæˆ–å®šé‡å‹ï¼‰çš„ã€‚æ•°
å€¼å‹å˜é‡å¯ä»¥æ˜¯è¿ç»­çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç¦»æ•£çš„ã€‚

ä¸€ä¸ªå¸¸ç”¨äºè¿ç»­å˜é‡åˆ†å¸ƒçš„å¯è§†åŒ–æ–¹æ³•æ˜¯ç›´æ–¹å›¾ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ body\_mass\_g)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{200}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-25-1.pdf}

ç›´æ–¹å›¾å°†xè½´åˆ†æˆç­‰é—´è·çš„åŒºé—´ï¼ˆæˆ–ç§°ä¸º``ç®±''ï¼‰ï¼Œç„¶åä½¿ç”¨æ¡å½¢çš„é«˜åº¦æ¥æ˜¾ç¤ºè½åœ¨æ¯ä¸ªåŒºé—´å†…çš„è§‚å¯Ÿå€¼çš„æ•°é‡ã€‚åœ¨
ä¸Šé¢çš„å›¾ä¸­ï¼Œæœ€é«˜çš„æ¡å½¢è¡¨ç¤ºæœ‰39ä¸ªè§‚å¯Ÿå€¼çš„\texttt{body\_mass\_g}å€¼åœ¨3,500å…‹åˆ°3,700å…‹ä¹‹é—´ï¼Œè¿™æ˜¯æ¡å½¢çš„å·¦å³è¾¹ç¼˜ã€‚

ä½ å¯ä»¥ä½¿ç”¨binwidthå‚æ•°æ¥è®¾ç½®ç›´æ–¹å›¾ä¸­åŒºé—´çš„å®½åº¦ï¼Œè¿™ä¸ªå‚æ•°æ˜¯ä»¥\texttt{x}å˜é‡çš„å•ä½æ¥è¡¡é‡çš„ã€‚å½“
ä½¿ç”¨ç›´æ–¹å›¾æ—¶ï¼Œä½ åº”è¯¥æ¢ç´¢ä¸åŒçš„åŒºé—´å®½åº¦ï¼Œå› ä¸ºä¸åŒçš„åŒºé—´å®½åº¦å¯èƒ½ä¼šæ­ç¤ºä¸åŒçš„æ¨¡å¼ã€‚åœ¨
ä¸‹é¢çš„å›¾ä¸­ï¼ŒåŒºé—´å®½åº¦ä¸º20å¤ªçª„äº†ï¼Œå¯¼è‡´æ¡å½¢å¤ªå¤šï¼Œä½¿å¾—éš¾ä»¥ç¡®å®šåˆ†å¸ƒçš„å½¢çŠ¶ã€‚ç±»
ä¼¼åœ°ï¼ŒåŒºé—´å®½åº¦ä¸º2,000å¤ªé«˜äº†ï¼Œå¯¼è‡´æ‰€æœ‰æ•°æ®åªè¢«åˆ†åˆ°ä¸‰ä¸ªæ¡å½¢ä¸­ï¼Œä¹Ÿéš¾ä»¥ç¡®å®šåˆ†å¸ƒçš„å½¢çŠ¶ã€‚åŒº
é—´å®½åº¦å–200è¾¾åˆ°äº†åˆç†çš„å¹³è¡¡ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ body\_mass\_g)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{20}\NormalTok{)}
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ body\_mass\_g)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{2000}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-26-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-26-2.pdf}\end{minipage}%

\end{figure}%

æ•°å€¼å˜é‡åˆ†å¸ƒçš„å¦ä¸€ç§å¯è§†åŒ–æ–¹å¼æ˜¯å¯†åº¦å›¾ã€‚å¯†
åº¦å›¾æ˜¯ç›´æ–¹å›¾çš„å¹³æ»‘ç‰ˆæœ¬ï¼Œæ˜¯è¿ç»­æ•°æ®çš„å®ç”¨æ›¿ä»£æ–¹æ¡ˆï¼Œç‰¹åˆ«æ˜¯å½“æ•°æ®æ¥è‡ªä¸€ä¸ªæ½œåœ¨çš„å¹³æ»‘åˆ†å¸ƒæ—¶ã€‚æˆ‘
ä»¬ä¸ä¼šæ·±å…¥äº†è§£\texttt{geom\_density()}å¦‚ä½•ä¼°è®¡å¯†åº¦ï¼ˆä½ å¯ä»¥åœ¨å‡½æ•°æ–‡æ¡£ä¸­äº†è§£æ›´å¤šï¼‰ï¼Œä½†æˆ‘ä»¬å¯é€šè¿‡ä¸€ä¸ªç±»æ¯”æ¥è§£é‡Šå¦‚ä½•ç»˜åˆ¶å¯†åº¦æ›²çº¿ã€‚æƒ³
è±¡ä¸€ä¸ªç”±æœ¨å—åˆ¶æˆçš„ç›´æ–¹å›¾ï¼Œç„¶åæƒ³è±¡ä½ åœ¨ç›´æ–¹å›¾ä¸Šæ”¾ä¸‹ä¸€æ ¹ç…®ç†Ÿçš„é¢æ¡ï¼Œé¢æ¡åœ¨æœ¨å—ä¸ŠæŠ«æŒ‚çš„å½¢çŠ¶å¯ä»¥çœ‹ä½œæ˜¯å¯†åº¦æ›²çº¿çš„å½¢çŠ¶ã€‚ä¸
ç›´æ–¹å›¾ç›¸æ¯”ï¼Œå®ƒæ˜¾ç¤ºçš„ç»†èŠ‚è¾ƒå°‘ï¼Œä½†å¯ä»¥æ›´å®¹æ˜“åœ°å¿«é€Ÿäº†è§£åˆ†å¸ƒçš„å½¢çŠ¶ï¼Œç‰¹åˆ«æ˜¯å…³äºä¼—æ•°å’Œåæ€ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ body\_mass\_g)) }\SpecialCharTok{+}
  \FunctionTok{geom\_density}\NormalTok{()}
\CommentTok{\#\textgreater{} Warning: Removed 2 rows containing non{-}finite outside the scale range}
\CommentTok{\#\textgreater{} (\textasciigrave{}stat\_density()\textasciigrave{}).}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-27-1.pdf}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-1}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  åšä¸€ä¸ªä¼é¹…ç§ç±»çš„æ¡å½¢å›¾ï¼ŒæŠŠç‰©ç§åˆ†é…ç»™\texttt{y}ã€‚è¿™ ä¸ªå›¾æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ
\item
  ä¸‹é¢ä¸¤ä¸ªå›¾æœ‰ä»€ä¹ˆä¸åŒï¼Ÿå“ª ç§ç¾å­¦ï¼ˆé¢œè‰²æˆ–å¡«å……ï¼‰å¯¹æ”¹å˜æ¡çš„é¢œè‰²æ›´æœ‰ç”¨ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ species)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{color =} \StringTok{"red"}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ species)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{fill =} \StringTok{"red"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  \texttt{geom\_histogram()} ä¸­çš„å‚æ•° \texttt{bins} èµ·ä»€ä¹ˆä½œç”¨ï¼Ÿ
\item
  åœ¨åŠ è½½tidyverseåŒ…åï¼Œå¯¹\texttt{diamonds}æ•°æ®é›†ä¸­çš„\texttt{carat}å˜é‡åˆ¶ä½œä¸€ä¸ªç›´æ–¹å›¾ã€‚å°
  è¯•ä½¿ç”¨ä¸åŒçš„åŒºé—´å®½åº¦ã€‚å“ª ç§åŒºé—´å®½åº¦æ­ç¤ºäº†æœ€æœ‰è¶£çš„æ¨¡å¼ï¼Ÿ
\end{enumerate}

\section{å¯è§†åŒ–å…³ç³»}\label{ux53efux89c6ux5316ux5173ux7cfb}

ä¸ºäº†å¯è§†åŒ–å…³ç³»ï¼Œæˆ‘ä»¬éœ€è¦å°†è‡³å°‘ä¸¤ä¸ªå˜é‡æ˜ å°„åˆ°å›¾çš„ç¾å­¦ä¸Šã€‚åœ¨
ä¸‹é¢çš„å†…å®¹ä¸­ï¼Œä½ å°†äº†è§£ç”¨äºå¯è§†åŒ–ä¸¤ä¸ªæˆ–å¤šä¸ªå˜é‡ä¹‹é—´å…³ç³»çš„å¸¸ç”¨ç»˜å›¾ä»¥åŠç”¨äºåˆ›å»ºå®ƒä»¬çš„å‡ ä½•å›¾å½¢ã€‚

To visualize a relationship we need to have at least two variables
mapped to aesthetics of a plot. In the following sections you will learn
about commonly used plots for visualizing relationships between two or
more variables and the geoms used for creating them.

\subsection{æ•°å€¼å˜é‡å’Œåˆ†ç±»å˜é‡}\label{ux6570ux503cux53d8ux91cfux548cux5206ux7c7bux53d8ux91cf}

ä¸ºäº†å¯è§†åŒ–æ•°å€¼å˜é‡å’Œåˆ†ç±»å˜é‡ä¹‹é—´çš„å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¹¶åˆ—ç®±çº¿å›¾ã€‚\textbf{ç®±}
\textbf{çº¿å›¾}æ˜¯ä¸€ç§æè¿°åˆ†å¸ƒçš„ä½ç½®åº¦é‡æŒ‡æ ‡ï¼ˆç™¾åˆ†ä½æ•°ï¼‰çš„è§†è§‰ç®€å†™å½¢å¼ï¼Œå®ƒè¿˜æœ‰åŠ©äºè¯†åˆ«æ½œåœ¨çš„å¼‚å¸¸å€¼ã€‚å¦‚
å›¾~\ref{fig-eda-boxplot} æ‰€ç¤ºï¼Œæ¯ä¸ªç®±çº¿å›¾åŒ…æ‹¬ï¼š

\begin{itemize}
\tightlist
\item
  ä¸€ä¸ªç®±å­ï¼Œè¡¨ç¤ºæ•°æ®ä¸­é—´ä¸€åŠçš„èŒƒå›´ï¼Œå³ä»åˆ†å¸ƒçš„25\%ç™¾åˆ†ä½æ•°åˆ°75\%ç™¾åˆ†ä½æ•°çš„è·ç¦»ï¼Œè¿™ä¸ªè·ç¦»ç§°ä¸ºå››åˆ†ä½è·ï¼ˆ\textbf{i}nter\textbf{q}uartile
  \textbf{r}angeï¼ŒIQRï¼‰ã€‚åœ¨ç®±å­çš„ä¸­é—´æœ‰ä¸€æ¡çº¿ï¼Œè¡¨ç¤ºåˆ†å¸ƒçš„ä¸­ä½æ•°ï¼Œå³50\%ç™¾åˆ†ä½æ•°ã€‚è¿™ä¸‰æ¡çº¿å¯ä»¥è®©ä½ æ„Ÿå—åˆ°åˆ†å¸ƒçš„ç¦»æ•£ç¨‹åº¦ä»¥åŠåˆ†å¸ƒæ˜¯å¦å…³äºä¸­ä½æ•°å¯¹ç§°æˆ–åå‘ä¸€ä¾§ã€‚
\item
  è§†è§‰ç‚¹ï¼Œç”¨äºæ˜¾ç¤ºè·ç¦»ç®±å­è¾¹ç¼˜è¶…è¿‡1.5å€IQRçš„è§‚æµ‹å€¼ã€‚è¿™äº›å¼‚å¸¸ç‚¹æ˜¯ä¸å¯»å¸¸çš„ï¼Œå› æ­¤å•ç‹¬ç»˜åˆ¶ã€‚
\item
  ä¸€æ¡çº¿ï¼ˆæˆ–ç§°ä¸º``èƒ¡é¡»''ï¼‰ï¼Œä»ç®±å­çš„æ¯ä¸ªæœ«ç«¯å»¶ä¼¸å‡ºå»ï¼Œç›´åˆ°åˆ†å¸ƒä¸­æœ€è¿œçš„éå¼‚å¸¸å€¼ç‚¹ã€‚
\end{itemize}

\begin{figure}

\centering{

\includegraphics[width=3.56in,height=\textheight]{images/EDA-boxplot.png}

}

\caption{\label{fig-eda-boxplot}Diagram depicting how a boxplot is
created.}

\end{figure}%

è®©æˆ‘ä»¬ç”¨\texttt{geom\_boxplot()}æ¥çœ‹çœ‹æŒ‰ç‰©ç§åˆ†ç»„çš„ä¼é¹…ä½“é‡çš„åˆ†å¸ƒ:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ species, }\AttributeTok{y =}\NormalTok{ body\_mass\_g)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-30-1.pdf}

æˆ–è€…ï¼Œä½¿ç”¨\texttt{geom\_density()}ç»˜åˆ¶å¯†åº¦å›¾ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ body\_mass\_g, }\AttributeTok{color =}\NormalTok{ species)) }\SpecialCharTok{+}
  \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{linewidth =} \FloatTok{0.75}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-31-1.pdf}

æˆ‘ä»¬è¿˜ä½¿ç”¨äº†\texttt{linewidth}å‚æ•°æ¥å®šåˆ¶çº¿æ¡çš„ç²—ç»†ï¼Œä»¥ä¾¿ä½¿å®ƒä»¬åœ¨èƒŒæ™¯ä¸­æ›´åŠ çªå‡ºã€‚

æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç‰©ç§æ˜ å°„åˆ°é¢œè‰²å’Œå¡«å……çš„ç¾å­¦ç‰¹æ€§ï¼Œå¹¶ä½¿ç”¨\texttt{alpha}ç¾å­¦ç‰¹æ€§ä¸ºå¡«å……çš„å¯†åº¦æ›²çº¿æ·»åŠ é€æ˜åº¦ã€‚è¿™
ä¸ªç¾å­¦ç‰¹æ€§å–å€¼èŒƒå›´åœ¨0ï¼ˆå®Œå…¨é€æ˜ï¼‰å’Œ1ï¼ˆå®Œå…¨ä¸é€æ˜ï¼‰ä¹‹é—´ã€‚åœ¨
ä¸‹å›¾ä¸­ï¼Œå®ƒè¢«è®¾ç½®ä¸º0.5ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ body\_mass\_g, }\AttributeTok{color =}\NormalTok{ species, }\AttributeTok{fill =}\NormalTok{ species)) }\SpecialCharTok{+}
  \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-32-1.pdf}

æ³¨æ„æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨çš„æœ¯è¯­:

\begin{itemize}
\tightlist
\item
  å¦‚æœæƒ³è®©ç¾å­¦æ‰€ä»£è¡¨çš„è§†è§‰å±æ€§æ ¹æ®å˜é‡çš„å€¼è€Œå˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥å°†å˜é‡æ˜ å°„åˆ°ç¾å­¦ã€‚
\item
  å¦åˆ™ï¼Œè®¾ç½®è¯¥ç¾å­¦ç‰¹æ€§çš„å€¼ã€‚
\end{itemize}

\subsection{ä¸¤ä¸ªåˆ†ç±»å˜é‡}\label{ux4e24ux4e2aux5206ux7c7bux53d8ux91cf}

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å †å æ¡å½¢å›¾æ¥å¯è§†åŒ–ä¸¤ä¸ªåˆ†ç±»å˜é‡ä¹‹é—´çš„å…³ç³»ã€‚ä¾‹
å¦‚ï¼Œä¸‹é¢çš„ä¸¤ä¸ªå †å æ¡å½¢å›¾éƒ½æ˜¾ç¤ºäº†\texttt{å²›å±¿}å’Œ\texttt{ç‰©ç§}ä¹‹é—´çš„å…³ç³»ï¼Œæˆ–è€…å…·ä½“åœ°è¯´ï¼Œæ˜¾ç¤ºäº†æ¯ä¸ªå²›å±¿å†…ç‰©ç§çš„åˆ†å¸ƒã€‚

ç¬¬ä¸€å¼ å›¾æ˜¾ç¤ºäº†æ¯ä¸ªå²›å±¿ä¸Šæ¯ç§ä¼é¹…çš„é¢‘æ•°ã€‚é¢‘
æ•°å›¾æ˜¾ç¤ºï¼Œæ¯ä¸ªå²›ä¸Šçš„Adeliesä¼é¹…æ•°é‡ç›¸ç­‰ã€‚ä½†
æ˜¯ï¼Œæˆ‘ä»¬æ— æ³•å¾ˆå¥½åœ°æ„ŸçŸ¥æ¯ä¸ªå²›å±¿å†…éƒ¨çš„æ¯”ä¾‹å¹³è¡¡ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ island, }\AttributeTok{fill =}\NormalTok{ species)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-33-1.pdf}

ç¬¬äºŒä¸ªå›¾æ˜¯é€šè¿‡åœ¨geomä¸­è®¾ç½®\texttt{position\ =\ "fill"}åˆ›å»ºçš„ç›¸å¯¹é¢‘æ•°å›¾ï¼Œå®ƒå¯¹äºæ¯”è¾ƒä¸åŒå²›å±¿ä¸Šçš„ç‰©ç§åˆ†å¸ƒæ›´æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä¸å—å²›å±¿ä¹‹é—´ä¼é¹…æ•°é‡ä¸ç­‰çš„å½±å“ã€‚æ ¹
æ®æ­¤å›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°Gentooä¼é¹…éƒ½ç”Ÿæ´»åœ¨Biscoeå²›ä¸Šï¼Œçº¦å è¯¥å²›å±¿ä¼é¹…çš„75\%ï¼ŒChinstrapä¼é¹…éƒ½ç”Ÿæ´»åœ¨Dreamå²›ä¸Šï¼Œçº¦å è¯¥å²›å±¿ä¼é¹…çš„50\%ï¼Œè€ŒAdelieä¼é¹…ç”Ÿæ´»åœ¨æ‰€æœ‰ä¸‰ä¸ªå²›å±¿ä¸Šï¼Œå¹¶ä¸”Torgersenå²›ä¸Šéƒ½æ˜¯Torgersenä¼é¹…ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ island, }\AttributeTok{fill =}\NormalTok{ species)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"fill"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-34-1.pdf}

åœ¨åˆ›å»ºè¿™äº›æ¡å½¢å›¾æ—¶ï¼Œæˆ‘ä»¬å°†è¦è¢«åˆ†å‰²æˆæ¡å½¢çš„å˜é‡æ˜ å°„åˆ°\texttt{x}ç¾å­¦ä¸Šï¼Œè€Œå°†æ”¹å˜æ¡å½¢å†…éƒ¨é¢œè‰²çš„å˜é‡æ˜ å°„åˆ°\texttt{fill}ç¾å­¦ä¸Šã€‚

\subsection{ä¸¤ä¸ªæ•°å€¼å˜é‡}\label{ux4e24ux4e2aux6570ux503cux53d8ux91cf}

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å·²ç»å­¦ä¹ äº†æ•£ç‚¹å›¾ï¼ˆç”¨\texttt{geom\_point()}åˆ›å»ºï¼‰å’Œå¹³æ»‘æ›²çº¿ï¼ˆç”¨\texttt{geom\_smooth()}åˆ›å»ºï¼‰ï¼Œç”¨äºå¯è§†åŒ–ä¸¤ä¸ªæ•°å€¼å˜é‡ä¹‹é—´çš„å…³ç³»ã€‚æ•£
ç‚¹å›¾å¯èƒ½æ˜¯ç”¨äºå¯è§†åŒ–ä¸¤ä¸ªæ•°å€¼å˜é‡é—´å…³ç³»çš„æœ€å¸¸ç”¨å›¾å½¢ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-35-1.pdf}

\subsection{ä¸‰ä¸ªæˆ–æ›´å¤šå˜é‡}\label{ux4e09ux4e2aux6216ux66f4ux591aux53d8ux91cf}

æ­£å¦‚æˆ‘ä»¬åœ¨@sec-adding-aesthetics-layers
ä¸­çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†æ›´å¤šå˜é‡æ˜ å°„åˆ°é¢å¤–çš„ç¾å­¦ç‰¹æ€§æ¥å°†å®ƒä»¬èå…¥å›¾è¡¨ä¸­ã€‚ä¾‹
å¦‚ï¼Œåœ¨ä¸‹é¢çš„æ•£ç‚¹å›¾ä¸­ï¼Œç‚¹çš„é¢œè‰²ä»£è¡¨ç‰©ç§ï¼Œè€Œç‚¹çš„å½¢çŠ¶ä»£è¡¨å²›å±¿ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ species, }\AttributeTok{shape =}\NormalTok{ island))}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-36-1.pdf}

ç„¶è€Œï¼Œåœ¨å›¾è¡¨ä¸­æ·»åŠ è¿‡å¤šçš„ç¾å­¦æ˜ å°„ä¼šä½¿å®ƒå˜å¾—æ‚ä¹±æ— ç« ä¸”éš¾ä»¥ç†è§£ã€‚å¦
ä¸€ç§ç‰¹åˆ«é€‚ç”¨äºåˆ†ç±»å˜é‡çš„æ–¹æ³•æ˜¯å°†å›¾å½¢æ‹†åˆ†ä¸ºå¤šä¸ªåˆ†é¢ï¼ˆ\textbf{facets}ï¼‰ï¼Œå³æ¯ä¸ªåˆ†é¢æ˜¾ç¤ºæ•°æ®çš„ä¸€ä¸ªå­é›†ã€‚

è¦é€šè¿‡å•ä¸ªå˜é‡å°†å›¾è¡¨æ‹†åˆ†ä¸ºåˆ†é¢ï¼Œè¯·ä½¿ç”¨\texttt{facet\_wrap()}ã€‚\texttt{f}
\texttt{acet\_wrap()}çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå…¬å¼ï¼ˆformulaï¼‰\footnote{è¿™é‡Œçš„``formula''æ˜¯ç”±\textasciitilde åˆ›å»ºçš„äº‹ç‰©çš„åç§°ï¼Œè€Œä¸æ˜¯``equation''çš„åŒä¹‰è¯ã€‚}ï¼Œé€šè¿‡\texttt{\textasciitilde{}}åè·Ÿå˜é‡åæ¥åˆ›å»ºè¿™ä¸ªå…¬å¼ï¼Œä¼ é€’ç»™\texttt{facet\_wrap()}çš„å˜é‡åº”è¯¥æ˜¯åˆ†ç±»å˜é‡ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ species, }\AttributeTok{shape =}\NormalTok{ species)) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{island)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=25in,height=\textheight]{data-visualize_files/figure-pdf/unnamed-chunk-37-1.pdf}

åœ¨@sec-layers
ä¸­ï¼Œä½ å°†å­¦ä¹ è®¸å¤šå…¶ä»–ç”¨äºå¯è§†åŒ–å˜é‡åˆ†å¸ƒä»¥åŠå®ƒä»¬ä¹‹é—´å…³ç³»çš„å‡ ä½•å¯¹è±¡ï¼ˆgeomsï¼‰ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-2}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \texttt{ggplot2}åŒ…ä¸­æ†ç»‘çš„\texttt{mpg}æ•°æ®æ¡†åŒ…å«äº†ç¾å›½ç¯å¢ƒä¿æŠ¤å±€æ”¶é›†çš„234ä¸ªè§‚æµ‹å€¼ï¼Œæ¶µç›–äº†38ç§æ±½è½¦å‹å·ã€‚\texttt{m}
  \texttt{pg}ä¸­çš„å“ªäº›å˜é‡æ˜¯åˆ†ç±»å˜é‡ï¼Ÿå“ª äº›å˜é‡æ˜¯æ•°å€¼å˜é‡ï¼Ÿï¼ˆ
  æç¤ºï¼šé”®å…¥\texttt{?mpg}ä»¥è¯»å–æ•°æ®é›†çš„æ–‡æ¡£ã€‚ï¼‰å½“ä½ è¿è¡Œ\texttt{mpg}æ—¶ï¼Œå¦‚ä½•æŸ¥çœ‹è¿™äº›ä¿¡æ¯ï¼Ÿ
\item
  ä½¿ç”¨\texttt{mpg}æ•°æ®æ¡†åˆ¶ä½œ\texttt{hwy}ä¸\texttt{displ}çš„æ•£ç‚¹å›¾ã€‚æ¥
  ä¸‹æ¥ï¼Œå°†ç¬¬ä¸‰ä¸ªæ•°å€¼å˜é‡æ˜ å°„åˆ°
  \texttt{color}ï¼Œç„¶åæ˜ å°„åˆ°\texttt{size}ï¼Œå†åŒæ—¶æ˜ å°„åˆ°\texttt{color}å’Œ\texttt{size}ï¼Œæœ€åæ˜ å°„åˆ°\texttt{shape}ã€‚è¿™
  äº›ç¾å­¦ç‰¹æ€§åœ¨åˆ†ç±»å˜é‡ä¸æ•°å€¼å˜é‡ä¸Šè¡¨ç°æœ‰ä½•ä¸åŒï¼Ÿ
\item
  åœ¨\texttt{hwy}ä¸\texttt{displ}çš„æ•£ç‚¹å›¾ä¸­ï¼Œå¦‚æœå°†ç¬¬ä¸‰ä¸ªå˜é‡æ˜ å°„åˆ°\texttt{linewidth}ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ
\item
  å¦‚æœä½ å°†åŒä¸€ä¸ªå˜é‡æ˜ å°„åˆ°å¤šä¸ªç¾å­¦ç‰¹æ€§ä¸Šä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ
\item
  åˆ¶ä½œ\texttt{bill\_depth\_mm}ä¸\texttt{bill\_length\_mm}çš„æ•£ç‚¹å›¾ï¼Œå¹¶æŒ‰\texttt{species}å¯¹ç‚¹è¿›è¡Œç€è‰²ã€‚é€š
  è¿‡æŒ‰ç‰©ç§ç€è‰²ï¼Œå¯ä»¥æ­ç¤ºè¿™ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿå¦‚
  æœæŒ‰\texttt{species}åˆ†é¢åˆä¼šå¦‚ä½•ï¼Ÿ
\item
  ä¸ºä»€ä¹ˆä»¥ä¸‹ä»£ç ä¼šç”Ÿæˆä¸¤ä¸ªç‹¬ç«‹çš„å›¾ä¾‹ï¼Ÿä½  å¦‚ä½•ä¿®å¤å®ƒä»¥åˆå¹¶è¿™ä¸¤ä¸ªå›¾ä¾‹ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}
  \AttributeTok{data =}\NormalTok{ penguins,}
  \AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}
    \AttributeTok{x =}\NormalTok{ bill\_length\_mm, }\AttributeTok{y =}\NormalTok{ bill\_depth\_mm, }
    \AttributeTok{color =}\NormalTok{ species, }\AttributeTok{shape =}\NormalTok{ species}
\NormalTok{  )}
\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{color =} \StringTok{"Species"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  åˆ›å»ºä»¥ä¸‹ä¸¤ä¸ªå †å æ¡å½¢å›¾ã€‚ç¬¬ ä¸€ä¸ªå›¾å¯ä»¥å›ç­”å“ªä¸ªé—®é¢˜ï¼Ÿç¬¬
  äºŒä¸ªå›¾å¯ä»¥å›ç­”å“ªä¸ªé—®é¢˜ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ island, }\AttributeTok{fill =}\NormalTok{ species)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"fill"}\NormalTok{)}
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ species, }\AttributeTok{fill =}\NormalTok{ island)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"fill"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{ä¿å­˜å›¾å½¢}\label{sec-ggsave}

ä¸€æ—¦ä½ åˆ›å»ºäº†å›¾å½¢ï¼Œä½ å¯èƒ½æƒ³å°†å…¶ä»Rä¸­å¯¼å‡ºå¹¶ä¿å­˜ä¸ºå›¾åƒï¼Œä»¥ä¾¿åœ¨å…¶ä»–åœ°æ–¹ä½¿ç”¨ã€‚è¿™
å°±æ˜¯\texttt{ggsave()}å‡½æ•°çš„ä½œç”¨ï¼Œå®ƒä¼šå°†æœ€è¿‘åˆ›å»ºçš„å›¾ä¿å­˜åˆ°ç£ç›˜ä¸Šï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(penguins, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ flipper\_length\_mm, }\AttributeTok{y =}\NormalTok{ body\_mass\_g)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\FunctionTok{ggsave}\NormalTok{(}\AttributeTok{filename =} \StringTok{"penguin{-}plot.png"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

è¿™ä¼šå°†å›¾ä¿å­˜åˆ°å·¥ä½œç›®å½•, æ‚¨ä¼šåœ¨@sec-workflow-scripts-projects
ä¸­æ›´å¤šåœ°äº†è§£è¿™ä¸ªæ¦‚å¿µã€‚

å¦‚æœä½ æ²¡æœ‰æŒ‡å®š\texttt{width}å’Œ\texttt{height}ï¼Œåˆ™å°†ä»å½“å‰ç»˜å›¾è®¾å¤‡çš„å°ºå¯¸ä¸­è·å–å®ƒä»¬ã€‚ä¸º
äº†ä»£ç çš„å¯é‡å¤æ€§ï¼Œä½ åº”è¯¥æŒ‡å®šå®ƒä»¬ã€‚å¯
ä»¥åœ¨æ–‡æ¡£ä¸­äº†è§£æ›´å¤šå…³äº\texttt{ggsave()}çš„ä¿¡æ¯ã€‚

ç„¶è€Œï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬æ¨èä½ ä½¿ç”¨Quartoæ¥ç»„åˆä½ çš„æœ€ç»ˆæŠ¥å‘Šï¼ŒQuartoæ˜¯ä¸€ä¸ªå¯é‡å¤çš„åˆ›ä½œç³»ç»Ÿï¼Œå®ƒå…è®¸ä½ å°†ä»£ç å’Œæ–‡æœ¬ç©¿æ’åœ¨ä¸€èµ·ï¼Œå¹¶è‡ªåŠ¨å°†ä½ çš„å›¾åŒ…å«åœ¨æŠ¥å‘Šä¸­ã€‚ä½ 
å°†åœ¨@sec-quarto ä¸­äº†è§£æ›´å¤šå…³äºQuartoçš„ä¿¡æ¯ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-3}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  è¿è¡Œä»¥ä¸‹ä»£ç è¡Œã€‚è¿™ ä¸¤ä¸ªå›¾ä¸­å“ªä¸€ä¸ªè¢«ä¿å­˜ä¸º\texttt{mpg-plot.png}ï¼Ÿä¸º
  ä»€ä¹ˆï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ class)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{()}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cty, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\FunctionTok{ggsave}\NormalTok{(}\StringTok{"mpg{-}plot.png"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  ä½ éœ€è¦åœ¨ä¸Šé¢çš„ä»£ç ä¸­æ›´æ”¹ä»€ä¹ˆä»¥å°†å›¾å½¢ä¿å­˜ä¸ºPDFè€Œä¸æ˜¯PNGï¼Ÿå¦‚
  ä½•çŸ¥é“åœ¨\texttt{ggsave()}ä¸­å¯ä»¥ä¿å­˜å“ªäº›ç±»å‹çš„å›¾åƒæ–‡ä»¶ï¼Ÿ
\end{enumerate}

\section{å¸¸è§é—®é¢˜}\label{ux5e38ux89c1ux95eeux9898}

å½“ä½ å¼€å§‹è¿è¡ŒRä»£ç æ—¶ï¼Œä½ å¾ˆå¯èƒ½ä¼šé‡åˆ°é—®é¢˜ã€‚ä¸
ç”¨æ‹…å¿ƒï¼Œæ¯ä¸ªäººéƒ½ä¼šé‡åˆ°è¿™æ ·çš„é—®é¢˜ã€‚æˆ‘
ä»¬å·²ç»å†™äº†å¤šå¹´çš„Rä»£ç ï¼Œä½†æ¯å¤©æˆ‘ä»¬è¿˜æ˜¯ä¼šå†™å‡ºç¬¬ä¸€æ¬¡å°è¯•æ—¶ä¸å·¥ä½œçš„ä»£ç ï¼

é¦–å…ˆï¼Œä»”ç»†æ¯”è¾ƒä½ æ­£åœ¨è¿è¡Œçš„ä»£ç å’Œä¹¦ä¸­çš„ä»£ç ã€‚R
éå¸¸æŒ‘å‰”ï¼Œä¸€ä¸ªæ”¾é”™ä½ç½®çš„å­—ç¬¦å¯èƒ½å°±ä¼šäº§ç”Ÿæˆªç„¶ä¸åŒçš„ç»“æœã€‚ç¡®
ä¿æ¯ä¸ª\texttt{(}éƒ½æœ‰ä¸€ä¸ªåŒ¹é…çš„\texttt{)}ï¼Œæ¯ä¸ªåŒå¼•å·\texttt{"}éƒ½æœ‰å¦ä¸€ä¸ª\texttt{"}é…å¯¹ã€‚æœ‰
æ—¶ä½ è¿è¡Œä»£ç åä»€ä¹ˆéƒ½ä¸ä¼šå‘ç”Ÿã€‚æ£€
æŸ¥æ§åˆ¶å°å·¦ä¾§ï¼šå¦‚æœæ˜¯ä¸€ä¸ª\texttt{+}ï¼Œè¿™æ„å‘³ç€Rè®¤ä¸ºä½ æ²¡æœ‰è¾“å…¥å®Œæ•´çš„è¡¨è¾¾å¼ï¼Œå®ƒåœ¨ç­‰å¾…ä½ å®Œæˆå®ƒã€‚åœ¨
è¿™ç§æƒ…å†µä¸‹ï¼Œé€šå¸¸å¾ˆå®¹æ˜“é€šè¿‡æŒ‰ESCé”®æ¥ä¸­æ­¢å½“å‰å‘½ä»¤çš„å¤„ç†ï¼Œç„¶åé‡æ–°å¼€å§‹ã€‚

åœ¨åˆ›å»ºggplot2å›¾å½¢æ—¶ï¼Œä¸€ä¸ªå¸¸è§çš„é—®é¢˜æ˜¯å°†åŠ å·\texttt{+}æ”¾åœ¨é”™è¯¯çš„ä½ç½®ï¼šå®ƒå¿…é¡»æ”¾åœ¨è¡Œçš„æœ«å°¾ï¼Œè€Œä¸æ˜¯å¼€å¤´ã€‚æ¢
å¥è¯è¯´ï¼Œç¡®ä¿ä½ æ²¡æœ‰å†™å‡ºè¿™æ ·çš„ä»£ç ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ mpg) }
\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy))}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ ä»ç„¶æ— æ³•è§£å†³é—®é¢˜ï¼Œå°è¯•ä½¿ç”¨å¸®åŠ©åŠŸèƒ½ã€‚ä½ 
å¯ä»¥åœ¨æ§åˆ¶å°ä¸­è¿è¡Œ\texttt{?function\_name}æ¥è·å–ä»»ä½•Rå‡½æ•°çš„å¸®åŠ©ï¼Œæˆ–è€…åœ¨RStudioä¸­çªå‡ºæ˜¾ç¤ºå‡½æ•°åå¹¶æŒ‰F1é”®ã€‚å¦‚
æœå¸®åŠ©ä¿¡æ¯çœ‹èµ·æ¥ä¸å¤ªæœ‰ç”¨ï¼Œä¸è¦æ‹…å¿ƒï¼Œç›´æ¥è·³åˆ°ç¤ºä¾‹éƒ¨åˆ†ï¼Œå¯»æ‰¾ä¸ä½ è¯•å›¾åšçš„äº‹æƒ…ç›¸åŒ¹é…çš„ä»£ç ã€‚

å¦‚æœè¿™æ²¡æœ‰å¸®åŠ©ï¼Œè¯·ä»”ç»†é˜…è¯»é”™è¯¯æ¶ˆæ¯ã€‚æœ‰ æ—¶ç­”æ¡ˆå°±éšè—åœ¨å…¶ä¸­ï¼ä½†
æ˜¯å½“ä½ åˆšå¼€å§‹å­¦ä¹ Ræ—¶ï¼Œå³ä½¿ç­”æ¡ˆåœ¨é”™è¯¯æ¶ˆæ¯ä¸­ï¼Œä½ å¯èƒ½è¿˜ä¸çŸ¥é“å¦‚ä½•ç†è§£å®ƒã€‚å¦
ä¸€ä¸ªå¾ˆå¥½çš„å·¥å…·æ˜¯Googleï¼šå°è¯•æœç´¢é”™è¯¯æ¶ˆæ¯ï¼Œå› ä¸ºå¾ˆå¯èƒ½æœ‰äººé‡åˆ°è¿‡åŒæ ·çš„é—®é¢˜ï¼Œå¹¶åœ¨ç½‘ä¸Šå¾—åˆ°äº†å¸®åŠ©ã€‚

\section{å°ç»“}\label{ux5c0fux7ed3}

åœ¨æœ¬ç« ä¸­ï¼Œä½ å­¦ä¹ äº†ä½¿ç”¨ggplot2è¿›è¡Œæ•°æ®å¯è§†åŒ–çš„åŸºç¡€çŸ¥è¯†ã€‚æˆ‘
ä»¬é¦–å…ˆä»‹ç»äº†ggplot2çš„åŸºæœ¬åŸç†ï¼šå¯è§†åŒ–æ˜¯ä¸€ç§å°†ä½ çš„æ•°æ®ä¸­çš„å˜é‡æ˜ å°„åˆ°è¯¸å¦‚ä½ç½®ã€é¢œè‰²ã€å¤§å°å’Œå½¢çŠ¶ç­‰ç¾å­¦å±æ€§çš„è¿‡ç¨‹ã€‚ç„¶
åï¼Œä½ å­¦ä¹ äº†å¦‚ä½•é€å±‚å¢åŠ å¤æ‚æ€§å¹¶æ”¹è¿›ä½ çš„å›¾è¡¨çš„å‘ˆç°æ–¹å¼ã€‚ä½ 
è¿˜å­¦ä¹ äº†å¦‚ä½•åˆ©ç”¨é¢å¤–çš„ç¾å­¦æ˜ å°„å’Œ/æˆ–é€šè¿‡å°†å›¾è¡¨åˆ†å‰²æˆå¤šä¸ªå°å›¾ï¼ˆfacetingï¼‰æ¥å¯è§†åŒ–å•ä¸ªå˜é‡çš„åˆ†å¸ƒä»¥åŠä¸¤ä¸ªæˆ–å¤šä¸ªå˜é‡ä¹‹é—´çš„å…³ç³»ã€‚

åœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬å°†åå¤ä½¿ç”¨å¯è§†åŒ–ï¼Œå¹¶åœ¨éœ€è¦æ—¶ä»‹ç»æ–°çš„æŠ€æœ¯ï¼›åŒæ—¶åœ¨@sec-layers
åˆ°@sec-communication ä¸­æ›´æ·±å…¥åœ°æ¢è®¨ä½¿ç”¨ggplot2åˆ›å»ºå¯è§†åŒ–ã€‚

æŒæ¡äº†å¯è§†åŒ–çš„åŸºç¡€åï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç« ä¸­ç¨å¾®è½¬æ¢ä¸€ä¸‹æ–¹å‘ï¼Œç»™ä½ ä¸€äº›å®ç”¨çš„å·¥ä½œæµç¨‹å»ºè®®ã€‚æˆ‘
ä»¬åœ¨æœ¬ä¹¦çš„è¿™ä¸€éƒ¨åˆ†ç©¿æ’äº†å·¥ä½œæµç¨‹å»ºè®®å’Œæ•°æ®ç§‘å­¦å·¥å…·ï¼Œå› ä¸ºè¿™å°†å¸®åŠ©ä½ åœ¨ç¼–å†™è¶Šæ¥è¶Šå¤šçš„Rä»£ç æ—¶ä¿æŒç»„ç»‡æœ‰åºã€‚

\chapter{å·¥ä½œæµç¨‹ï¼šåŸºç¡€}\label{sec-workflow-basics}

ç°åœ¨ä½ å·²ç»æœ‰äº†è¿è¡ŒRä»£ç çš„ç»éªŒã€‚è™½
ç„¶æˆ‘ä»¬æ²¡æœ‰ç»™ä½ å¾ˆå¤šç»†èŠ‚ï¼Œä½†ä½ è‚¯å®šå·²ç»äº†è§£äº†ä¸€äº›åŸºæœ¬çŸ¥è¯†ï¼Œå¦åˆ™ä½ ä¼šæ²®ä¸§åœ°æŠŠè¿™æœ¬ä¹¦æ‰”æ‰ï¼å½“
ä½ å¼€å§‹ç”¨Rç¼–ç¨‹æ—¶ï¼Œå¿ƒæƒ…æ²®ä¸§æ˜¯å¾ˆè‡ªç„¶çš„ï¼Œå› ä¸ºRå¯¹æ ‡ç‚¹ç¬¦å·æ˜¯å¦‚æ­¤çš„æŒ‘å‰”ï¼Œä¸€ä¸ªå­—ç¬¦ä¸åˆé€‚éƒ½å¯èƒ½å¯¼è‡´å®ƒæŠ¥é”™ã€‚å½“
ä½ æ„Ÿåˆ°æ²®ä¸§æ—¶ï¼Œä½ è¦å®‰æ…°è‡ªå·±ï¼Œè¿™ç§ç»å†æ˜¯æ™®éçš„ã€æš‚æ—¶çš„ï¼Œæ¯ä¸ªäººéƒ½ä¼šé‡åˆ°è¿™ç§æƒ…å†µï¼Œå…‹æœå®ƒçš„å”¯ä¸€æ–¹æ³•å°±æ˜¯ç»§ç»­åŠªåŠ›ã€‚

åœ¨æˆ‘ä»¬è¿›ä¸€æ­¥è®¨è®ºä¹‹å‰ï¼Œè®©æˆ‘ä»¬ç¡®ä¿ä½ åœ¨è¿è¡ŒRä»£ç æ–¹é¢æœ‰ä¸€ä¸ªåšå®çš„åŸºç¡€ï¼Œå¹¶ä¸”ä½ çŸ¥é“ä¸€äº›æœ€æœ‰ç”¨çš„RStudioç‰¹æ€§ã€‚

\section{ç¼–ç¨‹åŸºç¡€}\label{ux7f16ux7a0bux57faux7840}

è®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹ä¹‹å‰æˆ‘ä»¬å¿½ç•¥çš„ä¸€äº›åŸºç¡€çŸ¥è¯†ï¼Œä»¥ä¾¿è®©æ‚¨å°½å¿«å­¦ä¼šç»˜å›¾ã€‚ä½ 
å¯ä»¥ç”¨Ræ¥åšåŸºæœ¬çš„æ•°å­¦è®¡ç®—ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1} \SpecialCharTok{/} \DecValTok{200} \SpecialCharTok{*} \DecValTok{30}
\CommentTok{\#\textgreater{} [1] 0.15}
\NormalTok{(}\DecValTok{59} \SpecialCharTok{+} \DecValTok{73} \SpecialCharTok{+} \DecValTok{2}\NormalTok{) }\SpecialCharTok{/} \DecValTok{3}
\CommentTok{\#\textgreater{} [1] 44.66667}
\FunctionTok{sin}\NormalTok{(pi }\SpecialCharTok{/} \DecValTok{2}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] 1}
\end{Highlighting}
\end{Shaded}

å¯ä»¥ä½¿ç”¨èµ‹å€¼æ“ä½œç¬¦åˆ›å»ºæ–°å¯¹è±¡\texttt{\textless{}-}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{3} \SpecialCharTok{*} \DecValTok{4}
\end{Highlighting}
\end{Shaded}

æ³¨æ„ï¼Œ\texttt{x}çš„å€¼æ²¡æœ‰è¢«æ‰“å°å‡ºæ¥, å®ƒåªæ˜¯è¢«ä¿å­˜èµ·æ¥äº†ã€‚å¦‚
æœè¦æŸ¥çœ‹è¯¥å€¼ï¼Œè¯·åœ¨æ§åˆ¶å°ä¸­é”®å…¥\texttt{x}ã€‚

å¯ä»¥ç”¨\texttt{c()}å°†å¤šä¸ªå…ƒç´ ç»„åˆæˆä¸€ä¸ªå‘é‡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{primes }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{11}\NormalTok{, }\DecValTok{13}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

å‘é‡çš„åŸºæœ¬è¿ç®—åº”ç”¨äºå‘é‡çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{primes }\SpecialCharTok{*} \DecValTok{2}
\CommentTok{\#\textgreater{} [1]  4  6 10 14 22 26}
\NormalTok{primes }\SpecialCharTok{{-}} \DecValTok{1}
\CommentTok{\#\textgreater{} [1]  1  2  4  6 10 12}
\end{Highlighting}
\end{Shaded}

æ‰€æœ‰åˆ›å»ºå¯¹è±¡çš„Rè¯­å¥ï¼Œäº¦å³èµ‹å€¼è¯­å¥ï¼Œéƒ½æœ‰ç›¸åŒçš„å½¢å¼:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{object\_name }\OtherTok{\textless{}{-}}\NormalTok{ value}
\end{Highlighting}
\end{Shaded}

å½“ä½ è¯»è¿™æ®µä»£ç æ—¶ï¼Œåœ¨å¿ƒé‡Œé»˜å¿µ``å¯¹è±¡åè·å¾—äº†å€¼''ã€‚

ä½ ä¼šè¿›è¡Œå¤§é‡çš„èµ‹å€¼æ“ä½œï¼Œè€Œ\texttt{\textless{}-}æ‰“èµ·æ¥æ¯”è¾ƒè´¹åŠ²ï¼Œä½ å¯ä»¥ä½¿ç”¨
RStudio çš„å¿«æ·é”®æ¥èŠ‚çœæ—¶é—´ï¼šAlt + -ï¼ˆå‡å·ï¼‰ã€‚è¯· æ³¨æ„ï¼ŒRStudio
ä¼šè‡ªåŠ¨åœ¨\texttt{\textless{}-}å‘¨å›´æ·»åŠ ç©ºæ ¼ï¼Œè¿™æ˜¯ä¸€ç§è‰¯å¥½çš„å†™ä»£ç ä¹ æƒ¯ã€‚ä»£
ç åœ¨ç¾å¥½çš„æ—¥å­é‡Œè¯»èµ·æ¥ä¹Ÿå¯èƒ½å¾ˆä»¤äººç—›è‹¦ï¼ˆè¯•è¯•giveyoureyesabreakï¼‰ï¼Œæ‰€ä»¥ç»™ä½ çš„çœ¼ç›ä¼‘æ¯ä¸€ä¸‹ï¼Œä½¿ç”¨ç©ºæ ¼å§ã€‚

\section{æ³¨é‡Š}\label{ux6ce8ux91ca}

Rä¼šå¿½ç•¥è¯¥è¡Œä¸­\texttt{\#}ä¹‹åçš„ä»»ä½•æ–‡æœ¬ã€‚è¿™ å…è®¸ä½ ç¼–å†™\textbf{æ³¨é‡Š}ï¼Œå³ R
ä¼šå¿½ç•¥ä½†äººç±»å¯ä»¥é˜…è¯»çš„æ–‡æœ¬ã€‚æˆ‘
ä»¬æœ‰æ—¶ä¼šåœ¨ç¤ºä¾‹ä¸­åŒ…å«æ³¨é‡Šï¼Œä»¥è§£é‡Šä»£ç æ­£åœ¨åšä»€ä¹ˆã€‚

æ³¨é‡Šå¯ä»¥å¸®åŠ©æ‚¨ç®€è¦æè¿°ä¸‹é¢ä»£ç çš„åŠŸèƒ½ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# create vector of primes}
\NormalTok{primes }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{11}\NormalTok{, }\DecValTok{13}\NormalTok{)}

\CommentTok{\# multiply primes by 2}
\NormalTok{primes }\SpecialCharTok{*} \DecValTok{2}
\CommentTok{\#\textgreater{} [1]  4  6 10 14 22 26}
\end{Highlighting}
\end{Shaded}

åƒè¿™æ ·ç®€çŸ­çš„ä»£ç æ®µï¼Œå¯èƒ½ä¸éœ€è¦ä¸ºæ¯ä¸€è¡Œä»£ç éƒ½ç•™ä¸‹æ³¨é‡Šã€‚ä½†
æ˜¯ï¼Œéšç€ç¼–å†™çš„ä»£ç å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œæ³¨é‡Šå¯ä»¥å¸®åŠ©ä½ ï¼ˆåŠä½ çš„åˆä½œè€…ï¼‰èŠ‚çœå¾ˆå¤šæ—¶é—´æ¥å¼„æ¸…æ¥šä»£ç æ˜¯åšä»€ä¹ˆçš„ã€‚

ä½¿ç”¨æ³¨é‡Šæ¥è§£é‡Šä½ ç¼–å†™ä»£ç çš„åŸå› ï¼ˆwhyï¼‰ï¼Œè€Œä¸æ˜¯æ–¹æ³•ï¼ˆhowï¼‰æˆ–å†…å®¹ï¼ˆwhatï¼‰ã€‚é€š
è¿‡ä»”ç»†é˜…è¯»ä»£ç ï¼Œæ€»æ˜¯æœ‰å¯èƒ½å¼„æ¸…æ¥šä»£ç çš„æ–¹æ³•å’Œå†…å®¹çš„ï¼Œå°½ç®¡è¿™å¯èƒ½ä¼šå¾ˆç¹çã€‚å¦‚
æœä½ åœ¨æ³¨é‡Šä¸­æè¿°äº†æ¯ä¸€æ­¥ï¼Œç„¶åä¿®æ”¹äº†ä»£ç ï¼Œä½ éœ€è¦è®°å¾—åŒæ—¶æ›´æ–°æ³¨é‡Šï¼Œå¦åˆ™å½“ä½ å°†æ¥å†æ¬¡æŸ¥çœ‹è¿™æ®µä»£ç æ—¶ï¼Œå¯èƒ½ä¼šæ„Ÿåˆ°å›°æƒ‘ã€‚

å¼„æ¸…æ¥šä¸ºä»€ä¹ˆè¿™ä¹ˆåšå¾€å¾€æ›´åŠ å›°éš¾ï¼Œç”šè‡³æ˜¯ä¸å¯èƒ½çš„ã€‚ä¾‹
å¦‚ï¼Œ\texttt{geom\_smooth()}å‡½æ•°æœ‰ä¸€ä¸ªåä¸º\texttt{span}çš„å‚æ•°ï¼Œå®ƒæ§åˆ¶æ›²çº¿çš„å¹³æ»‘åº¦ï¼Œè¾ƒå¤§çš„å€¼ä¼šäº§ç”Ÿæ›´å¹³æ»‘çš„æ›²çº¿ã€‚å‡
è®¾ä½ å†³å®šå°†\texttt{span}çš„å€¼ä»é»˜è®¤çš„ 0.75 æ”¹ä¸º
0.9ï¼šæœªæ¥çš„è¯»è€…å¾ˆå®¹æ˜“ç†è§£å‘ç”Ÿäº†ä»€ä¹ˆï¼Œä½†é™¤éä½ åœ¨æ³¨é‡Šä¸­æ³¨æ˜ä½ çš„æ€è€ƒè¿‡ç¨‹ï¼Œå¦åˆ™æ²¡æœ‰äººä¼šç†è§£ä½ ä¸ºä»€ä¹ˆè¦æ”¹å˜é»˜è®¤å€¼ã€‚

å¯¹äºæ•°æ®åˆ†æä»£ç ï¼Œä½¿ç”¨æ³¨é‡Šæ¥è§£é‡Šä½ çš„æ•´ä½“ç­–ç•¥å’Œæ­¥éª¤ï¼Œå¹¶åœ¨é‡åˆ°é‡è¦è§è§£æ—¶è®°å½•ä¸‹æ¥ã€‚è¿™
äº›çŸ¥è¯†æ˜¯æ— æ³•ä»…ä»ä»£ç æœ¬èº«é‡æ–°è·å–çš„ã€‚

\section{å¯¹è±¡åç§°}\label{sec-whats-in-a-name}

å¯¹è±¡åå¿…é¡»ä»¥å­—æ¯å¼€å¤´ï¼Œå¹¶ä¸”åªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€\texttt{\_}å’Œ
\texttt{.}\emph{ã€‚}ä½ å¸Œæœ›å¯¹è±¡åæ˜¯æè¿°æ€§çš„ï¼Œå› æ­¤éœ€è¦ä¸ºå¤šä¸ªå•è¯é‡‡ç”¨ä¸€ç§çº¦å®šã€‚æˆ‘
ä»¬æ¨èä½¿ç”¨è›‡å½¢å‘½åæ³•ï¼ˆ\textbf{snake\_case}ï¼‰ï¼Œå³ä½¿ç”¨
\texttt{\_}åˆ†éš”å°å†™å•è¯ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{i\_use\_snake\_case}
\NormalTok{otherPeopleUseCamelCase}
\NormalTok{some.people.use.periods}
\NormalTok{And\_aFew.People\_RENOUNCEconvention}
\end{Highlighting}
\end{Shaded}

å½“è®¨è®º ç« èŠ‚~\ref{sec-workflow-style}
ä¸­çš„ä»£ç é£æ ¼æ—¶ï¼Œæˆ‘ä»¬å°†å†æ¬¡å›åˆ°å¯¹è±¡åã€‚

ä½ å¯ä»¥é€šè¿‡è¾“å…¥ä¸€ä¸ªå¯¹è±¡çš„åå­—æ¥æ£€æŸ¥å®ƒï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x}
\CommentTok{\#\textgreater{} [1] 12}
\end{Highlighting}
\end{Shaded}

ä¸‹é¢æ˜¯å¦å¤–ä¸€ä¸ªèµ‹å€¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{this\_is\_a\_really\_long\_name }\OtherTok{\textless{}{-}} \FloatTok{2.5}
\end{Highlighting}
\end{Shaded}

è¦æ£€æŸ¥è¿™ä¸ªå¯¹è±¡ï¼Œè¯·å°è¯•RStudioçš„è¡¥å…¨åŠŸèƒ½ï¼šè¾“å…¥``this''ï¼ŒæŒ‰TABé”®ï¼Œæ·»åŠ å­—ç¬¦ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå”¯ä¸€çš„å‰ç¼€ï¼Œç„¶åæŒ‰å›è½¦é”®ã€‚

å‡è®¾ä½ çŠ¯äº†ä¸€ä¸ªé”™è¯¯ï¼Œ\texttt{this\_is\_a\_really\_long\_name}çš„å€¼åº”è¯¥æ˜¯
3.5 è€Œä¸æ˜¯ 2.5ï¼Œä½ å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ªé”®ç›˜å¿«æ·é”®æ¥å¸®åŠ©ä½ ä¿®æ­£å®ƒã€‚ä¾‹ å¦‚ï¼ŒæŒ‰ â†‘
é”®æ¥è°ƒå‡ºä½ åˆšæ‰è¾“å…¥çš„æœ€åä¸€ä¸ªå‘½ä»¤å¹¶è¿›è¡Œç¼–è¾‘ã€‚æˆ– è€…è¾“å…¥ ``this'' ï¼Œç„¶åæŒ‰
Cmd/Ctrl + â†‘
æ¥åˆ—å‡ºè¾“å…¥è¿‡çš„æ‰€æœ‰ä»¥è¿™äº›å­—æ¯å¼€å¤´çš„å‘½ä»¤ï¼Œä½¿ç”¨ç®­å¤´é”®æ¥å¯¼èˆªã€‚ç„¶ åæŒ‰ Enter
é”®é‡æ–°è¾“å…¥å‘½ä»¤ï¼Œå°† 2.5 æ”¹ä¸º 3.5 å¹¶é‡æ–°è¿è¡Œã€‚

å†æ¥ä¸€ä¸ªèµ‹å€¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{r\_rocks }\OtherTok{\textless{}{-}} \DecValTok{2}\SpecialCharTok{\^{}}\DecValTok{3}
\end{Highlighting}
\end{Shaded}

è¯•ç€æ£€æŸ¥ä¸€ä¸‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{r\_rock}
\CommentTok{\#\textgreater{} Error: object \textquotesingle{}r\_rock\textquotesingle{} not found}
\NormalTok{R\_rocks}
\CommentTok{\#\textgreater{} Error: object \textquotesingle{}R\_rocks\textquotesingle{} not found}
\end{Highlighting}
\end{Shaded}

è¿™è¯´æ˜ä½ å’ŒRä¹‹é—´çš„å­˜åœ¨éšå«çº¦å®šï¼šRä¼šä¸ºä½ å®Œæˆç¹ççš„è®¡ç®—ï¼Œä½†ç›¸åº”åœ°ï¼Œä½ çš„æŒ‡ä»¤å¿…é¡»å®Œå…¨ç²¾ç¡®ã€‚å¦‚
æœä¸è¿™æ ·åšï¼Œä½ å¯èƒ½ä¼šæ”¶åˆ°ä¸€ä¸ªé”™è¯¯æç¤ºï¼Œè¯´æœªæ‰¾åˆ°ä½ æ­£åœ¨æŸ¥æ‰¾çš„å¯¹è±¡ã€‚æ‹¼
å†™å¾ˆé‡è¦ï¼Œå¦‚ä½ åœ¨è¾“å…¥\texttt{r\_rock}æ—¶å¯èƒ½æŒ‡çš„æ˜¯\texttt{r\_rocks}ï¼Œä½†Ræ— æ³•è¯»æ‡‚ä½ çš„æƒ³æ³•ã€‚å¤§
å°å†™ä¹Ÿå¾ˆé‡è¦ï¼Œå¦‚ä½ è¾“å…¥\texttt{R\_rocks}æ—¶å¯èƒ½æŒ‡çš„æ˜¯\texttt{r\_rocks}ï¼Œä½†RåŒæ ·æ— æ³•è¯»æ‡‚ä½ çš„æƒ³æ³•ã€‚

\section{å‡½æ•°è°ƒç”¨}\label{ux51fdux6570ux8c03ux7528}

Ræœ‰å¤§é‡çš„å†…ç½®å‡½æ•°ï¼Œå¯ä»¥è¿™æ ·è°ƒç”¨:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{function\_name}\NormalTok{(}\AttributeTok{argument1 =}\NormalTok{ value1, }\AttributeTok{argument2 =}\NormalTok{ value2, ...)}
\end{Highlighting}
\end{Shaded}

è®©æˆ‘ä»¬å°è¯•ä½¿ç”¨\texttt{seq()}å‡½æ•°æ¥ç”Ÿæˆä¸€ç³»åˆ—æœ‰è§„å¾‹çš„æ•°å­—ï¼ŒåŒæ—¶ä¹Ÿå­¦ä¹ 
RStudio çš„ä¸€äº›æ›´å®ç”¨çš„ç‰¹æ€§ã€‚è¾“ å…¥\texttt{se}å¹¶æŒ‰ä¸‹ TAB
é”®ï¼Œè¿™æ—¶ä¼šå¼¹å‡ºä¸€ä¸ªçª—å£æ˜¾ç¤ºå¯èƒ½çš„è¡¥å…¨é€‰é¡¹ã€‚é€š
è¿‡è¾“å…¥æ›´å¤šå†…å®¹ï¼ˆå¦‚\texttt{q}ï¼‰æ¥æ˜ç¡®æŒ‡å®š\texttt{seq()}ï¼Œæˆ–è€…ä½¿ç”¨ â†‘/â†“
ç®­å¤´æ¥é€‰æ‹©ã€‚æ³¨ æ„å¼¹å‡ºçš„æµ®åŠ¨æç¤ºï¼Œå®ƒä¼šæé†’ä½ å‡½æ•°çš„å‚æ•°å’Œç”¨é€”ã€‚å¦‚
æœä½ æƒ³è¦æ›´å¤šå¸®åŠ©ï¼ŒæŒ‰ä¸‹ F1
é”®ï¼Œåœ¨å³ä¸‹è§’çª—æ ¼çš„å¸®åŠ©é€‰é¡¹å¡ä¸­è·å–æ‰€æœ‰è¯¦ç»†ä¿¡æ¯ã€‚

å½“é€‰æ‹©äº†æƒ³è¦çš„å‡½æ•°åï¼Œå†æ¬¡æŒ‰ä¸‹ TAB é”®ï¼ŒRStudio ä¼šä¸ºä½ æ·»åŠ åŒ¹é…çš„å·¦æ‹¬å·
\texttt{(} å’Œå³æ‹¬å· \texttt{)} ã€‚è¾“
å…¥ç¬¬ä¸€ä¸ªå‚æ•°çš„åå­—\texttt{from}ï¼Œå°†å…¶è®¾ç½®ä¸ºç­‰äº
1ï¼Œç„¶åï¼Œè¾“å…¥ç¬¬äºŒä¸ªå‚æ•°çš„åå­—\texttt{to}ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºç­‰äº10ã€‚æœ€
åï¼ŒæŒ‰ä¸‹å›è½¦é”®ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\AttributeTok{from =} \DecValTok{1}\NormalTok{, }\AttributeTok{to =} \DecValTok{10}\NormalTok{)}
\CommentTok{\#\textgreater{}  [1]  1  2  3  4  5  6  7  8  9 10}
\end{Highlighting}
\end{Shaded}

åœ¨å‡½æ•°è°ƒç”¨ä¸­æˆ‘ä»¬ç»å¸¸çœç•¥å‰å‡ ä¸ªå‚æ•°çš„åå­—ï¼Œæ‰€ä»¥è¿™ä¸€è¡Œä»£ç ä¹Ÿå¯ä»¥è¿™æ ·å†™:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{10}\NormalTok{)}
\CommentTok{\#\textgreater{}  [1]  1  2  3  4  5  6  7  8  9 10}
\end{Highlighting}
\end{Shaded}

è¾“å…¥ä»¥ä¸‹ä»£ç ï¼Œæ³¨æ„åˆ° RStudio åœ¨æˆå¯¹çš„å¼•å·ä¸Šä¹Ÿæä¾›äº†ç±»ä¼¼çš„å¸®åŠ©ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \StringTok{"hello world"}
\end{Highlighting}
\end{Shaded}

å¼•å·å’Œæ‹¬å·æ€»æ˜¯æˆå¯¹å‡ºç°ã€‚R Studio
ä¼šå°½åŠ›å¸®åŠ©ä½ ï¼Œä½†ä»ç„¶æœ‰å¯èƒ½å‡ºé”™å¹¶å¯¼è‡´ä¸åŒ¹é…ã€‚å¦‚ æœå‘ç”Ÿè¿™ç§æƒ…å†µï¼ŒR
ä¼šæ˜¾ç¤ºç»­è¡Œå­—ç¬¦ \texttt{+}ï¼š

\begin{verbatim}
> x <- "hello
+
\end{verbatim}

\texttt{+}å‘Šè¯‰ä½  R æ­£åœ¨ç­‰å¾…æ›´å¤šçš„è¾“å…¥ï¼Œå®ƒè®¤ä¸ºä½ è¿˜æ²¡æœ‰å®Œæˆã€‚é€š
å¸¸ï¼Œè¿™æ„å‘³ç€ä½ å¿˜è®°äº†è¾“å…¥ä¸€ä¸ª\texttt{"}
æˆ–è€…ä¸€ä¸ª\texttt{)}ã€‚ä½ å¯ä»¥æ·»åŠ ç¼ºå¤±çš„é…å¯¹ç¬¦å·ï¼Œæˆ–è€…æŒ‰ä¸‹ ESCAPE
é”®æ¥ä¸­æ­¢è¡¨è¾¾å¼å¹¶é‡æ–°å°è¯•ã€‚

è¯·æ³¨æ„ï¼Œå³ä¸Šè§’çª—æ ¼ä¸­çš„ç¯å¢ƒï¼ˆEnvironmentï¼‰é€‰é¡¹å¡æ˜¾ç¤ºäº†ä½ åˆ›å»ºçš„æ‰€æœ‰å¯¹è±¡ï¼š

\includegraphics[width=2.59in,height=\textheight]{screenshots/rstudio-env.png}

\section{ç»ƒä¹ }\label{ux7ec3ux4e60-4}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ä¸ºä»€ä¹ˆè¿™æ®µä»£ç ä¸èƒ½æ­£å¸¸è¿è¡Œï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_variable }\OtherTok{\textless{}{-}} \DecValTok{10}
\NormalTok{my\_varÄ±able}
\CommentTok{\#\textgreater{} Error in eval(expr, envir, enclos): object \textquotesingle{}my\_varÄ±able\textquotesingle{} not found}
\end{Highlighting}
\end{Shaded}

  ä»”ç»†çœ‹ï¼è¿™
  å¯èƒ½çœ‹èµ·æ¥åƒæ˜¯æ— æ„ä¹‰çš„ç»ƒä¹ ï¼Œä½†èƒ½è®­ç»ƒä½ çš„å¤§è„‘æ³¨æ„åˆ°å³ä½¿æ˜¯å¾®å°çš„å·®å¼‚ï¼Œè¿™åœ¨ç¼–ç¨‹æ—¶ä¹Ÿä¼šè®©ä½ æœ‰æ‰€å—ç›Šã€‚
\item
  å¾®è°ƒä»¥ä¸‹æ¯ä¸ª R å‘½ä»¤ï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥æ­£ç¡®è¿è¡Œï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{libary}\NormalTok{(todyverse)}

\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{dTA =}\NormalTok{ mpg) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{maping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"lm)}
\end{Highlighting}
\end{Shaded}
\item
  æŒ‰ä¸‹ Option + Shift + K / Alt + Shift + Kï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä½ 
  å¦‚ä½•é€šè¿‡èœå•åˆ°è¾¾åŒæ ·çš„åœ°æ–¹ï¼Ÿ
\item
  é‡æ–°çœ‹ä¸€ä¸‹æ¥è‡ª å°èŠ‚~\ref{sec-ggsave} çš„ä¸€ä¸ªç»ƒä¹ ã€‚è¿ è¡Œä»¥ä¸‹ä»£ç è¡Œã€‚å“ª
  ä¸ªå›¾å½¢è¢«ä¿å­˜ä¸º \texttt{mpg-plot.png}ï¼Ÿä¸º ä»€ä¹ˆï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{my\_bar\_plot }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ class)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{()}
\NormalTok{my\_scatter\_plot }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cty, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\FunctionTok{ggsave}\NormalTok{(}\AttributeTok{filename =} \StringTok{"mpg{-}plot.png"}\NormalTok{, }\AttributeTok{plot =}\NormalTok{ my\_bar\_plot)}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{å°ç»“}\label{ux5c0fux7ed3-1}

ç°åœ¨ä½ å·²ç»å­¦ä¹ äº†æ›´å¤šå…³äºRä»£ç å¦‚ä½•å·¥ä½œçš„çŸ¥è¯†ä»¥åŠä¸€äº›æç¤ºã€‚åœ¨
å°†æ¥é‡æ–°ä½¿ç”¨ä»£ç æ—¶è¿™äº›æç¤ºèƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å®ƒã€‚åœ¨
ä¸‹ä¸€ç« ï¼Œæˆ‘ä»¬å°†ç»§ç»­æ•°æ®ç§‘å­¦ä¹‹æ—…ï¼Œå‘ä½ ä»‹ç»dplyrï¼Œå®ƒæ˜¯tidyverseçš„ä¸€ä¸ªåŒ…ï¼Œå¯ä»¥å¸®åŠ©ä½ è½¬æ¢æ•°æ®ï¼Œä¾‹å¦‚é€‰æ‹©é‡è¦çš„å˜é‡ã€ç­›é€‰æ„Ÿå…´è¶£çš„è¡Œè¿˜æ˜¯è®¡ç®—æ±‡æ€»ç»Ÿè®¡é‡ã€‚

\chapter{æ•°æ®è½¬æ¢}\label{sec-data-transform}

\section{å¼•è¨€}\label{ux5f15ux8a00-1}

å¯è§†åŒ–æ˜¯ç”Ÿæˆæ–°è§è§£çš„é‡è¦å·¥å…·ï¼Œä½†å¾ˆå°‘èƒ½åˆšå¥½å¾—åˆ°ä½ æ‰€éœ€çš„ç¡®åˆ‡å½¢å¼çš„æ•°æ®æ¥åˆ¶ä½œä½ æƒ³è¦çš„å›¾ã€‚é€š
å¸¸ï¼Œä½ éœ€è¦åˆ›å»ºä¸€äº›æ–°çš„å˜é‡æˆ–æ±‡æ€»ç»Ÿè®¡é‡æ¥ç”¨æ•°æ®å›ç­”ä½ çš„é—®é¢˜ï¼›æˆ–è€…ä½ å¯èƒ½åªæ˜¯æƒ³é‡å‘½åå˜é‡æˆ–é‡æ–°æ’åºè§‚æµ‹å€¼ï¼Œä»¥ä½¿æ•°æ®æ›´æ˜“äºå¤„ç†ã€‚åœ¨
æœ¬ç« ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•åšåˆ°è¿™äº›ï¼ˆåŠæ›´å¤šï¼‰ã€‚æœ¬
ç« å°†ä»‹ç»ä½¿ç”¨\textbf{dplyr}åŒ…å’Œ2013å¹´ä»çº½çº¦å¸‚å‡ºå‘çš„èˆªç­æ•°æ®é›†è¿›è¡Œæ•°æ®è½¬æ¢ã€‚

æœ¬ç« çš„ç›®æ ‡æ˜¯ä¸ºä½ æ¦‚è¿°è½¬æ¢æ•°æ®æ¡†çš„æ‰€æœ‰å…³é”®å·¥å…·ã€‚æˆ‘
ä»¬å°†ä»å¯¹æ•°æ®æ¡†çš„è¡Œå’Œåˆ—è¿›è¡Œæ“ä½œçš„å‡½æ•°å¼€å§‹ï¼Œç„¶åå†æ¬¡å›åˆ°è®¨è®ºç®¡é“ï¼ˆpipeï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªé‡è¦çš„å·¥å…·ï¼Œç”¨äºç»„åˆåŠ¨è¯ã€‚æ¥
ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¤„ç†åˆ†ç»„çš„èƒ½åŠ›ã€‚æˆ‘
ä»¬å°†ä»¥ä¸€ä¸ªç ”ç©¶æ¡ˆä¾‹ç»“æŸæœ¬ç« ï¼Œè¯¥æ¡ˆä¾‹ç ”ç©¶å±•ç¤ºäº†è¿™äº›å‡½æ•°çš„å®é™…åº”ç”¨ï¼›å½“æˆ‘ä»¬å¼€å§‹æ·±å…¥ç ”ç©¶ç‰¹å®šç±»å‹çš„æ•°æ®ï¼ˆä¾‹å¦‚æ•°å­—ã€å­—ç¬¦ä¸²ã€æ—¥æœŸï¼‰æ—¶ï¼Œæˆ‘ä»¬å°†åœ¨åç»­çš„ç« èŠ‚ä¸­æ›´è¯¦ç»†åœ°è®¨è®ºè¿™äº›å‡½æ•°ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-1}

æœ¬ç« å°†é‡ç‚¹è®¨è®ºdplyråŒ…ï¼Œå®ƒæ˜¯tidyverseçš„å¦ä¸€ä¸ªæ ¸å¿ƒæˆå‘˜ã€‚æˆ‘
ä»¬å°†ä½¿ç”¨æ¥è‡ªnycflights13åŒ…çš„æ•°æ®æ¥è¯´æ˜dplyråŒ…çš„å…³é”®ç†å¿µï¼Œå¹¶ä½¿ç”¨ggplot2æ¥å¸®åŠ©æˆ‘ä»¬ç†è§£æ•°æ®ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(nycflights13)}
\FunctionTok{library}\NormalTok{(tidyverse)}
\CommentTok{\#\textgreater{} {-}{-} Attaching core tidyverse packages {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} tidyverse 2.0.0 {-}{-}}
\CommentTok{\#\textgreater{} v dplyr     1.1.4     v readr     2.1.5}
\CommentTok{\#\textgreater{} v forcats   1.0.0     v stringr   1.5.1}
\CommentTok{\#\textgreater{} v ggplot2   3.5.0     v tibble    3.2.1}
\CommentTok{\#\textgreater{} v lubridate 1.9.3     v tidyr     1.3.1}
\CommentTok{\#\textgreater{} v purrr     1.0.2     }
\CommentTok{\#\textgreater{} {-}{-} Conflicts {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-} tidyverse\_conflicts() {-}{-}}
\CommentTok{\#\textgreater{} x dplyr::filter() masks stats::filter()}
\CommentTok{\#\textgreater{} x dplyr::lag()    masks stats::lag()}
\CommentTok{\#\textgreater{} i Use the conflicted package (\textless{}http://conflicted.r{-}lib.org/\textgreater{}) to force all conflicts to become errors}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„åŠ è½½tidyverseæ—¶æ˜¾ç¤ºçš„å†²çªæ¶ˆæ¯ã€‚å®ƒ
å‘Šè¯‰ä½ dplyrè¦†ç›–äº†RåŸºç¡€åŒ…ä¸­çš„ä¸€äº›å‡½æ•°ã€‚å¦‚
æœä½ åœ¨åŠ è½½dplyråæƒ³ä½¿ç”¨è¿™äº›å‡½æ•°çš„åŸºç¡€ç‰ˆæœ¬ï¼Œä½ éœ€è¦ä½¿ç”¨å®ƒä»¬çš„å…¨åï¼šstats::filter()
å’Œ stats::lag()ã€‚åˆ°
ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸»è¦å¿½ç•¥äº†å‡½æ•°æ¥è‡ªå“ªä¸ªåŒ…ï¼Œå› ä¸ºå¤§å¤šæ•°æƒ…å†µä¸‹è¿™å¹¶ä¸é‡è¦ã€‚ä½†
æ˜¯ï¼ŒçŸ¥é“åŒ…åå¯ä»¥å¸®åŠ©ä½ æ‰¾åˆ°å¸®åŠ©å’Œç›¸å…³çš„å‡½æ•°ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬éœ€è¦ç²¾ç¡®åœ°çŸ¥é“ä¸€ä¸ªå‡½æ•°æ¥è‡ªå“ªä¸ªåŒ…æ—¶ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸Rç›¸åŒçš„è¯­æ³•ï¼špackagename::functionname()ã€‚

\subsection{nycflights13}\label{nycflights13}

ä¸ºäº†æ¢ç´¢åŸºæœ¬çš„dplyræ“ä½œï¼Œæˆ‘ä»¬å°†ä½¿ç”¨nycflights13::flightsã€‚æ­¤
æ•°æ®é›†åŒ…å«æ‰€æœ‰r format(nrow(nycflights13::flights), big.mark =
``,'')2013å¹´ä»çº½çº¦å‡ºå‘çš„èˆªç­ã€‚è¿™
äº›æ•°æ®æ¥è‡ªç¾å›½\href{https://www.transtats.bts.gov/DL_SelectFields.aspx?gnoyr_VQ=FGJ&QO_fu146_anzr=b0-gvzr}{Bureau
of Transportation Statistics}ï¼Œå¹¶è®°å½•åœ¨ ?f lightsã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      517            515         2      830            819}
\CommentTok{\#\textgreater{} 2  2013     1     1      533            529         4      850            830}
\CommentTok{\#\textgreater{} 3  2013     1     1      542            540         2      923            850}
\CommentTok{\#\textgreater{} 4  2013     1     1      544            545        {-}1     1004           1022}
\CommentTok{\#\textgreater{} 5  2013     1     1      554            600        {-}6      812            837}
\CommentTok{\#\textgreater{} 6  2013     1     1      554            558        {-}4      740            728}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

flightsæ˜¯ä¸€ä¸ªtibbleï¼ˆtibbleæ˜¯tidyverseä½¿ç”¨çš„ä¸€ç§ç‰¹æ®Šç±»å‹çš„æ•°æ®æ¡†ï¼‰ï¼Œç”¨äºé¿å…ä¸€äº›å¸¸è§çš„æ„å¤–æƒ…å†µã€‚t
ibbleå’Œæ•°æ®æ¡†ä¹‹é—´æœ€é‡è¦çš„åŒºåˆ«åœ¨äºå®ƒä»¬çš„è¾“å‡ºæ–¹å¼ï¼›tibbleæ˜¯ä¸ºäº†å¤§å‹æ•°æ®é›†è®¾è®¡çš„ï¼Œå› æ­¤å®ƒä»¬åªæ˜¾ç¤ºå‰å‡ è¡Œå’Œèƒ½å¤Ÿåœ¨ä¸€ä¸ªå±å¹•ä¸Šæ˜¾ç¤ºçš„åˆ—ã€‚æœ‰
å‡ ç§æ–¹æ³•å¯ä»¥æŸ¥çœ‹æ‰€æœ‰å†…å®¹ã€‚å¦‚
æœä½ æ­£åœ¨ä½¿ç”¨RStudioï¼Œæœ€æ–¹ä¾¿çš„å¯èƒ½æ˜¯View(flights)ï¼Œè¿™ä¼šæ‰“å¼€ä¸€ä¸ªå¯ä»¥æ»šåŠ¨å’Œç­›é€‰çš„äº¤äº’å¼è§†å›¾ã€‚å¦
å¤–ä½ å¯ä»¥ä½¿ç”¨print(flights, width =
Inf)æ¥æ˜¾ç¤ºæ‰€æœ‰åˆ—ï¼Œæˆ–è€…ä½¿ç”¨glimpse()å‡½æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{glimpse}\NormalTok{(flights)}
\CommentTok{\#\textgreater{} Rows: 336,776}
\CommentTok{\#\textgreater{} Columns: 19}
\CommentTok{\#\textgreater{} $ year           \textless{}int\textgreater{} 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013\textasciitilde{}}
\CommentTok{\#\textgreater{} $ month          \textless{}int\textgreater{} 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1\textasciitilde{}}
\CommentTok{\#\textgreater{} $ day            \textless{}int\textgreater{} 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1\textasciitilde{}}
\CommentTok{\#\textgreater{} $ dep\_time       \textless{}int\textgreater{} 517, 533, 542, 544, 554, 554, 555, 557, 557, 558, 55\textasciitilde{}}
\CommentTok{\#\textgreater{} $ sched\_dep\_time \textless{}int\textgreater{} 515, 529, 540, 545, 600, 558, 600, 600, 600, 600, 60\textasciitilde{}}
\CommentTok{\#\textgreater{} $ dep\_delay      \textless{}dbl\textgreater{} 2, 4, 2, {-}1, {-}6, {-}4, {-}5, {-}3, {-}3, {-}2, {-}2, {-}2, {-}2, {-}2,\textasciitilde{}}
\CommentTok{\#\textgreater{} $ arr\_time       \textless{}int\textgreater{} 830, 850, 923, 1004, 812, 740, 913, 709, 838, 753, 8\textasciitilde{}}
\CommentTok{\#\textgreater{} $ sched\_arr\_time \textless{}int\textgreater{} 819, 830, 850, 1022, 837, 728, 854, 723, 846, 745, 8\textasciitilde{}}
\CommentTok{\#\textgreater{} $ arr\_delay      \textless{}dbl\textgreater{} 11, 20, 33, {-}18, {-}25, 12, 19, {-}14, {-}8, 8, {-}2, {-}3, 7,\textasciitilde{}}
\CommentTok{\#\textgreater{} $ carrier        \textless{}chr\textgreater{} "UA", "UA", "AA", "B6", "DL", "UA", "B6", "EV", "B6"\textasciitilde{}}
\CommentTok{\#\textgreater{} $ flight         \textless{}int\textgreater{} 1545, 1714, 1141, 725, 461, 1696, 507, 5708, 79, 301\textasciitilde{}}
\CommentTok{\#\textgreater{} $ tailnum        \textless{}chr\textgreater{} "N14228", "N24211", "N619AA", "N804JB", "N668DN", "N\textasciitilde{}}
\CommentTok{\#\textgreater{} $ origin         \textless{}chr\textgreater{} "EWR", "LGA", "JFK", "JFK", "LGA", "EWR", "EWR", "LG\textasciitilde{}}
\CommentTok{\#\textgreater{} $ dest           \textless{}chr\textgreater{} "IAH", "IAH", "MIA", "BQN", "ATL", "ORD", "FLL", "IA\textasciitilde{}}
\CommentTok{\#\textgreater{} $ air\_time       \textless{}dbl\textgreater{} 227, 227, 160, 183, 116, 150, 158, 53, 140, 138, 149\textasciitilde{}}
\CommentTok{\#\textgreater{} $ distance       \textless{}dbl\textgreater{} 1400, 1416, 1089, 1576, 762, 719, 1065, 229, 944, 73\textasciitilde{}}
\CommentTok{\#\textgreater{} $ hour           \textless{}dbl\textgreater{} 5, 5, 5, 5, 6, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 6, 6\textasciitilde{}}
\CommentTok{\#\textgreater{} $ minute         \textless{}dbl\textgreater{} 15, 29, 40, 45, 0, 58, 0, 0, 0, 0, 0, 0, 0, 0, 0, 59\textasciitilde{}}
\CommentTok{\#\textgreater{} $ time\_hour      \textless{}dttm\textgreater{} 2013{-}01{-}01 05:00:00, 2013{-}01{-}01 05:00:00, 2013{-}01{-}0\textasciitilde{}}
\end{Highlighting}
\end{Shaded}

åœ¨è¿™ä¸¤ç§è§†å›¾ä¸­ï¼Œå˜é‡ååé¢è·Ÿç€ç¼©å†™ï¼Œè¿™äº›ç¼©å†™è¡¨ç¤ºæ¯ä¸ªå˜é‡çš„ç±»å‹ï¼š\textless int\textgreater æ˜¯æ•´æ•°çš„ç¼©å†™ï¼Œ\textless dbl\textgreater æ˜¯åŒç²¾åº¦æµ®ç‚¹æ•°ï¼ˆä¹Ÿç§°ä¸ºå®æ•°ï¼‰çš„ç¼©å†™ï¼Œ\textless chr\textgreater æ˜¯å­—ç¬¦ï¼ˆä¹Ÿç§°ä¸ºå­—ç¬¦ä¸²ï¼‰çš„ç¼©å†™ï¼Œ\textless dttm\textgreater æ˜¯æ—¥æœŸæ—¶é—´çš„ç¼©å†™ã€‚è¿™
äº›ç¼©å†™å¾ˆé‡è¦ï¼Œå› ä¸ºä½ å¯ä»¥åœ¨ä¸€åˆ—ä¸Šæ‰§è¡Œçš„æ“ä½œåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºå®ƒçš„``ç±»å‹''ã€‚

\subsection{dplyr åŸºç¡€}\label{dplyr-ux57faux7840}

ä¸‹é¢å°†å­¦ä¹ dplyrçš„ä¸»è¦æ“ä½œï¼ˆå³å‡½æ•°ï¼‰ï¼Œè¿™äº›å‡½æ•°èƒ½å¸®ä½ è§£å†³ç»å¤§å¤šæ•°çš„æ•°æ®å¤„ç†é—®é¢˜ã€‚ä½†
åœ¨è®¨è®ºå®ƒä»¬å„è‡ªçš„å·®å¼‚ä¹‹å‰ï¼Œå€¼å¾—ä¸€æçš„æ˜¯å®ƒä»¬çš„å…±åŒç‚¹ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  ç¬¬ä¸€ä¸ªå‚æ•°å§‹ç»ˆæ˜¯ä¸€ä¸ªæ•°æ®æ¡†ï¼›
\item
  åç»­å‚æ•°é€šå¸¸ä½¿ç”¨å˜é‡åï¼ˆä¸å¸¦å¼•å·ï¼‰æ¥æè¿°è¦æ“ä½œçš„åˆ—ï¼›
\item
  è¾“å‡ºå§‹ç»ˆæ˜¯ä¸€ä¸ªæ–°çš„æ•°æ®æ¡†ã€‚
\end{enumerate}

å› ä¸ºæ¯ä¸ªå‡½æ•°éƒ½æ“…é•¿åšä¸€ä»¶äº‹ï¼Œæ‰€ä»¥è§£å†³å¤æ‚é—®é¢˜é€šå¸¸éœ€è¦ç»„åˆå¤šä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç®¡é“æ“ä½œç¬¦\textbar\textgreater æ¥å®ç°è¿™ä¸€ç‚¹ã€‚æˆ‘
ä»¬å°†åœ¨@sec-the-pipe æ›´è¯¦ç»†åœ°è®¨è®ºç®¡é“æ“ä½œç¬¦ã€‚ç®€
è¨€ä¹‹ï¼Œç®¡é“æ“ä½œç¬¦å°†å…¶å·¦ä¾§çš„å†…å®¹ä¼ é€’ç»™å…¶å³ä¾§çš„å‡½æ•°ï¼Œå› æ­¤x
\textbar\textgreater{} f(y)ç­‰åŒäºf(x, y)ï¼Œè€Œx \textbar\textgreater{}
f(y) \textbar\textgreater{} g(z)ç­‰åŒäºg(f(x, y),
z)ï¼Œ\textbar\textgreater æœ€ç®€å•çš„å‘éŸ³æ˜¯``then''ã€‚è¿™
ä½¿å¾—å³ä½¿ä½ è¿˜æ²¡æœ‰å­¦ä¹ ç»†èŠ‚ï¼Œä¹Ÿæœ‰å¯èƒ½ç†è§£ä¸‹é¢çš„ä»£ç ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{filter}\NormalTok{(dest }\SpecialCharTok{==} \StringTok{"IAH"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(year, month, day) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{arr\_delay =} \FunctionTok{mean}\NormalTok{(arr\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

dplyrçš„å‡½æ•°æ ¹æ®ä½œç”¨å¯¹è±¡ä¸åŒåˆ†ä¸ºå››ç»„ï¼š\textbf{è¡Œ}ï¼ˆrowsï¼‰ã€\textbf{åˆ—}ï¼ˆcolumnsï¼‰ã€\textbf{ç»„}ï¼ˆgroupsï¼‰æˆ–\textbf{è¡¨}ï¼ˆtablesï¼‰ã€‚ä¸‹
é¢å°†å­¦ä¹ æœ‰å…³è¡Œã€åˆ—å’Œç»„çš„æœ€é‡è¦å‡½æ•°ï¼Œç„¶åå›åˆ°@sec-joins
ä¸­æ¢è®¨ä½œç”¨äºè¡¨çš„åˆå¹¶æ“ä½œã€‚è®© æˆ‘ä»¬å¼€å§‹å§!

\section{è¡Œ}\label{ux884c}

å¯¹æ•°æ®é›†çš„è¡Œè¿›è¡Œæ“ä½œçš„æœ€é‡è¦çš„å‡½æ•°æ˜¯filter()ï¼Œå®ƒå½±å“è¡Œçš„å»ç•™è€Œä¸æ”¹å˜å®ƒä»¬çš„é¡ºåºï¼›è€Œå‡½æ•°arrange()æ”¹å˜è¡Œçš„é¡ºåºè€Œä¸å½±å“è¡Œçš„å»ç•™ã€‚è¿™
ä¸¤ä¸ªå‡½æ•°éƒ½åªå½±å“è¡Œï¼Œåˆ—ä¿æŒä¸å˜ã€‚æˆ‘
ä»¬è¿˜å°†è®¨è®ºdistinct()ï¼Œå®ƒæ‰¾å‡ºå…·æœ‰å”¯ä¸€å€¼çš„è¡Œï¼Œä½†ä¸arrange()å’Œfilter()ä¸åŒï¼Œå®ƒè¿˜å¯ä»¥é€‰æ‹©æ€§åœ°ä¿®æ”¹åˆ—ã€‚

\subsection{filter()}\label{filter}

Filter()å…è®¸ä½ æ ¹æ®åˆ—çš„å€¼ä¿ç•™è¡Œ\footnote{ç¨åï¼Œæ‚¨å°†å­¦ä¹ \texttt{slice\_*()ç³»åˆ—}å‡½æ•°ï¼Œå®ƒå…è®¸ä½ æ ¹æ®è¡Œçš„ä½ç½®é€‰æ‹©è¡Œã€‚}ã€‚
ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°æ®æ¡†ï¼Œç¬¬äºŒä¸ªåŠéšåçš„å‚æ•°æ˜¯ä¿ç•™è¯¥è¡Œå¿…é¡»ä¸ºçœŸçš„æ¡ä»¶ã€‚
ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾å‡ºæ‰€æœ‰è¿Ÿåˆ°è¶…è¿‡120åˆ†é’Ÿ(2å°æ—¶)çš„èˆªç­:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(dep\_delay }\SpecialCharTok{\textgreater{}} \DecValTok{120}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 9,723 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      848           1835       853     1001           1950}
\CommentTok{\#\textgreater{} 2  2013     1     1      957            733       144     1056            853}
\CommentTok{\#\textgreater{} 3  2013     1     1     1114            900       134     1447           1222}
\CommentTok{\#\textgreater{} 4  2013     1     1     1540           1338       122     2020           1825}
\CommentTok{\#\textgreater{} 5  2013     1     1     1815           1325       290     2120           1542}
\CommentTok{\#\textgreater{} 6  2013     1     1     1842           1422       260     1958           1535}
\CommentTok{\#\textgreater{} \# i 9,717 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

é™¤äº†ä½¿ç”¨ \textgreaterï¼ˆå¤§äºï¼‰ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨
\textgreater=ï¼ˆå¤§äºæˆ–ç­‰äºï¼‰ã€\textlessï¼ˆå°äºï¼‰ã€\textless=ï¼ˆå°äºæˆ–ç­‰äºï¼‰ã€==ï¼ˆç­‰äºï¼‰å’Œ
!= ï¼ˆä¸ç­‰äºï¼‰ã€‚ä½  è¿˜å¯ä»¥ä½¿ç”¨ \& æˆ– ,
æ¥ç»„åˆæ¡ä»¶ï¼Œè¡¨ç¤º``å’Œ''ï¼ˆæ£€æŸ¥ä¸¤ä¸ªæ¡ä»¶æ˜¯å¦éƒ½æ»¡è¶³ï¼‰ï¼Œæˆ–è€…ä½¿ç”¨ \textbar{}
æ¥è¡¨ç¤º``æˆ–''ï¼ˆæ£€æŸ¥ä»»ä¸€æ¡ä»¶æ˜¯å¦æ»¡è¶³ï¼‰ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Flights that departed on January 1}
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(month }\SpecialCharTok{==} \DecValTok{1} \SpecialCharTok{\&}\NormalTok{ day }\SpecialCharTok{==} \DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 842 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      517            515         2      830            819}
\CommentTok{\#\textgreater{} 2  2013     1     1      533            529         4      850            830}
\CommentTok{\#\textgreater{} 3  2013     1     1      542            540         2      923            850}
\CommentTok{\#\textgreater{} 4  2013     1     1      544            545        {-}1     1004           1022}
\CommentTok{\#\textgreater{} 5  2013     1     1      554            600        {-}6      812            837}
\CommentTok{\#\textgreater{} 6  2013     1     1      554            558        {-}4      740            728}
\CommentTok{\#\textgreater{} \# i 836 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}

\CommentTok{\# Flights that departed in January or February}
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(month }\SpecialCharTok{==} \DecValTok{1} \SpecialCharTok{|}\NormalTok{ month }\SpecialCharTok{==} \DecValTok{2}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 51,955 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      517            515         2      830            819}
\CommentTok{\#\textgreater{} 2  2013     1     1      533            529         4      850            830}
\CommentTok{\#\textgreater{} 3  2013     1     1      542            540         2      923            850}
\CommentTok{\#\textgreater{} 4  2013     1     1      544            545        {-}1     1004           1022}
\CommentTok{\#\textgreater{} 5  2013     1     1      554            600        {-}6      812            837}
\CommentTok{\#\textgreater{} 6  2013     1     1      554            558        {-}4      740            728}
\CommentTok{\#\textgreater{} \# i 51,949 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

å½“æ‚¨ç»“åˆä½¿ç”¨ \textbar{} å’Œ == æ—¶æœ‰ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„å¿«æ·æ–¹å¼ï¼š\%in\%ã€‚å®ƒ
ä¼šä¿ç•™å˜é‡ç­‰äºå³ä¾§å€¼ä¹‹ä¸€çš„è¡Œï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# A shorter way to select flights that departed in January or February}
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(month }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\CommentTok{\#\textgreater{} \# A tibble: 51,955 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      517            515         2      830            819}
\CommentTok{\#\textgreater{} 2  2013     1     1      533            529         4      850            830}
\CommentTok{\#\textgreater{} 3  2013     1     1      542            540         2      923            850}
\CommentTok{\#\textgreater{} 4  2013     1     1      544            545        {-}1     1004           1022}
\CommentTok{\#\textgreater{} 5  2013     1     1      554            600        {-}6      812            837}
\CommentTok{\#\textgreater{} 6  2013     1     1      554            558        {-}4      740            728}
\CommentTok{\#\textgreater{} \# i 51,949 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å°†åœ¨@sec-logicals ä¸­è¯¦ç»†è®¨è®ºè¿™äº›æ¯”è¾ƒå’Œé€»è¾‘è¿ç®—ç¬¦ã€‚

å½“ä½ è¿è¡Œfilter()æ—¶ï¼Œdplyrä¼šæ‰§è¡Œç­›é€‰æ“ä½œï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®æ¡†ï¼Œç„¶åè¾“å‡ºå®ƒã€‚å®ƒ
ä¸ä¼šä¿®æ”¹ç°æœ‰çš„flightsæ•°æ®é›†ï¼Œå› ä¸ºdplyrå‡½æ•°æ°¸è¿œä¸ä¼šä¿®æ”¹å®ƒä»¬çš„è¾“å…¥ã€‚è¦
ä¿å­˜ç»“æœï¼Œä½ éœ€è¦ä½¿ç”¨èµ‹å€¼è¿ç®—ç¬¦\textless-ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{jan1 }\OtherTok{\textless{}{-}}\NormalTok{ flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(month }\SpecialCharTok{==} \DecValTok{1} \SpecialCharTok{\&}\NormalTok{ day }\SpecialCharTok{==} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{å¸¸è§é”™è¯¯}\label{ux5e38ux89c1ux9519ux8bef}

ä»ä½ åˆšå¼€å§‹å­¦ä¹ Ræ—¶ï¼Œæœ€å®¹æ˜“çŠ¯çš„é”™è¯¯æ˜¯åœ¨æ£€éªŒæ˜¯å¦ç›¸ç­‰æ—¶ä½¿ç”¨=è€Œä¸æ˜¯==ã€‚f
ilter()ä¼šå‘Šè¯‰ä½ å‘ç”Ÿäº†ä»€ä¹ˆï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(}\AttributeTok{month =} \DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} Error in \textasciigrave{}filter()\textasciigrave{}:}
\CommentTok{\#\textgreater{} ! We detected a named input.}
\CommentTok{\#\textgreater{} i This usually means that you\textquotesingle{}ve used \textasciigrave{}=\textasciigrave{} instead of \textasciigrave{}==\textasciigrave{}.}
\CommentTok{\#\textgreater{} i Did you mean \textasciigrave{}month == 1\textasciigrave{}?}
\end{Highlighting}
\end{Shaded}

å¦ä¸€ä¸ªé”™è¯¯æ˜¯åƒåœ¨è‹±è¯­ä¸­é‚£æ ·å†™``æˆ–''è¯­å¥:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(month }\SpecialCharTok{==} \DecValTok{1} \SpecialCharTok{|} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

è¿™æ®µä»£ç ``æœ‰æ•ˆ''ï¼Œå®ƒä¸ä¼šæŠ›å‡ºé”™è¯¯ï¼Œä½†å®ƒæ²¡æœ‰æŒ‰ç…§ä½ çš„æœŸæœ›å»åšï¼Œå› ä¸º
\textbar{} é¦–å…ˆæ£€æŸ¥æ¡ä»¶month ==
1ï¼Œç„¶åæ£€æŸ¥æ¡ä»¶2ï¼Œè€Œæ£€æŸ¥2å¹¶ä¸æ˜¯ä¸€ä¸ªåˆç†çš„æ¡ä»¶ã€‚æˆ‘ ä»¬å°†åœ¨
å°èŠ‚~\ref{sec-boolean-operations} æ›´å¤šåœ°äº†è§£è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Œä»¥åŠä¸ºä»€ä¹ˆã€‚

\subsection{arrange()}\label{arrange}

arrange()æ ¹æ®åˆ—çš„å€¼æ”¹å˜è¡Œçš„é¡ºåºã€‚å®ƒ
æ ¹æ®ä¸€ä¸ªæ•°æ®æ¡†å’Œä¸€ç»„åˆ—åï¼ˆæˆ–æ›´å¤æ‚çš„è¡¨è¾¾å¼ï¼‰æ¥æ’åºã€‚å¦‚
æœä½ æä¾›äº†å¤šä¸ªåˆ—åï¼Œé‚£ä¹ˆæ¯ä¸ªé¢å¤–çš„åˆ—éƒ½å°†ç”¨äºè§£å†³å‰é¢åˆ—ä¸­å€¼çš„å¹¶åˆ—é—®é¢˜ã€‚ä¾‹
å¦‚ï¼Œä¸‹é¢çš„ä»£ç æŒ‰å‡ºå‘æ—¶é—´æ’åºï¼Œå‡ºå‘æ—¶é—´åˆ†å¸ƒåœ¨å››ä¸ªåˆ—ä¸­ã€‚æˆ‘
ä»¬é¦–å…ˆå¾—åˆ°æœ€æ—©çš„å¹´ä»½ï¼Œç„¶ååœ¨åŒä¸€å¹´ä»½ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°æœ€æ—©çš„æœˆä»½ï¼Œä¾æ­¤ç±»æ¨ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{arrange}\NormalTok{(year, month, day, dep\_time)}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      517            515         2      830            819}
\CommentTok{\#\textgreater{} 2  2013     1     1      533            529         4      850            830}
\CommentTok{\#\textgreater{} 3  2013     1     1      542            540         2      923            850}
\CommentTok{\#\textgreater{} 4  2013     1     1      544            545        {-}1     1004           1022}
\CommentTok{\#\textgreater{} 5  2013     1     1      554            600        {-}6      812            837}
\CommentTok{\#\textgreater{} 6  2013     1     1      554            558        {-}4      740            728}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥åœ¨arrange()å†…éƒ¨å¯¹æŸä¸€åˆ—ä½¿ç”¨desc()æ¥æ ¹æ®è¯¥åˆ—çš„å€¼ä»¥é™åºï¼ˆä»å¤§åˆ°å°ï¼‰é‡æ–°æ’åºæ•°æ®æ¡†ã€‚ä¾‹
å¦‚ï¼Œè¿™æ®µä»£ç å°†èˆªç­æŒ‰å»¶è¯¯æ—¶é—´ä»é•¿åˆ°çŸ­æ’åºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(dep\_delay))}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     9      641            900      1301     1242           1530}
\CommentTok{\#\textgreater{} 2  2013     6    15     1432           1935      1137     1607           2120}
\CommentTok{\#\textgreater{} 3  2013     1    10     1121           1635      1126     1239           1810}
\CommentTok{\#\textgreater{} 4  2013     9    20     1139           1845      1014     1457           2210}
\CommentTok{\#\textgreater{} 5  2013     7    22      845           1600      1005     1044           1815}
\CommentTok{\#\textgreater{} 6  2013     4    10     1100           1900       960     1342           2211}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

æ³¨æ„ï¼Œè¡Œæ•°æ²¡æœ‰æ”¹å˜ï¼Œæˆ‘ä»¬åªæ˜¯å¯¹æ•°æ®è¿›è¡Œäº†æ’åˆ—ï¼Œæ²¡æœ‰å¯¹å…¶è¿›è¡Œè¿‡ç­›é€‰ã€‚

\subsection{distinct()}\label{distinct}

distinct()åœ¨æ•°æ®é›†ä¸­æ‰¾å‡ºæ‰€æœ‰å”¯ä¸€çš„è¡Œï¼Œæ‰€ä»¥ä»æŠ€æœ¯ä¸Šè®²ï¼Œå®ƒä¸»è¦å¯¹è¡Œè¿›è¡Œæ“ä½œã€‚ç„¶
è€Œï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ ä¼šæƒ³è¦æŸäº›å˜é‡çš„ä¸åŒç»„åˆï¼Œå› æ­¤ä½ ä¹Ÿå¯ä»¥é€‰æ‹©æ€§åœ°æä¾›åˆ—åï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Remove duplicate rows, if any}
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{distinct}\NormalTok{()}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      517            515         2      830            819}
\CommentTok{\#\textgreater{} 2  2013     1     1      533            529         4      850            830}
\CommentTok{\#\textgreater{} 3  2013     1     1      542            540         2      923            850}
\CommentTok{\#\textgreater{} 4  2013     1     1      544            545        {-}1     1004           1022}
\CommentTok{\#\textgreater{} 5  2013     1     1      554            600        {-}6      812            837}
\CommentTok{\#\textgreater{} 6  2013     1     1      554            558        {-}4      740            728}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}

\CommentTok{\# Find all unique origin and destination pairs}
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{distinct}\NormalTok{(origin, dest)}
\CommentTok{\#\textgreater{} \# A tibble: 224 x 2}
\CommentTok{\#\textgreater{}   origin dest }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}  \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 EWR    IAH  }
\CommentTok{\#\textgreater{} 2 LGA    IAH  }
\CommentTok{\#\textgreater{} 3 JFK    MIA  }
\CommentTok{\#\textgreater{} 4 JFK    BQN  }
\CommentTok{\#\textgreater{} 5 LGA    ATL  }
\CommentTok{\#\textgreater{} 6 EWR    ORD  }
\CommentTok{\#\textgreater{} \# i 218 more rows}
\end{Highlighting}
\end{Shaded}

æˆ–è€…ï¼Œå¦‚æœå¸Œæœ›åœ¨ç­›é€‰å”¯ä¸€è¡Œæ—¶ä¿ç•™å…¶ä»–åˆ—ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨.keep\_all =
TRUEé€‰é¡¹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{distinct}\NormalTok{(origin, dest, }\AttributeTok{.keep\_all =} \ConstantTok{TRUE}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 224 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      517            515         2      830            819}
\CommentTok{\#\textgreater{} 2  2013     1     1      533            529         4      850            830}
\CommentTok{\#\textgreater{} 3  2013     1     1      542            540         2      923            850}
\CommentTok{\#\textgreater{} 4  2013     1     1      544            545        {-}1     1004           1022}
\CommentTok{\#\textgreater{} 5  2013     1     1      554            600        {-}6      812            837}
\CommentTok{\#\textgreater{} 6  2013     1     1      554            558        {-}4      740            728}
\CommentTok{\#\textgreater{} \# i 218 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

æ‰€æœ‰è¿™äº›ä¸åŒçš„èˆªç­éƒ½åœ¨1æœˆ1æ—¥å¹¶ä¸æ˜¯å·§åˆï¼šdistinct()ä¼šåœ¨æ•°æ®é›†ä¸­æ‰¾åˆ°ç¬¬ä¸€ä¸ªå‡ºç°çš„å”¯ä¸€è¡Œï¼Œå¹¶ä¸¢å¼ƒå…¶ä½™çš„è¡Œã€‚

å¦‚æœä½ æƒ³è¦æ‰¾åˆ°å‡ºç°çš„æ¬¡æ•°ï¼Œé‚£ä¹ˆæœ€å¥½å°†distinct()æ›¿æ¢ä¸ºcount()ï¼Œå¹¶ä½¿ç”¨sort
= TRUEå‚æ•°ï¼Œä½ å¯ä»¥æŒ‰ç…§å‡ºç°æ¬¡æ•°çš„é™åºæ’åˆ—å®ƒä»¬ã€‚ä½  å°†åœ¨
å°èŠ‚~\ref{sec-counts} å­¦åˆ°æ›´å¤šå…³äºcountçš„å†…å®¹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{count}\NormalTok{(origin, dest, }\AttributeTok{sort =} \ConstantTok{TRUE}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 224 x 3}
\CommentTok{\#\textgreater{}   origin dest      n}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}  \textless{}chr\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 JFK    LAX   11262}
\CommentTok{\#\textgreater{} 2 LGA    ATL   10263}
\CommentTok{\#\textgreater{} 3 LGA    ORD    8857}
\CommentTok{\#\textgreater{} 4 JFK    SFO    8204}
\CommentTok{\#\textgreater{} 5 LGA    CLT    6168}
\CommentTok{\#\textgreater{} 6 EWR    ORD    6100}
\CommentTok{\#\textgreater{} \# i 218 more rows}
\end{Highlighting}
\end{Shaded}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-5}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  é’ˆå¯¹æ¯ä¸ªæ¡ä»¶ï¼Œåœ¨å•ä¸ªç®¡é“ä¸­æŸ¥æ‰¾æ‰€æœ‰ç¬¦åˆä»¥ä¸‹æ¡ä»¶çš„èˆªç­ï¼š

  \begin{itemize}
  \tightlist
  \item
    åˆ°è¾¾å»¶è¯¯ä¸¤å°æ—¶æˆ–æ›´é•¿æ—¶é—´
  \item
    é£å¾€ä¼‘æ–¯æ•¦ï¼ˆIAHæˆ–HOUï¼‰
  \item
    ç”±è”åˆèˆªç©ºï¼ˆUnitedï¼‰ã€ç¾å›½èˆªç©ºï¼ˆAmericanï¼‰,æˆ–è¾¾ç¾èˆªç©ºï¼ˆDeltaï¼‰è¿è¥
  \item
    åœ¨å¤å­£ï¼ˆä¸ƒæœˆã€å…«æœˆå’Œä¹æœˆï¼‰èµ·é£
  \item
    åˆ°è¾¾å»¶è¯¯è¶…è¿‡ä¸¤å°æ—¶ï¼Œä½†èµ·é£ä¸å»¶è¯¯
  \item
    å»¶è¯¯è‡³å°‘ä¸€å°æ—¶ï¼Œä½†åœ¨é£è¡Œä¸­å¼¥è¡¥äº†è¶…è¿‡30åˆ†é’Ÿçš„æ—¶é—´
  \end{itemize}
\item
  å¯¹flights
  è¿›è¡Œæ’åºä»¥æ‰¾åˆ°å‡ºå‘å»¶è¯¯æ—¶é—´æœ€é•¿çš„èˆªç­ï¼›æ‰¾åˆ°æ—©ä¸Šæœ€æ—©èµ·é£çš„èˆªç­ï¼›
\item
  å¯¹flightsè¿›è¡Œæ’åºä»¥æ‰¾åˆ°æœ€å¿«çš„èˆªç­ã€‚ï¼ˆ æç¤º:
  å°è¯•åœ¨å‡½æ•°ä¸­åŒ…å«æ•°å­¦è®¡ç®—ã€‚ï¼‰
\item
  2013å¹´çš„æ¯ä¸€å¤©éƒ½æœ‰èˆªç­å—ï¼Ÿ
\item
  å“ªäº›èˆªç­é£è¡Œäº†æœ€è¿œçš„è·ç¦»ï¼Ÿå“ª äº›é£è¡Œäº†æœ€çŸ­çš„è·ç¦»ï¼Ÿ
\item
  å¦‚æœä½ åŒæ—¶ä½¿ç”¨filter()å’Œarrange()ï¼Œä½ ä½¿ç”¨çš„é¡ºåºé‡è¦å—ï¼Ÿä¸º ä»€ä¹ˆï¼Ÿæ€
  è€ƒä¸€ä¸‹ç»“æœä»¥åŠè¿™äº›å‡½æ•°éœ€è¦æ‰§è¡Œå¤šå°‘å·¥ä½œã€‚
\end{enumerate}

\section{åˆ—}\label{ux5217}

æœ‰å››ä¸ªé‡è¦çš„å‡½æ•°ï¼Œå®ƒä»¬å½±å“åˆ—è€Œä¸æ”¹å˜è¡Œï¼šmutate()ç”¨äºæ ¹æ®ç°æœ‰åˆ—åˆ›å»ºæ–°åˆ—ï¼Œselect()ç”¨äºæ›´æ”¹åˆ—å­˜ç•™ï¼Œrename()ç”¨äºæ›´æ”¹åˆ—çš„åç§°ï¼Œè€Œrelocate()ç”¨äºæ›´æ”¹åˆ—çš„ä½ç½®ã€‚

\subsection{mutate()}\label{sec-mutate}

mutate()çš„ä½œç”¨æ˜¯æ·»åŠ æ ¹æ®ç°æœ‰åˆ—è®¡ç®—å¾—åˆ°çš„æ–°åˆ—ã€‚åœ¨
æ•°æ®è½¬æ¢ç« èŠ‚ä¸­ï¼Œä½ å°†å­¦ä¹ ä¸€ç³»åˆ—å‡½æ•°ï¼Œè¿™äº›å‡½æ•°å¯ç”¨äºå¤„ç†ä¸åŒç±»å‹çš„å˜é‡ã€‚ç›®
å‰ï¼Œæˆ‘ä»¬å°†ç»§ç»­ä½¿ç”¨åŸºç¡€ä»£æ•°ï¼Œè¿™å…è®¸æˆ‘ä»¬è®¡ç®—gainï¼ˆå³å»¶è¯¯èˆªç­åœ¨ç©ºä¸­å¼¥è¡¥äº†å¤šå°‘æ—¶é—´ï¼‰ä»¥åŠæ¯å°æ—¶çš„é€Ÿåº¦ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{gain =}\NormalTok{ dep\_delay }\SpecialCharTok{{-}}\NormalTok{ arr\_delay,}
    \AttributeTok{speed =}\NormalTok{ distance }\SpecialCharTok{/}\NormalTok{ air\_time }\SpecialCharTok{*} \DecValTok{60}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 21}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      517            515         2      830            819}
\CommentTok{\#\textgreater{} 2  2013     1     1      533            529         4      850            830}
\CommentTok{\#\textgreater{} 3  2013     1     1      542            540         2      923            850}
\CommentTok{\#\textgreater{} 4  2013     1     1      544            545        {-}1     1004           1022}
\CommentTok{\#\textgreater{} 5  2013     1     1      554            600        {-}6      812            837}
\CommentTok{\#\textgreater{} 6  2013     1     1      554            558        {-}4      740            728}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 13 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

é»˜è®¤æƒ…å†µä¸‹ï¼Œmutate()ä¼šåœ¨æ•°æ®é›†çš„å³ä¾§æ·»åŠ æ–°åˆ—ï¼Œä½†è¿™ä½¿å¾—æˆ‘ä»¬å¾ˆéš¾çœ‹åˆ°æ•°æ®é›†é‡Œå‘ç”Ÿäº†ä»€ä¹ˆã€‚å¯
ä»¥ä½¿ç”¨.beforeå‚æ•°æ¥å°†å˜é‡æ·»åŠ åˆ°å·¦ä¾§ï¼š

By default, mutate() adds new columns on the right hand side of your
dataset, which makes it difficult to see what's happening here. We can
use the .before argument to instead add the variables to the left hand
side\footnote{Remember that in RStudio, the easiest way to see a dataset
  with many columns is \texttt{View()}.}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{gain =}\NormalTok{ dep\_delay }\SpecialCharTok{{-}}\NormalTok{ arr\_delay,}
    \AttributeTok{speed =}\NormalTok{ distance }\SpecialCharTok{/}\NormalTok{ air\_time }\SpecialCharTok{*} \DecValTok{60}\NormalTok{,}
    \AttributeTok{.before =} \DecValTok{1}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 21}
\CommentTok{\#\textgreater{}    gain speed  year month   day dep\_time sched\_dep\_time dep\_delay arr\_time}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1    {-}9  370.  2013     1     1      517            515         2      830}
\CommentTok{\#\textgreater{} 2   {-}16  374.  2013     1     1      533            529         4      850}
\CommentTok{\#\textgreater{} 3   {-}31  408.  2013     1     1      542            540         2      923}
\CommentTok{\#\textgreater{} 4    17  517.  2013     1     1      544            545        {-}1     1004}
\CommentTok{\#\textgreater{} 5    19  394.  2013     1     1      554            600        {-}6      812}
\CommentTok{\#\textgreater{} 6   {-}16  288.  2013     1     1      554            558        {-}4      740}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 12 more variables: sched\_arr\_time \textless{}int\textgreater{}, arr\_delay \textless{}dbl\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

.æ˜¯ä¸€ä¸ªæ ‡å¿—ï¼Œè¡¨ç¤º.before~æ˜¯å‡½æ•°çš„å‚æ•°ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬æ­£åœ¨åˆ›å»ºçš„ç¬¬ä¸‰ä¸ªæ–°å˜é‡çš„åç§°ã€‚ä½ 
ä¹Ÿå¯ä»¥ä½¿ç”¨.afteråœ¨æŸä¸ªå˜é‡ä¹‹åæ·»åŠ æ–°å˜é‡ï¼Œåœ¨.beforeå’Œ.afterä¸­ï¼Œä½ éƒ½å¯ä»¥ä½¿ç”¨å˜é‡åè€Œä¸æ˜¯ä½ç½®ã€‚ä¾‹
å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨dayä¹‹åæ·»åŠ æ–°å˜é‡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{gain =}\NormalTok{ dep\_delay }\SpecialCharTok{{-}}\NormalTok{ arr\_delay,}
    \AttributeTok{speed =}\NormalTok{ distance }\SpecialCharTok{/}\NormalTok{ air\_time }\SpecialCharTok{*} \DecValTok{60}\NormalTok{,}
    \AttributeTok{.after =}\NormalTok{ day}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

å¦å¤–ï¼Œä½ å¯ä»¥ä½¿ç”¨.keepå‚æ•°æ¥æ§åˆ¶ä¿ç•™å“ªäº›å˜é‡ã€‚ä¸€
ä¸ªç‰¹åˆ«æœ‰ç”¨çš„å‚æ•°æ˜¯''used''ï¼Œå®ƒæŒ‡å®šæˆ‘ä»¬åªä¿ç•™åœ¨mutate()æ­¥éª¤ä¸­æ¶‰åŠæˆ–åˆ›å»ºçš„åˆ—ã€‚ä¾‹
å¦‚ï¼Œä»¥ä¸‹è¾“å‡ºå°†ä»…åŒ…å«dep\_delayã€arr\_delayã€air\_timeã€gainã€hourså’Œgain\_per\_hourè¿™äº›å˜é‡ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{gain =}\NormalTok{ dep\_delay }\SpecialCharTok{{-}}\NormalTok{ arr\_delay,}
    \AttributeTok{hours =}\NormalTok{ air\_time }\SpecialCharTok{/} \DecValTok{60}\NormalTok{,}
    \AttributeTok{gain\_per\_hour =}\NormalTok{ gain }\SpecialCharTok{/}\NormalTok{ hours,}
    \AttributeTok{.keep =} \StringTok{"used"}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„ï¼Œç”±äºæˆ‘ä»¬æ²¡æœ‰å°†ä¸Šè¿°è®¡ç®—çš„ç»“æœé‡æ–°åˆ†é…ç»™flightsæ•°æ®æ¡†ï¼Œæ–°çš„å˜é‡gainã€hourså’Œgain\_per\_houråªä¼šè¢«è¾“å‡ºå‡ºæ¥ï¼Œä½†ä¸ä¼šè¢«å­˜å‚¨åœ¨ä¸€ä¸ªæ•°æ®æ¡†ä¸­ã€‚å¦‚
æœæˆ‘ä»¬å¸Œæœ›è¿™äº›å˜é‡åœ¨æœªæ¥çš„æ•°æ®æ¡†ä¸­å¯ç”¨ï¼Œæˆ‘ä»¬åº”è¯¥ä»”ç»†è€ƒè™‘æ˜¯å¦è¦å°†ç»“æœé‡æ–°åˆ†é…ç»™flightsï¼Œä»è€Œç”¨æ›´å¤šçš„å˜é‡è¦†ç›–åŸå§‹æ•°æ®æ¡†ï¼Œè¿˜æ˜¯åˆ†é…ç»™ä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚é€š
å¸¸ï¼Œæ­£ç¡®çš„ç­”æ¡ˆæ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¹¶ä¸ºå…¶å‘½åä»¥æ¸…æ™°åœ°æŒ‡ç¤ºå…¶å†…å®¹ï¼Œä¾‹å¦‚delay\_gainï¼Œä½†ä½ ä¹Ÿå¯èƒ½æœ‰å……åˆ†çš„ç†ç”±è¦†ç›–flightsã€‚

\subsection{select()}\label{sec-select}

è·å¾—åŒ…å«æ•°ç™¾ç”šè‡³æ•°åƒä¸ªå˜é‡çš„æ•°æ®é›†å¹¶ä¸ç½•è§ã€‚åœ¨
è¿™ç§æƒ…å†µä¸‹ï¼Œç¬¬ä¸€ä¸ªæŒ‘æˆ˜é€šå¸¸æ˜¯ä»…å…³æ³¨ä½ æ„Ÿå…´è¶£çš„å˜é‡ã€‚s
elect()å…è®¸ä½ åŸºäºå˜é‡çš„åç§°ï¼Œé€šè¿‡æ“ä½œå¿«é€Ÿç¼©å°åˆ°ä¸€ä¸ªæœ‰ç”¨çš„å­é›†ï¼š

\begin{itemize}
\item
  æŒ‰åç§°é€‰æ‹©åˆ—:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(year, month, day)}
\end{Highlighting}
\end{Shaded}
\item
  é€‰æ‹©yearå’Œdayä¹‹é—´çš„æ‰€æœ‰åˆ—:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(year}\SpecialCharTok{:}\NormalTok{day)}
\end{Highlighting}
\end{Shaded}
\item
  é€‰æ‹©é™¤äº†ä»yearåˆ°dayçš„æ‰€æœ‰åˆ—ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{!}\NormalTok{year}\SpecialCharTok{:}\NormalTok{day)}
\end{Highlighting}
\end{Shaded}

  å†å²ä¸Šï¼Œè¿™ä¸ªæ“ä½œæ˜¯ç”¨-è€Œä¸æ˜¯!æ¥ å®Œæˆçš„ï¼Œæ‰€ä»¥ä½ å¯èƒ½ä¼šåœ¨å®é™…åœºæ™¯ä¸­çœ‹-ã€‚è¿™
  ä¸¤ä¸ªæ“ä½œç¬¦å…·æœ‰ç›¸åŒçš„ç›®çš„ï¼Œä½†åœ¨è¡Œä¸ºä¸Šæœ‰ç»†å¾®çš„å·®åˆ«ã€‚æˆ‘ ä»¬æ¨èä½¿ç”¨!ï¼Œ
  å› ä¸ºå®ƒè¯»ä½œ``ä¸æ˜¯''ï¼Œå¹¶ä¸”ä¸\&å’Œ\textbar é…åˆå¾—å¾ˆå¥½ã€‚
\item
  é€‰æ‹©æ‰€æœ‰æ˜¯å­—ç¬¦çš„åˆ—ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(}\FunctionTok{where}\NormalTok{(is.character))}
\end{Highlighting}
\end{Shaded}
\end{itemize}

åœ¨select()ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€äº›è¾…åŠ©å‡½æ•°ï¼š

\begin{itemize}
\tightlist
\item
  starts\_with(``abc''): åŒ¹é…ä»¥ ``abc'' å¼€å¤´çš„åç§°ï¼›
\item
  ends\_with(``xyz''): åŒ¹é…ä»¥ ``xyz'' ç»“å°¾çš„åç§°ï¼›
\item
  contains(``ijk''): åŒ¹é…åŒ…å« ``ijk'' çš„åç§°ï¼›
\item
  num\_range(``x'', 1:3): åŒ¹é… x1ã€x2 å’Œ x3ã€‚
\end{itemize}

å‚é˜…?s electä»¥è·å–æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚ä¸€ æ—¦ä½ ç†Ÿæ‚‰äº†æ­£åˆ™è¡¨è¾¾å¼ï¼ˆè¿™æ˜¯
ç« èŠ‚~\ref{sec-regular-expressions}
çš„å†…å®¹ï¼‰ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨matches()æ¥é€‰æ‹©åŒ¹é…æŸä¸ªæ¨¡å¼çš„å˜é‡ã€‚

ä½ å¯ä»¥åœ¨select()å˜é‡æ—¶ä½¿ç”¨=æ¥é‡å‘½åå®ƒä»¬ï¼Œæ–°åç§°å‡ºç°åœ¨=çš„å·¦ä¾§ï¼Œæ—§å˜é‡å‡ºç°åœ¨å³ä¾§ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(}\AttributeTok{tail\_num =}\NormalTok{ tailnum)}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 1}
\CommentTok{\#\textgreater{}   tail\_num}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}   }
\CommentTok{\#\textgreater{} 1 N14228  }
\CommentTok{\#\textgreater{} 2 N24211  }
\CommentTok{\#\textgreater{} 3 N619AA  }
\CommentTok{\#\textgreater{} 4 N804JB  }
\CommentTok{\#\textgreater{} 5 N668DN  }
\CommentTok{\#\textgreater{} 6 N39463  }
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\end{Highlighting}
\end{Shaded}

\subsection{rename()}\label{rename}

å¦‚æœä½ æƒ³ä¿ç•™æ‰€æœ‰ç°æœ‰çš„å˜é‡ï¼Œåªæ˜¯å¯¹å‡ ä¸ªé‡å‘½åï¼Œå¯ä»¥ä½¿ç”¨rename()è€Œä¸æ˜¯select():

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{rename}\NormalTok{(}\AttributeTok{tail\_num =}\NormalTok{ tailnum)}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      517            515         2      830            819}
\CommentTok{\#\textgreater{} 2  2013     1     1      533            529         4      850            830}
\CommentTok{\#\textgreater{} 3  2013     1     1      542            540         2      923            850}
\CommentTok{\#\textgreater{} 4  2013     1     1      544            545        {-}1     1004           1022}
\CommentTok{\#\textgreater{} 5  2013     1     1      554            600        {-}6      812            837}
\CommentTok{\#\textgreater{} 6  2013     1     1      554            558        {-}4      740            728}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

å¦‚æœæ‚¨æœ‰ä¸€å †å‘½åä¸ä¸€è‡´çš„åˆ—ï¼Œå¹¶ä¸”æ‰‹å·¥ä¿®å¤å®ƒä»¬ä¼šå¾ˆç—›è‹¦ï¼Œè¯·æŸ¥çœ‹janitor::clean\_names()ï¼Œå®ƒæä¾›äº†ä¸€äº›æœ‰ç”¨çš„è‡ªåŠ¨æ¸…ç†æ–¹æ³•ã€‚

\subsection{relocate()}\label{relocate}

ä½¿ç”¨relocate()æ¥ç§»åŠ¨å˜é‡ã€‚ä½ 
å¯èƒ½å¸Œæœ›å°†ç›¸å…³å˜é‡æ”¶é›†åœ¨ä¸€èµ·æˆ–å°†é‡è¦å˜é‡ç§»åˆ°å‰é¢ã€‚é»˜
è®¤æƒ…å†µä¸‹ï¼Œrelocate()å°†å˜é‡ç§»åˆ°å‰é¢:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{relocate}\NormalTok{(time\_hour, air\_time)}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 19}
\CommentTok{\#\textgreater{}   time\_hour           air\_time  year month   day dep\_time sched\_dep\_time}
\CommentTok{\#\textgreater{}   \textless{}dttm\textgreater{}                 \textless{}dbl\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 2013{-}01{-}01 05:00:00      227  2013     1     1      517            515}
\CommentTok{\#\textgreater{} 2 2013{-}01{-}01 05:00:00      227  2013     1     1      533            529}
\CommentTok{\#\textgreater{} 3 2013{-}01{-}01 05:00:00      160  2013     1     1      542            540}
\CommentTok{\#\textgreater{} 4 2013{-}01{-}01 05:00:00      183  2013     1     1      544            545}
\CommentTok{\#\textgreater{} 5 2013{-}01{-}01 06:00:00      116  2013     1     1      554            600}
\CommentTok{\#\textgreater{} 6 2013{-}01{-}01 05:00:00      150  2013     1     1      554            558}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 12 more variables: dep\_delay \textless{}dbl\textgreater{}, arr\_time \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨.beforeå’Œ.afterå‚æ•°æŒ‡å®šæ”¾ç½®å®ƒä»¬çš„ä½ç½®ï¼Œå°±åƒmutate()ä¸€æ ·:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{relocate}\NormalTok{(year}\SpecialCharTok{:}\NormalTok{dep\_time, }\AttributeTok{.after =}\NormalTok{ time\_hour)}
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{relocate}\NormalTok{(}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"arr"}\NormalTok{), }\AttributeTok{.before =}\NormalTok{ dep\_time)}
\end{Highlighting}
\end{Shaded}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-6}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  æ¯”è¾ƒdep\_timeã€sched\_dep\_timeå’Œdep\_delayï¼Œä½ è®¤ä¸ºè¿™ä¸‰ä¸ªæ•°å­—æ˜¯å¦‚ä½•è”ç³»èµ·æ¥çš„ï¼Ÿ
\item
  å¤´è„‘é£æš´ï¼Œæƒ³å°½å¯èƒ½å¤šçš„ä»flightsä¸­é€‰æ‹©å˜é‡dep\_timeã€dep\_delayã€arr\_timeå’Œarr\_delayçš„æ–¹æ³•ã€‚
\item
  å¦‚æœåœ¨select()è°ƒç”¨ä¸­å¤šæ¬¡æŒ‡å®šç›¸åŒå˜é‡çš„åç§°ï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿ
\item
  any\_of()å‡½æ•°çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿä¸º ä»€ä¹ˆå®ƒå’Œä¸‹é¢è¿™ä¸ªå‘é‡ç»“åˆä¼šæœ‰ç”¨?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{variables }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"year"}\NormalTok{, }\StringTok{"month"}\NormalTok{, }\StringTok{"day"}\NormalTok{, }\StringTok{"dep\_delay"}\NormalTok{, }\StringTok{"arr\_delay"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  è¿è¡Œä»¥ä¸‹ä»£ç çš„ç»“æœæ˜¯å¦è®©ä½ æ„Ÿåˆ°æƒŠè®¶ï¼Ÿé»˜
  è®¤æƒ…å†µä¸‹ï¼Œselect()çš„è¾…åŠ©å‡½æ•°å¦‚ä½•å¤„ç†å¤§å†™å’Œå°å†™ï¼Ÿå¦‚ ä½•æ›´æ”¹è¯¥é»˜è®¤å€¼ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} \FunctionTok{select}\NormalTok{(}\FunctionTok{contains}\NormalTok{(}\StringTok{"TIME"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}
\item
  å°†air\_timeé‡å‘½åä¸ºair\_time\_minï¼Œä»¥è¡¨æ˜åº¦é‡å•ä½ï¼Œå¹¶å°†å…¶ç§»åŠ¨åˆ°æ•°æ®æ¡†çš„å¼€å¤´ã€‚
\item
  ä¸ºä»€ä¹ˆä¸‹é¢çš„ä»£ç ä¸è¿è¡Œï¼Œerror ä»£è¡¨ä»€ä¹ˆæ„æ€?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(tailnum) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{arrange}\NormalTok{(arr\_delay)}
\CommentTok{\#\textgreater{} Error in \textasciigrave{}arrange()\textasciigrave{}:}
\CommentTok{\#\textgreater{} i In argument: \textasciigrave{}..1 = arr\_delay\textasciigrave{}.}
\CommentTok{\#\textgreater{} Caused by error:}
\CommentTok{\#\textgreater{} ! object \textquotesingle{}arr\_delay\textquotesingle{} not found}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{ç®¡é“}\label{sec-the-pipe}

ä¸Šé¢å·²ç»å±•ç¤ºäº†ç®¡é“çš„ç®€å•ç¤ºä¾‹ï¼Œä½†æ˜¯å½“ä½ å¼€å§‹ç»„åˆä½¿ç”¨å¤šä¸ªå‡½æ•°æ—¶ï¼Œå®ƒçš„çœŸæ­£åŠŸèƒ½æ‰ä¼šå‡ºç°ã€‚ä¾‹
å¦‚ï¼Œå‡è®¾ä½ æƒ³æŸ¥æ‰¾é£å¾€ä¼‘æ–¯é¡¿IAHæœºåœºçš„æœ€å¿«èˆªç­ï¼Œæ‚¨éœ€è¦ç»„åˆå‡½æ•°filter()ã€mutate()ã€select()å’Œarrange():

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(dest }\SpecialCharTok{==} \StringTok{"IAH"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{speed =}\NormalTok{ distance }\SpecialCharTok{/}\NormalTok{ air\_time }\SpecialCharTok{*} \DecValTok{60}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(year}\SpecialCharTok{:}\NormalTok{day, dep\_time, carrier, flight, speed) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(speed))}
\CommentTok{\#\textgreater{} \# A tibble: 7,198 x 7}
\CommentTok{\#\textgreater{}    year month   day dep\_time carrier flight speed}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{} \textless{}chr\textgreater{}    \textless{}int\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     7     9      707 UA         226  522.}
\CommentTok{\#\textgreater{} 2  2013     8    27     1850 UA        1128  521.}
\CommentTok{\#\textgreater{} 3  2013     8    28      902 UA        1711  519.}
\CommentTok{\#\textgreater{} 4  2013     8    28     2122 UA        1022  519.}
\CommentTok{\#\textgreater{} 5  2013     6    11     1628 UA        1178  515.}
\CommentTok{\#\textgreater{} 6  2013     8    27     1017 UA         333  515.}
\CommentTok{\#\textgreater{} \# i 7,192 more rows}
\end{Highlighting}
\end{Shaded}

å³ä½¿è¿™ä¸ªç®¡é“æœ‰å››ä¸ªæ­¥éª¤ï¼Œä¹Ÿå¾ˆå®¹æ˜“æµè§ˆï¼Œå› ä¸ºæ¯ä¸ªæ­¥éª¤çš„å‡½æ•°éƒ½ä½äºæ¯è¡Œçš„å¼€å¤´ï¼šä»flightsæ•°æ®å¼€å§‹ï¼Œç„¶åè¿‡æ»¤ï¼Œè½¬æ¢ï¼Œé€‰æ‹©ï¼Œæœ€åæ’åºã€‚

å¦‚æœæˆ‘ä»¬ä¸ä½¿ç”¨ç®¡é“ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæˆ‘
ä»¬å¯ä»¥å°†æ¯ä¸ªå‡½æ•°è°ƒç”¨åµŒå¥—åœ¨å‰ä¸€ä¸ªè°ƒç”¨å†…éƒ¨ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{arrange}\NormalTok{(}
  \FunctionTok{select}\NormalTok{(}
    \FunctionTok{mutate}\NormalTok{(}
      \FunctionTok{filter}\NormalTok{(}
\NormalTok{        flights, }
\NormalTok{        dest }\SpecialCharTok{==} \StringTok{"IAH"}
\NormalTok{      ),}
      \AttributeTok{speed =}\NormalTok{ distance }\SpecialCharTok{/}\NormalTok{ air\_time }\SpecialCharTok{*} \DecValTok{60}
\NormalTok{    ),}
\NormalTok{    year}\SpecialCharTok{:}\NormalTok{day, dep\_time, carrier, flight, speed}
\NormalTok{  ),}
  \FunctionTok{desc}\NormalTok{(speed)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

æˆ–è€…å¯ä»¥ä½¿ç”¨ä¸€äº›ä¸­é—´å¯¹è±¡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights1 }\OtherTok{\textless{}{-}} \FunctionTok{filter}\NormalTok{(flights, dest }\SpecialCharTok{==} \StringTok{"IAH"}\NormalTok{)}
\NormalTok{flights2 }\OtherTok{\textless{}{-}} \FunctionTok{mutate}\NormalTok{(flights1, }\AttributeTok{speed =}\NormalTok{ distance }\SpecialCharTok{/}\NormalTok{ air\_time }\SpecialCharTok{*} \DecValTok{60}\NormalTok{)}
\NormalTok{flights3 }\OtherTok{\textless{}{-}} \FunctionTok{select}\NormalTok{(flights2, year}\SpecialCharTok{:}\NormalTok{day, dep\_time, carrier, flight, speed)}
\FunctionTok{arrange}\NormalTok{(flights3, }\FunctionTok{desc}\NormalTok{(speed))}
\end{Highlighting}
\end{Shaded}

è™½ç„¶è¿™ä¸¤ç§å½¢å¼éƒ½æœ‰å…¶é€‚ç”¨çš„æ—¶é—´å’Œåœºåˆï¼Œä½†ç®¡é“é€šå¸¸ä¼šäº§ç”Ÿæ›´æ˜“äºç¼–å†™å’Œé˜…è¯»çš„æ•°æ®åˆ†æä»£ç ã€‚

è¦åœ¨ä»£ç ä¸­æ·»åŠ ç®¡é“ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨å†…ç½®çš„é”®ç›˜å¿«æ·é”® Ctrl/Cmd + Shift +
Mã€‚è¦ ä½¿ç”¨\textbar\textgreater è€Œä¸æ˜¯\%\textgreater\%ï¼Œä½ éœ€è¦å¯¹ RStudio
é€‰é¡¹è¿›è¡Œä¸€é¡¹æ›´æ”¹ï¼Œå¦‚ å›¾~\ref{fig-pipe-options}
æ‰€ç¤ºï¼›ç¨åä¼šè¯¦ç»†ä»‹ç»\%\textgreater\%ã€‚

\begin{figure}

\centering{

\includegraphics[width=2.05in,height=\textheight]{screenshots/rstudio-pipe-options.png}

}

\caption{\label{fig-pipe-options}To insert
\texttt{\textbar{}\textgreater{}}, make sure the ``Use native pipe
operator'' option is checked.}

\end{figure}%

\section{Magrittr}\label{sec-the-magtittr}

å¦‚æœæ‚¨å·²ç»ä½¿ç”¨äº†ä¸€æ®µæ—¶é—´çš„tidyverseï¼Œé‚£ä¹ˆä½ å¯èƒ½å¯¹magrittråŒ…æä¾›çš„\%\textgreater\%ç®¡é“å¾ˆç†Ÿæ‚‰ã€‚\textbf{m}
\textbf{agrittr}åŒ…åŒ…å«åœ¨tidyverseä¸­ï¼Œæ‰€ä»¥ä½ å¯ä»¥åœ¨åŠ è½½tidyverseæ—¶ä½¿ç”¨\%\textgreater\%ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}

\NormalTok{mtcars }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(cyl) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{n =} \FunctionTok{n}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

å¯¹äºç®€å•çš„æƒ…å†µï¼Œ\textbar\textgreater å’Œ\%\textgreater\%çš„è¡Œä¸ºæ˜¯ç›¸åŒçš„ã€‚é‚£
ä¹ˆæˆ‘ä»¬ä¸ºä»€ä¹ˆæ¨èåŸºç¡€ç®¡é“\textbar\textgreater å‘¢ï¼Ÿé¦– å…ˆï¼Œå› ä¸ºå®ƒæ˜¯ R
è¯­è¨€çš„åŸºç¡€éƒ¨åˆ†ï¼Œæ‰€ä»¥ä½ æ€»æ˜¯å¯ä»¥ä½¿ç”¨å®ƒï¼Œå³ä½¿ä½ æ²¡æœ‰ä½¿ç”¨ tidyverseã€‚å…¶
æ¬¡ï¼Œ\textbar\textgreater æ¯”\%\textgreater\%ç®€å•å¾—å¤šï¼šåœ¨\%\textgreater\%äº
2014 å¹´è¢«å‘æ˜å’Œ\textbar\textgreater äº 2021 å¹´åœ¨ R 4.1.0
ä¸­è¢«å¼•å…¥ä¹‹é—´çš„è¿™æ®µæ—¶é—´é‡Œï¼Œæˆ‘ä»¬å¯¹ç®¡é“æœ‰äº†æ›´å¥½çš„ç†è§£ã€‚è¿™
ä½¿å¾—\textbar\textgreater èƒ½å¤Ÿèˆå¼ƒé‚£äº›ä¸å¸¸ç”¨ä¸”ä¸å¤ªé‡è¦çš„ç‰¹æ€§ã€‚

\section{åˆ†ç»„}\label{ux5206ux7ec4}

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å·²ç»å­¦ä¹ äº†å¤„ç†è¡Œå’Œåˆ—çš„å‡½æ•°ã€‚å½“
ä½ æ·»åŠ äº†å¤„ç†åˆ†ç»„çš„èƒ½åŠ›æ—¶ï¼Œdplyrä¼šå˜å¾—æ›´åŠ å¼ºå¤§ã€‚åœ¨
æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨æœ€é‡è¦çš„å‡½æ•°ï¼šgroup\_by()ã€summarize()å’Œsliceå‡½æ•°æ—ã€‚

\subsection{group\_by()}\label{group_by}

ä½¿ç”¨group\_by()å°†æ•°æ®é›†åˆ’åˆ†ä¸ºå¯¹åˆ†ææœ‰æ„ä¹‰çš„ç»„:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(month)}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 19}
\CommentTok{\#\textgreater{} \# Groups:   month [12]}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      517            515         2      830            819}
\CommentTok{\#\textgreater{} 2  2013     1     1      533            529         4      850            830}
\CommentTok{\#\textgreater{} 3  2013     1     1      542            540         2      923            850}
\CommentTok{\#\textgreater{} 4  2013     1     1      544            545        {-}1     1004           1022}
\CommentTok{\#\textgreater{} 5  2013     1     1      554            600        {-}6      812            837}
\CommentTok{\#\textgreater{} 6  2013     1     1      554            558        {-}4      740            728}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

group\_by()å¹¶ä¸æ”¹å˜æ•°æ®ï¼Œä½†å¦‚æœä½ ä»”ç»†è§‚å¯Ÿè¾“å‡ºï¼Œä½ ä¼šæ³¨æ„åˆ°è¾“å‡ºæ˜¾ç¤ºå®ƒæ˜¯æŒ‰æœˆ``åˆ†ç»„''ï¼ˆGroups:
month {[}12{]}ï¼‰ã€‚è¿™ æ„å‘³ç€åç»­çš„æ“ä½œå°†``æŒ‰æœˆ''è¿›è¡Œã€‚g
roup\_by()å°†è¿™ä¸ªåˆ†ç»„ç‰¹æ€§ï¼ˆç§°ä¸ºç±»ï¼‰æ·»åŠ åˆ°æ•°æ®æ¡†ä¸­ï¼Œä»è€Œæ”¹å˜äº†åç»­åº”ç”¨äºæ•°æ®çš„å‡½æ•°çš„è¡Œä¸ºã€‚

\subsection{summarize()}\label{sec-summarize}

æœ€é‡è¦çš„åˆ†ç»„æ“ä½œæ˜¯æ±‡æ€»ï¼Œå¦‚æœç”¨äºè®¡ç®—å•ä¸ªæ±‡æ€»ç»Ÿè®¡é‡ï¼Œå®ƒå°†æ•°æ®æ¡†ç¼©å‡ä¸ºæ¯ä¸ªç»„åªæœ‰ä¸€è¡Œã€‚åœ¨
dplyr
ä¸­ï¼Œè¿™ä¸ªæ“ä½œæ˜¯é€šè¿‡summarize()\footnote{å¦‚æœä½ å–œæ¬¢è‹±å¼è‹±è¯­ï¼Œä¹Ÿå¯ä»¥ç”¨\texttt{summarise()}ã€‚}å®Œæˆçš„ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼Œå®ƒè®¡ç®—äº†æ¯ä¸ªæœˆçš„å¹³å‡ç¦»æ¸¯å»¶è¯¯æ—¶é—´ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(month) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{avg\_delay =} \FunctionTok{mean}\NormalTok{(dep\_delay)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 12 x 2}
\CommentTok{\#\textgreater{}   month avg\_delay}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{}     \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1        NA}
\CommentTok{\#\textgreater{} 2     2        NA}
\CommentTok{\#\textgreater{} 3     3        NA}
\CommentTok{\#\textgreater{} 4     4        NA}
\CommentTok{\#\textgreater{} 5     5        NA}
\CommentTok{\#\textgreater{} 6     6        NA}
\CommentTok{\#\textgreater{} \# i 6 more rows}
\end{Highlighting}
\end{Shaded}

å“å‘€ï¼å‡º é”™äº†ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„ç»“æœéƒ½æ˜¯ NAï¼ˆè¯»ä½œ``N-A''ï¼‰ï¼Œè¿™æ˜¯ R
ä¸­ç¼ºå¤±å€¼çš„ç¬¦å·ã€‚è¿™
æ˜¯å› ä¸ºæˆ‘ä»¬è§‚å¯Ÿçš„ä¸€äº›èˆªç­åœ¨å»¶è¯¯åˆ—ä¸­æœ‰ç¼ºå¤±æ•°æ®ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬å°†è¿™äº›å€¼åŒ…æ‹¬åœ¨å†…è®¡ç®—å¹³å‡å€¼æ—¶ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ª
NA ç»“æœã€‚æˆ‘ ä»¬å°†åœ¨ ç« èŠ‚~\ref{sec-missing-values}
éƒ¨åˆ†ä¸­è¯¦ç»†è®¨è®ºç¼ºå¤±å€¼ï¼Œä½†ç°åœ¨æˆ‘ä»¬ä¼šå‘Šè¯‰mean()å‡½æ•°é€šè¿‡è®¾ç½®na.rmå‚æ•°ä¸ºTRUEæ¥å¿½ç•¥æ‰€æœ‰ç¼ºå¤±å€¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(month) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{avg\_delay =} \FunctionTok{mean}\NormalTok{(dep\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 12 x 2}
\CommentTok{\#\textgreater{}   month avg\_delay}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{}     \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1      10.0}
\CommentTok{\#\textgreater{} 2     2      10.8}
\CommentTok{\#\textgreater{} 3     3      13.2}
\CommentTok{\#\textgreater{} 4     4      13.9}
\CommentTok{\#\textgreater{} 5     5      13.0}
\CommentTok{\#\textgreater{} 6     6      20.8}
\CommentTok{\#\textgreater{} \# i 6 more rows}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥åœ¨å•æ¬¡è°ƒç”¨summarize()æ—¶åˆ›å»ºä»»æ„æ•°é‡çš„æ±‡æ€»ã€‚åœ¨
æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­ï¼Œä½ å°†å­¦ä¹ å„ç§æœ‰ç”¨çš„æ±‡æ€»ï¼Œä½†å…¶ä¸­ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ‘˜è¦æ˜¯n()ï¼Œå®ƒè¿”å›æ¯ä¸ªç»„çš„è¡Œæ•°

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(month) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{avg\_delay =} \FunctionTok{mean}\NormalTok{(dep\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{), }
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{()}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 12 x 3}
\CommentTok{\#\textgreater{}   month avg\_delay     n}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{}     \textless{}dbl\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1     1      10.0 27004}
\CommentTok{\#\textgreater{} 2     2      10.8 24951}
\CommentTok{\#\textgreater{} 3     3      13.2 28834}
\CommentTok{\#\textgreater{} 4     4      13.9 28330}
\CommentTok{\#\textgreater{} 5     5      13.0 28796}
\CommentTok{\#\textgreater{} 6     6      20.8 28243}
\CommentTok{\#\textgreater{} \# i 6 more rows}
\end{Highlighting}
\end{Shaded}

Meanså’Œcountsåœ¨æ•°æ®ç§‘å­¦ä¸­å¯ä»¥è®©ä½ èµ°å¾—å¾ˆè¿œï¼Œè¿œåˆ°è®©ä½ åƒæƒŠ!

\subsection{slice\_ å‡½æ•°æ—}\label{slice_-ux51fdux6570ux65cf}

æœ‰äº”ä¸ªå‡½æ•°å…è®¸ä½ æ–¹ä¾¿åœ°æå–æ¯ä¸ªç»„ä¸­å†…ç‰¹å®šè¡Œ:

\begin{itemize}
\tightlist
\item
  df \textbar\textgreater{} slice\_head(n = 1) tä»æ¯ä¸ªç»„ä¸­å–ç¬¬ä¸€è¡Œï¼›
\item
  df \textbar\textgreater{} slice\_tail(n = 1) ä»æ¯ä¸ªç»„ä¸­å–æœ€åä¸€è¡Œï¼›
\item
  df \textbar\textgreater{} slice\_min(x, n = 1) å–åˆ—xå€¼æœ€å°çš„è¡Œï¼›
\item
  df \textbar\textgreater{} slice\_max(x, n = 1) å–åˆ—xå€¼æœ€å¤§çš„è¡Œï¼›
\item
  df \textbar\textgreater{} slice\_sample(n = 1) éšæœºå–ä¸€è¡Œã€‚
\end{itemize}

ä½ å¯ä»¥æ”¹å˜å‚æ•°næ¥é€‰æ‹©å¤šè¡Œï¼Œæˆ–è€…ä»£æ›¿n=ï¼Œä½ å¯ä»¥ä½¿ç”¨prop =
0.1ï¼ˆä¾‹å¦‚ï¼‰æ¥é€‰æ‹©æ¯ä¸ªç»„çš„ 10\% çš„è¡Œã€‚ä¾‹
å¦‚ï¼Œä»¥ä¸‹ä»£ç æŸ¥æ‰¾æ¯ä¸ªç›®çš„åœ°åˆ°è¾¾æ—¶å»¶è¯¯æœ€ä¸¥é‡çš„èˆªç­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(dest) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{slice\_max}\NormalTok{(arr\_delay, }\AttributeTok{n =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{relocate}\NormalTok{(dest)}
\CommentTok{\#\textgreater{} \# A tibble: 108 x 19}
\CommentTok{\#\textgreater{} \# Groups:   dest [105]}
\CommentTok{\#\textgreater{}   dest   year month   day dep\_time sched\_dep\_time dep\_delay arr\_time}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 ABQ    2013     7    22     2145           2007        98      132}
\CommentTok{\#\textgreater{} 2 ACK    2013     7    23     1139            800       219     1250}
\CommentTok{\#\textgreater{} 3 ALB    2013     1    25      123           2000       323      229}
\CommentTok{\#\textgreater{} 4 ANC    2013     8    17     1740           1625        75     2042}
\CommentTok{\#\textgreater{} 5 ATL    2013     7    22     2257            759       898      121}
\CommentTok{\#\textgreater{} 6 AUS    2013     7    10     2056           1505       351     2347}
\CommentTok{\#\textgreater{} \# i 102 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: sched\_arr\_time \textless{}int\textgreater{}, arr\_delay \textless{}dbl\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„ï¼Œè™½ç„¶æœ‰ 105 ä¸ªç›®çš„åœ°ï¼Œä½†æˆ‘ä»¬è¿™é‡Œå¾—åˆ°äº† 108 è¡Œï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿs
lice\_min()å’Œslice\_max()ä¼šä¿ç•™å¹¶åˆ—çš„å€¼ï¼Œæ‰€ä»¥n =
1æ„å‘³ç€ç»™æˆ‘ä»¬æ‰€æœ‰å…·æœ‰æœ€é«˜å€¼çš„è¡Œã€‚å¦‚
æœä½ æƒ³è¦æ¯ä¸ªç»„æ­£å¥½ä¸€è¡Œï¼Œä½ å¯ä»¥è®¾ç½®with\_ties = FALSEã€‚

è¿™ä¸ä½¿ç”¨summarize()è®¡ç®—æœ€å¤§å»¶è¯¯ç±»ä¼¼ï¼Œä½†ä½ ä¼šå¾—åˆ°æ•´ä¸ªå¯¹åº”çš„è¡Œï¼ˆå¦‚æœæœ‰å¹¶åˆ—å€¼ï¼Œåˆ™æ˜¯å¤šè¡Œï¼‰ï¼Œè€Œä¸æ˜¯å•ä¸ªæ±‡æ€»ç»Ÿè®¡é‡ã€‚

\subsection{æŒ‰å¤šå˜é‡åˆ†ç»„}\label{ux6309ux591aux53d8ux91cfux5206ux7ec4}

å¯ä»¥ä½¿ç”¨å¤šä¸ªå˜é‡åˆ›å»ºåˆ†ç»„ã€‚ä¾‹ å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸ªæ—¥æœŸåˆ›å»ºä¸€ä¸ªç»„ã€‚

You can create groups using more than one variable. For example, we
could make a group for each date.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{daily }\OtherTok{\textless{}{-}}\NormalTok{ flights }\SpecialCharTok{|\textgreater{}}  
  \FunctionTok{group\_by}\NormalTok{(year, month, day)}
\NormalTok{daily}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 19}
\CommentTok{\#\textgreater{} \# Groups:   year, month, day [365]}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      517            515         2      830            819}
\CommentTok{\#\textgreater{} 2  2013     1     1      533            529         4      850            830}
\CommentTok{\#\textgreater{} 3  2013     1     1      542            540         2      923            850}
\CommentTok{\#\textgreater{} 4  2013     1     1      544            545        {-}1     1004           1022}
\CommentTok{\#\textgreater{} 5  2013     1     1      554            600        {-}6      812            837}
\CommentTok{\#\textgreater{} 6  2013     1     1      554            558        {-}4      740            728}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

å½“ä½ åœ¨ä½¿ç”¨å¤šä¸ªå˜é‡å¯¹ tibble
è¿›è¡Œåˆ†ç»„å¹¶å¯¹å…¶è¿›è¡Œæ±‡æ€»æ—¶ï¼Œæ¯ä¸ªæ±‡æ€»éƒ½ä¼šå»æ‰æœ€åä¸€ä¸ªåˆ†ç»„ã€‚äº‹
åçœ‹æ¥ï¼Œè¿™ä¸æ˜¯è®©è¿™ä¸ªå‡½æ•°å·¥ä½œçš„å¥½æ–¹æ³•ï¼Œä½†å¦‚æœä¸ç ´åç°æœ‰ä»£ç å°±å¾ˆéš¾æ”¹å˜å®ƒã€‚ä¸º
äº†è®©å‘ç”Ÿçš„äº‹æƒ…å˜å¾—æ˜¾è€Œæ˜“è§ï¼Œdplyr
æ˜¾ç¤ºäº†ä¸€æ¡æ¶ˆæ¯ï¼Œå‘Šè¯‰ä½ å¦‚ä½•æ”¹å˜è¿™ç§è¡Œä¸ºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{daily\_flights }\OtherTok{\textless{}{-}}\NormalTok{ daily }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{n =} \FunctionTok{n}\NormalTok{())}
\CommentTok{\#\textgreater{} \textasciigrave{}summarise()\textasciigrave{} has grouped output by \textquotesingle{}year\textquotesingle{}, \textquotesingle{}month\textquotesingle{}. You can override using}
\CommentTok{\#\textgreater{} the \textasciigrave{}.groups\textasciigrave{} argument.}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ å¯¹è¿™ç§è¡Œä¸ºæ„Ÿåˆ°æ»¡æ„ï¼Œä½ å¯ä»¥æ˜ç¡®åœ°è¦æ±‚å®ƒä»¥æŠ‘åˆ¶è¿™æ¡æ¶ˆæ¯:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{daily\_flights }\OtherTok{\textless{}{-}}\NormalTok{ daily }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{(), }
    \AttributeTok{.groups =} \StringTok{"drop\_last"}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

æˆ–è€…ï¼Œé€šè¿‡è®¾ç½®ä¸åŒçš„å€¼æ¥æ”¹å˜é»˜è®¤è¡Œä¸ºï¼Œä¾‹å¦‚ï¼Œ``drop'' åˆ é™¤æ‰€æœ‰åˆ†ç»„ï¼Œæˆ–è€…
``keep'' ä¿ç•™ç›¸åŒçš„åˆ†ç»„ã€‚

\subsection{å»æ¶ˆåˆ†ç»„}\label{ux53bbux6d88ux5206ux7ec4}

æ‚¨å¯èƒ½è¿˜å¸Œæœ›åœ¨ä¸ä½¿ç”¨summarize()çš„æƒ…å†µä¸‹ä»æ•°æ®æ¡†ä¸­åˆ é™¤åˆ†ç»„ã€‚æ‚¨
å¯ä»¥ä½¿ç”¨ungroup()å®ç°è¿™ä¸€ç‚¹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{daily }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ungroup}\NormalTok{()}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      517            515         2      830            819}
\CommentTok{\#\textgreater{} 2  2013     1     1      533            529         4      850            830}
\CommentTok{\#\textgreater{} 3  2013     1     1      542            540         2      923            850}
\CommentTok{\#\textgreater{} 4  2013     1     1      544            545        {-}1     1004           1022}
\CommentTok{\#\textgreater{} 5  2013     1     1      554            600        {-}6      812            837}
\CommentTok{\#\textgreater{} 6  2013     1     1      554            558        {-}4      740            728}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹åœ¨æ±‡æ€»æœªåˆ†ç»„çš„æ•°æ®æ¡†æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{daily }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ungroup}\NormalTok{() }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{avg\_delay =} \FunctionTok{mean}\NormalTok{(dep\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{), }
    \AttributeTok{flights =} \FunctionTok{n}\NormalTok{()}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 2}
\CommentTok{\#\textgreater{}   avg\_delay flights}
\CommentTok{\#\textgreater{}       \textless{}dbl\textgreater{}   \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1      12.6  336776}
\end{Highlighting}
\end{Shaded}

è¿”å›ä¸€è¡Œï¼Œå› ä¸ºdplyrå°†æœªåˆ†ç»„æ•°æ®æ¡†ä¸­çš„æ‰€æœ‰è¡Œè§†ä¸ºå±äºä¸€ä¸ªç»„ã€‚

\subsection{.by}\label{by}

dplyr 1.1.0
å¼•å…¥äº†ä¸€ä¸ªæ–°çš„å¤„äºè¯•éªŒé˜¶æ®µçš„è¯­æ³•ï¼Œç”¨äºæ¯æ¬¡æ“ä½œçš„åˆ†ç»„ï¼Œå³.byå‚æ•°ã€‚g
roup\_by()å’Œungroup()ä¸ä¼šè¢«å¼ƒç”¨ï¼Œä½†ç°åœ¨ä½ ä¹Ÿå¯ä»¥åœ¨å•ä¸ªæ“ä½œä¸­ä½¿ç”¨.byå‚æ•°è¿›è¡Œåˆ†ç»„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{delay =} \FunctionTok{mean}\NormalTok{(dep\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{), }
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{.by =}\NormalTok{ month}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

æˆ–è€…å¦‚æœä½ æƒ³æŒ‰å¤šä¸ªå˜é‡åˆ†ç»„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{delay =} \FunctionTok{mean}\NormalTok{(dep\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{), }
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{.by =} \FunctionTok{c}\NormalTok{(origin, dest)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

.byä¸æ‰€æœ‰åŠ¨è¯ï¼ˆå‡½æ•°ï¼‰å…¼å®¹ï¼Œå…¶ä¼˜åŠ¿åœ¨äºä½ ä¸éœ€è¦ä½¿ç”¨.groupså‚æ•°æ¥æŠ‘åˆ¶åˆ†ç»„æ¶ˆæ¯ï¼Œæˆ–åœ¨å®Œæˆåä½¿ç”¨ungroup()ã€‚

æˆ‘ä»¬åœ¨ç¼–å†™æœ¬ä¹¦æ—¶ï¼Œæ²¡æœ‰é‡ç‚¹å…³æ³¨è¿™ç§è¯­æ³•ï¼Œå› ä¸ºå®ƒå½“æ—¶éå¸¸æ–°ã€‚ä½†
æˆ‘ä»¬è¿˜æ˜¯æƒ³æä¸€ä¸‹ï¼Œå› ä¸ºæˆ‘ä»¬è®¤ä¸ºå®ƒå¾ˆæœ‰å‰æ™¯ï¼Œå¹¶ä¸”å¯èƒ½ä¼šéå¸¸å—æ¬¢è¿ã€‚ä½ 
å¯ä»¥åœ¨
\href{https://www.tidyverse.org/blog/2023/02/dplyr-1-1-0-per-operation-grouping/}{dplyr
1.1.0 çš„åšå®¢}ä¸­äº†è§£æ›´å¤šå…³äºå®ƒçš„ä¿¡æ¯ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-7}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  å“ªå®¶èˆªç©ºå…¬å¸çš„å¹³å‡å»¶è¯¯æ—¶é—´æœ€é•¿ï¼ŸæŒ‘
  æˆ˜ï¼šä½ èƒ½ç†æ¸…æœºåœºå·®å’Œèˆªç©ºå…¬å¸å·®çš„å½±å“å—ï¼Ÿä¸º ä»€ä¹ˆèƒ½/ä¸ºä»€ä¹ˆä¸èƒ½ï¼Ÿï¼ˆ æç¤º:
  è€ƒè™‘ä½¿ç”¨ flights \textbar\textgreater{} group\_by(carrier, dest)
  \textbar\textgreater{} summarize(n())ï¼‰
\item
  æ‰¾å‡ºä»æ¯ä¸ªç›®çš„åœ°å‡ºå‘å»¶è¯¯æœ€ä¸¥é‡çš„èˆªç­ï¼›
\item
  å»¶è¯¯æƒ…å†µåœ¨ä¸€å¤©ä¸­æ˜¯å¦‚ä½•å˜åŒ–çš„ï¼Ÿç”¨ å›¾è¡¨æ¥å±•ç¤ºä½ çš„ç­”æ¡ˆï¼›
\item
  å¦‚æœä½ ç»™slice\_min()åŠå…¶ç›¸å…³å‡½æ•°æä¾›è´Ÿçš„nå€¼ä¼šæ€æ ·ï¼Ÿ
\item
  ç”¨ä½ åˆšåˆšå­¦ä¹ çš„ dplyr åŠ¨è¯ï¼ˆå‡½æ•°ï¼‰æ¥è§£é‡Šcount()åšäº†ä»€ä¹ˆã€‚c
  ount()çš„sortå‚æ•°æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ
\item
  å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹çš„å°æ•°æ®æ¡†:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{x =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{,}
  \AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"b"}\NormalTok{, }\StringTok{"a"}\NormalTok{, }\StringTok{"a"}\NormalTok{, }\StringTok{"b"}\NormalTok{),}
  \AttributeTok{z =} \FunctionTok{c}\NormalTok{(}\StringTok{"K"}\NormalTok{, }\StringTok{"K"}\NormalTok{, }\StringTok{"L"}\NormalTok{, }\StringTok{"L"}\NormalTok{, }\StringTok{"K"}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \item
    å†™ä¸‹ä½ è®¤ä¸ºçš„è¾“å‡ºæ˜¯ä»€ä¹ˆæ ·å­ï¼Œç„¶åæ£€æŸ¥æ˜¯å¦æ­£ç¡®ï¼Œå¹¶æè¿°group\_by()çš„ä½œç”¨ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}
  \item
    å†™ä¸‹ä½ è®¤ä¸ºçš„è¾“å‡ºæ˜¯ä»€ä¹ˆæ ·å­ï¼Œç„¶åæ£€æŸ¥ä½ æ˜¯å¦æ­£ç¡®ï¼Œå¹¶æè¿°arrange()çš„ä½œç”¨ã€‚åŒ
    æ—¶è¯„è®ºä¸€ä¸‹å®ƒä¸ï¼ˆaï¼‰éƒ¨åˆ†ä¸­çš„group\_by()æœ‰ä»€ä¹ˆä¸åŒã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{arrange}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}
  \item
    å†™ä¸‹ä½ è®¤ä¸ºçš„è¾“å‡ºæ˜¯ä»€ä¹ˆæ ·å­ï¼Œç„¶åæ£€æŸ¥ä½ æ˜¯å¦æ­£ç¡®ï¼Œå¹¶æè¿°ç®¡é“çš„åŠŸèƒ½ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(y) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{mean\_x =} \FunctionTok{mean}\NormalTok{(x))}
\end{Highlighting}
\end{Shaded}
  \item
    å†™ä¸‹ä½ è®¤ä¸ºçš„è¾“å‡ºæ˜¯ä»€ä¹ˆæ ·å­ï¼Œç„¶åæ£€æŸ¥ä½ æ˜¯å¦æ­£ç¡®ï¼Œå¹¶æè¿°ç®¡é“çš„åŠŸèƒ½ã€‚ç„¶
    åå¯¹ä¿¡æ¯å†…å®¹è¿›è¡Œè¯„è®ºã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(y, z) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{mean\_x =} \FunctionTok{mean}\NormalTok{(x))}
\end{Highlighting}
\end{Shaded}
  \item
    å†™ä¸‹ä½ è®¤ä¸ºçš„è¾“å‡ºæ˜¯ä»€ä¹ˆæ ·å­ï¼Œç„¶åæ£€æŸ¥ä½ æ˜¯å¦æ­£ç¡®ï¼Œå¹¶æè¿°ç®¡é“çš„åŠŸèƒ½ã€‚ä¸
    (d)éƒ¨åˆ†ä¸­çš„è¾“å‡ºæœ‰ä½•ä¸åŒ?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(y, z) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{mean\_x =} \FunctionTok{mean}\NormalTok{(x), }\AttributeTok{.groups =} \StringTok{"drop"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
  \item
    å†™ä¸‹ä½ è®¤ä¸ºçš„è¾“å‡ºæ˜¯ä»€ä¹ˆæ ·å­ï¼Œç„¶åæ£€æŸ¥ä½ æ˜¯å¦æ­£ç¡®ï¼Œå¹¶æè¿°æ¯ä¸ªç®¡é“çš„ä½œç”¨ã€‚ä¸¤
    ä¸ªç®¡é“çš„è¾“å‡ºæœ‰ä»€ä¹ˆä¸åŒ?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(y, z) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{mean\_x =} \FunctionTok{mean}\NormalTok{(x))}

\NormalTok{df }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(y, z) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{mean\_x =} \FunctionTok{mean}\NormalTok{(x))}
\end{Highlighting}
\end{Shaded}
  \end{enumerate}
\end{enumerate}

\section{æ¡ˆä¾‹ç ”ç©¶: æ±‡æ€»æ•°æ®å’Œæ ·æœ¬é‡}\label{sec-sample-size}

æ— è®ºä½•æ—¶è¿›è¡Œæ•°æ®æ±‡æ€»ï¼ŒåŒ…å«è®¡æ•°ï¼ˆn()ï¼‰æ€»æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚è¿™
æ ·å¯ä»¥ç¡®ä¿ä½ ä¸æ˜¯åŸºäºå¾ˆå°‘é‡çš„æ•°æ®æ¥å¾—å‡ºç»“è®ºã€‚æˆ‘
ä»¬å°†ä½¿ç”¨\textbf{Lahman}åŒ…ä¸­çš„æ£’çƒæ•°æ®æ¥æ¼”ç¤ºè¿™ä¸€ç‚¹ã€‚å…·
ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å°†æ¯”è¾ƒçƒå‘˜å‡»çƒæˆåŠŸï¼ˆHï¼‰çš„æ¬¡æ•°ä¸å°è¯•å‡»çƒï¼ˆABï¼‰çš„æ¬¡æ•°ä¹‹é—´çš„æ¯”ä¾‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{batters }\OtherTok{\textless{}{-}}\NormalTok{ Lahman}\SpecialCharTok{::}\NormalTok{Batting }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(playerID) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{performance =} \FunctionTok{sum}\NormalTok{(H, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(AB, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{n =} \FunctionTok{sum}\NormalTok{(AB, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  )}
\NormalTok{batters}
\CommentTok{\#\textgreater{} \# A tibble: 20,469 x 3}
\CommentTok{\#\textgreater{}   playerID  performance     n}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}           \textless{}dbl\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 aardsda01      0          4}
\CommentTok{\#\textgreater{} 2 aaronha01      0.305  12364}
\CommentTok{\#\textgreater{} 3 aaronto01      0.229    944}
\CommentTok{\#\textgreater{} 4 aasedo01       0          5}
\CommentTok{\#\textgreater{} 5 abadan01       0.0952    21}
\CommentTok{\#\textgreater{} 6 abadfe01       0.111      9}
\CommentTok{\#\textgreater{} \# i 20,463 more rows}
\end{Highlighting}
\end{Shaded}

å½“æˆ‘ä»¬ç»˜åˆ¶å‡»çƒæ‰‹çš„æŠ€å·§ï¼ˆé€šè¿‡å‡»çƒç‡æ¥è¡¡é‡ï¼Œå³performanceï¼‰ä¸å‡»çƒæœºä¼šçš„æ•°é‡ï¼ˆé€šè¿‡å‡»çƒæ¬¡æ•°æ¥è¡¡é‡ï¼Œå³nï¼‰ä¹‹é—´çš„å…³ç³»æ—¶ï¼Œä½ ä¼šçœ‹åˆ°ä¸¤ç§æ¨¡å¼ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  å‡»çƒæ¬¡æ•°è¾ƒå°‘çš„çƒå‘˜ä¹‹é—´çš„æŠ€å·§å·®å¼‚æ›´å¤§ã€‚è¿™ç§å›¾çš„å½¢çŠ¶éå¸¸å…¸å‹ï¼šæ¯å½“ä½ ç»˜åˆ¶å¹³å‡å€¼ï¼ˆæˆ–å…¶ä»–æ±‡æ€»ç»Ÿè®¡é‡ï¼‰ä¸ç»„å¤§å°æ—¶ï¼Œä½ ä¼šçœ‹åˆ°éšç€æ ·æœ¬é‡çš„å¢åŠ ï¼Œå˜å¼‚ç¨‹åº¦ä¼šé™ä½\footnote{å¤§æ•°å®šå¾‹}ã€‚
\item
  æŠ€å·§ï¼ˆperformanceï¼‰ä¸å‡»çƒæœºä¼šï¼ˆnï¼‰ä¹‹é—´å­˜åœ¨æ­£ç›¸å…³å…³ç³»ï¼Œå› ä¸ºçƒé˜Ÿå¸Œæœ›ç»™ä»–ä»¬çš„æœ€ä½³å‡»çƒæ‰‹æœ€å¤šçš„å‡»çƒæœºä¼šã€‚
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{batters }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(n }\SpecialCharTok{\textgreater{}} \DecValTok{100}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ n, }\AttributeTok{y =}\NormalTok{ performance)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha =} \DecValTok{1} \SpecialCharTok{/} \DecValTok{10}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{data-transform_files/figure-pdf/unnamed-chunk-58-1.pdf}

è¯·æ³¨æ„å°†ggplot2å’Œdplyrç»“åˆä½¿ç”¨çš„ä¾¿æ·æ¨¡å¼ã€‚ä½ 
åªéœ€è¦è®°ä½åœ¨æ•°æ®é›†å¤„ç†æ—¶ä½¿ç”¨\textbar\textgreaterï¼Œè€Œåœ¨å‘ä½ çš„å›¾æ·»åŠ å›¾å±‚æ—¶ä½¿ç”¨+ã€‚

è¿™å¯¹äºæ’åä¹Ÿæœ‰é‡è¦çš„å½±å“ã€‚å¦‚
æœä½ åªæ˜¯ç®€å•åœ°æ ¹æ®desc(performance)è¿›è¡Œæ’åºï¼Œé‚£ä¹ˆæ˜¾ç„¶å‡»çƒç‡æœ€å¥½çš„äººæ˜¯é‚£äº›å°è¯•å‡»çƒæ¬¡æ•°å¾ˆå°‘ä½†ç¢°å·§å‡»ä¸­çš„äººï¼Œä»–ä»¬ä¸ä¸€å®šæ˜¯æŠ€æœ¯æœ€ç†Ÿç»ƒçš„çƒå‘˜ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{batters }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(performance))}
\CommentTok{\#\textgreater{} \# A tibble: 20,469 x 3}
\CommentTok{\#\textgreater{}   playerID  performance     n}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}           \textless{}dbl\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 abramge01           1     1}
\CommentTok{\#\textgreater{} 2 alberan01           1     1}
\CommentTok{\#\textgreater{} 3 banisje01           1     1}
\CommentTok{\#\textgreater{} 4 bartocl01           1     1}
\CommentTok{\#\textgreater{} 5 bassdo01            1     1}
\CommentTok{\#\textgreater{} 6 birasst01           1     2}
\CommentTok{\#\textgreater{} \# i 20,463 more rows}
\end{Highlighting}
\end{Shaded}

å…³äºè¿™ä¸ªé—®é¢˜åŠå…¶è§£å†³æ–¹æ³•ï¼Œä½ å¯ä»¥åœ¨ä»¥ä¸‹ç½‘å€æ‰¾åˆ°å¾ˆå¥½çš„è§£é‡Šï¼š
\url{http://varianceexplained.org/r/empirical_bayes_baseball/} å’Œ
\url{https://www.evanmiller.org/how-not-to-sort-by-average-rating.html}.

\section{å°ç»“}\label{ux5c0fux7ed3-2}

åœ¨æœ¬ç« ä¸­ï¼Œä½ å­¦ä¹ äº†dplyrä¸ºå¤„ç†æ•°æ®æ¡†æä¾›çš„å·¥å…·ã€‚è¿™
äº›å·¥å…·å¤§è‡´åˆ†ä¸ºä¸‰ç±»ï¼šæ“ä½œè¡Œçš„å·¥å…·ï¼ˆå¦‚\texttt{filter()}å’Œ\texttt{arrange()}ï¼‰ï¼Œæ“ä½œåˆ—çš„å·¥å…·ï¼ˆå¦‚\texttt{select()}å’Œ\texttt{mutate()}ï¼‰ï¼Œä»¥åŠæ“ä½œç»„çš„å·¥å…·ï¼ˆå¦‚\texttt{group\_by()}å’Œ\texttt{summarize()}ï¼‰ã€‚åœ¨
æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬ä¸“æ³¨äºè¿™äº›``æ•´ä¸ªæ•°æ®æ¡†''çš„å·¥å…·ï¼Œä½†ä½ è¿˜æ²¡æœ‰æ·±å…¥äº†è§£å¯ä»¥ä½¿ç”¨å•ä¸ªå˜é‡åšä»€ä¹ˆã€‚æˆ‘
ä»¬å°†åœ¨æœ¬ä¹¦çš„è½¬æ¢éƒ¨åˆ†å›åˆ°è¿™ä¸ªé—®é¢˜ï¼Œå…¶ä¸­æ¯ä¸€ç« éƒ½å°†ä¸ºä½ æä¾›ç‰¹å®šç±»å‹å˜é‡çš„å·¥å…·ã€‚

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†å›åˆ°å·¥ä½œæµç¨‹ï¼Œè®¨è®ºä»£ç é£æ ¼çš„é‡è¦æ€§ï¼Œä¿æŒæ‚¨çš„ä»£ç ç»„ç»‡è‰¯å¥½ï¼Œä»¥ä¾¿ä½ å’Œä»–äººèƒ½å¤Ÿè½»æ¾é˜…è¯»å’Œç†è§£ä½ çš„ä»£ç ã€‚

\chapter{å·¥ä½œæµç¨‹: ä»£ç é£æ ¼}\label{sec-workflow-style}

è‰¯å¥½çš„ç¼–ç é£æ ¼å°±åƒæ­£ç¡®çš„æ ‡ç‚¹ç¬¦å·ï¼šæ²¡æœ‰å®ƒä¹Ÿèƒ½å†™ä»£ç ï¼Œä½†å®ƒç¡®å®èƒ½è®©äº‹æƒ…å˜å¾—æ›´æ˜“äºé˜…è¯»ã€‚å³
ä½¿ä½œä¸ºä¸€åéå¸¸æ–°çš„ç¨‹åºå‘˜ï¼Œå…»æˆå¥½çš„ä»£ç é£æ ¼ä¹Ÿæ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚ä½¿
ç”¨ä¸€è‡´çš„ä»£ç é£æ ¼å¯ä»¥è®©ä»–äººï¼ˆåŒ…æ‹¬æœªæ¥çš„ä½ ï¼‰æ›´å®¹æ˜“è¯»æ‡‚ä½ çš„å·¥ä½œï¼Œè¿™åœ¨ä½ éœ€è¦ä»–äººå¸®åŠ©æ—¶å˜å¾—å°¤ä¸ºé‡è¦ã€‚æœ¬
ç« å°†ä»‹ç»\href{https://style.tidyverse.org}{tidyverseé£æ ¼æŒ‡å—}çš„æœ€é‡è¦å†…å®¹ï¼Œè¯¥æŒ‡å—åœ¨æœ¬ä¹¦ä¸­è´¯ç©¿å§‹ç»ˆã€‚

åˆšå¼€å§‹ä¸ºä»£ç è®¾ç½®æ ·å¼å¯èƒ½ä¼šè§‰å¾—æœ‰äº›ä¹å‘³ï¼Œä½†å¦‚æœä½ åšæŒç»ƒä¹ ï¼Œå®ƒå¾ˆå¿«å°±ä¼šæˆä¸ºä½ çš„ç¬¬äºŒå¤©æ€§ã€‚æ­¤
å¤–ï¼Œè¿˜æœ‰ä¸€äº›å¾ˆæ£’çš„å·¥å…·å¯ä»¥å¿«é€Ÿé‡æ–°æ ¼å¼åŒ–ç°æœ‰çš„ä»£ç ï¼Œæ¯”å¦‚Lorenz
Walthertçš„\href{https://styler.r-lib.org}{\textbf{styler}}åŒ…ã€‚ä¸€
æ—¦ä½ ä½¿ç”¨\texttt{install.packages("styler")}å®‰è£…äº†è¿™ä¸ªåŒ…ï¼Œä¸€ä¸ªç®€å•çš„ä½¿ç”¨æ–¹æ³•æ˜¯é€šè¿‡RStudioçš„å‘½ä»¤é¢æ¿ã€‚å‘½
ä»¤é¢æ¿å…è®¸ä½ ä½¿ç”¨ä»»ä½•å†…ç½®çš„RStudioå‘½ä»¤ä»¥åŠç”±åŒ…æä¾›çš„è®¸å¤šæ’ä»¶ã€‚é€š
è¿‡æŒ‰Cmd/Ctrl + Shift +
Pæ‰“å¼€é¢æ¿ï¼Œç„¶åè¾“å…¥``styler''æ¥æŸ¥çœ‹styleræä¾›çš„æ‰€æœ‰å¿«æ·é”®ï¼Œå›¾~\ref{fig-styler}
å±•ç¤ºäº†ç»“æœã€‚

\begin{figure}

\centering{

\includegraphics[width=2.13in,height=\textheight]{screenshots/rstudio-palette.png}

}

\caption{\label{fig-styler}RStudio's command palette makes it easy to
access every RStudio command using only the keyboard.}

\end{figure}%

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨tidyverseå’Œnycflights13åŒ…ä½œä¸ºä»£ç ç¤ºä¾‹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(nycflights13)}
\end{Highlighting}
\end{Shaded}

\section{åç§°}\label{ux540dux79f0}

æˆ‘ä»¬åœ¨@sec-whats-in-a-name ç®€è¦åœ°è®¨è®ºäº†åç§°ã€‚è¯·
è®°ä½ï¼Œå˜é‡åï¼ˆé€šè¿‡\texttt{\textless{}-}å’Œ\texttt{mutate()}åˆ›å»ºçš„ï¼‰åº”è¯¥åªä½¿ç”¨å°å†™å­—æ¯ã€æ•°å­—å’Œ\texttt{\_}ã€‚ä½¿
ç”¨\texttt{\_}æ¥åˆ†éš”åç§°ä¸­çš„å•è¯ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Strive for:}
\NormalTok{short\_flights }\OtherTok{\textless{}{-}}\NormalTok{ flights }\SpecialCharTok{|\textgreater{}} \FunctionTok{filter}\NormalTok{(air\_time }\SpecialCharTok{\textless{}} \DecValTok{60}\NormalTok{)}

\CommentTok{\# Avoid:}
\NormalTok{SHORTFLIGHTS }\OtherTok{\textless{}{-}}\NormalTok{ flights }\SpecialCharTok{|\textgreater{}} \FunctionTok{filter}\NormalTok{(air\_time }\SpecialCharTok{\textless{}} \DecValTok{60}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

ä½œä¸ºä¸€æ¡é€šç”¨çš„ç»éªŒæ³•åˆ™ï¼Œæœ€å¥½é€‰æ‹©é•¿è€Œæè¿°æ€§å¼ºçš„åç§°ï¼Œè¿™æ ·æ›´å®¹æ˜“ç†è§£ï¼Œè€Œä¸æ˜¯å¿«é€Ÿè¾“å…¥çš„ç®€æ´åç§°ã€‚åœ¨
ç¼–å†™ä»£ç æ—¶ï¼ŒçŸ­åç§°èŠ‚çœçš„æ—¶é—´ç›¸å¯¹è¾ƒå°‘ï¼ˆç‰¹åˆ«æ˜¯å½“è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½å¸®åŠ©ä½ å®Œæˆè¾“å…¥æ—¶ï¼‰ï¼Œä½†å½“ä½ å›åˆ°æ—§ä»£ç å¹¶è¢«è¿«çŒœæµ‹ä¸€ä¸ªæ™¦æ¶©çš„ç¼©å†™æ—¶ï¼Œè¿™å¯èƒ½ä¼šå¾ˆè€—æ—¶ã€‚

å¦‚æœä½ æœ‰ä¸€ç»„ä¸ç›¸å…³äº‹ç‰©ç›¸å…³çš„åç§°ï¼Œè¯·å°½é‡ä¿æŒä¸€è‡´ã€‚å½“
ä½ å¿˜è®°ä¹‹å‰çš„çº¦å®šæ—¶ï¼Œä¸ä¸€è‡´æ€§å¾ˆå®¹æ˜“äº§ç”Ÿï¼Œæ‰€ä»¥å¦‚æœä½ å¿…é¡»å›å»é‡å‘½åäº‹ç‰©ï¼Œä¹Ÿä¸è¦æ„Ÿåˆ°éš¾è¿‡ã€‚ä¸€
èˆ¬æ¥è¯´ï¼Œå¦‚æœä½ æœ‰ä¸€ç»„å˜é‡æ˜¯æŸä¸ªä¸»é¢˜çš„å˜ä½“ï¼Œæœ€å¥½ç»™å®ƒä»¬ä¸€ä¸ªå…±åŒçš„å‰ç¼€è€Œä¸æ˜¯å…±åŒçš„åç¼€ï¼Œå› ä¸ºè‡ªåŠ¨è¡¥å…¨åœ¨å˜é‡çš„å¼€å¤´æ•ˆæœæœ€å¥½ã€‚

\section{ç©ºæ ¼}\label{ux7a7aux683c}

åœ¨é™¤\texttt{\^{}}ä»¥å¤–çš„æ•°å­¦è¿ç®—ç¬¦(å³\texttt{-}ã€\texttt{==}ã€\texttt{\textless{}}ã€\ldots)ä»¥åŠèµ‹å€¼è¿ç®—ç¬¦(\texttt{\textless{}-})çš„ä¸¤ä¾§åŠ ä¸Šç©ºæ ¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Strive for}
\NormalTok{z }\OtherTok{\textless{}{-}}\NormalTok{ (a }\SpecialCharTok{+}\NormalTok{ b)}\SpecialCharTok{\^{}}\DecValTok{2} \SpecialCharTok{/}\NormalTok{ d}

\CommentTok{\# Avoid}
\NormalTok{z}\OtherTok{\textless{}{-}}\NormalTok{( a }\SpecialCharTok{+}\NormalTok{ b ) }\SpecialCharTok{\^{}} \DecValTok{2}\SpecialCharTok{/}\NormalTok{d}
\end{Highlighting}
\end{Shaded}

å¯¹äºå¸¸è§„å‡½æ•°è°ƒç”¨ï¼Œä¸è¦åœ¨åœ†æ‹¬å·å†…æˆ–åœ†æ‹¬å·å¤–æ”¾ç©ºæ ¼ã€‚æ€»
æ˜¯åœ¨é€—å·åé¢åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œå°±åƒåœ¨æ ‡å‡†è‹±è¯­ä¸­ä¸€æ ·ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Strive for}
\FunctionTok{mean}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}

\CommentTok{\# Avoid}
\FunctionTok{mean}\NormalTok{ (x ,}\AttributeTok{na.rm=}\ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

å¦‚æœå¯ä»¥æé«˜å¯¹é½æ•ˆæœï¼Œå¯ä»¥æ·»åŠ é¢å¤–çš„ç©ºæ ¼ã€‚ä¾‹
å¦‚ï¼Œå¦‚æœè¦åœ¨mutate()ä¸­åˆ›å»ºå¤šä¸ªå˜é‡ï¼Œåˆ™å¯èƒ½éœ€è¦æ·»åŠ ç©ºæ ¼ï¼Œä»¥ä¾¿æ‰€æœ‰çš„\texttt{=}å¯¹é½\footnote{ç”±äº\texttt{dep\_time}æ˜¯\texttt{HMM}æˆ–\texttt{HHMM}æ ¼å¼ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨æ•´æ•°é™¤æ³•(\texttt{\%/\%})æ¥è·å¾—å°æ—¶ï¼Œä½¿ç”¨ä½™æ•°(ä¹Ÿç§°ä¸ºå–æ¨¡ï¼Œ\texttt{\%\%})æ¥è·å¾—åˆ†é’Ÿã€‚}ã€‚
è¿™ä¼šä½¿å¾—æµè§ˆä»£ç æ›´å®¹æ˜“ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{speed      =}\NormalTok{ distance }\SpecialCharTok{/}\NormalTok{ air\_time,}
    \AttributeTok{dep\_hour   =}\NormalTok{ dep\_time }\SpecialCharTok{\%/\%} \DecValTok{100}\NormalTok{,}
    \AttributeTok{dep\_minute =}\NormalTok{ dep\_time }\SpecialCharTok{\%\%}  \DecValTok{100}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\section{ç®¡é“}\label{sec-pipes}

\texttt{\textbar{}\textgreater{}}å‰é¢åº”è¯¥å§‹ç»ˆæœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œå¹¶ä¸”é€šå¸¸åº”è¯¥æ˜¯è¡Œçš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚è¿™
æ ·åšå¯ä»¥æ›´å®¹æ˜“åœ°æ·»åŠ æ–°æ­¥éª¤ã€é‡æ–°æ’åˆ—ç°æœ‰æ­¥éª¤ã€ä¿®æ”¹æ­¥éª¤ä¸­çš„å…ƒç´ ï¼Œå¹¶é€šè¿‡æµè§ˆå·¦ä¾§çš„åŠ¨è¯ï¼ˆå‡½æ•°ï¼‰æ¥è·å¾—ä¸€ä¸ªå…¨å±€è§†è§’ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Strive for }
\NormalTok{flights }\SpecialCharTok{|\textgreater{}}  
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(arr\_delay), }\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(tailnum)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count}\NormalTok{(dest)}

\CommentTok{\# Avoid}
\NormalTok{flights}\SpecialCharTok{|\textgreater{}}\FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(arr\_delay), }\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(tailnum))}\SpecialCharTok{|\textgreater{}}\FunctionTok{count}\NormalTok{(dest)}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ç®¡é“ä¼ é€’æ•°æ®çš„å‡½æ•°å…·æœ‰è¢«å‘½åçš„å‚æ•°ï¼ˆå¦‚\texttt{mutate()}æˆ–\texttt{summarize()}ï¼‰ï¼Œè¯·å°†æ¯ä¸ªå‚æ•°æ”¾åœ¨æ–°è¡Œä¸Šã€‚å¦‚
æœå‡½æ•°æ²¡æœ‰å‘½åå‚æ•°ï¼ˆå¦‚\texttt{select()}æˆ–\texttt{filter()}ï¼‰ï¼Œåˆ™é™¤éå‚æ•°è¿‡é•¿æ— æ³•æ”¾åœ¨ä¸€è¡Œä¸­ï¼Œå¦åˆ™å°†æ‰€æœ‰å†…å®¹æ”¾åœ¨ä¸€è¡Œä¸Šã€‚åœ¨
å‚æ•°è¿‡é•¿çš„æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥å°†æ¯ä¸ªå‚æ•°æ”¾åœ¨è‡ªå·±çš„è¡Œä¸Šã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Strive for}
\NormalTok{flights }\SpecialCharTok{|\textgreater{}}  
  \FunctionTok{group\_by}\NormalTok{(tailnum) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{delay =} \FunctionTok{mean}\NormalTok{(arr\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{()}
\NormalTok{  )}

\CommentTok{\# Avoid}
\NormalTok{flights }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(}
\NormalTok{    tailnum}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{delay =} \FunctionTok{mean}\NormalTok{(arr\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{), }\AttributeTok{n =} \FunctionTok{n}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

åœ¨ç®¡é“çš„ç¬¬ä¸€æ­¥ä¹‹åï¼Œå°†æ¯è¡Œç¼©è¿›ä¸¤ä¸ªç©ºæ ¼ã€‚åœ¨
\texttt{\textbar{}\textgreater{}}åé¢çš„æ¢è¡Œåï¼ŒRStudioä¼šè‡ªåŠ¨ä¸ºä½ æ·»åŠ ç©ºæ ¼ã€‚å¦‚
æœä½ å°†æ¯ä¸ªå‚æ•°æ”¾åœ¨å•ç‹¬çš„ä¸€è¡Œä¸Šï¼Œåˆ™å†ç¼©è¿›ä¸¤ä¸ªç©ºæ ¼ã€‚ç¡®
ä¿\texttt{)}å•ç‹¬æ”¾åœ¨ä¸€è¡Œä¸Šï¼Œå¹¶ä¸”ä¸ç¼©è¿›ï¼Œä»¥åŒ¹é…å‡½æ•°åçš„æ°´å¹³ä½ç½®ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Strive for }
\NormalTok{flights }\SpecialCharTok{|\textgreater{}}  
  \FunctionTok{group\_by}\NormalTok{(tailnum) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{delay =} \FunctionTok{mean}\NormalTok{(arr\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{()}
\NormalTok{  )}

\CommentTok{\# Avoid}
\NormalTok{flights}\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(tailnum) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
             \AttributeTok{delay =} \FunctionTok{mean}\NormalTok{(arr\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{), }
             \AttributeTok{n =} \FunctionTok{n}\NormalTok{()}
\NormalTok{           )}

\CommentTok{\# Avoid}
\NormalTok{flights}\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(tailnum) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
  \AttributeTok{delay =} \FunctionTok{mean}\NormalTok{(arr\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{), }
  \AttributeTok{n =} \FunctionTok{n}\NormalTok{()}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ çš„ç®¡é“å¯ä»¥å¾ˆå®¹æ˜“åœ°æ”¾åœ¨ä¸€è¡Œä¸Šï¼Œé‚£ä¹ˆå¿½ç•¥ä¸€äº›è§„åˆ™æ˜¯å¯ä»¥çš„ã€‚ä½†
æ ¹æ®æˆ‘ä»¬çš„å…±åŒç»éªŒï¼Œç®€çŸ­çš„ä»£ç ç‰‡æ®µç»å¸¸ä¼šå˜å¾—æ›´é•¿ï¼Œæ‰€ä»¥é€šå¸¸ä¸€å¼€å§‹å°±ä½¿ç”¨æ‰€æœ‰ä½ éœ€è¦çš„å‚ç›´ç©ºé—´ä¼šåœ¨é•¿è¿œä¸ŠèŠ‚çœæ—¶é—´ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# This fits compactly on one line}
\NormalTok{df }\SpecialCharTok{|\textgreater{}} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{y =}\NormalTok{ x }\SpecialCharTok{+} \DecValTok{1}\NormalTok{)}

\CommentTok{\# While this takes up 4x as many lines, it\textquotesingle{}s easily extended to }
\CommentTok{\# more variables and more steps in the future}
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{y =}\NormalTok{ x }\SpecialCharTok{+} \DecValTok{1}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

æœ€åï¼Œè¦è­¦æƒ•ç¼–å†™éå¸¸é•¿çš„ç®¡é“ï¼Œæ¯”å¦‚è¶…è¿‡10-15è¡Œçš„ç®¡é“ã€‚å°
è¯•å°†å®ƒä»¬åˆ†è§£æˆæ›´å°çš„å­ä»»åŠ¡ï¼Œå¹¶ä¸ºæ¯ä¸ªä»»åŠ¡èµ‹äºˆä¸€ä¸ªä¿¡æ¯æ€§å¼ºçš„åç§°ã€‚è¿™
äº›åç§°å°†å¸®åŠ©è¯»è€…äº†è§£æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ï¼Œå¹¶æ›´å®¹æ˜“åœ°æ£€æŸ¥ä¸­é—´ç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸã€‚åª
è¦ä½ èƒ½ä¸ºæŸä¸ªäº‹ç‰©èµ‹äºˆä¸€ä¸ªä¿¡æ¯æ€§å¼ºçš„åç§°ï¼Œä½ å°±åº”è¯¥è¿™æ ·åšï¼Œä¾‹å¦‚å½“ä½ ä»æ ¹æœ¬ä¸Šæ”¹å˜æ•°æ®çš„ç»“æ„æ—¶ï¼Œä¾‹å¦‚åœ¨é€è§†æˆ–æ±‡æ€»ä¹‹åã€‚ä¸
è¦æœŸæœ›ç¬¬ä¸€æ¬¡å°±èƒ½åšå¯¹ï¼è¿™
æ„å‘³ç€ï¼Œå¦‚æœä¸­é—´çŠ¶æ€å¯ä»¥å¾—åˆ°å¥½çš„åç§°ï¼Œå°±åº”è¯¥æ‹†åˆ†é•¿çš„ç®¡é“ã€‚

\section{ggplot2}\label{ggplot2}

é€‚ç”¨äºç®¡é“çš„åŸºæœ¬è§„åˆ™ä¹Ÿé€‚ç”¨äºggplot2ï¼Œå¯¹å¾…\texttt{+}å°±åƒå¯¹å¾…\texttt{\textbar{}\textgreater{}}ä¸€æ ·ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(month) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{delay =} \FunctionTok{mean}\NormalTok{(arr\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ month, }\AttributeTok{y =}\NormalTok{ delay)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

åŒæ ·ï¼Œå¦‚æœä½ ä¸èƒ½å°†å‡½æ•°çš„æ‰€æœ‰å‚æ•°æ”¾åœ¨ä¸€è¡Œä¸­ï¼Œè¯·å°†æ¯ä¸ªå‚æ•°æ”¾åœ¨å•ç‹¬çš„ä¸€è¡Œä¸­:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(dest) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{distance =} \FunctionTok{mean}\NormalTok{(distance),}
    \AttributeTok{speed =} \FunctionTok{mean}\NormalTok{(distance }\SpecialCharTok{/}\NormalTok{ air\_time, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ distance, }\AttributeTok{y =}\NormalTok{ speed)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}
    \AttributeTok{method =} \StringTok{"loess"}\NormalTok{,}
    \AttributeTok{span =} \FloatTok{0.5}\NormalTok{,}
    \AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{, }
    \AttributeTok{color =} \StringTok{"white"}\NormalTok{, }
    \AttributeTok{linewidth =} \DecValTok{4}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

æ³¨æ„ä» \texttt{\textbar{}\textgreater{}} åˆ° \texttt{+} çš„è½¬æ¢ã€‚æˆ‘
ä»¬å¸Œæœ›è¿™ç§è½¬æ¢æ˜¯ä¸å¿…è¦çš„ï¼Œä½†ä¸å¹¸çš„æ˜¯ï¼Œggplot2 æ˜¯åœ¨ç®¡é“å‘æ˜ä¹‹å‰ç¼–å†™çš„ã€‚

\section{åˆ†æ®µæ³¨é‡Š}\label{ux5206ux6bb5ux6ce8ux91ca}

éšç€ä½ çš„è„šæœ¬å˜é•¿ï¼Œä½ å¯ä»¥ä½¿ç”¨åˆ†æ®µæ³¨é‡Šï¼ˆsectioning
commentsï¼‰å°†æ–‡ä»¶åˆ†è§£æˆå¯ç®¡ç†çš„ç‰‡æ®µï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load data {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}

\CommentTok{\# Plot data {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\end{Highlighting}
\end{Shaded}

RStudioæä¾›äº†ä¸€ä¸ªå¿«æ·é”®æ¥åˆ›å»ºè¿™äº›æ ‡é¢˜(Cmd/Ctrl Shift
R)ï¼Œå¹¶å°†å®ƒä»¬æ˜¾ç¤ºåœ¨ç¼–è¾‘å™¨å·¦ä¸‹è§’çš„ä»£ç å¯¼èˆªä¸‹æ‹‰èœå•ä¸­ï¼Œå¦‚
å›¾~\ref{fig-rstudio-sections} æ‰€ç¤ºã€‚

\begin{figure}

\centering{

\includegraphics[width=0.42in,height=\textheight]{screenshots/rstudio-nav.png}

}

\caption{\label{fig-rstudio-sections}After adding sectioning comments to
your script, you can easily navigate to them using the code navigation
tool in the bottom-left of the script editor.}

\end{figure}%

\section{ç»ƒä¹ }\label{ux7ec3ux4e60-8}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  æŒ‰ç…§ä¸Šé¢çš„æŒ‡å—é‡æ–°è®¾è®¡ä»¥ä¸‹ç®¡é“çš„æ ·å¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights}\SpecialCharTok{|\textgreater{}}\FunctionTok{filter}\NormalTok{(dest}\SpecialCharTok{==}\StringTok{"IAH"}\NormalTok{)}\SpecialCharTok{|\textgreater{}}\FunctionTok{group\_by}\NormalTok{(year,month,day)}\SpecialCharTok{|\textgreater{}}\FunctionTok{summarize}\NormalTok{(}\AttributeTok{n=}\FunctionTok{n}\NormalTok{(),}
\AttributeTok{delay=}\FunctionTok{mean}\NormalTok{(arr\_delay,}\AttributeTok{na.rm=}\ConstantTok{TRUE}\NormalTok{))}\SpecialCharTok{|\textgreater{}}\FunctionTok{filter}\NormalTok{(n}\SpecialCharTok{\textgreater{}}\DecValTok{10}\NormalTok{)}

\NormalTok{flights}\SpecialCharTok{|\textgreater{}}\FunctionTok{filter}\NormalTok{(carrier}\SpecialCharTok{==}\StringTok{"UA"}\NormalTok{,dest}\SpecialCharTok{\%in\%}\FunctionTok{c}\NormalTok{(}\StringTok{"IAH"}\NormalTok{,}\StringTok{"HOU"}\NormalTok{),sched\_dep\_time}\SpecialCharTok{\textgreater{}}
\DecValTok{0900}\NormalTok{,sched\_arr\_time}\SpecialCharTok{\textless{}}\DecValTok{2000}\NormalTok{)}\SpecialCharTok{|\textgreater{}}\FunctionTok{group\_by}\NormalTok{(flight)}\SpecialCharTok{|\textgreater{}}\FunctionTok{summarize}\NormalTok{(}\AttributeTok{delay=}\FunctionTok{mean}\NormalTok{(}
\NormalTok{arr\_delay,}\AttributeTok{na.rm=}\ConstantTok{TRUE}\NormalTok{),}\AttributeTok{cancelled=}\FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(arr\_delay)),}\AttributeTok{n=}\FunctionTok{n}\NormalTok{())}\SpecialCharTok{|\textgreater{}}\FunctionTok{filter}\NormalTok{(n}\SpecialCharTok{\textgreater{}}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{å°ç»“}\label{ux5c0fux7ed3-3}

åœ¨æœ¬ç« ä¸­ï¼Œä½ å­¦ä¹ äº†ä»£ç é£æ ¼æœ€é‡è¦çš„åŸåˆ™ã€‚è¿™
äº›åŸåˆ™ä¸€å¼€å§‹å¯èƒ½æ„Ÿè§‰åƒæ˜¯ä¸€å¥—ä»»æ„çš„è§„åˆ™ï¼ˆå› ä¸ºå®ƒä»¬ç¡®å®æ˜¯ï¼‰ï¼Œä½†éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå½“ä½ ç¼–å†™æ›´å¤šçš„ä»£ç å¹¶ä¸æ›´å¤šçš„äººåˆ†äº«ä»£ç æ—¶ï¼Œä½ ä¼šçœ‹åˆ°ä¸€è‡´çš„æ ·å¼æ˜¯å¤šä¹ˆé‡è¦ã€‚åˆ«
å¿˜äº†styleråŒ…ï¼Œå®ƒæ˜¯å¿«é€Ÿæé«˜æ ·å¼ä¸ä½³çš„ä»£ç è´¨é‡çš„ç»ä½³æ–¹å¼ã€‚

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†å›åˆ°æ•°æ®ç§‘å­¦å·¥å…·ï¼Œå­¦ä¹ æ•´ç†æ•°æ®ã€‚æ•´
ç†æ•°æ®æ˜¯ä¸€ç§ç»„ç»‡æ•°æ®æ¡†çš„ä¸€è‡´æ–¹å¼ï¼Œå®ƒåœ¨tidyverseä¸­å¾—åˆ°äº†å¹¿æ³›åº”ç”¨ã€‚è¿™
ç§ä¸€è‡´æ€§è®©ä½ çš„ç”Ÿæ´»å˜å¾—æ›´åŠ å®¹æ˜“ï¼Œå› ä¸ºä¸€æ—¦ä½ æœ‰äº†æ•´æ´çš„æ•°æ®ï¼Œå®ƒå°±å¯ä»¥ä¸ç»å¤§å¤šæ•°tidyverseå‡½æ•°ä¸€èµ·å·¥ä½œã€‚å½“
ç„¶ï¼Œç”Ÿæ´»ä»æ¥éƒ½ä¸å®¹æ˜“ï¼Œä½ åœ¨å®é™…ä¸­é‡åˆ°çš„å¤§å¤šæ•°æ•°æ®é›†éƒ½ä¸ä¼šæ˜¯æ•´æ´çš„ã€‚æ‰€
ä»¥ï¼Œæˆ‘ä»¬è¿˜å°†æ•™ä½ å¦‚ä½•ä½¿ç”¨tidyråŒ…æ¥æ•´ç†ä½ çš„ä¸æ•´æ´çš„æ•°æ®ã€‚

\chapter{æ•°æ®æ•´ç†}\label{sec-data-tidy}

\section{å¼•è¨€}\label{ux5f15ux8a00-2}

\begin{quote}
``å¹¸ç¦çš„å®¶åº­éƒ½æ˜¯ç›¸ä¼¼çš„ï¼›æ¯ä¸ªä¸å¹¸çš„å®¶åº­å„æœ‰å„çš„ä¸å¹¸ã€‚''\\
--- åˆ—å¤«Â·æ‰˜å°”æ–¯æ³°
\end{quote}

\begin{quote}
``æ•´æ´çš„æ•°æ®é›†éƒ½æ˜¯ç›¸ä¼¼çš„ï¼Œä½†æ¯ä¸ªæ··ä¹±çš„æ•°æ®é›†å„æœ‰å„çš„æ··ä¹±æ–¹å¼ã€‚''\\
--- å“ˆå¾·åˆ©Â·å¨å…‹æ±‰å§†
\end{quote}

åœ¨æœ¬ç« ä¸­ï¼Œä½ å°†å­¦ä¹ ä¸€ç§åœ¨Rä¸­ç»„ç»‡æ•°æ®çš„ä¸€è‡´æ–¹æ³•ï¼Œå³åˆ©ç”¨ä¸€ç§è¢«ç§°ä¸ºæ•´é½æ•°æ®ï¼ˆtidy
dataï¼‰çš„ç³»ç»Ÿã€‚å°†
æ•°æ®æ•´ç†æˆè¿™ç§æ ¼å¼éœ€è¦ä¸€äº›å‰æœŸå·¥ä½œï¼Œä½†ä»é•¿è¿œæ¥çœ‹ï¼Œè¿™äº›å·¥ä½œæ˜¯å€¼å¾—çš„ã€‚ä¸€
æ—¦ä½ æœ‰äº†æ•´é½çš„æ•°æ®å’ŒtidyverseåŒ…æä¾›çš„æ•´ç†å·¥å…·ï¼Œä½ å°†èŠ±è´¹æ›´å°‘çš„æ—¶é—´å°†æ•°æ®ä»ä¸€ç§è¡¨ç°å½¢å¼è½¬æ¢ä¸ºå¦ä¸€ç§è¡¨ç°å½¢å¼ï¼Œä»è€Œè®©ä½ æœ‰æ›´å¤šçš„æ—¶é—´æŠ•å…¥åˆ°ä½ å…³å¿ƒçš„æ•°æ®é—®é¢˜ä¸Šã€‚

åœ¨æœ¬ç« ä¸­ï¼Œä½ å°†é¦–å…ˆå­¦ä¹ æ•´é½æ•°æ®çš„å®šä¹‰ï¼Œå¹¶å°†å…¶åº”ç”¨äºä¸€ä¸ªç®€å•çš„ç¤ºä¾‹æ•°æ®é›†ã€‚ç„¶
åï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ç”¨äºæ•´ç†æ•°æ®çš„ä¸»è¦å·¥å…·ï¼šæ•°æ®é‡å¡‘ï¼ˆdata
pivotingï¼‰ï¼Œæ•°æ®é€è§†å…è®¸ä½ æ”¹å˜æ•°æ®çš„æ ¼å¼è€Œä¸æ”¹å˜ä»»ä½•å€¼ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-2}

æœ¬ç« å°†é‡ç‚¹ä»‹ç»\texttt{tidyr}ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—å·¥å…·æ¥å¸®åŠ©æ•´ç†æ··ä¹±çš„æ•°æ®é›†ï¼Œæ˜¯tidyverseçš„ä¸€ä¸ªæˆå‘˜ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

ä»æœ¬ç« å¼€å§‹ï¼Œæˆ‘ä»¬å°†é˜»æ­¢\texttt{library(tidyverse)}çš„åŠ è½½æ¶ˆæ¯ã€‚

\section{æ•´é½æ•°æ®}\label{sec-tidy-data}

ä½ å¯ä»¥ç”¨å¤šç§æ–¹å¼è¡¨ç¤ºç›¸åŒçš„åŸºç¡€æ•°æ®ã€‚ä¸‹
é¢çš„ä¾‹å­å±•ç¤ºäº†ä»¥ä¸‰ç§ä¸åŒçš„æ–¹å¼ç»„ç»‡çš„åŒä¸€æ•°æ®ã€‚æ¯
ä¸ªæ•°æ®é›†éƒ½æ˜¾ç¤ºäº†å››ä¸ªå˜é‡çš„ç›¸åŒå€¼ï¼šå›½å®¶ï¼ˆ\emph{country}ï¼‰ã€å¹´ä»½ï¼ˆ\emph{year}ï¼‰ã€äººå£ï¼ˆ\emph{population}ï¼‰å’Œè®°å½•åœ¨æ¡ˆçš„ç»“æ ¸ç—…ï¼ˆtuberculosisï¼ŒTBï¼‰ç—…ä¾‹æ•°ï¼ˆ\emph{cases}ï¼‰ï¼Œä½†æ¯ä¸ªæ•°æ®é›†éƒ½ä»¥ä¸åŒçš„æ–¹å¼ç»„ç»‡è¿™äº›å€¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{table1}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 4}
\CommentTok{\#\textgreater{}   country      year  cases population}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}       \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}      \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 Afghanistan  1999    745   19987071}
\CommentTok{\#\textgreater{} 2 Afghanistan  2000   2666   20595360}
\CommentTok{\#\textgreater{} 3 Brazil       1999  37737  172006362}
\CommentTok{\#\textgreater{} 4 Brazil       2000  80488  174504898}
\CommentTok{\#\textgreater{} 5 China        1999 212258 1272915272}
\CommentTok{\#\textgreater{} 6 China        2000 213766 1280428583}

\NormalTok{table2}
\CommentTok{\#\textgreater{} \# A tibble: 12 x 4}
\CommentTok{\#\textgreater{}   country      year type           count}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}       \textless{}dbl\textgreater{} \textless{}chr\textgreater{}          \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 Afghanistan  1999 cases            745}
\CommentTok{\#\textgreater{} 2 Afghanistan  1999 population  19987071}
\CommentTok{\#\textgreater{} 3 Afghanistan  2000 cases           2666}
\CommentTok{\#\textgreater{} 4 Afghanistan  2000 population  20595360}
\CommentTok{\#\textgreater{} 5 Brazil       1999 cases          37737}
\CommentTok{\#\textgreater{} 6 Brazil       1999 population 172006362}
\CommentTok{\#\textgreater{} \# i 6 more rows}

\NormalTok{table3}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 3}
\CommentTok{\#\textgreater{}   country      year rate             }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}       \textless{}dbl\textgreater{} \textless{}chr\textgreater{}            }
\CommentTok{\#\textgreater{} 1 Afghanistan  1999 745/19987071     }
\CommentTok{\#\textgreater{} 2 Afghanistan  2000 2666/20595360    }
\CommentTok{\#\textgreater{} 3 Brazil       1999 37737/172006362  }
\CommentTok{\#\textgreater{} 4 Brazil       2000 80488/174504898  }
\CommentTok{\#\textgreater{} 5 China        1999 212258/1272915272}
\CommentTok{\#\textgreater{} 6 China        2000 213766/1280428583}
\end{Highlighting}
\end{Shaded}

å®ƒä»¬éƒ½è¡¨ç¤ºäº†åŒä¸€åŸºç¡€æ•°æ®ï¼Œä½†ä½¿ç”¨éš¾åº¦å¹¶ä¸ç›¸åŒã€‚å…¶ ä¸­ï¼Œ\texttt{table1}
åœ¨tidyverseä¸­æ›´å®¹æ˜“ä½¿ç”¨ï¼Œå› ä¸ºå®ƒå¾ˆæ•´é½ï¼ˆtidyï¼‰ã€‚

ä½¿ä¸€ä¸ªæ•°æ®é›†æ•´é½çš„ä¸‰ä¸ªç›¸äº’å…³è”çš„è§„åˆ™æ˜¯ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  æ¯ä¸ªå˜é‡éƒ½æ˜¯ä¸€åˆ—ï¼›æ¯ä¸€åˆ—éƒ½æ˜¯ä¸€ä¸ªå˜é‡ï¼›
\item
  æ¯ä¸ªè§‚æµ‹å€¼éƒ½æ˜¯ä¸€è¡Œï¼›æ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªè§‚æµ‹å€¼ï¼›
\item
  æ¯ä¸ªå€¼éƒ½æ˜¯ä¸€ä¸ªå•å…ƒæ ¼ï¼›æ¯ä¸ªå•å…ƒæ ¼éƒ½æ˜¯ä¸€ä¸ªå•ä¸€çš„å€¼ã€‚
\end{enumerate}

å›¾~\ref{fig-tidy-structure} ç›´è§‚åœ°å±•ç¤ºäº†è¿™äº›è§„åˆ™ã€‚

\begin{figure}

\centering{

\includegraphics[width=7.11in,height=\textheight]{images/tidy-1.png}

}

\caption{\label{fig-tidy-structure}The following three rules make a
dataset tidy: variables are columns, observations are rows, and values
are cells.}

\end{figure}%

ä¸ºä»€ä¹ˆè¦ç¡®ä¿ä½ çš„æ•°æ®æ˜¯æ•´é½çš„ï¼Ÿæœ‰ ä¸¤ä¸ªä¸»è¦ä¼˜åŠ¿ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  é€‰æ‹©ä¸€ç§ä¸€è‡´çš„æ•°æ®å­˜å‚¨æ–¹å¼å…·æœ‰æ™®éä¼˜åŠ¿ã€‚å¦‚æœä½ çš„æ•°æ®ç»“æ„æ˜¯ä¸€è‡´çš„ï¼Œå­¦ä¹ ä¸ä¹‹é…åˆä½¿ç”¨çš„å·¥å…·å°±æ›´å®¹æ˜“ï¼Œå› ä¸ºå®ƒä»¬å…·æœ‰åº•å±‚çš„ä¸€è‡´æ€§ã€‚
\item
  å°†å˜é‡æ”¾åœ¨åˆ—ä¸­å…·æœ‰ç‰¹å®šçš„ä¼˜åŠ¿ï¼Œå› ä¸ºè¿™å¯ä»¥è®©Rçš„çŸ¢é‡åŒ–ç‰¹æ€§å¤§æ”¾å¼‚å½©ã€‚æ­£å¦‚ä½ åœ¨@sec-mutate
  å’Œ@sec-summarize
  æ‰€å­¦åˆ°çš„ï¼Œå¤§å¤šæ•°å†…ç½®çš„Rå‡½æ•°éƒ½ä½¿ç”¨å€¼çš„å‘é‡ã€‚è¿™ä½¿å¾—å¤„ç†æ•´é½æ•°æ®æ„Ÿè§‰ç‰¹åˆ«è‡ªç„¶ã€‚
\end{enumerate}

dplyrã€ggplot2ä»¥åŠtidyverseä¸­çš„æ‰€æœ‰å…¶ä»–åŒ…éƒ½æ˜¯ä¸ºå¤„ç†æ•´é½æ•°æ®è€Œè®¾è®¡çš„ã€‚ä¸‹
é¢ä»£ç æ˜¯ä¸€äº›å±•ç¤ºå¦‚ä½•ä½¿ç”¨\texttt{table1}çš„å°ç¤ºä¾‹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Compute rate per 10,000}
\NormalTok{table1 }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{rate =}\NormalTok{ cases }\SpecialCharTok{/}\NormalTok{ population }\SpecialCharTok{*} \DecValTok{10000}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 5}
\CommentTok{\#\textgreater{}   country      year  cases population  rate}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}       \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}      \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 Afghanistan  1999    745   19987071 0.373}
\CommentTok{\#\textgreater{} 2 Afghanistan  2000   2666   20595360 1.29 }
\CommentTok{\#\textgreater{} 3 Brazil       1999  37737  172006362 2.19 }
\CommentTok{\#\textgreater{} 4 Brazil       2000  80488  174504898 4.61 }
\CommentTok{\#\textgreater{} 5 China        1999 212258 1272915272 1.67 }
\CommentTok{\#\textgreater{} 6 China        2000 213766 1280428583 1.67}

\CommentTok{\# Compute total cases per year}
\NormalTok{table1 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(year) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{total\_cases =} \FunctionTok{sum}\NormalTok{(cases))}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 2}
\CommentTok{\#\textgreater{}    year total\_cases}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{}       \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1  1999      250740}
\CommentTok{\#\textgreater{} 2  2000      296920}

\CommentTok{\# Visualize changes over time}
\FunctionTok{ggplot}\NormalTok{(table1, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ year, }\AttributeTok{y =}\NormalTok{ cases)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{group =}\NormalTok{ country), }\AttributeTok{color =} \StringTok{"grey50"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ country, }\AttributeTok{shape =}\NormalTok{ country)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{c}\NormalTok{(}\DecValTok{1999}\NormalTok{, }\DecValTok{2000}\NormalTok{)) }\CommentTok{\# x{-}axis breaks at 1999 and 2000}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=15.625in,height=\textheight]{data-tidy_files/figure-pdf/unnamed-chunk-5-1.pdf}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-9}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  å¯¹äºæ¯ä¸ªç¤ºä¾‹è¡¨æ ¼ï¼Œæè¿°æ¯ä¸ªè§‚æµ‹å€¼å’Œæ¯åˆ—åˆ†åˆ«ä»£è¡¨ä»€ä¹ˆã€‚
\item
  æ¦‚è¿°ä½ å°†å¦‚ä½•è®¡ç®—\texttt{table2}å’Œ\texttt{table3}ä¸­çš„\texttt{rate}ã€‚ä½ 
  éœ€è¦æ‰§è¡Œå››ä¸ªæ“ä½œï¼š

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \tightlist
  \item
    æå–æ¯ä¸ªå›½å®¶æ¯å¹´çš„TBç—…ä¾‹æ•°ï¼›
  \item
    æå–æ¯ä¸ªå›½å®¶æ¯å¹´å¯¹åº”çš„äººå£æ•°ï¼›
  \item
    å°†ç—…ä¾‹æ•°é™¤ä»¥äººå£æ•°ï¼Œç„¶åä¹˜ä»¥10000ï¼›
  \item
    å°†ç»“æœå­˜å‚¨å›é€‚å½“çš„åœ°æ–¹.
  \end{enumerate}

  ä½ è¿˜æ²¡æœ‰å­¦ä¹ æ‰€æœ‰å®é™…æ‰§è¡Œè¿™äº›æ“ä½œæ‰€éœ€çš„å‡½æ•°ï¼Œä½†åº”è¯¥ä»ç„¶èƒ½å¤Ÿæ€è€ƒå‡ºæ‰€éœ€çš„è½¬æ¢æ­¥éª¤ã€‚
\end{enumerate}

\section{æ•°æ®è½¬æ¢---é•¿æ ¼å¼}\label{sec-pivoting}

æ•´é½æ•°æ®çš„åŸåˆ™å¯èƒ½çœ‹èµ·æ¥å¦‚æ­¤æ˜¾è€Œæ˜“è§ï¼Œä»¥è‡³äºä½ æ€€ç–‘æ˜¯å¦ä¼šé‡åˆ°ä¸æ•´é½çš„æ•°æ®é›†ã€‚ç„¶
è€Œï¼Œä¸å¹¸çš„æ˜¯ï¼Œå¤§å¤šæ•°çœŸå®æ•°æ®éƒ½æ˜¯ä¸æ•´é½çš„ã€‚è¿™ ä¸»è¦æœ‰ä¸¤ä¸ªåŸå› ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  æ•°æ®é€šå¸¸æ˜¯ä¸ºäº†æ–¹ä¾¿é™¤äº†åˆ†æä»¥å¤–çš„å…¶ä»–ç›®çš„è€Œç»„ç»‡çš„ã€‚ä¾‹
  å¦‚ï¼Œæ•°æ®é€šå¸¸ä»¥æ˜“äºæ•°æ®å½•å…¥è€Œä¸æ˜¯åˆ†æçš„ç»“æ„æ¥ç»„ç»‡ã€‚
\item
  å¤§å¤šæ•°äººå¹¶ä¸ç†Ÿæ‚‰æ•´é½æ•°æ®çš„åŸåˆ™ï¼Œé™¤éä½ èŠ±å¾ˆå¤šæ—¶é—´å¤„ç†æ•°æ®ï¼Œå¦åˆ™å¾ˆéš¾è‡ªå·±æ¨å¯¼å‡ºè¿™äº›åŸåˆ™ã€‚
\end{enumerate}

è¿™æ„å‘³ç€å¤§å¤šæ•°å®é™…åˆ†æè‡³å°‘éœ€è¦è¿›è¡Œä¸€äº›æ•´ç†ã€‚é¦–
å…ˆè¦å¼„æ¸…æ¥šåŸºç¡€å˜é‡å’Œè§‚æµ‹å€¼æ˜¯ä»€ä¹ˆï¼Œæœ‰æ—¶è¿™å¾ˆç®€å•ï¼Œæœ‰æ—¶ä½ éœ€è¦å’¨è¯¢æœ€åˆç”Ÿæˆæ•°æ®çš„äººï¼›æ¥ä¸‹æ¥ï¼Œä½ éœ€è¦å°†æ•°æ®é‡å¡‘ï¼ˆ\textbf{pivot}ï¼‰ä¸ºæ•´é½çš„å½¢å¼ï¼Œå°†å˜é‡æ”¾åœ¨åˆ—ä¸­ï¼Œå°†è§‚æµ‹å€¼æ”¾åœ¨è¡Œä¸­ã€‚

tidyråŒ…æä¾›äº†ä¸¤ä¸ªç”¨äºæ•°æ®é‡å¡‘çš„å‡½æ•°ï¼š\texttt{pivot\_longer()}å’Œ\texttt{pivot\_wider()}ã€‚æˆ‘
ä»¬å°†é¦–å…ˆä»\texttt{pivot\_longer()}å¼€å§‹ï¼Œå› ä¸ºå®ƒæ˜¯æœ€å¸¸è§çš„æƒ…å†µã€‚è®©
æˆ‘ä»¬æ·±å…¥æ¢è®¨ä¸€äº›ç¤ºä¾‹ã€‚

\subsection{åˆ—åä¸­çš„æ•°æ®}\label{sec-billboard}

\texttt{billboard}æ•°æ®é›†è®°å½•äº† 2000 å¹´æ­Œæ›²çš„ Billboard æ’è¡Œæ¦œæ’å:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{billboard}
\CommentTok{\#\textgreater{} \# A tibble: 317 x 79}
\CommentTok{\#\textgreater{}   artist       track               date.entered   wk1   wk2   wk3   wk4   wk5}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}        \textless{}chr\textgreater{}               \textless{}date\textgreater{}       \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 2 Pac        Baby Don\textquotesingle{}t Cry (Ke\textasciitilde{} 2000{-}02{-}26      87    82    72    77    87}
\CommentTok{\#\textgreater{} 2 2Ge+her      The Hardest Part O\textasciitilde{} 2000{-}09{-}02      91    87    92    NA    NA}
\CommentTok{\#\textgreater{} 3 3 Doors Down Kryptonite          2000{-}04{-}08      81    70    68    67    66}
\CommentTok{\#\textgreater{} 4 3 Doors Down Loser               2000{-}10{-}21      76    76    72    69    67}
\CommentTok{\#\textgreater{} 5 504 Boyz     Wobble Wobble       2000{-}04{-}15      57    34    25    17    17}
\CommentTok{\#\textgreater{} 6 98\^{}0         Give Me Just One N\textasciitilde{} 2000{-}08{-}19      51    39    34    26    26}
\CommentTok{\#\textgreater{} \# i 311 more rows}
\CommentTok{\#\textgreater{} \# i 71 more variables: wk6 \textless{}dbl\textgreater{}, wk7 \textless{}dbl\textgreater{}, wk8 \textless{}dbl\textgreater{}, wk9 \textless{}dbl\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

åœ¨è¿™ä¸ªæ•°æ®é›†ä¸­ï¼Œæ¯ä¸ªè§‚æµ‹éƒ½æ˜¯ä¸€é¦–æ­Œã€‚å‰
ä¸‰åˆ—ï¼ˆ\texttt{artist}ã€\texttt{track} å’Œ
\texttt{date.entered}ï¼‰æ˜¯æè¿°æ­Œæ›²çš„å˜é‡ã€‚ç„¶
åæœ‰76åˆ—ï¼ˆ\texttt{wk1}-\texttt{wk76}ï¼‰æè¿°äº†æ­Œæ›²åœ¨æ¯å‘¨çš„æ’å\footnote{åªè¦è¿™é¦–æ­Œåœ¨2000å¹´çš„æŸä¸ªæ—¶é—´ç‚¹è¿›å…¥æ’è¡Œæ¦œå‰100åï¼Œå®ƒå°±ä¼šè¢«æ”¶å½•ï¼Œå¹¶åœ¨å®ƒå‡ºç°åçš„72å‘¨å†…è¢«è¿½è¸ªã€‚}ã€‚
åœ¨è¿™é‡Œï¼Œåˆ—åæ˜¯ä¸€ä¸ªå˜é‡ï¼ˆ\texttt{week}ï¼‰ï¼Œè€Œå•å…ƒæ ¼çš„å€¼æ˜¯å¦ä¸€ä¸ªå˜é‡ï¼ˆ\texttt{rank}ï¼‰ã€‚

ä¸ºäº†æ•´ç†è¿™ä¸ªæ•°æ®ï¼Œæˆ‘ä»¬ä½¿ç”¨ \texttt{pivot\_longer()}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{billboard }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_longer}\NormalTok{(}
    \AttributeTok{cols =} \FunctionTok{starts\_with}\NormalTok{(}\StringTok{"wk"}\NormalTok{), }
    \AttributeTok{names\_to =} \StringTok{"week"}\NormalTok{, }
    \AttributeTok{values\_to =} \StringTok{"rank"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 24,092 x 5}
\CommentTok{\#\textgreater{}    artist track                   date.entered week   rank}
\CommentTok{\#\textgreater{}    \textless{}chr\textgreater{}  \textless{}chr\textgreater{}                   \textless{}date\textgreater{}       \textless{}chr\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{}  1 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26   wk1      87}
\CommentTok{\#\textgreater{}  2 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26   wk2      82}
\CommentTok{\#\textgreater{}  3 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26   wk3      72}
\CommentTok{\#\textgreater{}  4 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26   wk4      77}
\CommentTok{\#\textgreater{}  5 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26   wk5      87}
\CommentTok{\#\textgreater{}  6 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26   wk6      94}
\CommentTok{\#\textgreater{}  7 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26   wk7      99}
\CommentTok{\#\textgreater{}  8 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26   wk8      NA}
\CommentTok{\#\textgreater{}  9 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26   wk9      NA}
\CommentTok{\#\textgreater{} 10 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26   wk10     NA}
\CommentTok{\#\textgreater{} \# i 24,082 more rows}
\end{Highlighting}
\end{Shaded}

æ•°æ®ä¹‹åï¼Œæœ‰ä¸‰ä¸ªå…³é”®å‚æ•°ï¼š

\begin{itemize}
\tightlist
\item
  \texttt{cols}
  æŒ‡å®šäº†å“ªäº›åˆ—éœ€è¦è¿›è¡Œé‡å¡‘ï¼Œå³å“ªäº›åˆ—ä¸æ˜¯å˜é‡ã€‚è¿™ä¸ªå‚æ•°ä½¿ç”¨äº†ä¸\texttt{select()}ç›¸åŒçš„è¯­æ³•ï¼Œå› æ­¤åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{!c(artist,\ track,\ date.entered)}æˆ–è€…\texttt{starts\_with("wk")}ã€‚
\item
  \texttt{names\_to}
  ç”¨äºå‘½ååˆ—åä¸­å­˜å‚¨çš„å˜é‡ï¼Œæˆ‘ä»¬å°†å…¶å‘½åä¸º\texttt{week}
\item
  \texttt{values\_to}
  ç”¨äºå‘½åå•å…ƒæ ¼å€¼ä¸­å­˜å‚¨çš„å˜é‡ï¼Œæˆ‘ä»¬å°†å…¶å‘½åä¸º\texttt{rank}ã€‚
\end{itemize}

è¯·æ³¨æ„ï¼Œä»£ç ä¸­\texttt{â€œweekâ€}å’Œ\texttt{â€œrankâ€}è¢«å¼•å·æ‹¬èµ·æ¥ï¼Œå› ä¸ºè¿™äº›æ˜¯æˆ‘ä»¬åˆ›å»ºçš„æ–°å˜é‡ï¼Œåœ¨è¿è¡Œ\texttt{pivot\_longer()}è°ƒç”¨æ—¶å®ƒä»¬è¿˜ä¸åœ¨æ•°æ®ä¸­ã€‚

ç°åœ¨è®©æˆ‘ä»¬æŠŠæ³¨æ„åŠ›è½¬å‘å¾—åˆ°çš„é•¿æ•°æ®æ¡†ã€‚å¦‚
æœä¸€é¦–æ­Œåœ¨å‰100åä¸­çš„æ—¶é—´å°‘äº76å‘¨ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä»¥ 2 Pacçš„ã€ŠBaby Don't
Cryã€‹ä¸ºä¾‹ã€‚ä¸Š
é¢çš„è¾“å‡ºè¡¨æ˜å®ƒåªåœ¨å‰100åä¸­å¾…äº†7å‘¨ï¼Œè€Œå…¶ä½™æ‰€æœ‰å‘¨éƒ½å¡«å……äº†ç¼ºå¤±å€¼ã€‚è¿™
äº›NAå¹¶ä¸çœŸæ­£ä»£è¡¨æœªçŸ¥çš„è§‚æµ‹å€¼ï¼Œå®ƒä»¬æ˜¯ç”±äºæ•°æ®é›†çš„ç»“æ„è€Œè¢«è¿«å­˜åœ¨çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è¦æ±‚\texttt{pivot\_longer()}é€šè¿‡è®¾ç½®\texttt{values\_drop\_na\ =\ TRUE}æ¥åˆ é™¤å®ƒä»¬ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{billboard }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_longer}\NormalTok{(}
    \AttributeTok{cols =} \FunctionTok{starts\_with}\NormalTok{(}\StringTok{"wk"}\NormalTok{), }
    \AttributeTok{names\_to =} \StringTok{"week"}\NormalTok{, }
    \AttributeTok{values\_to =} \StringTok{"rank"}\NormalTok{,}
    \AttributeTok{values\_drop\_na =} \ConstantTok{TRUE}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 5,307 x 5}
\CommentTok{\#\textgreater{}   artist track                   date.entered week   rank}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}  \textless{}chr\textgreater{}                   \textless{}date\textgreater{}       \textless{}chr\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26   wk1      87}
\CommentTok{\#\textgreater{} 2 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26   wk2      82}
\CommentTok{\#\textgreater{} 3 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26   wk3      72}
\CommentTok{\#\textgreater{} 4 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26   wk4      77}
\CommentTok{\#\textgreater{} 5 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26   wk5      87}
\CommentTok{\#\textgreater{} 6 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26   wk6      94}
\CommentTok{\#\textgreater{} \# i 5,301 more rows}
\end{Highlighting}
\end{Shaded}

ç°åœ¨è¡Œæ•°å¤§å¤§å‡å°‘ï¼Œè¿™è¡¨æ˜è®¸å¤šåŒ…å«\texttt{NA}çš„è¡Œå·²è¢«åˆ é™¤ã€‚

ä½ ä¹Ÿå¯èƒ½ä¼šå¥½å¥‡ï¼Œå¦‚æœä¸€é¦–æ­Œåœ¨å‰100åä¸­è¶…è¿‡76å‘¨ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä»
è¿™äº›æ•°æ®ä¸­æˆ‘ä»¬æ— æ³•å¾—çŸ¥ï¼Œä½†ä½ å¯ä»¥çŒœæµ‹æ•°æ®é›†ä¼šæ·»åŠ é¢å¤–çš„åˆ—ï¼Œå¦‚\texttt{wk77}ã€\texttt{wk78}ç­‰ã€‚

ç°åœ¨æ•°æ®å·²ç»æ•´é½äº†ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨\texttt{mutate()}å’Œ\texttt{readr::parse\_number()}å°†\texttt{week}çš„å€¼ä»å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—ï¼Œä»¥ä½¿æœªæ¥çš„è®¡ç®—æ›´åŠ æ–¹ä¾¿ã€‚\texttt{p}
\texttt{arse\_number()}æ˜¯ä¸€ä¸ªæ–¹ä¾¿çš„å‡½æ•°ï¼Œå®ƒä¼šä»å­—ç¬¦ä¸²ä¸­æå–ç¬¬ä¸€ä¸ªæ•°å­—ï¼Œå¿½ç•¥å…¶ä»–æ‰€æœ‰æ–‡æœ¬ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{billboard\_longer }\OtherTok{\textless{}{-}}\NormalTok{ billboard }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_longer}\NormalTok{(}
    \AttributeTok{cols =} \FunctionTok{starts\_with}\NormalTok{(}\StringTok{"wk"}\NormalTok{), }
    \AttributeTok{names\_to =} \StringTok{"week"}\NormalTok{, }
    \AttributeTok{values\_to =} \StringTok{"rank"}\NormalTok{,}
    \AttributeTok{values\_drop\_na =} \ConstantTok{TRUE}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{week =} \FunctionTok{parse\_number}\NormalTok{(week)}
\NormalTok{  )}
\NormalTok{billboard\_longer}
\CommentTok{\#\textgreater{} \# A tibble: 5,307 x 5}
\CommentTok{\#\textgreater{}   artist track                   date.entered  week  rank}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}  \textless{}chr\textgreater{}                   \textless{}date\textgreater{}       \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26       1    87}
\CommentTok{\#\textgreater{} 2 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26       2    82}
\CommentTok{\#\textgreater{} 3 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26       3    72}
\CommentTok{\#\textgreater{} 4 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26       4    77}
\CommentTok{\#\textgreater{} 5 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26       5    87}
\CommentTok{\#\textgreater{} 6 2 Pac  Baby Don\textquotesingle{}t Cry (Keep... 2000{-}02{-}26       6    94}
\CommentTok{\#\textgreater{} \# i 5,301 more rows}
\end{Highlighting}
\end{Shaded}

æ—¢ç„¶æˆ‘ä»¬å·²ç»å°†æ‰€æœ‰å‘¨æ•°æ”¾å…¥ä¸€ä¸ªå˜é‡ï¼Œå¹¶å°†æ‰€æœ‰æ’åå€¼æ”¾å…¥å¦ä¸€ä¸ªå˜é‡ï¼Œç°åœ¨å¯ä»¥å¾ˆå¥½åœ°å¯è§†åŒ–æ­Œæ›²æ’åå¦‚ä½•éšæ—¶é—´å˜åŒ–ã€‚ä¸‹
é¢çš„ä»£ç å±•ç¤ºäº†è¿™ä¸€ç‚¹ï¼Œç»“æœä½äº@fig-billboard-ranks ã€‚æˆ‘
ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¾ˆå°‘æœ‰æ­Œæ›²èƒ½åœ¨å‰100åä¸­ä¿æŒè¶…è¿‡20å‘¨çš„æ—¶é—´ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{billboard\_longer }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ week, }\AttributeTok{y =}\NormalTok{ rank, }\AttributeTok{group =}\NormalTok{ track)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.25}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{scale\_y\_reverse}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics[width=18.75in,height=\textheight]{data-tidy_files/figure-pdf/fig-billboard-ranks-1.pdf}

}

\caption{\label{fig-billboard-ranks}A line plot showing how the rank of
a song changes over time.}

\end{figure}%

\subsection{pivotingæ˜¯å¦‚ä½•å·¥ä½œçš„?}\label{pivotingux662fux5982ux4f55ux5de5ux4f5cux7684}

æ—¢ç„¶ä½ å·²ç»çœ‹åˆ°äº†æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨pivotingæ¥é‡å¡‘æˆ‘ä»¬çš„æ•°æ®ï¼Œè®©æˆ‘ä»¬èŠ±ç‚¹æ—¶é—´æ¥ç›´è§‚åœ°ç†è§£pivotingå¯¹æ•°æ®åšäº†ä»€ä¹ˆã€‚è®©
æˆ‘ä»¬ä»ä¸€ä¸ªéå¸¸ç®€å•çš„æ•°æ®é›†å¼€å§‹ï¼Œä»¥ä¾¿æ›´å®¹æ˜“åœ°çœ‹åˆ°å‘ç”Ÿäº†ä»€ä¹ˆã€‚å‡
è®¾æˆ‘ä»¬æœ‰ä¸‰ä¸ªæ‚£è€…ï¼Œ\texttt{id}åˆ†åˆ«ä¸ºAã€Bå’ŒCï¼Œå¯¹æ¯ä¸ªæ‚£è€…è¿›è¡Œäº†ä¸¤æ¬¡è¡€å‹æµ‹é‡ã€‚æˆ‘
ä»¬ä½¿ç”¨\texttt{tribble()}æ¥åˆ›å»ºè¿™äº›æ•°æ®ï¼Œtribble()æ˜¯ä¸€ä¸ªæ˜“ç”¨çš„å‡½æ•°ï¼Œè¿™é‡Œé€šè¿‡æ‰‹åŠ¨æ„é€ å°å‹tibbleå¯¹è±¡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{id,  }\SpecialCharTok{\textasciitilde{}}\NormalTok{bp1, }\SpecialCharTok{\textasciitilde{}}\NormalTok{bp2,}
   \StringTok{"A"}\NormalTok{,  }\DecValTok{100}\NormalTok{,  }\DecValTok{120}\NormalTok{,}
   \StringTok{"B"}\NormalTok{,  }\DecValTok{140}\NormalTok{,  }\DecValTok{115}\NormalTok{,}
   \StringTok{"C"}\NormalTok{,  }\DecValTok{120}\NormalTok{,  }\DecValTok{125}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å¸Œæœ›æ–°æ•°æ®é›†æœ‰ä¸‰ä¸ªå˜é‡ï¼šidï¼ˆå·²å­˜åœ¨ï¼‰ã€measurementï¼ˆåˆ—åï¼‰å’Œvalueï¼ˆå•å…ƒæ ¼å€¼ï¼‰ã€‚ä¸º
äº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦å°†dfé‡å¡‘ï¼ˆpivotï¼‰ä¸ºæ›´é•¿çš„æ ¼å¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_longer}\NormalTok{(}
    \AttributeTok{cols =}\NormalTok{ bp1}\SpecialCharTok{:}\NormalTok{bp2,}
    \AttributeTok{names\_to =} \StringTok{"measurement"}\NormalTok{,}
    \AttributeTok{values\_to =} \StringTok{"value"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 3}
\CommentTok{\#\textgreater{}   id    measurement value}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}chr\textgreater{}       \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 A     bp1           100}
\CommentTok{\#\textgreater{} 2 A     bp2           120}
\CommentTok{\#\textgreater{} 3 B     bp1           140}
\CommentTok{\#\textgreater{} 4 B     bp2           115}
\CommentTok{\#\textgreater{} 5 C     bp1           120}
\CommentTok{\#\textgreater{} 6 C     bp2           125}
\end{Highlighting}
\end{Shaded}

é‡å¡‘æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿå¦‚ æœæˆ‘ä»¬æŒ‰åˆ—æ€è€ƒï¼Œå°±ä¼šæ›´å®¹æ˜“ç†è§£ã€‚å¦‚
å›¾~\ref{fig-pivot-variables}
æ‰€ç¤ºï¼Œåœ¨åŸå§‹æ•°æ®é›†ä¸­å·²ç»æ˜¯å˜é‡çš„åˆ—ï¼ˆå¦‚idï¼‰çš„å€¼éœ€è¦è¢«é‡å¤ï¼Œæ¯ä¸ªè¢«é‡å¡‘çš„åˆ—é‡å¤ä¸€æ¬¡ã€‚

\begin{figure}

\centering{

\includegraphics[width=5.37in,height=\textheight]{diagrams/tidy-data/variables.png}

}

\caption{\label{fig-pivot-variables}Columns that are already variables
need to be repeated, once for each column that is pivoted.}

\end{figure}%

åˆ—åå˜æˆæ–°å˜é‡çš„å€¼ï¼Œæ–°å˜é‡çš„åç§°ç”±\texttt{names\_to}å®šä¹‰ï¼Œå¦‚@fig-pivot-names
æ‰€ç¤ºã€‚å®ƒ ä»¬éœ€è¦åœ¨åŸå§‹æ•°æ®é›†çš„æ¯ä¸€è¡Œä¸­é‡å¤ä¸€æ¬¡ã€‚

\begin{figure}

\centering{

\includegraphics[width=5.37in,height=\textheight]{diagrams/tidy-data/column-names.png}

}

\caption{\label{fig-pivot-names}The column names of pivoted columns
become values in a new column. The values need to be repeated once for
each row of the original dataset.}

\end{figure}%

å•å…ƒæ ¼å€¼ä¹Ÿå˜æˆæ–°å˜é‡çš„å€¼ï¼Œæ–°å˜é‡çš„åç§°ç”±\texttt{values\_to}å®šä¹‰ã€‚å®ƒ
ä»¬è¢«é€è¡Œåœ°å±•å¼€ã€‚@ fig-pivot-values å±•ç¤ºäº†è¿™ä¸€è¿‡ç¨‹ã€‚

\begin{figure}

\centering{

\includegraphics[width=5.37in,height=\textheight]{diagrams/tidy-data/cell-values.png}

}

\caption{\label{fig-pivot-values}The number of values is preserved (not
repeated), but unwound row-by-row.}

\end{figure}%

\subsection{åˆ—åä¸­åŒ…å«å¤šä¸ªå˜é‡}\label{ux5217ux540dux4e2dux5305ux542bux591aux4e2aux53d8ux91cf}

å½“åˆ—åä¸­èåˆäº†å¤šä¸ªä¿¡æ¯ç‰‡æ®µè€Œä½ å¸Œæœ›å°†è¿™äº›ä¿¡æ¯åˆ†æ•£åˆ°ç‹¬ç«‹çš„æ–°å˜é‡ä¸­æ—¶ï¼Œæƒ…å†µå°±ä¼šå˜å¾—æ›´åŠ å¤æ‚ã€‚è¿™
é‡Œä»¥ä½ ä¹‹å‰çœ‹åˆ°çš„\texttt{table1}ç­‰è¡¨çš„æºå¤´æ•°æ®é›†\texttt{who2}ä¸ºä¾‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{who2}
\CommentTok{\#\textgreater{} \# A tibble: 7,240 x 58}
\CommentTok{\#\textgreater{}   country      year sp\_m\_014 sp\_m\_1524 sp\_m\_2534 sp\_m\_3544 sp\_m\_4554}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}       \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 Afghanistan  1980       NA        NA        NA        NA        NA}
\CommentTok{\#\textgreater{} 2 Afghanistan  1981       NA        NA        NA        NA        NA}
\CommentTok{\#\textgreater{} 3 Afghanistan  1982       NA        NA        NA        NA        NA}
\CommentTok{\#\textgreater{} 4 Afghanistan  1983       NA        NA        NA        NA        NA}
\CommentTok{\#\textgreater{} 5 Afghanistan  1984       NA        NA        NA        NA        NA}
\CommentTok{\#\textgreater{} 6 Afghanistan  1985       NA        NA        NA        NA        NA}
\CommentTok{\#\textgreater{} \# i 7,234 more rows}
\CommentTok{\#\textgreater{} \# i 51 more variables: sp\_m\_5564 \textless{}dbl\textgreater{}, sp\_m\_65 \textless{}dbl\textgreater{}, sp\_f\_014 \textless{}dbl\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

è¿™ä¸ªæ•°æ®é›†ç”±ä¸–ç•Œå«ç”Ÿç»„ç»‡æ”¶é›†ï¼Œè®°å½•äº†å…³äºç»“æ ¸ç—…è¯Šæ–­çš„ä¿¡æ¯,å…¶ä¸­æœ‰ä¸¤ä¸ªåˆ—å·²ç»æ˜¯å˜é‡ä¸”æ˜“äºè§£è¯»ï¼š\texttt{country}å’Œ\texttt{year}ã€‚æ¥
ç€æ˜¯56ä¸ªåƒ\texttt{sp\_m\_014}ã€\texttt{ep\_m\_4554}å’Œ\texttt{rel\_m\_3544}è¿™æ ·çš„åˆ—ã€‚å¦‚
æœä½ é•¿æ—¶é—´ç›¯ç€è¿™äº›åˆ—çœ‹å°±ä¼šå‘ç°ä¸€ä¸ªè§„å¾‹ã€‚æ¯
ä¸ªåˆ—åéƒ½ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œç”±\texttt{\_}åˆ†éš”ã€‚ç¬¬
ä¸€éƒ¨åˆ†\texttt{sp}/\texttt{rel}/\texttt{ep}æè¿°äº†ç”¨äºè¯Šæ–­çš„æ–¹æ³•ï¼›ç¬¬äºŒéƒ¨åˆ†\texttt{m}/\texttt{f}æ˜¯æ€§åˆ«ï¼ˆåœ¨è¿™ä¸ªæ•°æ®é›†ä¸­è¢«ç¼–ç ä¸ºäºŒè¿›åˆ¶å˜é‡ï¼‰ï¼›ç¬¬ä¸‰éƒ¨åˆ†ï¼Œ\texttt{014}/\texttt{1524}/\texttt{2534}/\texttt{3544}/\texttt{4554}/\texttt{5564}/\texttt{65}æ˜¯å¹´é¾„èŒƒå›´ï¼ˆä¾‹å¦‚ï¼Œ\texttt{014}ä»£è¡¨0-14å²ï¼‰ã€‚

å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ\texttt{who2}æ•°æ®é›†ä¸­è®°å½•äº†å…­æ¡ä¿¡æ¯ï¼šcountryå’Œyearï¼ˆå·²ç»æ˜¯åˆ—ï¼‰ï¼›è¯Šæ–­æ–¹æ³•ã€æ€§åˆ«å’Œå¹´é¾„èŒƒå›´ç±»åˆ«ï¼ˆåŒ…å«åœ¨å…¶ä»–åˆ—åä¸­ï¼‰ï¼Œä»¥åŠè¯¥ç±»åˆ«ä¸­çš„æ‚£è€…æ•°é‡ï¼ˆå•å…ƒæ ¼å€¼ï¼‰ã€‚ä¸º
äº†å°†è¿™å…­æ¡ä¿¡æ¯ç»„ç»‡åˆ°å…­ä¸ªå•ç‹¬çš„åˆ—ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨\texttt{pivot\_longer()}å‡½æ•°ï¼Œå¹¶ä¸º\texttt{names\_to}æä¾›ä¸€ä¸ªåˆ—åå­—ç¬¦ä¸²å‘é‡ï¼Œä»¥åŠä¸º\texttt{names\_sep}æä¾›ä¸€ä¸ªæŒ‡ä»¤æ¥å°†åŸå§‹å˜é‡ååˆ†å‰²æˆç‰‡æ®µï¼Œå¹¶ä¸º\texttt{values\_to}æä¾›ä¸€ä¸ªåˆ—åï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{who2 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_longer}\NormalTok{(}
    \AttributeTok{cols =} \SpecialCharTok{!}\NormalTok{(country}\SpecialCharTok{:}\NormalTok{year),}
    \AttributeTok{names\_to =} \FunctionTok{c}\NormalTok{(}\StringTok{"diagnosis"}\NormalTok{, }\StringTok{"gender"}\NormalTok{, }\StringTok{"age"}\NormalTok{), }
    \AttributeTok{names\_sep =} \StringTok{"\_"}\NormalTok{,}
    \AttributeTok{values\_to =} \StringTok{"count"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 405,440 x 6}
\CommentTok{\#\textgreater{}   country      year diagnosis gender age   count}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}       \textless{}dbl\textgreater{} \textless{}chr\textgreater{}     \textless{}chr\textgreater{}  \textless{}chr\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 Afghanistan  1980 sp        m      014      NA}
\CommentTok{\#\textgreater{} 2 Afghanistan  1980 sp        m      1524     NA}
\CommentTok{\#\textgreater{} 3 Afghanistan  1980 sp        m      2534     NA}
\CommentTok{\#\textgreater{} 4 Afghanistan  1980 sp        m      3544     NA}
\CommentTok{\#\textgreater{} 5 Afghanistan  1980 sp        m      4554     NA}
\CommentTok{\#\textgreater{} 6 Afghanistan  1980 sp        m      5564     NA}
\CommentTok{\#\textgreater{} \# i 405,434 more rows}
\end{Highlighting}
\end{Shaded}

é™¤äº†\texttt{names\_sep}ä¹‹å¤–ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨\texttt{names\_pattern}ã€‚å½“
ä½ åœ¨@sec-regular-expressions
å­¦ä¹ äº†æ­£åˆ™è¡¨è¾¾å¼ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨å®ƒæ¥ä»æ›´å¤æ‚çš„å‘½ååœºæ™¯ä¸­æå–å˜é‡ã€‚

ä»æ¦‚å¿µä¸Šè®²ï¼Œè¿™åªæ˜¯åœ¨ä½ ä¹‹å‰çœ‹åˆ°çš„ç®€å•æƒ…å†µä¸Šåšäº†å¾®å°çš„å˜åŒ–ã€‚@
sec-regular-expressions
å±•ç¤ºäº†åŸºæœ¬æ€æƒ³ï¼šç°åœ¨ï¼Œåˆ—åä¸å†åªæ˜¯è½¬æ¢ä¸ºä¸€ä¸ªå•ç‹¬çš„åˆ—ï¼Œè€Œæ˜¯è½¬æ¢ä¸ºå¤šä¸ªåˆ—ã€‚ä½ 
å¯ä»¥æƒ³è±¡è¿™ä¸ªè¿‡ç¨‹åˆ†ä¸ºä¸¤æ­¥ï¼ˆé¦–å…ˆè½¬æ¢ç„¶ååˆ†å‰²ï¼‰ï¼Œä½†å®é™…ä¸Šå®ƒæ˜¯åœ¨ä¸€æ­¥ä¸­å®Œæˆçš„ï¼Œå› ä¸ºè¿™æ ·æ›´å¿«ã€‚

\begin{figure}

\centering{

\includegraphics[width=5.46in,height=\textheight]{diagrams/tidy-data/multiple-names.png}

}

\caption{\label{fig-pivot-multiple-names}Pivoting columns with multiple
pieces of information in the names means that each column name now fills
in values in multiple output columns.}

\end{figure}%

\subsection{åˆ—æ ‡é¢˜ä¸­çš„æ•°æ®å’Œå˜é‡å}\label{ux5217ux6807ux9898ux4e2dux7684ux6570ux636eux548cux53d8ux91cfux540d}

æ¥ä¸‹æ¥æ›´å¤æ‚çš„æ­¥éª¤æ˜¯å½“åˆ—ååŒ…å«å˜é‡å€¼å’Œå˜é‡åçš„æ··åˆæ—¶ã€‚ä¾‹
å¦‚ï¼Œä»¥\texttt{household}æ•°æ®é›†ä¸ºä¾‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{household}
\CommentTok{\#\textgreater{} \# A tibble: 5 x 5}
\CommentTok{\#\textgreater{}   family dob\_child1 dob\_child2 name\_child1 name\_child2}
\CommentTok{\#\textgreater{}    \textless{}int\textgreater{} \textless{}date\textgreater{}     \textless{}date\textgreater{}     \textless{}chr\textgreater{}       \textless{}chr\textgreater{}      }
\CommentTok{\#\textgreater{} 1      1 1998{-}11{-}26 2000{-}01{-}29 Susan       Jose       }
\CommentTok{\#\textgreater{} 2      2 1996{-}06{-}22 NA         Mark        \textless{}NA\textgreater{}       }
\CommentTok{\#\textgreater{} 3      3 2002{-}07{-}11 2004{-}04{-}05 Sam         Seth       }
\CommentTok{\#\textgreater{} 4      4 2004{-}10{-}10 2009{-}08{-}27 Craig       Khai       }
\CommentTok{\#\textgreater{} 5      5 2000{-}12{-}05 2005{-}02{-}28 Parker      Gracie}
\end{Highlighting}
\end{Shaded}

è¿™ä¸ªæ•°æ®é›†åŒ…å«äº†äº”ä¸ªå®¶åº­çš„æ•°æ®ï¼Œæ¯ä¸ªå®¶åº­æœ€å¤šæœ‰ä¸¤ä¸ªå­©å­çš„å§“åå’Œå‡ºç”Ÿæ—¥æœŸã€‚æ•°
æ®é›†ä¸­çš„æ–°æŒ‘æˆ˜æ˜¯åˆ—ååŒ…å«äº†ä¸¤ä¸ªå˜é‡çš„åç§°ï¼ˆ\texttt{dob}ã€\texttt{name}ï¼‰å’Œå¦ä¸€ä¸ªå˜é‡ï¼ˆ\texttt{child}ï¼Œå…¶å€¼ä¸º1æˆ–2ï¼‰çš„å€¼ã€‚ä¸º
äº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å†æ¬¡éœ€è¦å‘\texttt{names\_to}æä¾›ä¸€ä¸ªå‘é‡ï¼Œä½†è¿™æ¬¡æˆ‘ä»¬ä½¿ç”¨ç‰¹æ®Šçš„\texttt{".value"}å“¨å…µå€¼ï¼ˆsentinelï¼‰ï¼›è¿™ä¸æ˜¯å˜é‡çš„åç§°ï¼Œè€Œæ˜¯ä¸€ä¸ªç‹¬ç‰¹çš„å€¼ï¼Œå®ƒå‘Šè¯‰\texttt{pivot\_longer()}åšä¸€äº›ä¸åŒçš„äº‹æƒ…ã€‚è¿™
ä¼šè¦†ç›–é€šå¸¸çš„\texttt{values\_to}å‚æ•°ï¼Œä½¿ç”¨é‡å¡‘åçš„åˆ—åçš„ç¬¬ä¸€ä¸ªç»„æˆéƒ¨åˆ†ä½œä¸ºè¾“å‡ºä¸­çš„å˜é‡åã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{household }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_longer}\NormalTok{(}
    \AttributeTok{cols =} \SpecialCharTok{!}\NormalTok{family, }
    \AttributeTok{names\_to =} \FunctionTok{c}\NormalTok{(}\StringTok{".value"}\NormalTok{, }\StringTok{"child"}\NormalTok{), }
    \AttributeTok{names\_sep =} \StringTok{"\_"}\NormalTok{, }
    \AttributeTok{values\_drop\_na =} \ConstantTok{TRUE}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 9 x 4}
\CommentTok{\#\textgreater{}   family child  dob        name }
\CommentTok{\#\textgreater{}    \textless{}int\textgreater{} \textless{}chr\textgreater{}  \textless{}date\textgreater{}     \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1      1 child1 1998{-}11{-}26 Susan}
\CommentTok{\#\textgreater{} 2      1 child2 2000{-}01{-}29 Jose }
\CommentTok{\#\textgreater{} 3      2 child1 1996{-}06{-}22 Mark }
\CommentTok{\#\textgreater{} 4      3 child1 2002{-}07{-}11 Sam  }
\CommentTok{\#\textgreater{} 5      3 child2 2004{-}04{-}05 Seth }
\CommentTok{\#\textgreater{} 6      4 child1 2004{-}10{-}10 Craig}
\CommentTok{\#\textgreater{} \# i 3 more rows}
\end{Highlighting}
\end{Shaded}

ç”±äºè¾“å…¥æ•°æ®çš„æ ¼å¼ï¼Œå¿…é¡»åˆ›å»ºä¸€äº›æ˜ç¡®çš„ç¼ºå¤±å˜é‡ï¼ˆä¾‹å¦‚ï¼Œå¯¹äºåªæœ‰ä¸€ä¸ªå­©å­çš„å®¶åº­ï¼‰é€šè¿‡è®¾ç½®\texttt{values\_drop\_na\ =\ TRUE}ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å¿½ç•¥è¿™äº›ç”±äºæ•°æ®ä¸å®Œæ•´è€Œäº§ç”Ÿçš„NAå€¼ã€‚ã€‚

å›¾~\ref{fig-pivot-names-and-values}
é€šè¿‡ä¸€ä¸ªæ›´ç®€å•çš„ç¤ºä¾‹è¯´æ˜äº†åŸºæœ¬æ€æƒ³ã€‚å½“
æ‚¨åœ¨\texttt{names\_to}ä¸­ä½¿ç”¨\texttt{".value"}æ—¶ï¼Œè¾“å…¥ä¸­çš„åˆ—åå¯¹è¾“å‡ºä¸­çš„å€¼å’Œå˜é‡åéƒ½æœ‰è´¡çŒ®ã€‚

\begin{figure}

\centering{

\includegraphics[width=4.94in,height=\textheight]{diagrams/tidy-data/names-and-values.png}

}

\caption{\label{fig-pivot-names-and-values}Pivoting with
\texttt{names\_to\ =\ c(".value",\ "num")} splits the column names into
two components: the first part determines the output column name
(\texttt{x} or \texttt{y}), and the second part determines the value of
the \texttt{num} column.}

\end{figure}%

\section{æ•°æ®è½¬æ¢---å®½æ ¼å¼}\label{ux6570ux636eux8f6cux6362ux5bbdux683cux5f0f}

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨\texttt{pivot\_longer()}å‡½æ•°æ¥è§£å†³äº†ä¸€ä¸ªå¸¸è§é—®é¢˜ï¼Œå³å€¼æœ€ç»ˆå‡ºç°åœ¨åˆ—åä¸­çš„æƒ…å†µã€‚æ¥
ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†è½¬ç½®ï¼ˆHA
HAï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªåŒå…³è¯­ï¼Œå› ä¸ºpivotåœ¨è‹±è¯­ä¸­ä¹Ÿæœ‰``è½¬ç½®''çš„æ„æ€ï¼‰åˆ°\texttt{pivot\_wider()}å‡½æ•°ï¼Œè¯¥å‡½æ•°é€šè¿‡å¢åŠ åˆ—å’Œå‡å°‘è¡Œæ¥ä½¿æ•°æ®é›†å˜å®½ï¼Œè¿™åœ¨ä¸€ä¸ªè§‚æµ‹åˆ†å¸ƒåœ¨å¤šè¡Œæ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚è¿™
ç§æƒ…å†µåœ¨å®é™…æ•°æ®ä¸­è¾ƒå°‘å‡ºç°ï¼Œä½†åœ¨å¤„ç†æ”¿åºœæ•°æ®æ—¶ä¼¼ä¹å¾ˆå¸¸è§ã€‚

æˆ‘ä»¬å°†é¦–å…ˆæŸ¥çœ‹\texttt{cms\_patient\_experience}æ•°æ®é›†ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¥è‡ªåŒ»ç–—ä¿é™©å’ŒåŒ»ç–—è¡¥åŠ©æœåŠ¡ä¸­å¿ƒï¼ˆCenters
of Medicare and Medicaid
Servicesï¼‰çš„æ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†æ”¶é›†äº†å…³äºæ‚£è€…ä½“éªŒçš„æ•°æ®ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cms\_patient\_experience}
\CommentTok{\#\textgreater{} \# A tibble: 500 x 5}
\CommentTok{\#\textgreater{}   org\_pac\_id org\_nm                     measure\_cd   measure\_title   prf\_rate}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}      \textless{}chr\textgreater{}                      \textless{}chr\textgreater{}        \textless{}chr\textgreater{}              \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 0446157747 USC CARE MEDICAL GROUP INC CAHPS\_GRP\_1  CAHPS for MIPS\textasciitilde{}       63}
\CommentTok{\#\textgreater{} 2 0446157747 USC CARE MEDICAL GROUP INC CAHPS\_GRP\_2  CAHPS for MIPS\textasciitilde{}       87}
\CommentTok{\#\textgreater{} 3 0446157747 USC CARE MEDICAL GROUP INC CAHPS\_GRP\_3  CAHPS for MIPS\textasciitilde{}       86}
\CommentTok{\#\textgreater{} 4 0446157747 USC CARE MEDICAL GROUP INC CAHPS\_GRP\_5  CAHPS for MIPS\textasciitilde{}       57}
\CommentTok{\#\textgreater{} 5 0446157747 USC CARE MEDICAL GROUP INC CAHPS\_GRP\_8  CAHPS for MIPS\textasciitilde{}       85}
\CommentTok{\#\textgreater{} 6 0446157747 USC CARE MEDICAL GROUP INC CAHPS\_GRP\_12 CAHPS for MIPS\textasciitilde{}       24}
\CommentTok{\#\textgreater{} \# i 494 more rows}
\end{Highlighting}
\end{Shaded}

è¢«ç ”ç©¶çš„æ ¸å¿ƒå•ä½æ˜¯ç»„ç»‡ï¼Œä½†æ¯ä¸ªç»„ç»‡éƒ½åˆ†å¸ƒåœ¨å…­è¡Œä¸­ï¼Œæ¯è¡Œä»£è¡¨è°ƒæŸ¥ç»„ç»‡ä¸­çš„ä¸€ä¸ªæµ‹é‡å€¼ã€‚æˆ‘
ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨\texttt{distinct()}å‡½æ•°æ¥æŸ¥çœ‹\texttt{measure\_cd}å’Œ\texttt{measure\_title}å€¼çš„å®Œæ•´é›†ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cms\_patient\_experience }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{distinct}\NormalTok{(measure\_cd, measure\_title)}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 2}
\CommentTok{\#\textgreater{}   measure\_cd   measure\_title                                                 }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}        \textless{}chr\textgreater{}                                                         }
\CommentTok{\#\textgreater{} 1 CAHPS\_GRP\_1  CAHPS for MIPS SSM: Getting Timely Care, Appointments, and In\textasciitilde{}}
\CommentTok{\#\textgreater{} 2 CAHPS\_GRP\_2  CAHPS for MIPS SSM: How Well Providers Communicate            }
\CommentTok{\#\textgreater{} 3 CAHPS\_GRP\_3  CAHPS for MIPS SSM: Patient\textquotesingle{}s Rating of Provider              }
\CommentTok{\#\textgreater{} 4 CAHPS\_GRP\_5  CAHPS for MIPS SSM: Health Promotion and Education            }
\CommentTok{\#\textgreater{} 5 CAHPS\_GRP\_8  CAHPS for MIPS SSM: Courteous and Helpful Office Staff        }
\CommentTok{\#\textgreater{} 6 CAHPS\_GRP\_12 CAHPS for MIPS SSM: Stewardship of Patient Resources}
\end{Highlighting}
\end{Shaded}

è¿™ä¸¤åˆ—éƒ½ä¸ä¼šæˆä¸ºç‰¹åˆ«å¥½çš„å˜é‡åï¼š\texttt{measure\_cd}æ²¡æœ‰æš—ç¤ºå˜é‡çš„å«ä¹‰ï¼Œè€Œ\texttt{measure\_title}æ˜¯ä¸€ä¸ªåŒ…å«ç©ºæ ¼çš„é•¿å¥å­ã€‚ç›®
å‰æˆ‘ä»¬å°†ä½¿ç”¨\texttt{measure\_cd}ä½œä¸ºæ–°åˆ—åçš„æ¥æºï¼Œä½†åœ¨å®é™…åˆ†æä¸­ï¼Œä½ å¯èƒ½å¸Œæœ›åˆ›å»ºæ—¢ç®€çŸ­åˆæœ‰æ„ä¹‰çš„å˜é‡åã€‚

\texttt{pivot\_wider()}ä¸\texttt{pivot\_longer()}çš„æ“ä½œæ­£å¥½ç›¸åã€‚å®ƒ
ä¸éœ€è¦å®šä¹‰æ–°çš„åˆ—åï¼Œè€Œæ˜¯é€‰æ‹©ä¸€ä¸ªç°æœ‰åˆ—æ¥æä¾›å€¼ï¼ˆ\texttt{values\_from}ï¼‰ï¼Œå¹¶é€‰æ‹©å¦ä¸€ä¸ªåˆ—æ¥å®šä¹‰æ–°çš„åˆ—åï¼ˆ\texttt{names\_from}ï¼‰ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cms\_patient\_experience }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_wider}\NormalTok{(}
    \AttributeTok{names\_from =}\NormalTok{ measure\_cd,}
    \AttributeTok{values\_from =}\NormalTok{ prf\_rate}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 500 x 9}
\CommentTok{\#\textgreater{}   org\_pac\_id org\_nm                   measure\_title   CAHPS\_GRP\_1 CAHPS\_GRP\_2}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}      \textless{}chr\textgreater{}                    \textless{}chr\textgreater{}                 \textless{}dbl\textgreater{}       \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 0446157747 USC CARE MEDICAL GROUP \textasciitilde{} CAHPS for MIPS\textasciitilde{}          63          NA}
\CommentTok{\#\textgreater{} 2 0446157747 USC CARE MEDICAL GROUP \textasciitilde{} CAHPS for MIPS\textasciitilde{}          NA          87}
\CommentTok{\#\textgreater{} 3 0446157747 USC CARE MEDICAL GROUP \textasciitilde{} CAHPS for MIPS\textasciitilde{}          NA          NA}
\CommentTok{\#\textgreater{} 4 0446157747 USC CARE MEDICAL GROUP \textasciitilde{} CAHPS for MIPS\textasciitilde{}          NA          NA}
\CommentTok{\#\textgreater{} 5 0446157747 USC CARE MEDICAL GROUP \textasciitilde{} CAHPS for MIPS\textasciitilde{}          NA          NA}
\CommentTok{\#\textgreater{} 6 0446157747 USC CARE MEDICAL GROUP \textasciitilde{} CAHPS for MIPS\textasciitilde{}          NA          NA}
\CommentTok{\#\textgreater{} \# i 494 more rows}
\CommentTok{\#\textgreater{} \# i 4 more variables: CAHPS\_GRP\_3 \textless{}dbl\textgreater{}, CAHPS\_GRP\_5 \textless{}dbl\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

è¾“å‡ºçš„ç»“æœçœ‹èµ·æ¥ä¸å¤ªå¯¹ï¼Œå› ä¸ºä¼¼ä¹æ¯ä¸ªç»„ç»‡ä»ç„¶æœ‰å¤šè¡Œæ•°æ®ã€‚è¿™
æ˜¯å› ä¸ºæˆ‘ä»¬è¿˜éœ€å‘Šè¯‰\texttt{pivot\_wider()}å“ªä¸ªåˆ—æˆ–å“ªäº›åˆ—çš„å€¼èƒ½å¤Ÿå”¯ä¸€åœ°æ ‡è¯†æ¯ä¸€è¡Œï¼›åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¿™äº›æ˜¯ä»¥
\texttt{"org"} å¼€å¤´çš„å˜é‡ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cms\_patient\_experience }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_wider}\NormalTok{(}
    \AttributeTok{id\_cols =} \FunctionTok{starts\_with}\NormalTok{(}\StringTok{"org"}\NormalTok{),}
    \AttributeTok{names\_from =}\NormalTok{ measure\_cd,}
    \AttributeTok{values\_from =}\NormalTok{ prf\_rate}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 95 x 8}
\CommentTok{\#\textgreater{}   org\_pac\_id org\_nm           CAHPS\_GRP\_1 CAHPS\_GRP\_2 CAHPS\_GRP\_3 CAHPS\_GRP\_5}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}      \textless{}chr\textgreater{}                  \textless{}dbl\textgreater{}       \textless{}dbl\textgreater{}       \textless{}dbl\textgreater{}       \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 0446157747 USC CARE MEDICA\textasciitilde{}          63          87          86          57}
\CommentTok{\#\textgreater{} 2 0446162697 ASSOCIATION OF \textasciitilde{}          59          85          83          63}
\CommentTok{\#\textgreater{} 3 0547164295 BEAVER MEDICAL \textasciitilde{}          49          NA          75          44}
\CommentTok{\#\textgreater{} 4 0749333730 CAPE PHYSICIANS\textasciitilde{}          67          84          85          65}
\CommentTok{\#\textgreater{} 5 0840104360 ALLIANCE PHYSIC\textasciitilde{}          66          87          87          64}
\CommentTok{\#\textgreater{} 6 0840109864 REX HOSPITAL INC          73          87          84          67}
\CommentTok{\#\textgreater{} \# i 89 more rows}
\CommentTok{\#\textgreater{} \# i 2 more variables: CAHPS\_GRP\_8 \textless{}dbl\textgreater{}, CAHPS\_GRP\_12 \textless{}dbl\textgreater{}}
\end{Highlighting}
\end{Shaded}

è¿™å°±ç»™å‡ºäº†æˆ‘ä»¬æƒ³è¦çš„è¾“å‡ºã€‚

\subsection{\texorpdfstring{\texttt{pivot\_wider()}æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ}{pivot\_wider()æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ}}\label{pivot_widerux662fux5982ux4f55ux5de5ux4f5cux7684}

ä¸ºäº†ç†è§£\texttt{pivot\_wider()}æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè®©æˆ‘ä»¬å†æ¬¡ä»ä¸€ä¸ªéå¸¸ç®€å•çš„æ•°æ®é›†å¼€å§‹ã€‚è¿™
æ¬¡æˆ‘ä»¬æœ‰ä¸¤ä¸ªæ‚£è€…ï¼Œ\texttt{id}åˆ†åˆ«ä¸ºAå’ŒBï¼Œæˆ‘ä»¬åœ¨æ‚£è€…Aä¸Šè¿›è¡Œäº†ä¸‰æ¬¡è¡€å‹æµ‹é‡ï¼Œåœ¨æ‚£è€…Bä¸Šè¿›è¡Œäº†ä¸¤æ¬¡æµ‹é‡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{id, }\SpecialCharTok{\textasciitilde{}}\NormalTok{measurement, }\SpecialCharTok{\textasciitilde{}}\NormalTok{value,}
  \StringTok{"A"}\NormalTok{,        }\StringTok{"bp1"}\NormalTok{,    }\DecValTok{100}\NormalTok{,}
  \StringTok{"B"}\NormalTok{,        }\StringTok{"bp1"}\NormalTok{,    }\DecValTok{140}\NormalTok{,}
  \StringTok{"B"}\NormalTok{,        }\StringTok{"bp2"}\NormalTok{,    }\DecValTok{115}\NormalTok{, }
  \StringTok{"A"}\NormalTok{,        }\StringTok{"bp2"}\NormalTok{,    }\DecValTok{120}\NormalTok{,}
  \StringTok{"A"}\NormalTok{,        }\StringTok{"bp3"}\NormalTok{,    }\DecValTok{105}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å°†ä»\texttt{value}åˆ—ä¸­è·å–å€¼ï¼Œä»\texttt{measurement}åˆ—ä¸­è·å–åç§°:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_wider}\NormalTok{(}
    \AttributeTok{names\_from =}\NormalTok{ measurement,}
    \AttributeTok{values\_from =}\NormalTok{ value}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 4}
\CommentTok{\#\textgreater{}   id      bp1   bp2   bp3}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 A       100   120   105}
\CommentTok{\#\textgreater{} 2 B       140   115    NA}
\end{Highlighting}
\end{Shaded}

è¦å¼€å§‹è¿™ä¸ªè¿‡ç¨‹ï¼Œ\texttt{pivot\_wider()}é¦–å…ˆéœ€è¦å¼„æ¸…æ¥šè¡Œå’Œåˆ—ä¸­çš„å†…å®¹ã€‚æ–°
çš„åˆ—åå°†æ˜¯\texttt{measurement}çš„å”¯ä¸€å€¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{distinct}\NormalTok{(measurement) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pull}\NormalTok{()}
\CommentTok{\#\textgreater{} [1] "bp1" "bp2" "bp3"}
\end{Highlighting}
\end{Shaded}

é»˜è®¤æƒ…å†µä¸‹ï¼Œè¾“å‡ºä¸­çš„è¡Œç”±ä¸åŒ…å«åœ¨æ–°åç§°æˆ–å€¼ä¸­çš„æ‰€æœ‰å˜é‡å†³å®šã€‚è¿™
äº›è¢«ç§°ä¸º\texttt{id\_cols}ã€‚è¿™ é‡Œåªæœ‰ä¸€åˆ—ï¼Œä½†é€šå¸¸å¯ä»¥æ˜¯ä»»æ„æ•°é‡çš„åˆ—ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{measurement, }\SpecialCharTok{{-}}\NormalTok{value) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{distinct}\NormalTok{()}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 1}
\CommentTok{\#\textgreater{}   id   }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 A    }
\CommentTok{\#\textgreater{} 2 B}
\end{Highlighting}
\end{Shaded}

ç„¶å\texttt{pivot\_wider()}å°†è¿™äº›ç»“æœç»„åˆèµ·æ¥ç”Ÿæˆä¸€ä¸ªç©ºæ•°æ®æ¡†:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{measurement, }\SpecialCharTok{{-}}\NormalTok{value) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{distinct}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{x =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{y =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{z =} \ConstantTok{NA}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 4}
\CommentTok{\#\textgreater{}   id    x     y     z    }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}lgl\textgreater{} \textless{}lgl\textgreater{} \textless{}lgl\textgreater{}}
\CommentTok{\#\textgreater{} 1 A     NA    NA    NA   }
\CommentTok{\#\textgreater{} 2 B     NA    NA    NA}
\end{Highlighting}
\end{Shaded}

ç„¶åï¼Œå®ƒä½¿ç”¨è¾“å…¥ä¸­çš„æ•°æ®å¡«å……æ‰€æœ‰ç¼ºå¤±çš„å€¼ã€‚åœ¨
è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¾“å‡ºä¸­çš„æ¯ä¸ªå•å…ƒæ ¼åœ¨è¾“å…¥ä¸­å¹¶ééƒ½æœ‰å¯¹åº”çš„å€¼ï¼Œå› ä¸ºæ‚£è€…Bæ²¡æœ‰ç¬¬ä¸‰æ¬¡è¡€å‹æµ‹é‡ï¼Œæ‰€ä»¥é‚£ä¸ªå•å…ƒæ ¼çš„å€¼æ˜¯ç¼ºå¤±çš„ã€‚æˆ‘
ä»¬å°†åœ¨ ç« èŠ‚~\ref{sec-missing-values}
ä¸­æ¢è®¨\texttt{pivot\_wider()}å¯ä»¥``åˆ¶é€ ''ç¼ºå¤±å€¼è¿™ä¸ªè§‚ç‚¹ã€‚

ä½ å¯èƒ½è¿˜ä¼šæƒ³ï¼Œå¦‚æœè¾“å…¥ä¸­æœ‰å¤šä¸ªè¡Œå¯¹åº”äºè¾“å‡ºä¸­çš„ä¸€ä¸ªå•å…ƒæ ¼ä¼šå‘ç”Ÿä»€ä¹ˆã€‚ä¸‹
é¢çš„ä¾‹å­ä¸­æœ‰ä¸¤è¡Œå¯¹åº”äº\texttt{id}ä¸º``A''å’Œ\texttt{measurement}ä¸º``bp1''çš„å•å…ƒæ ¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{id, }\SpecialCharTok{\textasciitilde{}}\NormalTok{measurement, }\SpecialCharTok{\textasciitilde{}}\NormalTok{value,}
  \StringTok{"A"}\NormalTok{,        }\StringTok{"bp1"}\NormalTok{,    }\DecValTok{100}\NormalTok{,}
  \StringTok{"A"}\NormalTok{,        }\StringTok{"bp1"}\NormalTok{,    }\DecValTok{102}\NormalTok{,}
  \StringTok{"A"}\NormalTok{,        }\StringTok{"bp2"}\NormalTok{,    }\DecValTok{120}\NormalTok{,}
  \StringTok{"B"}\NormalTok{,        }\StringTok{"bp1"}\NormalTok{,    }\DecValTok{140}\NormalTok{, }
  \StringTok{"B"}\NormalTok{,        }\StringTok{"bp2"}\NormalTok{,    }\DecValTok{115}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

å¦‚æœæˆ‘ä»¬å°è¯•å¯¹è¿™æ ·çš„æ•°æ®é›†è¿›è¡Œé‡å¡‘ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªåŒ…å«åˆ—è¡¨-åˆ—çš„è¾“å‡ºï¼Œä½ å°†åœ¨@sec-rectangling
ä¸­å­¦ä¹ æ›´å¤šå…³äºåˆ—è¡¨-åˆ—çš„å†…å®¹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{pivot\_wider}\NormalTok{(}
    \AttributeTok{names\_from =}\NormalTok{ measurement,}
    \AttributeTok{values\_from =}\NormalTok{ value}
\NormalTok{  )}
\CommentTok{\#\textgreater{} Warning: Values from \textasciigrave{}value\textasciigrave{} are not uniquely identified; output will contain}
\CommentTok{\#\textgreater{} list{-}cols.}
\CommentTok{\#\textgreater{} * Use \textasciigrave{}values\_fn = list\textasciigrave{} to suppress this warning.}
\CommentTok{\#\textgreater{} * Use \textasciigrave{}values\_fn = \{summary\_fun\}\textasciigrave{} to summarise duplicates.}
\CommentTok{\#\textgreater{} * Use the following dplyr code to identify duplicates.}
\CommentTok{\#\textgreater{}   \{data\} |\textgreater{}}
\CommentTok{\#\textgreater{}   dplyr::summarise(n = dplyr::n(), .by = c(id, measurement)) |\textgreater{}}
\CommentTok{\#\textgreater{}   dplyr::filter(n \textgreater{} 1L)}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 3}
\CommentTok{\#\textgreater{}   id    bp1       bp2      }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}list\textgreater{}    \textless{}list\textgreater{}   }
\CommentTok{\#\textgreater{} 1 A     \textless{}dbl [2]\textgreater{} \textless{}dbl [1]\textgreater{}}
\CommentTok{\#\textgreater{} 2 B     \textless{}dbl [1]\textgreater{} \textless{}dbl [1]\textgreater{}}
\end{Highlighting}
\end{Shaded}

ç”±äºä½ è¿˜ä¸çŸ¥é“å¦‚ä½•å¤„ç†è¿™ç±»æ•°æ®ï¼Œå› æ­¤éœ€è¦éµå¾ªè­¦å‘Šä¸­çš„æç¤ºæ¥æ‰¾å‡ºé—®é¢˜æ‰€åœ¨:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(id, measurement) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{n =} \FunctionTok{n}\NormalTok{(), }\AttributeTok{.groups =} \StringTok{"drop"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(n }\SpecialCharTok{\textgreater{}} \DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 3}
\CommentTok{\#\textgreater{}   id    measurement     n}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}chr\textgreater{}       \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 A     bp1             2}
\end{Highlighting}
\end{Shaded}

æ¥ä¸‹æ¥ä½ éœ€è¦æ‰¾å‡ºä½ çš„æ•°æ®å‡ºäº†ä»€ä¹ˆé—®é¢˜ï¼Œç„¶åä¿®å¤æ½œåœ¨çš„æŸåï¼Œæˆ–è€…ä½¿ç”¨ä½ çš„åˆ†ç»„å’Œæ±‡æ€»æŠ€èƒ½æ¥ç¡®ä¿æ¯ä¸ªè¡Œå’Œåˆ—å€¼çš„ç»„åˆéƒ½åªæœ‰ä¸€è¡Œã€‚

\section{å°ç»“}\label{ux5c0fux7ed3-4}

åœ¨æœ¬ç« ä¸­ï¼Œä½ å­¦ä¹ äº†æ•´æ•´é½æ•°æ®ï¼šå°†æ•°æ®å˜é‡æ”¾åœ¨åˆ—ä¸­ï¼Œè§‚æµ‹æ”¾åœ¨è¡Œä¸­ã€‚æ•´
é½æ•°æ®ä½¿å¾—åœ¨tidyverseç¯å¢ƒä¸­å·¥ä½œæ›´åŠ å®¹æ˜“ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ç§è¢«å¤§å¤šæ•°å‡½æ•°æ‰€ç†è§£çš„ç»Ÿä¸€ç»“æ„ã€‚ä¸»
è¦çš„æŒ‘æˆ˜æ˜¯å°†ä½ ä»ä»»ä½•ç»“æ„ä¸­æ¥æ”¶åˆ°çš„æ•°æ®è½¬æ¢ä¸ºæ•´é½æ ¼å¼ã€‚ä¸º
æ­¤ï¼Œä½ å­¦ä¹ äº†\texttt{pivot\_longer()}å’Œ\texttt{pivot\_wider()}å‡½æ•°ï¼Œå®ƒä»¬å…è®¸ä½ æ•´ç†è®¸å¤šä¸æ•´é½çš„æ•°æ®é›†ã€‚æˆ‘
ä»¬åœ¨è¿™é‡Œç»™å‡ºçš„ä¾‹å­æ˜¯ä»\texttt{vignette("pivot",\ package\ =\ "tidyr")}ä¸­æŒ‘é€‰å‡ºæ¥çš„ï¼Œå› æ­¤å¦‚æœä½ é‡åˆ°æœ¬ç« æ²¡æœ‰å¸®åŠ©ä½ è§£å†³çš„é—®é¢˜ï¼Œé‚£ä¹ˆvignetteæ˜¯ä¸€ä¸ªè¿›è¡Œå°è¯•çš„å¥½åœ°æ–¹ã€‚

å¦ä¸€ä¸ªæŒ‘æˆ˜æ˜¯ï¼Œå¯¹äºç»™å®šçš„æ•°æ®é›†ï¼Œå¯èƒ½æ— æ³•å°†æ›´é•¿æˆ–æ›´å®½çš„ç‰ˆæœ¬æ ‡è®°ä¸º``æ•´é½''çš„ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šåæ˜ äº†æˆ‘ä»¬å¯¹æ•´æ´æ•°æ®çš„å®šä¹‰ã€‚æˆ‘
ä»¬è¯´æ•´é½æ•°æ®åœ¨æ¯åˆ—ä¸­éƒ½æœ‰ä¸€ä¸ªå˜é‡ï¼Œä½†æˆ‘ä»¬å®é™…ä¸Šå¹¶æ²¡æœ‰å®šä¹‰ä»€ä¹ˆæ˜¯å˜é‡ï¼ˆè€Œä¸”å®é™…ä¸Šå¾ˆéš¾è¿™æ ·åšï¼‰ã€‚åŠ¡
å®åœ°è¯´ï¼Œå˜é‡å°±æ˜¯ä½¿ä½ çš„åˆ†ææœ€å®¹æ˜“è¿›è¡Œçš„ä»»ä½•ä¸œè¥¿ã€‚å› 
æ­¤ï¼Œå¦‚æœä½ æ­£åœ¨ä¸ºå¦‚ä½•è¿›è¡ŒæŸäº›è®¡ç®—è€Œè‹¦æ¼ï¼Œè¯·è€ƒè™‘æ›´æ”¹ä½ çš„æ•°æ®ç»„ç»‡æ–¹å¼ï¼›ä¸è¦å®³æ€•åœ¨éœ€è¦æ—¶å–æ¶ˆæ•´é½åŒ–ã€è½¬æ¢å’Œé‡æ–°æ•´é½åŒ–ï¼

å¦‚æœä½ å–œæ¬¢è¿™ä¸€ç« å¹¶æƒ³äº†è§£æ›´å¤šåº•å±‚ç†è®ºï¼Œä½ å¯ä»¥å­¦ä¹ å‘è¡¨åœ¨ã€ŠJournal of
Statistical
Softwareã€‹ä¸Šçš„\href{https://www.jstatsoft.org/article/view/v059i10}{Tidy
Data} è®ºæ–‡ä¸­çš„å†å²å’Œç†è®ºåŸºç¡€ã€‚

ç°åœ¨ä½ å·²ç»ç¼–å†™äº†å¤§é‡çš„Rä»£ç ï¼Œæ˜¯æ—¶å€™å­¦ä¹ å¦‚ä½•å°†ä½ çš„ä»£ç ç»„ç»‡åˆ°æ–‡ä»¶å’Œç›®å½•ä¸­äº†ã€‚åœ¨
ä¸‹ä¸€ç« ä¸­ï¼Œä½ å°†äº†è§£è„šæœ¬å’Œé¡¹ç›®çš„æ‰€æœ‰ä¼˜åŠ¿ï¼Œä»¥åŠå®ƒä»¬æä¾›çš„ä¸€äº›å·¥å…·ï¼Œè¿™äº›å·¥å…·å°†ä½¿ä½ çš„ç”Ÿæ´»æ›´åŠ è½»æ¾ã€‚

\chapter{å·¥ä½œæµç¨‹: è„šæœ¬å’Œé¡¹ç›®}\label{sec-workflow-scripts-projects}

æœ¬ç« å°†å‘ä½ ä»‹ç»ç»„ç»‡ä»£ç çš„ä¸¤ä¸ªåŸºæœ¬å·¥å…·ï¼šè„šæœ¬å’Œé¡¹ç›®ã€‚

\section{è„šæœ¬}\label{ux811aux672c}

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å·²ç»ä½¿ç”¨æ§åˆ¶å°æ¥è¿è¡Œä»£ç ã€‚è¿™
æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ï¼Œä½†æ˜¯å½“ä½ åˆ›å»ºæ›´å¤æ‚çš„ggplot2å›¾å½¢å’Œæ›´é•¿çš„dplyrç®¡é“æ—¶ï¼Œæ‚¨ä¼šå‘ç°æ§åˆ¶å°ç©ºé—´å¾ˆå¿«å°±å˜å¾—ä¸å¤Ÿç”¨äº†ã€‚ä¸º
äº†ç»™è‡ªå·±æ›´å¤šçš„å·¥ä½œç©ºé—´ï¼Œè¯·ä½¿ç”¨è„šæœ¬ç¼–è¾‘å™¨ã€‚é€š
è¿‡ç‚¹å‡»``æ–‡ä»¶''èœå•ï¼Œé€‰æ‹©``æ–°å»ºæ–‡ä»¶''ï¼Œç„¶åé€‰æ‹©``Rè„šæœ¬''ï¼Œæˆ–è€…ä½¿ç”¨é”®ç›˜å¿«æ·é”®Cmd/Ctrl
+ Shift + Næ¥æ‰“å¼€å®ƒã€‚ä½  ä¼šçœ‹åˆ°å››ä¸ªçª—æ ¼ï¼Œå¦‚ å›¾~\ref{fig-rstudio-script}
æ‰€ç¤ºã€‚è„š æœ¬ç¼–è¾‘å™¨æ˜¯æµ‹è¯•ä»£ç çš„å¥½åœ°æ–¹ã€‚å½“
ä½ æƒ³è¦æ›´æ”¹æŸäº›å†…å®¹æ—¶ï¼Œä¸å†éœ€è¦é‡æ–°è¾“å…¥æ•´ä¸ªä»£ç ï¼Œåªéœ€ç¼–è¾‘è„šæœ¬å¹¶é‡æ–°è¿è¡Œå®ƒã€‚è€Œ
ä¸”ï¼Œä¸€æ—¦ç¼–å†™å¥½äº†ç¬¦åˆä½ éœ€æ±‚çš„ä»£ç ï¼Œå¯ä»¥å°†å…¶ä¿å­˜ä¸ºè„šæœ¬æ–‡ä»¶ï¼Œä»¥ä¾¿ä»¥åè½»æ¾è¿”å›ã€‚

\begin{figure}

\centering{

\includegraphics[width=5.43in,height=\textheight]{diagrams/rstudio/script.png}

}

\caption{\label{fig-rstudio-script}Opening the script editor adds a new
pane at the top-left of the IDE.}

\end{figure}%

\subsection{è¿è¡Œä»£ç }\label{ux8fd0ux884cux4ee3ux7801}

è„šæœ¬ç¼–è¾‘å™¨æ˜¯æ„å»ºå¤æ‚çš„ggplot2å›¾å½¢æˆ–é•¿åºåˆ—çš„dplyræ“ä½œçš„å¥½åœ°æ–¹ã€‚æœ‰
æ•ˆä½¿ç”¨è„šæœ¬ç¼–è¾‘å™¨çš„å…³é”®æ˜¯è®°ä½ä¸€ä¸ªæœ€é‡è¦çš„é”®ç›˜å¿«æ·é”®ï¼šCmd/Ctrl + Enterã€‚è¿™
ä¸ªå¿«æ·é”®å¯ä»¥åœ¨æ§åˆ¶å°ä¸­æ‰§è¡Œå½“å‰çš„Rè¡¨è¾¾å¼ã€‚ä¾‹ å¦‚ï¼Œè¯·çœ‹ä¸‹é¢çš„ä»£ç ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(dplyr)}
\FunctionTok{library}\NormalTok{(nycflights13)}

\NormalTok{not\_cancelled }\OtherTok{\textless{}{-}}\NormalTok{ flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(dep\_delay)â–ˆ, }\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(arr\_delay))}

\NormalTok{not\_cancelled }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(year, month, day) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{mean =} \FunctionTok{mean}\NormalTok{(dep\_delay))}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ çš„å…‰æ ‡ä½äºâ–ˆå¤„ï¼ŒæŒ‰ä¸‹Cmd/Ctrl +
Enterå°†è¿è¡Œç”Ÿæˆ\texttt{not\_cancelled}çš„å®Œæ•´å‘½ä»¤ã€‚åŒ
æ—¶ï¼Œå…‰æ ‡ä¹Ÿä¼šç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªè¯­å¥ï¼ˆä»¥\texttt{not\_cancelled\ \textbar{}\textgreater{}}å¼€å¤´ï¼‰ã€‚è¿™
ä½¿å¾—é€šè¿‡åå¤æŒ‰ä¸‹Cmd/Ctrl + Enteræ¥é€æ­¥æ‰§è¡Œæ•´ä¸ªè„šæœ¬å˜å¾—å¾ˆå®¹æ˜“ã€‚

ä¸å…¶é€ä¸ªè¡¨è¾¾å¼åœ°è¿è¡Œä»£ç ï¼Œè¿˜å¯ä»¥ä½¿ç”¨Cmd/Ctrl + Shift +
Sä¸€æ¬¡æ€§æ‰§è¡Œå®Œæ•´çš„è„šæœ¬ã€‚å®š
æœŸè¿™æ ·åšæ˜¯ä¿è¯ä½ æ•è·äº†è„šæœ¬ä¸­ä»£ç æ‰€æœ‰é‡è¦éƒ¨åˆ†çš„å¥½æ–¹æ³•ã€‚

æˆ‘ä»¬å»ºè®®ä½ å§‹ç»ˆåœ¨è„šæœ¬å¼€å¤´åˆ—å‡ºæ‰€éœ€çš„åŒ…ã€‚è¿™
æ ·ï¼Œå¦‚æœä¸ä»–äººå…±äº«ä»£ç ï¼Œä»–ä»¬å¯ä»¥è½»æ¾åœ°çœ‹åˆ°ä»–ä»¬éœ€è¦å®‰è£…å“ªäº›åŒ…ã€‚ä½†
æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œä¸è¦åœ¨å…±äº«çš„è„šæœ¬ä¸­åŒ…å«\texttt{install.packages()}ã€‚å¦‚
æœä¸å°å¿ƒå°†ä¸€ä¸ªä¼šæ›´æ”¹è®¡ç®—æœºçš„è„šæœ¬äº¤ç»™ä»–ä»¬æ˜¯æ¬ è€ƒè™‘çš„ï¼

åœ¨å­¦ä¹ åç»­ç« èŠ‚æ—¶ï¼Œæˆ‘ä»¬å¼ºçƒˆæ¨èä»è„šæœ¬ç¼–è¾‘å™¨å¼€å§‹å¹¶ç»ƒä¹ æ‚¨çš„é”®ç›˜å¿«æ·é”®ã€‚éš
ç€æ—¶é—´çš„æ¨ç§»ï¼Œä»¥è¿™ç§æ–¹å¼å°†ä»£ç å‘é€åˆ°æ§åˆ¶å°ä¼šå˜å¾—å¦‚æ­¤è‡ªç„¶ï¼Œç”šè‡³ä¸ç”¨å»è€ƒè™‘ã€‚

\subsection{RStudio è¯Šæ–­}\label{rstudio-ux8bcaux65ad}

åœ¨è„šæœ¬ç¼–è¾‘å™¨ä¸­ï¼ŒRStudioä¼šåœ¨ä¾§è¾¹æ ä¸­ç”¨ä¸€æ¡çº¢è‰²å¼¯å¼¯æ›²æ›²çš„çº¿å’Œä¸€ä¸ªå‰æ¥çªå‡ºæ˜¾ç¤ºè¯­æ³•é”™è¯¯ã€‚

\includegraphics[width=0.49in,height=\textheight]{screenshots/rstudio-diagnostic.png}

å°†é¼ æ ‡æ‚¬åœåœ¨åå­—ä¸Šï¼Œçœ‹çœ‹é—®é¢˜æ˜¯ä»€ä¹ˆï¼š

\includegraphics[width=0.77in,height=\textheight]{screenshots/rstudio-diagnostic-tip.png}

RStudio è¿˜ä¼šè®©æ‚¨äº†è§£æ½œåœ¨çš„é—®é¢˜ï¼š

\includegraphics[width=1.46in,height=\textheight]{screenshots/rstudio-diagnostic-warn.png}

\subsection{æ–‡ä»¶ä¿å­˜å’Œå‘½å}\label{ux6587ux4ef6ux4fddux5b58ux548cux547dux540d}

RStudio
åœ¨ä½ é€€å‡ºæ—¶ä¼šè‡ªåŠ¨ä¿å­˜è„šæœ¬ç¼–è¾‘å™¨çš„å†…å®¹ï¼Œå¹¶åœ¨é‡æ–°æ‰“å¼€æ—¶è‡ªåŠ¨åŠ è½½å®ƒã€‚ç„¶
è€Œï¼Œæœ€å¥½ä¸è¦ä½¿ç”¨``Untitled1''ï¼Œ``Untitled2''ï¼Œ``Untitled3''ç­‰å‘½åæ–¹å¼ï¼Œè€Œæ˜¯åº”è¯¥ä¿å­˜æ‚¨çš„è„šæœ¬å¹¶ç»™å®ƒä»¬èµ·ä¸€ä¸ªæœ‰æ„ä¹‰çš„åå­—ã€‚

å¯èƒ½ä½ ä¼šæƒ³ç”¨\texttt{code.R}æˆ–\texttt{myscript.R}æ¥å‘½åæ–‡ä»¶ï¼Œä½†åœ¨é€‰æ‹©æ–‡ä»¶åä¹‹å‰åº”è¯¥å¤šè€ƒè™‘ä¸€ä¸‹ã€‚æ–‡
ä»¶å‘½åçš„ä¸‰ä¸ªé‡è¦åŸåˆ™æ˜¯ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  æ–‡ä»¶ååº”è¯¥æ˜¯\textbf{æœºå™¨}å¯è¯»çš„ï¼šé¿å…ç©ºæ ¼ã€ç¬¦å·å’Œç‰¹æ®Šå­—ç¬¦ï¼Œä¸è¦ä¾èµ–å¤§å°å†™æ¥åŒºåˆ†æ–‡ä»¶ã€‚
\item
  æ–‡ä»¶ååº”è¯¥æ˜¯\textbf{äººç±»}å¯è¯»çš„ï¼šä½¿ç”¨æ–‡ä»¶åæ¥æè¿°æ–‡ä»¶ä¸­çš„å†…å®¹ã€‚
\item
  æ–‡ä»¶ååº”è¯¥ä¸é»˜è®¤æ’åºæ–¹å¼å…¼å®¹ï¼šä»¥æ•°å­—å¼€å¤´å‘½åæ–‡ä»¶ï¼Œä»¥ä¾¿æŒ‰å­—æ¯é¡ºåºæ’åºæ—¶ï¼Œå®ƒä»¬èƒ½æŒ‰ç…§ä½¿ç”¨çš„é¡ºåºæ’åˆ—ã€‚
\end{enumerate}

ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨åœ¨ä¸€ä¸ªé¡¹ç›®æ–‡ä»¶å¤¹ä¸­æœ‰ä»¥ä¸‹æ–‡ä»¶ï¼š

\begin{verbatim}
alternative model.R
code for exploratory analysis.r
finalreport.qmd
FinalReport.qmd
fig 1.png
Figure_02.png
model_first_try.R
run-first.r
temp.txt
\end{verbatim}

è¿™é‡Œå­˜åœ¨å‡ ä¸ªé—®é¢˜ï¼šå¾ˆéš¾ç¡®å®šå…ˆè¿è¡Œå“ªä¸ªæ–‡ä»¶ï¼›æ–‡ä»¶ååŒ…å«ç©ºæ ¼ï¼›æœ‰ä¸¤ä¸ªåç§°ç›¸åŒä½†å¤§å°å†™ä¸åŒçš„æ–‡ä»¶ï¼ˆ\texttt{finalreport}
ä¸
\texttt{FinalReport}\footnote{å¦‚æœä½ åœ¨åå­—ä¸­ä½¿ç”¨``final''æ›´æ˜¯åœ¨å†’é™©ğŸ˜†ï¼›æ¼«ç”»ã€ŠPiled
  Higher and
  Deeperã€‹ä¸­æœ‰ä¸€ä¸ª\href{https://phdcomics.com/comics/archive.php?comicid=1531}{å…³äºæ­¤è¯é¢˜çš„æœ‰è¶£è¿è½½}ã€‚}ï¼‰ï¼Œå¹¶ä¸”ä¸€äº›åç§°æ²¡æœ‰æè¿°å…¶å†…å®¹ï¼ˆ\texttt{run-first}
å’Œ \texttt{temp}ï¼‰ã€‚

ä¸‹é¢æ˜¯ä¸€ç§æ›´å¥½çš„å‘½åå’Œç»„ç»‡åŒä¸€ç»„æ–‡ä»¶çš„æ–¹æ³•:

\begin{verbatim}
01-load-data.R
02-exploratory-analysis.R
03-model-approach-1.R
04-model-approach-2.R
fig-01.png
fig-02.png
report-2022-03-20.qmd
report-2022-04-02.qmd
report-draft-notes.txt
\end{verbatim}

å¯¹å…³é”®è„šæœ¬è¿›è¡Œç¼–å·å¯ä»¥æ˜ç¡®å®ƒä»¬çš„è¿è¡Œé¡ºåºï¼Œè€Œä¸€è‡´çš„å‘½åæ–¹æ¡ˆå¯ä»¥æ›´å®¹æ˜“åœ°çœ‹å‡ºå‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–ã€‚æ­¤
å¤–ï¼Œå›¾è¡¨çš„æ ‡ç­¾ä¹Ÿç±»ä¼¼ï¼›æŠ¥å‘Šé€šè¿‡æ–‡ä»¶åä¸­åŒ…å«çš„æ—¥æœŸè¿›è¡ŒåŒºåˆ†ï¼Œè€Œ\texttt{temp}è¢«é‡å‘½åä¸º\texttt{report-draft-notes}ä»¥æ›´å¥½åœ°æè¿°å…¶å†…å®¹ã€‚å¦‚
æœæ‚¨åœ¨ç›®å½•ä¸­æœ‰å¤§é‡æ–‡ä»¶ï¼Œå»ºè®®è¿›ä¸€æ­¥ç»„ç»‡æ–‡ä»¶ï¼Œå°†ä¸åŒç±»å‹çš„æ–‡ä»¶ï¼ˆè„šæœ¬ã€å›¾è¡¨ç­‰ï¼‰æ”¾åœ¨ä¸åŒçš„ç›®å½•ä¸­ã€‚

\section{é¡¹ç›®}\label{ux9879ux76ee}

æœ‰æ—¶ï¼Œä½ å¯èƒ½éœ€è¦é€€å‡ºRå»åšå…¶ä»–çš„äº‹æƒ…ï¼Œç¨åå†å›åˆ°åˆ†æä»»åŠ¡ä¸­ï¼›æœ‰æ—¶ï¼Œä½ ä¼šåŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡ï¼Œå¹¶ä¸”å¸Œæœ›å°†å®ƒä»¬åˆ†å¼€ã€‚æœ‰
æ—¶ï¼Œä½ éœ€è¦å°†å¤–éƒ¨ä¸–ç•Œçš„æ•°æ®å¸¦å…¥Rï¼Œå¹¶å°†Rä¸­çš„æ•°å€¼ç»“æœå’Œå›¾è¡¨å‘é€å›å¤–éƒ¨ä¸–ç•Œã€‚

ä¸ºäº†å¤„ç†è¿™äº›å®é™…æƒ…å†µï¼Œä½ éœ€è¦åšå‡ºä¸¤ä¸ªå†³å®šï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  ä»€ä¹ˆæ˜¯çœŸç›¸çš„æ¥æºï¼Ÿä½ ä¼šä¿å­˜ä»€ä¹ˆä½œä¸ºå‘ç”Ÿçš„äº‹æƒ…çš„æ°¸ä¹…è®°å½•ï¼Ÿ
\item
  ä½ çš„åˆ†æåœ¨å“ªé‡Œè¿›è¡Œï¼Ÿ
\end{enumerate}

\subsection{ä»€ä¹ˆæ˜¯çœŸç›¸çš„æ¥æºï¼Ÿ}\label{ux4ec0ux4e48ux662fux771fux76f8ux7684ux6765ux6e90}

ä½œä¸ºåˆå­¦è€…ï¼Œä¾é å½“å‰ç¯å¢ƒï¼ˆEnvironment
ï¼‰åŒ…å«åˆ†æè¿‡ç¨‹ä¸­åˆ›å»ºçš„æ‰€æœ‰å¯¹è±¡æ˜¯æ— å¯åšéçš„ã€‚ä½†
æ˜¯ï¼Œä¸ºäº†æ›´å®¹æ˜“åœ°è¿›è¡Œå¤§å‹é¡¹ç›®æˆ–ä¸ä»–äººåˆä½œï¼ŒRè„šæœ¬åº”è¯¥æˆä¸ºäº‹å®çœŸç›¸çš„æ¥æºï¼Œä½ å¯ä»¥é€šè¿‡Rè„šæœ¬ï¼ˆå’Œæ•°æ®æ–‡ä»¶ï¼‰é‡æ–°åˆ›å»ºç¯å¢ƒã€‚å¦‚
æœåªæœ‰è‡ªå·±çš„ç¯å¢ƒï¼Œåˆ™å¾ˆéš¾é‡æ–°åˆ›å»ºRè„šæœ¬ï¼šä½ è¦ä¹ˆå¿…é¡»ä»è®°å¿†ä¸­é‡æ–°é”®å…¥å¤§é‡ä»£ç ï¼ˆåœ¨æ­¤è¿‡ç¨‹ä¸­ä¸å¯é¿å…åœ°ä¼šçŠ¯é”™è¯¯ï¼‰ï¼Œè¦ä¹ˆå¿…é¡»ä»”ç»†æŒ–æ˜æ‚¨çš„Rå†å²è®°å½•ã€‚

ä¸ºäº†å¸®åŠ©ä¿æŒRè„šæœ¬ä½œä¸ºä½ åˆ†æçš„çœŸç›¸æ¥æºï¼Œæˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½ ä¸è¦è®©RStudioåœ¨ä¼šè¯ä¹‹é—´ä¿ç•™æ‚¨çš„å·¥ä½œç©ºé—´ï¼ˆworkspaceï¼‰ã€‚æ‚¨
å¯ä»¥é€šè¿‡è¿è¡Œ\texttt{usethis::use\_blank\_slate()}\footnote{å¦‚æœæ²¡æœ‰å®‰è£…usethisï¼Œå¯ä»¥ä½¿ç”¨\texttt{install.packages("usethis")}å®‰è£…ã€‚}æˆ–æ¨¡ä»¿
å›¾~\ref{fig-blank-slate} ä¸­æ‰€ç¤ºçš„é€‰é¡¹æ¥å®ç°ã€‚
è¿™å°†ä¼šç»™æ‚¨å¸¦æ¥ä¸€äº›çŸ­æœŸçš„ç—›è‹¦ï¼Œå› ä¸ºç°åœ¨å½“æ‚¨é‡æ–°å¯åŠ¨RStudioæ—¶ï¼Œå®ƒå°†ä¸å†è®°ä½æ‚¨ä¸Šæ¬¡è¿è¡Œçš„ä»£ç ï¼Œæ‚¨åˆ›å»ºçš„å¯¹è±¡æˆ–è¯»å–çš„æ•°æ®é›†ä¹Ÿå°†æ— æ³•ä½¿ç”¨ã€‚
ä½†æ˜¯è¿™ç§çŸ­æœŸçš„ç—›è‹¦å¯ä»¥é¿å…é•¿æœŸçš„ç—›è‹¦ï¼Œå› ä¸ºå®ƒè¿«ä½¿ä½ åœ¨ä»£ç ä¸­æ•è·æ‰€æœ‰é‡è¦çš„è¿‡ç¨‹ã€‚
æ²¡æœ‰ä»€ä¹ˆæ¯”åœ¨äº‹å®å‘ç”Ÿä¸‰ä¸ªæœˆåå‘ç°ä½ åªåœ¨ç¯å¢ƒä¸­å­˜å‚¨äº†é‡è¦è®¡ç®—çš„ç»“æœï¼Œè€Œæ²¡æœ‰åœ¨ä»£ç ä¸­å­˜å‚¨è®¡ç®—æ›´ç³Ÿç³•çš„äº†ã€‚

\begin{figure}

\centering{

\includegraphics[width=5.44in,height=\textheight]{diagrams/rstudio/clean-slate.png}

}

\caption{\label{fig-blank-slate}Copy these options in your RStudio
options to always start your RStudio session with a clean slate.}

\end{figure}%

æœ‰ä¸€ç»„éå¸¸å®ç”¨çš„é”®ç›˜å¿«æ·é”®ç»„åˆï¼Œå®ƒä»¬å°†ååŒå·¥ä½œä»¥ç¡®ä¿ä½ å·²ç»åœ¨ç¼–è¾‘å™¨ä¸­æ•è·äº†ä»£ç çš„é‡è¦éƒ¨åˆ†ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  æŒ‰Cmd/Ctrl + Shift + 0/F10æ¥é‡å¯Rã€‚
\item
  æŒ‰Cmd/Ctrl + Shift + Sæ¥é‡æ–°è¿è¡Œå½“å‰è„šæœ¬ã€‚
\end{enumerate}

æˆ‘ä»¬æ¯å‘¨éƒ½ä¼šä½¿ç”¨è¿™ç§æ¨¡å¼æ•°ç™¾æ¬¡ã€‚

æˆ–è€…ï¼Œå¦‚æœä¸ä½¿ç”¨å¿«æ·é”®ï¼Œä½ å¯ä»¥è½¬åˆ°``ä¼šè¯''\textgreater{}``é‡å¯R''ï¼Œç„¶åé€‰ä¸­å¹¶é‡æ–°è¿è¡Œå½“å‰è„šæœ¬ã€‚

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, titlerule=0mm, breakable, colback=white, opacityback=0, bottomtitle=1mm, colbacktitle=quarto-callout-note-color!10!white, toptitle=1mm, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{RStudio server}, arc=.35mm, left=2mm, opacitybacktitle=0.6, rightrule=.15mm, bottomrule=.15mm, colframe=quarto-callout-note-color-frame, coltitle=black, leftrule=.75mm]

å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯RStudio serverï¼Œé»˜è®¤æƒ…å†µä¸‹Rä¼šè¯ä¸ä¼šè‡ªåŠ¨é‡å¯ã€‚å½“
ä½ å…³é—­RStudio
serveræ ‡ç­¾é¡µæ—¶ï¼Œå¯èƒ½ä¼šæ„Ÿè§‰æ­£åœ¨å…³é—­Rï¼Œä½†å®é™…ä¸ŠæœåŠ¡å™¨ä¼šåœ¨åå°ä¿æŒå…¶è¿è¡ŒçŠ¶æ€ã€‚ä¸‹
æ¬¡ä½ è¿”å›æ—¶ï¼Œä½ å°†å¤„äºå’Œç¦»å¼€æ—¶å®Œå…¨ç›¸åŒçš„ä½ç½®ã€‚è¿™
ä½¿å¾—å®šæœŸé‡å¯Rå˜å¾—å°¤ä¸ºé‡è¦ï¼Œä»¥ä¾¿ä½ æ˜¯ä»ä¸€ä¸ªå¹²å‡€çŠ¶æ€å¼€å§‹çš„ã€‚

\end{tcolorbox}

\subsection{åˆ†æåœ¨å“ªé‡Œè¿›è¡Œ?}\label{ux5206ux6790ux5728ux54eaux91ccux8fdbux884c}

\textbf{å·¥ä½œç›®å½•}æ˜¯Rä¸­éå¸¸é‡è¦çš„æ¦‚å¿µã€‚R
åœ¨è¿™ä¸ªç›®å½•ä¸­æŸ¥æ‰¾ä½ æƒ³è¦åŠ è½½çš„æ–‡ä»¶ï¼Œä¹Ÿå°†è¦ä¿å­˜çš„æ–‡ä»¶å­˜æ”¾åœ¨è¿™é‡Œã€‚R
Studioåœ¨æ§åˆ¶å°é¡¶éƒ¨æ˜¾ç¤ºå½“å‰çš„å·¥ä½œç›®å½•ï¼š

\includegraphics[width=1.07in,height=\textheight]{screenshots/rstudio-wd.png}

å¯ä»¥é€šè¿‡è¿è¡Œ\texttt{getwd()}å‡½æ•°åœ¨Rä»£ç ä¸­è¾“å‡ºå½“å‰çš„å·¥ä½œç›®å½•:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{getwd}\NormalTok{()}
\CommentTok{\#\textgreater{} [1] "/Users/hadley/Documents/r4ds"}
\end{Highlighting}
\end{Shaded}

æœ¬æ¬¡Rä¼šè¯ä¸­ï¼Œå½“å‰å·¥ä½œç›®å½•ï¼ˆå¯ä»¥å°†å…¶è§†ä¸º``ä¸»ç›®å½•''ï¼‰ä½äºHadleyçš„Documentsæ–‡ä»¶å¤¹ä¸­ä¸€ä¸ªåä¸ºr4dsçš„å­æ–‡ä»¶å¤¹ä¸­ã€‚å½“
æ‚¨è¿è¡Œæ­¤ä»£ç æ—¶ï¼Œå®ƒå°†è¿”å›ä¸åŒçš„ç»“æœï¼Œå› ä¸ºä½ çš„è®¡ç®—æœºçš„ç›®å½•ç»“æ„ä¸Hadleyçš„ä¸åŒï¼

ä½œä¸ºRçš„åˆå­¦è€…ï¼Œè®©å·¥ä½œç›®å½•æˆä¸ºä½ çš„ä¸»ç›®å½•ã€æ–‡æ¡£ç›®å½•æˆ–è€…è®¡ç®—æœºä¸Šçš„ä»»ä½•å…¶ä»–å¥‡æ€ªçš„ç›®å½•éƒ½æ˜¯å¯ä»¥çš„ã€‚ä½†
æ˜¯ï¼Œä½ å·²ç»é˜…è¯»äº†æœ¬ä¹¦ä¸­çš„å¤šä¸ªç« èŠ‚ï¼Œä¸å†æ˜¯åˆå­¦è€…äº†ã€‚ç°
åœ¨ï¼Œä½ åº”è¯¥å¼€å§‹å°†é¡¹ç›®ç»„ç»‡åˆ°ç›®å½•ä¸­ï¼Œå¹¶åœ¨å¤„ç†é¡¹ç›®æ—¶å°†Rçš„å·¥ä½œç›®å½•è®¾ç½®ä¸ºç›¸å…³ç›®å½•ã€‚

ä½ å¯ä»¥åœ¨Rå†…éƒ¨è®¾ç½®å·¥ä½œç›®å½•ï¼Œä½†\textbf{ä¸æ¨èè¿™æ ·åš}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{setwd}\NormalTok{(}\StringTok{"/path/to/my/CoolProject"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

æœ‰ä¸€ç§æ›´å¥½çš„æ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿèƒ½è®©æ‚¨åƒä¸“å®¶ä¸€æ ·ç®¡ç†Rå·¥ä½œã€‚é‚£
å°±æ˜¯ä½¿ç”¨RStudioé¡¹ç›®ã€‚

\subsection{RStudioé¡¹ç›®}\label{rstudioux9879ux76ee}

å°†æ‰€æœ‰ä¸æŸä¸ªé¡¹ç›®ç›¸å…³çš„æ–‡ä»¶ï¼ˆè¾“å…¥æ•°æ®ã€Rè„šæœ¬ã€åˆ†æç»“æœå’Œå›¾è¡¨ï¼‰ä¿å­˜åœ¨ä¸€ä¸ªç›®å½•ä¸­æ˜¯ä¸€ç§æ˜æ™ºä¸”å¸¸è§çš„åšæ³•ï¼ŒRStudioé€šè¿‡é¡¹ç›®æä¾›äº†å†…ç½®æ”¯æŒã€‚è®©
æˆ‘ä»¬ä¸ºæ‚¨åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œä»¥ä¾¿æ‚¨åœ¨ä½¿ç”¨æœ¬ä¹¦çš„å…¶ä½™éƒ¨åˆ†æ—¶å¯ä»¥ä½¿ç”¨å®ƒã€‚ç‚¹
å‡»``æ–‡ä»¶''\textgreater{}``æ–°å»ºé¡¹ç›®''ï¼Œç„¶åæŒ‰ç…§@fig-new-project
ä¸­æ˜¾ç¤ºçš„æ­¥éª¤æ“ä½œã€‚

\begin{figure}

\centering{

\includegraphics[width=3.91in,height=\textheight]{diagrams/new-project.png}

}

\caption{\label{fig-new-project}To create new project: (top) first click
New Directory, then (middle) click New Project, then (bottom) fill in
the directory (project) name, choose a good subdirectory for its home
and click Create Project.}

\end{figure}%

å°†ä½ çš„é¡¹ç›®å‘½åä¸º\texttt{r4ds}ï¼Œå¹¶ä»”ç»†è€ƒè™‘å°†å…¶æ”¾åœ¨å“ªä¸ªå­ç›®å½•ä¸­ã€‚å¦‚
æœä¸å°†å…¶å­˜å‚¨åœ¨ä¸€ä¸ªåˆç†çš„åœ°æ–¹ï¼Œå°†æ¥ä¼šå¾ˆéš¾æ‰¾åˆ°å®ƒï¼

ä¸€æ—¦å®Œæˆæ­¤è¿‡ç¨‹ï¼Œä½ å°†è·å¾—ä¸€ä¸ªä¸“ä¸ºæ­¤ä¹¦åˆ›å»ºçš„æ–°RStudioé¡¹ç›®ã€‚è¯·
æ£€æŸ¥é¡¹ç›®çš„``ä¸»ç›®å½•''æ˜¯å¦å·²è®¾ç½®ä¸ºå½“å‰å·¥ä½œç›®å½•ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{getwd}\NormalTok{()}
\CommentTok{\#\textgreater{} [1] /Users/hadley/Documents/r4ds}
\end{Highlighting}
\end{Shaded}

ç°åœ¨ï¼Œåœ¨è„šæœ¬ç¼–è¾‘å™¨ä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤å¹¶å°†æ–‡ä»¶ä¿å­˜ä¸º``diamonds.R''ã€‚ç„¶
åï¼Œåˆ›å»ºä¸€ä¸ªåä¸º``data''çš„æ–°æ–‡ä»¶å¤¹ã€‚ä½ 
å¯ä»¥é€šè¿‡åœ¨RStudioçš„``æ–‡ä»¶''é¢æ¿ä¸­ç‚¹å‡»``æ–°å»ºæ–‡ä»¶å¤¹''æŒ‰é’®æ¥å®Œæˆæ­¤æ“ä½œã€‚æœ€
åï¼Œè¿è¡Œå®Œæ•´çš„è„šæœ¬ï¼Œå®ƒå°†æŠŠPNGå’ŒCSVæ–‡ä»¶ä¿å­˜åˆ°æ‚¨çš„é¡¹ç›®ç›®å½•ä¸­ã€‚ä¸
ç”¨å…³æ³¨ç»†èŠ‚ï¼Œä½ å°†åœ¨æœ¬ä¹¦çš„åç»­ä¸­å­¦ä¹ å®ƒä»¬ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}

\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat, }\AttributeTok{y =}\NormalTok{ price)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_hex}\NormalTok{()}
\FunctionTok{ggsave}\NormalTok{(}\StringTok{"diamonds.png"}\NormalTok{)}

\FunctionTok{write\_csv}\NormalTok{(diamonds, }\StringTok{"data/diamonds.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

é€€å‡ºRStudioã€‚æ£€
æŸ¥ä¸ä½ çš„é¡¹ç›®å…³è”çš„æ–‡ä»¶å¤¹------æ³¨æ„\texttt{.Rproj}æ–‡ä»¶ã€‚åŒ
å‡»è¯¥æ–‡ä»¶ä»¥é‡æ–°æ‰“å¼€é¡¹ç›®ã€‚è¯·
æ³¨æ„ï¼Œä½ å›åˆ°äº†ç¦»å¼€æ—¶çš„ä½ç½®ï¼šå·¥ä½œç›®å½•å’Œå‘½ä»¤å†å²ä¸åŸæ¥ç›¸åŒï¼Œä½ æ­£åœ¨å¤„ç†çš„æ‰€æœ‰æ–‡ä»¶ä»ç„¶æ‰“å¼€ã€‚ä½†
æ˜¯ï¼Œç”±äºéµå¾ªäº†ä¸Šé¢çš„è¯´æ˜ï¼Œä½ å°†æ‹¥æœ‰ä¸€ä¸ªå…¨æ–°çš„ç¯å¢ƒï¼Œç¡®ä¿ä½ æ˜¯ä»ä¸€ä¸ªå¹²å‡€çš„çŠ¶æ€å¼€å§‹çš„ã€‚

æ ¹æ®æ“ä½œç³»ç»Ÿçš„ä¸åŒï¼Œé€‰æ‹©ä½ æœ€å–œæ¬¢çš„æ–¹å¼åœ¨è®¡ç®—æœºä¸Šæœç´¢\texttt{diamonds.png}ã€‚ä½ 
ä¼šæ‰¾åˆ°PNGæ–‡ä»¶ï¼ˆè¿™å¹¶ä¸å¥‡æ€ªï¼‰ï¼Œè¿˜ä¼šæ‰¾åˆ°åˆ›å»ºå®ƒçš„è„šæœ¬æ–‡ä»¶\texttt{diamonds.R}ã€‚è¿™
æ˜¯ä¸€ä¸ªå·¨å¤§çš„èƒœåˆ©ï¼æœ‰
ä¸€å¤©ï¼Œä½ å¯èƒ½ä¼šæƒ³è¦é‡æ–°ç”Ÿæˆä¸€ä¸ªå›¾å½¢æˆ–åªæ˜¯äº†è§£å®ƒçš„æ¥æºã€‚å¦‚
æœä½ ä¸¥æ ¼åœ°ä½¿ç”¨Rä»£ç å°†å›¾å½¢ä¿å­˜åˆ°æ–‡ä»¶ä¸­è€Œä»ä¸ä½¿ç”¨é¼ æ ‡æˆ–å‰ªè´´æ¿ï¼Œé‚£ä¹ˆä½ å°†èƒ½å¤Ÿè½»æ¾åœ°é‡å¤ä»¥å‰çš„å·¥ä½œï¼

\subsection{ç›¸å¯¹å’Œç»å¯¹è·¯å¾„}\label{ux76f8ux5bf9ux548cux7eddux5bf9ux8defux5f84}

ä¸€æ—¦è¿›å…¥ä¸€ä¸ªé¡¹ç›®ï¼Œä½ åº”è¯¥åªä½¿ç”¨ç›¸å¯¹è·¯å¾„è€Œä¸æ˜¯ç»å¯¹è·¯å¾„ã€‚æœ‰ ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿç›¸
å¯¹è·¯å¾„æ˜¯ç›¸å¯¹äºå·¥ä½œç›®å½•çš„ï¼Œå³é¡¹ç›®çš„æ ¹ç›®å½•ã€‚å½“
Hadleyåœ¨ä¸Šé¢å†™\texttt{data/diamonds.csv}æ—¶ï¼Œå®ƒæ˜¯\texttt{/Users/hadley/Documents/r4ds/data/diamonds.csv}çš„å¿«æ·æ–¹å¼ã€‚ä½†
å¦‚æœMineåœ¨å¥¹çš„è®¡ç®—æœºä¸Šè¿è¡Œè¿™æ®µä»£ç ï¼Œå®ƒå°†æŒ‡å‘\texttt{/Users/Mine/Documents/r4ds/data/diamonds.csv}ã€‚è¿™
å°±æ˜¯ä¸ºä»€ä¹ˆç›¸å¯¹è·¯å¾„å¾ˆé‡è¦ï¼šæ— è®ºRé¡¹ç›®æ–‡ä»¶å¤¹æœ€ç»ˆä½äºä½•å¤„ï¼Œå®ƒä»¬éƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚

ç»å¯¹è·¯å¾„æ˜¯æŒ‡å‘åŒä¸€ä¸ªä½ç½®ï¼Œä¸ä½ çš„å·¥ä½œç›®å½•æ— å…³ã€‚æ ¹
æ®æ“ä½œç³»ç»Ÿä¸åŒï¼Œå®ƒä»¬çœ‹ä¸Šå»ä¼šæœ‰æ‰€ä¸åŒã€‚åœ¨
Windowsä¸Šï¼Œå®ƒä»¬ä»¥é©±åŠ¨å™¨å­—æ¯ï¼ˆä¾‹å¦‚ï¼Œ\texttt{C:}ï¼‰æˆ–ä¸¤ä¸ªåæ–œæ ï¼ˆä¾‹å¦‚ï¼Œ\texttt{\textbackslash{}\textbackslash{}servername}ï¼‰å¼€å¤´ï¼Œè€Œåœ¨Mac/Linuxä¸Šï¼Œå®ƒä»¬ä»¥æ–œæ ``/''å¼€å¤´ï¼ˆä¾‹å¦‚ï¼Œ\texttt{/users/hadley}ï¼‰ã€‚ä½ 
ä¸åº”è¯¥åœ¨è„šæœ¬ä¸­ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œå› ä¸ºå®ƒä»¬ä¼šå¦¨ç¢å…±äº«ï¼šæ²¡æœ‰äººä¼šæ‹¥æœ‰ä¸ä½ å®Œå…¨ç›¸åŒçš„ç›®å½•é…ç½®ã€‚

æ“ä½œç³»ç»Ÿä¹‹é—´è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„åŒºåˆ«ï¼šå¦‚ä½•åˆ†éš”è·¯å¾„çš„å„ä¸ªéƒ¨åˆ†ã€‚M
acå’ŒLinuxä½¿ç”¨æ–œæ ï¼ˆä¾‹å¦‚ï¼Œ\texttt{data/diamonds.csv}ï¼‰ï¼Œè€ŒWindowsä½¿ç”¨åæ–œæ ï¼ˆä¾‹å¦‚ï¼Œ\texttt{data\textbackslash{}diamonds.csv}ï¼‰ã€‚R
å¯ä»¥ä¸è¿™ä¸¤ç§ç±»å‹ä¸€èµ·å·¥ä½œï¼ˆæ— è®ºä½ å½“å‰ä½¿ç”¨ä»€ä¹ˆå¹³å°ï¼‰ï¼Œä½†ä¸å¹¸çš„æ˜¯ï¼Œåæ–œæ åœ¨Rä¸­æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œè¦åœ¨è·¯å¾„ä¸­è·å¾—å•ä¸ªåæ–œæ ï¼Œæ‚¨éœ€è¦é”®å…¥ä¸¤ä¸ªåæ–œæ ï¼è¿™
ä¼šä½¿ç”Ÿæ´»å˜å¾—ä»¤äººæ²®ä¸§ï¼Œå› æ­¤æˆ‘ä»¬å»ºè®®ä½¿ç”¨Linux/Macé£æ ¼çš„æ–œæ ã€‚

\section{ç»ƒä¹ }\label{ux7ec3ux4e60-10}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ç™»å½•RStudio Tips Twitterè´¦æˆ·
  \url{https://twitter.com/rstudiotips}ï¼Œæ‰¾åˆ°ä¸€ä¸ªæœ‰è¶£çš„æŠ€å·§ï¼Œç»ƒä¹ ä½¿ç”¨å®ƒï¼
\item
  RStudioè¯Šæ–­è¿˜ä¼šæŠ¥å‘Šå“ªäº›å¸¸è§é”™è¯¯ï¼Ÿé˜… è¯»
  \url{https://support.posit.co/hc/en-us/articles/205753617-Code-Diagnostics}
  æ‰¾åˆ°ç­”æ¡ˆã€‚
\end{enumerate}

\section{å°ç»“}\label{ux5c0fux7ed3-5}

åœ¨æœ¬ç« ä¸­ï¼Œä½ å­¦ä¹ äº†å¦‚ä½•åœ¨è„šæœ¬ï¼ˆæ–‡ä»¶ï¼‰å’Œé¡¹ç›®ï¼ˆç›®å½•ï¼‰ä¸­ç»„ç»‡ä»£ç ã€‚å°±
åƒä»£ç é£æ ¼ä¸€æ ·ï¼Œè¿™åœ¨ä¸€å¼€å§‹å¯èƒ½ä¼šæ„Ÿè§‰åƒæ˜¯åœ¨åšæ— ç”¨åŠŸã€‚ä½†
æ˜¯ï¼Œéšç€ä½ åœ¨å¤šä¸ªé¡¹ç›®ä¸­ç§¯ç´¯æ›´å¤šçš„ä»£ç ï¼Œä½ ä¼šå¼€å§‹è®¤è¯†åˆ°å‰æœŸçš„ä¸€ç‚¹ç»„ç»‡å·¥ä½œå¯ä»¥ä¸ºä½ èŠ‚çœå¤§é‡çš„æ—¶é—´ã€‚

æ€»çš„æ¥è¯´ï¼Œè„šæœ¬å’Œé¡¹ç›®ä¸ºä½ æä¾›äº†ä¸€ä¸ªåšå®çš„å·¥ä½œæµç¨‹ï¼Œè¿™ä¼šåœ¨æœªæ¥å¾ˆå¥½åœ°ä¸ºä½ æœåŠ¡ï¼š

\begin{itemize}
\tightlist
\item
  ä¸ºæ¯ä¸ªæ•°æ®åˆ†æé¡¹ç›®åˆ›å»ºä¸€ä¸ªRStudioé¡¹ç›®ï¼›
\item
  åœ¨é¡¹ç›®ä¸­ä¿å­˜ä½ çš„è„šæœ¬ï¼ˆèµ·ä¸€ä¸ªå¸¦æœ‰ä¿¡æ¯çš„åå­—ï¼‰ï¼Œç¼–è¾‘å®ƒä»¬ï¼Œåˆ†éƒ¨åˆ†æˆ–æ•´ä½“è¿è¡Œå®ƒä»¬ï¼›ç»å¸¸é‡æ–°å¯åŠ¨Rä»¥ç¡®ä¿ä½ å·²å°†æ‰€æœ‰å†…å®¹æ•è·åˆ°è„šæœ¬ä¸­ã€‚
\item
  æ°¸è¿œåªä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œè€Œä¸æ˜¯ç»å¯¹è·¯å¾„ã€‚
\end{itemize}

ç„¶åï¼Œä½ éœ€è¦çš„æ‰€æœ‰å†…å®¹éƒ½å­˜æ”¾äºä¸€ä¸ªåœ°æ–¹ï¼Œå¹¶ä¸”ä¸æ‚¨æ­£åœ¨å¤„ç†çš„æ‰€æœ‰å…¶ä»–é¡¹ç›®å¹²å‡€åœ°åˆ†éš”å¼€ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨ä½¿ç”¨RåŒ…ä¸­åŒ…å«çš„æ•°æ®é›†ã€‚è¿™
ä½¿å¾—åœ¨é¢„å…ˆå‡†å¤‡çš„æ•°æ®ä¸Šè¿›è¡Œä¸€äº›å®è·µå˜å¾—æ›´å®¹æ˜“ï¼Œä½†æ˜¾ç„¶ä½ çš„æ•°æ®ä¸ä¼šä»¥è¿™ç§æ–¹å¼æä¾›ã€‚å› 
æ­¤ï¼Œåœ¨ä¸‹ä¸€ç« ä¸­å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨readråŒ…å°†æ•°æ®ä»ç£ç›˜åŠ è½½åˆ°Rä¼šè¯ä¸­ã€‚

\chapter{æ•°æ®å¯¼å…¥}\label{sec-data-import}

\section{å¼•è¨€}\label{ux5f15ux8a00-3}

ä½¿ç”¨RåŒ…æä¾›çš„æ•°æ®æ¥å­¦ä¹ æ•°æ®ç§‘å­¦å·¥å…·æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ï¼Œä½†æ€»æœ‰ä¸€å¤©ä½ ä¼šæƒ³å°†æ‰€å­¦åº”ç”¨äºè‡ªå·±çš„æ•°æ®ã€‚åœ¨
æœ¬ç« ä¸­ï¼Œä½ å°†å­¦ä¹ å°†æ•°æ®æ–‡ä»¶è¯»å…¥Rçš„åŸºç¡€çŸ¥è¯†ã€‚

å…·ä½“æ¥è¯´ï¼Œæœ¬ç« å°†é‡ç‚¹å…³æ³¨è¯»å–çº¯æ–‡æœ¬çŸ©å½¢æ–‡ä»¶ã€‚æˆ‘
ä»¬å°†ä»å¤„ç†åˆ—åã€ç±»å‹å’Œç¼ºå¤±æ•°æ®çš„å®ç”¨å»ºè®®å¼€å§‹ã€‚ç„¶
åï¼Œå­¦ä¹ å¦‚ä½•ä¸€æ¬¡ä»å¤šä¸ªæ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼Œä»¥åŠå¦‚ä½•å°†Rä¸­çš„æ•°æ®å†™å…¥æ–‡ä»¶ã€‚æœ€
åï¼Œå­¦ä¹ å¦‚ä½•åœ¨Rä¸­æ‰‹åŠ¨åˆ›å»ºæ•°æ®æ¡†ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-3}

åœ¨æœ¬ç« ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨\textbf{readr}åŒ…åœ¨Rä¸­åŠ è½½å¹³é¢æ–‡ä»¶ï¼ŒreadråŒ…æ˜¯æ ¸å¿ƒåŒ…tidyverseçš„ä¸€éƒ¨åˆ†ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\section{ä»æ–‡ä»¶è¯»å–æ•°æ®}\label{ux4eceux6587ux4ef6ux8bfbux53d6ux6570ux636e}

é¦–å…ˆï¼Œæˆ‘ä»¬å°†å…³æ³¨æœ€å¸¸è§çš„çŸ©å½¢æ•°æ®æ–‡ä»¶ç±»å‹ï¼šCSVï¼ˆComma-Separated
Valuesçš„ç¼©å†™ï¼‰ã€‚ä¸‹
é¢æ˜¯ä¸€ä¸ªç®€å•çš„CSVæ–‡ä»¶ï¼Œç¬¬ä¸€è¡Œé€šå¸¸è¢«ç§°ä¸ºæ ‡é¢˜è¡Œï¼Œç»™å‡ºäº†åˆ—åï¼Œæ¥ä¸‹æ¥çš„å…­è¡Œæä¾›äº†æ•°æ®ï¼Œåˆ—ä¹‹é—´ç”±é€—å·åˆ†éš”ï¼Œä¹Ÿç§°ä¸ºå®šç•Œç¬¦ã€‚

\begin{verbatim}
Student ID,Full Name,favourite.food,mealPlan,AGE
1,Sunil Huffmann,Strawberry yoghurt,Lunch only,4
2,Barclay Lynn,French fries,Lunch only,5
3,Jayendra Lyne,N/A,Breakfast and lunch,7
4,Leon Rossini,Anchovies,Lunch only,
5,Chidiegwu Dunkel,Pizza,Breakfast and lunch,five
6,GÃ¼venÃ§ Attila,Ice cream,Lunch only,6
\end{verbatim}

è¡¨~\ref{tbl-students-table} ä»¥è¡¨æ ¼å½¢å¼å‘ˆç°äº†ç›¸åŒçš„æ•°æ®ã€‚

\begin{longtable}[]{@{}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 8\tabcolsep) * \real{0.1528}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 8\tabcolsep) * \real{0.2361}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 8\tabcolsep) * \real{0.2639}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 8\tabcolsep) * \real{0.2778}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 8\tabcolsep) * \real{0.0694}}@{}}

\caption{\label{tbl-students-table}Data from the students.csv file as a
table.}

\tabularnewline

\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedleft
Student ID
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Full Name
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
favourite.food
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
mealPlan
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
AGE
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1 & Sunil Huffmann & Strawberry yoghurt & Lunch only & 4 \\
2 & Barclay Lynn & French fries & Lunch only & 5 \\
3 & Jayendra Lyne & N/A & Breakfast and lunch & 7 \\
4 & Leon Rossini & Anchovies & Lunch only & NA \\
5 & Chidiegwu Dunkel & Pizza & Breakfast and lunch & five \\
6 & GÃ¼venÃ§ Attila & Ice cream & Lunch only & 6 \\

\end{longtable}

æˆ‘ä»¬ä½¿ç”¨\texttt{read\_csv()}å°†è¿™ä¸ªæ–‡ä»¶è¯»å…¥Rã€‚ç¬¬
ä¸€ä¸ªå‚æ•°æ˜¯æœ€é‡è¦çš„ï¼šæ–‡ä»¶è·¯å¾„ã€‚å¯
ä»¥å°†è·¯å¾„è§†ä¸ºæ–‡ä»¶çš„åœ°å€ï¼Œæ–‡ä»¶åä¸º\texttt{students.csv}ï¼Œå®ƒä½äº\texttt{data}æ–‡ä»¶å¤¹ä¸­ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{students }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"data/students.csv"}\NormalTok{)}
\CommentTok{\#\textgreater{} Rows: 6 Columns: 5}
\CommentTok{\#\textgreater{} {-}{-} Column specification {-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}{-}}
\CommentTok{\#\textgreater{} Delimiter: ","}
\CommentTok{\#\textgreater{} chr (4): Full Name, favourite.food, mealPlan, AGE}
\CommentTok{\#\textgreater{} dbl (1): Student ID}
\CommentTok{\#\textgreater{} }
\CommentTok{\#\textgreater{} i Use \textasciigrave{}spec()\textasciigrave{} to retrieve the full column specification for this data.}
\CommentTok{\#\textgreater{} i Specify the column types or set \textasciigrave{}show\_col\_types = FALSE\textasciigrave{} to quiet this message.}
\end{Highlighting}
\end{Shaded}

ä¸Šé¢çš„ä»£ç åœ¨ä½ çš„é¡¹ç›®ä¸­å­˜åœ¨åä¸º \texttt{data} çš„æ–‡ä»¶å¤¹å¹¶ä¸”å…¶ä¸­åŒ…å«
\texttt{students.csv} æ–‡ä»¶æ—¶æœ‰æ•ˆã€‚æ‚¨
å¯ä»¥ä»\url{https://pos.it/r4ds-students-csv}ä¸‹è½½ \texttt{students.csv}
æ–‡ä»¶ï¼Œæˆ–è€…å¯ä»¥ç›´æ¥ä»è¯¥URLè¯»å–å®ƒï¼Œä½¿ç”¨å¦‚ä¸‹æ–¹å¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{students }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"https://pos.it/r4ds{-}students{-}csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

å½“ä½ è¿è¡Œ\texttt{read\_csv()}æ—¶ï¼Œå®ƒä¼šè¾“å‡ºä¸€æ¡æ¶ˆæ¯ï¼Œå‘Šè¯‰ä½ æ•°æ®çš„è¡Œæ•°å’Œåˆ—æ•°ã€æ‰€ä½¿ç”¨çš„åˆ†éš”ç¬¦ä»¥åŠåˆ—è§„èŒƒï¼ˆæŒ‰åˆ—ä¸­æ•°æ®ç±»å‹ç»„ç»‡çš„åˆ—åï¼‰ã€‚å®ƒ
è¿˜ä¼šè¾“å‡ºå…³äºå¦‚ä½•æ£€ç´¢å®Œæ•´åˆ—è§„èŒƒå’Œå¦‚ä½•é™é»˜æ­¤æ¶ˆæ¯çš„ä¸€äº›ä¿¡æ¯ã€‚è¿™
æ¡æ¶ˆæ¯æ˜¯\texttt{readr}åŒ…çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†åœ¨@sec-col-types
ä¸­å†æ¬¡è®¨è®ºå®ƒã€‚

\subsection{å®ç”¨å»ºè®®}\label{ux5b9eux7528ux5efaux8bae}

ä¸€æ—¦ä½ è¯»å–äº†æ•°æ®ï¼Œç¬¬ä¸€æ­¥é€šå¸¸æ˜¯ä»¥æŸç§æ–¹å¼è½¬æ¢å®ƒï¼Œä»¥ä½¿å…¶åœ¨å‰©ä½™çš„åˆ†æä¸­æ›´å®¹æ˜“å¤„ç†ã€‚è®©
æˆ‘ä»¬å¸¦ç€è¿™ä¸ªæƒ³æ³•å†æ¬¡æŸ¥çœ‹\texttt{students}æ•°æ®ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{students}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 5}
\CommentTok{\#\textgreater{}   \textasciigrave{}Student ID\textasciigrave{} \textasciigrave{}Full Name\textasciigrave{}      favourite.food     mealPlan            AGE  }
\CommentTok{\#\textgreater{}          \textless{}dbl\textgreater{} \textless{}chr\textgreater{}            \textless{}chr\textgreater{}              \textless{}chr\textgreater{}               \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1            1 Sunil Huffmann   Strawberry yoghurt Lunch only          4    }
\CommentTok{\#\textgreater{} 2            2 Barclay Lynn     French fries       Lunch only          5    }
\CommentTok{\#\textgreater{} 3            3 Jayendra Lyne    N/A                Breakfast and lunch 7    }
\CommentTok{\#\textgreater{} 4            4 Leon Rossini     Anchovies          Lunch only          \textless{}NA\textgreater{} }
\CommentTok{\#\textgreater{} 5            5 Chidiegwu Dunkel Pizza              Breakfast and lunch five }
\CommentTok{\#\textgreater{} 6            6 GÃ¼venÃ§ Attila    Ice cream          Lunch only          6}
\end{Highlighting}
\end{Shaded}

åœ¨\texttt{favourite.food}åˆ—ä¸­æœ‰ä¸€å †é£Ÿå“é¡¹ç›®ï¼Œç„¶åæ˜¯å­—ç¬¦ä¸²\texttt{N/A}ï¼Œå®ƒåº”è¯¥æ˜¯ä¸€ä¸ª
R ä¼šè¯†åˆ«ä¸º``ä¸å¯ç”¨''çš„çœŸæ­£çš„\texttt{NA}å€¼ã€‚è¿™
æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡\texttt{na}å‚æ•°æ¥è§£å†³çš„é—®é¢˜ã€‚é»˜
è®¤æƒ…å†µä¸‹ï¼Œ\texttt{read\_csv()}åªå°†æ­¤æ•°æ®é›†ä¸­çš„ç©ºå­—ç¬¦ä¸²(\texttt{""})
è¯†åˆ«ä¸º \texttt{NA}sï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒä¹Ÿèƒ½è¯†åˆ«å­—ç¬¦ä¸²\texttt{"N/A"}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{students }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"data/students.csv"}\NormalTok{, }\AttributeTok{na =} \FunctionTok{c}\NormalTok{(}\StringTok{"N/A"}\NormalTok{, }\StringTok{""}\NormalTok{))}

\NormalTok{students}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 5}
\CommentTok{\#\textgreater{}   \textasciigrave{}Student ID\textasciigrave{} \textasciigrave{}Full Name\textasciigrave{}      favourite.food     mealPlan            AGE  }
\CommentTok{\#\textgreater{}          \textless{}dbl\textgreater{} \textless{}chr\textgreater{}            \textless{}chr\textgreater{}              \textless{}chr\textgreater{}               \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1            1 Sunil Huffmann   Strawberry yoghurt Lunch only          4    }
\CommentTok{\#\textgreater{} 2            2 Barclay Lynn     French fries       Lunch only          5    }
\CommentTok{\#\textgreater{} 3            3 Jayendra Lyne    \textless{}NA\textgreater{}               Breakfast and lunch 7    }
\CommentTok{\#\textgreater{} 4            4 Leon Rossini     Anchovies          Lunch only          \textless{}NA\textgreater{} }
\CommentTok{\#\textgreater{} 5            5 Chidiegwu Dunkel Pizza              Breakfast and lunch five }
\CommentTok{\#\textgreater{} 6            6 GÃ¼venÃ§ Attila    Ice cream          Lunch only          6}
\end{Highlighting}
\end{Shaded}

ä½ å¯èƒ½è¿˜æ³¨æ„åˆ°ï¼Œ\texttt{Student\ ID}å’Œ\texttt{Full\ Name}åˆ—ä½¿ç”¨äº†åå¼•å·ã€‚è¿™
æ˜¯å› ä¸ºå®ƒä»¬åŒ…å«ç©ºæ ¼ï¼Œè¿åäº† R
ä¸­å˜é‡åçš„å¸¸è§„è§„åˆ™ï¼Œå®ƒä»¬æ˜¯éè¯­æ³•ï¼ˆ\textbf{non-syntactic}ï¼‰åç§°ã€‚è¦
å¼•ç”¨è¿™äº›å˜é‡ï¼Œä½ éœ€è¦ä½¿ç”¨åå¼•å·\texttt{\textasciigrave{}}å°†å®ƒä»¬æ‹¬èµ·æ¥ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{students }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{rename}\NormalTok{(}
    \AttributeTok{student\_id =} \StringTok{\textasciigrave{}}\AttributeTok{Student ID}\StringTok{\textasciigrave{}}\NormalTok{,}
    \AttributeTok{full\_name =} \StringTok{\textasciigrave{}}\AttributeTok{Full Name}\StringTok{\textasciigrave{}}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 5}
\CommentTok{\#\textgreater{}   student\_id full\_name        favourite.food     mealPlan            AGE  }
\CommentTok{\#\textgreater{}        \textless{}dbl\textgreater{} \textless{}chr\textgreater{}            \textless{}chr\textgreater{}              \textless{}chr\textgreater{}               \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1          1 Sunil Huffmann   Strawberry yoghurt Lunch only          4    }
\CommentTok{\#\textgreater{} 2          2 Barclay Lynn     French fries       Lunch only          5    }
\CommentTok{\#\textgreater{} 3          3 Jayendra Lyne    \textless{}NA\textgreater{}               Breakfast and lunch 7    }
\CommentTok{\#\textgreater{} 4          4 Leon Rossini     Anchovies          Lunch only          \textless{}NA\textgreater{} }
\CommentTok{\#\textgreater{} 5          5 Chidiegwu Dunkel Pizza              Breakfast and lunch five }
\CommentTok{\#\textgreater{} 6          6 GÃ¼venÃ§ Attila    Ice cream          Lunch only          6}
\end{Highlighting}
\end{Shaded}

å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨~\texttt{janitor::clean\_names()}~å‡½æ•°ï¼Œè¯¥å‡½æ•°ä½¿ç”¨ä¸€äº›å¯å‘å¼æ–¹æ³•æ¥ä¸€æ¬¡æ€§å°†å®ƒä»¬å…¨éƒ¨è½¬æ¢ä¸ºè›‡å½¢å‘½åæ³•ï¼ˆsnake
caseï¼‰\footnote{\href{http://sfirke.github.io/janitor/}{janitor}åŒ…ä¸æ˜¯tidyverseçš„ä¸€éƒ¨åˆ†ï¼Œä½†å®ƒæä¾›äº†æ–¹ä¾¿çš„æ•°æ®æ¸…ç†åŠŸèƒ½ï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨\texttt{\textbar{}\textgreater{}}çš„æ•°æ®ç®¡é“ä¸­å·¥ä½œå¾—å¾ˆå¥½ã€‚}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{students }\SpecialCharTok{|\textgreater{}}\NormalTok{ janitor}\SpecialCharTok{::}\FunctionTok{clean\_names}\NormalTok{()}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 5}
\CommentTok{\#\textgreater{}   student\_id full\_name        favourite\_food     meal\_plan           age  }
\CommentTok{\#\textgreater{}        \textless{}dbl\textgreater{} \textless{}chr\textgreater{}            \textless{}chr\textgreater{}              \textless{}chr\textgreater{}               \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1          1 Sunil Huffmann   Strawberry yoghurt Lunch only          4    }
\CommentTok{\#\textgreater{} 2          2 Barclay Lynn     French fries       Lunch only          5    }
\CommentTok{\#\textgreater{} 3          3 Jayendra Lyne    \textless{}NA\textgreater{}               Breakfast and lunch 7    }
\CommentTok{\#\textgreater{} 4          4 Leon Rossini     Anchovies          Lunch only          \textless{}NA\textgreater{} }
\CommentTok{\#\textgreater{} 5          5 Chidiegwu Dunkel Pizza              Breakfast and lunch five }
\CommentTok{\#\textgreater{} 6          6 GÃ¼venÃ§ Attila    Ice cream          Lunch only          6}
\end{Highlighting}
\end{Shaded}

è¯»å–æ•°æ®åçš„å¦ä¸€ä¸ªå¸¸è§ä»»åŠ¡æ˜¯è€ƒè™‘å˜é‡ç±»å‹ã€‚ä¾‹
å¦‚ï¼Œ\texttt{meal\_plan}æ˜¯ä¸€ä¸ªåˆ†ç±»å˜é‡ï¼Œå…·æœ‰ä¸€ç»„å·²çŸ¥çš„å¯èƒ½å€¼ï¼Œåœ¨ R
ä¸­åº”è¯¥è¡¨ç¤ºä¸ºå› å­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{students }\SpecialCharTok{|\textgreater{}}
\NormalTok{  janitor}\SpecialCharTok{::}\FunctionTok{clean\_names}\NormalTok{() }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{meal\_plan =} \FunctionTok{factor}\NormalTok{(meal\_plan))}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 5}
\CommentTok{\#\textgreater{}   student\_id full\_name        favourite\_food     meal\_plan           age  }
\CommentTok{\#\textgreater{}        \textless{}dbl\textgreater{} \textless{}chr\textgreater{}            \textless{}chr\textgreater{}              \textless{}fct\textgreater{}               \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1          1 Sunil Huffmann   Strawberry yoghurt Lunch only          4    }
\CommentTok{\#\textgreater{} 2          2 Barclay Lynn     French fries       Lunch only          5    }
\CommentTok{\#\textgreater{} 3          3 Jayendra Lyne    \textless{}NA\textgreater{}               Breakfast and lunch 7    }
\CommentTok{\#\textgreater{} 4          4 Leon Rossini     Anchovies          Lunch only          \textless{}NA\textgreater{} }
\CommentTok{\#\textgreater{} 5          5 Chidiegwu Dunkel Pizza              Breakfast and lunch five }
\CommentTok{\#\textgreater{} 6          6 GÃ¼venÃ§ Attila    Ice cream          Lunch only          6}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„ï¼Œ\texttt{meal\_plan}å˜é‡ä¸­çš„å€¼ä¿æŒä¸å˜ï¼Œä½†å˜é‡åä¸‹æ–¹è¡¨ç¤ºçš„å˜é‡ç±»å‹å·²ç»ä»å­—ç¬¦å‹ï¼ˆ\texttt{\textless{}chr}\textgreaterï¼‰å˜ä¸ºäº†å› å­å‹ï¼ˆ\textless{}\texttt{fct}\textgreaterï¼‰ã€‚ä½ 
å°†åœ¨ ç« èŠ‚~\ref{sec-factors} ä¸­äº†è§£æ›´å¤šå…³äºå› å­çš„å†…å®¹ã€‚

åœ¨åˆ†æè¿™äº›æ•°æ®ä¹‹å‰ï¼Œä½ å¯èƒ½æƒ³è¦ä¿®å¤\texttt{age}å’Œ\texttt{id}åˆ—ã€‚ç›®
å‰ï¼Œ\texttt{age}æ˜¯ä¸€ä¸ªå­—ç¬¦å‹å˜é‡ï¼Œå› ä¸ºå…¶ä¸­ä¸€ä¸ªè§‚æµ‹å€¼è¢«è¾“å…¥ä¸ºæ–‡æœ¬\texttt{five}è€Œä¸æ˜¯æ•°å­—\texttt{5}ã€‚æˆ‘
ä»¬å°†åœ¨ ç« èŠ‚~\ref{sec-import-spreadsheets} è¯¦ç»†è®¨è®ºå¦‚ä½•ä¿®å¤è¿™ä¸ªé—®é¢˜ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{students }\OtherTok{\textless{}{-}}\NormalTok{ students }\SpecialCharTok{|\textgreater{}}
\NormalTok{  janitor}\SpecialCharTok{::}\FunctionTok{clean\_names}\NormalTok{() }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{meal\_plan =} \FunctionTok{factor}\NormalTok{(meal\_plan),}
    \AttributeTok{age =} \FunctionTok{parse\_number}\NormalTok{(}\FunctionTok{if\_else}\NormalTok{(age }\SpecialCharTok{==} \StringTok{"five"}\NormalTok{, }\StringTok{"5"}\NormalTok{, age))}
\NormalTok{  )}

\NormalTok{students}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 5}
\CommentTok{\#\textgreater{}   student\_id full\_name        favourite\_food     meal\_plan             age}
\CommentTok{\#\textgreater{}        \textless{}dbl\textgreater{} \textless{}chr\textgreater{}            \textless{}chr\textgreater{}              \textless{}fct\textgreater{}               \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1          1 Sunil Huffmann   Strawberry yoghurt Lunch only              4}
\CommentTok{\#\textgreater{} 2          2 Barclay Lynn     French fries       Lunch only              5}
\CommentTok{\#\textgreater{} 3          3 Jayendra Lyne    \textless{}NA\textgreater{}               Breakfast and lunch     7}
\CommentTok{\#\textgreater{} 4          4 Leon Rossini     Anchovies          Lunch only             NA}
\CommentTok{\#\textgreater{} 5          5 Chidiegwu Dunkel Pizza              Breakfast and lunch     5}
\CommentTok{\#\textgreater{} 6          6 GÃ¼venÃ§ Attila    Ice cream          Lunch only              6}
\end{Highlighting}
\end{Shaded}

è¿™é‡Œæœ‰ä¸€ä¸ªæ–°çš„å‡½æ•°\texttt{if\_else()}ï¼Œå®ƒæœ‰ä¸‰ä¸ªå‚æ•°ã€‚ç¬¬
ä¸€ä¸ªå‚æ•°\texttt{test}åº”è¯¥æ˜¯ä¸€ä¸ªé€»è¾‘å‘é‡ã€‚å½“
\texttt{test}ä¸º\texttt{TRUE}æ—¶ï¼Œç»“æœå°†åŒ…å«ç¬¬äºŒä¸ªå‚æ•°\texttt{yes}çš„å€¼ï¼›å½“å®ƒä¸º\texttt{FALSE}æ—¶ï¼Œå°†åŒ…å«ç¬¬ä¸‰ä¸ªå‚æ•°\texttt{no}çš„å€¼ã€‚åœ¨
è¿™é‡Œï¼Œæˆ‘ä»¬è¡¨ç¤ºå¦‚æœ\texttt{age}æ˜¯å­—ç¬¦ä¸² \texttt{"five"}ï¼Œåˆ™å°†å…¶å˜ä¸º
\texttt{"5"}ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™ä¿æŒåŸæ ·ã€‚ä½  å°†åœ¨ ç« èŠ‚~\ref{sec-logicals}
éƒ¨åˆ†äº†è§£æ›´å¤šå…³äº\texttt{if\_else()}å’Œé€»è¾‘å‘é‡çš„å†…å®¹ã€‚

\subsection{å…¶ä»–å‚æ•°}\label{ux5176ux4ed6ux53c2ux6570}

è¿™é‡Œè¿˜æœ‰ä¸€äº›å…¶ä»–é‡è¦çš„å‚æ•°æˆ‘ä»¬éœ€è¦æåŠã€‚å¦‚
æœå…ˆå‘ä½ ä»¬å±•ç¤ºä¸€ä¸ªæœ‰ç”¨çš„æŠ€å·§ï¼Œè¿™äº›å‚æ•°çš„æ¼”ç¤ºå°±ä¼šæ›´å®¹æ˜“ç†è§£ï¼š\texttt{read\_csv()}å¯ä»¥è¯»å–ä½ åˆ›å»ºå¹¶æ ¼å¼åŒ–ä¸º
CSV æ–‡ä»¶æ ¼å¼çš„æ–‡æœ¬å­—ç¬¦ä¸²ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{read\_csv}\NormalTok{(}
  \StringTok{"a,b,c}
\StringTok{  1,2,3}
\StringTok{  4,5,6"}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 3}
\CommentTok{\#\textgreater{}       a     b     c}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1     2     3}
\CommentTok{\#\textgreater{} 2     4     5     6}
\end{Highlighting}
\end{Shaded}

é€šå¸¸ï¼Œ\texttt{read\_csv()}ä½¿ç”¨æ•°æ®çš„ç¬¬ä¸€è¡Œä½œä¸ºåˆ—åï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„çº¦å®šã€‚ä½†
æ˜¯ï¼Œåœ¨æ–‡ä»¶çš„é¡¶éƒ¨åŒ…å«å‡ è¡Œå…ƒæ•°æ®çš„æƒ…å†µä¹Ÿä¸å°‘è§ã€‚ä½ 
å¯ä»¥ä½¿ç”¨\texttt{skip\ =\ n}æ¥è·³è¿‡å‰ n
è¡Œï¼Œæˆ–è€…ä½¿ç”¨\texttt{comment\ =\ "\#"}æ¥å¿½ç•¥æ‰€æœ‰ä»¥ï¼ˆä¾‹å¦‚ï¼‰\# å¼€å¤´çš„è¡Œï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{read\_csv}\NormalTok{(}
  \StringTok{"The first line of metadata}
\StringTok{  The second line of metadata}
\StringTok{  x,y,z}
\StringTok{  1,2,3"}\NormalTok{,}
  \AttributeTok{skip =} \DecValTok{2}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 3}
\CommentTok{\#\textgreater{}       x     y     z}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1     2     3}

\FunctionTok{read\_csv}\NormalTok{(}
  \StringTok{"\# A comment I want to skip}
\StringTok{  x,y,z}
\StringTok{  1,2,3"}\NormalTok{,}
  \AttributeTok{comment =} \StringTok{"\#"}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 3}
\CommentTok{\#\textgreater{}       x     y     z}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1     2     3}
\end{Highlighting}
\end{Shaded}

åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œæ•°æ®å¯èƒ½æ²¡æœ‰åˆ—åã€‚ä½ 
å¯ä»¥ä½¿ç”¨\texttt{col\_names\ =\ FALSE}æ¥å‘Šè¯‰~\texttt{read\_csv()}ä¸è¦å°†ç¬¬ä¸€è¡Œä½œä¸ºæ ‡é¢˜ï¼Œè€Œæ˜¯ä»\texttt{X1}åˆ°\texttt{Xn}é¡ºåºåœ°ç»™å®ƒä»¬æ ‡è®°åˆ—åï¼š

In other cases, the data might not have column names. You can use
\texttt{col\_names\ =\ FALSE} to tell \texttt{read\_csv()} not to treat
the first row as headings and instead label them sequentially from
\texttt{X1} to \texttt{Xn}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{read\_csv}\NormalTok{(}
  \StringTok{"1,2,3}
\StringTok{  4,5,6"}\NormalTok{,}
  \AttributeTok{col\_names =} \ConstantTok{FALSE}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 3}
\CommentTok{\#\textgreater{}      X1    X2    X3}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1     2     3}
\CommentTok{\#\textgreater{} 2     4     5     6}
\end{Highlighting}
\end{Shaded}

å¦å¤–ï¼Œä½ å¯ä»¥å‘\texttt{col\_names}ä¼ é€’ä¸€ä¸ªå­—ç¬¦å‘é‡ï¼Œè¿™ä¸ªå­—ç¬¦å‘é‡å°†è¢«ç”¨ä½œåˆ—åï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{read\_csv}\NormalTok{(}
  \StringTok{"1,2,3}
\StringTok{  4,5,6"}\NormalTok{,}
  \AttributeTok{col\_names =} \FunctionTok{c}\NormalTok{(}\StringTok{"x"}\NormalTok{, }\StringTok{"y"}\NormalTok{, }\StringTok{"z"}\NormalTok{)}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 3}
\CommentTok{\#\textgreater{}       x     y     z}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1     2     3}
\CommentTok{\#\textgreater{} 2     4     5     6}
\end{Highlighting}
\end{Shaded}

è¿™äº›å‚æ•°æ˜¯ä½ éœ€è¦çŸ¥é“çš„ï¼Œä»¥ä¾¿è¯»å–ä½ åœ¨å®è·µä¸­é‡åˆ°çš„å¤§å¤šæ•° CSV æ–‡ä»¶ã€‚ï¼ˆ
å¯¹äºå…¶ä»–æƒ…å†µï¼Œä½ éœ€è¦ä»”ç»†æ£€æŸ¥ä½ çš„ \texttt{.csv}
æ–‡ä»¶ï¼Œå¹¶é˜…è¯»\texttt{read\_csv()}çš„è®¸å¤šå…¶ä»–å‚æ•°çš„æ–‡æ¡£ã€‚ï¼‰

\subsection{å…¶ä»–æ–‡ä»¶ç±»å‹}\label{ux5176ux4ed6ux6587ux4ef6ux7c7bux578b}

ä¸€æ—¦ä½ æŒæ¡äº†\texttt{read\_csv()}ï¼Œä½¿ç”¨\texttt{readr}çš„å…¶ä»–å‡½æ•°å°±å¾ˆç®€å•äº†ï¼›ä½ åªéœ€è¦çŸ¥é“åº”è¯¥ä½¿ç”¨å“ªä¸ªå‡½æ•°ï¼š

\begin{itemize}
\item
  \texttt{read\_csv2()} ç”¨äºè¯»å–åˆ†å·åˆ†éš”çš„æ–‡ä»¶ã€‚è¿™
  äº›æ–‡ä»¶ä½¿ç”¨\texttt{;}è€Œä¸æ˜¯\texttt{,}æ¥åˆ†éš”å­—æ®µï¼Œè¿™åœ¨ä½¿ç”¨\texttt{,}ä½œä¸ºå°æ•°ç‚¹æ ‡è®°ç¬¦çš„å›½å®¶ä¸­å¾ˆå¸¸è§ï¼›
\item
  \texttt{read\_tsv()} ç”¨äºè¯»å–åˆ¶è¡¨ç¬¦åˆ†éš”ï¼ˆtab-delimitedï¼‰çš„æ–‡ä»¶ï¼›
\item
  \texttt{read\_delim()}
  ç”¨äºè¯»å–å…·æœ‰ä»»ä½•åˆ†éš”ç¬¦çš„æ–‡ä»¶ï¼Œå¦‚æœä½ æ²¡æœ‰æŒ‡å®šåˆ†éš”ç¬¦ï¼Œå®ƒä¼šå°è¯•è‡ªåŠ¨çŒœæµ‹åˆ†éš”ç¬¦ï¼›
\item
  \texttt{read\_fwf()} ç”¨äºè¯»å–å›ºå®šå®½åº¦çš„æ–‡ä»¶ã€‚ä½ 
  å¯ä»¥ä½¿ç”¨\texttt{fwf\_widths()}é€šè¿‡å®½åº¦æŒ‡å®šå­—æ®µï¼Œæˆ–è€…ä½¿ç”¨\texttt{fwf\_positions()}é€šè¿‡ä½ç½®æŒ‡å®šå­—æ®µï¼›
\item
  \texttt{read\_table()}
  ç”¨äºè¯»å–å›ºå®šå®½åº¦æ–‡ä»¶çš„å¸¸è§å˜ä½“ï¼Œå…¶ä¸­åˆ—ç”±ç©ºç™½å­—ç¬¦åˆ†éš”ï¼›
\item
  \texttt{read\_log()} ç”¨äºè¯»å– Apache é£æ ¼çš„æ—¥å¿—æ–‡ä»¶ã€‚
\end{itemize}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-11}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  å¦‚æœä½ æƒ³è¦è¯»å–ä¸€ä¸ªå­—æ®µä¹‹é—´ä½¿ç”¨ ``\textbar{}''
  åˆ†éš”çš„æ–‡ä»¶ï¼Œä½ ä¼šä½¿ç”¨ä»€ä¹ˆå‡½æ•°ï¼Ÿ
\item
  é™¤äº†\texttt{file}ã€\texttt{skip}å’Œ\texttt{comment}ä¹‹å¤–ï¼Œ\texttt{read\_csv()}å’Œ\texttt{read\_tsv()}è¿˜æœ‰å“ªäº›å…±åŒçš„å‚æ•°ï¼Ÿ
\item
  \texttt{read\_fwf()}çš„æœ€é‡è¦å‚æ•°æ˜¯ä»€ä¹ˆï¼Ÿ
\item
  æœ‰æ—¶ CSV æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²åŒ…å«é€—å·ã€‚ä¸º
  äº†é˜²æ­¢å®ƒä»¬å¼•èµ·é—®é¢˜ï¼Œè¿™äº›å­—ç¬¦ä¸²éœ€è¦ç”¨å¼•å·å­—ç¬¦ï¼ˆå¦‚ \texttt{"} æˆ–
  \texttt{\textquotesingle{}}ï¼‰æ‹¬èµ·æ¥ã€‚é»˜
  è®¤æƒ…å†µä¸‹ï¼Œ\texttt{read\_csv()}å‡è®¾å¼•å·å­—ç¬¦ä¸º
  \texttt{"}ã€‚ä¸ºäº†å°†ä»¥ä¸‹æ–‡æœ¬è¯»å–åˆ°æ•°æ®æ¡†ä¸­ï¼Œä½ éœ€è¦ä¸º\texttt{read\_csv()}æŒ‡å®šå“ªä¸ªå‚æ•°ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\StringTok{"x,y}\SpecialCharTok{\textbackslash{}n}\StringTok{1,\textquotesingle{}a,b\textquotesingle{}"}
\end{Highlighting}
\end{Shaded}
\item
  è¯†åˆ«ä»¥ä¸‹å†…è”CSVæ–‡ä»¶ä¸­çš„æ¯ä¸ªé”™è¯¯æ˜¯ä»€ä¹ˆã€‚å½“ ä½ è¿è¡Œä»£ç æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{read\_csv}\NormalTok{(}\StringTok{"a,b}\SpecialCharTok{\textbackslash{}n}\StringTok{1,2,3}\SpecialCharTok{\textbackslash{}n}\StringTok{4,5,6"}\NormalTok{)}
\FunctionTok{read\_csv}\NormalTok{(}\StringTok{"a,b,c}\SpecialCharTok{\textbackslash{}n}\StringTok{1,2}\SpecialCharTok{\textbackslash{}n}\StringTok{1,2,3,4"}\NormalTok{)}
\FunctionTok{read\_csv}\NormalTok{(}\StringTok{"a,b}\SpecialCharTok{\textbackslash{}n\textbackslash{}"}\StringTok{1"}\NormalTok{)}
\FunctionTok{read\_csv}\NormalTok{(}\StringTok{"a,b}\SpecialCharTok{\textbackslash{}n}\StringTok{1,2}\SpecialCharTok{\textbackslash{}n}\StringTok{a,b"}\NormalTok{)}
\FunctionTok{read\_csv}\NormalTok{(}\StringTok{"a;b}\SpecialCharTok{\textbackslash{}n}\StringTok{1;3"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  é€šè¿‡ä»¥ä¸‹æ–¹å¼ç»ƒä¹ åœ¨æ•°æ®æ¡†ä¸­å¼•ç”¨éè¯­æ³•åç§°ï¼š

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \tightlist
  \item
    æå–åä¸º\texttt{1}çš„å˜é‡ï¼›
  \item
    ç»˜åˆ¶ \texttt{1} ä¸ \texttt{2}çš„æ•£ç‚¹å›¾ï¼›
  \item
    åˆ›å»ºä¸€ä¸ªåä¸º\texttt{3}çš„æ–°åˆ—ï¼Œè¯¥åˆ—æ˜¯\texttt{2}é™¤ä»¥\texttt{1}çš„ç»“æœï¼›
  \item
    å°†åˆ—åé‡å‘½åä¸º \texttt{one}, \texttt{two}å’Œ \texttt{three}.
  \end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{annoying }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \StringTok{\textasciigrave{}}\AttributeTok{1}\StringTok{\textasciigrave{}} \OtherTok{=} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{,}
  \StringTok{\textasciigrave{}}\AttributeTok{2}\StringTok{\textasciigrave{}} \OtherTok{=} \StringTok{\textasciigrave{}}\AttributeTok{1}\StringTok{\textasciigrave{}} \SpecialCharTok{*} \DecValTok{2} \SpecialCharTok{+} \FunctionTok{rnorm}\NormalTok{(}\FunctionTok{length}\NormalTok{(}\StringTok{\textasciigrave{}}\AttributeTok{1}\StringTok{\textasciigrave{}}\NormalTok{))}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{æ§åˆ¶åˆ—ç±»å‹}\label{sec-col-types}

CSV
æ–‡ä»¶ä¸åŒ…å«å…³äºæ¯ä¸ªå˜é‡ç±»å‹ï¼ˆå³å®ƒæ˜¯å¦æ˜¯é€»è¾‘å‹ã€æ•°å­—å‹ã€å­—ç¬¦ä¸²å‹ç­‰ï¼‰çš„ä»»ä½•ä¿¡æ¯ï¼Œå› æ­¤readr
ä¼šå°è¯•çŒœæµ‹ç±»å‹ã€‚æœ¬
èŠ‚å°†æè¿°çŒœæµ‹è¿‡ç¨‹çš„å·¥ä½œåŸç†ï¼Œå¦‚ä½•è§£å†³ä¸€äº›å¸¸è§çš„å¯¼è‡´çŒœæµ‹å¤±è´¥çš„é—®é¢˜ï¼Œä»¥åŠï¼ˆå¦‚æœéœ€è¦çš„è¯ï¼‰å¦‚ä½•è‡ªå·±æä¾›åˆ—ç±»å‹ã€‚æœ€
åï¼Œæˆ‘ä»¬å°†æåŠä¸€äº›åœ¨readr
é­é‡ä¸¥é‡å¤±è´¥ä¸”ä½ éœ€è¦æ›´æ·±å…¥åœ°äº†è§£æ–‡ä»¶ç»“æ„æ—¶éå¸¸æœ‰ç”¨çš„é€šç”¨ç­–ç•¥ã€‚

\subsection{çŒœæµ‹ç±»å‹}\label{ux731cux6d4bux7c7bux578b}

readr ä½¿ç”¨ä¸€ç§å¯å‘å¼æ–¹æ³•æ¥ç¡®å®šåˆ—çš„ç±»å‹ã€‚å¯¹
äºæ¯ä¸€åˆ—ï¼Œå®ƒä¼šä»ç¬¬ä¸€è¡Œåˆ°æœ€åä¸€è¡Œå‡åŒ€åœ°æŠ½å– 1,000\footnote{ä½ å¯ä»¥ä½¿ç”¨\texttt{guess\_max}å‚æ•°è¦†ç›–1000çš„é»˜è®¤å€¼ã€‚}
è¡Œçš„å€¼ï¼Œå¹¶å¿½ç•¥ç¼ºå¤±å€¼ã€‚ ç„¶åï¼Œå®ƒä¼šé€šè¿‡ä»¥ä¸‹é—®é¢˜è¿›è¡Œåˆ¤æ–­ï¼š

\begin{itemize}
\tightlist
\item
  å®ƒæ˜¯å¦åªåŒ…å« \texttt{F}ã€\texttt{T}ã€\texttt{FALSE} æˆ–
  \texttt{TRUE}ï¼ˆå¿½ç•¥å¤§å°å†™ï¼‰ï¼Ÿå¦‚æœæ˜¯ï¼Œåˆ™å®ƒæ˜¯é€»è¾‘å‹ï¼›
\item
  å®ƒæ˜¯å¦åªåŒ…å«æ•°å­—ï¼ˆå¦‚\texttt{1}ã€\texttt{-4.5}ã€\texttt{5e6}ã€\texttt{Inf}ï¼‰ï¼Ÿå¦‚æœæ˜¯ï¼Œåˆ™å®ƒæ˜¯æ•°å­—å‹ï¼›
\item
  å®ƒæ˜¯å¦ç¬¦åˆ ISO8601
  æ ‡å‡†ï¼Ÿå¦‚æœæ˜¯ï¼Œåˆ™å®ƒæ˜¯æ—¥æœŸæˆ–æ—¥æœŸ-æ—¶é—´å‹ã€‚ï¼ˆæˆ‘ä»¬å°†åœ¨@sec-creating-datetimes
  æ›´è¯¦ç»†åœ°è®¨è®ºæ—¥æœŸ-æ—¶é—´å‹ï¼‰ï¼›
\item
  å¦åˆ™ï¼Œå®ƒä¸€å®šæ˜¯å­—ç¬¦ä¸²å‹ã€‚
\end{itemize}

ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹ç®€å•ç¤ºä¾‹çœ‹åˆ°è¿™ä¸ªè¡Œä¸ºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{read\_csv}\NormalTok{(}\StringTok{"}
\StringTok{  logical,numeric,date,string}
\StringTok{  TRUE,1,2021{-}01{-}15,abc}
\StringTok{  false,4.5,2021{-}02{-}15,def}
\StringTok{  T,Inf,2021{-}02{-}16,ghi}
\StringTok{"}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 4}
\CommentTok{\#\textgreater{}   logical numeric date       string}
\CommentTok{\#\textgreater{}   \textless{}lgl\textgreater{}     \textless{}dbl\textgreater{} \textless{}date\textgreater{}     \textless{}chr\textgreater{} }
\CommentTok{\#\textgreater{} 1 TRUE        1   2021{-}01{-}15 abc   }
\CommentTok{\#\textgreater{} 2 FALSE       4.5 2021{-}02{-}15 def   }
\CommentTok{\#\textgreater{} 3 TRUE      Inf   2021{-}02{-}16 ghi}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ æœ‰ä¸€ä¸ªå¹²å‡€çš„æ•°æ®é›†ï¼Œè¿™ç§å¯å‘å¼æ–¹æ³•å¾ˆæœ‰æ•ˆï¼Œä½†åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œä½ ä¼šé‡åˆ°å„ç§å¥‡æ€ªè€Œç¾ä¸½çš„å¤±è´¥ã€‚

\subsection{ç¼ºå¤±å€¼ã€åˆ—ç±»å‹å’Œé—®é¢˜}\label{ux7f3aux5931ux503cux5217ux7c7bux578bux548cux95eeux9898}

åˆ—æ£€æµ‹å¤±è´¥æœ€å¸¸è§çš„æ–¹å¼æ˜¯æŸåˆ—åŒ…å«äº†æ„å¤–å€¼ï¼Œç»“æœä½ å¾—åˆ°äº†ä¸€ä¸ªå­—ç¬¦å‹åˆ—è€Œä¸æ˜¯æ›´å…·ä½“çš„ç±»å‹ã€‚è¿™
ç§æƒ…å†µæœ€å¸¸è§çš„åŸå› ä¹‹ä¸€æ˜¯ç¼ºå¤±å€¼ï¼Œè¿™äº›ç¼ºå¤±å€¼ä¸æ˜¯ä½¿ç”¨readr
æ‰€æœŸæœ›çš„\texttt{NA}æ¥è®°å½•çš„ã€‚

ä»¥ä¸‹é¢è¿™ä¸ªç®€å•çš„åªæœ‰ä¸€åˆ—çš„ CSV æ–‡ä»¶ä¸ºä¾‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{simple\_csv }\OtherTok{\textless{}{-}} \StringTok{"}
\StringTok{  x}
\StringTok{  10}
\StringTok{  .}
\StringTok{  20}
\StringTok{  30"}
\end{Highlighting}
\end{Shaded}

å¦‚æœæˆ‘ä»¬åœ¨æ²¡æœ‰ä»»ä½•é™„åŠ å‚æ•°çš„æƒ…å†µä¸‹è¯»å–å®ƒï¼Œ\texttt{x}å°†å˜æˆä¸€ä¸ªå­—ç¬¦åˆ—ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{read\_csv}\NormalTok{(simple\_csv)}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 1}
\CommentTok{\#\textgreater{}   x    }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 10   }
\CommentTok{\#\textgreater{} 2 .    }
\CommentTok{\#\textgreater{} 3 20   }
\CommentTok{\#\textgreater{} 4 30}
\end{Highlighting}
\end{Shaded}

åœ¨è¿™ä¸ªå¾ˆå°çš„ä¾‹å­ä¸­ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°çœ‹åˆ°ç¼ºå¤±å€¼\texttt{.}ã€‚ä½†
æ˜¯ï¼Œå¦‚æœä½ çš„æ–‡ä»¶ä¸­æœ‰æ•°åƒè¡Œï¼Œå¹¶ä¸”åªæœ‰å°‘æ•°å‡ ä¸ªç¼ºå¤±å€¼ï¼Œå¹¶ä¸”è¿™äº›ç¼ºå¤±å€¼åˆ†æ•£åœ¨æ–‡ä»¶ä¸­ï¼Œé‚£ä¹ˆä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿä¸€
ç§æ–¹æ³•æ˜¯å‘Šè¯‰readr \texttt{x} æ˜¯ä¸€åˆ—æ•°å­—å‹æ•°æ®ï¼Œç„¶åæŸ¥çœ‹å®ƒåœ¨å“ªé‡Œå¤±è´¥ã€‚ä½ 
å¯ä»¥ä½¿ç”¨\texttt{col\_types}å‚æ•°æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œè¯¥å‚æ•°æ¥å—ä¸€ä¸ªå‘½ååˆ—è¡¨ï¼Œå…¶ä¸­åˆ—è¡¨çš„åç§°ä¸
CSV æ–‡ä»¶ä¸­çš„åˆ—åç›¸åŒ¹é…ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}
\NormalTok{  simple\_csv, }
  \AttributeTok{col\_types =} \FunctionTok{list}\NormalTok{(}\AttributeTok{x =} \FunctionTok{col\_double}\NormalTok{())}
\NormalTok{)}
\CommentTok{\#\textgreater{} Warning: One or more parsing issues, call \textasciigrave{}problems()\textasciigrave{} on your data frame for}
\CommentTok{\#\textgreater{} details, e.g.:}
\CommentTok{\#\textgreater{}   dat \textless{}{-} vroom(...)}
\CommentTok{\#\textgreater{}   problems(dat)}
\end{Highlighting}
\end{Shaded}

ç°åœ¨\texttt{read\_csv()}æŠ¥å‘Šå­˜åœ¨é—®é¢˜ï¼Œå¹¶å‘Šè¯‰æˆ‘ä»¬å¯ä»¥é€šè¿‡\texttt{problems()}æ‰¾åˆ°æ›´å¤šä¿¡æ¯:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{problems}\NormalTok{(df)}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 5}
\CommentTok{\#\textgreater{}     row   col expected actual file                                           }
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}chr\textgreater{}    \textless{}chr\textgreater{}  \textless{}chr\textgreater{}                                          }
\CommentTok{\#\textgreater{} 1     3     1 a double .      /private/var/folders/2m/th7w53zx2fx6gl3g1jcj4l\textasciitilde{}}
\end{Highlighting}
\end{Shaded}

è¿™å‘Šè¯‰æˆ‘ä»¬ï¼Œåœ¨ç¬¬ 3 è¡Œã€ç¬¬ 1 åˆ—å‡ºç°äº†é—®é¢˜ï¼Œ readr
æœŸå¾…ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°ï¼Œä½†æ˜¯å¾—åˆ°äº†ä¸€ä¸ª\texttt{.}ã€‚è¿™
è¡¨æ˜è¿™ä¸ªæ•°æ®é›†ä½¿ç”¨\texttt{.}æ¥è¡¨ç¤ºç¼ºå¤±å€¼ã€‚å› 
æ­¤ï¼Œæˆ‘ä»¬è®¾ç½®\texttt{na\ =\ "."}ï¼Œè‡ªåŠ¨çŒœæµ‹æˆåŠŸï¼Œå¾—åˆ°äº†æˆ‘ä»¬æƒ³è¦çš„æ•°å­—åˆ—ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{read\_csv}\NormalTok{(simple\_csv, }\AttributeTok{na =} \StringTok{"."}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 1}
\CommentTok{\#\textgreater{}       x}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1    10}
\CommentTok{\#\textgreater{} 2    NA}
\CommentTok{\#\textgreater{} 3    20}
\CommentTok{\#\textgreater{} 4    30}
\end{Highlighting}
\end{Shaded}

\subsection{åˆ—ç±»å‹}\label{ux5217ux7c7bux578b}

readræ€»å…±æä¾›äº†ä¹ç§åˆ—ç±»å‹ä¾›æ‚¨ä½¿ç”¨:

\begin{itemize}
\tightlist
\item
  \texttt{col\_logical()}å’Œ\texttt{col\_double()}åˆ†åˆ«ç”¨äºè¯»å–é€»è¾‘å€¼å’Œå®æ•°ã€‚ç”±äºreadr
  é€šå¸¸ä¼šè‡ªåŠ¨ä¸ºä½ çŒœæµ‹è¿™äº›ç±»å‹ï¼Œå› æ­¤å®ƒä»¬ç›¸å¯¹ä¸å¸¸ç”¨ï¼ˆé™¤äº†ä¸Šè¿°æƒ…å†µï¼‰ï¼›
\item
  \texttt{col\_integer()}
  ç”¨äºè¯»å–æ•´æ•°ã€‚åœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬å¾ˆå°‘åŒºåˆ†æ•´æ•°å’ŒåŒç²¾åº¦æµ®ç‚¹æ•°ï¼Œå› ä¸ºå®ƒä»¬åœ¨åŠŸèƒ½ä¸Šæ˜¯ç­‰ä»·çš„ï¼Œä½†æ˜ç¡®è¯»å–æ•´æ•°æœ‰æ—¶æ˜¯æœ‰ç”¨çš„ï¼Œå› ä¸ºå®ƒä»¬å ç”¨çš„å†…å­˜åªæœ‰åŒç²¾åº¦æµ®ç‚¹æ•°çš„ä¸€åŠï¼›
\item
  \texttt{col\_character()}
  ç”¨äºè¯»å–å­—ç¬¦ä¸²ã€‚å½“æŸåˆ—æ˜¯æ•°å­—æ ‡è¯†ç¬¦æ—¶ï¼Œæ˜ç¡®æŒ‡å®šå®ƒå¯ä»¥å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚ï¼Œç”¨äºæ ‡è¯†å¯¹è±¡çš„é•¿æ•°å­—åºåˆ—ï¼Œä½†å¯¹è¿™äº›æ•°å­—åº”ç”¨æ•°å­¦è¿ç®—æ²¡æœ‰æ„ä¹‰ã€‚ç¤ºä¾‹åŒ…æ‹¬ç”µè¯å·ç ã€ç¤¾ä¼šä¿éšœå·ç ã€ä¿¡ç”¨å¡å·ç ç­‰ï¼›
\item
  \texttt{col\_factor()}, \texttt{col\_date()}å’Œ\texttt{col\_datetime()}
  åˆ†åˆ«ç”¨äºåˆ›å»ºå› å­ã€æ—¥æœŸå’Œæ—¥æœŸ-æ—¶é—´ï¼›å½“æˆ‘ä»¬åœ¨@sec-factors å’Œ
  ç« èŠ‚~\ref{sec-dates-and-times}
  å­¦ä¹ è¿™äº›æ•°æ®ç±»å‹æ—¶ï¼Œä½ ä¼šäº†è§£æ›´å¤šç›¸å…³ä¿¡æ¯ï¼›
\item
  \texttt{col\_number()}
  æ˜¯ä¸€ä¸ªå®½å®¹çš„æ•°å­—è§£æå™¨ï¼Œå®ƒå°†å¿½ç•¥éæ•°å­—éƒ¨åˆ†ï¼Œç‰¹åˆ«é€‚ç”¨äºè´§å¸ã€‚åœ¨@sec-numbers
  ä½ å°†äº†è§£æ›´å¤šç›¸å…³ä¿¡æ¯ï¼›
\item
  \texttt{col\_skip()} ç”¨äºè·³è¿‡æŸåˆ—ï¼Œä½¿å…¶ä¸åŒ…å«åœ¨ç»“æœä¸­ï¼›è¿™åœ¨å¤„ç†å¤§å‹
  CSV æ–‡ä»¶ä¸”åªæƒ³ä½¿ç”¨å…¶ä¸­çš„æŸäº›åˆ—æ—¶æœ‰ç”¨ï¼Œå¯ä»¥åŠ å¿«æ•°æ®è¯»å–é€Ÿåº¦ã€‚
\end{itemize}

æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å°†\texttt{list()}åˆ‡æ¢åˆ°\texttt{cols()}å¹¶æŒ‡å®š\texttt{.default}æ¥è¦†ç›–é»˜è®¤åˆ—ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{another\_csv }\OtherTok{\textless{}{-}} \StringTok{"}
\StringTok{x,y,z}
\StringTok{1,2,3"}

\FunctionTok{read\_csv}\NormalTok{(}
\NormalTok{  another\_csv, }
  \AttributeTok{col\_types =} \FunctionTok{cols}\NormalTok{(}\AttributeTok{.default =} \FunctionTok{col\_character}\NormalTok{())}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 3}
\CommentTok{\#\textgreater{}   x     y     z    }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}chr\textgreater{} \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 1     2     3}
\end{Highlighting}
\end{Shaded}

Another useful helper is \texttt{cols\_only()} which will read in only
the columns you specify:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{read\_csv}\NormalTok{(}
\NormalTok{  another\_csv,}
  \AttributeTok{col\_types =} \FunctionTok{cols\_only}\NormalTok{(}\AttributeTok{x =} \FunctionTok{col\_character}\NormalTok{())}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 1}
\CommentTok{\#\textgreater{}   x    }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 1}
\end{Highlighting}
\end{Shaded}

\section{ä»å¤šä¸ªæ–‡ä»¶è¯»å–æ•°æ®}\label{sec-readr-directory}

æœ‰æ—¶ï¼Œä½ çš„æ•°æ®åˆ†æ•£åœ¨å¤šä¸ªæ–‡ä»¶ä¸­ï¼Œè€Œä¸æ˜¯åªåŒ…å«åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚ä¾‹
å¦‚ï¼Œä½ å¯èƒ½æœ‰å¤šä¸ªæœˆä»½çš„é”€å”®æ•°æ®ï¼Œæ¯ä¸ªæœˆçš„æ•°æ®éƒ½ä¿å­˜åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­ï¼š1æœˆçš„é”€å”®æ•°æ®åœ¨\texttt{01-sales.csv}ä¸­ï¼Œ2æœˆçš„åœ¨\texttt{02-sales.csv}ä¸­ï¼Œ3æœˆçš„åœ¨\texttt{03-sales.csv}ä¸­ã€‚ä½¿
ç”¨\texttt{read\_csv()}å‡½æ•°å¯ä»¥ä¸€æ¬¡æ€§è¯»å–è¿™äº›æ•°æ®ï¼Œå¹¶å°†å®ƒä»¬å †å åœ¨ä¸€ä¸ªæ•°æ®æ¡†ä¸­ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sales\_files }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"data/01{-}sales.csv"}\NormalTok{, }\StringTok{"data/02{-}sales.csv"}\NormalTok{, }\StringTok{"data/03{-}sales.csv"}\NormalTok{)}
\FunctionTok{read\_csv}\NormalTok{(sales\_files, }\AttributeTok{id =} \StringTok{"file"}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 19 x 6}
\CommentTok{\#\textgreater{}   file              month    year brand  item     n}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}             \textless{}chr\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 data/01{-}sales.csv January  2019     1  1234     3}
\CommentTok{\#\textgreater{} 2 data/01{-}sales.csv January  2019     1  8721     9}
\CommentTok{\#\textgreater{} 3 data/01{-}sales.csv January  2019     1  1822     2}
\CommentTok{\#\textgreater{} 4 data/01{-}sales.csv January  2019     2  3333     1}
\CommentTok{\#\textgreater{} 5 data/01{-}sales.csv January  2019     2  2156     9}
\CommentTok{\#\textgreater{} 6 data/01{-}sales.csv January  2019     2  3987     6}
\CommentTok{\#\textgreater{} \# i 13 more rows}
\end{Highlighting}
\end{Shaded}

åŒæ ·ï¼Œå¦‚æœåœ¨é¡¹ç›®çš„\texttt{data}æ–‡ä»¶å¤¹ä¸­æœ‰CSVæ–‡ä»¶ï¼Œä¸Šè¿°ä»£ç å°±å¯ä»¥å·¥ä½œã€‚ä½ 
å¯ä»¥ä»\url{https://pos.it/r4ds-01-sales},
\url{https://pos.it/r4ds-02-sales}å’Œ\url{https://pos.it/r4ds-03-sales}ä¸‹è½½è¿™äº›æ–‡ä»¶ï¼Œæˆ–è€…ä½ å¯ä»¥ç›´æ¥è¯»å–å®ƒä»¬:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sales\_files }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
  \StringTok{"https://pos.it/r4ds{-}01{-}sales"}\NormalTok{,}
  \StringTok{"https://pos.it/r4ds{-}02{-}sales"}\NormalTok{,}
  \StringTok{"https://pos.it/r4ds{-}03{-}sales"}
\NormalTok{)}
\FunctionTok{read\_csv}\NormalTok{(sales\_files, }\AttributeTok{id =} \StringTok{"file"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\texttt{id}å‚æ•°ä¼šåœ¨ç»“æœæ•°æ®æ¡†ä¸­æ·»åŠ ä¸€ä¸ªåä¸º\texttt{file}çš„æ–°åˆ—ï¼Œç”¨äºæ ‡è¯†æ•°æ®æ¥è‡ªå“ªä¸ªæ–‡ä»¶ã€‚è¿™
åœ¨è¯»å–çš„æ–‡ä»¶æ²¡æœ‰åŒ…å«å¯ä»¥å¸®åŠ©ä½ è¿½è¸ªè§‚æµ‹å›åˆ°å…¶åŸå§‹æ¥æºçš„æ ‡è¯†åˆ—æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚

å¦‚æœä½ æœ‰å¾ˆå¤šæ–‡ä»¶æƒ³è¦è¯»å–ï¼Œä¸€ä¸ªä¸ªå†™å‡ºå®ƒä»¬çš„åç§°å¯èƒ½ä¼šå¾ˆéº»çƒ¦ã€‚ç›¸
åï¼Œä½ å¯ä»¥ä½¿ç”¨åŸºç¡€å‡½æ•°\texttt{list.files()}æ¥é€šè¿‡åŒ¹é…æ–‡ä»¶åä¸­çš„æ¨¡å¼æ‰¾åˆ°è¿™äº›æ–‡ä»¶ã€‚ä½ 
å°†åœ¨@sec-regular-expressions éƒ¨åˆ†å­¦ä¹ æ›´å¤šå…³äºè¿™äº›æ¨¡å¼çš„çŸ¥è¯†ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sales\_files }\OtherTok{\textless{}{-}} \FunctionTok{list.files}\NormalTok{(}\StringTok{"data"}\NormalTok{, }\AttributeTok{pattern =} \StringTok{"sales}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{.csv$"}\NormalTok{, }\AttributeTok{full.names =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{sales\_files}
\CommentTok{\#\textgreater{} [1] "data/01{-}sales.csv" "data/02{-}sales.csv" "data/03{-}sales.csv"}
\end{Highlighting}
\end{Shaded}

\section{å†™å…¥æ–‡ä»¶}\label{sec-writing-to-a-file}

readr
è¿˜æä¾›äº†ä¸¤ä¸ªæœ‰ç”¨çš„å‡½æ•°ï¼Œç”¨äºå°†æ•°æ®å†™å›ç£ç›˜ï¼š\texttt{write\_csv()}å’Œ\texttt{write\_tsv()}ã€‚è¿™
äº›å‡½æ•°æœ€é‡è¦çš„å‚æ•°æ˜¯\texttt{x}(è¦ä¿å­˜çš„æ•°æ®æ¡†)å’Œ\texttt{file}(è¦ä¿å­˜çš„ä½ç½®)ã€‚ä½ 
è¿˜å¯ä»¥æŒ‡å®šå¦‚ä½•ä½¿ç”¨\texttt{na}æ¥å†™å…¥ç¼ºå¤±å€¼ä»¥åŠæ˜¯å¦å¸Œæœ›å°†å…¶é™„åŠ åˆ°ç°æœ‰æ–‡ä»¶ä¸­ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{write\_csv}\NormalTok{(students, }\StringTok{"students.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

ç°åœ¨è®©æˆ‘ä»¬è¯»å…¥csvæ–‡ä»¶ã€‚è¯·
æ³¨æ„ï¼Œå½“ä½ ä¿å­˜åˆ°CSVæ—¶ï¼Œåˆšåˆšè®¾ç½®çš„å˜é‡ç±»å‹ä¿¡æ¯ä¼šä¸¢å¤±ï¼Œå› ä¸ºä½ é‡æ–°å¼€å§‹ä»çº¯æ–‡æœ¬æ–‡ä»¶è¯»å–:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{students}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 5}
\CommentTok{\#\textgreater{}   student\_id full\_name        favourite\_food     meal\_plan             age}
\CommentTok{\#\textgreater{}        \textless{}dbl\textgreater{} \textless{}chr\textgreater{}            \textless{}chr\textgreater{}              \textless{}fct\textgreater{}               \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1          1 Sunil Huffmann   Strawberry yoghurt Lunch only              4}
\CommentTok{\#\textgreater{} 2          2 Barclay Lynn     French fries       Lunch only              5}
\CommentTok{\#\textgreater{} 3          3 Jayendra Lyne    \textless{}NA\textgreater{}               Breakfast and lunch     7}
\CommentTok{\#\textgreater{} 4          4 Leon Rossini     Anchovies          Lunch only             NA}
\CommentTok{\#\textgreater{} 5          5 Chidiegwu Dunkel Pizza              Breakfast and lunch     5}
\CommentTok{\#\textgreater{} 6          6 GÃ¼venÃ§ Attila    Ice cream          Lunch only              6}
\FunctionTok{write\_csv}\NormalTok{(students, }\StringTok{"students{-}2.csv"}\NormalTok{)}
\FunctionTok{read\_csv}\NormalTok{(}\StringTok{"students{-}2.csv"}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 5}
\CommentTok{\#\textgreater{}   student\_id full\_name        favourite\_food     meal\_plan             age}
\CommentTok{\#\textgreater{}        \textless{}dbl\textgreater{} \textless{}chr\textgreater{}            \textless{}chr\textgreater{}              \textless{}chr\textgreater{}               \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1          1 Sunil Huffmann   Strawberry yoghurt Lunch only              4}
\CommentTok{\#\textgreater{} 2          2 Barclay Lynn     French fries       Lunch only              5}
\CommentTok{\#\textgreater{} 3          3 Jayendra Lyne    \textless{}NA\textgreater{}               Breakfast and lunch     7}
\CommentTok{\#\textgreater{} 4          4 Leon Rossini     Anchovies          Lunch only             NA}
\CommentTok{\#\textgreater{} 5          5 Chidiegwu Dunkel Pizza              Breakfast and lunch     5}
\CommentTok{\#\textgreater{} 6          6 GÃ¼venÃ§ Attila    Ice cream          Lunch only              6}
\end{Highlighting}
\end{Shaded}

è¿™ä½¿å¾—CSVåœ¨ç¼“å­˜ä¸­é—´ç»“æœæ—¶æœ‰äº›ä¸å¯é ï¼Œæ¯æ¬¡åŠ è½½æ—¶éƒ½éœ€è¦é‡æ–°åˆ›å»ºåˆ—è§„èŒƒã€‚ä¸»
è¦æœ‰ä¸¤ç§æ›¿ä»£æ–¹æ¡ˆï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \texttt{write\_rds()} å’Œ \texttt{read\_rds()}
  æ˜¯å›´ç»•åŸºç¡€å‡½æ•°\texttt{readRDS()}å’Œ\texttt{saveRDS()}çš„ç»Ÿä¸€åŒ…è£…å™¨ã€‚è¿™
  äº›å‡½æ•°å°†æ•°æ®å­˜å‚¨åœ¨Rçš„è‡ªå®šä¹‰äºŒè¿›åˆ¶æ ¼å¼RDSä¸­ã€‚è¿™
  æ„å‘³ç€å½“ä½ é‡æ–°åŠ è½½å¯¹è±¡æ—¶ï¼Œä½ åŠ è½½çš„æ˜¯ä¸å­˜å‚¨æ—¶å®Œå…¨ç›¸åŒçš„Rå¯¹è±¡ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{write\_rds}\NormalTok{(students, }\StringTok{"students.rds"}\NormalTok{)}
\FunctionTok{read\_rds}\NormalTok{(}\StringTok{"students.rds"}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 5}
\CommentTok{\#\textgreater{}   student\_id full\_name        favourite\_food     meal\_plan             age}
\CommentTok{\#\textgreater{}        \textless{}dbl\textgreater{} \textless{}chr\textgreater{}            \textless{}chr\textgreater{}              \textless{}fct\textgreater{}               \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1          1 Sunil Huffmann   Strawberry yoghurt Lunch only              4}
\CommentTok{\#\textgreater{} 2          2 Barclay Lynn     French fries       Lunch only              5}
\CommentTok{\#\textgreater{} 3          3 Jayendra Lyne    \textless{}NA\textgreater{}               Breakfast and lunch     7}
\CommentTok{\#\textgreater{} 4          4 Leon Rossini     Anchovies          Lunch only             NA}
\CommentTok{\#\textgreater{} 5          5 Chidiegwu Dunkel Pizza              Breakfast and lunch     5}
\CommentTok{\#\textgreater{} 6          6 GÃ¼venÃ§ Attila    Ice cream          Lunch only              6}
\end{Highlighting}
\end{Shaded}
\item
  \texttt{arrow}åŒ…å…è®¸ä½ è¯»å–å’Œå†™å…¥ parquet
  æ–‡ä»¶ï¼Œè¿™æ˜¯ä¸€ç§å¯ä»¥å¿«é€Ÿè·¨ç¼–ç¨‹è¯­è¨€å…±äº«çš„äºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼ã€‚æˆ‘ ä»¬å°†åœ¨
  ç« èŠ‚~\ref{sec-arrow} ä¸­æ›´æ·±å…¥åœ°æ¢è®¨\texttt{arrow}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(arrow)}
\FunctionTok{write\_parquet}\NormalTok{(students, }\StringTok{"students.parquet"}\NormalTok{)}
\FunctionTok{read\_parquet}\NormalTok{(}\StringTok{"students.parquet"}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 6 Ã— 5}
\CommentTok{\#\textgreater{}   student\_id full\_name        favourite\_food     meal\_plan             age}
\CommentTok{\#\textgreater{}        \textless{}dbl\textgreater{} \textless{}chr\textgreater{}            \textless{}chr\textgreater{}              \textless{}fct\textgreater{}               \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1          1 Sunil Huffmann   Strawberry yoghurt Lunch only              4}
\CommentTok{\#\textgreater{} 2          2 Barclay Lynn     French fries       Lunch only              5}
\CommentTok{\#\textgreater{} 3          3 Jayendra Lyne    NA                 Breakfast and lunch     7}
\CommentTok{\#\textgreater{} 4          4 Leon Rossini     Anchovies          Lunch only             NA}
\CommentTok{\#\textgreater{} 5          5 Chidiegwu Dunkel Pizza              Breakfast and lunch     5}
\CommentTok{\#\textgreater{} 6          6 GÃ¼venÃ§ Attila    Ice cream          Lunch only              6}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

Parquetå¾€å¾€æ¯”RDSå¿«å¾—å¤šï¼Œå¹¶ä¸”å¯ä»¥åœ¨Rä¹‹å¤–ä½¿ç”¨ï¼Œä½†ç¡®å®éœ€è¦\texttt{arrow}åŒ…ã€‚

\section{æ•°æ®å½•å…¥}\label{ux6570ux636eux5f55ux5165}

æœ‰æ—¶ï¼Œä½ éœ€è¦åœ¨Rè„šæœ¬ä¸­æ‰‹åŠ¨ç»„è£…ä¸€ä¸ªtibbleï¼ˆæ•°æ®æ¡†ï¼‰ï¼Œè¿›è¡Œä¸€äº›æ•°æ®å½•å…¥ã€‚æœ‰
ä¸¤ä¸ªæœ‰ç”¨çš„å‡½æ•°å¯ä»¥å¸®åŠ©ä½ å®Œæˆè¿™é¡¹å·¥ä½œï¼Œè¿™ä¸¤ä¸ªå‡½æ•°çš„ä¸åŒä¹‹å¤„åœ¨äºå®ƒä»¬æ˜¯é€šè¿‡åˆ—è¿˜æ˜¯é€šè¿‡è¡Œæ¥å¸ƒå±€tibbleçš„ã€‚\texttt{t}
\texttt{ibble()}å‡½æ•°æ˜¯æŒ‰åˆ—å·¥ä½œçš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{5}\NormalTok{), }
  \AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\StringTok{"h"}\NormalTok{, }\StringTok{"m"}\NormalTok{, }\StringTok{"g"}\NormalTok{),}
  \AttributeTok{z =} \FunctionTok{c}\NormalTok{(}\FloatTok{0.08}\NormalTok{, }\FloatTok{0.83}\NormalTok{, }\FloatTok{0.60}\NormalTok{)}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 3}
\CommentTok{\#\textgreater{}       x y         z}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}chr\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1 h      0.08}
\CommentTok{\#\textgreater{} 2     2 m      0.83}
\CommentTok{\#\textgreater{} 3     5 g      0.6}
\end{Highlighting}
\end{Shaded}

æŒ‰åˆ—å¸ƒå±€æ•°æ®å¯èƒ½ä¼šéš¾ä»¥çœ‹åˆ°è¡Œä¹‹é—´çš„å…³ç³»ï¼Œå› æ­¤å¦ä¸€ç§æ–¹æ³•æ˜¯\texttt{tribble()}ï¼ˆ\textbf{tr}ansposed
t\textbf{ibble}çš„ç¼©å†™ï¼‰ï¼Œå®ƒå…è®¸ä½ é€è¡Œå¸ƒå±€æ•°æ®ã€‚\texttt{t}
\texttt{ribble()}æ˜¯ä¸ºä»£ç ä¸­çš„æ•°æ®è¾“å…¥å®šåˆ¶çš„ï¼šåˆ—æ ‡é¢˜ä»¥\texttt{\textasciitilde{}}å¼€å¤´ï¼Œæ¡ç›®ä¹‹é—´ç”¨é€—å·åˆ†éš”ã€‚è¿™
ä½¿å¾—ä»¥æ˜“äºé˜…è¯»çš„å½¢å¼å¸ƒå±€å°‘é‡æ•°æ®æˆä¸ºå¯èƒ½ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{x, }\SpecialCharTok{\textasciitilde{}}\NormalTok{y, }\SpecialCharTok{\textasciitilde{}}\NormalTok{z,}
  \DecValTok{1}\NormalTok{, }\StringTok{"h"}\NormalTok{, }\FloatTok{0.08}\NormalTok{,}
  \DecValTok{2}\NormalTok{, }\StringTok{"m"}\NormalTok{, }\FloatTok{0.83}\NormalTok{,}
  \DecValTok{5}\NormalTok{, }\StringTok{"g"}\NormalTok{, }\FloatTok{0.60}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 3}
\CommentTok{\#\textgreater{}       x y         z}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}chr\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1 h      0.08}
\CommentTok{\#\textgreater{} 2     2 m      0.83}
\CommentTok{\#\textgreater{} 3     5 g      0.6}
\end{Highlighting}
\end{Shaded}

\section{å°ç»“}\label{ux5c0fux7ed3-6}

åœ¨æœ¬ç« ä¸­ï¼Œä½ å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨\texttt{read\_csv()}åŠ è½½CSVæ–‡ä»¶ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨\texttt{tibble()}å’Œ\texttt{tribble()}è¿›è¡Œè‡ªå·±çš„æ•°æ®è¾“å…¥ã€‚ä½ 
äº†è§£äº†CSVæ–‡ä»¶çš„å·¥ä½œåŸç†ï¼Œå¯èƒ½ä¼šé‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼Œä»¥åŠå¦‚ä½•è§£å†³è¿™äº›é—®é¢˜ã€‚åœ¨
æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬å°†å¤šæ¬¡æ¶‰åŠæ•°æ®å¯¼å…¥ï¼šä»Excelå’ŒGoogleè¡¨æ ¼ä¸­å¯¼å…¥æ•°æ®çš„
ç« èŠ‚~\ref{sec-import-spreadsheets} ï¼Œç« èŠ‚~\ref{sec-import-databases}
å°†å‘ä½ å±•ç¤ºå¦‚ä½•ä»æ•°æ®åº“ä¸­åŠ è½½æ•°æ®ï¼Œç« èŠ‚~\ref{sec-arrow}
å°†ä»‹ç»å¦‚ä½•ä»Parquetæ–‡ä»¶ä¸­åŠ è½½æ•°æ®ï¼Œç« èŠ‚~\ref{sec-rectangling}
å°†æ¶‰åŠä»JSONä¸­å¯¼å…¥æ•°æ®ï¼Œä»¥åŠ@sec-scraping å°†ä»‹ç»å¦‚ä½•ä»ç½‘ç«™ä¸ŠæŠ“å–æ•°æ®ã€‚

æœ¬ä¹¦çš„è¿™ä¸ªéƒ¨åˆ†å³å°†ç»“æŸï¼Œä½†è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„ä¸»é¢˜éœ€è¦è®¨è®ºï¼šå¦‚ä½•è·å–å¸®åŠ©ã€‚å› 
æ­¤ï¼Œåœ¨ä¸‹ä¸€ç« ä¸­ï¼Œä½ å°†å­¦ä¹ ä¸€äº›å¯»æ±‚å¸®åŠ©çš„å¥½åœ°æ–¹ï¼Œå¦‚ä½•åˆ›å»ºä¸€ä¸ªå¯é‡ç°çš„ç¤ºä¾‹ï¼ˆreprexï¼‰ä»¥æœ€å¤§åŒ–è·å¾—è‰¯å¥½å¸®åŠ©çš„æœºä¼šï¼Œä»¥åŠä¸€äº›å…³äºè·Ÿä¸ŠRä¸–ç•Œæ­¥ä¼çš„ä¸€èˆ¬æ€§å»ºè®®ã€‚

\chapter{å·¥ä½œæµç¨‹ï¼šè·å–å¸®åŠ©}\label{sec-workflow-getting-help}

æœ¬ä¹¦å¹¶éå­¤å²›ï¼Œæ²¡æœ‰ä»»ä½•å•ä¸€èµ„æºèƒ½å¤Ÿè®©ä½ å®Œå…¨æŒæ¡Rè¯­è¨€ã€‚å½“
ä½ å¼€å§‹å°†æœ¬ä¹¦ä¸­æè¿°çš„æŠ€æœ¯åº”ç”¨äºè‡ªå·±çš„æ•°æ®æ—¶ï¼Œä½ å¾ˆå¿«å°±ä¼šé‡åˆ°æˆ‘ä»¬æ²¡æœ‰è§£ç­”çš„é—®é¢˜ã€‚æœ¬
èŠ‚å°†ä»‹ç»ä¸€äº›è·å–å¸®åŠ©å’ŒæŒç»­å­¦ä¹ çš„æŠ€å·§ã€‚

\section{å……åˆ†åˆ©ç”¨äº’è”ç½‘}\label{ux5145ux5206ux5229ux7528ux4e92ux8054ux7f51}

å¦‚æœä½ é‡åˆ°äº†å›°éš¾ï¼Œé¦–å…ˆå°è¯•ä½¿ç”¨Googleæœç´¢ã€‚é€š
å¸¸ï¼Œåœ¨æŸ¥è¯¢ä¸­åŠ ä¸Š``R''å°±èƒ½å°†ç»“æœé™åˆ¶åœ¨ç›¸å…³çš„èŒƒå›´å†…ï¼šå¦‚æœæœç´¢ç»“æœæ²¡æœ‰å¸®åŠ©ï¼Œé‚£é€šå¸¸æ„å‘³ç€æ²¡æœ‰ç‰¹å®šçš„Rè¯­è¨€ç›¸å…³ç»“æœã€‚æ­¤
å¤–ï¼Œæ·»åŠ åŒ…åå¦‚``tidyverse''æˆ–``ggplot2''å°†æœ‰åŠ©äºå°†ç»“æœç¼©å°åˆ°ä½ æ›´ç†Ÿæ‚‰çš„ä»£ç èŒƒå›´å†…ï¼Œä¾‹å¦‚ï¼Œ``å¦‚ä½•åœ¨Rä¸­åˆ¶ä½œç®±çº¿å›¾''ä¸``å¦‚ä½•åœ¨Rä¸­ä½¿ç”¨ggplot2åˆ¶ä½œç®±çº¿å›¾''ã€‚G
oogleå¯¹é”™è¯¯æ¶ˆæ¯ç‰¹åˆ«æœ‰ç”¨ï¼Œå¦‚æœä½ æ”¶åˆ°ä¸€ä¸ªé”™è¯¯æ¶ˆæ¯è€Œä¸çŸ¥é“å®ƒæ˜¯ä»€ä¹ˆæ„æ€ï¼Œè¯•ç€æœç´¢å®ƒï¼å¾ˆ
æœ‰å¯èƒ½å…¶ä»–äººä»¥å‰ä¹Ÿè¢«è¿™ä¸ªé”™è¯¯æ¶ˆæ¯æç³Šæ¶‚è¿‡ï¼Œç½‘ä¸ŠæŸä¸ªåœ°æ–¹ä¼šæœ‰å¸®åŠ©ã€‚ï¼ˆ
å¦‚æœé”™è¯¯æ¶ˆæ¯ä¸æ˜¯è‹±æ–‡çš„ï¼Œè¿è¡Œ\texttt{Sys.setenv(LANGUAGE\ =\ "en")}å¹¶é‡æ–°è¿è¡Œä»£ç ï¼›ä½ æ›´æœ‰å¯èƒ½æ‰¾åˆ°è‹±æ–‡é”™è¯¯æ¶ˆæ¯çš„å¸®åŠ©ã€‚ï¼‰

å¦‚æœGoogleæ²¡æœ‰å¸®åŠ©ï¼Œå°è¯•ä½¿ç”¨\href{https://stackoverflow.com}{Stack
Overflow}ã€‚é¦–
å…ˆèŠ±ä¸€äº›æ—¶é—´æœç´¢ç°æœ‰çš„ç­”æ¡ˆï¼ŒåŒ…æ‹¬\texttt{{[}R{]}}æ ‡ç­¾ï¼Œä»¥å°†æœç´¢é™åˆ¶åœ¨ä½¿ç”¨Rçš„é—®é¢˜å’Œç­”æ¡ˆä¸Šã€‚

\section{åˆ¶ä½œreprexx}\label{ux5236ux4f5creprexx}

å¦‚æœä½ çš„Googleæœç´¢æ²¡æœ‰æ‰¾åˆ°æœ‰ç”¨çš„ä¿¡æ¯ï¼Œåˆ¶ä½œä¸€ä¸ªæœ€å°åŒ–çš„reprexï¼ˆ\textbf{rep}roducible
\textbf{ex}ampleçš„ç¼©å†™ï¼‰æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¸»æ„ã€‚ä¸€
ä¸ªå¥½çš„reprexä¼šè®©å…¶ä»–äººæ›´å®¹æ˜“å¸®åŠ©ä½ ï¼Œè€Œä¸”é€šå¸¸åœ¨åˆ¶ä½œå®ƒçš„è¿‡ç¨‹ä¸­ï¼Œä½ è‡ªå·±å°±ä¼šå‘ç°é—®é¢˜æ‰€åœ¨ã€‚åˆ¶
ä½œreprexæœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼š

\begin{itemize}
\item
  é¦–å…ˆï¼Œä½ éœ€è¦è®©ä½ çš„ä»£ç å¯å¤ç°ã€‚è¿™
  æ„å‘³ç€ä½ éœ€è¦æ•è·æ‰€æœ‰å†…å®¹ï¼Œå³åŒ…æ‹¬ä»»ä½•\texttt{library()}è°ƒç”¨å¹¶åˆ›å»ºæ‰€æœ‰å¿…è¦çš„å¯¹è±¡ã€‚ç¡®
  ä¿ä½ å·²ç»åšåˆ°è¿™ä¸€ç‚¹çš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨\texttt{reprex}åŒ…ã€‚
\item
  å…¶æ¬¡ï¼Œä½ éœ€è¦å°†å…¶ç®€åŒ–åˆ°æœ€å°ã€‚å» æ‰æ‰€æœ‰ä¸é—®é¢˜ä¸ç›´æ¥ç›¸å…³çš„å†…å®¹ã€‚è¿™
  é€šå¸¸æ„å‘³ç€åˆ›å»ºä¸€ä¸ªæ¯”ä½ å®é™…é¢å¯¹çš„æ›´å°ã€æ›´ç®€å•çš„Rå¯¹è±¡ï¼Œæˆ–è€…ç”šè‡³ä½¿ç”¨å†…ç½®æ•°æ®ã€‚
\end{itemize}

è¿™å¬èµ·æ¥åƒæ˜¯ä¸€é¡¹ç¹é‡çš„å·¥ä½œï¼ç¡® å®å¯èƒ½å¦‚æ­¤ï¼Œä½†å®ƒçš„å›æŠ¥éå¸¸å¤§

\begin{itemize}
\item
  80\%çš„æƒ…å†µä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªå‡ºè‰²çš„reprexä¼šæ­ç¤ºé—®é¢˜çš„æ ¹æºã€‚ä»¤
  äººæƒŠè®¶çš„æ˜¯ï¼Œå¤šå°‘æ¬¡åœ¨ç¼–å†™ä¸€ä¸ªç‹¬ç«‹ä¸”ç®€åŒ–çš„ä¾‹å­çš„è¿‡ç¨‹ä¸­ï¼Œä½ å°±èƒ½å¤Ÿè‡ªå·±è§£ç­”é—®é¢˜äº†ï¼›
\item
  å¦å¤–20\%çš„æƒ…å†µä¸‹ï¼Œä½ å·²ç»ä»¥æ˜“äºä»–äººæ“ä½œçš„æ–¹å¼æ•æ‰åˆ°äº†é—®é¢˜çš„æœ¬è´¨ï¼Œè¿™æå¤§åœ°æé«˜äº†ä½ è·å¾—å¸®åŠ©çš„æœºä¼šï¼
\end{itemize}

åœ¨æ‰‹åŠ¨åˆ›å»ºreprexæ—¶ï¼Œå¾ˆå®¹æ˜“ä¸å°å¿ƒé—æ¼æŸäº›å†…å®¹ï¼Œå¯¼è‡´ä½ çš„ä»£ç æ— æ³•åœ¨åˆ«äººçš„è®¡ç®—æœºä¸Šè¿è¡Œã€‚é€š
è¿‡ä½¿ç”¨reprexåŒ…å¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜ï¼Œè¯¥åŒ…æ˜¯tidyverseçš„ä¸€éƒ¨åˆ†ã€‚å‡
è®¾ä½ å°†è¿™æ®µä»£ç å¤åˆ¶åˆ°äº†å‰ªè´´æ¿ï¼ˆæˆ–è€…ï¼Œåœ¨RStudio
Serveræˆ–Cloudä¸Šï¼Œé€‰æ‹©å®ƒï¼‰ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{4}
\FunctionTok{mean}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

ç„¶åè°ƒç”¨\texttt{reprex()}ï¼Œå…¶é»˜è®¤è¾“å‡ºæ ¼å¼ä¸ºGitHubæ‰€éœ€çš„æ ¼å¼:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{reprex}\SpecialCharTok{::}\FunctionTok{reprex}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ æ­£åœ¨ä½¿ç”¨RStudioï¼Œä¸€ä¸ªç²¾ç¾çš„HTMLé¢„è§ˆå°†ä¼šåœ¨RStudioçš„Viewerä¸­æ˜¾ç¤ºï¼›å¦åˆ™ï¼Œå®ƒä¼šåœ¨ä½ çš„é»˜è®¤æµè§ˆå™¨ä¸­æ˜¾ç¤ºã€‚r
eprexä¼šè¢«è‡ªåŠ¨å¤åˆ¶åˆ°ä½ çš„å‰ªè´´æ¿ï¼ˆåœ¨RStudio
Serveræˆ–Cloudä¸Šï¼Œä½ éœ€è¦æ‰‹åŠ¨å¤åˆ¶ï¼‰ï¼š

\begin{verbatim}
``` r
y <- 1:4
mean(y)
#> [1] 2.5
```
\end{verbatim}

è¿™æ®µæ–‡æœ¬ä»¥ä¸€ç§ç‰¹æ®Šçš„æ–¹å¼æ ¼å¼åŒ–ï¼Œç§°ä¸ºMarkdownï¼Œå®ƒå¯ä»¥ç²˜è´´åˆ°åƒStackOverflowæˆ–Githubè¿™æ ·çš„ç½‘ç«™ä¸Šï¼Œå¹¶ä¸”è¿™äº›ç½‘ç«™ä¼šè‡ªåŠ¨å°†å…¶æ¸²æŸ“æˆä»£ç çš„æ ·å­ã€‚ä»¥
ä¸‹æ˜¯è¿™æ®µMarkdownåœ¨Githubä¸Šçš„æ¸²æŸ“æ•ˆæœï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{4}
\FunctionTok{mean}\NormalTok{(y)}
\CommentTok{\#\textgreater{} [1] 2.5}
\end{Highlighting}
\end{Shaded}

ä»»ä½•äººéƒ½å¯ä»¥ç«‹å³å¤åˆ¶ã€ç²˜è´´å’Œè¿è¡Œè¿™ä¸ªä¾‹å­ã€‚

è¦ä½¿ä½ çš„ä¾‹å­å¯é‡å¤ï¼Œéœ€è¦åŒ…å«ä¸‰æ ·ä¸œè¥¿ï¼šå¿…è¦çš„åŒ…ã€æ•°æ®å’Œä»£ç ã€‚

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{åŒ…}åº”è¯¥åœ¨è„šæœ¬çš„é¡¶éƒ¨åŠ è½½ï¼Œè¿™æ ·å¾ˆå®¹æ˜“çœ‹å‡ºè¿™ä¸ªä¾‹å­éœ€è¦å“ªäº›åŒ…ã€‚ç°
  åœ¨æ˜¯æ£€æŸ¥ä½ æ˜¯å¦åœ¨ä½¿ç”¨æ¯ä¸ªåŒ…çš„æœ€æ–°ç‰ˆæœ¬çš„å¥½æ—¶æœºï¼›ä½ å¯èƒ½å‘ç°äº†ä¸€ä¸ªè‡ªä½ å®‰è£…æˆ–æœ€åä¸€æ¬¡æ›´æ–°åŒ…ä»¥æ¥å·²ç»è¢«ä¿®å¤çš„é”™è¯¯ã€‚å¯¹
  äºtidyverseä¸­çš„åŒ…ï¼Œæœ€ç®€å•çš„æ£€æŸ¥æ–¹æ³•æ˜¯è¿è¡Œ\texttt{tidyverse\_update()}ã€‚
\item
  åŒ…å«\textbf{æ•°æ®}çš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨\texttt{dput()}æ¥ç”Ÿæˆé‡æ–°åˆ›å»ºå®ƒæ‰€éœ€çš„Rä»£ç ã€‚ä¾‹
  å¦‚ï¼Œè¦åœ¨Rä¸­é‡æ–°åˆ›å»º\texttt{mtcars}æ•°æ®é›†ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \tightlist
  \item
    åœ¨Rä¸­è¿è¡Œ\texttt{dput(mtcars)}
  \item
    å¤åˆ¶è¾“å‡ºç»“æœt
  \item
    åœ¨reprexä¸­ï¼Œé”®å…¥\texttt{mtcars\ \textless{}-}ï¼Œç„¶åç²˜è´´ã€‚
  \end{enumerate}

  å°½é‡ä½¿ç”¨æ•°æ®çš„æœ€å°å­é›†ï¼Œä½†è¿˜è¦èƒ½æ­ç¤ºé—®é¢˜ã€‚
\item
  èŠ±ç‚¹æ—¶é—´ç¡®ä¿ä½ çš„\textbf{ä»£ç }æ˜“äºä»–äººé˜…è¯»ï¼š

  \begin{itemize}
  \item
    ç¡®ä¿ä½ ä½¿ç”¨äº†ç©ºæ ¼ï¼Œå¹¶ä¸”ä½ çš„å˜é‡åç®€æ´ä½†å¯Œæœ‰ä¿¡æ¯æ€§ï¼›
  \item
    ä½¿ç”¨æ³¨é‡Šæ¥æŒ‡å‡ºé—®é¢˜æ‰€åœ¨ï¼›
  \item
    å°½æœ€å¤§åŠªåŠ›ç§»é™¤ä¸é—®é¢˜æ— å…³çš„æ‰€æœ‰å†…å®¹ã€‚
  \end{itemize}

  ä½ çš„ä»£ç è¶ŠçŸ­ï¼Œå°±è¶Šå®¹æ˜“ç†è§£ï¼Œä¹Ÿå°±è¶Šå®¹æ˜“ä¿®å¤ã€‚
\end{enumerate}

æœ€åï¼Œé€šè¿‡å¯åŠ¨ä¸€ä¸ªæ–°çš„Rä¼šè¯å¹¶å¤åˆ¶ç²˜è´´ä½ çš„è„šæœ¬æ¥æ£€æŸ¥ä½ æ˜¯å¦çœŸçš„åˆ›å»ºäº†ä¸€ä¸ªå¯é‡å¤çš„ä¾‹å­ã€‚

åˆ›å»ºreprexeså¹¶ä¸æ˜¯ä¸€ä»¶ç®€å•çš„äº‹æƒ…ï¼Œè€Œä¸”å­¦ä¹ åˆ›å»ºå¥½çš„ã€çœŸæ­£ç²¾ç®€çš„reprexeséœ€è¦ä¸€äº›å®è·µã€‚ç„¶
è€Œï¼Œå­¦ä¹ åœ¨é—®é¢˜ä¸­åŒ…å«ä»£ç ï¼Œå¹¶æŠ•å…¥æ—¶é—´ä½¿å…¶å¯é‡å¤ï¼Œå°†éšç€ä½ å­¦ä¹ å’ŒæŒæ¡Rè€Œä¸æ–­å¾—åˆ°å›æŠ¥ã€‚

\section{æŠ•èµ„è‡ªå·±}\label{ux6295ux8d44ux81eaux5df1}

ä½ ä¹Ÿåº”è¯¥èŠ±ä¸€äº›æ—¶é—´åœ¨é—®é¢˜å‘ç”Ÿä¹‹å‰åšå¥½è§£å†³é—®é¢˜çš„å‡†å¤‡ã€‚æ¯
å¤©èŠ±ä¸€ç‚¹æ—¶é—´å­¦ä¹ Rï¼Œé•¿æœŸæ¥çœ‹ä¼šæœ‰ä¸°åšçš„å›æŠ¥ã€‚ä¸€
ç§æ–¹æ³•æ˜¯å…³æ³¨tidyverseå›¢é˜Ÿåœ¨\href{https://www.tidyverse.org/blog/}{tidyverseåšå®¢}ä¸Šçš„åŠ¨æ€ã€‚ä¸º
äº†æ›´å¹¿æ³›åœ°äº†è§£Rç¤¾åŒºï¼Œæˆ‘ä»¬æ¨èé˜…è¯»\href{https://rweekly.org}{R
Weekly}ï¼šå®ƒæ˜¯ç¤¾åŒºçš„ä¸€é¡¹åŠªåŠ›ï¼Œæ¯å‘¨æ±‡æ€»Rç¤¾åŒºä¸­æœ€æœ‰è¶£çš„æ–°é—»ã€‚

\section{å°ç»“}\label{ux5c0fux7ed3-7}

æœ¬ä¹¦å…¨è²Œæ¦‚è§ˆï¼ˆWhole Gameï¼‰éƒ¨åˆ†åˆ°æ­¤ç»“æŸã€‚ç°
åœ¨ä½ å·²ç»çœ‹åˆ°äº†æ•°æ®ç§‘å­¦è¿‡ç¨‹ä¸­æœ€é‡è¦çš„éƒ¨åˆ†ï¼šå¯è§†åŒ–ã€è½¬æ¢ã€æ•´ç†å’Œå¯¼å…¥ã€‚ç°
åœ¨ä½ å·²ç»æœ‰äº†ä¸€ä¸ªå¯¹æ•´ä¸ªè¿‡ç¨‹çš„æ•´ä½“è®¤è¯†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†æ·±å…¥åˆ°å„ä¸ªå°éƒ¨åˆ†çš„ç»†èŠ‚ã€‚

æœ¬ä¹¦çš„ä¸‹ä¸€éƒ¨åˆ†ï¼Œå¯è§†åŒ–ï¼Œå°†æ·±å…¥æ¢è®¨å›¾å½¢è¯­æ³•å’Œå¦‚ä½•ä½¿ç”¨ggplot2åˆ›å»ºæ•°æ®å¯è§†åŒ–ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ä½ è¿„ä»Šä¸ºæ­¢å­¦åˆ°çš„å·¥å…·è¿›è¡Œæ¢ç´¢æ€§æ•°æ®åˆ†æï¼Œå¹¶ä»‹ç»åˆ›å»ºç”¨äºäº¤æµçš„å›¾çš„è‰¯å¥½å®è·µã€‚

\part{å¯è§†åŒ–}

åœ¨é˜…è¯»äº†æœ¬ä¹¦çš„ç¬¬ä¸€éƒ¨åˆ†ä¹‹åï¼Œä½ ï¼ˆè‡³å°‘ä»è¡¨é¢ä¸Šï¼‰ç†è§£äº†åšæ•°æ®ç§‘å­¦æœ€é‡è¦çš„å·¥å…·ï¼Œç°åœ¨æ˜¯æ—¶å€™æ·±å…¥ç»†èŠ‚äº†ã€‚åœ¨
æœ¬ä¹¦è¿™ä¸€éƒ¨åˆ†ï¼Œä½ å°†è¿›ä¸€æ­¥æ·±å…¥å­¦ä¹ æ•°æ®å¯è§†åŒ–ã€‚

\begin{figure}

\centering{

\includegraphics[width=5.57in,height=\textheight]{diagrams/data-science/visualize.png}

}

\caption{\label{fig-ds-visualize}Data visualization is often the first
step in data exploration.}

\end{figure}%

æ¯ä¸€ç« éƒ½ä¼šä»‹ç»åˆ›å»ºæ•°æ®å¯è§†åŒ–çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–¹é¢ã€‚

\begin{itemize}
\tightlist
\item
  åœ¨ ç« èŠ‚~\ref{sec-layers} éƒ¨åˆ†ï¼Œå­¦ä¹ å›¾å½¢çš„åˆ†å±‚è¯­æ³•ï¼›
\item
  åœ¨ ç« èŠ‚~\ref{sec-exploratory-data-analysis}
  éƒ¨åˆ†ï¼ŒæŠŠå¯è§†åŒ–ä¸ä½ çš„å¥½å¥‡å¿ƒå’Œæ€€ç–‘ç²¾ç¥ç»“åˆèµ·æ¥ï¼Œé’ˆå¯¹æ•°æ®æå‡ºå¹¶å›ç­”æœ‰è¶£çš„é—®é¢˜ï¼›
\item
  æœ€å, åœ¨ ç« èŠ‚~\ref{sec-communication}
  éƒ¨åˆ†ï¼Œå­¦ä¹ å¦‚ä½•å°†æ¢ç´¢æ€§å›¾å½¢æå‡ä¸ºè§£é‡Šæ€§å›¾å½¢ï¼Œè¿™äº›å›¾å½¢æœ‰åŠ©äºæ–°æ‰‹å°½å¿«ç†è§£ä½ çš„åˆ†æç»“æœã€‚
\end{itemize}

è¿™ä¸‰ç« å¸¦ä½ è¿›å…¥å¯è§†åŒ–çš„ä¸–ç•Œï¼Œä½†è¿˜æœ‰æ›´å¤šè¦å­¦ä¹ çš„å†…å®¹ã€‚å­¦
ä¹ æ›´å¤šçŸ¥è¯†çš„ç»ä½³é€‰æ‹©æ˜¯ggplot2ï¼š\href{https://ggplot2-book.org/}{\emph{ggplot2:
Elegant graphics for data analysis}}.ã€‚è¿™
æœ¬ä¹¦æ·±å…¥æ¢è®¨äº†åº•å±‚ç†è®ºï¼Œå¹¶æä¾›äº†è®¸å¤šå¦‚ä½•å°†å„ä¸ªéƒ¨åˆ†ç»„åˆèµ·æ¥è§£å†³å®é™…é—®é¢˜çš„ç¤ºä¾‹ã€‚å¦
ä¸€ä¸ªå¾ˆå¥½çš„èµ„æºæ˜¯ggplot2æ‰©å±•åº“\href{https://exts.ggplot2.tidyverse.org/gallery/\%E3\%80\%82\%E8\%BF\%99\%E4\%B8\%AA\%E7\%BD\%91\%E7\%AB\%99\%E5\%88\%97\%E5\%87\%BA\%E4\%BA\%86\%E8\%AE\%B8\%E5\%A4\%9A\%E7\%94\%A8\%E6\%96\%B0\%E7\%9A\%84\%E5\%87\%A0\%E4\%BD\%95\%E5\%9B\%BE\%E5\%BD\%A2\%E5\%92\%8C\%E6\%AF\%94\%E4\%BE\%8B\%E5\%B0\%BA\%E6\%89\%A9\%E5\%B1\%95ggplot2\%E7\%9A\%84\%E5\%8C\%85\%E3\%80\%82\%E5\%A6\%82\%E6\%9E\%9C\%E4\%BD\%A0\%E8\%AF\%95\%E5\%9B\%BE\%E7\%94\%A8ggplot2\%E5\%81\%9A\%E4\%B8\%80\%E4\%BA\%9B\%E7\%9C\%8B\%E4\%BC\%BC\%E5\%9B\%B0\%E9\%9A\%BE\%E7\%9A\%84\%E4\%BA\%8B\%E6\%83\%85\%EF\%BC\%8C\%E8\%BF\%99\%E6\%98\%AF\%E4\%B8\%80\%E4\%B8\%AA\%E5\%BE\%88\%E5\%A5\%BD\%E7\%9A\%84\%E8\%B5\%B7\%E7\%82\%B9\%E3\%80\%82}{https://exts.ggplot2.tidyverse.org/gallery/}ã€‚è¿™
ä¸ªç½‘ç«™åˆ—å‡ºäº†è®¸å¤šç”¨æ–°çš„geomså’Œscalesæ‰©å±•ggplot2çš„åŒ…ã€‚å¦‚
æœä½ è¯•å›¾ç”¨ggplot2åšä¸€äº›çœ‹ä¼¼å›°éš¾çš„äº‹æƒ…ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å‡ºå‘ç‚¹ã€‚

\chapter{å›¾å±‚}\label{sec-layers}

\section{å¼•è¨€}\label{ux5f15ux8a00-4}

åœ¨ ç« èŠ‚~\ref{sec-data-visualization} ä¸­,
ä½ å­¦åˆ°çš„è¿œä¸æ­¢å¦‚ä½•åˆ¶ä½œæ•£ç‚¹å›¾ã€æ¡å½¢å›¾å’Œç®±çº¿å›¾ã€‚ä½ 
å­¦ä¹ äº†åˆ©ç”¨\texttt{ggplot2}å¯ä»¥åˆ¶ä½œä»»ä½•ç±»å‹å›¾å½¢çš„åŸºç¡€çŸ¥è¯†ã€‚

åœ¨æœ¬ç« ä¸­ä½ å°†åœ¨è¿™ä¸ªåŸºç¡€ä¸Šè¿›è¡Œæ‰©å±•ï¼Œå­¦ä¹ å›¾å½¢çš„åˆ†å±‚è¯­æ³•ã€‚é¦–
å…ˆï¼Œæˆ‘ä»¬å°†æ›´æ·±å…¥åœ°æ¢è®¨ç¾å­¦æ˜ å°„ã€å‡ ä½•å¯¹è±¡å’Œåˆ‡é¢ã€‚ç„¶
åï¼Œä½ å°†äº†è§£\texttt{ggplot2}åœ¨åˆ›å»ºå›¾å½¢æ—¶èƒŒåè¿›è¡Œçš„ç»Ÿè®¡è½¬æ¢ã€‚è¿™
äº›è½¬æ¢ç”¨äºè®¡ç®—æ–°çš„ç»˜å›¾å€¼ï¼Œä¾‹å¦‚æ¡å½¢å›¾ä¸­çš„æ¡å½¢é«˜åº¦æˆ–ç®±çº¿å›¾çš„ä¸­ä½æ•°ã€‚ä½ 
è¿˜å°†å­¦ä¹ ä½ç½®è°ƒæ•´ï¼Œè¿™ä¼šä¿®æ”¹å‡ ä½•å¯¹è±¡åœ¨å›¾è¡¨ä¸­çš„æ˜¾ç¤ºæ–¹å¼ã€‚æœ€
åï¼Œæˆ‘ä»¬å°†ç®€è¦ä»‹ç»åæ ‡ç³»ã€‚

æˆ‘ä»¬ä¸ä¼šæ¶µç›–è¿™äº›å›¾å±‚ä¸­çš„æ¯ä¸€ä¸ªå‡½æ•°å’Œé€‰é¡¹ï¼Œä½†æˆ‘ä»¬å°†å¼•å¯¼ä½ äº†è§£\texttt{ggplot2}æä¾›çš„æœ€é‡è¦å’Œæœ€å¸¸ç”¨çš„åŠŸèƒ½ï¼Œå¹¶å‘ä½ ä»‹ç»æ‰©å±•\texttt{ggplot2}çš„åŒ…ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-4}

æœ¬ç« é‡ç‚¹ä»‹ç»ggplot2ã€‚è¦
è®¿é—®æœ¬ç« ä¸­ä½¿ç”¨çš„æ•°æ®é›†ã€å¸®åŠ©é¡µé¢å’Œå‡½æ•°ï¼Œè¯·è¿è¡Œä»¥ä¸‹ä»£ç åŠ è½½tidyverse:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\section{ç¾å­¦æ˜ å°„}\label{ux7f8eux5b66ux6620ux5c04}

\begin{quote}
``å›¾ç‰‡çš„æœ€å¤§ä»·å€¼åœ¨äºå®ƒèƒ½å¤Ÿè¿«ä½¿æˆ‘ä»¬æ³¨æ„åˆ°æˆ‘ä»¬ä»æœªé¢„æœŸåˆ°çš„å†…å®¹ã€‚''

--- John Tukey
\end{quote}

è¯·è®°ä½ï¼Œggplot2 åŒ…é™„å¸¦çš„ \texttt{mpg}
æ•°æ®æ¡†åŒ…å«äº†å…³äº38ç§ä¸åŒæ±½è½¦å‹å·çš„234æ¡è§‚æµ‹æ•°æ®ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mpg}
\CommentTok{\#\textgreater{} \# A tibble: 234 x 11}
\CommentTok{\#\textgreater{}   manufacturer model displ  year   cyl trans      drv     cty   hwy fl   }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}        \textless{}chr\textgreater{} \textless{}dbl\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}chr\textgreater{}      \textless{}chr\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 audi         a4      1.8  1999     4 auto(l5)   f        18    29 p    }
\CommentTok{\#\textgreater{} 2 audi         a4      1.8  1999     4 manual(m5) f        21    29 p    }
\CommentTok{\#\textgreater{} 3 audi         a4      2    2008     4 manual(m6) f        20    31 p    }
\CommentTok{\#\textgreater{} 4 audi         a4      2    2008     4 auto(av)   f        21    30 p    }
\CommentTok{\#\textgreater{} 5 audi         a4      2.8  1999     6 auto(l5)   f        16    26 p    }
\CommentTok{\#\textgreater{} 6 audi         a4      2.8  1999     6 manual(m5) f        18    26 p    }
\CommentTok{\#\textgreater{} \# i 228 more rows}
\CommentTok{\#\textgreater{} \# i 1 more variable: class \textless{}chr\textgreater{}}
\end{Highlighting}
\end{Shaded}

\texttt{mpg} ä¸­çš„å˜é‡åŒ…æ‹¬:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \texttt{displ}: æ±½è½¦å‘åŠ¨æœºçš„æ’é‡ï¼Œå•ä½ä¸ºå‡ã€‚è¿™ æ˜¯ä¸€ä¸ªæ•°å€¼å‹å˜é‡ã€‚
\item
  \texttt{hwy}:
  é«˜é€Ÿå…¬è·¯ä¸Šæ±½è½¦çš„ç‡ƒæ²¹æ•ˆç‡ï¼Œä»¥æ¯åŠ ä»‘è¡Œé©¶çš„è‹±é‡Œæ•°ï¼ˆmpgï¼‰ä¸ºå•ä½ã€‚å½“
  ä¸¤è¾†æ±½è½¦è¡Œé©¶ç›¸åŒçš„è·ç¦»æ—¶ï¼Œç‡ƒæ²¹æ•ˆç‡ä½çš„æ±½è½¦æ¯”ç‡ƒæ²¹æ•ˆç‡é«˜çš„æ±½è½¦æ¶ˆè€—æ›´å¤šçš„ç‡ƒæ²¹ã€‚è¿™
  æ˜¯ä¸€ä¸ªæ•°å€¼å‹å˜é‡ã€‚
\item
  \texttt{class}: æ±½è½¦çš„å‹å·ã€‚è¿™ æ˜¯ä¸€ä¸ªåˆ†ç±»å˜é‡ã€‚
\end{enumerate}

è®©æˆ‘ä»¬é¦–å…ˆé€šè¿‡å¯è§†åŒ–ä¸åŒè½¦å‹ç±»åˆ«ï¼ˆ\texttt{class}ï¼‰çš„æ’é‡ï¼ˆ\texttt{displ}ï¼‰å’Œé«˜é€Ÿå…¬è·¯ç‡ƒæ²¹æ•ˆç‡ï¼ˆ\texttt{hwy}ï¼‰ä¹‹é—´çš„å…³ç³»æ¥å¼€å§‹ã€‚æˆ‘
ä»¬å¯ä»¥ä½¿ç”¨æ•£ç‚¹å›¾æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œå…¶ä¸­æ•°å€¼å˜é‡æ˜ å°„åˆ° \texttt{x} å’Œ
\texttt{y}
ç¾å­¦ä¸Šï¼Œè€Œåˆ†ç±»å˜é‡åˆ™æ˜ å°„åˆ°\texttt{color}æˆ–\texttt{shape}ç­‰ç¾å­¦ä¸Šã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Left}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{color =}\NormalTok{ class)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}

\CommentTok{\# Right}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{shape =}\NormalTok{ class)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\CommentTok{\#\textgreater{} Warning: The shape palette can deal with a maximum of 6 discrete values because more}
\CommentTok{\#\textgreater{} than 6 becomes difficult to discriminate}
\CommentTok{\#\textgreater{} i you have requested 7 values. Consider specifying shapes manually if you}
\CommentTok{\#\textgreater{}   need that many have them.}
\CommentTok{\#\textgreater{} Warning: Removed 62 rows containing missing values or values outside the scale range}
\CommentTok{\#\textgreater{} (\textasciigrave{}geom\_point()\textasciigrave{}).}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-4-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-4-2.pdf}\end{minipage}%

\end{figure}%

å½“ç±»åˆ«ï¼ˆ\texttt{class}ï¼‰æ˜ å°„åˆ°å½¢çŠ¶ï¼ˆ\texttt{shape}ï¼‰æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸¤ä¸ªè­¦å‘Šï¼š

\begin{quote}
1: å½¢çŠ¶è°ƒè‰²æ¿æœ€å¤šåªèƒ½å¤„ç† 6 ä¸ªç¦»æ•£å€¼ï¼Œå› ä¸ºè¶…è¿‡ 6
ä¸ªå€¼åå°±å¾ˆéš¾åŒºåˆ†ï¼›ä½†ä½ æœ‰ 7 ä¸ªã€‚å¦‚ æœä½ å¿…é¡»ä½¿ç”¨å®ƒä»¬ï¼Œè¯·è€ƒè™‘æ‰‹åŠ¨æŒ‡å®šå½¢çŠ¶ã€‚

2: åˆ é™¤äº†åŒ…å«ç¼ºå¤±å€¼çš„ 62 è¡Œï¼ˆ\texttt{geom\_point()}ï¼‰ã€‚
\end{quote}

ç”±äº ggplot2
é»˜è®¤ä¸€æ¬¡åªä¼šä½¿ç”¨å…­ä¸ªå½¢çŠ¶ï¼Œå› æ­¤å½“ä½¿ç”¨å½¢çŠ¶ç¾å­¦æ—¶ï¼Œé¢å¤–çš„ç»„å°†ä¸ä¼šè¢«ç»˜åˆ¶ã€‚ç¬¬
äºŒä¸ªè­¦å‘Šä¸æ­¤ç›¸å…³------æ•°æ®é›†ä¸­æœ‰ 62 è¾† SUVï¼Œå®ƒä»¬æ²¡æœ‰è¢«ç»˜åˆ¶å‡ºæ¥ã€‚

ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†ç±»åˆ«ï¼ˆ\texttt{class}ï¼‰æ˜ å°„åˆ°å¤§å°ï¼ˆ\texttt{size}ï¼‰æˆ–é€æ˜åº¦ï¼ˆ\texttt{alpha}ï¼‰ç¾å­¦ä¸Šï¼Œå®ƒä»¬åˆ†åˆ«æ§åˆ¶ç‚¹çš„å¤§å°å’Œé€æ˜åº¦ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Left}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{size =}\NormalTok{ class)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\CommentTok{\#\textgreater{} Warning: Using size for a discrete variable is not advised.}

\CommentTok{\# Right}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{alpha =}\NormalTok{ class)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\CommentTok{\#\textgreater{} Warning: Using alpha for a discrete variable is not advised.}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-5-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-5-2.pdf}\end{minipage}%

\end{figure}%

è¿™ä¸¤ç§æ–¹æ³•éƒ½ä¼šäº§ç”Ÿè­¦å‘Š:

\begin{quote}
ä¸å»ºè®®å°†alphaç”¨ä½œç¦»æ•£å˜é‡ã€‚
\end{quote}

å°†ä¸€ä¸ªæ— åºçš„ç¦»æ•£ï¼ˆåˆ†ç±»ï¼‰å˜é‡ï¼ˆå¦‚è½¦å‹\texttt{class}ï¼‰æ˜ å°„åˆ°ä¸€ä¸ªæœ‰åºçš„ç¾å­¦å±æ€§ï¼ˆå¦‚å¤§å°\texttt{size}æˆ–é€æ˜åº¦\texttt{alpha}ï¼‰é€šå¸¸ä¸æ˜¯æ˜æ™ºä¹‹ä¸¾ï¼Œå› ä¸ºå®ƒæš—å«äº†ä¸€ä¸ªå®é™…ä¸Šå¹¶ä¸å­˜åœ¨çš„æ’åã€‚

ä¸€æ—¦ä½ æ˜ å°„äº†ä¸€ä¸ªç¾å­¦å±æ€§ï¼Œggplot2 å°±ä¼šå¤„ç†å…¶ä½™éƒ¨åˆ†ã€‚å®ƒ
ä¼šé€‰æ‹©ä¸€ä¸ªåˆç†çš„åˆ»åº¦æ¥ä¸è¿™ä¸ªç¾å­¦å±æ€§ä¸€èµ·ä½¿ç”¨ï¼Œå¹¶æ„é€ ä¸€ä¸ªå›¾ä¾‹æ¥è§£é‡Šæ°´å¹³å’Œå€¼ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚å¯¹
äº x å’Œ y ç¾å­¦å±æ€§ï¼Œggplot2
ä¸ä¼šåˆ›å»ºå›¾ä¾‹ï¼Œä½†ä¼šåˆ›å»ºä¸€ä¸ªå¸¦æœ‰åˆ»åº¦çº¿å’Œæ ‡ç­¾çš„åæ ‡è½´çº¿ã€‚å
æ ‡è½´çº¿æä¾›äº†ä¸å›¾ä¾‹ç›¸åŒçš„ä¿¡æ¯ï¼›å®ƒè§£é‡Šäº†ä½ç½®å’Œå€¼ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚

ä½ ä¹Ÿå¯ä»¥é€šè¿‡å‡ ä½•å¯¹è±¡å‡½æ•°çš„å‚æ•°ï¼ˆåœ¨ \texttt{aes()}
ä¹‹å¤–ï¼‰æ¥æ‰‹åŠ¨è®¾ç½®ä½ çš„å‡ ä½•å¯¹è±¡çš„è§†è§‰å±æ€§ï¼Œè€Œä¸æ˜¯ä¾èµ–å˜é‡æ˜ å°„æ¥ç¡®å®šå¤–è§‚ã€‚ä¾‹
å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è®©æˆ‘ä»¬çš„å›¾å½¢ä¸­çš„æ‰€æœ‰ç‚¹éƒ½å‘ˆç°è“è‰²ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{color =} \StringTok{"blue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-6-1.pdf}

åœ¨è¿™é‡Œé¢œè‰²å¹¶ä¸ä¼ è¾¾å…³äºå˜é‡çš„ä¿¡æ¯ï¼Œè€Œåªæ˜¯æ”¹å˜å›¾çš„å¤–è§‚ã€‚ä½ 
éœ€è¦é€‰æ‹©ä¸€ä¸ªå¯¹è¯¥ç¾å­¦å±æ€§æœ‰æ„ä¹‰çš„å€¼ï¼š

\begin{itemize}
\tightlist
\item
  é¢œè‰²çš„åç§°ä½œä¸ºå­—ç¬¦ä¸², ä¾‹å¦‚ \texttt{color\ =\ "blue"}
\item
  ç‚¹çš„å¤§å°ä»¥æ¯«ç±³ä¸ºå•ä½ï¼Œä¾‹å¦‚ \texttt{size\ =\ 1}
\item
  ç‚¹çš„å½¢çŠ¶ä½œä¸ºä¸€ä¸ªæ•°å­—ï¼Œä¾‹å¦‚ \texttt{shape\ =\ 1}, å¦‚å›¾
  å›¾~\ref{fig-shapes} æ‰€ç¤ºã€‚
\end{itemize}

\begin{figure}

\centering{

\includegraphics[width=18.75in,height=\textheight]{layers_files/figure-pdf/fig-shapes-1.pdf}

}

\caption{\label{fig-shapes}R has 25 built-in shapes that are identified
by numbers. There are some seeming duplicates: for example, 0, 15, and
22 are all squares. The difference comes from the interaction of the
\texttt{color} and \texttt{fill} aesthetics. The hollow shapes (0--14)
have a border determined by \texttt{color}; the solid shapes (15--20)
are filled with \texttt{color}; the filled shapes (21--24) have a border
of \texttt{color} and are filled with \texttt{fill}. Shapes are arranged
to keep similar shapes next to each other.}

\end{figure}%

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è®¨è®ºäº†åœ¨ä½¿ç”¨ç‚¹å‡ ä½•å¯¹è±¡ï¼ˆpoint
geomï¼‰åˆ›å»ºæ•£ç‚¹å›¾æ—¶å¯ä»¥æ˜ å°„æˆ–è®¾ç½®çš„ç¾å­¦å±æ€§ã€‚ä½ 
å¯ä»¥åœ¨\url{https://ggplot2.tidyverse.org/articles/ggplot2-specs.html}
çš„ç¾å­¦è§„èŒƒæ–‡æ¡£ä¸­äº†è§£æ›´å¤šå…³äºæ‰€æœ‰å¯èƒ½çš„ç¾å­¦æ˜ å°„çš„ä¿¡æ¯ã€‚

ä½ å¯ä»¥åœ¨ä¸€ä¸ªå›¾ä¸­ä½¿ç”¨çš„å…·ä½“ç¾å­¦å±æ€§å–å†³äºä½ ç”¨æ¥è¡¨ç¤ºæ•°æ®çš„å‡ ä½•å¯¹è±¡ï¼ˆgeomï¼‰ã€‚åœ¨
ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ›´æ·±å…¥åœ°æ¢è®¨å‡ ä½•å¯¹è±¡ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-12}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  åˆ›å»ºä¸€ä¸ª\texttt{hwy}å’Œ\texttt{displ}çš„æ•£ç‚¹å›¾ï¼Œå…¶ä¸­çš„ç‚¹æ˜¯ç²‰çº¢è‰²å¡«å……çš„ä¸‰è§’å½¢ã€‚
\item
  ä»¥ä¸‹ä»£ç ä¸ºä»€ä¹ˆæ²¡æœ‰ç”Ÿæˆå¸¦æœ‰è“è‰²ç‚¹çš„å›¾ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{color =} \StringTok{"blue"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}
\item
  æè¾¹ç¾å­¦ï¼ˆstroke aestheticï¼‰æ˜¯åšä»€ä¹ˆç”¨çš„ï¼Ÿå®ƒ ä¸å“ªäº›å½¢çŠ¶ä¸€èµ·å·¥ä½œï¼Ÿï¼ˆ
  æç¤ºï¼šä½¿ç”¨ \texttt{?geom\_point}ï¼‰
\item
  å¦‚æœä½ å°†ç¾å­¦æ˜ å°„åˆ°å˜é‡åä¹‹å¤–çš„å…¶ä»–ä¸œè¥¿ï¼Œæ¯”å¦‚
  \texttt{aes(color\ =\ displ\ \textless{}\ 5)}ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæ³¨
  æ„ï¼Œä½ è¿˜éœ€è¦æŒ‡å®š x å’Œ yã€‚
\end{enumerate}

\section{å‡ ä½•å¯¹è±¡}\label{sec-geometric-objects}

ä¸‹é¢ä¸¤å¼ å›¾æœ‰ä»€ä¹ˆç›¸ä¼¼ä¹‹å¤„ï¼Ÿ

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-9-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-9-2.pdf}\end{minipage}%

\end{figure}%

ä¸¤å¼ å›¾åŒ…å«ç›¸åŒçš„xå˜é‡å’Œyå˜é‡ï¼Œå¹¶ä¸”éƒ½æè¿°äº†ç›¸åŒçš„æ•°æ®ã€‚ä½†
æ˜¯ï¼Œè¿™ä¸¤å¼ å›¾å¹¶ä¸å®Œå…¨ç›¸åŒã€‚æ¯
å¼ å›¾éƒ½ä½¿ç”¨ä¸åŒçš„å‡ ä½•å¯¹è±¡ï¼ˆgeomï¼‰æ¥è¡¨ç¤ºæ•°æ®ã€‚å·¦
ä¾§çš„å›¾ä½¿ç”¨äº†ç‚¹å‡ ä½•å¯¹è±¡ï¼ˆpoint
geomï¼‰ï¼Œè€Œå³ä¾§çš„å›¾è¡¨ä½¿ç”¨äº†å¹³æ»‘å‡ ä½•å¯¹è±¡ï¼ˆsmooth
geomï¼‰ï¼Œå³ç”¨å¹³æ»‘çº¿æ‹Ÿåˆåˆ°æ•°æ®ä¸Šã€‚

è¦åœ¨ä½ çš„å›¾ä¸­æ›´æ”¹å‡ ä½•å¯¹è±¡ï¼ˆgeomï¼‰ï¼Œè¯·æ›´æ”¹ä½ æ·»åŠ åˆ°\texttt{ggplot()}å‡½æ•°ä¸­çš„å‡ ä½•å¯¹è±¡å‡½æ•°ã€‚ä¾‹
å¦‚ï¼Œè¦ç»˜åˆ¶ä¸Šè¿°å›¾å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Left}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{()}

\CommentTok{\# Right}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_smooth}\NormalTok{()}
\CommentTok{\#\textgreater{} \textasciigrave{}geom\_smooth()\textasciigrave{} using method = \textquotesingle{}loess\textquotesingle{} and formula = \textquotesingle{}y \textasciitilde{} x\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

åœ¨ggplot2ä¸­ï¼Œæ¯ä¸ªgeomå‡½æ•°éƒ½æ¥å—ä¸€ä¸ªæ˜ å°„å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°å¯ä»¥åœ¨geomå›¾å±‚ä¸­æœ¬åœ°å®šä¹‰ï¼Œä¹Ÿå¯ä»¥åœ¨\texttt{ggplot()}å›¾å±‚ä¸­å…¨å±€å®šä¹‰ã€‚ç„¶
è€Œï¼Œå¹¶ä¸æ˜¯æ¯ä¸ªç¾å­¦å±æ€§ï¼ˆaestheticï¼‰éƒ½é€‚ç”¨äºæ¯ä¸ªgeomã€‚ä½ 
å¯ä»¥è®¾ç½®ç‚¹çš„å½¢çŠ¶ï¼Œä½†ä½ ä¸èƒ½è®¾ç½®çº¿çš„``å½¢çŠ¶''ã€‚å¦‚
æœä½ å°è¯•è¿™æ ·åšï¼Œggplot2ä¼šé™é»˜åœ°å¿½ç•¥è¯¥ç¾å­¦æ˜ å°„ã€‚å¦
ä¸€æ–¹é¢ï¼Œä½ å¯ä»¥è®¾ç½®çº¿çš„çº¿å‹ã€‚\texttt{g}
\texttt{eom\_smooth()}ä¼šæ ¹æ®ä½ æ˜ å°„åˆ°çº¿å‹å˜é‡çš„ä¸åŒå€¼ï¼Œç»˜åˆ¶å…·æœ‰ä¸åŒçº¿å‹çš„å¹³æ»‘çº¿ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Left}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{shape =}\NormalTok{ drv)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_smooth}\NormalTok{()}

\CommentTok{\# Right}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{linetype =}\NormalTok{ drv)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_smooth}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-11-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-11-2.pdf}\end{minipage}%

\end{figure}%

åœ¨è¿™é‡Œï¼Œ\texttt{geom\_smooth()}æ ¹æ®æ±½è½¦çš„\texttt{drv}å€¼ï¼ˆæè¿°äº†æ±½è½¦çš„é©±åŠ¨æ–¹å¼ï¼‰å°†æ±½è½¦æ•°æ®åˆ†æˆä¸‰æ¡çº¿ã€‚ä¸€
æ¡çº¿æè¿°äº†æ‰€æœ‰å€¼ä¸º4çš„ç‚¹ï¼Œä¸€æ¡çº¿æè¿°äº†æ‰€æœ‰å€¼ä¸º\texttt{f}çš„ç‚¹ï¼Œè¿˜æœ‰ä¸€æ¡çº¿æè¿°äº†æ‰€æœ‰å€¼ä¸º\texttt{r}çš„ç‚¹ã€‚åœ¨
è¿™é‡Œï¼Œ4ä»£è¡¨å››è½®é©±åŠ¨ï¼Œ\texttt{f}ä»£è¡¨å‰è½®é©±åŠ¨ï¼Œ\texttt{r}ä»£è¡¨åè½®é©±åŠ¨ã€‚

å¦‚æœè¿™å¬èµ·æ¥æœ‰äº›å¥‡æ€ªï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å°†è¿™ä¸‰æ¡çº¿å åŠ åœ¨åŸå§‹æ•°æ®ä¸Šï¼Œå¹¶æ ¹æ®\texttt{drv}çš„å€¼ç»™æ‰€æœ‰å†…å®¹ä¸Šè‰²ï¼Œæ¥ä½¿å…¶æ›´åŠ æ¸…æ™°ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{linetype =}\NormalTok{ drv))}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-12-1.pdf}

è¯·æ³¨æ„ï¼Œè¿™ä¸ªå›¾åœ¨åŒä¸€ä¸ªå›¾å½¢ä¸­åŒ…å«äº†ä¸¤ä¸ªå‡ ä½•å¯¹è±¡ï¼ˆgeomsï¼‰ã€‚

è®¸å¤šå‡ ä½•å¯¹è±¡ï¼ˆå¦‚\texttt{geom\_smooth()}ï¼‰ä½¿ç”¨å•ä¸ªå‡ ä½•å¯¹è±¡æ¥æ˜¾ç¤ºå¤šè¡Œæ•°æ®ã€‚å¯¹
äºè¿™äº›å‡ ä½•å¯¹è±¡ï¼Œä½ å¯ä»¥å°†ç»„ï¼ˆ\texttt{group}ï¼‰ç¾å­¦å±æ€§è®¾ç½®ä¸ºåˆ†ç±»å˜é‡æ¥ç»˜åˆ¶å¤šä¸ªå¯¹è±¡ã€‚g
gplot2ä¼šä¸ºåˆ†ç»„å˜é‡çš„æ¯ä¸ªå€¼ç»˜åˆ¶ä¸€ä¸ªç‹¬ç«‹çš„å¯¹è±¡ã€‚åœ¨
å®è·µä¸­ï¼Œå½“ä½ å°†ç¾å­¦å±æ€§æ˜ å°„åˆ°ç¦»æ•£å˜é‡æ—¶ï¼ˆå¦‚çº¿å‹ç¤ºä¾‹ï¼‰ï¼Œggplot2ä¼šè‡ªåŠ¨ä¸ºè¿™äº›å‡ ä½•å¯¹è±¡åˆ†ç»„æ•°æ®ã€‚ä¾
èµ–è¿™ä¸ªç‰¹æ€§æ˜¯å¾ˆæ–¹ä¾¿çš„ï¼Œå› ä¸ºç»„ï¼ˆ\texttt{group}ï¼‰ç¾å­¦å±æ€§æœ¬èº«ä¸ä¼šç»™å‡ ä½•å¯¹è±¡æ·»åŠ å›¾ä¾‹æˆ–åŒºåˆ†ç‰¹å¾ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Left}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{()}

\CommentTok{\# Middle}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{group =}\NormalTok{ drv))}

\CommentTok{\# Right}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ drv), }\AttributeTok{show.legend =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.33\linewidth}
\includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-13-1.pdf}\end{minipage}%
%
\begin{minipage}{0.33\linewidth}
\includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-13-2.pdf}\end{minipage}%
%
\begin{minipage}{0.33\linewidth}
\includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-13-3.pdf}\end{minipage}%

\end{figure}%

å¦‚æœä½ åœ¨geomå‡½æ•°ä¸­æ”¾ç½®æ˜ å°„ï¼Œggplot2ä¼šå°†è¿™äº›æ˜ å°„è§†ä¸ºè¯¥å›¾å±‚çš„æœ¬åœ°æ˜ å°„ã€‚å®ƒ
å°†ä½¿ç”¨è¿™äº›æ˜ å°„æ¥æ‰©å±•æˆ–è¦†ç›–è¯¥å›¾å±‚çš„å…¨å±€æ˜ å°„ã€‚è¿™
ä½¿å¾—åœ¨ä¸åŒçš„å›¾å±‚ä¸­æ˜¾ç¤ºä¸åŒçš„ç¾å­¦å±æ€§æˆä¸ºå¯èƒ½ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ class)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_smooth}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-14-1.pdf}

ä½ å¯ä»¥ä½¿ç”¨ç›¸åŒçš„æ€è·¯æ¥ä¸ºæ¯ä¸€å±‚æŒ‡å®šä¸åŒçš„æ•°æ®ã€‚åœ¨
è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çº¢è‰²çš„ç‚¹å’Œç©ºå¿ƒçš„åœ†åœˆæ¥çªå‡ºæ˜¾ç¤ºä¸¤åº§è½¦ã€‚\texttt{g}
\texttt{eom\_point()}ä¸­çš„å±€éƒ¨æ•°æ®å‚æ•°ï¼ˆlocal data
argumentï¼‰ä»…é’ˆå¯¹é‚£ä¸€å±‚è¦†ç›–äº†\texttt{ggplot()}ä¸­çš„å…¨å±€æ•°æ®å‚æ•°ï¼ˆglobal
data argumentï¼‰ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}
    \AttributeTok{data =}\NormalTok{ mpg }\SpecialCharTok{|\textgreater{}} \FunctionTok{filter}\NormalTok{(class }\SpecialCharTok{==} \StringTok{"2seater"}\NormalTok{), }
    \AttributeTok{color =} \StringTok{"red"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}
    \AttributeTok{data =}\NormalTok{ mpg }\SpecialCharTok{|\textgreater{}} \FunctionTok{filter}\NormalTok{(class }\SpecialCharTok{==} \StringTok{"2seater"}\NormalTok{), }
    \AttributeTok{shape =} \StringTok{"circle open"}\NormalTok{, }\AttributeTok{size =} \DecValTok{3}\NormalTok{, }\AttributeTok{color =} \StringTok{"red"}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-15-1.pdf}

å‡ ä½•å¯¹è±¡ï¼ˆ\texttt{geoms}ï¼‰æ˜¯\texttt{ggplot2}çš„åŸºæœ¬æ„å»ºæ¨¡å—ã€‚ä½ 
å¯ä»¥é€šè¿‡æ”¹å˜å›¾å½¢çš„\texttt{geom}æ¥å®Œå…¨æ”¹å˜å…¶å¤–è§‚ï¼Œè€Œä¸åŒçš„\texttt{geoms}å¯ä»¥æ­ç¤ºæ•°æ®çš„ä¸åŒç‰¹å¾ã€‚ä¾‹
å¦‚ä¸‹é¢çš„ç›´æ–¹å›¾å’Œå¯†åº¦å›¾æ­ç¤ºäº†é«˜é€Ÿå…¬è·¯é‡Œç¨‹çš„åˆ†å¸ƒæ˜¯åŒå³°çš„ä¸”å‘å³åæ–œï¼Œè€Œç®±çº¿å›¾åˆ™æ­ç¤ºäº†ä¸¤ä¸ªæ½œåœ¨çš„å¼‚å¸¸å€¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Left}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{2}\NormalTok{)}

\CommentTok{\# Middle}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_density}\NormalTok{()}

\CommentTok{\# Right}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.33\linewidth}
\includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-16-1.pdf}\end{minipage}%
%
\begin{minipage}{0.33\linewidth}
\includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-16-2.pdf}\end{minipage}%
%
\begin{minipage}{0.33\linewidth}
\includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-16-3.pdf}\end{minipage}%

\end{figure}%

ggplot2æä¾›äº†è¶…è¿‡ 40
ä¸ª\texttt{geoms}ï¼Œä½†è¿™å¹¶ä¸è¦†ç›–æ‰€æœ‰å¯èƒ½åˆ›å»ºçš„å›¾å½¢ã€‚å¦‚
æœä½ éœ€è¦ä¸€ä¸ªä¸åŒçš„\texttt{geom}ï¼Œæˆ‘ä»¬å»ºè®®å…ˆæŸ¥çœ‹æ‰©å±•åŒ…ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰äººå·²ç»å®ç°äº†å®ƒï¼ˆå¯ä»¥åœ¨\url{https://exts.ggplot2.tidyverse.org/gallery/}æ‰¾åˆ°ä¸€ä¸ªç¤ºä¾‹ï¼‰ã€‚ä¾‹
å¦‚ï¼Œ\texttt{ggridges}åŒ…ï¼ˆ\href{https://wilkelab.org/ggridges/}{https://wilkelab.org/ggridges}ï¼‰å¯¹äºåˆ¶ä½œå±±è„Šçº¿å›¾ï¼ˆridgeline
plotsï¼‰å¾ˆæœ‰ç”¨ï¼Œè¿™ç§å›¾å¯ä»¥ç”¨äºå¯è§†åŒ–æ•°å€¼å˜é‡åœ¨ä¸åŒç±»åˆ«å˜é‡æ°´å¹³ä¸‹çš„å¯†åº¦ã€‚åœ¨
ä¸‹é¢çš„å›¾å½¢ä¸­ï¼Œæˆ‘ä»¬ä¸ä»…ä½¿ç”¨äº†ä¸€ä¸ªæ–°çš„\texttt{geom}ï¼ˆ\texttt{geom\_density\_ridges()}ï¼‰ï¼Œè€Œä¸”æˆ‘ä»¬è¿˜å°†ç›¸åŒçš„å˜é‡æ˜ å°„åˆ°å¤šä¸ªç¾å­¦å±æ€§ï¼ˆ\texttt{drv}åˆ°\texttt{y}ã€\texttt{fill}å’Œ\texttt{color}ï¼‰ï¼Œå¹¶è®¾ç½®äº†ä¸€ä¸ªç¾å­¦å±æ€§ï¼ˆ\texttt{alpha\ =\ 0.5}ï¼‰ä»¥ä½¿å¯†åº¦æ›²çº¿é€æ˜ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggridges)}

\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ hwy, }\AttributeTok{y =}\NormalTok{ drv, }\AttributeTok{fill =}\NormalTok{ drv, }\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+}
  \FunctionTok{geom\_density\_ridges}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{, }\AttributeTok{show.legend =} \ConstantTok{FALSE}\NormalTok{)}
\CommentTok{\#\textgreater{} Picking joint bandwidth of 1.28}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-17-1.pdf}

è¦äº†è§£\texttt{ggplot2}æä¾›çš„æ‰€æœ‰\texttt{geoms}çš„å…¨é¢æ¦‚è¿°ä»¥åŠåŒ…ä¸­çš„æ‰€æœ‰å‡½æ•°ï¼Œæœ€å¥½çš„åœ°æ–¹æ˜¯å‚è€ƒ\url{https://ggplot2.tidyverse.org/reference}ã€‚è¦
æ·±å…¥äº†è§£ä»»ä½•å•ä¸€çš„\texttt{geom}ï¼Œè¯·ä½¿ç”¨å¸®åŠ©å‡½æ•°ï¼ˆä¾‹å¦‚
\texttt{?geom\_smooth}ï¼‰ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-13}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ä½ ä¼šä½¿ç”¨å“ªç§\texttt{geom}æ¥ç»˜åˆ¶æŠ˜çº¿å›¾ï¼Ÿç®± çº¿å›¾ï¼Ÿç›´ æ–¹å›¾ï¼Ÿé¢ ç§¯å›¾ï¼Ÿ
\item
  åœ¨æœ¬ç« çš„å‰é¢éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†\texttt{show.legend}è€Œæ²¡æœ‰è§£é‡Šå®ƒï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ drv), }\AttributeTok{show.legend =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \texttt{show.legend\ =\ FALSE}åœ¨è¿™é‡Œçš„ä½œç”¨æ˜¯ä»€ä¹ˆ?å¦‚
  æœä½ æŠŠå®ƒå»æ‰ä¼šæ€ä¹ˆæ ·?ä½  è§‰å¾—æˆ‘ä»¬ä¹‹å‰ä¸ºä»€ä¹ˆç”¨å®ƒ?
\item
  \texttt{geom\_smooth()} çš„å‚æ•°\texttt{se}èµ·ä»€ä¹ˆä½œç”¨?
\item
  é‡æ–°åˆ›å»ºç”Ÿæˆä»¥ä¸‹å›¾å½¢æ‰€éœ€çš„Rä»£ç ã€‚
  è¯·æ³¨æ„ï¼Œå›¾ä¸­ç”¨åˆ°çš„åˆ†ç±»å˜é‡çš„éƒ½æ˜¯\texttt{drv}ã€‚

  \begin{figure}

  \begin{minipage}{0.50\linewidth}
  \includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-19-1.pdf}\end{minipage}%
  %
  \begin{minipage}{0.50\linewidth}
  \includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-19-2.pdf}\end{minipage}%
  \newline
  \begin{minipage}{0.50\linewidth}
  \includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-19-3.pdf}\end{minipage}%
  %
  \begin{minipage}{0.50\linewidth}
  \includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-19-4.pdf}\end{minipage}%
  \newline
  \begin{minipage}{0.50\linewidth}
  \includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-19-5.pdf}\end{minipage}%
  %
  \begin{minipage}{0.50\linewidth}
  \includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-19-6.pdf}\end{minipage}%

  \end{figure}%
\end{enumerate}

\section{åˆ†é¢}\label{ux5206ux9762}

åœ¨ ç« èŠ‚~\ref{sec-data-visualization}
ï¼Œä½ å­¦ä¹ äº†ä½¿ç”¨\texttt{facet\_wrap()}è¿›è¡Œåˆ†é¢ï¼Œè¯¥æ–¹æ³•å¯ä»¥å°†ä¸€ä¸ªå›¾å½¢åˆ†å‰²æˆå­å›¾ï¼Œæ¯ä¸ªå­å›¾éƒ½åŸºäºä¸€ä¸ªåˆ†ç±»å˜é‡æ˜¾ç¤ºæ•°æ®çš„ä¸€ä¸ªå­é›†ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{cyl)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-20-1.pdf}

è¦ä½¿ç”¨ä¸¤ä¸ªå˜é‡çš„ç»„åˆæ¥å¯¹ä½ çš„å›¾å½¢è¿›è¡Œåˆ†é¢ï¼Œä½ éœ€è¦ä»\texttt{facet\_wrap()}åˆ‡æ¢åˆ°\texttt{facet\_grid()}ã€‚\texttt{f}
\texttt{acet\_grid()}çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå…¬å¼ï¼Œä½†ç°åœ¨å®ƒæ˜¯ä¸€ä¸ªåŒé¢å…¬å¼ï¼š\texttt{rows\ \textasciitilde{}\ cols}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{facet\_grid}\NormalTok{(drv }\SpecialCharTok{\textasciitilde{}}\NormalTok{ cyl)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-21-1.pdf}

é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªåˆ†é¢å…±äº«ç›¸åŒçš„xè½´å’Œyè½´çš„åˆ»åº¦å’ŒèŒƒå›´ã€‚å½“
ä½ æƒ³è·¨åˆ†é¢æ¯”è¾ƒæ•°æ®æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ï¼Œä½†å½“ä½ å¸Œæœ›æ›´å¥½åœ°å¯è§†åŒ–æ¯ä¸ªåˆ†é¢å†…çš„å…³ç³»æ—¶ï¼Œè¿™å¯èƒ½ä¼šæœ‰æ‰€é™åˆ¶ã€‚å°†
åˆ†é¢å‡½æ•°ä¸­çš„\texttt{scales}å‚æ•°è®¾ç½®ä¸º\texttt{"free"}å°†å…è®¸è¡Œå’Œåˆ—ä¹‹é—´ä½¿ç”¨ä¸åŒçš„è½´åˆ»åº¦ï¼Œ``\texttt{free\_x}''å°†å…è®¸è¡Œä¹‹é—´ä½¿ç”¨ä¸åŒçš„åˆ»åº¦ï¼Œ``\texttt{free\_y}''å°†å…è®¸åˆ—ä¹‹é—´ä½¿ç”¨ä¸åŒçš„åˆ»åº¦ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{facet\_grid}\NormalTok{(drv }\SpecialCharTok{\textasciitilde{}}\NormalTok{ cyl, }\AttributeTok{scales =} \StringTok{"free\_y"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-22-1.pdf}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-14}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  å¦‚æœä½ å¯¹ä¸€ä¸ªè¿ç»­å˜é‡è¿›è¡Œåˆ†é¢ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ
\item
  ä¸Šé¢çš„å›¾ä¸­ä½¿ç”¨\texttt{facet\_grid(drv\ \textasciitilde{}\ cyl)}ç”Ÿæˆçš„ç©ºå•å…ƒæ ¼æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿè¿
  è¡Œä»¥ä¸‹ä»£ç ï¼Œå®ƒä»¬ä¸ç”Ÿæˆçš„å›¾æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ drv, }\AttributeTok{y =}\NormalTok{ cyl))}
\end{Highlighting}
\end{Shaded}
\item
  ä»¥ä¸‹ä»£ç ç”Ÿæˆäº†ä»€ä¹ˆæ ·çš„å›¾å½¢ï¼Ÿ\texttt{.} åœ¨è¿™é‡Œä»£è¡¨ä»€ä¹ˆï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(drv }\SpecialCharTok{\textasciitilde{}}\NormalTok{ .)}

\FunctionTok{ggplot}\NormalTok{(mpg) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(. }\SpecialCharTok{\textasciitilde{}}\NormalTok{ cyl)}
\end{Highlighting}
\end{Shaded}
\item
  æŸ¥çœ‹æœ¬èŠ‚ä¸­çš„ç¬¬ä¸€ä¸ªåˆ†é¢å›¾ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+} 
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{ class, }\AttributeTok{nrow =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  ä½¿ç”¨åˆ†é¢ï¼ˆfacetingï¼‰è€Œä¸æ˜¯é¢œè‰²ç¾å­¦ï¼ˆcolor aestheticï¼‰çš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼ŸåŠ£
  åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ æœä½ æœ‰ä¸€ä¸ªæ›´å¤§çš„æ•°æ®é›†ï¼Œè¿™ç§å¹³è¡¡å¯èƒ½ä¼šå¦‚ä½•æ”¹å˜ï¼Ÿ
\item
  é˜…è¯»\texttt{?facet\_wrap}çš„å¸®åŠ©æ–‡æ¡£ï¼Œ\texttt{nrow}æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ\texttt{n}
  \texttt{col}å‘¢ï¼Ÿè¿˜ æœ‰å“ªäº›é€‰é¡¹æ§åˆ¶å•ä¸ªé¢æ¿çš„å¸ƒå±€ï¼Ÿä¸º
  ä»€ä¹ˆ\texttt{facet\_grid()}æ²¡æœ‰\texttt{nrow}å’Œ\texttt{ncol}å‚æ•°ï¼Ÿ
\item
  ä¸‹é¢çš„å“ªä¸ªå›¾ä½¿å¾—æ¯”è¾ƒä¸åŒé©±åŠ¨æ–¹å¼çš„æ±½è½¦çš„å‘åŠ¨æœºæ’é‡ï¼ˆ\texttt{displ}ï¼‰æ›´å®¹æ˜“ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_histogram}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{facet\_grid}\NormalTok{(drv }\SpecialCharTok{\textasciitilde{}}\NormalTok{ .)}

\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_histogram}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(. }\SpecialCharTok{\textasciitilde{}}\NormalTok{ drv)}
\end{Highlighting}
\end{Shaded}
\item
  ä½¿ç”¨\texttt{facet\_wrap()}é‡æ–°åˆ›å»ºä»¥ä¸‹å›¾å½¢ã€‚è¿™
  æ—¶åˆ†é¢æ ‡ç­¾çš„ä½ç½®å¦‚ä½•å˜åŒ–ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{facet\_grid}\NormalTok{(drv }\SpecialCharTok{\textasciitilde{}}\NormalTok{ .)}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{ç»Ÿè®¡å˜æ¢}\label{ux7edfux8ba1ux53d8ux6362}

ä¸‹é¢æ˜¯ä¸€ä¸ªç”¨\texttt{geom\_bar()}æˆ–\texttt{geom\_col()}ç»˜åˆ¶çš„åŸºæœ¬æ¡å½¢å›¾ï¼Œå›¾å½¢æ˜¾ç¤ºäº†\texttt{diamonds}æ•°æ®é›†ä¸­æŒ‰\texttt{cut}åˆ†ç»„çš„é’»çŸ³æ€»æ•°ã€‚\texttt{d}
\texttt{iamonds}æ•°æ®é›†ä½äº\texttt{ggplot2}åŒ…ä¸­ï¼ŒåŒ…å«çº¦ 54,000
é¢—é’»çŸ³çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ¯é¢—é’»çŸ³çš„ä»·æ ¼ï¼ˆ\texttt{price}ï¼‰ã€é‡é‡ï¼ˆ\texttt{carat}ï¼‰ã€é¢œè‰²ï¼ˆ\texttt{color}ï¼‰ã€å‡€åº¦ï¼ˆ\texttt{clarity}ï¼‰å’Œåˆ‡å‰²æ–¹å¼ï¼ˆ\texttt{cut}
ï¼‰ã€‚å›¾ å½¢æ˜¾ç¤ºï¼Œé«˜è´¨é‡åˆ‡å‰²çš„é’»çŸ³æ¯”ä½è´¨é‡åˆ‡å‰²çš„é’»çŸ³æ›´å¤šã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cut)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_bar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-28-1.pdf}

åœ¨ x è½´ä¸Šå›¾å½¢æ˜¾ç¤ºäº†æ¥è‡ª \texttt{diamonds} æ•°æ®é›†çš„å˜é‡ \texttt{cut}ã€‚åœ¨
y è½´ä¸Šæ˜¾ç¤ºäº† countï¼Œä½† count å¹¶ä¸æ˜¯ \texttt{diamonds} æ•°æ®é›†ä¸­çš„å˜é‡ï¼c
ount æ˜¯ä»å“ªé‡Œæ¥çš„ï¼Ÿè®¸ å¤šå›¾å½¢ï¼Œå¦‚æ•£ç‚¹å›¾ä¼šç»˜åˆ¶æ•°æ®é›†çš„åŸå§‹å€¼ã€‚è€Œ
å…¶ä»–å›¾å½¢ï¼Œå¦‚æ¡å½¢å›¾åˆ™ä¼šè®¡ç®—æ–°çš„å€¼æ¥ç»˜åˆ¶ï¼š

\begin{itemize}
\tightlist
\item
  æ¡å½¢å›¾ã€ç›´æ–¹å›¾å’Œé¢‘æ•°å¤šè¾¹å½¢ä¼šå°†æ•°æ®è¿›è¡Œåˆ†ç®±ï¼Œç„¶åç»˜åˆ¶æ¯ä¸ªåˆ†ç®±ä¸­çš„ç‚¹æ•°ï¼ˆå³åˆ†ç®±è®¡æ•°ï¼‰ã€‚
\item
  å¹³æ»‘å™¨ï¼ˆsmoothersï¼‰ä¼šå¯¹æ‚¨çš„æ•°æ®æ‹Ÿåˆä¸€ä¸ªæ¨¡å‹ï¼Œç„¶åç»˜åˆ¶è¯¥æ¨¡å‹çš„é¢„æµ‹å€¼ã€‚
\item
  ç®±çº¿å›¾ä¼šè®¡ç®—åˆ†å¸ƒçš„äº”æ•°æ±‡æ€»ï¼ˆfive-number
  summaryï¼‰ï¼Œç„¶åä»¥ç‰¹æ®Šæ ¼å¼çš„ç®±å­æ˜¾ç¤ºè¯¥æ±‡æ€»ã€‚
\end{itemize}

ç”¨äºè®¡ç®—å›¾å½¢æ–°å€¼çš„ç®—æ³•è¢«ç§°ä¸º \textbf{stat}ï¼Œæ˜¯ statistical
transformationï¼ˆç»Ÿè®¡å˜æ¢ï¼‰çš„ç¼©å†™ã€‚@ fig-vis-stat-bar å±•ç¤ºäº†
\texttt{geom\_bar()} æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

\begin{figure}

\centering{

\includegraphics[width=1\textwidth,height=\textheight]{images/visualization-stat-bar.png}

}

\caption{\label{fig-vis-stat-bar}When creating a bar chart we first
start with the raw data, then aggregate it to count the number of
observations in each bar, and finally map those computed variables to
plot aesthetics.}

\end{figure}%

ä½ å¯ä»¥é€šè¿‡æ£€æŸ¥\texttt{stat}å‚æ•°çš„é»˜è®¤å€¼æ¥äº†è§£ä¸€ä¸ª\texttt{geom}ä½¿ç”¨çš„æ˜¯å“ªç§ç»Ÿè®¡å˜æ¢ã€‚ä¾‹
å¦‚\texttt{?geom\_bar}æ˜¾ç¤º\texttt{stat}çš„é»˜è®¤å€¼æ˜¯''count''ï¼Œè¿™æ„å‘³ç€\texttt{geom\_bar()}ä½¿ç”¨çš„æ˜¯\texttt{stat\_count()}ã€‚\texttt{s}
\texttt{tat\_count()}çš„æ–‡æ¡£ä¸\texttt{geom\_bar()}åœ¨åŒä¸€é¡µé¢ã€‚å¦‚
æœä½ å‘ä¸‹æ»šåŠ¨ï¼Œåä¸º``Computed
variables''çš„éƒ¨åˆ†è¯´æ˜å®ƒè®¡ç®—äº†ä¸¤ä¸ªæ–°å˜é‡ï¼š\texttt{count}å’Œ\texttt{prop}ã€‚

æ¯ä¸ª\texttt{geom}éƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„ç»Ÿè®¡å˜æ¢ï¼›æ¯ä¸ªç»Ÿè®¡å˜æ¢ä¹Ÿæœ‰ä¸€ä¸ªé»˜è®¤çš„\texttt{geom}ã€‚è¿™
æ„å‘³ç€ä½ é€šå¸¸å¯ä»¥ä½¿ç”¨\texttt{geoms}è€Œä¸ç”¨æ‹…å¿ƒåº•å±‚çš„ç»Ÿè®¡å˜æ¢ã€‚ç„¶
è€Œï¼Œåœ¨ä¸‰ç§æƒ…å†µä¸‹ä½ å¯èƒ½éœ€è¦æŒ‡æ˜ä½¿ç”¨ä½•ç§ç»Ÿè®¡å˜æ¢ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ä½ å¯èƒ½æƒ³è¦è¦†ç›–é»˜è®¤çš„ç»Ÿè®¡å˜æ¢ã€‚åœ¨
  ä¸‹é¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†\texttt{geom\_bar()}çš„ç»Ÿè®¡å˜æ¢ä»é»˜è®¤çš„countæ›´æ”¹ä¸ºidentityã€‚è¿™
  æ ·æˆ‘ä»¬å°±å¯ä»¥å°†æ¡å½¢çš„é«˜åº¦æ˜ å°„åˆ° y å˜é‡çš„åŸå§‹å€¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{count}\NormalTok{(cut) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cut, }\AttributeTok{y =}\NormalTok{ n)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \includegraphics[width=18.75in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-30-1.pdf}
\item
  ä½ å¯èƒ½æƒ³è¦è¦†ç›–ä»å˜æ¢åçš„å˜é‡åˆ°è§†è§‰å±æ€§çš„é»˜è®¤æ˜ å°„ã€‚ä¾‹
  å¦‚ï¼Œä½ å¯èƒ½æƒ³è¦æ˜¾ç¤ºä¸€ä¸ªæ¯”ä¾‹æ¡å½¢å›¾ï¼Œè€Œä¸æ˜¯è®¡æ•°æ¡å½¢å›¾ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cut, }\AttributeTok{y =} \FunctionTok{after\_stat}\NormalTok{(prop), }\AttributeTok{group =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_bar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

  \includegraphics[width=18.75in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-31-1.pdf}

  è¦æ‰¾åˆ°å¯ä»¥ç”±ç»Ÿè®¡å˜æ¢è®¡ç®—çš„å¯èƒ½çš„å˜é‡ï¼Œè¯·åœ¨\texttt{geom\_bar()}çš„å¸®åŠ©æ–‡æ¡£ä¸­å¯»æ‰¾æ ‡é¢˜ä¸º``computed
  variables''çš„éƒ¨åˆ†ã€‚
\item
  ä½ å¯èƒ½å¸Œæœ›åœ¨ä½ çš„ä»£ç ä¸­æ›´åŠ å…³æ³¨ç»Ÿè®¡å˜æ¢ã€‚ä¾‹
  å¦‚ä½ å¯èƒ½ä½¿ç”¨\texttt{stat\_summary()}ï¼Œå®ƒå¯¹æ¯ä¸ªå”¯ä¸€çš„ x å€¼æ±‡æ€» y
  å€¼ï¼Œä»¥æ­¤æ¥å¼ºè°ƒä½ æ­£åœ¨è®¡ç®—çš„æ±‡æ€»ç»Ÿè®¡é‡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(diamonds) }\SpecialCharTok{+} 
  \FunctionTok{stat\_summary}\NormalTok{(}
    \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cut, }\AttributeTok{y =}\NormalTok{ depth),}
    \AttributeTok{fun.min =}\NormalTok{ min,}
    \AttributeTok{fun.max =}\NormalTok{ max,}
    \AttributeTok{fun =}\NormalTok{ median}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

  \includegraphics[width=18.75in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-32-1.pdf}
\end{enumerate}

ggplot2 æä¾›äº†è¶…è¿‡ 20 ç§ç»Ÿè®¡å˜æ¢ã€‚æ¯
ä¸ªç»Ÿè®¡å˜æ¢éƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥ä½ å¯ä»¥é€šè¿‡å¸¸è§„æ–¹å¼è·å–å¸®åŠ©ï¼Œä¾‹å¦‚ä½¿ç”¨\texttt{?stat\_bin}ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-15}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \texttt{stat\_summary()}çš„é»˜è®¤\texttt{geom}æ˜¯ä»€ä¹ˆï¼Ÿå¦‚
  ä½•ä½¿ç”¨è¿™ä¸ª\texttt{geom}å‡½æ•°è€Œä¸æ˜¯\texttt{stat}å‡½æ•°æ¥é‡å†™å‰é¢çš„å›¾å½¢ï¼Ÿ
\item
  \texttt{geom\_col()}æ˜¯åšä»€ä¹ˆçš„ï¼Ÿå®ƒ ä¸\texttt{geom\_bar()}æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ
\item
  å¤§å¤šæ•°geomså’Œstatséƒ½æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œå®ƒä»¬å‡ ä¹æ€»æ˜¯ååŒå·¥ä½œã€‚è¯·
  åˆ—å‡ºæ‰€æœ‰è¿™äº›å¯¹å­ã€‚å®ƒ ä»¬æœ‰ä»€ä¹ˆå…±åŒç‚¹ï¼Ÿï¼ˆ æç¤ºï¼šé˜…è¯»æ–‡æ¡£ã€‚ï¼‰
\item
  \texttt{stat\_smooth()}å‡½æ•°è®¡ç®—å“ªäº›å˜é‡ï¼Ÿå“ª äº›å‚æ•°æ§åˆ¶å…¶è¡Œä¸ºï¼Ÿ
\item
  åœ¨æˆ‘ä»¬çš„æ¯”ä¾‹æ¡å½¢å›¾ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®\texttt{group\ =\ 1}ã€‚ä¸º ä»€ä¹ˆå‘¢ï¼Ÿæ¢
  å¥è¯è¯´ï¼Œè¿™ä¸¤ä¸ªå›¾æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cut, }\AttributeTok{y =} \FunctionTok{after\_stat}\NormalTok{(prop))) }\SpecialCharTok{+} 
  \FunctionTok{geom\_bar}\NormalTok{()}
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cut, }\AttributeTok{fill =}\NormalTok{ color, }\AttributeTok{y =} \FunctionTok{after\_stat}\NormalTok{(prop))) }\SpecialCharTok{+} 
  \FunctionTok{geom\_bar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{ä½ç½®è°ƒæ•´}\label{ux4f4dux7f6eux8c03ux6574}

ä¸æ¡å½¢å›¾ç›¸å…³çš„è¿˜æœ‰ä¸€ä¸ªç¥å¥‡çš„ç‰¹æ€§ã€‚ä½  å¯ä»¥ä½¿ç”¨é¢œè‰²ç¾å­¦ï¼ˆcolor
aestheticï¼‰æ¥ä¸ºæ¡å½¢å›¾ä¸Šè‰²ï¼Œä½†æ›´æœ‰ç”¨çš„æ˜¯ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨å¡«å……ç¾å­¦ï¼ˆfill
aestheticï¼‰æ¥ä¸ºæ¡å½¢å›¾ä¸Šè‰²ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Left}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ drv, }\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_bar}\NormalTok{()}

\CommentTok{\# Right}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ drv, }\AttributeTok{fill =}\NormalTok{ drv)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_bar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-34-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-34-2.pdf}\end{minipage}%

\end{figure}%

è¯·æ³¨æ„ï¼Œå¦‚æœä½ å°†å¡«å……ç¾å­¦æ˜ å°„åˆ°å¦ä¸€ä¸ªå˜é‡ï¼Œæ¯”å¦‚\texttt{class}ï¼Œæ¡å½¢å›¾ä¼šè‡ªåŠ¨å †å ã€‚æ¯
ä¸ªå½©è‰²çŸ©å½¢ä»£è¡¨\texttt{drv}å’Œ\texttt{class}çš„ä¸€ä¸ªç»„åˆã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ drv, }\AttributeTok{fill =}\NormalTok{ class)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_bar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-35-1.pdf}

å †å æ˜¯é€šè¿‡ç”±\texttt{position}å‚æ•°æŒ‡å®šçš„ä½ç½®è°ƒæ•´ï¼ˆposition
adjustmentï¼‰è‡ªåŠ¨æ‰§è¡Œçš„ã€‚å¦‚
æœä½ ä¸æƒ³åˆ›å»ºå †å æ¡å½¢å›¾ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸‰ç§é€‰é¡¹ä¹‹ä¸€ï¼š\texttt{"identity"}ã€\texttt{"dodge"}
æˆ– \texttt{"fill"}ã€‚

\begin{itemize}
\item
  \texttt{position\ =\ "identity"}ä¼šå°†æ¯ä¸ªå¯¹è±¡ç²¾ç¡®åœ°æ”¾ç½®åœ¨å…¶åœ¨å›¾ä¸­çš„ä½ç½®ã€‚è¿™
  å¯¹äºæ¡å½¢å›¾æ¥è¯´ä¸æ˜¯å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒä¼šä½¿å®ƒä»¬é‡å ã€‚ä¸º
  äº†çœ‹åˆ°è¿™ç§é‡å ï¼Œæˆ‘ä»¬éœ€è¦å°†æ¡å½¢è®¾ç½®ä¸ºç¨å¾®é€æ˜ï¼Œé€šè¿‡å°†\texttt{alpha}è®¾ç½®ä¸ºä¸€ä¸ªå°å€¼ï¼Œæˆ–è€…é€šè¿‡è®¾ç½®\texttt{fill\ =\ NA}ä½¿å…¶å®Œå…¨é€æ˜ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Left}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ drv, }\AttributeTok{fill =}\NormalTok{ class)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{alpha =} \DecValTok{1}\SpecialCharTok{/}\DecValTok{5}\NormalTok{, }\AttributeTok{position =} \StringTok{"identity"}\NormalTok{)}

\CommentTok{\# Right}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ drv, }\AttributeTok{color =}\NormalTok{ class)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{fill =} \ConstantTok{NA}\NormalTok{, }\AttributeTok{position =} \StringTok{"identity"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \begin{figure}

  \begin{minipage}{0.50\linewidth}
  \includegraphics[width=12.5in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-36-1.pdf}\end{minipage}%
  %
  \begin{minipage}{0.50\linewidth}
  \includegraphics[width=12.5in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-36-2.pdf}\end{minipage}%

  \end{figure}%

  \texttt{â€œidentityâ€}ä½ç½®è°ƒæ•´å¯¹äºäºŒç»´å‡ ä½•å¯¹è±¡ï¼ˆå¦‚ç‚¹ï¼‰æ›´ä¸ºæœ‰ç”¨ï¼Œå®ƒæ˜¯è¿™äº›å¯¹è±¡çš„é»˜è®¤è®¾ç½®ã€‚
\item
  \texttt{position\ =\ "fill"}
  çš„ä½œç”¨ç±»ä¼¼äºå †å ï¼Œä½†ä¼šä½¿æ¯ç»„å †å çš„æ¡å½¢å…·æœ‰ç›¸åŒçš„é«˜åº¦ã€‚è¿™
  ä½¿å¾—æ¯”è¾ƒå„ç»„ä¹‹é—´çš„æ¯”ä¾‹æ›´å®¹æ˜“ã€‚
\item
  \texttt{position\ =\ "dodge"}
  å°†é‡å çš„å¯¹è±¡ç›´æ¥å¹¶æ’æ”¾ç½®ï¼Œè¿™ä½¿å¾—æ¯”è¾ƒå„ä¸ªå€¼æ›´å®¹æ˜“ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Left}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ drv, }\AttributeTok{fill =}\NormalTok{ class)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"fill"}\NormalTok{)}

\CommentTok{\# Right}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ drv, }\AttributeTok{fill =}\NormalTok{ class)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  \begin{figure}

  \begin{minipage}{0.50\linewidth}
  \includegraphics[width=12.5in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-37-1.pdf}\end{minipage}%
  %
  \begin{minipage}{0.50\linewidth}
  \includegraphics[width=12.5in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-37-2.pdf}\end{minipage}%

  \end{figure}%
\end{itemize}

è¿˜æœ‰ä¸€ç§è°ƒæ•´ä¸é€‚ç”¨äºæ¡å½¢å›¾ï¼Œä½†å¯¹æ•£ç‚¹å›¾éå¸¸æœ‰ç”¨ã€‚å›
æƒ³æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ•£ç‚¹å›¾ã€‚ä½ 
æœ‰æ²¡æœ‰æ³¨æ„åˆ°ï¼Œå°½ç®¡æ•°æ®é›†ä¸­æœ‰234ä¸ªè§‚æµ‹å€¼ï¼Œä½†å›¾ä¸­åªæ˜¾ç¤ºäº†126ä¸ªç‚¹ï¼Ÿ

\includegraphics[width=18.75in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-38-1.pdf}

\texttt{hwy}å’Œ\texttt{displ}çš„åŸºç¡€å€¼è¢«å››èˆäº”å…¥ï¼Œå› æ­¤ç‚¹æ˜¾ç¤ºåœ¨ä¸€ä¸ªç½‘æ ¼ä¸Šï¼Œè®¸å¤šç‚¹äº’ç›¸é‡å ã€‚è¿™
ä¸ªé—®é¢˜è¢«ç§°ä¸ºè¿‡åº¦ç»˜åˆ¶ï¼ˆoverplottingï¼‰ã€‚è¿™
ç§å¸ƒå±€ä½¿å¾—å¾ˆéš¾çœ‹åˆ°æ•°æ®çš„åˆ†å¸ƒã€‚æ•°
æ®ç‚¹åœ¨æ•´ä¸ªå›¾ä¸­æ˜¯å‡åŒ€åˆ†å¸ƒçš„å—ï¼Œè¿˜æ˜¯\texttt{hwy}å’Œ\texttt{displ}çš„æŸä¸ªç‰¹æ®Šç»„åˆåŒ…å«äº†109ä¸ªå€¼ï¼Ÿ

ä½ å¯ä»¥é€šè¿‡è®¾ç½®ä½ç½®è°ƒæ•´ä¸º ``jitter'' æ¥é¿å…è¿™ç§ç½‘æ ¼åŒ–ã€‚\texttt{p}
\texttt{osition\ =\ "jitter"}ä¼šç»™æ¯ä¸ªç‚¹æ·»åŠ ä¸€å°éƒ¨åˆ†éšæœºå™ªå£°ã€‚è¿™
ä¼šå°†ç‚¹åˆ†æ•£å¼€æ¥ï¼Œå› ä¸ºä¸¤ä¸ªç‚¹ä¸å¤ªå¯èƒ½è·å¾—ç›¸åŒæ•°é‡çš„éšæœºå™ªå£°ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position =} \StringTok{"jitter"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-39-1.pdf}

æ·»åŠ éšæœºæ€§ä¼¼ä¹æ˜¯ä¸€ç§å¥‡æ€ªçš„æ”¹è¿›å›¾è¡¨çš„æ–¹å¼ï¼Œä½†å°½ç®¡å®ƒåœ¨å°èŒƒå›´å†…é™ä½äº†å›¾å½¢çš„å‡†ç¡®æ€§ï¼Œä½†åœ¨å¤§èŒƒå›´å†…å´ä½¿å›¾å½¢æ›´æ¸…æ™°ã€‚ç”±
äºè¿™æ˜¯ä¸€ç§éå¸¸æœ‰ç”¨çš„æ“ä½œï¼Œggplot2
ä¸º\texttt{geom\_point(position\ =\ "jitter")}æä¾›äº†ä¸€ä¸ªç®€å†™å½¢å¼ï¼š\texttt{geom\_jitter()}ã€‚

è¦äº†è§£æ›´å¤šå…³äºä½ç½®è°ƒæ•´çš„ä¿¡æ¯ï¼Œè¯·æŸ¥é˜…ä¸æ¯ä¸ªè°ƒæ•´ç›¸å…³çš„å¸®åŠ©é¡µé¢ï¼š\texttt{?position\_dodge}ã€\texttt{?position\_fill}ã€\texttt{?position\_identity}ã€\texttt{?position\_jitter}~å’Œ~\texttt{?position\_stack}ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-16}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ä¸‹é¢çš„å›¾æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿå¦‚ ä½•æ”¹è¿›å®ƒï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cty, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}
\item
  è¿™ä¸¤ä¸ªå›¾ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Ÿä¸º ä»€ä¹ˆï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{position =} \StringTok{"identity"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  \texttt{geom\_jitter()}ä¸­çš„å“ªäº›å‚æ•°æ§åˆ¶æŠ–åŠ¨é‡ï¼ˆamount of jitteringï¼‰ï¼Ÿ
\item
  å°†\texttt{geom\_jitter()}ä¸\texttt{geom\_count()}è¿›è¡Œæ¯”è¾ƒå’Œå¯¹æ¯”ã€‚
\item
  \texttt{geom\_boxplot()}çš„é»˜è®¤ä½ç½®è°ƒæ•´æ˜¯ä»€ä¹ˆï¼Ÿä½¿ ç”¨ \texttt{mpg}
  æ•°æ®é›†åˆ›å»ºä¸€ä¸ªå¯è§†åŒ–æ¥å±•ç¤ºå®ƒã€‚
\end{enumerate}

\section{åæ ‡ç³»}\label{ux5750ux6807ux7cfb}

åæ ‡ç³»å¯èƒ½æ˜¯ ggplot2 ä¸­æœ€å¤æ‚çš„éƒ¨åˆ†ã€‚é»˜ è®¤çš„åæ ‡ç³»æ˜¯ç¬›å¡å°”åæ ‡ç³»ï¼Œå…¶ä¸­ x
å’Œ y ä½ç½®ç‹¬ç«‹åœ°ç¡®å®šæ¯ä¸ªç‚¹çš„ä½ç½®ã€‚è¿˜
æœ‰å¦å¤–ä¸¤ç§åæ ‡ç³»åœ¨æŸäº›æƒ…å†µä¸‹ä¹Ÿå¾ˆæœ‰ç”¨ã€‚

\begin{itemize}
\item
  \texttt{coord\_quickmap()}ä¸ºåœ°ç†åœ°å›¾è®¾ç½®äº†æ­£ç¡®çš„çºµæ¨ªæ¯”ã€‚å¦‚ æœä½ ä½¿ç”¨
  ggplot2 ç»˜åˆ¶ç©ºé—´æ•°æ®ï¼Œè¿™ä¸€ç‚¹éå¸¸é‡è¦ã€‚æœ¬
  ä¹¦ä¸­æ²¡æœ‰ç©ºé—´è®¨è®ºåœ°å›¾ï¼Œä½†ä½ å¯ä»¥åœ¨ã€Š\emph{ggplot2: Elegant graphics for
  data analysis}ã€‹ä¸€ä¹¦çš„\href{https://ggplot2-book.org/maps.html}{Maps
  chapter} ä¸­äº†è§£æ›´å¤šä¿¡æ¯ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nz }\OtherTok{\textless{}{-}} \FunctionTok{map\_data}\NormalTok{(}\StringTok{"nz"}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(nz, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ long, }\AttributeTok{y =}\NormalTok{ lat, }\AttributeTok{group =}\NormalTok{ group)) }\SpecialCharTok{+}
  \FunctionTok{geom\_polygon}\NormalTok{(}\AttributeTok{fill =} \StringTok{"white"}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(nz, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ long, }\AttributeTok{y =}\NormalTok{ lat, }\AttributeTok{group =}\NormalTok{ group)) }\SpecialCharTok{+}
  \FunctionTok{geom\_polygon}\NormalTok{(}\AttributeTok{fill =} \StringTok{"white"}\NormalTok{, }\AttributeTok{color =} \StringTok{"black"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{coord\_quickmap}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

  \begin{figure}

  \begin{minipage}{0.50\linewidth}
  \includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-42-1.pdf}\end{minipage}%
  %
  \begin{minipage}{0.50\linewidth}
  \includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-42-2.pdf}\end{minipage}%

  \end{figure}%
\item
  \texttt{coord\_polar()} ä½¿ç”¨æåæ ‡ç³»ã€‚æ
  åæ ‡ç³»æ­ç¤ºäº†æ¡å½¢å›¾å’Œæ‰‡å½¢å›¾ï¼ˆCoxcomb chartï¼‰ä¹‹é—´ä¸€ä¸ªæœ‰è¶£çš„è”ç³»ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bar }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ diamonds) }\SpecialCharTok{+} 
  \FunctionTok{geom\_bar}\NormalTok{(}
    \AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ clarity, }\AttributeTok{fill =}\NormalTok{ clarity), }
    \AttributeTok{show.legend =} \ConstantTok{FALSE}\NormalTok{,}
    \AttributeTok{width =} \DecValTok{1}
\NormalTok{  ) }\SpecialCharTok{+} 
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{aspect.ratio =} \DecValTok{1}\NormalTok{)}

\NormalTok{bar }\SpecialCharTok{+} \FunctionTok{coord\_flip}\NormalTok{()}
\NormalTok{bar }\SpecialCharTok{+} \FunctionTok{coord\_polar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

  \begin{figure}

  \begin{minipage}{0.50\linewidth}
  \includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-43-1.pdf}\end{minipage}%
  %
  \begin{minipage}{0.50\linewidth}
  \includegraphics[width=9.375in,height=\textheight]{layers_files/figure-pdf/unnamed-chunk-43-2.pdf}\end{minipage}%

  \end{figure}%
\end{itemize}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-17}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ä½¿ç”¨\texttt{coord\_polar()}å°†å †å çš„æ¡å½¢å›¾è½¬æ¢ä¸ºé¥¼çŠ¶å›¾ã€‚
\item
  \texttt{coord\_quickmap()} å’Œ \texttt{coord\_map()} ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ
\item
  ä¸‹å›¾å‘Šè¯‰ä½ cityå’Œé«˜é€Ÿå…¬è·¯mpgä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿä¸º
  ä»€ä¹ˆ\texttt{coord\_fixed()}å¾ˆé‡è¦ï¼Ÿ\texttt{g}
  \texttt{eom\_abline()}çš„ä½œç”¨ä»€ä¹ˆï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ mpg, }\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cty, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{geom\_abline}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{coord\_fixed}\NormalTok{()}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{å›¾å½¢çš„åˆ†å±‚è¯­æ³•}\label{ux56feux5f62ux7684ux5206ux5c42ux8bedux6cd5}

æˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ ä½ç½®è°ƒæ•´ã€ç»Ÿè®¡é‡ã€åæ ‡ç³»å’Œåˆ†é¢æ¥æ‰©å±•ä½ åœ¨@sec-ggplot2-calls
å­¦åˆ°çš„ç»˜å›¾æ¨¡æ¿ï¼š

\begin{verbatim}
ggplot(data = <DATA>) + 
  <GEOM_FUNCTION>(
     mapping = aes(<MAPPINGS>),
     stat = <STAT>, 
     position = <POSITION>
  ) +
  <COORDINATE_FUNCTION> +
  <FACET_FUNCTION>
\end{verbatim}

æˆ‘ä»¬çš„æ–°æ¨¡æ¿éœ€è¦ä¸ƒä¸ªå‚æ•°ï¼Œå³æ¨¡æ¿ä¸­å‡ºç°çš„æ‹¬å·ä¸­çš„è¯ã€‚åœ¨
å®è·µä¸­ï¼Œä½ å¾ˆå°‘éœ€è¦ä¸ºåˆ¶ä½œå›¾å½¢æä¾›æ‰€æœ‰ä¸ƒä¸ªå‚æ•°ï¼Œå› ä¸º ggplot2
ä¼šä¸ºé™¤äº†æ•°æ®ã€æ˜ å°„å’Œ geom å‡½æ•°ä¹‹å¤–çš„æ‰€æœ‰å†…å®¹æä¾›æœ‰ç”¨çš„é»˜è®¤å€¼ã€‚

æ¨¡æ¿ä¸­çš„ä¸ƒä¸ªå‚æ•°æ„æˆäº†å›¾å½¢çš„è¯­æ³•ï¼ˆgrammar of
graphicsï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºå›¾å½¢çš„æ­£å¼ç³»ç»Ÿã€‚å›¾
å½¢çš„è¯­æ³•åŸºäºè¿™æ ·ä¸€ä¸ªè§è§£ï¼šä½ å¯ä»¥å°†ä»»ä½•å›¾å½¢å”¯ä¸€åœ°æè¿°ä¸ºæ•°æ®é›†ã€geomã€ä¸€ç»„æ˜ å°„ã€ç»Ÿè®¡é‡ã€ä½ç½®è°ƒæ•´ã€åæ ‡ç³»ã€åˆ†é¢æ–¹æ¡ˆå’Œä¸»é¢˜çš„ç»„åˆã€‚

ä¸ºäº†äº†è§£è¿™æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè¯·è€ƒè™‘å¦‚ä½•ä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ªåŸºæœ¬çš„å›¾å½¢ï¼šä½ å¯ä»¥ä»ä¸€ä¸ªæ•°æ®é›†å¼€å§‹ï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºä½ æƒ³è¦æ˜¾ç¤ºçš„ä¿¡æ¯ï¼ˆä½¿ç”¨ç»Ÿè®¡é‡ï¼‰ã€‚æ¥
ä¸‹æ¥ï¼Œä½ å¯ä»¥é€‰æ‹©ä¸€ä¸ªå‡ ä½•å¯¹è±¡æ¥è¡¨ç¤ºè½¬æ¢åæ•°æ®ä¸­çš„æ¯ä¸ªè§‚æµ‹å€¼ã€‚ç„¶
åï¼Œä½ å¯ä»¥ä½¿ç”¨ geom çš„ç¾å­¦å±æ€§æ¥è¡¨ç¤ºæ•°æ®ä¸­çš„å˜é‡ã€‚ä½ 
å¯ä»¥å°†æ¯ä¸ªå˜é‡çš„å€¼æ˜ å°„åˆ°ç¾å­¦çš„æ°´å¹³ã€‚è¿™ äº›æ­¥éª¤åœ¨
å›¾~\ref{fig-visualization-grammar} ä¸­è¿›è¡Œäº†è¯´æ˜ã€‚ç„¶
åï¼Œä½ ä¼šé€‰æ‹©ä¸€ä¸ªåæ ‡ç³»æ¥æ”¾ç½®
geomï¼Œä½¿ç”¨å¯¹è±¡çš„ä½ç½®ï¼ˆå®ƒæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªç¾å­¦å±æ€§ï¼‰æ¥æ˜¾ç¤º x å’Œ y å˜é‡çš„å€¼ã€‚

\begin{figure}

\centering{

\includegraphics[width=4.44in,height=\textheight]{images/visualization-grammar.png}

}

\caption{\label{fig-visualization-grammar}Steps for going from raw data
to a table of frequencies to a bar plot where the heights of the bar
represent the frequencies.}

\end{figure}%

åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œä½ å°†æ‹¥æœ‰ä¸€ä¸ªå®Œæ•´çš„å›¾å½¢ï¼Œä½†ä½ å¯ä»¥è¿›ä¸€æ­¥è°ƒæ•´ geom
åœ¨åæ ‡ç³»å†…çš„ä½ç½®ï¼ˆä½ç½®è°ƒæ•´ï¼‰æˆ–å°†å›¾å½¢æ‹†åˆ†ä¸ºå­å›¾ï¼ˆåˆ†é¢ï¼‰ã€‚ä½ 
è¿˜å¯ä»¥é€šè¿‡æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªé™„åŠ å±‚æ¥æ‰©å±•å›¾å½¢ï¼Œå…¶ä¸­æ¯ä¸ªé™„åŠ å±‚éƒ½ä½¿ç”¨æ•°æ®é›†ã€geomã€ä¸€ç»„æ˜ å°„ã€ç»Ÿè®¡é‡å’Œä½ç½®è°ƒæ•´ã€‚

ä½ å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹æ³•æ¥æ„å»ºä½ æƒ³è±¡ä¸­çš„ä»»ä½•å›¾å½¢ã€‚æ¢
å¥è¯è¯´ï¼Œä½ å¯ä»¥ä½¿ç”¨æœ¬ç« ä¸­å­¦ä¹ çš„ä»£ç æ¨¡æ¿æ¥æ„å»ºæ•°åä¸‡ä¸ªç‹¬ç‰¹çš„å›¾å½¢ã€‚

å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº ggplot2
çš„ç†è®ºåŸºç¡€ï¼Œä½ å¯èƒ½ä¼šå–œæ¬¢é˜…è¯»ã€Š\href{https://vita.had.co.nz/papers/layered-grammar.pdf}{The
Layered Grammar of Graphics}ã€‹è¿™ç¯‡ç§‘å­¦è®ºæ–‡ï¼Œå®ƒè¯¦ç»†æè¿°äº† ggplot2
çš„ç†è®ºã€‚

\section{å°ç»“}\label{ux5c0fux7ed3-8}

åœ¨æœ¬ç« ä¸­ï¼Œä½ ä»ç¾å­¦å’Œå‡ ä½•å›¾å½¢å¼€å§‹å­¦ä¹ äº†å›¾å½¢çš„åˆ†å±‚è¯­æ³•ï¼Œä»¥æ„å»ºç®€å•çš„å›¾å½¢ã€é€šè¿‡åˆ†é¢å°†å›¾å½¢æ‹†åˆ†ä¸ºå­é›†ã€é€šè¿‡ç»Ÿè®¡é‡äº†è§£
geom æ˜¯å¦‚ä½•è®¡ç®—çš„ã€é€šè¿‡ä½ç½®è°ƒæ•´æ§åˆ¶ geom
å¯èƒ½é‡å æ—¶çš„ä½ç½®ç»†èŠ‚ï¼Œä»¥åŠé€šè¿‡åæ ‡ç³»ç»Ÿä»æ ¹æœ¬ä¸Šæ”¹å˜ x å’Œ y çš„å«ä¹‰ã€‚æˆ‘
ä»¬å°šæœªæ¶‰åŠçš„ä¸€ä¸ªå±‚æ¬¡æ˜¯ä¸»é¢˜ï¼ˆthemeï¼‰ï¼Œæˆ‘ä»¬å°†åœ¨ å°èŠ‚~\ref{sec-themes}
ä¸­ä»‹ç»ã€‚

ä¸¤ä¸ªéå¸¸æœ‰ç”¨çš„èµ„æºå¯ä»¥å¸®åŠ©ä½ å…¨é¢äº†è§£ ggplot2 çš„å®Œæ•´åŠŸèƒ½ï¼Œåˆ†åˆ«æ˜¯ ggplot2
é€ŸæŸ¥è¡¨ï¼ˆä½ å¯ä»¥åœ¨\url{https://posit.co/resources/cheatsheets}æ‰¾åˆ°ï¼‰å’Œ
ggplot2 åŒ…ç½‘ç«™ï¼ˆ\url{https://ggplot2.tidyverse.org}./)ï¼‰ã€‚

ä½ åº”è¯¥ä»æœ¬ç« ä¸­å­¦åˆ°çš„ä¸€ä¸ªé‡è¦æ•™è®­æ˜¯ï¼Œå½“ä½ è§‰å¾—éœ€è¦ ggplot2 æ²¡æœ‰æä¾›çš„ geom
æ—¶ï¼Œæœ€å¥½å…ˆæŸ¥çœ‹æ˜¯å¦æœ‰äººå·²ç»é€šè¿‡åˆ›å»ºæä¾›è¯¥ geom çš„ ggplot2
æ‰©å±•åŒ…æ¥è§£å†³äº†ä½ çš„é—®é¢˜ã€‚

\chapter{æ¢ç´¢æ€§æ•°æ®åˆ†æ}\label{sec-exploratory-data-analysis}

\section{å¼•è¨€}\label{ux5f15ux8a00-5}

æœ¬ç« å°†å‘ä½ å±•ç¤ºå¦‚ä½•ç³»ç»Ÿåœ°ä½¿ç”¨å¯è§†åŒ–å’Œè½¬æ¢æ¥æ¢ç´¢æ•°æ®ï¼Œè¿™é¡¹ä»»åŠ¡è¢«ç»Ÿè®¡å­¦å®¶ç§°ä¸ºæ¢ç´¢æ€§æ•°æ®åˆ†æï¼ˆExploratory
Data Analysisï¼Œç®€ç§°EDAï¼‰ã€‚E DAæ˜¯ä¸€ä¸ªè¿­ä»£å¾ªç¯çš„è¿‡ç¨‹ã€‚ä½  éœ€è¦ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  å¯¹ä½ çš„æ•°æ®äº§ç”Ÿç–‘é—®ã€‚
\item
  é€šè¿‡æ•°æ®å¯è§†åŒ–ã€è½¬æ¢å’Œå»ºæ¨¡æ¥å¯»æ‰¾ç­”æ¡ˆã€‚
\item
  åˆ©ç”¨æ‰€å­¦çš„çŸ¥è¯†æ¥å®Œå–„ä½ çš„é—®é¢˜æˆ–è€…äº§ç”Ÿæ–°çš„é—®é¢˜ã€‚
\end{enumerate}

EDAå¹¶ä¸æ˜¯ä¸€ä¸ªæœ‰ç€ä¸¥æ ¼è§„åˆ™çš„æ­£å¼æµç¨‹ï¼Œå…¶æ›´å¤šçš„æ˜¯ä¸€ç§æ€ç»´æ–¹å¼ã€‚åœ¨
EDAçš„åˆå§‹é˜¶æ®µï¼Œä½ åº”è¯¥è‡ªç”±åœ°è°ƒæŸ¥ä»»ä½•å‡ºç°åœ¨ä½ è„‘æµ·ä¸­çš„æƒ³æ³•ã€‚è¿™
äº›æƒ³æ³•ä¸­çš„ä¸€äº›ä¼šæˆåŠŸï¼Œè€Œä¸€äº›åˆ™ä¼šæ˜¯æ­»èƒ¡åŒã€‚éš
ç€ä½ çš„æ¢ç´¢ç»§ç»­ï¼Œä½ å°†ä¸“æ³¨äºä¸€äº›ç‰¹åˆ«æœ‰æ•ˆçš„è§è§£ï¼Œå¹¶æœ€ç»ˆå°†å…¶è®°å½•ä¸‹æ¥å¹¶ä¸ä»–äººäº¤æµã€‚

EDAæ˜¯ä»»ä½•æ•°æ®åˆ†æçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå³ä½¿ä¸»è¦çš„ç ”ç©¶é—®é¢˜å·²ç»è¢«ç›´æ¥æå‡ºï¼Œå› ä¸ºä½ æ€»æ˜¯éœ€è¦è°ƒæŸ¥ä½ çš„æ•°æ®è´¨é‡ã€‚æ•°
æ®æ¸…æ´—åªæ˜¯EDAçš„ä¸€ä¸ªåº”ç”¨ï¼šä½ é—®çš„é—®é¢˜æ˜¯æ•°æ®æ˜¯å¦ç¬¦åˆä½ çš„æœŸæœ›ã€‚ä¸º
äº†è¿›è¡Œæ•°æ®æ¸…æ´—ï¼Œä½ éœ€è¦è¿ç”¨EDAçš„æ‰€æœ‰å·¥å…·ï¼šå¯è§†åŒ–ã€è½¬æ¢å’Œå»ºæ¨¡ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-5}

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ç»“åˆä½ å­¦åˆ°çš„å…³äºdplyrå’Œggplot2çš„çŸ¥è¯†ï¼Œä»¥äº¤äº’çš„æ–¹å¼æå‡ºé—®é¢˜ï¼Œç”¨æ•°æ®æ¥å›ç­”é—®é¢˜ï¼Œç„¶åæå‡ºæ–°çš„é—®é¢˜ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\section{é—®é¢˜}\label{ux95eeux9898}

\begin{quote}
``æ²¡æœ‰å¸¸è§„çš„ç»Ÿè®¡é—®é¢˜ï¼Œåªæœ‰å¯ç–‘çš„ç»Ÿè®¡å¸¸è§„ã€‚'' --- Sir David Cox
\end{quote}

\begin{quote}
``ä¸€ä¸ªå¯¹æ­£ç¡®é—®é¢˜çš„è¿‘ä¼¼ç­”æ¡ˆï¼ˆè¿™ä¸ªé—®é¢˜å¸¸å¸¸æ˜¯æ¨¡ç³Šçš„ï¼‰è¿œèƒœäºä¸€ä¸ªå¯¹é”™è¯¯é—®é¢˜çš„ç²¾ç¡®ç­”æ¡ˆï¼ˆè¿™ä¸ªé—®é¢˜æ€»æ˜¯å¯ä»¥ç²¾ç¡®åŒ–çš„ï¼‰ã€‚''
--- John Tukey
\end{quote}

åœ¨EDAæœŸé—´ï¼Œä½ çš„ç›®æ ‡æ˜¯äº†è§£ä½ çš„æ•°æ®ã€‚è¦
åšåˆ°è¿™ä¸€ç‚¹ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯å°†é—®é¢˜ä½œä¸ºå·¥å…·æ¥æŒ‡å¯¼ä½ çš„è°ƒæŸ¥ã€‚å½“
ä½ æå‡ºä¸€ä¸ªé—®é¢˜æ—¶ï¼Œè¿™ä¸ªé—®é¢˜ä¼šå°†ä½ çš„æ³¨æ„åŠ›é›†ä¸­åœ¨æ•°æ®é›†çš„ç‰¹å®šéƒ¨åˆ†ä¸Šï¼Œå¹¶å¸®åŠ©ä½ å†³å®šåˆ¶ä½œå“ªäº›å›¾å½¢ã€æ¨¡å‹æˆ–è½¬æ¢ã€‚

EDAæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåˆ›é€ æ€§çš„è¿‡ç¨‹ã€‚å’Œ
å¤§å¤šæ•°åˆ›é€ æ€§è¿‡ç¨‹ä¸€æ ·ï¼Œæå‡ºé«˜è´¨é‡é—®é¢˜çš„å…³é”®æ˜¯ç”Ÿæˆå¤§é‡é—®é¢˜ã€‚åœ¨
ä½ çš„åˆ†æå¼€å§‹æ—¶ï¼Œå¾ˆéš¾æå‡ºæœ‰å¯ç¤ºæ€§çš„é—®é¢˜ï¼Œå› ä¸ºä½ ä¸çŸ¥é“å¯ä»¥ä»æ•°æ®é›†ä¸­è·å–å“ªäº›è§è§£ã€‚å¦
ä¸€æ–¹é¢ï¼Œä½ æå‡ºçš„æ¯ä¸€ä¸ªæ–°é—®é¢˜éƒ½ä¼šè®©ä½ äº†è§£æ•°æ®çš„ä¸€ä¸ªæ–°æ–¹é¢ï¼Œå¹¶å¢åŠ ä½ å‘ç°æ–°äº‹ç‰©çš„æœºä¼šã€‚å¦‚
æœä½ æ ¹æ®æ‰€å‘ç°çš„å†…å®¹ï¼Œé’ˆå¯¹æ¯ä¸ªé—®é¢˜éƒ½æå‡ºä¸€ä¸ªæ–°é—®é¢˜ï¼Œä½ å°±èƒ½è¿…é€Ÿæ·±å…¥æ•°æ®ä¸­æœ€æœ‰è¶£çš„éƒ¨åˆ†ï¼Œå¹¶å¼€å‘å‡ºä¸€ç³»åˆ—å¼•äººæ·±æ€çš„é—®é¢˜ã€‚

æ²¡æœ‰è§„å®šä½ åº”è¯¥æå‡ºå“ªäº›é—®é¢˜æ¥æŒ‡å¯¼ä½ çš„ç ”ç©¶ã€‚ç„¶
è€Œï¼Œä¸¤ç§ç±»å‹çš„é—®é¢˜å§‹ç»ˆæœ‰åŠ©äºåœ¨ä½ çš„æ•°æ®ä¸­å‘ç°æ–°äº‹ç‰©ã€‚ä½ 
å¯ä»¥å¤§è‡´åœ°å°†è¿™äº›é—®é¢˜è¡¨è¿°ä¸ºï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  æˆ‘çš„å˜é‡ä¸­å­˜åœ¨ä»€ä¹ˆç±»å‹çš„å˜å¼‚ï¼Ÿ
\item
  æˆ‘çš„å˜é‡ä¹‹é—´å­˜åœ¨ä»€ä¹ˆç±»å‹çš„åå˜ï¼Ÿ
\end{enumerate}

æœ¬ç« çš„å…¶ä½™éƒ¨åˆ†å°†æ¢è®¨è¿™ä¸¤ä¸ªé—®é¢˜ã€‚æˆ‘
ä»¬å°†è§£é‡Šä»€ä¹ˆæ˜¯å˜å¼‚å’Œåå˜ï¼Œå¹¶å‘ä½ å±•ç¤ºå‡ ç§å›ç­”é—®é¢˜çš„æ–¹æ³•ã€‚

\section{å˜å¼‚}\label{ux53d8ux5f02}

å˜å¼‚ï¼ˆvariationï¼‰æ˜¯æŒ‡å˜é‡çš„å€¼ä»ä¸€æ¬¡æµ‹é‡åˆ°å¦ä¸€æ¬¡æµ‹é‡æ—¶å‘ç”Ÿå˜åŒ–çš„è¶‹åŠ¿ã€‚åœ¨
ç°å®ç”Ÿæ´»ä¸­ï¼Œä½ å¾ˆå®¹æ˜“çœ‹åˆ°å˜å¼‚ï¼›å¦‚æœä½ å¯¹ä»»ä½•è¿ç»­å˜é‡è¿›è¡Œä¸¤æ¬¡æµ‹é‡ï¼Œä½ ä¼šå¾—åˆ°ä¸¤ä¸ªä¸åŒçš„ç»“æœã€‚å³
ä½¿ä½ æµ‹é‡çš„æ˜¯åƒå…‰é€Ÿè¿™æ ·çš„å¸¸é‡ï¼Œä¹Ÿæ˜¯å¦‚æ­¤ã€‚ä½ 
çš„æ¯æ¬¡æµ‹é‡éƒ½ä¼šåŒ…å«ä¸€å®šé‡çš„è¯¯å·®ï¼Œè¿™äº›è¯¯å·®ä¼šéšç€æµ‹é‡çš„ä¸åŒè€Œæœ‰æ‰€å˜åŒ–ã€‚å˜
é‡ä¹Ÿå¯èƒ½å› ä¸ºæµ‹é‡å¯¹è±¡çš„ä¸åŒï¼ˆä¾‹å¦‚ï¼Œä¸åŒäººçš„çœ¼ç›é¢œè‰²ï¼‰æˆ–æ—¶é—´çš„ä¸åŒï¼ˆä¾‹å¦‚ï¼Œç”µå­åœ¨ä¸åŒæ—¶åˆ»çš„èƒ½é‡æ°´å¹³ï¼‰è€Œå‘ç”Ÿå˜åŒ–ã€‚æ¯
ä¸ªå˜é‡éƒ½æœ‰è‡ªå·±ç‰¹æœ‰çš„å˜å¼‚æ¨¡å¼ï¼Œè¿™äº›æ¨¡å¼å¯ä»¥æ­ç¤ºå‡ºå…³äºè¯¥å˜é‡åœ¨åŒä¸€è§‚æµ‹å€¼çš„ä¸åŒæµ‹é‡ä¹‹é—´ä»¥åŠä¸åŒè§‚æµ‹å€¼ä¹‹é—´çš„æœ‰è¶£ä¿¡æ¯ã€‚ç†
è§£è¿™ç§æ¨¡å¼çš„æœ€å¥½æ–¹æ³•æ˜¯å¯è§†åŒ–å˜é‡çš„å€¼åˆ†å¸ƒï¼Œè¿™æ˜¯ä½ åœ¨
ç« èŠ‚~\ref{sec-data-visualization} ä¸­å·²ç»å­¦è¿‡çš„å†…å®¹ã€‚

æˆ‘ä»¬å°†é€šè¿‡å¯è§†åŒ–\texttt{diamonds}æ•°æ®é›†ä¸­çº¦54,000é¢—é’»çŸ³çš„é‡é‡ï¼ˆ\texttt{carat}ï¼‰åˆ†å¸ƒæ¥å¼€å§‹æˆ‘ä»¬çš„æ¢ç´¢ã€‚ç”±
äº\texttt{carat}æ˜¯ä¸€ä¸ªæ•°å€¼å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›´æ–¹å›¾æ¥è¡¨ç¤ºã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-3-1.pdf}

æ—¢ç„¶ä½ ç°åœ¨å¯ä»¥å¯è§†åŒ–å˜å¼‚äº†ï¼Œä½ åº”è¯¥åœ¨ä½ çš„å›¾ä¸­å¯»æ‰¾ä»€ä¹ˆï¼Ÿä½ 
åº”è¯¥æå‡ºä»€ä¹ˆç±»å‹çš„åç»­é—®é¢˜ï¼Ÿæˆ‘
ä»¬å·²ç»åœ¨ä¸‹æ–¹åˆ—å‡ºäº†ä½ åœ¨å›¾å½¢ä¸­æœ€æœ‰ç”¨çš„ä¿¡æ¯ç±»å‹ï¼Œå¹¶ä¸ºæ¯ç§ç±»å‹çš„ä¿¡æ¯æä¾›äº†ä¸€äº›åç»­é—®é¢˜ã€‚æ
å‡ºå¥½çš„åç»­é—®é¢˜çš„å…³é”®åœ¨äºä¾é ä½ çš„å¥½å¥‡å¿ƒï¼ˆä½ æƒ³æ›´å¤šäº†è§£ä»€ä¹ˆï¼Ÿï¼‰å’Œæ€€ç–‘ç²¾ç¥ï¼ˆè¿™å¯èƒ½ä¼šè¯¯å¯¼äººå—ï¼Ÿï¼‰ã€‚

\subsection{å…¸å‹å€¼}\label{ux5178ux578bux503c}

åœ¨æ¡å½¢å›¾å’Œç›´æ–¹å›¾ä¸­ï¼Œé«˜çš„æ¡å½¢ä»£è¡¨å˜é‡çš„å¸¸è§å€¼ï¼Œè¾ƒçŸ­çš„æ¡å½¢ä»£è¡¨ä¸å¤ªå¸¸è§çš„å€¼ã€‚æ²¡
æœ‰æ¡å½¢çš„åœ°æ–¹è¡¨ç¤ºåœ¨æ‚¨çš„æ•°æ®ä¸­æœªçœ‹åˆ°çš„å€¼ã€‚ä¸º
äº†å°†è¿™äº›ä¿¡æ¯è½¬åŒ–ä¸ºæœ‰ç”¨çš„é—®é¢˜ï¼Œè¯·å¯»æ‰¾ä»»ä½•å‡ºä¹æ„æ–™çš„ä¸œè¥¿ï¼š

\begin{itemize}
\tightlist
\item
  å“ªäº›å€¼æ˜¯æœ€å¸¸è§çš„ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ
\item
  å“ªäº›å€¼æ˜¯ç½•è§çš„ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿè¿™ç¬¦åˆä½ çš„é¢„æœŸå—ï¼Ÿ
\item
  ä½ æ˜¯å¦çœ‹åˆ°ä»»ä½•ä¸å¯»å¸¸çš„æ¨¡å¼ï¼Ÿå¯èƒ½æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„ï¼Ÿ
\end{itemize}

è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹è¾ƒå°é’»çŸ³çš„\texttt{carat}åˆ†å¸ƒã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{smaller }\OtherTok{\textless{}{-}}\NormalTok{ diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(carat }\SpecialCharTok{\textless{}} \DecValTok{3}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(smaller, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \FloatTok{0.01}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-4-1.pdf}

è¿™ä¸ªç›´æ–¹å›¾æå‡ºäº†å‡ ä¸ªæœ‰è¶£çš„é—®é¢˜ï¼š

\begin{itemize}
\item
  ä¸ºä»€ä¹ˆæ•´å…‹æ‹‰å’Œå¸¸è§çš„å°æ•°å…‹æ‹‰çš„é’»çŸ³æ›´å¤šï¼Ÿ
\item
  ä¸ºä»€ä¹ˆæ¯ä¸ªå³°å€¼å³ä¾§çš„é’»çŸ³æ¯”å·¦ä¾§çš„ç¨å¾®å¤šä¸€äº›ï¼Ÿ
\end{itemize}

å¯è§†åŒ–å›¾è¡¨è¿˜å¯ä»¥æ­ç¤ºé›†ç¾¤ï¼Œè¿™è¡¨æ˜ä½ çš„æ•°æ®ä¸­å­˜åœ¨å­ç»„ã€‚ä¸º
äº†ç†è§£è¿™äº›å­ç»„ï¼Œè¯·é—®ï¼š

\begin{itemize}
\item
  æ¯ä¸ªå­ç»„å†…çš„è§‚æµ‹å€¼å¦‚ä½•ç›¸äº’ç›¸ä¼¼ï¼Ÿ
\item
  ä¸åŒé›†ç¾¤ä¸­çš„è§‚æµ‹å€¼å¦‚ä½•ç›¸äº’ä¸åŒï¼Ÿ
\item
  ä½ å¦‚ä½•è§£é‡Šæˆ–æè¿°è¿™äº›é›†ç¾¤ï¼Ÿ
\item
  ä¸ºä»€ä¹ˆé›†ç¾¤çš„å‡ºç°å¯èƒ½ä¼šäº§ç”Ÿè¯¯å¯¼ï¼Ÿ
\end{itemize}

å…¶ä¸­ä¸€äº›é—®é¢˜å¯ä»¥ç”¨æ•°æ®æ¥å›ç­”ï¼Œè€Œä¸€äº›é—®é¢˜åˆ™éœ€è¦å…³äºæ•°æ®çš„é¢†åŸŸä¸“ä¸šçŸ¥è¯†ã€‚è®¸
å¤šé—®é¢˜å°†ä¿ƒä½¿ä½ æ¢ç´¢å˜é‡ä¹‹é—´çš„å…³ç³»ï¼Œä¾‹å¦‚ï¼ŒæŸ¥çœ‹ä¸€ä¸ªå˜é‡çš„å€¼æ˜¯å¦å¯ä»¥è§£é‡Šå¦ä¸€ä¸ªå˜é‡çš„è¡Œä¸ºã€‚æˆ‘
ä»¬ç¨åä¼šè®²åˆ°è¿™ä¸€ç‚¹ã€‚

\subsection{å¼‚å¸¸å€¼}\label{ux5f02ux5e38ux503c}

å¼‚å¸¸å€¼æ˜¯ä¸å¯»å¸¸çš„è§‚æµ‹å€¼ï¼›å®ƒä»¬æ˜¯ä¼¼ä¹ä¸ç¬¦åˆæ¨¡å¼çš„æ•°æ®ç‚¹ã€‚æœ‰
æ—¶å¼‚å¸¸å€¼æ˜¯æ•°æ®è¾“å…¥é”™è¯¯ï¼Œæœ‰æ—¶å®ƒä»¬åªæ˜¯åœ¨è¿™ç»„æ•°æ®æ”¶é›†ä¸­å¶ç„¶è§‚å¯Ÿåˆ°çš„æç«¯å€¼ï¼Œè€Œå…¶ä»–æ—¶å€™å®ƒä»¬å¯èƒ½æš—ç¤ºç€é‡è¦çš„æ–°å‘ç°ã€‚å½“
ä½ æ‹¥æœ‰å¤§é‡æ•°æ®æ—¶ï¼Œæœ‰æ—¶åœ¨ç›´æ–¹å›¾ä¸­å¾ˆéš¾çœ‹åˆ°å¼‚å¸¸å€¼ã€‚ä¾‹
å¦‚ï¼ŒæŸ¥çœ‹é’»çŸ³æ•°æ®é›†ä¸­\texttt{y}å˜é‡çš„åˆ†å¸ƒã€‚å¼‚
å¸¸å€¼å­˜åœ¨çš„å”¯ä¸€è¯æ®æ˜¯xè½´ä¸Šå¼‚å¸¸å®½çš„ç•Œé™ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ y)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-5-1.pdf}

åœ¨å¸¸è§çš„æ•°å€¼èŒƒå›´ï¼ˆç®±å­ï¼‰ä¸­æœ‰è®¸å¤šè§‚æµ‹å€¼ï¼Œè¿™ä½¿å¾—ç½•è§çš„æ•°å€¼èŒƒå›´ï¼ˆç®±å­ï¼‰éå¸¸çŸ­ï¼Œå› æ­¤å¾ˆéš¾çœ‹åˆ°å®ƒä»¬ï¼ˆå°½ç®¡ä¹Ÿè®¸å¦‚æœä½ ç´§ç›¯ç€
y è½´çš„ 0 ç‚¹ä»”ç»†çœ‹ï¼Œä¼šå‘ç°ç‚¹ä»€ä¹ˆï¼‰ã€‚ä¸º
äº†æ›´å®¹æ˜“åœ°çœ‹åˆ°å¼‚å¸¸å€¼ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨\texttt{coord\_cartesian()}å‡½æ•°å°† y
è½´ç¼©æ”¾åˆ°è¾ƒå°çš„å€¼åŸŸèŒƒå›´ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ y)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{50}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-6-1.pdf}

\texttt{coord\_cartesian()}è¿˜æœ‰ä¸€ä¸ª\texttt{xlim()}å‚æ•°ï¼Œå½“ä½ éœ€è¦æ”¾å¤§ x
è½´æ—¶å¯ä»¥ä½¿ç”¨å®ƒã€‚\texttt{g}
\texttt{gplot2}åŒæ ·æœ‰\texttt{xlim()}å’Œ\texttt{ylim()}å‡½æ•°ï¼Œä½†å®ƒä»¬çš„å·¥ä½œæ–¹å¼ç•¥æœ‰ä¸åŒï¼šå®ƒä»¬ä¼šä¸¢å¼ƒè¶…å‡ºé™åˆ¶èŒƒå›´çš„æ•°æ®ã€‚

è¿™ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿçœ‹åˆ°æœ‰ä¸‰ä¸ªå¼‚å¸¸å€¼ï¼š0ï¼Œ\textasciitilde30å’Œ\textasciitilde60ã€‚æˆ‘
ä»¬ä½¿ç”¨\texttt{dplyr}å°†å®ƒä»¬ç­›é€‰å‡ºæ¥ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{unusual }\OtherTok{\textless{}{-}}\NormalTok{ diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(y }\SpecialCharTok{\textless{}} \DecValTok{3} \SpecialCharTok{|}\NormalTok{ y }\SpecialCharTok{\textgreater{}} \DecValTok{20}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(price, x, y, z) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{arrange}\NormalTok{(y)}
\NormalTok{unusual}
\CommentTok{\#\textgreater{} \# A tibble: 9 x 4}
\CommentTok{\#\textgreater{}   price     x     y     z}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1  5139  0      0    0   }
\CommentTok{\#\textgreater{} 2  6381  0      0    0   }
\CommentTok{\#\textgreater{} 3 12800  0      0    0   }
\CommentTok{\#\textgreater{} 4 15686  0      0    0   }
\CommentTok{\#\textgreater{} 5 18034  0      0    0   }
\CommentTok{\#\textgreater{} 6  2130  0      0    0   }
\CommentTok{\#\textgreater{} 7  2130  0      0    0   }
\CommentTok{\#\textgreater{} 8  2075  5.15  31.8  5.12}
\CommentTok{\#\textgreater{} 9 12210  8.09  58.9  8.06}
\end{Highlighting}
\end{Shaded}

\texttt{y} å˜é‡æµ‹é‡çš„æ˜¯è¿™äº›é’»çŸ³çš„ä¸‰ä¸ªç»´åº¦ä¹‹ä¸€ï¼Œå•ä½ä¸ºæ¯«ç±³ã€‚æˆ‘
ä»¬çŸ¥é“é’»çŸ³çš„å®½åº¦ä¸å¯èƒ½ä¸º 0 æ¯«ç±³ï¼Œæ‰€ä»¥è¿™äº›å€¼ä¸€å®šæ˜¯é”™è¯¯çš„ã€‚é€š
è¿‡è¿›è¡Œæ¢ç´¢æ€§æ•°æ®åˆ†æï¼ˆEDAï¼‰ï¼Œæˆ‘ä»¬å‘ç°äº†è¢«ç¼–ç ä¸º 0
çš„ç¼ºå¤±æ•°æ®ï¼Œè€Œæˆ‘ä»¬ä»…ä»…é€šè¿‡æœç´¢ \texttt{NA}s æ˜¯æ— æ³•å‘ç°è¿™äº›æ•°æ®çš„ã€‚æ¥
ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé€‰æ‹©å°†è¿™äº›å€¼é‡æ–°ç¼–ç ä¸º
\texttt{NA}sï¼Œä»¥é˜²æ­¢è¯¯å¯¼æ€§çš„è®¡ç®—ã€‚æˆ‘ ä»¬ä¹Ÿå¯èƒ½æ€€ç–‘ 32 æ¯«ç±³å’Œ 59
æ¯«ç±³çš„æµ‹é‡å€¼æ˜¯ä¸åˆç†çš„ï¼šè¿™äº›é’»çŸ³çš„é•¿åº¦è¶…è¿‡äº†ä¸€è‹±å¯¸ï¼Œä½†ä»·æ ¼å¹¶æ²¡æœ‰è¾¾åˆ°æ•°ä¸‡ç¾å…ƒï¼

ä¸€ä¸ªå¥½çš„åšæ³•æ˜¯åœ¨åŒ…å«å’Œä¸åŒ…å«å¼‚å¸¸å€¼çš„æƒ…å†µä¸‹é‡å¤ä½ çš„åˆ†æã€‚å¦‚
æœå®ƒä»¬å¯¹ç»“æœçš„å½±å“å¾ˆå°ï¼Œè€Œä¸”ä½ æ— æ³•ç¡®å®šå®ƒä»¬å‡ºç°çš„åŸå› ï¼Œé‚£ä¹ˆå¿½ç•¥å®ƒä»¬å¹¶ç»§ç»­åˆ†ææ˜¯åˆç†çš„ã€‚ç„¶
è€Œï¼Œå¦‚æœå®ƒä»¬å¯¹ä½ çš„ç»“æœæœ‰é‡å¤§å½±å“ï¼Œä½ ä¸åº”è¯¥æ²¡æœ‰ç†ç”±å°±åˆ é™¤å®ƒä»¬ã€‚ä½ 
éœ€è¦æ‰¾å‡ºå¯¼è‡´å®ƒä»¬å‡ºç°çš„åŸå› ï¼ˆä¾‹å¦‚æ•°æ®è¾“å…¥é”™è¯¯ï¼‰ï¼Œå¹¶åœ¨ä½ çš„æŠ¥å‘Šä¸­æŠ«éœ²ä½ å·²ç»åˆ é™¤äº†è¿™äº›å€¼ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-18}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  æ¢ç´¢\texttt{diamonds}æ•°æ®é›†ä¸­å˜é‡ \texttt{x}ã€\texttt{y} å’Œ \texttt{z}
  çš„åˆ†å¸ƒã€‚ä½  å‘ç°äº†ä»€ä¹ˆï¼Ÿæƒ³
  è±¡ä¸€ä¸‹é’»çŸ³ï¼Œå¹¶æ€è€ƒä½ å¦‚ä½•å†³å®šå“ªä¸ªç»´åº¦æ˜¯é•¿åº¦ã€å®½åº¦å’Œæ·±åº¦ã€‚
\item
  æ¢ç´¢\texttt{price}çš„åˆ†å¸ƒã€‚ä½  æ˜¯å¦å‘ç°äº†ä»»ä½•ä¸å¯»å¸¸æˆ–ä»¤äººæƒŠè®¶çš„äº‹æƒ…ï¼Ÿï¼ˆ
  æç¤ºï¼šä»”ç»†è€ƒè™‘\texttt{binwidth}ï¼Œå¹¶ç¡®ä¿ä½ å°è¯•äº†ä¸€ç³»åˆ—ä¸åŒçš„å€¼ã€‚ï¼‰
\item
  0.99 å…‹æ‹‰çš„é’»çŸ³æœ‰å¤šå°‘é¢—ï¼Ÿ1 å…‹æ‹‰çš„é’»çŸ³æœ‰å¤šå°‘é¢—ï¼Ÿä½ 
  è®¤ä¸ºè¿™ç§å·®å¼‚çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ
\item
  åœ¨ç›´æ–¹å›¾ä¸Šæ”¾å¤§æ—¶ï¼Œæ¯”è¾ƒ\texttt{coord\_cartesian()}å’Œ\texttt{xlim()}æˆ–\texttt{ylim()}çš„åŒºåˆ«ã€‚å¦‚
  æœä½ æ²¡æœ‰è®¾ç½®\texttt{binwidth}ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå¦‚
  æœä½ å°è¯•ç¼©æ”¾åˆ°åªæ˜¾ç¤ºåŠæ ¹æŸ±å­æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ
\end{enumerate}

\section{å¼‚å¸¸å€¼}\label{sec-unusual-values-eda}

å¦‚æœä½ åœ¨æ•°æ®é›†ä¸­é‡åˆ°äº†å¼‚å¸¸å€¼ï¼Œå¹¶ä¸”åªæ˜¯æƒ³ç»§ç»­å‰©ä½™åˆ†æï¼Œé‚£ä¹ˆä½ æœ‰ä¸¤ä¸ªé€‰æ‹©ã€‚

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  åˆ é™¤åŒ…å«å¼‚å¸¸å€¼çš„æ•´è¡Œï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds2 }\OtherTok{\textless{}{-}}\NormalTok{ diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(}\FunctionTok{between}\NormalTok{(y, }\DecValTok{3}\NormalTok{, }\DecValTok{20}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

  æˆ‘ä»¬ä¸æ¨èè¿™ä¸ªé€‰é¡¹ï¼Œå› ä¸ºä¸€ä¸ªæ— æ•ˆçš„å€¼å¹¶ä¸æ„å‘³ç€è¯¥è§‚æµ‹å€¼çš„å…¶ä»–æ‰€æœ‰å€¼ä¹Ÿéƒ½æ˜¯æ— æ•ˆçš„ã€‚æ­¤
  å¤–ï¼Œå¦‚æœä½ çš„æ•°æ®è´¨é‡è¾ƒä½ï¼Œå½“ä½ å°†è¿™ç§æ–¹æ³•åº”ç”¨äºæ¯ä¸ªå˜é‡æ—¶ï¼Œä½ å¯èƒ½ä¼šå‘ç°ä½ æ²¡æœ‰ç•™ä¸‹ä»»ä½•æ•°æ®ï¼
\item
  ç›¸åï¼Œæˆ‘ä»¬å»ºè®®å°†å¼‚å¸¸å€¼æ›¿æ¢ä¸ºç¼ºå¤±å€¼ã€‚æœ€
  ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨\texttt{mutate()}æ¥æ›¿æ¢å˜é‡çš„ä¸€ä¸ªä¿®æ”¹åçš„å‰¯æœ¬ã€‚ä½ 
  å¯ä»¥ä½¿ç”¨\texttt{if\_else()}å‡½æ•°å°†å¼‚å¸¸å€¼æ›¿æ¢ä¸º \texttt{NA}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds2 }\OtherTok{\textless{}{-}}\NormalTok{ diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{y =} \FunctionTok{if\_else}\NormalTok{(y }\SpecialCharTok{\textless{}} \DecValTok{3} \SpecialCharTok{|}\NormalTok{ y }\SpecialCharTok{\textgreater{}} \DecValTok{20}\NormalTok{, }\ConstantTok{NA}\NormalTok{, y))}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

åœ¨å›¾ä¸­ç»˜åˆ¶ç¼ºå¤±å€¼å¹¶ä¸åˆç†ï¼Œå› æ­¤ggplot2ä¸ä¼šå°†å®ƒä»¬åŒ…å«åœ¨å›¾ä¸­ï¼Œä½†ä¼šå‘å‡ºè­¦å‘Šï¼Œè¯´æ˜è¿™äº›å€¼å·²è¢«ç§»é™¤ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(diamonds2, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x, }\AttributeTok{y =}\NormalTok{ y)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{()}
\CommentTok{\#\textgreater{} Warning: Removed 9 rows containing missing values or values outside the scale range}
\CommentTok{\#\textgreater{} (\textasciigrave{}geom\_point()\textasciigrave{}).}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-12-1.png}

è¦é˜»æ­¢è¯¥è­¦å‘Šï¼Œè¯·è®¾ç½® \texttt{na.rm\ =\ TRUE}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(diamonds2, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x, }\AttributeTok{y =}\NormalTok{ y)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

æœ‰æ—¶ä½ æƒ³äº†è§£åŒ…å«ç¼ºå¤±å€¼çš„è§‚æµ‹ä¸åŒ…å«è®°å½•å€¼çš„è§‚æµ‹ä¹‹é—´æœ‰ä½•ä¸åŒã€‚ä¾‹
å¦‚ï¼Œåœ¨\texttt{nycflights13::flights}\footnote{è®°ä½ï¼Œå½“æˆ‘ä»¬éœ€è¦æ˜ç¡®æŒ‡å‡ºä¸€ä¸ªå‡½æ•°ï¼ˆæˆ–æ•°æ®é›†ï¼‰æ¥è‡ªå“ªä¸ªåŒ…æ—¶ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ç‰¹æ®Šçš„å½¢å¼\texttt{package::function()}æˆ–\texttt{package::dataset}ã€‚}æ•°æ®é›†ä¸­ï¼Œ\texttt{dep\_time}å˜é‡ä¸­çš„ç¼ºå¤±å€¼è¡¨ç¤ºèˆªç­è¢«å–æ¶ˆã€‚
å› æ­¤ï¼Œä½ å¯èƒ½æƒ³è¦æ¯”è¾ƒå–æ¶ˆèˆªç­å’Œæœªå–æ¶ˆèˆªç­çš„è®¡åˆ’èµ·é£æ—¶é—´ã€‚
å¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°å˜é‡æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œä½¿ç”¨\texttt{is.na()}å‡½æ•°æ¥æ£€æŸ¥\texttt{dep\_time}æ˜¯å¦ç¼ºå¤±ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nycflights13}\SpecialCharTok{::}\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{cancelled =} \FunctionTok{is.na}\NormalTok{(dep\_time),}
    \AttributeTok{sched\_hour =}\NormalTok{ sched\_dep\_time }\SpecialCharTok{\%/\%} \DecValTok{100}\NormalTok{,}
    \AttributeTok{sched\_min =}\NormalTok{ sched\_dep\_time }\SpecialCharTok{\%\%} \DecValTok{100}\NormalTok{,}
    \AttributeTok{sched\_dep\_time =}\NormalTok{ sched\_hour }\SpecialCharTok{+}\NormalTok{ (sched\_min }\SpecialCharTok{/} \DecValTok{60}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ sched\_dep\_time)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_freqpoly}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ cancelled), }\AttributeTok{binwidth =} \DecValTok{1}\SpecialCharTok{/}\DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-14-1.pdf}

ç„¶è€Œè¿™ä¸ªå›¾å¹¶ä¸å¤ªå¥½ï¼Œå› ä¸ºæœªå–æ¶ˆçš„èˆªç­æ¯”å·²å–æ¶ˆçš„èˆªç­å¤šå¾—å¤šã€‚åœ¨
ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ¢ç´¢ä¸€äº›æŠ€æœ¯æ¥æ”¹è¿›è¿™ç§æ¯”è¾ƒã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-19}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ç›´æ–¹å›¾ä¸­ç¼ºå¤±å€¼ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæ¡ å½¢å›¾ä¸­ç¼ºå¤±å€¼ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä¸º
  ä»€ä¹ˆç›´æ–¹å›¾å’Œæ¡å½¢å›¾ä¸­ç¼ºå¤±å€¼çš„å¤„ç†æ–¹å¼ä¸åŒï¼Ÿ
\item
  åœ¨\texttt{mean()}å’Œ\texttt{sum()}å‡½æ•°ä¸­ï¼Œ\texttt{na.rm\ =\ TRUE}çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ
\item
  é‡æ–°åˆ›å»ºæŒ‰èˆªç­æ˜¯å¦è¢«å–æ¶ˆç€è‰²çš„\texttt{scheduled\_dep\_time}çš„é¢‘æ•°å›¾ã€‚åŒ
  æ—¶æ ¹æ®\texttt{cancelled}å˜é‡è¿›è¡Œåˆ†é¢ã€‚åœ¨
  åˆ†é¢å‡½æ•°ä¸­å°è¯•ä½¿ç”¨\texttt{scales}å˜é‡çš„ä¸åŒå€¼ï¼Œä»¥å‡è½»æœªå–æ¶ˆèˆªç­å¤šäºå–æ¶ˆèˆªç­çš„å½±å“ã€‚
\end{enumerate}

\section{åå˜ï¼ˆcovariationï¼‰}\label{ux534fux53d8covariation}

å¦‚æœå˜å¼‚æè¿°äº†ä¸€ä¸ªå˜é‡å†…éƒ¨çš„è¡Œä¸ºï¼Œé‚£ä¹ˆåå˜æè¿°äº†å˜é‡ä¹‹é—´çš„è¡Œä¸ºã€‚å
å˜æ˜¯ä¸¤ä¸ªæˆ–å¤šä¸ªå˜é‡çš„å€¼ä»¥ç›¸å…³çš„æ–¹å¼ä¸€èµ·å˜åŒ–çš„è¶‹åŠ¿ã€‚å‘
ç°åå˜çš„æœ€ä½³æ–¹æ³•æ˜¯å¯è§†åŒ–ä¸¤ä¸ªæˆ–å¤šä¸ªå˜é‡ä¹‹é—´çš„å…³ç³»ã€‚

\subsection{ä¸€ä¸ªåˆ†ç±»å˜é‡å’Œä¸€ä¸ªæ•°å€¼å˜é‡}\label{sec-cat-num}

ä¾‹å¦‚ï¼Œä½¿ç”¨\texttt{geom\_freqpoly()}æ¥æ¢ç´¢é’»çŸ³çš„ä»·æ ¼å¦‚ä½•éšå…¶è´¨é‡(\texttt{cut})çš„å˜åŒ–è€Œå˜åŒ–:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ price)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_freqpoly}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ cut), }\AttributeTok{binwidth =} \DecValTok{500}\NormalTok{, }\AttributeTok{linewidth =} \FloatTok{0.75}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-15-1.pdf}

è¯·æ³¨æ„ï¼Œggplot2ä¸º\texttt{cut}ä½¿ç”¨äº†æœ‰åºçš„é¢œè‰²åˆ»åº¦ï¼Œå› ä¸ºå®ƒåœ¨æ•°æ®ä¸­å®šä¹‰ä¸ºæœ‰åºå› å­å˜é‡ã€‚ä½ 
å°†åœ¨ å°èŠ‚~\ref{sec-ordered-factors} ä¸­å­¦åˆ°æ›´å¤šå…³äºå®ƒçš„çŸ¥è¯†ã€‚

\texttt{geom\_freqpoly()}çš„é»˜è®¤å¤–è§‚åœ¨è¿™é‡Œå¹¶ä¸é‚£ä¹ˆæœ‰ç”¨ï¼Œå› ä¸ºç”±æ€»è®¡æ•°ç¡®å®šçš„é«˜åº¦åœ¨å„ä¸ª\texttt{cut}ä¹‹é—´å·®å¼‚å¾ˆå¤§ï¼Œä½¿å¾—éš¾ä»¥çœ‹å‡ºå®ƒä»¬åˆ†å¸ƒå½¢çŠ¶çš„å·®å¼‚ã€‚

ä¸ºäº†ä½¿æ¯”è¾ƒæ›´å®¹æ˜“ï¼Œæˆ‘ä»¬éœ€è¦äº¤æ¢ y è½´ä¸Šçš„æ˜¾ç¤ºå†…å®¹ã€‚æˆ‘
ä»¬ä¸æ˜¾ç¤ºè®¡æ•°ï¼Œè€Œæ˜¯æ˜¾ç¤ºå¯†åº¦ï¼ˆdensityï¼‰ï¼Œå¯†åº¦æ˜¯æ ‡å‡†åŒ–çš„è®¡æ•°ï¼Œä½¿å¾—æ¯ä¸ªé¢‘ç‡å¤šè¾¹å½¢çš„é¢ç§¯éƒ½ä¸º1ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ price, }\AttributeTok{y =} \FunctionTok{after\_stat}\NormalTok{(density))) }\SpecialCharTok{+} 
  \FunctionTok{geom\_freqpoly}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ cut), }\AttributeTok{binwidth =} \DecValTok{500}\NormalTok{, }\AttributeTok{linewidth =} \FloatTok{0.75}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-16-1.pdf}

è¯·æ³¨æ„ï¼Œæˆ‘ä»¬æ­£åœ¨å°†\texttt{density}
æ˜ å°„åˆ°\texttt{y}è½´ä¸Šï¼Œä½†ç”±äº\texttt{density}
ä¸æ˜¯\texttt{diamonds}æ•°æ®é›†ä¸­çš„å˜é‡ï¼Œé¦–å…ˆéœ€è¦è®¡ç®—å®ƒã€‚æˆ‘
ä»¬ä½¿ç”¨\texttt{after\_stat()}å‡½æ•°æ¥å®Œæˆè¿™ä¸€æ“ä½œã€‚

è¿™ä¸ªå›¾æœ‰ä¸€ä¸ªç›¸å½“ä»¤äººæƒŠè®¶çš„åœ°æ–¹------çœ‹èµ·æ¥è´¨é‡ä¸€èˆ¬çš„é’»çŸ³ï¼ˆå³æœ€ä½è´¨é‡ï¼‰çš„å¹³å‡ä»·æ ¼æœ€é«˜ï¼ä½†
ä¹Ÿè®¸è¿™æ˜¯å› ä¸ºé¢‘æ•°å¤šè¾¹å½¢å›¾æœ‰ç‚¹éš¾ä»¥è§£è¯»ï¼Œè¿™ä¸ªå›¾ä¸­æœ‰å¾ˆå¤šå†…å®¹ã€‚

æ¢ç´¢è¿™ç§å…³ç³»çš„ä¸€ç§è§†è§‰ä¸Šæ›´ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨å¹¶æ’ç®±çº¿å›¾ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cut, }\AttributeTok{y =}\NormalTok{ price)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-17-1.pdf}

å…³äºåˆ†å¸ƒçš„ä¿¡æ¯æˆ‘ä»¬çœ‹åˆ°çš„è¦å°‘å¾—å¤šï¼Œä½†ç®±çº¿å›¾æ›´åŠ ç´§å‡‘ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ›´å®¹æ˜“åœ°æ¯”è¾ƒå®ƒä»¬ï¼ˆå¹¶ä¸”å¯ä»¥åœ¨ä¸€ä¸ªå›¾ä¸Šå±•ç¤ºæ›´å¤šï¼‰ã€‚è¿™
æ”¯æŒäº†ä¸€ä¸ªåç›´è§‰çš„å‘ç°ï¼Œå³æ›´é«˜è´¨é‡çš„é’»çŸ³é€šå¸¸æ›´ä¾¿å®œï¼åœ¨
ç»ƒä¹ ä¸­ï¼Œä½ å°†é¢ä¸´çš„æŒ‘æˆ˜æ˜¯æ‰¾å‡ºä¸ºä»€ä¹ˆã€‚

\texttt{cut}æ˜¯ä¸€ä¸ªæœ‰åºå› å­ï¼šfairï¼ˆä¸€èˆ¬ï¼‰æ¯”
goodï¼ˆè‰¯å¥½ï¼‰å·®ï¼Œgoodï¼ˆè‰¯å¥½ï¼‰æ¯” very goodï¼ˆå¾ˆå¥½ï¼‰å·®ï¼Œä¾æ­¤ç±»æ¨ã€‚è®¸
å¤šåˆ†ç±»å˜é‡å¹¶æ²¡æœ‰è¿™æ ·çš„å†…åœ¨é¡ºåºï¼Œå› æ­¤ä½ å¯èƒ½å¸Œæœ›é‡æ–°æ’åºå®ƒä»¬ä»¥åˆ›å»ºæ›´å…·ä¿¡æ¯é‡çš„æ˜¾ç¤ºã€‚ä¸€
ç§æ–¹æ³•æ˜¯ä½¿ç”¨\texttt{fct\_reorder()}å‡½æ•°ï¼Œä½ å°†åœ¨
å°èŠ‚~\ref{sec-modifying-factor-order}
ä¸­äº†è§£è¯¥å‡½æ•°çš„æ›´å¤šä¿¡æ¯ï¼Œä½†å› ä¸ºæˆ‘ä»¬è§‰å¾—å®ƒéå¸¸æœ‰ç”¨ï¼Œæ‰€ä»¥æƒ³åœ¨è¿™é‡Œç»™ä½ ä¸€ä¸ªå¿«é€Ÿçš„é¢„è§ˆã€‚ä¾‹
å¦‚ï¼Œè€ƒè™‘\texttt{mpg}æ•°æ®é›†ä¸­çš„\texttt{class}å˜é‡ã€‚ä½ 
å¯èƒ½æƒ³çŸ¥é“ä¸åŒç±»åˆ«ä¹‹é—´çš„å…¬è·¯é‡Œç¨‹æ˜¯å¦‚ä½•å˜åŒ–çš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ class, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-18-1.pdf}

ä¸ºäº†ä½¿è¶‹åŠ¿æ›´å®¹æ˜“çœ‹åˆ°ï¼Œæˆ‘ä»¬æ ¹æ®\texttt{hwy}çš„ä¸­ä½æ•°å¯¹\texttt{class}é‡æ–°æ’åº:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{fct\_reorder}\NormalTok{(class, hwy, median), }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-19-1.pdf}

å¦‚æœä½ çš„å˜é‡åå¾ˆé•¿ï¼Œé‚£ä¹ˆå°†\texttt{geom\_boxplot()}æ—‹è½¬ 90Â°
å°†ä¼šæ›´æ˜“äºé˜…è¯»ã€‚ä½  å¯ä»¥é€šè¿‡äº¤æ¢ x å’Œ y çš„ç¾å­¦æ˜ å°„æ¥å®ç°è¿™ä¸€ç‚¹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ hwy, }\AttributeTok{y =} \FunctionTok{fct\_reorder}\NormalTok{(class, hwy, median))) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-20-1.pdf}

\subsubsection{ç»ƒä¹ }\label{ux7ec3ux4e60-20}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  åˆ©ç”¨ä½ å­¦åˆ°çš„çŸ¥è¯†æ¥æ”¹è¿›å–æ¶ˆèˆªç­ä¸éå–æ¶ˆèˆªç­èµ·é£æ—¶é—´çš„å¯è§†åŒ–ã€‚
\item
  åŸºäºEDAï¼Œdiamondsæ•°æ®é›†ä¸­å“ªä¸ªå˜é‡çœ‹èµ·æ¥å¯¹é¢„æµ‹é’»çŸ³çš„ä»·æ ¼æœ€é‡è¦ï¼Ÿè¿™
  ä¸ªå˜é‡ä¸åˆ‡å‰²æ–¹å¼ï¼ˆ\texttt{cut}ï¼‰æ˜¯å¦‚ä½•ç›¸å…³çš„ï¼Ÿä¸º
  ä»€ä¹ˆè¿™ä¸¤ä¸ªå…³ç³»çš„ç»„åˆä¼šå¯¼è‡´ä½è´¨é‡çš„é’»çŸ³æ›´æ˜‚è´µï¼Ÿ
\item
  ä¸äº¤æ¢ x å’Œ y
  å˜é‡ï¼Œè€Œæ˜¯åœ¨å‚ç›´ç®±çº¿å›¾ä¸­æ·»åŠ \texttt{coord\_flip()}ä½œä¸ºæ–°å±‚æ¥åˆ›å»ºæ°´å¹³ç®±çº¿å›¾ã€‚è¿™
  ä¸äº¤æ¢å˜é‡æœ‰ä½•ä¸åŒï¼Ÿ
\item
  ç®±çº¿å›¾çš„ä¸€ä¸ªé—®é¢˜æ˜¯å®ƒä»¬åœ¨æ•°æ®é‡è¾ƒå°çš„æ—¶æœŸå¼€å‘ï¼Œå¾€å¾€ä¼šæ˜¾ç¤ºè¿‡å¤šçš„``å¼‚å¸¸å€¼''ã€‚ä¸€
  ç§è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•æ˜¯ä½¿ç”¨å­—æ¯å€¼å›¾ã€‚å®‰ è£… \texttt{lvplot}
  åŒ…ï¼Œå¹¶å°è¯•ä½¿ç”¨\texttt{geom\_lv()}æ¥æ˜¾ç¤ºpriceä¸cutçš„åˆ†å¸ƒã€‚ä½ 
  å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿä½  å¦‚ä½•è§£é‡Šè¿™äº›å›¾ï¼Ÿ
\item
  ä½¿ç”¨\texttt{geom\_violin()}åˆ›å»ºé’»çŸ³ä»·æ ¼ä¸é’»çŸ³æ•°æ®é›†ä¸­ä¸€ä¸ªåˆ†ç±»å˜é‡çš„å¯è§†åŒ–ï¼Œç„¶åä½¿ç”¨åˆ†é¢çš„\texttt{geom\_histogram()}ï¼Œç„¶åæ˜¯ç€è‰²çš„\texttt{geom\_freqpoly()}ï¼Œæœ€åæ˜¯ç€è‰²çš„\texttt{geom\_density()}ã€‚æ¯”
  è¾ƒå’Œå¯¹æ¯”è¿™å››ç§å›¾ã€‚æ ¹
  æ®åˆ†ç±»å˜é‡çš„æ°´å¹³å¯è§†åŒ–æ•°å€¼å˜é‡åˆ†å¸ƒçš„æ¯ç§æ–¹æ³•å„æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ
\item
  å¦‚æœä½ æœ‰ä¸€ä¸ªå°å‹æ•°æ®é›†ï¼Œæœ‰æ—¶ä½¿ç”¨\texttt{geom\_jitter()}æ¥é¿å…è¿‡åº¦ç»˜å›¾æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œè¿™æ ·å¯ä»¥æ›´å®¹æ˜“åœ°çœ‹åˆ°è¿ç»­å˜é‡å’Œåˆ†ç±»å˜é‡ä¹‹é—´çš„å…³ç³»ã€‚g
  gbeeswarm åŒ…æä¾›äº†å¤šç§ä¸\texttt{geom\_jitter()}ç±»ä¼¼çš„æ–¹æ³•ã€‚åˆ—
  å‡ºå®ƒä»¬å¹¶ç®€è¦æè¿°æ¯ç§æ–¹æ³•çš„ä½œç”¨ã€‚
\end{enumerate}

\subsection{ä¸¤ä¸ªåˆ†ç±»å˜é‡}\label{ux4e24ux4e2aux5206ux7c7bux53d8ux91cf-1}

ä¸ºäº†å¯è§†åŒ–åˆ†ç±»å˜é‡ä¹‹é—´çš„åå˜å…³ç³»ï¼Œä½ éœ€è¦è®¡ç®—è¿™äº›åˆ†ç±»å˜é‡æ¯ä¸ªæ°´å¹³ç»„åˆçš„è§‚å¯Ÿæ•°ã€‚ä¸€
ç§æ–¹æ³•æ˜¯ä¾èµ–å†…ç½®çš„\texttt{geom\_count()}å‡½æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cut, }\AttributeTok{y =}\NormalTok{ color)) }\SpecialCharTok{+}
  \FunctionTok{geom\_count}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-21-1.pdf}

å›¾ä¸­çš„æ¯ä¸ªåœ†åœˆçš„å¤§å°æ˜¾ç¤ºäº†æ¯ä¸ªå€¼ç»„åˆå‡ºç°äº†å¤šå°‘æ¬¡è§‚æµ‹ã€‚å
å˜å°†è¡¨ç°ä¸ºç‰¹å®šxå€¼å’Œç‰¹å®šyå€¼ä¹‹é—´çš„å¼ºç›¸å…³æ€§ã€‚

æ¢ç´¢è¿™äº›å˜é‡ä¹‹é—´å…³ç³»çš„å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨dplyræ¥è®¡ç®—è®¡æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count}\NormalTok{(color, cut)}
\CommentTok{\#\textgreater{} \# A tibble: 35 x 3}
\CommentTok{\#\textgreater{}   color cut           n}
\CommentTok{\#\textgreater{}   \textless{}ord\textgreater{} \textless{}ord\textgreater{}     \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 D     Fair        163}
\CommentTok{\#\textgreater{} 2 D     Good        662}
\CommentTok{\#\textgreater{} 3 D     Very Good  1513}
\CommentTok{\#\textgreater{} 4 D     Premium    1603}
\CommentTok{\#\textgreater{} 5 D     Ideal      2834}
\CommentTok{\#\textgreater{} 6 E     Fair        224}
\CommentTok{\#\textgreater{} \# i 29 more rows}
\end{Highlighting}
\end{Shaded}

ç„¶åä½¿ç”¨\texttt{geom\_tile()}å’Œå¡«å……ç¾å­¦è¿›è¡Œå¯è§†åŒ–:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count}\NormalTok{(color, cut) }\SpecialCharTok{|\textgreater{}}  
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ color, }\AttributeTok{y =}\NormalTok{ cut)) }\SpecialCharTok{+}
  \FunctionTok{geom\_tile}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{fill =}\NormalTok{ n))}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-23-1.pdf}

å¦‚æœåˆ†ç±»å˜é‡æ˜¯æ— åºçš„ï¼Œä½ å¯èƒ½æƒ³è¦ä½¿ç”¨\texttt{seriation}åŒ…æ¥åŒæ—¶é‡æ–°æ’åºè¡Œå’Œåˆ—ï¼Œä»¥ä¾¿æ›´æ¸…æ¥šåœ°æ­ç¤ºæœ‰è¶£çš„æ¨¡å¼ã€‚å¯¹
äºè¾ƒå¤§çš„å›¾å½¢ï¼Œä½ å¯èƒ½æƒ³è¦å°è¯•\texttt{heatmaply}åŒ…ï¼Œå®ƒåˆ›å»ºäº¤äº’å¼å›¾å½¢ã€‚

\subsubsection{ç»ƒä¹ }\label{ux7ec3ux4e60-21}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  å¦‚ä½•é‡æ–°ç¼©æ”¾ä¸Šé¢çš„è®¡æ•°æ•°æ®é›†ï¼Œä»¥æ›´æ¸…æ¥šåœ°æ˜¾ç¤ºcolorä¸­çš„cutåˆ†å¸ƒï¼Œæˆ–cutä¸­çš„coloråˆ†å¸ƒï¼Ÿ
\item
  å¦‚æœ\texttt{color}æ˜ å°„åˆ°\texttt{x}ç¾å­¦ï¼Œ\texttt{cut}æ˜ å°„åˆ°\texttt{fill}ç¾å­¦ï¼Œä½¿ç”¨åˆ†æ®µæ¡å½¢å›¾ä½ èƒ½å¾—åˆ°å“ªäº›ä¸åŒçš„æ•°æ®è§è§£ï¼Ÿè®¡
  ç®—æ¯ä¸ªåˆ†æ®µä¸­çš„è®¡æ•°ã€‚
\item
  ä½¿ç”¨\texttt{geom\_tile()}ç»“åˆ\texttt{dplyr}æ¥æ¢ç´¢å¹³å‡èˆªç­èµ·é£å»¶è¯¯å¦‚ä½•å› ç›®çš„åœ°å’Œå¹´ä»½æœˆä»½è€Œå¼‚ã€‚è¿™
  ä¸ªå›¾ä¸ºä»€ä¹ˆéš¾ä»¥é˜…è¯»ï¼Ÿä½  å¦‚ä½•æ”¹è¿›å®ƒï¼Ÿ
\end{enumerate}

\subsection{ä¸¤ä¸ªæ•°å€¼å˜é‡}\label{ux4e24ux4e2aux6570ux503cux53d8ux91cf-1}

ä½ å·²ç»çœ‹åˆ°äº†å¯è§†åŒ–ä¸¤ä¸ªæ•°å€¼å˜é‡ä¹‹é—´åå˜å…³ç³»çš„ä¸€ç§å¥½æ–¹æ³•ï¼šä½¿ç”¨\texttt{geom\_point()}ç»˜åˆ¶æ•£ç‚¹å›¾ã€‚ä½ 
å¯ä»¥åœ¨ç‚¹çš„æ¨¡å¼ä¸­çœ‹åˆ°åå˜å…³ç³»ã€‚ä¾‹
å¦‚ï¼Œä½ å¯ä»¥çœ‹åˆ°é’»çŸ³çš„å…‹æ‹‰å¤§å°ä¸å…¶ä»·æ ¼ä¹‹é—´çš„æ­£ç›¸å…³å…³ç³»ï¼šå…‹æ‹‰æ•°è¶Šå¤šçš„é’»çŸ³ä»·æ ¼è¶Šé«˜ã€‚è¿™
ç§å…³ç³»æ˜¯å‘ˆæŒ‡æ•°å‹çš„ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(smaller, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat, }\AttributeTok{y =}\NormalTok{ price)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-24-1.png}

(åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨\texttt{smaller}æ•°æ®é›†æ¥é‡ç‚¹å…³æ³¨å…‹æ‹‰æ•°å°äº3çš„é’»çŸ³)

éšç€æ•°æ®é›†å¤§å°çš„å¢åŠ ï¼Œæ•£ç‚¹å›¾å˜å¾—ä¸é‚£ä¹ˆæœ‰ç”¨ï¼Œå› ä¸ºç‚¹å¼€å§‹é‡å å¹¶å †ç§¯æˆå‡åŒ€çš„é»‘è‰²åŒºåŸŸï¼Œè¿™ä½¿å¾—éš¾ä»¥åˆ¤æ–­äºŒç»´ç©ºé—´ä¸­æ•°æ®å¯†åº¦çš„å·®å¼‚ï¼Œä¹Ÿéš¾ä»¥å‘ç°è¶‹åŠ¿ã€‚ä½ 
å·²ç»çœ‹åˆ°äº†ä¸€ç§è§£å†³é—®é¢˜çš„æ–¹æ³•ï¼šä½¿ç”¨\texttt{alpha}ç¾å­¦å±æ€§æ¥å¢åŠ é€æ˜åº¦ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(smaller, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat, }\AttributeTok{y =}\NormalTok{ price)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha =} \DecValTok{1} \SpecialCharTok{/} \DecValTok{100}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-25-1.png}

ä½†æ˜¯ï¼Œå¯¹äºéå¸¸å¤§çš„æ•°æ®é›†ï¼Œä½¿ç”¨é€æ˜åº¦å¯èƒ½ä¼šå¾ˆæœ‰æŒ‘æˆ˜æ€§ã€‚å¦
ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨åˆ†ç»„ï¼ˆbinï¼‰ã€‚ä¹‹
å‰æ‚¨ä½¿ç”¨\texttt{geom\_histogram()}å’Œ\texttt{geom\_freqpoly()}åœ¨ä¸€ç»´ä¸­è¿›è¡Œåˆ†ç»„ã€‚ç°
åœ¨æ‚¨å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨\texttt{geom\_bin2d()}å’Œ\texttt{geom\_hex()}åœ¨äºŒç»´ä¸­è¿›è¡Œåˆ†ç»„ã€‚

\texttt{geom\_bin2d()}å’Œ\texttt{geom\_hex()}å°†åæ ‡å¹³é¢åˆ’åˆ†ä¸ºäºŒç»´çš„åˆ†ç»„ï¼ˆbinsï¼‰ï¼Œç„¶åä½¿ç”¨å¡«å……é¢œè‰²æ¥è¡¨ç¤ºæ¯ä¸ªåˆ†ç»„ä¸­æœ‰å¤šå°‘ç‚¹ã€‚\texttt{g}
\texttt{eom\_bin2d()}åˆ›å»ºçŸ©å½¢çš„åˆ†ç»„ã€‚\texttt{g}
\texttt{eom\_hex()}åˆ›å»ºå…­è¾¹å½¢çš„åˆ†ç»„ã€‚è¦
ä½¿ç”¨\texttt{geom\_hex()}ï¼Œæ‚¨éœ€è¦å®‰è£…\texttt{hexbin}åŒ…ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(smaller, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat, }\AttributeTok{y =}\NormalTok{ price)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bin2d}\NormalTok{()}

\CommentTok{\# install.packages("hexbin")}
\FunctionTok{ggplot}\NormalTok{(smaller, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat, }\AttributeTok{y =}\NormalTok{ price)) }\SpecialCharTok{+}
  \FunctionTok{geom\_hex}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-26-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-26-2.pdf}\end{minipage}%

\end{figure}%

å¦ä¸€ç§é€‰æ‹©æ˜¯å°†ä¸€ä¸ªè¿ç»­å˜é‡è¿›è¡Œåˆ†ç»„ï¼Œä½¿å…¶è¡¨ç°å¾—åƒä¸€ä¸ªåˆ†ç±»å˜é‡ã€‚ç„¶
åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ‚¨å­¦è¿‡çš„ç”¨äºå¯è§†åŒ–åˆ†ç±»å˜é‡å’Œè¿ç»­å˜é‡ç»„åˆçš„æŠ€æœ¯ä¹‹ä¸€ã€‚ä¾‹
å¦‚ï¼Œæ‚¨å¯ä»¥å¯¹\texttt{carat} è¿›è¡Œåˆ†ç»„ï¼Œç„¶åä¸ºæ¯ä¸ªç»„æ˜¾ç¤ºä¸€ä¸ªç®±çº¿å›¾ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(smaller, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat, }\AttributeTok{y =}\NormalTok{ price)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_boxplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{group =} \FunctionTok{cut\_width}\NormalTok{(carat, }\FloatTok{0.1}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-27-1.pdf}

ä¸Šé¢ä½¿ç”¨\texttt{cut\_width(x,\ width)}å°† \texttt{x} åˆ†æˆå®½åº¦ä¸º
\texttt{width} çš„åˆ†ç»„ã€‚é»˜
è®¤æƒ…å†µä¸‹ï¼Œæ— è®ºè§‚æµ‹çš„æ•°é‡å¦‚ä½•ï¼Œç®±çº¿å›¾çœ‹èµ·æ¥å¤§è‡´ç›¸åŒï¼ˆé™¤äº†å¼‚å¸¸å€¼çš„æ•°é‡ï¼‰ï¼Œå› æ­¤å¾ˆéš¾çœ‹å‡ºæ¯ä¸ªç®±çº¿å›¾æ±‡æ€»äº†ä¸åŒæ•°é‡çš„ç‚¹ã€‚ä¸€
ç§è¡¨ç¤ºè¿™ç§å·®å¼‚çš„æ–¹æ³•æ˜¯è®©ç®±çº¿å›¾çš„å®½åº¦ä¸ç‚¹çš„æ•°é‡æˆæ¯”ä¾‹ï¼Œè¿™é€šè¿‡è®¾ç½®\texttt{varwidth\ =\ TRUE}æ¥å®ç°ã€‚

\subsubsection{ç»ƒä¹ }\label{ux7ec3ux4e60-22}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  é™¤äº†ä½¿ç”¨ç®±çº¿å›¾æ¥æ€»ç»“æ¡ä»¶åˆ†å¸ƒå¤–ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨é¢‘æ•°å¤šè¾¹å½¢ã€‚åœ¨
  ä½¿ç”¨\texttt{cut\_width()}å’Œ\texttt{cut\_number()}æ—¶éœ€è¦è€ƒè™‘ä»€ä¹ˆï¼Ÿè¿™
  å¯¹å¯è§†åŒ–\texttt{carat}å’Œ\texttt{price}çš„äºŒç»´åˆ†å¸ƒæœ‰ä»€ä¹ˆå½±å“ï¼Ÿ
\item
  å¯è§†åŒ–æ ¹æ®\texttt{price}åˆ’åˆ†çš„\texttt{carat}åˆ†å¸ƒã€‚
\item
  éå¸¸å¤§çš„é’»çŸ³çš„ä»·æ ¼åˆ†å¸ƒä¸å°é’»çŸ³çš„ä»·æ ¼åˆ†å¸ƒç›¸æ¯”å¦‚ä½•ï¼Ÿæ˜¯
  å¦ç¬¦åˆä½ çš„é¢„æœŸï¼Œè¿˜æ˜¯è®©ä½ æ„Ÿåˆ°æƒŠè®¶ï¼Ÿ
\item
  ç»“åˆä½ å­¦è¿‡çš„ä¸¤ç§æŠ€æœ¯æ¥å¯è§†åŒ–\texttt{cut}ã€\texttt{carat}å’Œ\texttt{price}çš„è”åˆåˆ†å¸ƒã€‚
\item
  äºŒç»´å›¾å¯ä»¥æ­ç¤ºä¸€ç»´å›¾ä¸­ä¸å¯è§çš„å¼‚å¸¸å€¼ã€‚ä¾‹
  å¦‚ï¼Œä»¥ä¸‹å›¾ä¸­çš„æŸäº›ç‚¹å…·æœ‰ä¸å¯»å¸¸çš„ \texttt{x} å’Œ \texttt{y}
  å€¼ç»„åˆï¼Œå³ä½¿åˆ†åˆ«æŸ¥çœ‹è¿™äº›ç‚¹çš„ \texttt{x} å’Œ \texttt{y}
  å€¼æ—¶çœ‹èµ·æ¥æ˜¯æ­£å¸¸çš„ï¼Œä¹Ÿä½¿å¾—è¿™äº›ç‚¹æˆä¸ºå¼‚å¸¸å€¼ã€‚ä¸º
  ä»€ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹æ•£ç‚¹å›¾æ˜¯æ¯”åˆ†ç»„å›¾æ›´å¥½çš„å±•ç¤ºæ–¹å¼ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(x }\SpecialCharTok{\textgreater{}=} \DecValTok{4}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x, }\AttributeTok{y =}\NormalTok{ y)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{xlim =} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{11}\NormalTok{), }\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{11}\NormalTok{))}
\end{Highlighting}
\end{Shaded}
\item
  ä½¿ç”¨\texttt{cut\_number()}åˆ›å»ºåŒ…å«å¤§è‡´ç›¸ç­‰æ•°é‡ç‚¹çš„åˆ†ç»„ï¼Œè€Œä¸æ˜¯ä½¿ç”¨\texttt{cut\_width()}åˆ›å»ºç­‰å®½åº¦çš„åˆ†ç»„ã€‚è¿™
  ç§æ–¹æ³•çš„ä¼˜ç‚¹å’Œç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(smaller, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat, }\AttributeTok{y =}\NormalTok{ price)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_boxplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{group =} \FunctionTok{cut\_number}\NormalTok{(carat, }\DecValTok{20}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{æ¨¡å¼ä¸æ¨¡å‹}\label{ux6a21ux5f0fux4e0eux6a21ux578b}

å¦‚æœä¸¤ä¸ªå˜é‡ä¹‹é—´å­˜åœ¨ç³»ç»Ÿå…³ç³»ï¼Œå®ƒå°†åœ¨æ•°æ®ä¸­å‘ˆç°ä¸ºä¸€ç§æ¨¡å¼ã€‚å¦‚
æœä½ å‘ç°ä¸€ä¸ªæ¨¡å¼ï¼Œé—®é—®è‡ªå·±ï¼š

\begin{itemize}
\tightlist
\item
  è¿™ä¸ªæ¨¡å¼æ˜¯å¦å¯èƒ½æ˜¯å·§åˆï¼ˆå³éšæœºæœºä¼šï¼‰ï¼Ÿ
\item
  ä½ å¦‚ä½•æè¿°è¿™ä¸ªæ¨¡å¼æ‰€æš—ç¤ºçš„å…³ç³»ï¼Ÿ
\item
  è¿™ä¸ªæ¨¡å¼æ‰€æš—ç¤ºçš„å…³ç³»æœ‰å¤šå¼ºï¼Ÿ
\item
  è¿˜æœ‰å“ªäº›å…¶ä»–å˜é‡å¯èƒ½ä¼šå½±å“è¿™ç§å…³ç³»ï¼Ÿ
\item
  å¦‚æœä½ æŸ¥çœ‹æ•°æ®çš„å„ä¸ªå­ç»„ï¼Œè¿™ç§å…³ç³»ä¼šå‘ç”Ÿå˜åŒ–å—ï¼Ÿ
\end{itemize}

æ•°æ®ä¸­çš„æ¨¡å¼æä¾›äº†å…³äºå…³ç³»çš„çº¿ç´¢ï¼Œå³å®ƒä»¬æ­ç¤ºäº†åå˜ã€‚å¦‚
æœä½ æŠŠå˜åŒ–çœ‹ä½œæ˜¯ä¸€ç§äº§ç”Ÿä¸ç¡®å®šæ€§çš„ç°è±¡ï¼Œé‚£ä¹ˆåå˜å°±æ˜¯ä¸€ç§å‡å°‘è¿™ç§ä¸ç¡®å®šæ€§çš„ç°è±¡ã€‚å¦‚
æœä¸¤ä¸ªå˜é‡åå˜ï¼Œä½ å¯ä»¥åˆ©ç”¨ä¸€ä¸ªå˜é‡çš„å€¼æ¥æ›´å¥½åœ°é¢„æµ‹ç¬¬äºŒä¸ªå˜é‡çš„å€¼ã€‚å¦‚
æœåå˜æ˜¯ç”±å› æœå…³ç³»ï¼ˆä¸€ä¸ªç‰¹æ®Šæƒ…å†µï¼‰å¼•èµ·çš„ï¼Œé‚£ä¹ˆä½ å¯ä»¥ç”¨ä¸€ä¸ªå˜é‡çš„å€¼æ¥æ§åˆ¶ç¬¬äºŒä¸ªå˜é‡çš„å€¼ã€‚

æ¨¡å‹æ˜¯ä»æ•°æ®ä¸­æå–æ¨¡å¼çš„å·¥å…·ã€‚ä¾‹
å¦‚ï¼Œè€ƒè™‘é’»çŸ³æ•°æ®ï¼Œå¾ˆéš¾ç†è§£åˆ‡å·¥å’Œä»·æ ¼ä¹‹é—´çš„å…³ç³»ï¼Œå› ä¸ºåˆ‡å·¥å’Œå…‹æ‹‰æ•°ï¼Œä»¥åŠå…‹æ‹‰æ•°å’Œä»·æ ¼ä¹‹é—´å­˜åœ¨ç´§å¯†å…³ç³»ã€‚æˆ‘
ä»¬å¯ä»¥ä½¿ç”¨æ¨¡å‹æ¥æ¶ˆé™¤ä»·æ ¼å’Œå…‹æ‹‰æ•°ä¹‹é—´çš„éå¸¸å¼ºçš„å…³ç³»ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥æ¢ç´¢å‰©ä½™çš„ç»†å¾®å·®åˆ«ã€‚ä»¥
ä¸‹ä»£ç æ‹Ÿåˆäº†ä¸€ä¸ªä»\texttt{carat}é¢„æµ‹\texttt{price}çš„æ¨¡å‹ï¼Œç„¶åè®¡ç®—æ®‹å·®ï¼ˆé¢„æµ‹å€¼ä¸å®é™…å€¼ä¹‹é—´çš„å·®å¼‚ï¼‰ã€‚ä¸€
æ—¦å»é™¤äº†å…‹æ‹‰æ•°çš„å½±å“ï¼Œæ®‹å·®å°±ç»™äº†æˆ‘ä»¬é’»çŸ³ä»·æ ¼çš„ä¸€ä¸ªè§†å›¾ã€‚è¯·
æ³¨æ„ï¼Œæˆ‘ä»¬ä¸æ˜¯ç›´æ¥ä½¿ç”¨\texttt{price}å’Œ\texttt{carat}çš„åŸå§‹å€¼ï¼Œè€Œæ˜¯é¦–å…ˆå¯¹å®ƒä»¬è¿›è¡Œå¯¹æ•°è½¬æ¢ï¼Œå¹¶å¯¹å¯¹æ•°è½¬æ¢åçš„å€¼æ‹Ÿåˆæ¨¡å‹ã€‚ç„¶
åï¼Œæˆ‘ä»¬å¯¹æ®‹å·®è¿›è¡ŒæŒ‡æ•°åŒ–ï¼Œä»¥å°†å…¶é‡æ–°æ”¾å…¥åŸå§‹ä»·æ ¼çš„å°ºåº¦ä¸Šã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidymodels)}

\NormalTok{diamonds }\OtherTok{\textless{}{-}}\NormalTok{ diamonds }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{log\_price =} \FunctionTok{log}\NormalTok{(price),}
    \AttributeTok{log\_carat =} \FunctionTok{log}\NormalTok{(carat)}
\NormalTok{  )}

\NormalTok{diamonds\_fit }\OtherTok{\textless{}{-}} \FunctionTok{linear\_reg}\NormalTok{() }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{fit}\NormalTok{(log\_price }\SpecialCharTok{\textasciitilde{}}\NormalTok{ log\_carat, }\AttributeTok{data =}\NormalTok{ diamonds)}

\NormalTok{diamonds\_aug }\OtherTok{\textless{}{-}} \FunctionTok{augment}\NormalTok{(diamonds\_fit, }\AttributeTok{new\_data =}\NormalTok{ diamonds) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{.resid =} \FunctionTok{exp}\NormalTok{(.resid))}

\FunctionTok{ggplot}\NormalTok{(diamonds\_aug, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat, }\AttributeTok{y =}\NormalTok{ .resid)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-30-1.png}

ä¸€æ—¦æ¶ˆé™¤äº†å…‹æ‹‰æ•°å’Œä»·æ ¼ä¹‹é—´çš„å¼ºå…³ç³»ï¼Œä½ å°±å¯ä»¥çœ‹åˆ°åˆ‡å·¥å’Œä»·æ ¼ä¹‹é—´çš„å…³ç³»æ˜¯ä½ æ‰€é¢„æœŸçš„ï¼šç›¸å¯¹äºå®ƒä»¬çš„å¤§å°ï¼Œè´¨é‡å¥½çš„é’»çŸ³æ›´æ˜‚è´µã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(diamonds\_aug, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cut, }\AttributeTok{y =}\NormalTok{ .resid)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{EDA_files/figure-pdf/unnamed-chunk-31-1.pdf}

æœ¬ä¹¦å¹¶æœªè®¨è®ºå»ºæ¨¡ï¼Œå› ä¸ºä¸€æ—¦ä½ æŒæ¡äº†æ•°æ®å¤„ç†å’Œç¼–ç¨‹çš„å·¥å…·ï¼Œç†è§£æ¨¡å‹æ˜¯ä»€ä¹ˆä»¥åŠå®ƒä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„å°±ä¼šå˜å¾—æ›´åŠ å®¹æ˜“ã€‚

\section{å°ç»“}\label{ux5c0fux7ed3-9}

åœ¨è¿™ä¸€ç« ä¸­ï¼Œä½ å­¦ä¹ äº†å¤šç§å·¥å…·æ¥å¸®åŠ©ä½ ç†è§£æ•°æ®ä¸­çš„å˜åŒ–ã€‚ä½ 
å·²ç»çœ‹åˆ°äº†é’ˆå¯¹å•ä¸ªå˜é‡å’Œå˜é‡å¯¹çš„æŠ€æœ¯ã€‚å¦‚
æœä½ çš„æ•°æ®ä¸­æœ‰æ•°åä¸ªæˆ–æ•°ç™¾ä¸ªå˜é‡ï¼Œè¿™äº›æŠ€æœ¯å¯èƒ½çœ‹èµ·æ¥éå¸¸æœ‰é™ï¼Œä½†å®ƒä»¬æ˜¯æ‰€æœ‰å…¶ä»–æŠ€æœ¯çš„åŸºç¡€ã€‚

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä¸“æ³¨äºå¯ä»¥ç”¨æ¥äº¤æµç»“æœçš„å·¥å…·ã€‚

\chapter{äº¤æµ}\label{sec-communication}

\section{å¼•è¨€}\label{ux5f15ux8a00-6}

åœ¨ ç« èŠ‚~\ref{sec-exploratory-data-analysis}
ä¸­ï¼Œä½ å­¦ä¹ äº†å¦‚ä½•å°†å›¾å½¢ç”¨ä½œæ¢ç´¢å·¥å…·ã€‚å½“
ä½ åˆ¶ä½œæ¢ç´¢æ€§å›¾å½¢æ—¶ï¼Œä½ ç”šè‡³åœ¨æŸ¥çœ‹ä¹‹å‰å°±çŸ¥é“å›¾ä¸­å°†æ˜¾ç¤ºå“ªäº›å˜é‡ã€‚ä½ 
ä¸ºäº†æŸä¸ªç›®çš„åˆ¶ä½œæ¯ä¸ªå›¾å½¢ï¼Œå¯ä»¥å¿«é€ŸæŸ¥çœ‹å®ƒï¼Œç„¶åç§»è‡³ä¸‹ä¸€ä¸ªå›¾å½¢ã€‚åœ¨
å¤§å¤šæ•°åˆ†æè¿‡ç¨‹ä¸­ï¼Œä½ ä¼šç”Ÿæˆæ•°åä¸ªæˆ–æ•°ç™¾ä¸ªå›¾å½¢ï¼Œå…¶ä¸­å¤§å¤šæ•°ä¼šç«‹å³è¢«ä¸¢å¼ƒã€‚

ç°åœ¨ä½ ç†è§£äº†ä½ çš„æ•°æ®ï¼Œä½ éœ€è¦å°†ä½ çš„ç†è§£ä¸ä»–äººäº¤æµã€‚ä½ 
çš„å¬ä¼—å¯èƒ½ä¸å…·å¤‡ä½ çš„èƒŒæ™¯çŸ¥è¯†ï¼Œä¹Ÿä¸ä¼šå¯¹æ•°æ®æŠ•å…¥å¤ªå¤šå…³æ³¨ã€‚ä¸º
äº†å¸®åŠ©å…¶ä»–äººå¿«é€Ÿå»ºç«‹å¯¹æ•°æ®çš„è‰¯å¥½å¿ƒç†æ¨¡å‹ï¼Œä½ éœ€è¦åœ¨ä½¿å›¾å½¢å°½å¯èƒ½å…·æœ‰è‡ªè§£é‡Šæ€§æ–¹é¢æŠ•å…¥å¤§é‡åŠªåŠ›ã€‚åœ¨
æœ¬ç« ä¸­ï¼Œä½ å°†å­¦ä¹ ggplot2æä¾›çš„ä¸€äº›å·¥å…·æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚

æœ¬ç« é‡ç‚¹å…³æ³¨åˆ›å»ºè‰¯å¥½å›¾å½¢æ‰€éœ€çš„å·¥å…·ã€‚æˆ‘
ä»¬å‡è®¾ä½ çŸ¥é“ä½ æƒ³è¦ä»€ä¹ˆï¼Œåªæ˜¯éœ€è¦çŸ¥é“å¦‚ä½•å»åšã€‚å› 
æ­¤ï¼Œæˆ‘ä»¬å¼ºçƒˆå»ºè®®å°†æœ¬ç« ä¸ä¸€æœ¬ä¼˜ç§€çš„é€šç”¨å¯è§†åŒ–ä¹¦ç±ç»“åˆä½¿ç”¨ã€‚æˆ‘
ä»¬ç‰¹åˆ«å–œæ¬¢Albert
Cairoçš„ã€Š\href{https://www.amazon.com/gp/product/0321934075/}{The
Truthful Art}ã€‹ã€‚è¿™
æœ¬ä¹¦ä¸æ•™æˆåˆ›å»ºå¯è§†åŒ–çš„æœºåˆ¶ï¼Œè€Œæ˜¯ä¸“æ³¨äºä½ éœ€è¦è€ƒè™‘çš„å†…å®¹ä»¥åˆ›å»ºæœ‰æ•ˆçš„å›¾å½¢ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-6}

åœ¨æœ¬ç« ä¸­æˆ‘ä»¬å°†å†æ¬¡ä¸“æ³¨äºggplot2ã€‚æˆ‘
ä»¬è¿˜å°†ä½¿ç”¨dplyrè¿›è¡Œä¸€äº›æ•°æ®æ“ä½œï¼Œä½¿ç”¨\texttt{scales}æ¥è¦†ç›–é»˜è®¤çš„åˆ»åº¦ã€æ ‡ç­¾ã€å˜æ¢å’Œè°ƒè‰²æ¿ï¼Œä»¥åŠä¸€äº›ggplot2çš„æ‰©å±•åŒ…ï¼ŒåŒ…æ‹¬Kamil
Slowikowskiçš„\texttt{ggrepel}ï¼ˆ\href{https://ggrepel.slowkow.com/}{https://ggrepel.slowkow.com}ï¼‰å’ŒThomas
Lin
Pedersençš„\texttt{patchwork}ï¼ˆ\href{https://patchwork.data-imaginist.com/}{https://patchwork.data-imaginist.com}ï¼‰ã€‚å¦‚
æœä½ è¿˜æ²¡æœ‰è¿™äº›åŒ…ï¼Œåˆ«å¿˜äº†ä½¿ç”¨\texttt{install.packages()}æ¥å®‰è£…å®ƒä»¬ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(scales)}
\FunctionTok{library}\NormalTok{(ggrepel)}
\FunctionTok{library}\NormalTok{(patchwork)}
\end{Highlighting}
\end{Shaded}

\section{æ ‡ç­¾}\label{ux6807ux7b7e}

å°†æ¢ç´¢æ€§å›¾å½¢è½¬æ¢ä¸ºè¯´æ˜æ€§å›¾å½¢çš„æœ€ç®€å•èµ·ç‚¹æ˜¯ä½¿ç”¨å¥½çš„æ ‡ç­¾ã€‚ä½ 
å¯ä»¥ä½¿ç”¨\texttt{labs()}å‡½æ•°æ¥æ·»åŠ æ ‡ç­¾ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ class)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{x =} \StringTok{"Engine displacement (L)"}\NormalTok{,}
    \AttributeTok{y =} \StringTok{"Highway fuel economy (mpg)"}\NormalTok{,}
    \AttributeTok{color =} \StringTok{"Car type"}\NormalTok{,}
    \AttributeTok{title =} \StringTok{"Fuel efficiency generally decreases with engine size"}\NormalTok{,}
    \AttributeTok{subtitle =} \StringTok{"Two seaters (sports cars) are an exception because of their light weight"}\NormalTok{,}
    \AttributeTok{caption =} \StringTok{"Data from fueleconomy.gov"}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-3-1.pdf}

å›¾å½¢çš„æ ‡é¢˜ï¼ˆ\texttt{title}ï¼‰æ˜¯ä¸ºäº†æ¦‚æ‹¬ä¸»è¦å‘ç°ï¼Œé¿å…ä»…æè¿°å›¾å½¢å†…å®¹çš„æ ‡é¢˜ï¼Œä¾‹å¦‚``å‘åŠ¨æœºæ’é‡å’Œç‡ƒæ²¹ç»æµæ€§çš„æ•£ç‚¹å›¾å½¢''ã€‚

å¦‚æœä½ éœ€è¦æ·»åŠ æ›´å¤šæ–‡æœ¬ï¼Œè¿˜æœ‰å¦å¤–ä¸¤ä¸ªæœ‰ç”¨çš„æ ‡ç­¾ï¼šå‰¯æ ‡é¢˜ï¼ˆ\texttt{subtitle}ï¼‰ä»¥è¾ƒå°çš„å­—ä½“åœ¨æ ‡é¢˜ä¸‹æ–¹æ·»åŠ æ›´å¤šç»†èŠ‚ï¼Œè€Œå›¾æ³¨ï¼ˆ\texttt{caption}ï¼‰åœ¨å›¾å½¢çš„å³ä¸‹è§’æ·»åŠ æ–‡æœ¬ï¼Œé€šå¸¸ç”¨äºæè¿°æ•°æ®çš„æ¥æºã€‚ä½ 
è¿˜å¯ä»¥ä½¿ç”¨\texttt{labs()}å‡½æ•°æ¥æ›¿æ¢è½´å’Œå›¾ä¾‹çš„æ ‡é¢˜ã€‚é€š
å¸¸ï¼Œæœ€å¥½å°†ç®€çŸ­çš„å˜é‡åæ›¿æ¢ä¸ºæ›´è¯¦ç»†çš„æè¿°ï¼Œå¹¶åŒ…å«å•ä½ã€‚

å¯ä»¥ä½¿ç”¨æ•°å­¦æ–¹ç¨‹ä»£æ›¿æ–‡æœ¬å­—ç¬¦ä¸²ã€‚åª
éœ€å°†\texttt{""}æ›¿æ¢ä¸º\texttt{quote()}ï¼Œå¹¶æŸ¥é˜…\texttt{?plotmath}ä¸­å…³äºå¯ç”¨é€‰é¡¹çš„ä¿¡æ¯ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{x =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{,}
  \AttributeTok{y =} \FunctionTok{cumsum}\NormalTok{(x}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(x, y)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{x =} \FunctionTok{quote}\NormalTok{(x[i]),}
    \AttributeTok{y =} \FunctionTok{quote}\NormalTok{(}\FunctionTok{sum}\NormalTok{(x[i] }\SpecialCharTok{\^{}} \DecValTok{2}\NormalTok{, i }\SpecialCharTok{==} \DecValTok{1}\NormalTok{, n))}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=0.5\textwidth,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-4-1.pdf}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-23}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  åˆ›å»ºä¸€ä¸ªåŒ…å«è‡ªå®šä¹‰æ ‡é¢˜ã€å‰¯æ ‡é¢˜ã€å›¾æ³¨ã€\texttt{x}è½´ã€\texttt{y}è½´å’Œé¢œè‰²æ ‡ç­¾çš„å…³äºç‡ƒæ²¹ç»æµæ•°æ®çš„å›¾å½¢ã€‚C
  reate one plot on the fuel economy data with customized
  \texttt{title}, \texttt{subtitle}, \texttt{caption}, \texttt{x},
  \texttt{y}, and \texttt{color} labels.
\item
  ä½¿ç”¨ç‡ƒæ²¹ç»æµæ•°æ®é‡æ–°åˆ›å»ºä»¥ä¸‹å›¾å½¢ã€‚è¯·
  æ³¨æ„ï¼Œç‚¹å’Œå½¢çŠ¶çš„é¢œè‰²æ ¹æ®ä¼ åŠ¨ç³»ç»Ÿçš„ç±»å‹è€Œå˜åŒ–ã€‚

  \includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-5-1.pdf}
\item
  é€‰æ‹©ä½ åœ¨è¿‡å»ä¸€ä¸ªæœˆå†…åˆ›å»ºçš„ä¸€ä¸ªæ¢ç´¢æ€§å›¾å½¢ï¼Œå¹¶æ·»åŠ æœ‰ä¿¡æ¯é‡çš„æ ‡é¢˜ï¼Œä»¥ä¾¿å…¶ä»–äººæ›´å®¹æ˜“ç†è§£ã€‚
\end{enumerate}

\section{æ³¨é‡Š}\label{ux6ce8ux91ca-1}

é™¤äº†æ ‡è®°å›¾å½¢çš„ä¸»è¦ç»„ä»¶ä¹‹å¤–ï¼Œæ ‡è®°å•ä¸ªè§‚æµ‹æˆ–è§‚æµ‹ç»„é€šå¸¸ä¹Ÿå¾ˆæœ‰ç”¨ã€‚ä½ 
å¯ä»¥ä½¿ç”¨çš„ç¬¬ä¸€ä¸ªå·¥å…·æ˜¯\texttt{geom\_text()}ã€‚\texttt{g}
\texttt{eom\_text()}ç±»ä¼¼äº\texttt{geom\_point()}ï¼Œä½†å®ƒæœ‰ä¸€ä¸ªé¢å¤–çš„ç¾å­¦å±æ€§ï¼š\texttt{label}ã€‚è¿™
ä½¿å¾—åœ¨ä½ çš„å›¾å½¢ä¸­æ·»åŠ æ–‡æœ¬æ ‡ç­¾æˆä¸ºå¯èƒ½ã€‚

æ ‡ç­¾çš„æ¥æºæœ‰ä¸¤ç§å¯èƒ½ã€‚é¦– å…ˆï¼Œä½ å¯èƒ½æœ‰ä¸€ä¸ªæä¾›æ ‡ç­¾çš„tibbleã€‚åœ¨
ä¸‹é¢çš„å›¾å½¢ä¸­ï¼Œæˆ‘ä»¬æå–äº†æ¯ç§é©±åŠ¨ç±»å‹ä¸­å‘åŠ¨æœºå°ºå¯¸æœ€å¤§çš„æ±½è½¦ï¼Œå¹¶å°†å®ƒä»¬çš„ä¿¡æ¯ä¿å­˜ä¸ºä¸€ä¸ªåä¸º\texttt{label\_info}çš„æ–°æ•°æ®æ¡†ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{label\_info }\OtherTok{\textless{}{-}}\NormalTok{ mpg }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(drv) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(displ)) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{slice\_head}\NormalTok{(}\AttributeTok{n =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{drive\_type =} \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{      drv }\SpecialCharTok{==} \StringTok{"f"} \SpecialCharTok{\textasciitilde{}} \StringTok{"front{-}wheel drive"}\NormalTok{,}
\NormalTok{      drv }\SpecialCharTok{==} \StringTok{"r"} \SpecialCharTok{\textasciitilde{}} \StringTok{"rear{-}wheel drive"}\NormalTok{,}
\NormalTok{      drv }\SpecialCharTok{==} \StringTok{"4"} \SpecialCharTok{\textasciitilde{}} \StringTok{"4{-}wheel drive"}
\NormalTok{    )}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{select}\NormalTok{(displ, hwy, drv, drive\_type)}

\NormalTok{label\_info}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 4}
\CommentTok{\#\textgreater{} \# Groups:   drv [3]}
\CommentTok{\#\textgreater{}   displ   hwy drv   drive\_type       }
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}int\textgreater{} \textless{}chr\textgreater{} \textless{}chr\textgreater{}            }
\CommentTok{\#\textgreater{} 1   6.5    17 4     4{-}wheel drive    }
\CommentTok{\#\textgreater{} 2   5.3    25 f     front{-}wheel drive}
\CommentTok{\#\textgreater{} 3   7      24 r     rear{-}wheel drive}
\end{Highlighting}
\end{Shaded}

ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªæ–°çš„æ•°æ®æ¡†ç›´æ¥æ ‡è®°è¿™ä¸‰ä¸ªç»„ï¼Œç”¨ç›´æ¥æ”¾åœ¨å›¾å½¢ä¸Šçš„æ ‡ç­¾æ›¿æ¢å›¾ä¾‹ã€‚é€š
è¿‡ä½¿ç”¨\texttt{fontface}å’Œ\texttt{size}å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰æ–‡æœ¬æ ‡ç­¾çš„å¤–è§‚ã€‚å®ƒ
ä»¬æ¯”å›¾å½¢ä¸Šå…¶ä½™æ–‡æœ¬çš„å­—ä½“æ›´å¤§ä¸”åŠ ç²—ã€‚ï¼ˆ
\texttt{theme(legend.position\ =\ "none"}
ä¼šå…³é—­æ‰€æœ‰å›¾ä¾‹ï¼Œæˆ‘ä»¬ç¨åä¼šè¯¦ç»†è®¨è®ºå®ƒã€‚ï¼‰

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_text}\NormalTok{(}
    \AttributeTok{data =}\NormalTok{ label\_info, }
    \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{label =}\NormalTok{ drive\_type),}
    \AttributeTok{fontface =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{5}\NormalTok{, }\AttributeTok{hjust =} \StringTok{"right"}\NormalTok{, }\AttributeTok{vjust =} \StringTok{"bottom"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{)}
\CommentTok{\#\textgreater{} \textasciigrave{}geom\_smooth()\textasciigrave{} using method = \textquotesingle{}loess\textquotesingle{} and formula = \textquotesingle{}y \textasciitilde{} x\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-7-1.pdf}

è¯·æ³¨æ„ä½¿ç”¨\texttt{hjust}ï¼ˆæ°´å¹³å¯¹é½ï¼‰å’Œ\texttt{vjust}ï¼ˆå‚ç›´å¯¹é½ï¼‰æ¥æ§åˆ¶æ ‡ç­¾çš„å¯¹é½æ–¹å¼ã€‚

ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¸Šé¢åˆ¶ä½œçš„å¸¦æœ‰æ³¨é‡Šçš„å›¾å½¢å¾ˆéš¾é˜…è¯»ï¼Œå› ä¸ºæ ‡ç­¾ç›¸äº’é‡å ï¼Œå¹¶ä¸”ä¸ç‚¹é‡å ã€‚æˆ‘
ä»¬å¯ä»¥ä½¿ç”¨\texttt{ggrepel}åŒ…ä¸­çš„\texttt{geom\_label\_repel()}å‡½æ•°æ¥è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ã€‚è¿™
ä¸ªåŒ…ä¼šè‡ªåŠ¨è°ƒæ•´æ ‡ç­¾çš„ä½ç½®ï¼Œä»¥é¿å…å®ƒä»¬é‡å ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.3}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_label\_repel}\NormalTok{(}
    \AttributeTok{data =}\NormalTok{ label\_info, }
    \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{label =}\NormalTok{ drive\_type),}
    \AttributeTok{fontface =} \StringTok{"bold"}\NormalTok{, }\AttributeTok{size =} \DecValTok{5}\NormalTok{, }\AttributeTok{nudge\_y =} \DecValTok{2}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"none"}\NormalTok{)}
\CommentTok{\#\textgreater{} \textasciigrave{}geom\_smooth()\textasciigrave{} using method = \textquotesingle{}loess\textquotesingle{} and formula = \textquotesingle{}y \textasciitilde{} x\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-8-1.pdf}

ä½ è¿˜å¯ä»¥ä½¿ç”¨ç›¸åŒçš„æ–¹æ³•æ¥çªå‡ºæ˜¾ç¤º\texttt{ggrepel}åŒ…ä¸­\texttt{geom\_text\_repel()}å‡½æ•°åœ¨å›¾å½¢ä¸Šçš„æŸäº›ç‚¹ã€‚è¯·
æ³¨æ„è¿™é‡Œä½¿ç”¨çš„å¦ä¸€ä¸ªå®ç”¨çš„æŠ€å·§ï¼šæˆ‘ä»¬æ·»åŠ äº†ä¸€å±‚å¤§ä¸”ç©ºå¿ƒçš„ç‚¹ä½œä¸ºç¬¬äºŒå±‚ï¼Œä»¥è¿›ä¸€æ­¥çªå‡ºæ˜¾ç¤ºå¸¦æœ‰æ ‡ç­¾çš„ç‚¹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{potential\_outliers }\OtherTok{\textless{}{-}}\NormalTok{ mpg }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{filter}\NormalTok{(hwy }\SpecialCharTok{\textgreater{}} \DecValTok{40} \SpecialCharTok{|}\NormalTok{ (hwy }\SpecialCharTok{\textgreater{}} \DecValTok{20} \SpecialCharTok{\&}\NormalTok{ displ }\SpecialCharTok{\textgreater{}} \DecValTok{5}\NormalTok{))}
  
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_text\_repel}\NormalTok{(}\AttributeTok{data =}\NormalTok{ potential\_outliers, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{label =}\NormalTok{ model)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{data =}\NormalTok{ potential\_outliers, }\AttributeTok{color =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}
    \AttributeTok{data =}\NormalTok{ potential\_outliers,}
    \AttributeTok{color =} \StringTok{"red"}\NormalTok{, }\AttributeTok{size =} \DecValTok{3}\NormalTok{, }\AttributeTok{shape =} \StringTok{"circle open"}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-9-1.pdf}

è¯·è®°ä½ï¼Œé™¤äº†\texttt{geom\_text()}å’Œ\texttt{geom\_label()}ä¹‹å¤–ï¼Œggplot2ä¸­è¿˜æœ‰è®¸å¤šå…¶ä»–geomså¯ç”¨äºå¸®åŠ©ä½ æ³¨é‡Šä½ çš„å›¾å½¢ã€‚è¿™
é‡Œæœ‰å‡ ä¸ªæƒ³æ³•ï¼š

\begin{itemize}
\item
  ä½¿ç”¨\texttt{geom\_hline()}å’Œ\texttt{geom\_vline()}æ¥æ·»åŠ å‚è€ƒçº¿ã€‚æˆ‘
  ä»¬ç»å¸¸ä½¿å®ƒä»¬åŠ ç²—ï¼ˆ\texttt{linewidth\ =\ 2}ï¼‰å’Œä¸ºç™½è‰²ï¼ˆ\texttt{color\ =\ white}ï¼‰ï¼Œå¹¶åœ¨ä¸»è¦æ•°æ®å±‚ä¸‹é¢ç»˜åˆ¶å®ƒä»¬ã€‚è¿™
  ä½¿å¾—å®ƒä»¬æ˜“äºæŸ¥çœ‹ï¼Œè€Œä¸ä¼šåˆ†æ•£å¯¹æ•°æ®çš„æ³¨æ„åŠ›ã€‚
\item
  ä½¿ç”¨\texttt{geom\_rect()}åœ¨æ„Ÿå…´è¶£çš„ç‚¹ä¸Šç”»ä¸€ä¸ªçŸ©å½¢ã€‚çŸ©
  å½¢çš„è¾¹ç•Œç”±ç¾å­¦å±æ€§\texttt{xmin}, \texttt{xmax}, \texttt{ymin},
  \texttt{ymax}å®šä¹‰ã€‚å¦
  å¤–ï¼Œè¯·æŸ¥çœ‹\href{https://ggforce.data-imaginist.com/index.html}{ggforce}åŒ…ï¼Œç‰¹åˆ«æ˜¯\href{https://ggforce.data-imaginist.com/reference/geom_mark_hull.html}{\texttt{geom\_mark\_hull()}}ï¼Œå®ƒå…è®¸ä½ ä½¿ç”¨å‡¸åŒ…æ¥æ³¨é‡Šç‚¹çš„å­é›†ã€‚
\item
  ä½¿ç”¨å¸¦æœ‰\texttt{arrow}å‚æ•°çš„\texttt{geom\_segment()}æ¥ç”¨ç®­å¤´å¸å¼•å¯¹æŸä¸ªç‚¹çš„æ³¨æ„ã€‚ä½¿
  ç”¨ç¾å­¦å±æ€§\texttt{x}å’Œ\texttt{y}å®šä¹‰èµ·å§‹ä½ç½®ï¼Œä½¿ç”¨\texttt{xend}å’Œ\texttt{yend}å®šä¹‰ç»“æŸä½ç½®ã€‚
\end{itemize}

å¦ä¸€ä¸ªç”¨äºå‘å›¾å½¢æ·»åŠ æ³¨é‡Šçš„å®ç”¨å‡½æ•°æ˜¯\texttt{annotate()}ã€‚ä½œ
ä¸ºä¸€èˆ¬è§„åˆ™ï¼Œgeomsé€šå¸¸ç”¨äºçªå‡ºæ˜¾ç¤ºæ•°æ®çš„ä¸€ä¸ªå­é›†ï¼Œè€Œ\texttt{annotate()}åˆ™ç”¨äºå‘å›¾å½¢æ·»åŠ ä¸€ä¸ªæˆ–å°‘æ•°å‡ ä¸ªæ³¨é‡Šå…ƒç´ ã€‚

ä¸ºäº†æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨\texttt{annotate()}ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€äº›æ–‡æœ¬å¹¶å°†å…¶æ·»åŠ åˆ°æˆ‘ä»¬çš„å›¾å½¢ä¸­ã€‚æ–‡
æœ¬æœ‰ç‚¹é•¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä½¿ç”¨\texttt{stringr::str\_wrap()}æ¥æ ¹æ®æ¯è¡Œæ‰€éœ€çš„å­—ç¬¦æ•°è‡ªåŠ¨æ·»åŠ æ¢è¡Œç¬¦ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{trend\_text }\OtherTok{\textless{}{-}} \StringTok{"Larger engine sizes tend to have lower fuel economy."} \SpecialCharTok{|\textgreater{}}
  \FunctionTok{str\_wrap}\NormalTok{(}\AttributeTok{width =} \DecValTok{30}\NormalTok{)}
\NormalTok{trend\_text}
\CommentTok{\#\textgreater{} [1] "Larger engine sizes tend to\textbackslash{}nhave lower fuel economy."}
\end{Highlighting}
\end{Shaded}

ç„¶åï¼Œæˆ‘ä»¬æ·»åŠ ä¸¤å±‚æ³¨é‡Šï¼šä¸€å±‚ä½¿ç”¨æ ‡ç­¾geomï¼Œå¦ä¸€å±‚ä½¿ç”¨çº¿æ®µgeomã€‚ä¸¤
è€…ä¸­çš„\texttt{x}å’Œ\texttt{y}ç¾å­¦å±æ€§å®šä¹‰äº†æ³¨é‡Šåº”è¯¥ä»å“ªé‡Œå¼€å§‹ï¼Œè€Œçº¿æ®µæ³¨é‡Šä¸­çš„\texttt{xend}å’Œ\texttt{yend}ç¾å­¦å±æ€§å®šä¹‰äº†çº¿æ®µçš„ç»“æŸä½ç½®ã€‚è¿˜
è¯·æ³¨æ„ï¼Œçº¿æ®µè¢«è®¾ç½®ä¸ºç®­å¤´çš„æ ·å¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}
    \AttributeTok{geom =} \StringTok{"label"}\NormalTok{, }\AttributeTok{x =} \FloatTok{3.5}\NormalTok{, }\AttributeTok{y =} \DecValTok{38}\NormalTok{,}
    \AttributeTok{label =}\NormalTok{ trend\_text,}
    \AttributeTok{hjust =} \StringTok{"left"}\NormalTok{, }\AttributeTok{color =} \StringTok{"red"}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{annotate}\NormalTok{(}
    \AttributeTok{geom =} \StringTok{"segment"}\NormalTok{,}
    \AttributeTok{x =} \DecValTok{3}\NormalTok{, }\AttributeTok{y =} \DecValTok{35}\NormalTok{, }\AttributeTok{xend =} \DecValTok{5}\NormalTok{, }\AttributeTok{yend =} \DecValTok{25}\NormalTok{, }\AttributeTok{color =} \StringTok{"red"}\NormalTok{,}
    \AttributeTok{arrow =} \FunctionTok{arrow}\NormalTok{(}\AttributeTok{type =} \StringTok{"closed"}\NormalTok{)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-11-1.pdf}

æ³¨é‡Šæ˜¯ä¸€ç§å¼ºå¤§çš„å·¥å…·ï¼Œç”¨äºäº¤æµä½ çš„å¯è§†åŒ–çš„ä¸»è¦å†…å®¹å’Œæœ‰è¶£ç‰¹æ€§ã€‚å”¯
ä¸€çš„é™åˆ¶æ˜¯ä½ çš„æƒ³è±¡åŠ›ï¼ˆä»¥åŠä½ è€å¿ƒåœ°è°ƒæ•´æ³¨é‡Šä½ç½®ä»¥è¾¾åˆ°ç¾è§‚çš„è€å¿ƒï¼‰ï¼

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-24}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ä½¿ç”¨\texttt{geom\_text()}å¹¶é€šè¿‡è®¾ç½®æ¥è¿‘è¾¹ç•Œçš„åæ ‡å€¼æ¥åœ¨å›¾çš„å››ä¸ªè§’è½æ”¾ç½®æ–‡æœ¬ã€‚
\item
  ä½¿ç”¨\texttt{annotate()}åœ¨æœ€åä¸€ä¸ªå›¾çš„ä¸­å¿ƒæ·»åŠ ä¸€ä¸ªç‚¹ï¼Œè€Œæ— éœ€åˆ›å»ºä¸€ä¸ªtibbleã€‚è‡ª
  å®šä¹‰ç‚¹çš„å½¢çŠ¶ã€å¤§å°æˆ–é¢œè‰²ã€‚
\item
  \texttt{geom\_text()}ä¸­çš„æ ‡ç­¾æ˜¯å¦‚ä½•ä¸åˆ†é¢äº¤äº’çš„ï¼Ÿä½ 
  å¦‚ä½•ç»™å•ä¸ªåˆ†é¢æ·»åŠ ä¸€ä¸ªæ ‡ç­¾ï¼Ÿä½  å¦‚ä½•åœ¨æ¯ä¸ªåˆ†é¢ä¸­æ·»åŠ ä¸åŒçš„æ ‡ç­¾ï¼Ÿï¼ˆ
  æç¤ºï¼šè€ƒè™‘ä¼ é€’ç»™\texttt{geom\_text()}çš„æ•°æ®é›†ï¼‰
\item
  \texttt{geom\_label()}çš„å“ªäº›å‚æ•°æ§åˆ¶èƒŒæ™¯æ¡†çš„å¤–è§‚ï¼Ÿ
\item
  \texttt{arrow()}å‡½æ•°çš„å››ä¸ªå‚æ•°æ˜¯ä»€ä¹ˆï¼Ÿå®ƒ ä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿåˆ›
  å»ºä¸€ç³»åˆ—å›¾è¡¨æ¥å±•ç¤ºæœ€é‡è¦çš„é€‰é¡¹ã€‚
\end{enumerate}

\section{æ¯”ä¾‹å°º}\label{ux6bd4ux4f8bux5c3a}

ä½¿å›¾å½¢æ›´æ˜“äºä¼ è¾¾ä¿¡æ¯çš„ç¬¬ä¸‰ç§æ–¹æ³•æ˜¯è°ƒæ•´æ¯”ä¾‹å°ºã€‚æ¯”
ä¾‹å°ºæ§åˆ¶ç€ç¾å­¦æ˜ å°„å¦‚ä½•ä»¥è§†è§‰å½¢å¼å±•ç°ã€‚

\subsection{é»˜è®¤æ¯”ä¾‹å°º}\label{ux9ed8ux8ba4ux6bd4ux4f8bux5c3a}

é€šå¸¸ï¼Œggplot2 ä¼šè‡ªåŠ¨ä¸ºä½ æ·»åŠ æ¯”ä¾‹å°ºã€‚ä¾‹ å¦‚ï¼Œå½“ä½ è¾“å…¥ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ class))}
\end{Highlighting}
\end{Shaded}

ggplot2 åœ¨åå°è‡ªåŠ¨æ·»åŠ é»˜è®¤æ¯”ä¾‹å°º:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ class)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_discrete}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„æ¯”ä¾‹å°ºçš„å‘½åæ–¹æ¡ˆï¼šä»¥\texttt{scale\_}å¼€å¤´ï¼Œåé¢æ˜¯ç¾å­¦çš„åç§°ï¼Œç„¶åæ˜¯\texttt{\_}ï¼Œå†ç„¶åæ˜¯æ¯”ä¾‹å°ºçš„åç§°ã€‚é»˜
è®¤çš„æ¯”ä¾‹å°ºæ˜¯æ ¹æ®å®ƒä»¬ä¸ä¹‹å¯¹é½çš„å˜é‡ç±»å‹æ¥å‘½åçš„ï¼šè¿ç»­ã€ç¦»æ•£ã€æ—¥æœŸæ—¶é—´æˆ–æ—¥æœŸã€‚\texttt{s}
\texttt{cale\_x\_continuous()}å°†\texttt{displ}çš„æ•°å€¼ä»¥è¿ç»­çš„æ•°å­—çº¿å½¢å¼æ”¾åœ¨
x
è½´ä¸Šï¼Œ\texttt{scale\_color\_discrete()}ä¸ºæ¯ç§è½¦å‹ç±»åˆ«é€‰æ‹©é¢œè‰²ï¼Œç­‰ç­‰ã€‚ä¸‹
é¢å°†ä»‹ç»è®¸å¤šéé»˜è®¤çš„æ¯”ä¾‹å°ºã€‚

é»˜è®¤çš„æ¯”ä¾‹å°ºå·²ç»è¢«ç²¾å¿ƒé€‰æ‹©ï¼Œä»¥ä¾¿ä¸ºå¹¿æ³›çš„è¾“å…¥æä¾›è‰¯å¥½çš„å·¥ä½œæ•ˆæœã€‚ç„¶
è€Œï¼Œä½ å¯èƒ½æƒ³è¦å‡ºäºä¸¤ä¸ªåŸå› è¦†ç›–é»˜è®¤å€¼ï¼š

\begin{itemize}
\tightlist
\item
  ä½ å¯èƒ½æƒ³è¦è°ƒæ•´é»˜è®¤æ¯”ä¾‹å°ºçš„ä¸€äº›å‚æ•°ã€‚è¿™å…è®¸ä½ åšä¸€äº›äº‹æƒ…ï¼Œæ¯”å¦‚æ”¹å˜è½´ä¸Šçš„åˆ»åº¦æˆ–å›¾ä¾‹ä¸Šçš„é”®æ ‡ç­¾ã€‚
\item
  ä½ å¯èƒ½æƒ³è¦å®Œå…¨æ›¿æ¢æ¯”ä¾‹å°ºï¼Œå¹¶ä½¿ç”¨å®Œå…¨ä¸åŒçš„ç®—æ³•ã€‚é€šå¸¸ï¼Œç”±äºä½ æ›´äº†è§£æ•°æ®ï¼Œæ‰€ä»¥ä½ å¯ä»¥åšå¾—æ¯”é»˜è®¤å€¼æ›´å¥½ã€‚
\end{itemize}

è½´åˆ»åº¦å’Œå›¾ä¾‹é”®

è½´å’Œå›¾ä¾‹ç»Ÿç§°ä¸º``æŒ‡å—''ã€‚è½´ ç”¨äº x å’Œ y ç¾å­¦ï¼›å›¾ä¾‹ç”¨äºå…¶ä»–æ‰€æœ‰å†…å®¹ã€‚

æœ‰ä¸¤ä¸ªä¸»è¦å‚æ•°å½±å“è½´ä¸Šçš„åˆ»åº¦å’Œå›¾ä¾‹ä¸Šçš„é”®çš„å¤–è§‚ï¼š\texttt{breaks}~å’Œ~\texttt{labels}ã€‚\texttt{b}
\texttt{reaks}~æ§åˆ¶åˆ»åº¦çš„ä½ç½®æˆ–ä¸é”®å…³è”çš„å€¼ã€‚\texttt{l}
\texttt{abels}~æ§åˆ¶ä¸æ¯ä¸ªåˆ»åº¦/é”®å…³è”çš„æ–‡æœ¬æ ‡ç­¾ã€‚\texttt{b}
\texttt{reaks}~çš„æœ€å¸¸è§ç”¨æ³•æ˜¯è¦†ç›–é»˜è®¤é€‰æ‹©ï¼š

\subsection{è½´åˆ»åº¦å’Œå›¾ä¾‹é”®}\label{ux8f74ux523bux5ea6ux548cux56feux4f8bux952e}

è½´å’Œå›¾ä¾‹ç»Ÿç§°ä¸º``æŒ‡å—''ã€‚è½´ ç”¨äº x å’Œ y ç¾å­¦ï¼›å›¾ä¾‹ç”¨äºå…¶ä»–æ‰€æœ‰å†…å®¹ã€‚

æœ‰ä¸¤ä¸ªä¸»è¦å‚æ•°å½±å“è½´ä¸Šçš„åˆ»åº¦å’Œå›¾ä¾‹ä¸Šçš„é”®çš„å¤–è§‚ï¼š\texttt{breaks}å’Œ\texttt{labels}ã€‚\texttt{b}
\texttt{reaks}æ§åˆ¶åˆ»åº¦çš„ä½ç½®æˆ–ä¸é”®å…³è”çš„å€¼ã€‚\texttt{l}
\texttt{abels}æ§åˆ¶ä¸æ¯ä¸ªåˆ»åº¦/é”®å…³è”çš„æ–‡æœ¬æ ‡ç­¾ã€‚\texttt{b}
\texttt{reaks}çš„æœ€å¸¸è§ç”¨æ³•æ˜¯è¦†ç›–é»˜è®¤é€‰æ‹©ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{15}\NormalTok{, }\DecValTok{40}\NormalTok{, }\AttributeTok{by =} \DecValTok{5}\NormalTok{)) }
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-14-1.pdf}

ä½ å¯ä»¥ä»¥ç›¸åŒçš„æ–¹å¼ä½¿ç”¨\texttt{labels}ï¼ˆä¸€ä¸ªä¸\texttt{breaks}ç›¸åŒé•¿åº¦çš„å­—ç¬¦å‘é‡ï¼‰ï¼Œä½†ä½ ä¹Ÿå¯ä»¥å°†å…¶è®¾ç½®ä¸º\texttt{NULL}ä»¥å®Œå…¨æŠ‘åˆ¶æ ‡ç­¾çš„æ˜¾ç¤ºã€‚è¿™
åœ¨åœ°å›¾æˆ–å‘å¸ƒå›¾è¡¨æ—¶éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºåœ¨è¿™äº›æƒ…å†µä¸‹ä½ å¯èƒ½æ— æ³•åˆ†äº«ç»å¯¹æ•°å€¼ã€‚ä½ 
è¿˜å¯ä»¥ä½¿ç”¨\texttt{breaks}å’Œ\texttt{labels}æ¥æ§åˆ¶å›¾ä¾‹çš„å¤–è§‚ã€‚å¯¹
äºåˆ†ç±»å˜é‡çš„ç¦»æ•£æ¯”ä¾‹å°ºï¼Œ\texttt{labels}å¯ä»¥æ˜¯ä¸€ä¸ªå‘½ååˆ—è¡¨ï¼Œå…¶ä¸­åˆ—å‡ºäº†ç°æœ‰æ°´å¹³åç§°ä»¥åŠä¸ºå®ƒä»¬æŒ‡å®šçš„æ ‡ç­¾ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{labels =} \ConstantTok{NULL}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{labels =} \ConstantTok{NULL}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_discrete}\NormalTok{(}\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"4"} \OtherTok{=} \StringTok{"4{-}wheel"}\NormalTok{, }\StringTok{"f"} \OtherTok{=} \StringTok{"front"}\NormalTok{, }\StringTok{"r"} \OtherTok{=} \StringTok{"rear"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-15-1.pdf}

\texttt{labels}å‚æ•°~\texttt{scales}åŒ…ä¸­çš„æ ‡ç­¾å‡½æ•°ç»“åˆä½¿ç”¨ï¼Œè¿˜å¯ç”¨äºå°†æ•°å­—æ ¼å¼åŒ–ä¸ºè´§å¸ã€ç™¾åˆ†æ¯”ç­‰ã€‚å·¦
è¾¹çš„å›¾å½¢æ˜¾ç¤ºäº†ä½¿ç”¨\texttt{label\_dollar()}çš„é»˜è®¤æ ‡ç­¾ï¼Œå®ƒæ·»åŠ äº†ç¾å…ƒç¬¦å·å’Œåƒä½åˆ†éš”ç¬¦é€—å·ã€‚å³
è¾¹çš„å›¾å½¢é€šè¿‡è¿›ä¸€æ­¥å®šåˆ¶ï¼Œå°†ç¾å…ƒå€¼é™¤ä»¥1,000å¹¶æ·»åŠ åç¼€``K''ï¼ˆä»£è¡¨``åƒ''ï¼‰ï¼Œä»¥åŠæ·»åŠ è‡ªå®šä¹‰åˆ»åº¦ã€‚è¯·
æ³¨æ„ï¼Œ\texttt{breaks}æ˜¯åŸºäºæ•°æ®çš„åŸå§‹å°ºåº¦ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Left}
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ price, }\AttributeTok{y =}\NormalTok{ cut)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.05}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{labels =} \FunctionTok{label\_dollar}\NormalTok{())}

\CommentTok{\# Right}
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ price, }\AttributeTok{y =}\NormalTok{ cut)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.05}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}
    \AttributeTok{labels =} \FunctionTok{label\_dollar}\NormalTok{(}\AttributeTok{scale =} \DecValTok{1}\SpecialCharTok{/}\DecValTok{1000}\NormalTok{, }\AttributeTok{suffix =} \StringTok{"K"}\NormalTok{), }
    \AttributeTok{breaks =} \FunctionTok{seq}\NormalTok{(}\DecValTok{1000}\NormalTok{, }\DecValTok{19000}\NormalTok{, }\AttributeTok{by =} \DecValTok{6000}\NormalTok{)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-16-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-16-2.pdf}\end{minipage}%

\end{figure}%

å¦ä¸€ä¸ªæ–¹ä¾¿çš„æ ‡ç­¾å‡½æ•°æ˜¯ \texttt{label\_percent()}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cut, }\AttributeTok{fill =}\NormalTok{ clarity)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position =} \StringTok{"fill"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{name =} \StringTok{"Percentage"}\NormalTok{, }\AttributeTok{labels =} \FunctionTok{label\_percent}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-17-1.pdf}

\texttt{breaks}çš„å¦ä¸€ä¸ªç”¨é€”æ˜¯å½“ä½ çš„æ•°æ®ç‚¹ç›¸å¯¹è¾ƒå°‘ï¼Œå¹¶ä¸”å¸Œæœ›å‡†ç¡®åœ°çªå‡ºæ˜¾ç¤ºè§‚æµ‹å‘ç”Ÿçš„ä½ç½®æ—¶ã€‚ä¾‹
å¦‚ï¼Œè¿™å¼ å›¾æ˜¾ç¤ºäº†æ¯ä½ç¾å›½æ€»ç»Ÿä»»æœŸçš„å¼€å§‹å’Œç»“æŸæ—¶é—´ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{presidential }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{id =} \DecValTok{33} \SpecialCharTok{+} \FunctionTok{row\_number}\NormalTok{()) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ start, }\AttributeTok{y =}\NormalTok{ id)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_segment}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{xend =}\NormalTok{ end, }\AttributeTok{yend =}\NormalTok{ id)) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_date}\NormalTok{(}\AttributeTok{name =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{breaks =}\NormalTok{ presidential}\SpecialCharTok{$}\NormalTok{start, }\AttributeTok{date\_labels =} \StringTok{"\textquotesingle{}\%y"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-18-1.pdf}

è¯·æ³¨æ„ï¼Œå¯¹äº\texttt{breaks}å‚æ•°æˆ‘ä»¬æå–äº†\texttt{start}å˜é‡ä½œä¸ºä¸€ä¸ªå‘é‡ï¼Œå³\texttt{presidential\$start}ï¼Œå› ä¸ºæˆ‘ä»¬ä¸èƒ½ä¸ºè¿™ä¸ªå‚æ•°è¿›è¡Œç¾å­¦æ˜ å°„ã€‚å¦
å¤–è¯·æ³¨æ„ï¼Œå¯¹äºæ—¥æœŸå’Œæ—¥æœŸæ—¶é—´æ¯”ä¾‹å°ºçš„\texttt{breaks}å’Œ\texttt{labels}çš„æŒ‡å®šç•¥æœ‰ä¸åŒï¼š

\begin{itemize}
\item
  \texttt{date\_labels}
  éœ€è¦ä¸€ä¸ªæ ¼å¼è§„èŒƒï¼Œå…¶å½¢å¼ä¸\texttt{parse\_datetime()}ç›¸åŒã€‚
\item
  \texttt{date\_breaks} ï¼ˆè¿™é‡Œæœªå±•ç¤ºï¼‰éœ€è¦ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚ ``2 days'' æˆ–
  ``1 month''ã€‚
\end{itemize}

\subsection{å›¾ä¾‹å¸ƒå±€}\label{ux56feux4f8bux5e03ux5c40}

ä½ é€šå¸¸ä¼šä½¿ç”¨\texttt{breaks}å’Œ\texttt{labels}æ¥è°ƒæ•´åæ ‡è½´ã€‚è™½
ç„¶å®ƒä»¬ä¹Ÿé€‚ç”¨äºå›¾ä¾‹ï¼Œä½†è¿˜æœ‰ä¸€äº›ä½ æ›´å¯èƒ½ä½¿ç”¨çš„å…¶ä»–æŠ€æœ¯ã€‚

è¦æ§åˆ¶å›¾ä¾‹çš„æ•´ä½“ä½ç½®ï¼Œä½ éœ€è¦ä½¿ç”¨\texttt{theme()}è®¾ç½®ã€‚æˆ‘
ä»¬å°†åœ¨æœ¬ç« æœ«å°¾å†æ¬¡å›åˆ°ä¸»é¢˜è®¾ç½®ä¸Šï¼Œä½†ç®€è€Œè¨€ä¹‹ï¼Œå®ƒä»¬æ§åˆ¶å›¾ä¸­éæ•°æ®éƒ¨åˆ†çš„å†…å®¹ã€‚ä¸»
é¢˜è®¾ç½®\texttt{legend.position}æ§åˆ¶å›¾ä¾‹çš„ç»˜åˆ¶ä½ç½®ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{base }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ class))}

\NormalTok{base }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"right"}\NormalTok{) }\CommentTok{\# the default}
\NormalTok{base }\SpecialCharTok{+} \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"left"}\NormalTok{)}
\NormalTok{base }\SpecialCharTok{+} 
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"top"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{guides}\NormalTok{(}\AttributeTok{color =} \FunctionTok{guide\_legend}\NormalTok{(}\AttributeTok{nrow =} \DecValTok{3}\NormalTok{))}
\NormalTok{base }\SpecialCharTok{+} 
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"bottom"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{guides}\NormalTok{(}\AttributeTok{color =} \FunctionTok{guide\_legend}\NormalTok{(}\AttributeTok{nrow =} \DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-19-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-19-2.pdf}\end{minipage}%
\newline
\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-19-3.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-19-4.pdf}\end{minipage}%

\end{figure}%

å¦‚æœä½ çš„å›¾æ˜¯çŸ­è€Œå®½çš„ï¼Œå¯ä»¥å°†å›¾ä¾‹æ”¾åœ¨é¡¶éƒ¨æˆ–åº•éƒ¨ï¼›å¦‚æœå®ƒæ˜¯é«˜è€Œçª„çš„ï¼Œå¯ä»¥å°†å›¾ä¾‹æ”¾åœ¨å·¦ä¾§æˆ–å³ä¾§ã€‚ä½ 
è¿˜å¯ä»¥ä½¿ç”¨\texttt{legend.position\ =\ "none"}æ¥å®Œå…¨æŠ‘åˆ¶å›¾ä¾‹çš„æ˜¾ç¤ºã€‚

è¦æ§åˆ¶å•ä¸ªå›¾ä¾‹çš„æ˜¾ç¤ºï¼Œè¯·ä½¿ç”¨\texttt{guides()}æ­é…\texttt{guide\_legend()}æˆ–\texttt{guide\_colorbar()}ã€‚ä»¥
ä¸‹ç¤ºä¾‹å±•ç¤ºäº†ä¸¤ä¸ªé‡è¦çš„è®¾ç½®ï¼šä½¿ç”¨\texttt{nrow}æ§åˆ¶å›¾ä¾‹ä½¿ç”¨çš„è¡Œæ•°ï¼Œä»¥åŠé€šè¿‡è¦†ç›–å…¶ä¸­ä¸€ä¸ªç¾å­¦å±æ€§æ¥ä½¿ç‚¹å˜å¾—æ›´å¤§ã€‚è¿™
åœ¨ä½ åœ¨å›¾ä¸Šä½¿ç”¨ä½é€æ˜åº¦ï¼ˆ\texttt{alpha}ï¼‰æ¥æ˜¾ç¤ºè®¸å¤šç‚¹æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ class)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"bottom"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{guides}\NormalTok{(}\AttributeTok{color =} \FunctionTok{guide\_legend}\NormalTok{(}\AttributeTok{nrow =} \DecValTok{2}\NormalTok{, }\AttributeTok{override.aes =} \FunctionTok{list}\NormalTok{(}\AttributeTok{size =} \DecValTok{4}\NormalTok{)))}
\CommentTok{\#\textgreater{} \textasciigrave{}geom\_smooth()\textasciigrave{} using method = \textquotesingle{}loess\textquotesingle{} and formula = \textquotesingle{}y \textasciitilde{} x\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-20-1.pdf}

æ³¨æ„ï¼Œ\texttt{guides()}ä¸­çš„å‚æ•°åç§°ä¸ç¾å­¦åç§°ç›¸åŒ¹é…ï¼Œå°±åƒ\texttt{labs()}ä¸€æ ·ã€‚

\subsection{æ›¿æ¢æ¯”ä¾‹å°º}\label{ux66ffux6362ux6bd4ux4f8bux5c3a}

é™¤äº†å¾®è°ƒä¸€äº›ç»†èŠ‚ä¹‹å¤–ï¼Œä½ è¿˜å¯ä»¥å®Œå…¨æ›¿æ¢æ¯”ä¾‹å°ºã€‚æœ‰
ä¸¤ç§ç±»å‹çš„æ¯”ä¾‹å°ºä½ å¯èƒ½æœ€æƒ³è¦æ›¿æ¢ï¼šè¿ç»­ä½ç½®æ¯”ä¾‹å°ºå’Œé¢œè‰²æ¯”ä¾‹å°ºã€‚å¹¸
è¿çš„æ˜¯ï¼Œå…¶ä»–ç¾å­¦å±æ€§çš„åŸç†éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ä¸€æ—¦ä½ æŒæ¡äº†ä½ç½®å’Œé¢œè‰²ï¼Œä½ å°±èƒ½è¿…é€ŸæŒæ¡å…¶ä»–æ¯”ä¾‹å°ºçš„æ›¿æ¢ã€‚

ç»˜åˆ¶å˜é‡çš„å˜æ¢æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ä¾‹
å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å¯¹é’»çŸ³çš„é‡é‡ï¼ˆ\texttt{carat}ï¼‰å’Œä»·æ ¼ï¼ˆ\texttt{price}ï¼‰è¿›è¡Œå¯¹æ•°å˜æ¢ï¼Œå°±èƒ½æ›´å®¹æ˜“åœ°çœ‹åˆ°å®ƒä»¬ä¹‹é—´çš„ç²¾ç¡®å…³ç³»ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Left}
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat, }\AttributeTok{y =}\NormalTok{ price)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bin2d}\NormalTok{()}

\CommentTok{\# Right}
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \FunctionTok{log10}\NormalTok{(carat), }\AttributeTok{y =} \FunctionTok{log10}\NormalTok{(price))) }\SpecialCharTok{+}
  \FunctionTok{geom\_bin2d}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-21-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-21-2.pdf}\end{minipage}%

\end{figure}%

ç„¶è€Œï¼Œè¿™ç§å˜æ¢çš„ç¼ºç‚¹æ˜¯åæ ‡è½´ç°åœ¨è¢«æ ‡è®°ä¸ºå˜æ¢åçš„å€¼ï¼Œè¿™ä½¿å¾—å¾ˆéš¾è§£è¯»è¯¥å›¾ã€‚ä¸
å…¶åœ¨ç¾å­¦æ˜ å°„ä¸­è¿›è¡Œå˜æ¢ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©åœ¨åˆ»åº¦ä¸Šè¿›è¡Œå˜æ¢ã€‚ä»
è§†è§‰ä¸Šçœ‹ï¼Œä¸¤è€…æ˜¯ç›¸åŒçš„ï¼Œåªæ˜¯åæ ‡è½´æ˜¯æŒ‰ç…§åŸå§‹æ•°æ®çš„æ¯”ä¾‹å°ºè¿›è¡Œæ ‡è®°çš„ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat, }\AttributeTok{y =}\NormalTok{ price)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bin2d}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{scale\_x\_log10}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{scale\_y\_log10}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-22-1.pdf}

å¦ä¸€ä¸ªç»å¸¸éœ€è¦è‡ªå®šä¹‰çš„æ¯”ä¾‹å°ºæ˜¯é¢œè‰²ã€‚é»˜
è®¤çš„åˆ†ç±»æ¯”ä¾‹å°ºä¼šé€‰æ‹©åœ¨è‰²è½®ä¸Šå‡åŒ€åˆ†å¸ƒçš„é¢œè‰²ã€‚ä¸€ ä¸ªæœ‰ç”¨çš„æ›¿ä»£æ–¹æ¡ˆæ˜¯
ColorBrewer æ¯”ä¾‹å°ºï¼Œå®ƒç»è¿‡äººå·¥è°ƒæ•´ä»¥æ›´å¥½åœ°é€‚åº”æ‚£æœ‰å¸¸è§è‰²ç›²ç±»å‹çš„äººã€‚ä¸‹
é¢ä¸¤ä¸ªå›¾çœ‹èµ·æ¥ç›¸ä¼¼ï¼Œä½†çº¢è‰²å’Œç»¿è‰²çš„è‰²è°ƒå·®å¼‚è¶³å¤Ÿå¤§ï¼Œä»¥è‡³äºå³è¾¹çš„ç‚¹å³ä½¿å¯¹äºæ‚£æœ‰çº¢ç»¿è‰²ç›²çš„äººä¹Ÿèƒ½åŒºåˆ†å¼€æ¥\footnote{æ‚¨å¯ä»¥ä½¿ç”¨\href{https://michelf.ca/projects/sim-daltonism/}{SimDaltonism}ä¹‹ç±»çš„å·¥å…·æ¥æ¨¡æ‹Ÿè‰²ç›²æ¥æµ‹è¯•è¿™äº›å›¾åƒã€‚}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ drv))}

\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"Set1"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-23-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-23-2.pdf}\end{minipage}%

\end{figure}%

ä¸è¦å¿˜è®°æé«˜å¯è®¿é—®æ€§çš„æ›´ç®€å•çš„æŠ€æœ¯ã€‚å¦‚
æœåªæœ‰å‡ ç§é¢œè‰²ï¼Œä½ å¯ä»¥æ·»åŠ ä¸€ä¸ªå†—ä½™çš„å½¢çŠ¶æ˜ å°„ã€‚è¿™
ä¹Ÿæœ‰åŠ©äºç¡®ä¿ä½ çš„å›¾å½¢åœ¨é»‘ç™½æ¨¡å¼ä¸‹ä¹Ÿèƒ½è¢«è§£è¯»ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ drv, }\AttributeTok{shape =}\NormalTok{ drv)) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"Set1"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-24-1.pdf}

ColorBrewer
æ¯”ä¾‹å°ºçš„æ–‡æ¡£å¯ä»¥åœ¨çº¿æŸ¥çœ‹ï¼Œç½‘å€ä¸º\url{https://colorbrewer2.org/} ï¼Œå¹¶é€šè¿‡
Erich Neuwirth çš„ \texttt{RColorBrewer} åŒ…åœ¨ R ä¸­æä¾›ã€‚@ fig-brewer
æ˜¾ç¤ºäº†æ‰€æœ‰è°ƒè‰²æ¿çš„å®Œæ•´åˆ—è¡¨ã€‚å¦‚
æœä½ çš„åˆ†ç±»å€¼æ˜¯æœ‰åºçš„ï¼Œæˆ–è€…æœ‰ä¸€ä¸ª``ä¸­é—´å€¼''ï¼Œé‚£ä¹ˆé¡ºåºï¼ˆé¡¶éƒ¨ï¼‰å’Œå‘æ•£ï¼ˆåº•éƒ¨ï¼‰è°ƒè‰²æ¿å°±ç‰¹åˆ«æœ‰ç”¨ã€‚è¿™
é€šå¸¸å‘ç”Ÿåœ¨ä½ ä½¿ç”¨\texttt{cut()}å‡½æ•°å°†è¿ç»­å˜é‡è½¬æ¢ä¸ºåˆ†ç±»å˜é‡æ—¶ã€‚

\begin{figure}

\centering{

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/fig-brewer-1.pdf}

}

\caption{\label{fig-brewer}All colorBrewer scales.}

\end{figure}%

å½“ä½ æœ‰ä¸€ä¸ªé¢„å®šä¹‰çš„å€¼ä¸é¢œè‰²ä¹‹é—´çš„æ˜ å°„æ—¶ï¼Œä½¿ç”¨\texttt{scale\_color\_manual()}ã€‚ä¾‹
å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å°†æ€»ç»Ÿå…šæ´¾æ˜ å°„åˆ°é¢œè‰²ï¼Œæˆ‘ä»¬å¸Œæœ›ä½¿ç”¨æ ‡å‡†çš„çº¢è‰²ä»£è¡¨å…±å’Œå…šï¼Œè“è‰²ä»£è¡¨æ°‘ä¸»å…šã€‚ä¸º
è¿™äº›é¢œè‰²èµ‹å€¼çš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨åå…­è¿›åˆ¶é¢œè‰²ä»£ç ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{presidential }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{id =} \DecValTok{33} \SpecialCharTok{+} \FunctionTok{row\_number}\NormalTok{()) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ start, }\AttributeTok{y =}\NormalTok{ id, }\AttributeTok{color =}\NormalTok{ party)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_segment}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{xend =}\NormalTok{ end, }\AttributeTok{yend =}\NormalTok{ id)) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\AttributeTok{Republican =} \StringTok{"\#E81B23"}\NormalTok{, }\AttributeTok{Democratic =} \StringTok{"\#00AEF3"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-26-1.pdf}

å¯¹äºè¿ç»­é¢œè‰²ï¼Œå¯ä»¥ä½¿ç”¨å†…ç½®çš„\texttt{scale\_color\_gradient()}æˆ–\texttt{scale\_fill\_gradient()}ã€‚å¦‚
æœæœ‰ä¸€ä¸ªå‘æ•£çš„æ¯”ä¾‹å°ºï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{scale\_color\_gradient2()}ã€‚è¿™
å…è®¸ä½ å¯ä»¥ç»™æ­£æ•°å’Œè´Ÿæ•°åˆ†é…ä¸åŒçš„é¢œè‰²ã€‚æœ‰
æ—¶ï¼Œå½“ä½ æƒ³åŒºåˆ†é«˜äºæˆ–ä½äºå¹³å‡å€¼çš„ç‚¹æ—¶ï¼Œè¿™ä¹Ÿå¾ˆæœ‰ç”¨ã€‚

å¦ä¸€ä¸ªé€‰é¡¹æ˜¯ä½¿ç”¨ viridis é¢œè‰²æ¯”ä¾‹å°ºã€‚å…¶ è®¾è®¡è€… Nathaniel Smith å’Œ StÃ©fan
van der Walt
ç²¾å¿ƒåˆ¶ä½œäº†è¿ç»­çš„é¢œè‰²æ–¹æ¡ˆï¼Œè¿™äº›æ–¹æ¡ˆå¯¹äºæ‚£æœ‰å„ç§å½¢å¼è‰²ç›²çš„äººä»¥åŠåœ¨å½©è‰²å’Œé»‘ç™½æ¨¡å¼ä¸‹éƒ½æ˜¯æ„ŸçŸ¥å‡åŒ€çš„ã€‚è¿™
äº›æ¯”ä¾‹å°ºåœ¨ ggplot2
ä¸­ä½œä¸ºè¿ç»­ï¼ˆ\texttt{c}ï¼‰ã€ç¦»æ•£ï¼ˆ\texttt{d}ï¼‰å’Œåˆ†ç®±ï¼ˆ\texttt{b}ï¼‰è°ƒè‰²æ¿æä¾›ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{x =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10000}\NormalTok{),}
  \AttributeTok{y =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10000}\NormalTok{)}
\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(x, y)) }\SpecialCharTok{+}
  \FunctionTok{geom\_hex}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{coord\_fixed}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Default, continuous"}\NormalTok{, }\AttributeTok{x =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{y =} \ConstantTok{NULL}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(x, y)) }\SpecialCharTok{+}
  \FunctionTok{geom\_hex}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{coord\_fixed}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_viridis\_c}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Viridis, continuous"}\NormalTok{, }\AttributeTok{x =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{y =} \ConstantTok{NULL}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(x, y)) }\SpecialCharTok{+}
  \FunctionTok{geom\_hex}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{coord\_fixed}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_viridis\_b}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Viridis, binned"}\NormalTok{, }\AttributeTok{x =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{y =} \ConstantTok{NULL}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-27-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-27-2.pdf}\end{minipage}%
\newline
\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-27-3.pdf}\end{minipage}%

\end{figure}%

è¯·æ³¨æ„ï¼Œæ‰€æœ‰çš„é¢œè‰²æ¯”ä¾‹å°ºéƒ½æœ‰ä¸¤ç§ç±»å‹ï¼š\texttt{scale\_color\_*()}å’Œ\texttt{scale\_fill\_*()}ï¼Œåˆ†åˆ«ç”¨äºé¢œè‰²å’Œå¡«å……çš„ç¾å­¦ï¼ˆcolor
scales åœ¨è‹±å›½å’Œç¾å›½çš„æ‹¼å†™ä¸­éƒ½æ˜¯å¯ç”¨çš„ï¼‰ã€‚

\subsection{ç¼©æ”¾}\label{ux7f29ux653e}

æ§åˆ¶å›¾å½¢çš„ç•Œé™æœ‰ä¸‰ç§æ–¹æ³•ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  è°ƒæ•´è¦ç»˜åˆ¶çš„æ•°æ®ã€‚
\item
  åœ¨æ¯ä¸ªæ¯”ä¾‹å°ºä¸­è®¾ç½®ç•Œé™ã€‚
\item
  åœ¨\texttt{coord\_cartesian()}ä¸­è®¾ç½®\texttt{xlim}å’Œ\texttt{ylim}ã€‚
\end{enumerate}

æˆ‘ä»¬å°†åœ¨ä¸€ç³»åˆ—å›¾å½¢ä¸­æ¼”ç¤ºè¿™äº›é€‰é¡¹ã€‚å·¦
ä¾§çš„å›¾å½¢æ˜¾ç¤ºäº†å‘åŠ¨æœºå¤§å°å’Œç‡ƒæ²¹æ•ˆç‡ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶æŒ‰é©±åŠ¨ç±»å‹ç€è‰²ã€‚å³
ä¾§çš„å›¾è¡¨æ˜¾ç¤ºäº†ç›¸åŒçš„å˜é‡ï¼Œä½†ä»…ç»˜åˆ¶äº†éƒ¨åˆ†æ•°æ®ã€‚å­ é›†æ•°æ®å·²ç»å½±å“äº† x å’Œ y
æ¯”ä¾‹å°ºä»¥åŠå¹³æ»‘æ›²çº¿ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Left}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{()}

\CommentTok{\# Right}
\NormalTok{mpg }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{filter}\NormalTok{(displ }\SpecialCharTok{\textgreater{}=} \DecValTok{5} \SpecialCharTok{\&}\NormalTok{ displ }\SpecialCharTok{\textless{}=} \DecValTok{6} \SpecialCharTok{\&}\NormalTok{ hwy }\SpecialCharTok{\textgreater{}=} \DecValTok{10} \SpecialCharTok{\&}\NormalTok{ hwy }\SpecialCharTok{\textless{}=} \DecValTok{25}\NormalTok{) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-28-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-28-2.pdf}\end{minipage}%

\end{figure}%

è®©æˆ‘ä»¬æ¯”è¾ƒä¸‹é¢ä¸¤ä¸ªå›¾å½¢ï¼Œå…¶ä¸­å·¦ä¾§çš„å›¾å½¢åœ¨å•ä¸ªæ¯”ä¾‹å°ºä¸Šè®¾ç½®äº†ç•Œé™ï¼Œè€Œå³ä¾§çš„å›¾å½¢åœ¨\texttt{coord\_cartesian()}ä¸­è®¾ç½®äº†ç•Œé™ã€‚æˆ‘
ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå‡å°‘ç•Œé™çš„æ•ˆæœç›¸å½“äºå¯¹æ•°æ®è¿›è¡Œäº†å­é›†é€‰æ‹©ã€‚å› 
æ­¤ï¼Œä¸ºäº†æ”¾å¤§å›¾ä¸­çš„æŸä¸ªåŒºåŸŸï¼Œé€šå¸¸æœ€å¥½ä½¿ç”¨\texttt{coord\_cartesian()}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Left}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{)) }\SpecialCharTok{+}
  \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{c}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{25}\NormalTok{))}

\CommentTok{\# Right}
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{coord\_cartesian}\NormalTok{(}\AttributeTok{xlim =} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{), }\AttributeTok{ylim =} \FunctionTok{c}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{25}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-29-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-29-2.pdf}\end{minipage}%

\end{figure}%

å¦ä¸€æ–¹é¢ï¼Œå¦‚æœä½ æƒ³æ‰©å±•ç•Œé™ï¼Œæ¯”å¦‚åœ¨ä¸åŒçš„å›¾å½¢ä¹‹é—´åŒ¹é…æ¯”ä¾‹å°ºï¼Œé‚£ä¹ˆåœ¨å•ä¸ªæ¯”ä¾‹å°ºä¸Šè®¾ç½®\texttt{limits}é€šå¸¸æ›´æœ‰ç”¨ã€‚ä¾‹
å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æå–ä¸¤ç±»æ±½è½¦å¹¶åˆ†åˆ«ç»˜åˆ¶å®ƒä»¬ï¼Œåˆ™å¾ˆéš¾æ¯”è¾ƒè¿™äº›å›¾å½¢ï¼Œå› ä¸ºä¸‰ä¸ªæ¯”ä¾‹å°ºï¼ˆxè½´ã€yè½´å’Œé¢œè‰²ç¾å­¦ï¼‰çš„èŒƒå›´éƒ½ä¸ç›¸åŒã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{suv }\OtherTok{\textless{}{-}}\NormalTok{ mpg }\SpecialCharTok{|\textgreater{}} \FunctionTok{filter}\NormalTok{(class }\SpecialCharTok{==} \StringTok{"suv"}\NormalTok{)}
\NormalTok{compact }\OtherTok{\textless{}{-}}\NormalTok{ mpg }\SpecialCharTok{|\textgreater{}} \FunctionTok{filter}\NormalTok{(class }\SpecialCharTok{==} \StringTok{"compact"}\NormalTok{)}

\CommentTok{\# Left}
\FunctionTok{ggplot}\NormalTok{(suv, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}

\CommentTok{\# Right}
\FunctionTok{ggplot}\NormalTok{(compact, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-30-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-30-2.pdf}\end{minipage}%

\end{figure}%

è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯åœ¨å¤šä¸ªå›¾ä¹‹é—´å…±äº«æ¯”ä¾‹å°ºï¼Œå¹¶ä½¿ç”¨æ•´ä¸ªæ•°æ®çš„\texttt{limits}æ¥è®­ç»ƒè¿™äº›æ¯”ä¾‹å°ºã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x\_scale }\OtherTok{\textless{}{-}} \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{range}\NormalTok{(mpg}\SpecialCharTok{$}\NormalTok{displ))}
\NormalTok{y\_scale }\OtherTok{\textless{}{-}} \FunctionTok{scale\_y\_continuous}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{range}\NormalTok{(mpg}\SpecialCharTok{$}\NormalTok{hwy))}
\NormalTok{col\_scale }\OtherTok{\textless{}{-}} \FunctionTok{scale\_color\_discrete}\NormalTok{(}\AttributeTok{limits =} \FunctionTok{unique}\NormalTok{(mpg}\SpecialCharTok{$}\NormalTok{drv))}

\CommentTok{\# Left}
\FunctionTok{ggplot}\NormalTok{(suv, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
\NormalTok{  x\_scale }\SpecialCharTok{+}
\NormalTok{  y\_scale }\SpecialCharTok{+}
\NormalTok{  col\_scale}

\CommentTok{\# Right}
\FunctionTok{ggplot}\NormalTok{(compact, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
\NormalTok{  x\_scale }\SpecialCharTok{+}
\NormalTok{  y\_scale }\SpecialCharTok{+}
\NormalTok{  col\_scale}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-31-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-31-2.pdf}\end{minipage}%

\end{figure}%

åœ¨è¿™ç§ç‰¹å®šæƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ç®€å•åœ°ä½¿ç”¨åˆ†é¢ï¼ˆfacetingï¼‰æ¥è§£å†³é—®é¢˜ï¼Œä½†è¿™ç§æŠ€æœ¯æ›´å…·ä¸€èˆ¬æ€§ï¼Œä¾‹å¦‚å¦‚æœä½ æƒ³åœ¨æŠ¥å‘Šçš„å¤šä¸ªé¡µé¢ä¸Šåˆ†å¸ƒå›¾å½¢ï¼Œé‚£ä¹ˆè¿™ç§æŠ€æœ¯å°±å¾ˆæœ‰ç”¨ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-25}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ä¸ºä»€ä¹ˆä¸‹é¢çš„ä»£ç ä¸è¦†ç›–é»˜è®¤çš„æ¯”ä¾‹å°º?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{x =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10000}\NormalTok{),}
  \AttributeTok{y =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10000}\NormalTok{)}
\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(x, y)) }\SpecialCharTok{+}
  \FunctionTok{geom\_hex}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_gradient}\NormalTok{(}\AttributeTok{low =} \StringTok{"white"}\NormalTok{, }\AttributeTok{high =} \StringTok{"red"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{coord\_fixed}\NormalTok{()}
\end{Highlighting}
\end{Shaded}
\item
  æ¯ä¸ªæ¯”ä¾‹å°ºçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä»€ä¹ˆï¼Ÿå®ƒ å’Œ\texttt{labs()}ç›¸æ¯”æ€ä¹ˆæ ·ï¼Ÿ
\item
  é€šè¿‡ä»¥ä¸‹æ–¹å¼æ›´æ”¹æ€»ç»Ÿä»»æœŸçš„æ˜¾ç¤ºï¼š

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \tightlist
  \item
    ç»“åˆè‡ªå®šä¹‰é¢œè‰²å’Œxè½´åˆ»åº¦çš„ä¸¤ä¸ªå˜ä½“ã€‚
  \item
    æ”¹è¿›yè½´çš„æ˜¾ç¤ºã€‚
  \item
    ä¸ºæ¯ä¸ªä»»æœŸæ ‡ä¸Šæ€»ç»Ÿçš„åå­—ã€‚
  \item
    æ·»åŠ æœ‰ä¿¡æ¯é‡çš„å›¾æ ‡ç­¾ã€‚
  \item
    æ¯4å¹´è®¾ç½®ä¸€ä¸ªåˆ»åº¦ã€‚ï¼ˆè¿™çœ‹èµ·æ¥ç®€å•ä½†å®é™…ä¸Šæœ‰äº›æ£˜æ‰‹ï¼ï¼‰
  \end{enumerate}
\item
  é¦–å…ˆï¼Œåˆ›å»ºä»¥ä¸‹å›¾å½¢ã€‚ç„¶
  åï¼Œä½¿ç”¨\texttt{override.aes}ä¿®æ”¹ä»£ç ä»¥ä½¿å›¾ä¾‹æ›´å®¹æ˜“æŸ¥çœ‹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(diamonds, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat, }\AttributeTok{y =}\NormalTok{ price)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ cut), }\AttributeTok{alpha =} \DecValTok{1}\SpecialCharTok{/}\DecValTok{20}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{ä¸»é¢˜}\label{sec-themes}

æœ€åï¼Œä½¿ç”¨ä¸»é¢˜æ¥å®šåˆ¶å›¾å½¢ä¸­çš„éæ•°æ®å…ƒç´ ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color =}\NormalTok{ class)) }\SpecialCharTok{+}
  \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-34-1.pdf}

\texttt{ggplot2}åŒ…å«äº† å›¾~\ref{fig-themes}
ä¸­æ‰€ç¤ºçš„å…«ç§ä¸»é¢˜ï¼Œå…¶ä¸­\texttt{theme\_gray()}æ˜¯é»˜è®¤ä¸»é¢˜ã€‚åœ¨
åƒ\texttt{ggthemes}ï¼ˆ\url{https://jrnold.github.io/ggthemes}ï¼‰è¿™æ ·çš„é™„åŠ åŒ…ä¸­ï¼ŒJeffrey
Arnold æä¾›äº†æ›´å¤šçš„ä¸»é¢˜ã€‚å¦‚
æœä½ è¯•å›¾åŒ¹é…ç‰¹å®šçš„å…¬å¸æˆ–æœŸåˆŠé£æ ¼ï¼Œä½ è¿˜å¯ä»¥åˆ›å»ºè‡ªå·±çš„ä¸»é¢˜ã€‚

\begin{figure}

\centering{

\includegraphics[width=5.33in,height=\textheight]{images/visualization-themes.png}

}

\caption{\label{fig-themes}The eight themes built-in to ggplot2.}

\end{figure}%

åŒæ ·å¯ä»¥æ§åˆ¶æ¯ä¸ªä¸»é¢˜çš„å„ä¸ªç»„ä»¶ï¼Œæ¯”å¦‚ç”¨äºyè½´çš„å­—ä½“å¤§å°å’Œé¢œè‰²ã€‚æˆ‘
ä»¬å·²ç»çŸ¥é“\texttt{legend.position}æ§åˆ¶å›¾ä¾‹ç»˜åˆ¶çš„ä½ç½®ã€‚è¿˜
æœ‰è®¸å¤šå…¶ä»–æ–¹é¢çš„å›¾ä¾‹å¯ä»¥ç”¨\texttt{theme()}å‡½æ•°è¿›è¡Œå®šåˆ¶ã€‚ä¾‹
å¦‚ï¼Œåœ¨ä¸‹é¢çš„å›¾ä¸­ï¼Œæˆ‘ä»¬æ”¹å˜äº†å›¾ä¾‹çš„æ–¹å‘ï¼Œå¹¶åœ¨å…¶å‘¨å›´åŠ ä¸Šäº†é»‘è‰²è¾¹æ¡†ã€‚è¯·
æ³¨æ„ï¼Œä¸»é¢˜çš„å›¾ä¾‹æ¡†å’Œå›¾å½¢æ ‡é¢˜å…ƒç´ çš„å®šåˆ¶æ˜¯é€šè¿‡\texttt{element\_*()}å‡½æ•°å®Œæˆçš„ã€‚è¿™
äº›å‡½æ•°æŒ‡å®šéæ•°æ®ç»„ä»¶çš„æ ·å¼ï¼Œä¾‹å¦‚ï¼Œåœ¨\texttt{element\_text()}çš„\texttt{face}å‚æ•°ä¸­ï¼Œæ ‡é¢˜æ–‡æœ¬è¢«åŠ ç²—ï¼Œå›¾ä¾‹è¾¹æ¡†é¢œè‰²åœ¨\texttt{element\_rect()}çš„\texttt{color}å‚æ•°ä¸­å®šä¹‰ã€‚æ§
åˆ¶æ ‡é¢˜å’Œæ ‡é¢˜ä½ç½®çš„ä¸»é¢˜å…ƒç´ åˆ†åˆ«æ˜¯\texttt{plot.title.position}å’Œ\texttt{plot.caption.position}ã€‚åœ¨
ä¸‹é¢çš„å›¾ä¸­ï¼Œè¿™äº›è¢«è®¾ç½®ä¸º
``plot''ï¼Œä»¥è¡¨ç¤ºè¿™äº›å…ƒç´ ä¸æ•´ä¸ªç»˜å›¾åŒºåŸŸå¯¹é½ï¼Œè€Œä¸æ˜¯ä¸ç»˜å›¾é¢æ¿ï¼ˆé»˜è®¤å€¼ï¼‰å¯¹é½ã€‚å…¶
ä»–ä¸€äº›æœ‰ç”¨çš„\texttt{theme()}ç»„ä»¶ç”¨äºæ›´æ”¹æ ‡é¢˜å’Œæ ‡é¢˜æ–‡æœ¬æ ¼å¼çš„æ”¾ç½®ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"Larger engine sizes tend to have lower fuel economy"}\NormalTok{,}
    \AttributeTok{caption =} \StringTok{"Source: https://fueleconomy.gov."}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{theme}\NormalTok{(}
    \AttributeTok{legend.position =} \FunctionTok{c}\NormalTok{(}\FloatTok{0.6}\NormalTok{, }\FloatTok{0.7}\NormalTok{),}
    \AttributeTok{legend.direction =} \StringTok{"horizontal"}\NormalTok{,}
    \AttributeTok{legend.box.background =} \FunctionTok{element\_rect}\NormalTok{(}\AttributeTok{color =} \StringTok{"black"}\NormalTok{),}
    \AttributeTok{plot.title =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{face =} \StringTok{"bold"}\NormalTok{),}
    \AttributeTok{plot.title.position =} \StringTok{"plot"}\NormalTok{,}
    \AttributeTok{plot.caption.position =} \StringTok{"plot"}\NormalTok{,}
    \AttributeTok{plot.caption =} \FunctionTok{element\_text}\NormalTok{(}\AttributeTok{hjust =} \DecValTok{0}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} Warning: A numeric \textasciigrave{}legend.position\textasciigrave{} argument in \textasciigrave{}theme()\textasciigrave{} was deprecated in ggplot2}
\CommentTok{\#\textgreater{} 3.5.0.}
\CommentTok{\#\textgreater{} i Please use the \textasciigrave{}legend.position.inside\textasciigrave{} argument of \textasciigrave{}theme()\textasciigrave{} instead.}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-36-1.pdf}

è¦äº†è§£\texttt{theme()}å‡½æ•°çš„æ‰€æœ‰ç»„ä»¶çš„æ¦‚è¿°ï¼Œè¯·æŸ¥çœ‹\texttt{?theme}çš„å¸®åŠ©æ–‡æ¡£ã€‚\href{https://ggplot2-book.org/}{g}
\href{https://ggplot2-book.org/}{gplot2 book}
ä¹Ÿæ˜¯äº†è§£ä¸»é¢˜åŒ–å®Œæ•´ç»†èŠ‚çš„å¥½åœ°æ–¹ã€‚

For an overview of all \texttt{theme()} components, see help with
\texttt{?theme}. The \href{https://ggplot2-book.org/}{ggplot2 book} is
also a great place to go for the full details on theming.

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-26}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  ä»\texttt{ggthemes}åŒ…ä¸­é€‰æ‹©ä¸€ä¸ªä¸»é¢˜ï¼Œå¹¶å°†å…¶åº”ç”¨åˆ°ä½ æœ€ååˆ¶ä½œçš„å›¾å½¢ä¸Šã€‚
\item
  å°†ä½ çš„å›¾å½¢çš„è½´æ ‡ç­¾è®¾ç½®ä¸ºè“è‰²å¹¶åŠ ç²—ã€‚
\end{enumerate}

\section{å¸ƒå±€}\label{ux5e03ux5c40}

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•åˆ›å»ºå’Œä¿®æ”¹å•ä¸ªå›¾å½¢ã€‚ä½†
æ˜¯ï¼Œå¦‚æœä½ æœ‰å¤šä¸ªå›¾å½¢ï¼Œå¹¶å¸Œæœ›ä»¥æŸç§æ–¹å¼å°†å®ƒä»¬æ’åˆ—åœ¨ä¸€èµ·æ€ä¹ˆåŠï¼Ÿ\texttt{p}
\texttt{atchwork}åŒ…å…è®¸ä½ å°†å•ç‹¬çš„å›¾å½¢ç»„åˆåˆ°åŒä¸€ä¸ªå›¾å½¢ä¸­ã€‚åœ¨
æœ¬ç« çš„å‰é¢éƒ¨åˆ†ï¼Œæˆ‘ä»¬å·²ç»åŠ è½½äº†è¿™ä¸ªåŒ…ã€‚

è¦å°†ä¸¤ä¸ªå›¾å½¢å¹¶æ’æ”¾ç½®ï¼Œä½ åªéœ€å°†å®ƒä»¬åŠ åœ¨ä¸€èµ·ã€‚è¯·
æ³¨æ„ï¼Œä½ é¦–å…ˆéœ€è¦åˆ›å»ºå›¾å½¢å¹¶å°†å®ƒä»¬ä¿å­˜ä¸ºå¯¹è±¡ï¼ˆåœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œå®ƒä»¬è¢«ç§°ä¸º\texttt{p1}å’Œ\texttt{p2}ï¼‰ã€‚ç„¶
åï¼Œä½ ä½¿ç”¨\texttt{+}å°†å®ƒä»¬å¹¶æ’æ”¾ç½®ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p1 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Plot 1"}\NormalTok{)}
\NormalTok{p2 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ drv, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Plot 2"}\NormalTok{)}
\NormalTok{p1 }\SpecialCharTok{+}\NormalTok{ p2}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-37-1.pdf}

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä¸Šé¢çš„ä»£ç å—ä¸­ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ä½¿ç”¨\texttt{patchwork}åŒ…ä¸­çš„æ–°å‡½æ•°ã€‚ç›¸
åï¼Œè¯¥åŒ…ä¸º\texttt{+}è¿ç®—ç¬¦æ·»åŠ äº†æ–°çš„åŠŸèƒ½ã€‚

ä½ è¿˜å¯ä»¥ä½¿ç”¨\texttt{patchwork}åˆ›å»ºå¤æ‚çš„å›¾å½¢å¸ƒå±€ã€‚åœ¨
ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œ\texttt{\textbar{}}å°†\texttt{p1}å’Œ\texttt{p3}å¹¶æ’æ”¾ç½®ï¼Œè€Œ\texttt{/}å°†\texttt{p2}ç§»åŠ¨åˆ°ä¸‹ä¸€è¡Œã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p3 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cty, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Plot 3"}\NormalTok{)}
\NormalTok{(p1 }\SpecialCharTok{|}\NormalTok{ p3) }\SpecialCharTok{/}\NormalTok{ p2}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-38-1.pdf}

æ­¤å¤–ï¼Œ\texttt{patchwork}å…è®¸ä½ å°†å¤šä¸ªå›¾å½¢çš„å›¾ä¾‹æ”¶é›†åˆ°ä¸€ä¸ªå…±åŒçš„å›¾ä¾‹ä¸­ï¼Œè‡ªå®šä¹‰å›¾ä¾‹çš„ä½ç½®ä»¥åŠå›¾å½¢çš„å°ºå¯¸ï¼Œå¹¶ä¸ºä½ çš„å›¾å½¢æ·»åŠ å…±åŒçš„æ ‡é¢˜ã€å‰¯æ ‡é¢˜ã€è¯´æ˜ç­‰ã€‚ä¸‹
é¢æˆ‘ä»¬åˆ›å»ºäº†5ä¸ªå›¾å½¢ã€‚æˆ‘
ä»¬å…³é—­äº†ç®±å½¢å›¾å’Œæ•£ç‚¹å›¾çš„å›¾ä¾‹ï¼Œå¹¶å°†å¯†åº¦å›¾çš„å›¾ä¾‹æ”¶é›†åˆ°å›¾è¡¨é¡¶éƒ¨ï¼Œä½¿ç”¨äº†\texttt{\&\ theme(legend.position\ =\ "top")}ã€‚è¯·
æ³¨æ„è¿™é‡Œä½¿ç”¨äº†\texttt{\&}è¿ç®—ç¬¦è€Œä¸æ˜¯é€šå¸¸çš„\texttt{+}ã€‚è¿™
æ˜¯å› ä¸ºæˆ‘ä»¬æ­£åœ¨ä¿®æ”¹\texttt{patchwork}å›¾å½¢çš„ä¸»é¢˜ï¼Œè€Œä¸æ˜¯å•ä¸ªçš„\texttt{ggplot}ã€‚å›¾
ä¾‹è¢«æ”¾ç½®åœ¨é¡¶éƒ¨çš„\texttt{guide\_area()}å†…ã€‚æœ€
åï¼Œæˆ‘ä»¬è¿˜è‡ªå®šä¹‰äº†\texttt{patchwork}ä¸­å„ä¸ªç»„ä»¶çš„é«˜åº¦ï¼šæŒ‡å—çš„é«˜åº¦ä¸º1ï¼Œç®±å½¢å›¾çš„é«˜åº¦ä¸º3ï¼Œå¯†åº¦å›¾çš„é«˜åº¦ä¸º2ï¼Œåˆ†é¢çš„æ•£ç‚¹å›¾çš„é«˜åº¦ä¸º4ã€‚\texttt{p}
\texttt{atchwork}ä½¿ç”¨è¿™ä¸ªæ¯”ä¾‹æ¥åˆ’åˆ†ä½ ä¸ºå›¾å½¢åˆ†é…çš„åŒºåŸŸï¼Œå¹¶ç›¸åº”åœ°æ”¾ç½®å„ä¸ªç»„ä»¶ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p1 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ drv, }\AttributeTok{y =}\NormalTok{ cty, }\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{show.legend =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Plot 1"}\NormalTok{)}

\NormalTok{p2 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ drv, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{show.legend =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Plot 2"}\NormalTok{)}

\NormalTok{p3 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cty, }\AttributeTok{color =}\NormalTok{ drv, }\AttributeTok{fill =}\NormalTok{ drv)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Plot 3"}\NormalTok{)}

\NormalTok{p4 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ hwy, }\AttributeTok{color =}\NormalTok{ drv, }\AttributeTok{fill =}\NormalTok{ drv)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_density}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.5}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Plot 4"}\NormalTok{)}

\NormalTok{p5 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cty, }\AttributeTok{y =}\NormalTok{ hwy, }\AttributeTok{color =}\NormalTok{ drv)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{show.legend =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{facet\_wrap}\NormalTok{(}\SpecialCharTok{\textasciitilde{}}\NormalTok{drv) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Plot 5"}\NormalTok{)}

\NormalTok{(}\FunctionTok{guide\_area}\NormalTok{() }\SpecialCharTok{/}\NormalTok{ (p1 }\SpecialCharTok{+}\NormalTok{ p2) }\SpecialCharTok{/}\NormalTok{ (p3 }\SpecialCharTok{+}\NormalTok{ p4) }\SpecialCharTok{/}\NormalTok{ p5) }\SpecialCharTok{+}
  \FunctionTok{plot\_annotation}\NormalTok{(}
    \AttributeTok{title =} \StringTok{"City and highway mileage for cars with different drive trains"}\NormalTok{,}
    \AttributeTok{caption =} \StringTok{"Source: https://fueleconomy.gov."}
\NormalTok{  ) }\SpecialCharTok{+}
  \FunctionTok{plot\_layout}\NormalTok{(}
    \AttributeTok{guides =} \StringTok{"collect"}\NormalTok{,}
    \AttributeTok{heights =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{)}
\NormalTok{    ) }\SpecialCharTok{\&}
  \FunctionTok{theme}\NormalTok{(}\AttributeTok{legend.position =} \StringTok{"top"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=25in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-39-1.pdf}

å¦‚æœä½ å¸Œæœ›äº†è§£æ›´å¤šå…³äºå¦‚ä½•ä½¿ç”¨\texttt{patchwork}ç»„åˆå’Œå¸ƒå±€å¤šä¸ªå›¾å½¢çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬æ¨èä½ æµè§ˆè¯¥åŒ…çš„å®˜æ–¹ç½‘ç«™ä¸Šçš„æŒ‡å—ï¼š\href{https://patchwork.data-imaginist.com./}{https://patchwork.data-imaginist.com}ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-27}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  å¦‚æœåœ¨ä¸‹é¢çš„ç»˜å›¾å¸ƒå±€ä¸­çœç•¥æ‹¬å·ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä½ 
  èƒ½è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆä¼šè¿™æ ·å—ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p1 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ displ, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Plot 1"}\NormalTok{)}
\NormalTok{p2 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ drv, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_boxplot}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Plot 2"}\NormalTok{)}
\NormalTok{p3 }\OtherTok{\textless{}{-}} \FunctionTok{ggplot}\NormalTok{(mpg, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cty, }\AttributeTok{y =}\NormalTok{ hwy)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Plot 3"}\NormalTok{)}

\NormalTok{(p1 }\SpecialCharTok{|}\NormalTok{ p2) }\SpecialCharTok{/}\NormalTok{ p3}
\end{Highlighting}
\end{Shaded}
\item
  ä½¿ç”¨å‰é¢ç»ƒä¹ ä¸­çš„ä¸‰ä¸ªå›¾ï¼Œé‡æ–°åˆ›å»ºä¸‹é¢çš„patchworkã€‚

  \includegraphics[width=21.875in,height=\textheight]{communication_files/figure-pdf/unnamed-chunk-41-1.pdf}
\end{enumerate}

\section{å°ç»“}\label{ux5c0fux7ed3-10}

åœ¨æœ¬ç« ä¸­ï¼Œä½ å­¦ä¹ äº†å¦‚ä½•æ·»åŠ å›¾å½¢æ ‡ç­¾ï¼Œå¦‚æ ‡é¢˜ã€å‰¯æ ‡é¢˜ã€è¯´æ˜ä»¥åŠä¿®æ”¹é»˜è®¤çš„è½´æ ‡ç­¾ï¼Œä½¿ç”¨æ³¨é‡Šåœ¨å›¾å½¢ä¸­æ·»åŠ ä¿¡æ¯æ€§æ–‡æœ¬æˆ–çªå‡ºæ˜¾ç¤ºç‰¹å®šçš„æ•°æ®ç‚¹ï¼Œè‡ªå®šä¹‰è½´åˆ»åº¦ï¼Œå¹¶æ›´æ”¹å›¾å½¢çš„ä¸»é¢˜ã€‚ä½ 
è¿˜å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ç®€å•å’Œå¤æ‚çš„å›¾å½¢å¸ƒå±€å°†å¤šä¸ªå›¾å½¢ç»„åˆæˆä¸€ä¸ªå›¾å½¢ã€‚

è™½ç„¶åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨å·²ç»å­¦ä¹ äº†å¦‚ä½•åˆ¶ä½œè®¸å¤šä¸åŒç±»å‹çš„å›¾å½¢ä»¥åŠå¦‚ä½•ä½¿ç”¨å„ç§æŠ€æœ¯æ¥å®šåˆ¶å®ƒä»¬ï¼Œä½†æˆ‘ä»¬åªæ˜¯è§¦åŠäº†ä½¿ç”¨
ggplot2 åˆ›å»ºå†…å®¹çš„å†°å±±ä¸€è§’ã€‚å¦‚ æœä½ æƒ³å…¨é¢äº†è§£
ggplot2ï¼Œæˆ‘ä»¬æ¨èæ‚¨é˜…è¯»ã€Š\href{https://ggplot2-book.org}{\emph{ggplot2:
Elegant Graphics for Data Analysis}}ã€‹è¿™æœ¬ä¹¦ã€‚å…¶ ä»–æœ‰ç”¨çš„èµ„æºè¿˜æœ‰
Winston Chang çš„ã€Š\href{https://r-graphics.org}{\emph{R Graphics
Cookbook}}ã€‹å’Œ Claus Wilke
çš„ã€Š\href{https://clauswilke.com/dataviz/}{\emph{Fundamentals of Data
Visualization}} ã€‹ã€‚

\part{è½¬æ¢}

æœ¬ä¹¦çš„ç¬¬äºŒéƒ¨åˆ†æ·±å…¥æ¢è®¨äº†æ•°æ®å¯è§†åŒ–ã€‚åœ¨
è¿™ä¸€éƒ¨åˆ†ï¼Œä½ å°†å­¦ä¹ åœ¨æ•°æ®æ¡†ä¸­æœ€å¸¸é‡åˆ°çš„å˜é‡ç±»å‹ï¼Œå¹¶å­¦ä¹ å¯ç”¨äºå¤„ç†è¿™äº›å˜é‡çš„å·¥å…·ã€‚

\begin{figure}

\centering{

\includegraphics[width=5.57in,height=\textheight]{diagrams/data-science/transform.png}

}

\caption{\label{fig-ds-transform}The options for data transformation
depends heavily on the type of data involved, the subject of this part
of the book.}

\end{figure}%

ä½ å¯ä»¥æ ¹æ®éœ€è¦é˜…è¯»è¿™äº›ç« èŠ‚ã€‚å®ƒ
ä»¬çš„è®¾è®¡åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ç‹¬ç«‹çš„ï¼Œå› æ­¤å¯ä»¥æŒ‰é¡ºåºé˜…è¯»ï¼Œä¹Ÿå¯ä»¥ä¸æŒ‰é¡ºåºé˜…è¯»ã€‚

\begin{itemize}
\tightlist
\item
  ç« èŠ‚~\ref{sec-logicals}
  å°†å‘ä½ ä»‹ç»é€»è¾‘å‘é‡ã€‚é€»è¾‘å‘é‡æ˜¯æœ€ç®€å•çš„å‘é‡ç±»å‹ï¼Œä½†åŠŸèƒ½éå¸¸å¼ºå¤§ã€‚ä½ å°†å­¦ä¹ å¦‚ä½•é€šè¿‡æ•°å€¼æ¯”è¾ƒåˆ›å»ºå®ƒä»¬ï¼Œå¦‚ä½•ä½¿ç”¨å¸ƒå°”ä»£æ•°å°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·ï¼Œå¦‚ä½•åœ¨æ±‡æ€»ä¸­ä½¿ç”¨å®ƒä»¬ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒä»¬è¿›è¡Œæ¡ä»¶è½¬æ¢ï¼›
\item
  ç« èŠ‚~\ref{sec-numbers}
  å°†æ·±å…¥æ¢è®¨æ•°å­—å‘é‡çš„å·¥å…·ï¼Œè¿™æ˜¯æ•°æ®ç§‘å­¦çš„åŠ¨åŠ›æºæ³‰ã€‚ä½ å°†æ›´æ·±å…¥åœ°äº†è§£è®¡æ•°å’Œä¸€ç³»åˆ—é‡è¦çš„è½¬æ¢å’Œæ±‡æ€»å‡½æ•°ï¼›
\item
  ç« èŠ‚~\ref{sec-strings}
  å°†ä¸ºä½ æä¾›å¤„ç†å­—ç¬¦ä¸²çš„å·¥å…·ã€‚ä½ å¯ä»¥åˆ‡å‰²å®ƒä»¬ï¼Œå°†å®ƒä»¬åˆ†å‰²æˆå°å—ï¼Œç„¶åå†å°†å®ƒä»¬é‡æ–°ç»„åˆåœ¨ä¸€èµ·ã€‚è¿™ä¸€ç« ä¸»è¦å…³æ³¨stringråŒ…ï¼Œä½†ä½ ä¹Ÿå°†å­¦ä¹ ä¸€äº›æ›´å¤šç”¨äºä»å­—ç¬¦ä¸²ä¸­æå–æ•°æ®çš„tidyrå‡½æ•°ï¼›
\item
  ç« èŠ‚~\ref{sec-regular-expressions}
  å°†å‘ä½ ä»‹ç»æ­£åˆ™è¡¨è¾¾å¼ï¼Œè¿™æ˜¯ä¸€ç§å¼ºå¤§çš„å­—ç¬¦ä¸²æ“ä½œå·¥å…·ã€‚æœ¬ç« å°†å¸¦ä½ ä»æƒ³è±¡ä¸€åªçŒ«èµ°è¿‡ä½ çš„é”®ç›˜ï¼Œåˆ°é˜…è¯»å’Œç¼–å†™å¤æ‚çš„å­—ç¬¦ä¸²æ¨¡å¼ï¼›
\item
  ç« èŠ‚~\ref{sec-factors}
  å°†ä»‹ç»å› å­ï¼Œä¸€ç§Rç”¨äºå­˜å‚¨åˆ†ç±»æ•°æ®çš„æ•°æ®ç±»å‹ã€‚å½“å˜é‡å…·æœ‰ä¸€ç»„å›ºå®šçš„å¯èƒ½å€¼æ—¶ï¼Œæˆ–è€…å½“ä½ æƒ³è¦ä½¿ç”¨éå­—æ¯é¡ºåºçš„å­—ç¬¦ä¸²æ’åºæ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨å› å­ï¼›
\item
  ç« èŠ‚~\ref{sec-dates-and-times}
  å°†ä¸ºä½ æä¾›å¤„ç†æ—¥æœŸå’Œæ—¥æœŸæ—¶é—´çš„å…³é”®å·¥å…·ã€‚ä¸å¹¸çš„æ˜¯ï¼Œä½ è¶Šäº†è§£æ—¥æœŸæ—¶é—´ï¼Œå®ƒä»¬ä¼¼ä¹å°±å˜å¾—è¶Šå¤æ‚ï¼Œä½†åœ¨lubridateåŒ…çš„å¸®åŠ©ä¸‹ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•å…‹æœæœ€å¸¸è§çš„æŒ‘æˆ˜ï¼›
\item
  ç« èŠ‚~\ref{sec-missing-values}
  å°†æ·±å…¥æ¢è®¨ç¼ºå¤±å€¼ã€‚æˆ‘ä»¬ä¹‹å‰å·²ç»å•ç‹¬è®¨è®ºè¿‡å®ƒä»¬å‡ æ¬¡äº†ï¼Œä½†ç°åœ¨æ˜¯æ—¶å€™å…¨é¢è®¨è®ºå®ƒä»¬äº†ï¼Œå¸®åŠ©ä½ ç†è§£éšå¼å’Œæ˜¾å¼ç¼ºå¤±å€¼ä¹‹é—´çš„åŒºåˆ«ï¼Œä»¥åŠå¦‚ä½•å’Œä¸ºä»€ä¹ˆå¯åœ¨å®ƒä»¬ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼›
\item
  ç« èŠ‚~\ref{sec-joins}
  é€šè¿‡ä¸ºä½ æä¾›å°†ä¸¤ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰æ•°æ®æ¡†åˆå¹¶åœ¨ä¸€èµ·çš„å·¥å…·æ¥ç»“æŸæœ¬ä¹¦çš„è¿™ä¸€éƒ¨åˆ†ã€‚å­¦ä¹ åˆå¹¶ï¼ˆjoinï¼‰å°†è¿«ä½¿ä½ äº†è§£é”®ï¼ˆkeysï¼‰çš„æ¦‚å¿µï¼Œå¹¶æ€è€ƒå¦‚ä½•æ ‡è¯†æ•°æ®é›†çš„æ¯ä¸€è¡Œã€‚
\end{itemize}

\chapter{é€»è¾‘å‘é‡}\label{sec-logicals}

\section{å¼•è¨€}\label{ux5f15ux8a00-7}

åœ¨æœ¬ç« ä¸­ï¼Œä½ å°†å­¦ä¹ å¤„ç†é€»è¾‘å‘é‡çš„å·¥å…·ã€‚é€»
è¾‘å‘é‡æ˜¯æœ€ç®€å•çš„å‘é‡ç±»å‹ï¼Œå› ä¸ºæ¯ä¸ªå…ƒç´ åªèƒ½æ˜¯ä¸‰ä¸ªå¯èƒ½å€¼ä¹‹ä¸€ï¼š\texttt{TRUE}ï¼ˆçœŸï¼‰ã€\texttt{FALSE}ï¼ˆå‡ï¼‰å’Œ\texttt{NA}ï¼ˆç¼ºå¤±å€¼ï¼‰ã€‚åœ¨
åŸå§‹æ•°æ®ä¸­ç›´æ¥æ‰¾åˆ°é€»è¾‘å‘é‡çš„æƒ…å†µç›¸å¯¹è¾ƒå°‘ï¼Œä½†åœ¨å‡ ä¹æ¯æ¬¡åˆ†æçš„è¿‡ç¨‹ä¸­ï¼Œä½ éƒ½ä¼šåˆ›å»ºå’Œæ“ä½œå®ƒä»¬ã€‚

æˆ‘ä»¬å°†é¦–å…ˆè®¨è®ºåˆ›å»ºé€»è¾‘å‘é‡çš„æœ€å¸¸è§æ–¹æ³•ï¼šé€šè¿‡æ•°å€¼æ¯”è¾ƒã€‚ç„¶
åï¼Œä½ å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨å¸ƒå°”ä»£æ•°æ¥ç»„åˆä¸åŒçš„é€»è¾‘å‘é‡ï¼Œä»¥åŠä¸€äº›æœ‰ç”¨çš„æ€»ç»“ã€‚æœ€
åï¼Œæˆ‘ä»¬å°†ä»‹ç»\texttt{if\_else()}å’Œ\texttt{case\_when()}è¿™ä¸¤ä¸ªç”±é€»è¾‘å‘é‡é©±åŠ¨çš„ç”¨äºè¿›è¡Œæ¡ä»¶æ›´æ”¹çš„æœ‰ç”¨å‡½æ•°ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-7}

æœ¬ç« ä¸­ä½ å°†å­¦ä¹ çš„å¤§éƒ¨åˆ†å‡½æ•°éƒ½æ˜¯ç”±åŸºç¡€Ræä¾›çš„ï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦tidyverseï¼Œä½†æˆ‘ä»¬ä»ç„¶ä¼šåŠ è½½å®ƒï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{mutate()}ã€\texttt{filter()}ç­‰å‡½æ•°æ¥å¤„ç†æ•°æ®æ¡†ã€‚æˆ‘
ä»¬è¿˜å°†ç»§ç»­ä»\texttt{nycflights13::flights}æ•°æ®é›†ä¸­æå–ç¤ºä¾‹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(nycflights13)}
\end{Highlighting}
\end{Shaded}

ç„¶è€Œï¼Œéšç€æˆ‘ä»¬å¼€å§‹ä»‹ç»æ›´å¤šçš„å·¥å…·ï¼Œå¹¶ä¸æ€»æ˜¯ä¼šæœ‰ä¸€ä¸ªå®Œç¾çš„çœŸå®ç¤ºä¾‹ã€‚å› 
æ­¤ï¼Œæˆ‘ä»¬å°†å¼€å§‹ä½¿ç”¨\texttt{c()}åˆ›å»ºä¸€äº›è™šæ‹Ÿæ•°æ®:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{11}\NormalTok{, }\DecValTok{13}\NormalTok{)}
\NormalTok{x }\SpecialCharTok{*} \DecValTok{2}
\CommentTok{\#\textgreater{} [1]  2  4  6 10 14 22 26}
\end{Highlighting}
\end{Shaded}

è¿™æ ·åšä½¿å¾—è§£é‡Šå•ä¸ªå‡½æ•°å˜å¾—æ›´å®¹æ˜“ï¼Œä½†ä»£ä»·æ˜¯ä½¿å¾—å®ƒè¾ƒéš¾åº”ç”¨äºä½ çš„æ•°æ®é—®é¢˜ã€‚è¯·
è®°ä½ï¼Œæˆ‘ä»¬å¯¹è‡ªç”±æµ®åŠ¨çš„å‘é‡æ‰€åšçš„ä»»ä½•æ“ä½œï¼Œä½ éƒ½å¯ä»¥é€šè¿‡\texttt{mutate()}ç­‰å‡½æ•°å¯¹æ•°æ®æ¡†ä¸­çš„å˜é‡æ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(x)}
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{y =}\NormalTok{ x }\SpecialCharTok{*} \DecValTok{2}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 7 x 2}
\CommentTok{\#\textgreater{}       x     y}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1     2}
\CommentTok{\#\textgreater{} 2     2     4}
\CommentTok{\#\textgreater{} 3     3     6}
\CommentTok{\#\textgreater{} 4     5    10}
\CommentTok{\#\textgreater{} 5     7    14}
\CommentTok{\#\textgreater{} 6    11    22}
\CommentTok{\#\textgreater{} \# i 1 more row}
\end{Highlighting}
\end{Shaded}

\section{æ¯”è¾ƒ}\label{ux6bd4ux8f83}

åˆ›å»ºé€»è¾‘å‘é‡çš„ä¸€ä¸ªéå¸¸å¸¸è§çš„æ–¹å¼æ˜¯é€šè¿‡ä½¿ç”¨\texttt{\textless{}}ã€\texttt{\textless{}=}ã€\texttt{\textgreater{}}ã€\texttt{\textgreater{}=}ã€\texttt{!=}å’Œ\texttt{==}è¿›è¡Œæ•°å€¼æ¯”è¾ƒã€‚åˆ°
ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸»è¦åœ¨\texttt{filter()}å†…éƒ¨ä¸´æ—¶åˆ›å»ºé€»è¾‘å˜é‡ï¼Œå®ƒä»¬è¢«è®¡ç®—ã€ä½¿ç”¨ï¼Œç„¶åå°±è¢«ä¸¢å¼ƒäº†ã€‚ä¾‹
å¦‚ï¼Œä¸‹é¢çš„\texttt{filter()}æŸ¥æ‰¾æ‰€æœ‰å¤§è‡´å‡†æ—¶åˆ°è¾¾çš„æ—¥é—´èˆªç­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(dep\_time }\SpecialCharTok{\textgreater{}} \DecValTok{600} \SpecialCharTok{\&}\NormalTok{ dep\_time }\SpecialCharTok{\textless{}} \DecValTok{2000} \SpecialCharTok{\&} \FunctionTok{abs}\NormalTok{(arr\_delay) }\SpecialCharTok{\textless{}} \DecValTok{20}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 172,286 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      601            600         1      844            850}
\CommentTok{\#\textgreater{} 2  2013     1     1      602            610        {-}8      812            820}
\CommentTok{\#\textgreater{} 3  2013     1     1      602            605        {-}3      821            805}
\CommentTok{\#\textgreater{} 4  2013     1     1      606            610        {-}4      858            910}
\CommentTok{\#\textgreater{} 5  2013     1     1      606            610        {-}4      837            845}
\CommentTok{\#\textgreater{} 6  2013     1     1      607            607         0      858            915}
\CommentTok{\#\textgreater{} \# i 172,280 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

çŸ¥é“è¿™æ˜¯ä¸€ç§å¿«æ·æ–¹å¼ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨\texttt{mutate()}æ˜ç¡®åˆ›å»ºåº•å±‚çš„é€»è¾‘å˜é‡æ˜¯å¾ˆæœ‰ç”¨çš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{daytime =}\NormalTok{ dep\_time }\SpecialCharTok{\textgreater{}} \DecValTok{600} \SpecialCharTok{\&}\NormalTok{ dep\_time }\SpecialCharTok{\textless{}} \DecValTok{2000}\NormalTok{,}
    \AttributeTok{approx\_ontime =} \FunctionTok{abs}\NormalTok{(arr\_delay) }\SpecialCharTok{\textless{}} \DecValTok{20}\NormalTok{,}
    \AttributeTok{.keep =} \StringTok{"used"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 4}
\CommentTok{\#\textgreater{}   dep\_time arr\_delay daytime approx\_ontime}
\CommentTok{\#\textgreater{}      \textless{}int\textgreater{}     \textless{}dbl\textgreater{} \textless{}lgl\textgreater{}   \textless{}lgl\textgreater{}        }
\CommentTok{\#\textgreater{} 1      517        11 FALSE   TRUE         }
\CommentTok{\#\textgreater{} 2      533        20 FALSE   FALSE        }
\CommentTok{\#\textgreater{} 3      542        33 FALSE   FALSE        }
\CommentTok{\#\textgreater{} 4      544       {-}18 FALSE   TRUE         }
\CommentTok{\#\textgreater{} 5      554       {-}25 FALSE   FALSE        }
\CommentTok{\#\textgreater{} 6      554        12 FALSE   TRUE         }
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\end{Highlighting}
\end{Shaded}

è¿™åœ¨å¤„ç†æ›´å¤æ‚çš„é€»è¾‘æ—¶ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå‘½åä¸­é—´æ­¥éª¤æ—¢å¯ä»¥è®©ä»£ç æ›´æ˜“è¯»ï¼Œä¹Ÿæ›´å®¹æ˜“æ£€æŸ¥æ¯ä¸ªæ­¥éª¤æ˜¯å¦æ­£ç¡®è®¡ç®—ã€‚

æ€»çš„æ¥è¯´ï¼Œæœ€åˆçš„\texttt{filter}å‡½æ•°ç›¸å½“äºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{daytime =}\NormalTok{ dep\_time }\SpecialCharTok{\textgreater{}} \DecValTok{600} \SpecialCharTok{\&}\NormalTok{ dep\_time }\SpecialCharTok{\textless{}} \DecValTok{2000}\NormalTok{,}
    \AttributeTok{approx\_ontime =} \FunctionTok{abs}\NormalTok{(arr\_delay) }\SpecialCharTok{\textless{}} \DecValTok{20}\NormalTok{,}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(daytime }\SpecialCharTok{\&}\NormalTok{ approx\_ontime)}
\end{Highlighting}
\end{Shaded}

\subsection{æµ®ç‚¹æ•°æ¯”è¾ƒ}\label{sec-fp-comparison}

å¯¹æ•°å­—æ…ç”¨==ã€‚ä¾‹ å¦‚ï¼Œä¸‹é¢è¿™ä¸ªå‘é‡çœ‹èµ·æ¥åŒ…å«æ•°å­—1å’Œ2ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1} \SpecialCharTok{/} \DecValTok{49} \SpecialCharTok{*} \DecValTok{49}\NormalTok{, }\FunctionTok{sqrt}\NormalTok{(}\DecValTok{2}\NormalTok{) }\SpecialCharTok{\^{}} \DecValTok{2}\NormalTok{)}
\NormalTok{x}
\CommentTok{\#\textgreater{} [1] 1 2}
\end{Highlighting}
\end{Shaded}

ä½†å¦‚æœä½ æµ‹è¯•å®ƒä»¬æ˜¯å¦ç›¸ç­‰ï¼Œä½ å¾—åˆ° \texttt{FALSE}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\SpecialCharTok{==} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] FALSE FALSE}
\end{Highlighting}
\end{Shaded}

è¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿè®¡
ç®—æœºå­˜å‚¨æ•°å­—æ—¶åªæœ‰å›ºå®šçš„å°æ•°ä½æ•°ï¼Œå› æ­¤æ— æ³•ç²¾ç¡®è¡¨ç¤º1/49æˆ–\texttt{sqrt(2)}ï¼Œéšåçš„è®¡ç®—å°†ç•¥æœ‰åå·®ã€‚æˆ‘
ä»¬å¯ä»¥é€šè¿‡åœ¨\texttt{print()}å‡½æ•°ä¸­æŒ‡å®š\texttt{digits}\footnote{R
  é€šå¸¸ä¼šè‡ªåŠ¨ä¸ºä½ è°ƒç”¨\texttt{print}å‡½æ•°ï¼ˆå³\texttt{x}æ˜¯\texttt{print(x)}çš„ç®€å†™ï¼‰ï¼Œä½†å¦‚æœä½ æƒ³è¦æä¾›å…¶ä»–å‚æ•°ï¼Œæ˜¾å¼è°ƒç”¨\texttt{print}å‡½æ•°ä¼šå¾ˆæœ‰ç”¨ã€‚}
å‚æ•°æ¥æŸ¥çœ‹ç²¾ç¡®å€¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(x, }\AttributeTok{digits =} \DecValTok{16}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] 0.9999999999999999 2.0000000000000004}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥çœ‹åˆ°ä¸ºä»€ä¹ˆRé»˜è®¤ä¼šå¯¹è¿™äº›æ•°å­—è¿›è¡Œå››èˆäº”å…¥ï¼›å®ƒä»¬ç¡®å®éå¸¸æ¥è¿‘ä½ é¢„æœŸçš„å€¼ã€‚

æ—¢ç„¶ä½ å·²ç»æ˜ç™½äº†ä¸ºä»€ä¹ˆ\texttt{==}ä¼šå¤±è´¥ï¼Œé‚£ä½ èƒ½åšä»€ä¹ˆå‘¢ï¼Ÿä¸€
ä¸ªé€‰æ‹©æ˜¯ä½¿ç”¨\texttt{dplyr::near()}å‡½æ•°ï¼Œå®ƒä¼šå¿½ç•¥å¾®å°çš„å·®å¼‚ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{near}\NormalTok{(x, }\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] TRUE TRUE}
\end{Highlighting}
\end{Shaded}

\subsection{ç¼ºå¤±å€¼}\label{sec-na-comparison}

ç¼ºå¤±å€¼ä»£è¡¨æœªçŸ¥ï¼Œå› æ­¤å®ƒä»¬æ˜¯``å…·æœ‰ä¼ æŸ“æ€§çš„''ï¼šå‡ ä¹ä»»ä½•æ¶‰åŠæœªçŸ¥å€¼çš„æ“ä½œä¹Ÿå°†æ˜¯æœªçŸ¥çš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\ConstantTok{NA} \SpecialCharTok{\textgreater{}} \DecValTok{5}
\CommentTok{\#\textgreater{} [1] NA}
\DecValTok{10} \SpecialCharTok{==} \ConstantTok{NA}
\CommentTok{\#\textgreater{} [1] NA}
\end{Highlighting}
\end{Shaded}

æœ€ä»¤äººå›°æƒ‘çš„ç»“æœæ˜¯è¿™ä¸€ä¸ªï¼š

\begin{Shaded}
\begin{Highlighting}[]
\ConstantTok{NA} \SpecialCharTok{==} \ConstantTok{NA}
\CommentTok{\#\textgreater{} [1] NA}
\end{Highlighting}
\end{Shaded}

å¦‚æœæˆ‘ä»¬äººä¸ºåœ°æ·»åŠ ä¸€äº›é¢å¤–çš„ä¸Šä¸‹æ–‡ï¼Œå°†æ›´å®¹æ˜“ç†è§£ä¸ºä»€ä¹ˆè¿™æ˜¯æ­£ç¡®çš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# We don\textquotesingle{}t know how old Mary is}
\NormalTok{age\_mary }\OtherTok{\textless{}{-}} \ConstantTok{NA}

\CommentTok{\# We don\textquotesingle{}t know how old John is}
\NormalTok{age\_john }\OtherTok{\textless{}{-}} \ConstantTok{NA}

\CommentTok{\# Are Mary and John the same age?}
\NormalTok{age\_mary }\SpecialCharTok{==}\NormalTok{ age\_john}
\CommentTok{\#\textgreater{} [1] NA}
\CommentTok{\# We don\textquotesingle{}t know!}
\end{Highlighting}
\end{Shaded}

æ‰€ä»¥ï¼Œå¦‚æœä½ æƒ³è¦æ‰¾å‡ºæ‰€æœ‰\texttt{dep\_time}ç¼ºå¤±çš„èˆªç­ï¼Œä»¥ä¸‹ä»£ç æ˜¯ä¸èµ·ä½œç”¨çš„ï¼Œå› ä¸º\texttt{dep\_time\ ==\ NA}å¯¹äºæ¯ä¸€è¡Œéƒ½ä¼šè¿”å›\texttt{NA}ï¼Œè€Œ\texttt{filter()}å‡½æ•°ä¼šè‡ªåŠ¨ä¸¢å¼ƒç¼ºå¤±å€¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(dep\_time }\SpecialCharTok{==} \ConstantTok{NA}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 0 x 19}
\CommentTok{\#\textgreater{} \# i 19 variables: year \textless{}int\textgreater{}, month \textless{}int\textgreater{}, day \textless{}int\textgreater{}, dep\_time \textless{}int\textgreater{},}
\CommentTok{\#\textgreater{} \#   sched\_dep\_time \textless{}int\textgreater{}, dep\_delay \textless{}dbl\textgreater{}, arr\_time \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

ç›¸åï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–°å·¥å…·: \texttt{is.na()}.

\subsection{\texorpdfstring{\texttt{is.na()}}{is.na()}}\label{is.na}

\texttt{is.na(x)}é€‚ç”¨äºä»»ä½•ç±»å‹çš„å‘é‡ï¼Œå¯¹äºç¼ºå¤±å€¼è¿”å›
\texttt{TRUE}ï¼Œå¯¹äºå…¶ä»–æ‰€æœ‰å€¼è¿”å› \texttt{FALSE}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{is.na}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] FALSE  TRUE FALSE}
\FunctionTok{is.na}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\DecValTok{3}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] FALSE  TRUE FALSE}
\FunctionTok{is.na}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\StringTok{"b"}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] FALSE  TRUE FALSE}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{is.na()}æ¥æ‰¾åˆ°æ‰€æœ‰ç¼ºå¤±\texttt{dep\_time}çš„è¡Œï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(dep\_time))}
\CommentTok{\#\textgreater{} \# A tibble: 8,255 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1       NA           1630        NA       NA           1815}
\CommentTok{\#\textgreater{} 2  2013     1     1       NA           1935        NA       NA           2240}
\CommentTok{\#\textgreater{} 3  2013     1     1       NA           1500        NA       NA           1825}
\CommentTok{\#\textgreater{} 4  2013     1     1       NA            600        NA       NA            901}
\CommentTok{\#\textgreater{} 5  2013     1     2       NA           1540        NA       NA           1747}
\CommentTok{\#\textgreater{} 6  2013     1     2       NA           1620        NA       NA           1746}
\CommentTok{\#\textgreater{} \# i 8,249 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

\texttt{is.na()}åœ¨\texttt{arrange()}å‡½æ•°ä¸­ä¹Ÿéå¸¸æœ‰ç”¨ã€‚\texttt{a}
\texttt{rrange()}é€šå¸¸å°†æ‰€æœ‰ç¼ºå¤±å€¼æ”¾åœ¨æœ€åï¼Œä½†ä½ å¯ä»¥é€šè¿‡é¦–å…ˆæ ¹æ®\texttt{is.na()}è¿›è¡Œæ’åºæ¥è¦†ç›–è¿™ä¸ªé»˜è®¤è¡Œä¸ºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(month }\SpecialCharTok{==} \DecValTok{1}\NormalTok{, day }\SpecialCharTok{==} \DecValTok{1}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{arrange}\NormalTok{(dep\_time)}
\CommentTok{\#\textgreater{} \# A tibble: 842 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      517            515         2      830            819}
\CommentTok{\#\textgreater{} 2  2013     1     1      533            529         4      850            830}
\CommentTok{\#\textgreater{} 3  2013     1     1      542            540         2      923            850}
\CommentTok{\#\textgreater{} 4  2013     1     1      544            545        {-}1     1004           1022}
\CommentTok{\#\textgreater{} 5  2013     1     1      554            600        {-}6      812            837}
\CommentTok{\#\textgreater{} 6  2013     1     1      554            558        {-}4      740            728}
\CommentTok{\#\textgreater{} \# i 836 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}

\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(month }\SpecialCharTok{==} \DecValTok{1}\NormalTok{, day }\SpecialCharTok{==} \DecValTok{1}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(dep\_time)), dep\_time)}
\CommentTok{\#\textgreater{} \# A tibble: 842 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1       NA           1630        NA       NA           1815}
\CommentTok{\#\textgreater{} 2  2013     1     1       NA           1935        NA       NA           2240}
\CommentTok{\#\textgreater{} 3  2013     1     1       NA           1500        NA       NA           1825}
\CommentTok{\#\textgreater{} 4  2013     1     1       NA            600        NA       NA            901}
\CommentTok{\#\textgreater{} 5  2013     1     1      517            515         2      830            819}
\CommentTok{\#\textgreater{} 6  2013     1     1      533            529         4      850            830}
\CommentTok{\#\textgreater{} \# i 836 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å°†åœ¨ ç« èŠ‚~\ref{sec-missing-values} æ›´æ·±å…¥åœ°è®¨è®ºç¼ºå¤±å€¼ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-28}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \texttt{dplyr::near()} æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿé”®å…¥\texttt{near}ä»¥æŸ¥çœ‹æºä»£ç ã€‚
  \texttt{sqrt(2)\^{}2} ä¸ 2æ¥è¿‘å—ï¼Ÿ
\item
  ç»“åˆä½¿ç”¨\texttt{mutate()},\texttt{is.na()},å’Œ\texttt{count()}æ¥æè¿°\texttt{dep\_time}ã€\texttt{sched\_dep\_time}å’Œ\texttt{dep\_delay}ä¸­ç¼ºå¤±å€¼ä¹‹é—´çš„è”ç³»ã€‚
\end{enumerate}

\section{å¸ƒå°”ä»£æ•°}\label{ux5e03ux5c14ux4ee3ux6570}

è‹¥ä½ æœ‰äº†å¤šä¸ªé€»è¾‘å‘é‡ï¼Œå¯ä»¥ä½¿ç”¨å¸ƒå°”ä»£æ•°å°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·ã€‚åœ¨
Rä¸­ï¼Œ\texttt{\&}æ˜¯``å’Œ''ï¼Œ\texttt{\textbar{}}æ˜¯``æˆ–''ï¼Œ\texttt{!}~æ˜¯``é''ï¼Œè€Œ\texttt{xor()}æ˜¯å¼‚æˆ–\footnote{ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœ\texttt{x}ä¸ºçœŸï¼Œæˆ–\texttt{y}ä¸ºçœŸï¼Œä½†ä¸¤è€…ä¸åŒæ—¶ä¸ºçœŸï¼Œé‚£ä¹ˆ\texttt{xor(x,\ y)}å°±ä¸ºçœŸã€‚è¿™
  é€šå¸¸æ˜¯æˆ‘ä»¬åœ¨è‹±è¯­ä¸­ä½¿ç”¨``æˆ–''çš„æ–¹å¼ã€‚``
  ä¸¤è€…éƒ½''é€šå¸¸ä¸æ˜¯å¯¹``ä½ æƒ³è¦å†°æ·‡æ·‹è¿˜æ˜¯è›‹ç³•ï¼Ÿ'' è¿™ä¸ªé—®é¢˜çš„å¯æ¥å—ç­”æ¡ˆã€‚}ã€‚
ä¾‹å¦‚ï¼Œ\texttt{df\ \%\textgreater{}\%\ filter(!is.na(x))}æŸ¥æ‰¾æ‰€æœ‰\texttt{x}ä¸ç¼ºå¤±çš„è¡Œï¼Œè€Œ\texttt{df\ \%\textgreater{}\%\ filter(x\ \textless{}\ -10\ \textbar{}\ x\ \textgreater{}\ 0)}æŸ¥æ‰¾æ‰€æœ‰\texttt{x}å°äº-10æˆ–å¤§äº0çš„è¡Œã€‚
å›¾~\ref{fig-bool-ops} å±•ç¤ºäº†å®Œæ•´çš„å¸ƒå°”æ“ä½œé›†ä»¥åŠå®ƒä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

\begin{figure}

\centering{

\includegraphics[width=4.12in,height=\textheight]{diagrams/transform.png}

}

\caption{\label{fig-bool-ops}The complete set of Boolean operations.
\texttt{x} is the left-hand circle, \texttt{y} is the right-hand circle,
and the shaded region show which parts each operator selects.}

\end{figure}%

é™¤äº†\texttt{\&}å’Œ\texttt{\textbar{}}ä¹‹å¤–ï¼ŒR
è¿˜æœ‰\texttt{\&\&}å’Œ\texttt{\textbar{}\textbar{}}ã€‚ä¸ è¦åœ¨ dplyr
å‡½æ•°ä¸­ä½¿ç”¨å®ƒä»¬ï¼è¿™ äº›è¢«ç§°ä¸ºçŸ­è·¯è¿ç®—ç¬¦ï¼Œå¹¶ä¸”æ€»æ˜¯åªè¿”å›ä¸€ä¸ª \texttt{TRUE}
æˆ– \texttt{FALSE}ã€‚å®ƒ ä»¬å¯¹ç¼–ç¨‹å¾ˆé‡è¦ï¼Œä½†å¯¹æ•°æ®ç§‘å­¦æ¥è¯´å¹¶ä¸é‡è¦ã€‚

As well as \texttt{\&} and \texttt{\textbar{}}, R also has \texttt{\&\&}
and \texttt{\textbar{}\textbar{}}. Don't use them in dplyr functions!
These are called short-circuiting operators and only ever return a
single \texttt{TRUE} or \texttt{FALSE}. They're important for
programming, not data science.

\subsection{ç¼ºå¤±å€¼}\label{sec-na-boolean}

å¸ƒå°”ä»£æ•°ä¸­ç¼ºå¤±å€¼çš„è§„åˆ™æœ‰ç‚¹éš¾è§£é‡Šï¼Œå› ä¸ºä¹ä¸€çœ‹å®ƒä»¬ä¼¼ä¹ä¸ä¸€è‡´ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{, }\ConstantTok{NA}\NormalTok{))}

\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{and =}\NormalTok{ x }\SpecialCharTok{\&} \ConstantTok{NA}\NormalTok{,}
    \AttributeTok{or =}\NormalTok{ x }\SpecialCharTok{|} \ConstantTok{NA}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 3}
\CommentTok{\#\textgreater{}   x     and   or   }
\CommentTok{\#\textgreater{}   \textless{}lgl\textgreater{} \textless{}lgl\textgreater{} \textless{}lgl\textgreater{}}
\CommentTok{\#\textgreater{} 1 TRUE  NA    TRUE }
\CommentTok{\#\textgreater{} 2 FALSE FALSE NA   }
\CommentTok{\#\textgreater{} 3 NA    NA    NA}
\end{Highlighting}
\end{Shaded}

è¦ç†è§£å…¶ä¸­çš„åŸå› ï¼Œå¯ä»¥è€ƒè™‘\texttt{NA\ \textbar{}\ TRUE}ï¼ˆå³\texttt{NA}æˆ–\texttt{TRUE}ï¼‰ã€‚åœ¨
é€»è¾‘å‘é‡ä¸­ï¼Œç¼ºå¤±å€¼æ„å‘³ç€è¯¥å€¼å¯èƒ½æ˜¯\texttt{TRUE}æˆ–\texttt{FALSE}ã€‚å› 
ä¸ºè‡³å°‘æœ‰ä¸€ä¸ªæ˜¯\texttt{TRUE}ï¼Œæ‰€ä»¥\texttt{TRUE\ \textbar{}\ TRUE}å’Œ\texttt{FALSE\ \textbar{}\ TRUE}~éƒ½æ˜¯\texttt{TRUE}ã€‚\texttt{N}
\texttt{A\ \textbar{}\ TRUE}ä¹Ÿå¿…é¡»æ˜¯\texttt{TRUE}ï¼Œå› ä¸º\texttt{NA}å¯ä»¥æ˜¯\texttt{TRUE}æˆ–\texttt{FALSE}ã€‚ç„¶
è€Œï¼Œ\texttt{NA\ \textbar{}\ FALSE}æ˜¯\texttt{NA}ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“\texttt{NA}æ˜¯\texttt{TRUE}è¿˜æ˜¯\texttt{FALSE}ã€‚ç±»
ä¼¼çš„æ¨ç†ä¹Ÿé€‚ç”¨äº\texttt{NA\ \&\ FALSE}ã€‚

\subsection{è¿ç®—é¡ºåº}\label{ux8fd0ux7b97ux987aux5e8f}

è¯·æ³¨æ„ï¼Œæ“ä½œçš„é¡ºåºå¹¶ä¸ä¸è‹±è¯­ä¸­çš„é¡ºåºç›¸åŒã€‚ä»¥
ä¸‹ä»£ç ç”¨äºæŸ¥æ‰¾æ‰€æœ‰åœ¨åä¸€æœˆæˆ–åäºŒæœˆå‡ºå‘çš„èˆªç­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
   \FunctionTok{filter}\NormalTok{(month }\SpecialCharTok{==} \DecValTok{11} \SpecialCharTok{|}\NormalTok{ month }\SpecialCharTok{==} \DecValTok{12}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

ä½ å¯èƒ½ä¼šæƒ³è¦åƒåœ¨è‹±è¯­ä¸­é‚£æ ·å†™ï¼š ``Find all flights that departed in
November or December.'':

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
   \FunctionTok{filter}\NormalTok{(month }\SpecialCharTok{==} \DecValTok{11} \SpecialCharTok{|} \DecValTok{12}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      517            515         2      830            819}
\CommentTok{\#\textgreater{} 2  2013     1     1      533            529         4      850            830}
\CommentTok{\#\textgreater{} 3  2013     1     1      542            540         2      923            850}
\CommentTok{\#\textgreater{} 4  2013     1     1      544            545        {-}1     1004           1022}
\CommentTok{\#\textgreater{} 5  2013     1     1      554            600        {-}6      812            837}
\CommentTok{\#\textgreater{} 6  2013     1     1      554            558        {-}4      740            728}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

è¿™æ®µä»£ç æ²¡æœ‰æŠ¥é”™ï¼Œä½†çœ‹èµ·æ¥ä¹Ÿæ²¡æœ‰æ­£å¸¸å·¥ä½œã€‚è¿™ æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿåœ¨ è¿™é‡Œï¼ŒR
é¦–å…ˆè®¡ç®—\texttt{month\ ==\ 11}åˆ›å»ºä¸€ä¸ªé€»è¾‘å‘é‡ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º\texttt{nov}ã€‚ç„¶
åå®ƒè®¡ç®—\texttt{nov\ \textbar{}\ 12}ã€‚å½“
ä½ ä½¿ç”¨æ•°å­—ä¸é€»è¾‘è¿ç®—ç¬¦ç»“åˆæ—¶ï¼Œé™¤äº†0ä»¥å¤–çš„æ‰€æœ‰æ•°å­—éƒ½ä¼šè¢«è½¬æ¢ä¸ºTRUEï¼Œå› æ­¤è¿™ç­‰ä»·äº\texttt{nov\ \textbar{}\ TRUE}ï¼Œè€Œ\texttt{TRUE\ \textbar{}\ TRUE}æ€»æ˜¯\texttt{TRUE}ï¼Œæ‰€ä»¥æ¯ä¸€è¡Œéƒ½ä¼šè¢«é€‰ä¸­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{nov =}\NormalTok{ month }\SpecialCharTok{==} \DecValTok{11}\NormalTok{,}
    \AttributeTok{final =}\NormalTok{ nov }\SpecialCharTok{|} \DecValTok{12}\NormalTok{,}
    \AttributeTok{.keep =} \StringTok{"used"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 3}
\CommentTok{\#\textgreater{}   month nov   final}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}lgl\textgreater{} \textless{}lgl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1 FALSE TRUE }
\CommentTok{\#\textgreater{} 2     1 FALSE TRUE }
\CommentTok{\#\textgreater{} 3     1 FALSE TRUE }
\CommentTok{\#\textgreater{} 4     1 FALSE TRUE }
\CommentTok{\#\textgreater{} 5     1 FALSE TRUE }
\CommentTok{\#\textgreater{} 6     1 FALSE TRUE }
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\end{Highlighting}
\end{Shaded}

\subsection{\texorpdfstring{\texttt{\%in\%}}{\%in\%}}\label{in}

é¿å… \texttt{==}s å’Œ \texttt{\textbar{}}s
é¡ºåºé”™è¯¯çš„ä¸€ä¸ªç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨\texttt{\%in\%}ã€‚\texttt{x}
\texttt{\%in\%\ y}è¿”å›ä¸€ä¸ªä¸\texttt{x}é•¿åº¦ç›¸åŒçš„é€»è¾‘å‘é‡ï¼Œå½“\texttt{x}ä¸­çš„æŸä¸ªå€¼åœ¨\texttt{y}ä¸­æ—¶ï¼Œè¯¥é€»è¾‘å‘é‡çš„å¯¹åº”ä½ç½®ä¸º\texttt{TRUE}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1}\SpecialCharTok{:}\DecValTok{12} \SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{11}\NormalTok{)}
\CommentTok{\#\textgreater{}  [1]  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE}
\NormalTok{letters[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{] }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"e"}\NormalTok{, }\StringTok{"i"}\NormalTok{, }\StringTok{"o"}\NormalTok{, }\StringTok{"u"}\NormalTok{)}
\CommentTok{\#\textgreater{}  [1]  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE}
\end{Highlighting}
\end{Shaded}

å› æ­¤ï¼Œè¦æŸ¥æ‰¾11æœˆå’Œ12æœˆçš„æ‰€æœ‰èˆªç­ï¼Œå¯ä»¥è¿™æ ·å†™:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(month }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\DecValTok{11}\NormalTok{, }\DecValTok{12}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„ï¼Œ\texttt{\%in\%}å¯¹\texttt{NA}çš„å¤„ç†è§„åˆ™ä¸\texttt{==}ä¸åŒï¼Œå› ä¸º\texttt{NA\ \%in\%\ NA}æ˜¯TRUEã€‚

Note that \texttt{\%in\%} obeys different rules for \texttt{NA} to
\texttt{==}, as \texttt{NA\ \%in\%\ NA} is \texttt{TRUE}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\ConstantTok{NA}\NormalTok{) }\SpecialCharTok{==} \ConstantTok{NA}
\CommentTok{\#\textgreater{} [1] NA NA NA}
\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\ConstantTok{NA}\NormalTok{) }\SpecialCharTok{\%in\%} \ConstantTok{NA}
\CommentTok{\#\textgreater{} [1] FALSE FALSE  TRUE}
\end{Highlighting}
\end{Shaded}

è¿™å¯ä»¥ä½œä¸ºä¸€ä¸ªæœ‰ç”¨çš„å¿«æ·æ–¹å¼:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(dep\_time }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\DecValTok{0800}\NormalTok{))}
\CommentTok{\#\textgreater{} \# A tibble: 8,803 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      800            800         0     1022           1014}
\CommentTok{\#\textgreater{} 2  2013     1     1      800            810       {-}10      949            955}
\CommentTok{\#\textgreater{} 3  2013     1     1       NA           1630        NA       NA           1815}
\CommentTok{\#\textgreater{} 4  2013     1     1       NA           1935        NA       NA           2240}
\CommentTok{\#\textgreater{} 5  2013     1     1       NA           1500        NA       NA           1825}
\CommentTok{\#\textgreater{} 6  2013     1     1       NA            600        NA       NA            901}
\CommentTok{\#\textgreater{} \# i 8,797 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-29}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  æ‰¾å‡ºæ‰€æœ‰åˆ°è¾¾å»¶è¯¯ï¼ˆ\texttt{arr\_delay}ï¼‰ç¼ºå¤±ä½†èµ·é£å»¶è¯¯ï¼ˆ\texttt{dep\_delay}ï¼‰ä¸ç¼ºå¤±çš„èˆªç­ã€‚æ‰¾å‡ºæ‰€æœ‰åˆ°è¾¾æ—¶é—´ï¼ˆ\texttt{arr\_time}ï¼‰å’Œè®¡åˆ’åˆ°è¾¾æ—¶é—´ï¼ˆ\texttt{sched\_arr\_time}ï¼‰éƒ½ä¸ç¼ºå¤±ï¼Œä½†åˆ°è¾¾å»¶è¯¯ï¼ˆ\texttt{arr\_delay}ï¼‰ç¼ºå¤±çš„èˆªç­ã€‚
\item
  æœ‰å¤šå°‘èˆªç­çš„èµ·é£æ—¶é—´ï¼ˆ\texttt{dep\_time}ï¼‰æ˜¯ç¼ºå¤±çš„ï¼Ÿè¿™äº›è¡Œä¸­è¿˜ç¼ºå¤±äº†å“ªäº›å…¶ä»–å˜é‡ï¼Ÿè¿™äº›è¡Œå¯èƒ½ä»£è¡¨ä»€ä¹ˆï¼Ÿ
\item
  å‡è®¾ç¼ºå¤±çš„èµ·é£æ—¶é—´ï¼ˆ\texttt{dep\_time}ï¼‰æ„å‘³ç€èˆªç­è¢«å–æ¶ˆï¼ŒæŸ¥çœ‹æ¯å¤©å–æ¶ˆçš„èˆªç­æ•°é‡ã€‚æ˜¯å¦å­˜åœ¨æŸç§æ¨¡å¼ï¼Ÿè¢«å–æ¶ˆèˆªç­çš„æ¯”ä¾‹ä¸éã€‘æœªè¢«å–æ¶ˆèˆªç­çš„å¹³å‡å»¶è¯¯ä¹‹é—´æ˜¯å¦å­˜åœ¨è”ç³»ï¼Ÿ
\end{enumerate}

\section{å°ç»“}\label{sec-logical-summaries}

ä»¥ä¸‹éƒ¨åˆ†æè¿°äº†ä¸€äº›ç”¨äºæ€»ç»“é€»è¾‘å‘é‡çš„æœ‰ç”¨æŠ€æœ¯ã€‚é™¤
äº†ä¸“é—¨ä¸é€»è¾‘å‘é‡ä¸€èµ·å·¥ä½œçš„å‡½æ•°å¤–ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨ä¸æ•°å­—å‘é‡ä¸€èµ·å·¥ä½œçš„å‡½æ•°ã€‚

\subsection{é€»è¾‘æ±‡æ€»å‡½æ•°ï¼ˆlogical
summariesï¼‰}\label{ux903bux8f91ux6c47ux603bux51fdux6570logical-summaries}

æœ‰ä¸¤ä¸ªä¸»è¦çš„é€»è¾‘æ±‡æ€»å‡½æ•°ï¼š\texttt{any()}å’Œ\texttt{all()}ã€‚\texttt{a}
\texttt{ny(x)}ç›¸å½“äº\texttt{\textbar{}}ï¼Œå¦‚æœ\texttt{x}ä¸­æœ‰ä»»ä½•\texttt{TRUE}å€¼ï¼Œå®ƒå°±ä¼šè¿”å›\texttt{TRUE}ã€‚\texttt{a}
\texttt{ll(x)}ç›¸å½“äº\texttt{\&}ï¼Œåªæœ‰å½“\texttt{x}çš„æ‰€æœ‰å€¼éƒ½æ˜¯\texttt{TRUE}æ—¶ï¼Œå®ƒæ‰ä¼šè¿”å›\texttt{TRUE}ã€‚åƒ
æ‰€æœ‰æ±‡æ€»å‡½æ•°ä¸€æ ·ï¼Œå¦‚æœå­˜åœ¨ä»»ä½•ç¼ºå¤±å€¼ï¼Œå®ƒä»¬å°†è¿”å›\texttt{NA}ï¼Œå¹¶ä¸”ä½ å¯ä»¥åƒå¾€å¸¸ä¸€æ ·ä½¿ç”¨\texttt{na.rm\ =\ TRUE}æ¥è®©ç¼ºå¤±å€¼æ¶ˆå¤±ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{all()}å’Œ\texttt{any()}æ¥æ‰¾å‡ºæ˜¯å¦æ¯ä¸ªèˆªç­çš„èµ·é£å»¶è¯¯éƒ½ä¸è¶…è¿‡ä¸€ä¸ªå°æ—¶ï¼Œæˆ–è€…æ˜¯å¦æœ‰ä»»ä½•èˆªç­çš„åˆ°è¾¾å»¶è¯¯äº†äº”ä¸ªå°æ—¶æˆ–æ›´å¤šã€‚ä½¿
ç”¨\texttt{group\_by()}å¯ä»¥è®©æˆ‘ä»¬æŒ‰å¤©æ¥æ‰§è¡Œè¿™äº›æ“ä½œï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(year, month, day) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{all\_delayed =} \FunctionTok{all}\NormalTok{(dep\_delay }\SpecialCharTok{\textless{}=} \DecValTok{60}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{any\_long\_delay =} \FunctionTok{any}\NormalTok{(arr\_delay }\SpecialCharTok{\textgreater{}=} \DecValTok{300}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 365 x 5}
\CommentTok{\#\textgreater{}    year month   day all\_delayed any\_long\_delay}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}lgl\textgreater{}       \textless{}lgl\textgreater{}         }
\CommentTok{\#\textgreater{} 1  2013     1     1 FALSE       TRUE          }
\CommentTok{\#\textgreater{} 2  2013     1     2 FALSE       TRUE          }
\CommentTok{\#\textgreater{} 3  2013     1     3 FALSE       FALSE         }
\CommentTok{\#\textgreater{} 4  2013     1     4 FALSE       FALSE         }
\CommentTok{\#\textgreater{} 5  2013     1     5 FALSE       TRUE          }
\CommentTok{\#\textgreater{} 6  2013     1     6 FALSE       FALSE         }
\CommentTok{\#\textgreater{} \# i 359 more rows}
\end{Highlighting}
\end{Shaded}

ç„¶è€Œï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ\texttt{any()}å’Œ\texttt{all()}æœ‰ç‚¹è¿‡äºç²—ç•¥ï¼Œå¦‚æœèƒ½å¤Ÿæ›´è¯¦ç»†åœ°äº†è§£æœ‰å¤šå°‘å€¼æ˜¯\texttt{TRUE}æˆ–\texttt{FALSE}å°±å¥½äº†ã€‚è¿™
å°±å¼•å‡ºäº†æ•°å€¼æ‘˜è¦ï¼ˆnumeric summariesï¼‰ã€‚

\subsection{é€»è¾‘å‘é‡çš„æ•°å€¼æ±‡æ€»}\label{sec-numeric-summaries-of-logicals}

å½“ä½ åœ¨æ•°å€¼ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨é€»è¾‘å‘é‡æ—¶ï¼Œ\texttt{TRUE} å˜æˆ 1ï¼Œ\texttt{FALSE}
å˜æˆ 0ã€‚è¿™
ä½¿å¾—\texttt{sum()}å’Œ\texttt{mean()}å‡½æ•°å¯¹é€»è¾‘å‘é‡éå¸¸æœ‰ç”¨ï¼Œå› ä¸º\texttt{sum(x)}ç»™å‡º
\texttt{TRUE} çš„æ•°é‡ï¼Œè€Œ\texttt{mean(x)}ç»™å‡º \texttt{TRUE}
çš„æ¯”ä¾‹ï¼ˆå› ä¸º\texttt{mean()}å®é™…ä¸Šå°±æ˜¯\texttt{sum()}é™¤ä»¥\texttt{length()}ï¼‰ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹èµ·é£å»¶è¯¯æœ€å¤šä¸€å°æ—¶çš„èˆªç­çš„æ¯”ä¾‹ï¼Œä»¥åŠåˆ°è¾¾å»¶è¯¯äº”å°æ—¶æˆ–æ›´å¤šçš„èˆªç­çš„æ•°é‡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(year, month, day) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{proportion\_delayed =} \FunctionTok{mean}\NormalTok{(dep\_delay }\SpecialCharTok{\textless{}=} \DecValTok{60}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{count\_long\_delay =} \FunctionTok{sum}\NormalTok{(arr\_delay }\SpecialCharTok{\textgreater{}=} \DecValTok{300}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 365 x 5}
\CommentTok{\#\textgreater{}    year month   day proportion\_delayed count\_long\_delay}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}              \textless{}dbl\textgreater{}            \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1              0.939                3}
\CommentTok{\#\textgreater{} 2  2013     1     2              0.914                3}
\CommentTok{\#\textgreater{} 3  2013     1     3              0.941                0}
\CommentTok{\#\textgreater{} 4  2013     1     4              0.953                0}
\CommentTok{\#\textgreater{} 5  2013     1     5              0.964                1}
\CommentTok{\#\textgreater{} 6  2013     1     6              0.959                0}
\CommentTok{\#\textgreater{} \# i 359 more rows}
\end{Highlighting}
\end{Shaded}

\subsection{é€»è¾‘å­é›†ï¼ˆlogical
subsettingï¼‰}\label{ux903bux8f91ux5b50ux96c6logical-subsetting}

é€»è¾‘å‘é‡åœ¨æ±‡æ€»ä¸­çš„æœ€åä¸€ä¸ªç”¨é€”æ˜¯ï¼šä½ å¯ä»¥ä½¿ç”¨é€»è¾‘å‘é‡æ¥ç­›é€‰å•ä¸ªå˜é‡åˆ°æ„Ÿå…´è¶£çš„å­é›†ã€‚è¿™
åˆ©ç”¨äº†åŸºæœ¬çš„å­é›†æ“ä½œç¬¦\texttt{{[}}ï¼ˆå‘éŸ³ä¸º``subset''ï¼‰ï¼Œä½ å°†åœ¨
å°èŠ‚~\ref{sec-subset-many} ä¸­å­¦åˆ°æ›´å¤šå…³äºå®ƒçš„å†…å®¹ã€‚

æˆ‘ä»¬æƒ³è¦æŸ¥çœ‹å®é™…ä¸Šæœ‰å»¶è¯¯çš„èˆªç­çš„å¹³å‡å»¶è¯¯æ—¶é—´ã€‚ä¸€
ç§æ–¹æ³•æ˜¯å…ˆç­›é€‰èˆªç­ï¼Œç„¶åè®¡ç®—å¹³å‡å»¶è¯¯æ—¶é—´ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(arr\_delay }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(year, month, day) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{behind =} \FunctionTok{mean}\NormalTok{(arr\_delay),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 365 x 5}
\CommentTok{\#\textgreater{}    year month   day behind     n}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}  \textless{}dbl\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1   32.5   461}
\CommentTok{\#\textgreater{} 2  2013     1     2   32.0   535}
\CommentTok{\#\textgreater{} 3  2013     1     3   27.7   460}
\CommentTok{\#\textgreater{} 4  2013     1     4   28.3   297}
\CommentTok{\#\textgreater{} 5  2013     1     5   22.6   238}
\CommentTok{\#\textgreater{} 6  2013     1     6   24.4   381}
\CommentTok{\#\textgreater{} \# i 359 more rows}
\end{Highlighting}
\end{Shaded}

è¿™æ ·åšæ˜¯å¯ä»¥çš„ï¼Œä½†å¦‚æœæˆ‘ä»¬è¿˜æƒ³è®¡ç®—æå‰åˆ°è¾¾çš„èˆªç­çš„å¹³å‡å»¶è¯¯æ—¶é—´å‘¢ï¼Ÿæˆ‘
ä»¬éœ€è¦æ‰§è¡Œä¸€ä¸ªå•ç‹¬çš„ç­›é€‰æ­¥éª¤ï¼Œç„¶åè€ƒè™‘å¦‚ä½•å°†ä¸¤ä¸ªæ•°æ®æ¡†åˆå¹¶åœ¨ä¸€èµ·ã€‚ç›¸
åï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{{[}}æ¥æ‰§è¡Œå†…è”ç­›é€‰ï¼š\texttt{arr\_delay{[}arr\_delay\ \textgreater{}\ 0{]}}å°†ä»…è¿”å›æ­£çš„åˆ°è¾¾å»¶è¯¯æ—¶é—´ã€‚

ç”±æ­¤å¼•å‡ºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(year, month, day) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{behind =} \FunctionTok{mean}\NormalTok{(arr\_delay[arr\_delay }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{], }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{ahead =} \FunctionTok{mean}\NormalTok{(arr\_delay[arr\_delay }\SpecialCharTok{\textless{}} \DecValTok{0}\NormalTok{], }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 365 x 6}
\CommentTok{\#\textgreater{}    year month   day behind ahead     n}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}  \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1   32.5 {-}12.5   842}
\CommentTok{\#\textgreater{} 2  2013     1     2   32.0 {-}14.3   943}
\CommentTok{\#\textgreater{} 3  2013     1     3   27.7 {-}18.2   914}
\CommentTok{\#\textgreater{} 4  2013     1     4   28.3 {-}17.0   915}
\CommentTok{\#\textgreater{} 5  2013     1     5   22.6 {-}14.0   720}
\CommentTok{\#\textgreater{} 6  2013     1     6   24.4 {-}13.6   832}
\CommentTok{\#\textgreater{} \# i 359 more rows}
\end{Highlighting}
\end{Shaded}

åŒæ—¶ä¹Ÿè¦æ³¨æ„ç»„å¤§å°çš„å·®å¼‚ï¼šåœ¨ç¬¬ä¸€éƒ¨åˆ†ä¸­ï¼Œ\texttt{n()}ç»™å‡ºçš„æ˜¯æ¯å¤©å»¶è¯¯èˆªç­çš„æ•°é‡ï¼›åœ¨ç¬¬äºŒéƒ¨åˆ†ä¸­ï¼Œ\texttt{n()}ç»™å‡ºçš„æ˜¯æ€»èˆªç­æ•°é‡ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-30}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \texttt{sum(is.na(x))} ä¼šå‘Šè¯‰ä½ ä»€ä¹ˆä¿¡æ¯ï¼Ÿ \texttt{mean(is.na(x))}å‘¢ï¼Ÿ
\item
  å½“åº”ç”¨äºé€»è¾‘å‘é‡æ—¶ï¼Œ\texttt{prod()}è¿”å›ä»€ä¹ˆï¼Ÿå®ƒç­‰äºä»€ä¹ˆé€»è¾‘æ±‡æ€»å‡½æ•°ï¼Ÿå½“åº”ç”¨äºé€»è¾‘å‘é‡æ—¶\texttt{min()}è¿”å›ä»€ä¹ˆï¼Ÿå®ƒç­‰äºä»€ä¹ˆé€»è¾‘æ±‡æ€»å‡½æ•°ï¼Ÿé˜…è¯»æ–‡æ¡£å¹¶è¿›è¡Œä¸€äº›å®éªŒã€‚
\end{enumerate}

\section{æ¡ä»¶è½¬æ¢}\label{ux6761ux4ef6ux8f6cux6362}

é€»è¾‘å‘é‡æœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€æ˜¯ç”¨äºæ¡ä»¶è½¬æ¢ï¼Œå³å½“æ»¡è¶³æ¡ä»¶xæ—¶æ‰§è¡Œä¸€ä¸ªæ“ä½œï¼Œå½“æ»¡è¶³æ¡ä»¶yæ—¶æ‰§è¡Œå¦ä¸€ä¸ªæ“ä½œã€‚æœ‰
ä¸¤ä¸ªé‡è¦çš„å·¥å…·å¯ä»¥å®ç°è¿™ä¸€åŠŸèƒ½ï¼š\texttt{if\_else()}å’Œ\texttt{case\_when()}ã€‚

\subsection{\texorpdfstring{\texttt{if\_else()}}{if\_else()}}\label{if_else}

å¦‚æœä½ æƒ³è¦åœ¨ä¸€ä¸ªæ¡ä»¶ä¸º\texttt{TRUE}æ—¶ä½¿ç”¨ä¸€ä¸ªå€¼ï¼Œè€Œåœ¨æ¡ä»¶ä¸º\texttt{FALSE}æ—¶ä½¿ç”¨å¦ä¸€ä¸ªå€¼ï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{dplyr::if\_else()}ã€‚ä½ 
æ€»æ˜¯ä¼šç”¨åˆ°\texttt{if\_else()}çš„å‰ä¸‰ä¸ªå‚æ•°ã€‚ç¬¬
ä¸€ä¸ªå‚æ•°\texttt{condition}ï¼Œæ˜¯ä¸€ä¸ªé€»è¾‘å‘é‡ï¼›ç¬¬äºŒä¸ªå‚æ•°\texttt{true}ï¼Œç»™å‡ºå½“æ¡ä»¶ä¸ºçœŸæ—¶çš„è¾“å‡ºï¼›ç¬¬ä¸‰ä¸ªå‚æ•°\texttt{false}ï¼Œç»™å‡ºå½“æ¡ä»¶ä¸ºå‡æ—¶çš„è¾“å‡ºã€‚

è®©æˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­å¼€å§‹ï¼Œå°†ä¸€ä¸ªæ•°å€¼å‘é‡æ ‡è®°ä¸º``+ve''ï¼ˆæ­£ï¼‰æˆ–``-ve''ï¼ˆè´Ÿï¼‰ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{3}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\ConstantTok{NA}\NormalTok{)}
\FunctionTok{if\_else}\NormalTok{(x }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{, }\StringTok{"+ve"}\NormalTok{, }\StringTok{"{-}ve"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "{-}ve" "{-}ve" "{-}ve" "{-}ve" "+ve" "+ve" "+ve" NA}
\end{Highlighting}
\end{Shaded}

There's an optional fourth argument, \texttt{missing} which will be used
if the input is \texttt{NA}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{if\_else}\NormalTok{(x }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{, }\StringTok{"+ve"}\NormalTok{, }\StringTok{"{-}ve"}\NormalTok{, }\StringTok{"???"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "{-}ve" "{-}ve" "{-}ve" "{-}ve" "+ve" "+ve" "+ve" "???"}
\end{Highlighting}
\end{Shaded}

ä½ è¿˜å¯ä»¥ä½¿ç”¨å‘é‡ä½œä¸º\texttt{true}å’Œ\texttt{false}å‚æ•°ã€‚ä¾‹
å¦‚ï¼Œè¿™å…è®¸æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª\texttt{abs()}å‡½æ•°çš„ç®€åŒ–å®ç°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{if\_else}\NormalTok{(x }\SpecialCharTok{\textless{}} \DecValTok{0}\NormalTok{, }\SpecialCharTok{{-}}\NormalTok{x, x)}
\CommentTok{\#\textgreater{} [1]  3  2  1  0  1  2  3 NA}
\end{Highlighting}
\end{Shaded}

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‰€æœ‰çš„å‚æ•°éƒ½ä½¿ç”¨äº†ç›¸åŒçš„å‘é‡ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ··åˆå’ŒåŒ¹é…ã€‚ä¾‹
å¦‚ï¼Œä½ å¯ä»¥åƒè¿™æ ·å®ç°\texttt{coalesce()}å‡½æ•°çš„ç®€å•ç‰ˆæœ¬ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x1 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\ConstantTok{NA}\NormalTok{)}
\NormalTok{y1 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{6}\NormalTok{)}
\FunctionTok{if\_else}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(x1), y1, x1)}
\CommentTok{\#\textgreater{} [1] 3 1 2 6}
\end{Highlighting}
\end{Shaded}

ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°æˆ‘ä»¬ä¸Šé¢æ ‡è®°ç¤ºä¾‹ä¸­çš„ä¸€ä¸ªå°ç‘•ç–µï¼šé›¶æ—¢ä¸æ˜¯æ­£æ•°ä¹Ÿä¸æ˜¯è´Ÿæ•°ã€‚æˆ‘
ä»¬å¯ä»¥é€šè¿‡æ·»åŠ å¦ä¸€ä¸ª\texttt{if\_else()}æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{if\_else}\NormalTok{(x }\SpecialCharTok{==} \DecValTok{0}\NormalTok{, }\StringTok{"0"}\NormalTok{, }\FunctionTok{if\_else}\NormalTok{(x }\SpecialCharTok{\textless{}} \DecValTok{0}\NormalTok{, }\StringTok{"{-}ve"}\NormalTok{, }\StringTok{"+ve"}\NormalTok{), }\StringTok{"???"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "{-}ve" "{-}ve" "{-}ve" "0"   "+ve" "+ve" "+ve" "???"}
\end{Highlighting}
\end{Shaded}

è¿™å·²ç»æœ‰ç‚¹éš¾ä»¥é˜…è¯»äº†ï¼Œä½ å¯ä»¥æƒ³è±¡å¦‚æœæœ‰æ›´å¤šçš„æ¡ä»¶ï¼Œå®ƒåªä¼šå˜å¾—æ›´éš¾ã€‚ç›¸
åï¼Œä½ å¯ä»¥åˆ‡æ¢åˆ°\texttt{dplyr::case\_when()}ã€‚

\subsection{\texorpdfstring{\texttt{case\_when()}}{case\_when()}}\label{case_when}

dplyrçš„\texttt{case\_when()}æ˜¯å—SQLçš„\texttt{CASE}è¯­å¥å¯å‘ï¼Œä¸ºä¸åŒæ¡ä»¶æ‰§è¡Œä¸åŒè®¡ç®—æä¾›äº†çµæ´»çš„æ–¹æ³•ã€‚å®ƒ
æœ‰ä¸€ä¸ªç‰¹æ®Šçš„è¯­æ³•ï¼Œä¸è¿‡è¿™ä¸ªè¯­æ³•çœ‹èµ·æ¥ä¸tidyverseä¸­å°†è¦ä½¿ç”¨çš„ä»»ä½•å…¶ä»–å†…å®¹éƒ½ä¸ç›¸ä¼¼ã€‚å®ƒ
æ¥å—å½¢å¦‚\texttt{condition\ \textasciitilde{}\ output}çš„ç»„åˆï¼Œ\texttt{condition}å¿…é¡»æ˜¯ä¸€ä¸ªé€»è¾‘å‘é‡ï¼Œå½“å®ƒä¸ºTRUEæ—¶ï¼Œå°†ä½¿ç”¨\texttt{output}ã€‚

è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å°†ä¹‹å‰åµŒå¥—çš„\texttt{if\_else()}é‡æ–°åˆ›å»ºå¦‚ä¸‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{3}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\ConstantTok{NA}\NormalTok{)}
\FunctionTok{case\_when}\NormalTok{(}
\NormalTok{  x }\SpecialCharTok{==} \DecValTok{0}   \SpecialCharTok{\textasciitilde{}} \StringTok{"0"}\NormalTok{,}
\NormalTok{  x }\SpecialCharTok{\textless{}} \DecValTok{0}    \SpecialCharTok{\textasciitilde{}} \StringTok{"{-}ve"}\NormalTok{, }
\NormalTok{  x }\SpecialCharTok{\textgreater{}} \DecValTok{0}    \SpecialCharTok{\textasciitilde{}} \StringTok{"+ve"}\NormalTok{,}
  \FunctionTok{is.na}\NormalTok{(x) }\SpecialCharTok{\textasciitilde{}} \StringTok{"???"}
\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "{-}ve" "{-}ve" "{-}ve" "0"   "+ve" "+ve" "+ve" "???"}
\end{Highlighting}
\end{Shaded}

è™½ç„¶ä»£ç æ›´å¤šï¼Œä½†å®ƒä¹Ÿæ›´æ¸…æ™°ã€‚

ä¸ºäº†è§£é‡Š\texttt{case\_when()}æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè®©æˆ‘ä»¬æ¢ç´¢ä¸€äº›æ›´ç®€å•çš„æ¡ˆä¾‹ã€‚å¦‚
æœæ²¡æœ‰ä»»ä½•æƒ…å†µåŒ¹é…ï¼Œåˆ™è¾“å‡ºä¸ºNAï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{case\_when}\NormalTok{(}
\NormalTok{  x }\SpecialCharTok{\textless{}} \DecValTok{0} \SpecialCharTok{\textasciitilde{}} \StringTok{"{-}ve"}\NormalTok{,}
\NormalTok{  x }\SpecialCharTok{\textgreater{}} \DecValTok{0} \SpecialCharTok{\textasciitilde{}} \StringTok{"+ve"}
\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "{-}ve" "{-}ve" "{-}ve" NA    "+ve" "+ve" "+ve" NA}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ æƒ³ä¸ºæœªåŒ¹é…åˆ°ä»»ä½•æ¡ä»¶çš„æƒ…å†µè®¾ç½®ä¸€ä¸ª``é»˜è®¤''çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨\texttt{.default}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{case\_when}\NormalTok{(}
\NormalTok{  x }\SpecialCharTok{\textless{}} \DecValTok{0} \SpecialCharTok{\textasciitilde{}} \StringTok{"{-}ve"}\NormalTok{,}
\NormalTok{  x }\SpecialCharTok{\textgreater{}} \DecValTok{0} \SpecialCharTok{\textasciitilde{}} \StringTok{"+ve"}\NormalTok{,}
  \AttributeTok{.default =} \StringTok{"???"}
\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "{-}ve" "{-}ve" "{-}ve" "???" "+ve" "+ve" "+ve" "???"}
\end{Highlighting}
\end{Shaded}

æ³¨æ„ï¼Œå¦‚æœå¤šä¸ªæ¡ä»¶åŒ¹é…ï¼Œåªä¼šä½¿ç”¨ç¬¬ä¸€ä¸ªæ¡ä»¶:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{case\_when}\NormalTok{(}
\NormalTok{  x }\SpecialCharTok{\textgreater{}} \DecValTok{0} \SpecialCharTok{\textasciitilde{}} \StringTok{"+ve"}\NormalTok{,}
\NormalTok{  x }\SpecialCharTok{\textgreater{}} \DecValTok{2} \SpecialCharTok{\textasciitilde{}} \StringTok{"big"}
\NormalTok{)}
\CommentTok{\#\textgreater{} [1] NA    NA    NA    NA    "+ve" "+ve" "+ve" NA}
\end{Highlighting}
\end{Shaded}

å°±åƒä½¿ç”¨\texttt{if\_else()}ä¸€æ ·ï¼Œä½ å¯ä»¥åœ¨\texttt{\textasciitilde{}}çš„ä¸¤è¾¹ä½¿ç”¨å˜é‡ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®éœ€è¦æ··åˆå’ŒåŒ¹é…å˜é‡æ¥è§£å†³ä½ çš„é—®é¢˜ã€‚ä¾‹
å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{case\_when()}ä¸ºåˆ°è¾¾å»¶è¯¯æä¾›ä¸€äº›äººä»¬å¯è¯»çš„æ ‡ç­¾ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{status =} \FunctionTok{case\_when}\NormalTok{(}
      \FunctionTok{is.na}\NormalTok{(arr\_delay)      }\SpecialCharTok{\textasciitilde{}} \StringTok{"cancelled"}\NormalTok{,}
\NormalTok{      arr\_delay }\SpecialCharTok{\textless{}} \SpecialCharTok{{-}}\DecValTok{30}       \SpecialCharTok{\textasciitilde{}} \StringTok{"very early"}\NormalTok{,}
\NormalTok{      arr\_delay }\SpecialCharTok{\textless{}} \SpecialCharTok{{-}}\DecValTok{15}       \SpecialCharTok{\textasciitilde{}} \StringTok{"early"}\NormalTok{,}
      \FunctionTok{abs}\NormalTok{(arr\_delay) }\SpecialCharTok{\textless{}=} \DecValTok{15}  \SpecialCharTok{\textasciitilde{}} \StringTok{"on time"}\NormalTok{,}
\NormalTok{      arr\_delay }\SpecialCharTok{\textless{}} \DecValTok{60}        \SpecialCharTok{\textasciitilde{}} \StringTok{"late"}\NormalTok{,}
\NormalTok{      arr\_delay }\SpecialCharTok{\textless{}} \ConstantTok{Inf}       \SpecialCharTok{\textasciitilde{}} \StringTok{"very late"}\NormalTok{,}
\NormalTok{    ),}
    \AttributeTok{.keep =} \StringTok{"used"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 2}
\CommentTok{\#\textgreater{}   arr\_delay status }
\CommentTok{\#\textgreater{}       \textless{}dbl\textgreater{} \textless{}chr\textgreater{}  }
\CommentTok{\#\textgreater{} 1        11 on time}
\CommentTok{\#\textgreater{} 2        20 late   }
\CommentTok{\#\textgreater{} 3        33 late   }
\CommentTok{\#\textgreater{} 4       {-}18 early  }
\CommentTok{\#\textgreater{} 5       {-}25 early  }
\CommentTok{\#\textgreater{} 6        12 on time}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\end{Highlighting}
\end{Shaded}

åœ¨ç¼–å†™è¿™ç§å¤æ‚çš„\texttt{case\_when()}è¯­å¥æ—¶è¦å°å¿ƒï¼›æˆ‘æœ€åˆçš„ä¸¤æ¬¡å°è¯•æ··åˆä½¿ç”¨äº†\texttt{\textless{}}å’Œ\texttt{\textgreater{}}ï¼Œç»“æœä¸å°å¿ƒåˆ›å»ºäº†é‡å çš„æ¡ä»¶ã€‚

\subsection{å…¼å®¹ç±»å‹ï¼ˆcompatible
typesï¼‰}\label{ux517cux5bb9ux7c7bux578bcompatible-types}

è¯·æ³¨æ„ï¼Œ\texttt{if\_else()}å’Œ\texttt{case\_when()}éƒ½è¦æ±‚è¾“å‡ºå…·æœ‰å…¼å®¹çš„ç±»å‹ã€‚å¦‚
æœå®ƒä»¬ä¸å…¼å®¹ï¼Œä½ ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„é”™è¯¯ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{if\_else}\NormalTok{(}\ConstantTok{TRUE}\NormalTok{, }\StringTok{"a"}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} Error in \textasciigrave{}if\_else()\textasciigrave{}:}
\CommentTok{\#\textgreater{} ! Can\textquotesingle{}t combine \textasciigrave{}true\textasciigrave{} \textless{}character\textgreater{} and \textasciigrave{}false\textasciigrave{} \textless{}double\textgreater{}.}

\FunctionTok{case\_when}\NormalTok{(}
\NormalTok{  x }\SpecialCharTok{\textless{}} \SpecialCharTok{{-}}\DecValTok{1} \SpecialCharTok{\textasciitilde{}} \ConstantTok{TRUE}\NormalTok{,  }
\NormalTok{  x }\SpecialCharTok{\textgreater{}} \DecValTok{0}  \SpecialCharTok{\textasciitilde{}} \FunctionTok{now}\NormalTok{()}
\NormalTok{)}
\CommentTok{\#\textgreater{} Error in \textasciigrave{}case\_when()\textasciigrave{}:}
\CommentTok{\#\textgreater{} ! Can\textquotesingle{}t combine \textasciigrave{}..1 (right)\textasciigrave{} \textless{}logical\textgreater{} and \textasciigrave{}..2 (right)\textasciigrave{} \textless{}datetime\textless{}local\textgreater{}\textgreater{}.}
\end{Highlighting}
\end{Shaded}

æ€»ä½“æ¥è¯´ï¼Œå…¼å®¹çš„ç±»å‹æ˜¯ç›¸å¯¹è¾ƒå°‘çš„ï¼Œå› ä¸ºè‡ªåŠ¨å°†ä¸€ä¸ªç±»å‹çš„å‘é‡è½¬æ¢ä¸ºå¦ä¸€ä¸ªç±»å‹çš„å‘é‡æ˜¯å¸¸è§çš„é”™è¯¯æ¥æºã€‚ä»¥
ä¸‹æ˜¯ä¸€äº›æœ€é‡è¦çš„å…¼å®¹æƒ…å†µï¼š

\begin{itemize}
\tightlist
\item
  æ•°å­—å’Œé€»è¾‘å‘é‡æ˜¯å…¼å®¹çš„ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨@sec-numeric-summaries-of-logicals
  è®¨è®ºçš„é‚£æ ·ã€‚
\item
  å­—ç¬¦ä¸²å’Œå› å­ï¼ˆç« èŠ‚~\ref{sec-factors}ï¼‰
  æ˜¯å…¼å®¹çš„ï¼Œå› ä¸ºå¯ä»¥å°†å› å­è§†ä¸ºä¸€ç»„å…·æœ‰å›ºå®šå€¼çš„å­—ç¬¦ä¸²ã€‚
\item
  æ—¥æœŸå’Œæ—¥æœŸ-æ—¶é—´ï¼Œæˆ‘ä»¬å°†åœ¨ ç« èŠ‚~\ref{sec-dates-and-times}
  éƒ¨åˆ†è®¨è®ºï¼Œå®ƒä»¬æ˜¯å…¼å®¹çš„ï¼Œå› ä¸ºä½ å¯ä»¥å°†æ—¥æœŸè§†ä¸ºæ—¥æœŸ-æ—¶é—´çš„ä¸€ä¸ªç‰¹ä¾‹ã€‚
\item
  \texttt{NA},
  ä»æŠ€æœ¯ä¸Šè®²æ˜¯é€»è¾‘å‘é‡ï¼Œä¸æ‰€æœ‰ç±»å‹éƒ½å…¼å®¹ï¼Œå› ä¸ºæ¯ä¸ªå‘é‡éƒ½æœ‰è¡¨ç¤ºç¼ºå¤±å€¼çš„æ–¹å¼ã€‚
\end{itemize}

æˆ‘ä»¬ä¸è¦æ±‚ä½ è®°ä½è¿™äº›è§„åˆ™ï¼Œä½†éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå®ƒä»¬åº”è¯¥å˜å¾—è‡ªç„¶è€Œç„¶ï¼Œå› ä¸ºå®ƒä»¬åœ¨æ•´ä¸ªtidyverseä¸­éƒ½è¢«ä¸€è‡´åœ°åº”ç”¨ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-31}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  å¦‚æœä¸€ä¸ªæ•°èƒ½è¢«2æ•´é™¤ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯å¶æ•°ã€‚åœ¨
  Rä¸­ï¼Œä½ å¯ä»¥é€šè¿‡\texttt{x\ \%\%\ 2\ ==\ 0}æ¥åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦ä¸ºå¶æ•°ã€‚åˆ©
  ç”¨è¿™ä¸ªäº‹å®å’Œ\texttt{if\_else()}å‡½æ•°æ¥ç¡®å®š0åˆ°20ä¹‹é—´çš„æ¯ä¸ªæ•°æ˜¯å¶æ•°è¿˜æ˜¯å¥‡æ•°ã€‚
\item
  ç»™å®šä¸€ä¸ªå¤©æ•°å‘é‡ï¼Œå¦‚\texttt{x\ \textless{}-\ c("Monday",\ "Saturday",\ "Wednesday")}ï¼Œä½¿ç”¨\texttt{if\_else()}è¯­å¥å°†å®ƒä»¬æ ‡è®°ä¸ºå‘¨æœ«æˆ–å·¥ä½œæ—¥ã€‚
\item
  ä½¿ç”¨\texttt{if\_else()}å‡½æ•°è®¡ç®—ä¸€ä¸ªåä¸º\texttt{x}çš„æ•°å€¼å‘é‡çš„ç»å¯¹å€¼ã€‚
\item
  ç¼–å†™ä¸€ä¸ª\texttt{case\_when()}è¯­å¥ï¼Œåˆ©ç”¨\texttt{flights}æ•°æ®é›†ä¸­çš„\texttt{month}å’Œ\texttt{day}åˆ—æ¥æ ‡è®°ä¸€äº›é‡è¦çš„ç¾å›½èŠ‚å‡æ—¥ï¼ˆä¾‹å¦‚ï¼Œæ–°å¹´ã€7æœˆ4æ—¥ã€æ„Ÿæ©èŠ‚å’Œåœ£è¯èŠ‚ï¼‰ã€‚é¦–
  å…ˆåˆ›å»ºä¸€ä¸ªé€»è¾‘åˆ—ï¼Œå…¶å€¼ä¸º\texttt{TRUE}æˆ–\texttt{FALSE}ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªå­—ç¬¦åˆ—ï¼Œè¯¥åˆ—è¦ä¹ˆç»™å‡ºèŠ‚å‡æ—¥çš„åç§°ï¼Œè¦ä¹ˆæ˜¯NAã€‚
\end{enumerate}

\section{å°ç»“}\label{ux5c0fux7ed3-11}

é€»è¾‘å‘é‡çš„å®šä¹‰å¾ˆç®€å•ï¼Œå› ä¸ºæ¯ä¸ªå€¼éƒ½å¿…é¡»æ˜¯\texttt{TRUE}ã€\texttt{FALSE}æˆ–\texttt{NA}ã€‚ä½†
é€»è¾‘å‘é‡æä¾›äº†å·¨å¤§çš„åŠŸèƒ½ã€‚åœ¨
æœ¬ç« ä¸­ï¼Œä½ å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨\texttt{\textgreater{}}ã€\texttt{\textless{}}ã€\texttt{\textless{}=}ã€\texttt{\textgreater{}=}ã€\texttt{==}ã€\texttt{!=}å’Œ\texttt{is.na()}åˆ›å»ºé€»è¾‘å‘é‡ï¼Œå¦‚ä½•ä½¿ç”¨\texttt{!}ã€\texttt{\&}å’Œ\texttt{\textbar{}}ç»„åˆå®ƒä»¬ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨\texttt{any()}ã€\texttt{all()}ã€\texttt{sum()}å’Œ\texttt{mean()}å¯¹å®ƒä»¬è¿›è¡Œæ±‡æ€»ã€‚ä½ 
è¿˜å­¦ä¹ äº†å¼ºå¤§çš„\texttt{if\_else()}å’Œ\texttt{case\_when()}å‡½æ•°ï¼Œè¿™äº›å‡½æ•°å…è®¸ä½ æ ¹æ®é€»è¾‘å‘é‡çš„å€¼è¿”å›å€¼ã€‚

åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä¸€æ¬¡åˆä¸€æ¬¡åœ°çœ‹åˆ°é€»è¾‘å‘é‡ã€‚ä¾‹ å¦‚ï¼Œåœ¨@sec-strings
ï¼Œä½ å°†å­¦ä¹ \texttt{str\_detect(x,\ pattern)}ï¼Œå®ƒè¿”å›ä¸€ä¸ªé€»è¾‘å‘é‡ï¼Œå¯¹äºxä¸­åŒ¹é…æ¨¡å¼çš„å…ƒç´ ï¼Œè¯¥å‘é‡çš„å€¼ä¸º\texttt{TRUE}ï¼›åœ¨@sec-dates-and-times
ï¼Œä½ å°†é€šè¿‡æ¯”è¾ƒæ—¥æœŸå’Œæ—¶é—´æ¥åˆ›å»ºé€»è¾‘å‘é‡ã€‚ä½†
ç°åœ¨ï¼Œæˆ‘ä»¬å°†è½¬å‘ä¸‹ä¸€ä¸ªæœ€é‡è¦çš„å‘é‡ç±»å‹ï¼šæ•°å€¼å‘é‡ã€‚

\chapter{æ•°å€¼}\label{sec-numbers}

\section{å¼•è¨€}\label{ux5f15ux8a00-8}

æ•°å€¼å‘é‡æ˜¯æ•°æ®ç§‘å­¦çš„åŸºçŸ³ï¼Œä½ åœ¨æœ¬ä¹¦çš„å‰é¢éƒ¨åˆ†å·²ç»å¤šæ¬¡ä½¿ç”¨è¿‡å®ƒä»¬ã€‚ç°
åœ¨æ˜¯ç³»ç»Ÿåœ°å®¡è§†ä½ åœ¨Rä¸­å¯ä»¥å¯¹å®ƒä»¬åšä»€ä¹ˆçš„æ—¶å€™äº†ï¼Œç¡®ä¿ä½ èƒ½å¤Ÿå¾ˆå¥½åœ°åº”å¯¹ä»»ä½•æ¶‰åŠæ•°å€¼å‘é‡çš„æœªæ¥é—®é¢˜ã€‚

æˆ‘ä»¬å°†é¦–å…ˆä¸ºä½ æä¾›å‡ ä¸ªå·¥å…·ï¼Œä»¥ä¾¿åœ¨ä½ æœ‰å­—ç¬¦ä¸²æ—¶ç”Ÿæˆæ•°å­—ï¼Œç„¶åæ›´è¯¦ç»†åœ°ä»‹ç»\texttt{count()}å‡½æ•°ã€‚ç„¶
åï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ä¸\texttt{mutate()}æ­é…ä½¿ç”¨çš„å„ç§æ•°å€¼è½¬æ¢ï¼ŒåŒ…æ‹¬å¯ä»¥åº”ç”¨äºå…¶ä»–ç±»å‹å‘é‡çš„æ›´ä¸€èˆ¬çš„è½¬æ¢ï¼Œä½†é€šå¸¸ä¸æ•°å€¼å‘é‡ä¸€èµ·ä½¿ç”¨ã€‚æœ€
åï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸\texttt{summarize()}æ­é…ä½¿ç”¨çš„æ±‡æ€»å‡½æ•°ï¼Œå¹¶å‘ä½ å±•ç¤ºå®ƒä»¬ä¹Ÿå¯ä»¥ä¸\texttt{mutate()}ä¸€èµ·ä½¿ç”¨ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-8}

æœ¬ç« ä¸»è¦ä½¿ç”¨æ¥è‡ªåŸºç¡€Rçš„å‡½æ•°ï¼Œè¿™äº›å‡½æ•°æ— éœ€åŠ è½½ä»»ä½•åŒ…å³å¯ä½¿ç”¨ã€‚ä½†
æˆ‘ä»¬ä»ç„¶éœ€è¦tidyverseï¼Œå› ä¸ºæˆ‘ä»¬å°†åœ¨tidyverseçš„å‡½æ•°ï¼ˆå¦‚\texttt{mutate()}å’Œ\texttt{filter()}ï¼‰å†…éƒ¨ä½¿ç”¨è¿™äº›åŸºç¡€Rå‡½æ•°ã€‚å’Œ
ä¸Šä¸€ç« ä¸€æ ·ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨\texttt{nycflights13}æ•°æ®é›†çš„çœŸå®ç¤ºä¾‹ï¼Œä»¥åŠä½¿ç”¨\texttt{c()}å’Œ\texttt{tribble()}åˆ›å»ºçš„ç©å…·ç¤ºä¾‹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(nycflights13)}
\end{Highlighting}
\end{Shaded}

\section{æ•°å­—åŒ–}\label{ux6570ux5b57ux5316}

åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ ä¼šè·å¾—Rçš„æ•°å­—ç±»å‹ä¹‹ä¸€çš„æ•´æ•°æˆ–åŒç²¾åº¦æ•°å­—ã€‚ç„¶
è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ä½ å¯èƒ½ä¼šé‡åˆ°ä»¥å­—ç¬¦ä¸²å½¢å¼å‡ºç°çš„æ•°å­—ï¼Œå¯èƒ½æ˜¯å› ä¸ºä»åˆ—æ ‡é¢˜ä¸­è½¬æ¢å¾—åˆ°å®ƒä»¬ï¼Œæˆ–è€…æ˜¯å› ä¸ºåœ¨æ•°æ®å¯¼å…¥è¿‡ç¨‹ä¸­å‡ºç°äº†æŸäº›é—®é¢˜ã€‚

\texttt{readr}åŒ…æä¾›äº†ä¸¤ä¸ªæœ‰ç”¨çš„å‡½æ•°æ¥å°†å­—ç¬¦ä¸²è§£æä¸ºæ•°å­—ï¼š\texttt{parse\_double()}å’Œ\texttt{parse\_number()}ã€‚å½“
ä½ é‡åˆ°ä»¥å­—ç¬¦ä¸²å½¢å¼å†™å…¥çš„æ•°å­—æ—¶ï¼Œå¯ä»¥ä½¿ç”¨\texttt{parse\_double()}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"1.2"}\NormalTok{, }\StringTok{"5.6"}\NormalTok{, }\StringTok{"1e3"}\NormalTok{)}
\FunctionTok{parse\_double}\NormalTok{(x)}
\CommentTok{\#\textgreater{} [1]    1.2    5.6 1000.0}
\end{Highlighting}
\end{Shaded}

å½“å­—ç¬¦ä¸²ä¸­åŒ…å«ä½ æƒ³è¦å¿½ç•¥çš„éæ•°å­—æ–‡æœ¬æ—¶ï¼Œä½¿ç”¨\texttt{parse\_number()}ã€‚è¿™
å¯¹äºè´§å¸æ•°æ®å’Œç™¾åˆ†æ¯”ç‰¹åˆ«æœ‰ç”¨ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"$1,234"}\NormalTok{, }\StringTok{"USD 3,513"}\NormalTok{, }\StringTok{"59\%"}\NormalTok{)}
\FunctionTok{parse\_number}\NormalTok{(x)}
\CommentTok{\#\textgreater{} [1] 1234 3513   59}
\end{Highlighting}
\end{Shaded}

\section{è®¡æ•°}\label{sec-counts}

ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œä»…ä»…é€šè¿‡è®¡æ•°å’Œä¸€äº›åŸºæœ¬çš„ç®—æœ¯è¿ç®—ä½ å°±èƒ½å¤Ÿå®Œæˆä¸å°‘æ•°æ®ç§‘å­¦å·¥ä½œï¼Œå› æ­¤\texttt{dplyr}è‡´åŠ›äºé€šè¿‡\texttt{count()}å‡½æ•°ä½¿è®¡æ•°å°½å¯èƒ½ç®€å•ã€‚è¿™
ä¸ªå‡½æ•°éå¸¸é€‚åˆåœ¨åˆ†æè¿‡ç¨‹ä¸­è¿›è¡Œå¿«é€Ÿæ¢ç´¢å’Œæ£€æŸ¥ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} \FunctionTok{count}\NormalTok{(dest)}
\CommentTok{\#\textgreater{} \# A tibble: 105 x 2}
\CommentTok{\#\textgreater{}   dest      n}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 ABQ     254}
\CommentTok{\#\textgreater{} 2 ACK     265}
\CommentTok{\#\textgreater{} 3 ALB     439}
\CommentTok{\#\textgreater{} 4 ANC       8}
\CommentTok{\#\textgreater{} 5 ATL   17215}
\CommentTok{\#\textgreater{} 6 AUS    2439}
\CommentTok{\#\textgreater{} \# i 99 more rows}
\end{Highlighting}
\end{Shaded}

å°½ç®¡åœ¨ ç« èŠ‚~\ref{sec-workflow-style}
ç»™å‡ºäº†å»ºè®®ï¼Œä½†æˆ‘ä»¬é€šå¸¸è¿˜æ˜¯å°†\texttt{count()}æ”¾åœ¨å•ç‹¬çš„ä¸€è¡Œï¼Œå› ä¸ºå®ƒé€šå¸¸åœ¨æ§åˆ¶å°ä¸­ç”¨äºå¿«é€Ÿæ£€æŸ¥è®¡ç®—æ˜¯å¦æŒ‰é¢„æœŸå·¥ä½œã€‚

å¦‚æœä½ æƒ³çœ‹åˆ°æœ€å¸¸è§çš„å€¼ï¼Œæ·»åŠ  \texttt{sort\ =\ TRUE}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} \FunctionTok{count}\NormalTok{(dest, }\AttributeTok{sort =} \ConstantTok{TRUE}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 105 x 2}
\CommentTok{\#\textgreater{}   dest      n}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 ORD   17283}
\CommentTok{\#\textgreater{} 2 ATL   17215}
\CommentTok{\#\textgreater{} 3 LAX   16174}
\CommentTok{\#\textgreater{} 4 BOS   15508}
\CommentTok{\#\textgreater{} 5 MCO   14082}
\CommentTok{\#\textgreater{} 6 CLT   14064}
\CommentTok{\#\textgreater{} \# i 99 more rows}
\end{Highlighting}
\end{Shaded}

è¯·è®°ä½ï¼Œå¦‚æœå¸Œæœ›æŸ¥çœ‹æ‰€æœ‰å€¼ï¼Œå¯ä»¥ä½¿ç”¨\texttt{\textbar{}\textgreater{}\ View()}æˆ–\texttt{\textbar{}\textgreater{}\ print(n\ =\ Inf)}ã€‚

ä½ å¯ä»¥é€šè¿‡\texttt{group\_by()}ã€\texttt{summarize()}å’Œ\texttt{n()}``æ‰‹åŠ¨''æ‰§è¡Œç›¸åŒçš„è®¡ç®—ã€‚è¿™
æ˜¯æœ‰ç”¨çš„ï¼Œå› ä¸ºå®ƒå…è®¸ä½ åŒæ—¶è®¡ç®—å…¶ä»–æ±‡æ€»ç»Ÿè®¡é‡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(dest) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{delay =} \FunctionTok{mean}\NormalTok{(arr\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 105 x 3}
\CommentTok{\#\textgreater{}   dest      n delay}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}int\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 ABQ     254  4.38}
\CommentTok{\#\textgreater{} 2 ACK     265  4.85}
\CommentTok{\#\textgreater{} 3 ALB     439 14.4 }
\CommentTok{\#\textgreater{} 4 ANC       8 {-}2.5 }
\CommentTok{\#\textgreater{} 5 ATL   17215 11.3 }
\CommentTok{\#\textgreater{} 6 AUS    2439  6.02}
\CommentTok{\#\textgreater{} \# i 99 more rows}
\end{Highlighting}
\end{Shaded}

\texttt{n()}æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ±‡æ€»å‡½æ•°ï¼Œå®ƒä¸æ¥å—ä»»ä½•å‚æ•°ï¼Œè€Œæ˜¯è®¿é—®å…³äº``å½“å‰''ç»„çš„ä¿¡æ¯ã€‚è¿™
æ„å‘³ç€å®ƒåªèƒ½åœ¨\texttt{dplyr}çš„å‡½æ•°å†…éƒ¨ä½¿ç”¨ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{n}\NormalTok{()}
\CommentTok{\#\textgreater{} Error in \textasciigrave{}n()\textasciigrave{}:}
\CommentTok{\#\textgreater{} ! Must only be used inside data{-}masking verbs like \textasciigrave{}mutate()\textasciigrave{},}
\CommentTok{\#\textgreater{}   \textasciigrave{}filter()\textasciigrave{}, and \textasciigrave{}group\_by()\textasciigrave{}.}
\end{Highlighting}
\end{Shaded}

\texttt{n()}å’Œ\texttt{count()}æœ‰å‡ ä¸ªå˜ä½“ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—å®ƒä»¬æœ‰ç”¨ï¼š

\begin{itemize}
\item
  \texttt{n\_distinct(x)}è®¡ç®—ä¸€ä¸ªæˆ–å¤šä¸ªå˜é‡çš„ä¸åŒï¼ˆå”¯ä¸€ï¼‰å€¼çš„æ•°é‡ã€‚ä¾‹
  å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾å‡ºå“ªäº›ç›®çš„åœ°æœ‰æœ€å¤šçš„èˆªç©ºå…¬å¸æä¾›æœåŠ¡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(dest) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{carriers =} \FunctionTok{n\_distinct}\NormalTok{(carrier)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(carriers))}
\CommentTok{\#\textgreater{} \# A tibble: 105 x 2}
\CommentTok{\#\textgreater{}   dest  carriers}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}    \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 ATL          7}
\CommentTok{\#\textgreater{} 2 BOS          7}
\CommentTok{\#\textgreater{} 3 CLT          7}
\CommentTok{\#\textgreater{} 4 ORD          7}
\CommentTok{\#\textgreater{} 5 TPA          7}
\CommentTok{\#\textgreater{} 6 AUS          6}
\CommentTok{\#\textgreater{} \# i 99 more rows}
\end{Highlighting}
\end{Shaded}
\item
  åŠ æƒè®¡æ•°æ˜¯æ±‚å’Œã€‚ä¾‹ å¦‚ä½ å¯ä»¥``è®¡æ•°''æ¯æ¶é£æœºé£è¡Œçš„è‹±é‡Œæ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(tailnum) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{miles =} \FunctionTok{sum}\NormalTok{(distance))}
\CommentTok{\#\textgreater{} \# A tibble: 4,044 x 2}
\CommentTok{\#\textgreater{}   tailnum  miles}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}    \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 D942DN    3418}
\CommentTok{\#\textgreater{} 2 N0EGMQ  250866}
\CommentTok{\#\textgreater{} 3 N10156  115966}
\CommentTok{\#\textgreater{} 4 N102UW   25722}
\CommentTok{\#\textgreater{} 5 N103US   24619}
\CommentTok{\#\textgreater{} 6 N104UW   25157}
\CommentTok{\#\textgreater{} \# i 4,038 more rows}
\end{Highlighting}
\end{Shaded}

  åŠ æƒè®¡æ•°æ˜¯ä¸€ä¸ªå¸¸è§çš„é—®é¢˜ï¼Œæ‰€ä»¥\texttt{count()}å‡½æ•°æœ‰ä¸€ä¸ª\texttt{wt}å‚æ•°æ¥å®ç°åŒæ ·çš„åŠŸèƒ½ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} \FunctionTok{count}\NormalTok{(tailnum, }\AttributeTok{wt =}\NormalTok{ distance)}
\end{Highlighting}
\end{Shaded}
\item
  å¯ä»¥é€šè¿‡ç»“åˆ\texttt{sum()}å’Œ\texttt{is.na()}æ¥è®¡æ•°ç¼ºå¤±å€¼ã€‚åœ¨
  \texttt{flights}æ•°æ®é›†ä¸­ï¼Œè¿™è¡¨ç¤ºè¢«å–æ¶ˆçš„èˆªç­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(dest) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{n\_cancelled =} \FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(dep\_time))) }
\CommentTok{\#\textgreater{} \# A tibble: 105 x 2}
\CommentTok{\#\textgreater{}   dest  n\_cancelled}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}       \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 ABQ             0}
\CommentTok{\#\textgreater{} 2 ACK             0}
\CommentTok{\#\textgreater{} 3 ALB            20}
\CommentTok{\#\textgreater{} 4 ANC             0}
\CommentTok{\#\textgreater{} 5 ATL           317}
\CommentTok{\#\textgreater{} 6 AUS            21}
\CommentTok{\#\textgreater{} \# i 99 more rows}
\end{Highlighting}
\end{Shaded}
\end{itemize}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-32}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  å¦‚ä½•ä½¿ç”¨\texttt{count()}æ¥è®¡ç®—ç»™å®šå˜é‡ä¸­ç¼ºå¤±å€¼çš„è¡Œæ•°ï¼Ÿ
\item
  å°†ä»¥ä¸‹å¯¹\texttt{count()}çš„è°ƒç”¨æ‰©å±•ä¸ºä½¿ç”¨\texttt{group\_by()}ã€\texttt{summarize()}å’Œ\texttt{arrange()}:

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \item
    \texttt{flights\ \textbar{}\textgreater{}\ count(dest,\ sort\ =\ TRUE)}
  \item
    \texttt{flights\ \textbar{}\textgreater{}\ count(tailnum,\ wt\ =\ distance)}
  \end{enumerate}
\end{enumerate}

\section{æ•°å€¼è½¬æ¢}\label{ux6570ux503cux8f6cux6362}

è½¬æ¢å‡½æ•°ä¸\texttt{mutate()}é…åˆå¾—å¾ˆå¥½ï¼Œå› ä¸ºå®ƒä»¬çš„è¾“å‡ºé•¿åº¦ä¸è¾“å…¥ç›¸åŒã€‚ç»
å¤§å¤šæ•°è½¬æ¢å‡½æ•°å·²ç»å†…ç½®åœ¨Rçš„åŸºæœ¬åŒ…ä¸­ã€‚åˆ—
å‡ºæ‰€æœ‰å‡½æ•°æ˜¯ä¸åˆ‡å®é™…çš„ï¼Œæ‰€ä»¥æœ¬èŠ‚å°†å±•ç¤ºä¸€äº›æœ€æœ‰ç”¨çš„ã€‚ä¾‹
å¦‚ï¼Œè™½ç„¶Ræä¾›äº†ä½ å¯èƒ½æ¢¦å¯ä»¥æ±‚çš„æ‰€æœ‰ä¸‰è§’å‡½æ•°ï¼Œä½†æˆ‘ä»¬åœ¨è¿™é‡Œæ²¡æœ‰åˆ—å‡ºå®ƒä»¬ï¼Œå› ä¸ºå®ƒä»¬åœ¨æ•°æ®ç§‘å­¦ä¸­å¾ˆå°‘éœ€è¦ã€‚

\subsection{ç®—æœ¯å’Œå¾ªç¯è§„åˆ™}\label{sec-recycling}

åœ¨ ç« èŠ‚~\ref{sec-workflow-basics} ï¼Œæˆ‘ä»¬ä»‹ç»äº†ç®—æœ¯è¿ç®—ï¼ˆ\texttt{+},
\texttt{-}, \texttt{*}, \texttt{/},
\texttt{\^{}}ï¼‰çš„åŸºç¡€çŸ¥è¯†ï¼Œå¹¶åœ¨æ­¤ä¹‹åå¤šæ¬¡ä½¿ç”¨äº†å®ƒä»¬ã€‚è¿™
äº›å‡½æ•°ä¸éœ€è¦è¿‡å¤šçš„è§£é‡Šï¼Œå› ä¸ºå®ƒä»¬æ‰§è¡Œçš„æ˜¯ä½ åœ¨å°å­¦å°±å­¦è¿‡çš„è¿ç®—ã€‚ä½†
æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦ç®€çŸ­åœ°è®¨è®ºä¸€ä¸‹å¾ªç¯è§„åˆ™ï¼ˆrecycling
rulesï¼‰ï¼Œè¿™äº›è§„åˆ™å†³å®šäº†å½“å·¦ä¾§å’Œå³ä¾§çš„é•¿åº¦ä¸åŒæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚è¿™
å¯¹äºåƒ\texttt{flights\ \textbar{}\textgreater{}\ mutate(air\_time\ =\ air\_time\ /\ 60)}è¿™æ ·çš„æ“ä½œå¾ˆé‡è¦ï¼Œå› ä¸ºåœ¨\texttt{/}çš„å·¦ä¾§æœ‰336,776ä¸ªæ•°å­—ï¼Œè€Œå³ä¾§åªæœ‰ä¸€ä¸ªã€‚

Ré€šè¿‡å¾ªç¯æˆ–é‡å¤è¾ƒçŸ­çš„å‘é‡æ¥å¤„ç†é•¿åº¦ä¸åŒ¹é…çš„æƒ…å†µã€‚å¦‚
æœæˆ‘ä»¬åœ¨æ•°æ®æ¡†ä¹‹å¤–åˆ›å»ºä¸€äº›å‘é‡ï¼Œå°±èƒ½æ›´å®¹æ˜“åœ°çœ‹åˆ°è¿™ä¸ªæ“ä½œè¿‡ç¨‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{20}\NormalTok{)}
\NormalTok{x }\SpecialCharTok{/} \DecValTok{5}
\CommentTok{\#\textgreater{} [1] 0.2 0.4 2.0 4.0}
\CommentTok{\# is shorthand for}
\NormalTok{x }\SpecialCharTok{/} \FunctionTok{c}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{5}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] 0.2 0.4 2.0 4.0}
\end{Highlighting}
\end{Shaded}

é€šå¸¸ï¼Œä½ åªæƒ³å¾ªç¯å•ä¸ªæ•°å­—ï¼ˆå³é•¿åº¦ä¸º1çš„å‘é‡ï¼‰ï¼Œä½†Rä¼šå¾ªç¯ä»»ä½•è¾ƒçŸ­çš„å‘é‡ã€‚å¦‚
æœè¾ƒé•¿çš„å‘é‡ä¸æ˜¯è¾ƒçŸ­çš„å‘é‡çš„å€æ•°ï¼ŒRé€šå¸¸ä¼šï¼ˆä½†ä¸æ€»æ˜¯ï¼‰ç»™å‡ºè­¦å‘Šï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\SpecialCharTok{*} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{)}
\CommentTok{\#\textgreater{} [1]  1  4 10 40}
\NormalTok{x }\SpecialCharTok{*} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{)}
\CommentTok{\#\textgreater{} Warning in x * c(1, 2, 3): longer object length is not a multiple of shorter}
\CommentTok{\#\textgreater{} object length}
\CommentTok{\#\textgreater{} [1]  1  4 30 20}
\end{Highlighting}
\end{Shaded}

è¿™äº›å¾ªç¯è§„åˆ™ä¹Ÿé€‚ç”¨äºé€»è¾‘æ¯”è¾ƒï¼ˆ\texttt{==}, \texttt{\textless{}},
\texttt{\textless{}=}, \texttt{\textgreater{}},
\texttt{\textgreater{}=},
\texttt{!=}ï¼‰ï¼Œå¦‚æœä½ ä¸å°å¿ƒä½¿ç”¨äº†\texttt{==}è€Œä¸æ˜¯\texttt{\%in\%}ï¼Œå¹¶ä¸”æ•°æ®æ¡†çš„è¡Œæ•°ä¸å·§åœ°åŒ¹é…äº†è¿™äº›è§„åˆ™ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¸€ä¸ªä»¤äººæƒŠè®¶çš„ç»“æœã€‚ä¾‹
å¦‚ï¼Œè€ƒè™‘ä»¥ä¸‹ä»£ç ï¼Œå®ƒè¯•å›¾æ‰¾å‡º1æœˆå’Œ2æœˆçš„æ‰€æœ‰èˆªç­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(month }\SpecialCharTok{==} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\CommentTok{\#\textgreater{} \# A tibble: 25,977 x 19}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      517            515         2      830            819}
\CommentTok{\#\textgreater{} 2  2013     1     1      542            540         2      923            850}
\CommentTok{\#\textgreater{} 3  2013     1     1      554            600        {-}6      812            837}
\CommentTok{\#\textgreater{} 4  2013     1     1      555            600        {-}5      913            854}
\CommentTok{\#\textgreater{} 5  2013     1     1      557            600        {-}3      838            846}
\CommentTok{\#\textgreater{} 6  2013     1     1      558            600        {-}2      849            851}
\CommentTok{\#\textgreater{} \# i 25,971 more rows}
\CommentTok{\#\textgreater{} \# i 11 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

ä»£ç è¿è¡Œæ— è¯¯ï¼Œä½†å®ƒæ²¡æœ‰è¿”å›ä½ æƒ³è¦çš„ç»“æœã€‚ç”±
äºå¾ªç¯è§„åˆ™ï¼Œå®ƒæ‰¾åˆ°äº†åœ¨å¥‡æ•°è¡Œå‡ºå‘çš„1æœˆèˆªç­å’Œåœ¨å¶æ•°è¡Œå‡ºå‘çš„2æœˆèˆªç­ã€‚ä¸
å¹¸çš„æ˜¯ï¼Œç”±äº\texttt{flights}çš„è¡Œæ•°æ˜¯å¶æ•°æ‰€ä»¥æ²¡æœ‰ç»™å‡ºè­¦å‘Šã€‚

ä¸ºäº†é˜²æ­¢è¿™ç§é™é»˜å¤±è´¥çš„æƒ…å†µï¼Œtidyverseçš„å¤§å¤šæ•°å‡½æ•°ä½¿ç”¨äº†ä¸€ç§æ›´ä¸¥æ ¼çš„å¾ªç¯å½¢å¼ï¼Œå³ä»…å¾ªç¯å•ä¸ªå€¼ã€‚ä¸
å¹¸çš„æ˜¯ï¼Œè¿™åœ¨å½“å‰æƒ…å†µä¸‹æˆ–è®¸å¤šå…¶ä»–æƒ…å†µä¸‹å¹¶ä¸èµ·ä½œç”¨ï¼Œå› ä¸ºå…³é”®çš„è®¡ç®—æ˜¯ç”±åŸºç¡€Rå‡½æ•°\texttt{==}æ‰§è¡Œçš„ï¼Œè€Œä¸æ˜¯\texttt{filter()}ã€‚

\subsection{æœ€å°å€¼å’Œæœ€å¤§å€¼}\label{ux6700ux5c0fux503cux548cux6700ux5927ux503c}

ç®—æœ¯å‡½æ•°å¯¹å˜é‡å¯¹è¿›è¡Œæ“ä½œã€‚ä¸¤
ä¸ªç´§å¯†ç›¸å…³çš„å‡½æ•°æ˜¯\texttt{pmin()}å’Œ\texttt{pmax()}ï¼Œå½“ç»™å®šä¸¤ä¸ªæˆ–æ›´å¤šå˜é‡æ—¶ï¼Œå®ƒä»¬å°†è¿”å›æ¯è¡Œä¸­çš„æœ€å°æˆ–æœ€å¤§å€¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{x, }\SpecialCharTok{\textasciitilde{}}\NormalTok{y,}
  \DecValTok{1}\NormalTok{,  }\DecValTok{3}\NormalTok{,}
  \DecValTok{5}\NormalTok{,  }\DecValTok{2}\NormalTok{,}
  \DecValTok{7}\NormalTok{, }\ConstantTok{NA}\NormalTok{,}
\NormalTok{)}

\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{min =} \FunctionTok{pmin}\NormalTok{(x, y, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{max =} \FunctionTok{pmax}\NormalTok{(x, y, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 4}
\CommentTok{\#\textgreater{}       x     y   min   max}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1     3     1     3}
\CommentTok{\#\textgreater{} 2     5     2     2     5}
\CommentTok{\#\textgreater{} 3     7    NA     7     7}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„ï¼Œè¿™äº›å‡½æ•°ä¸\texttt{min()}å’Œ\texttt{max()}è¿™æ ·çš„æ±‡æ€»å‡½æ•°æ˜¯ä¸åŒçš„ï¼Œåè€…æ¥å—å¤šä¸ªè§‚æµ‹å€¼å¹¶è¿”å›ä¸€ä¸ªå•ä¸€çš„å€¼ã€‚å½“
å‘ç°æ‰€æœ‰çš„æœ€å°å€¼å’Œæ‰€æœ‰çš„æœ€å¤§å€¼éƒ½ç›¸åŒæ—¶ï¼Œä½ å¯ä»¥åˆ¤æ–­ä½ å¯èƒ½ä½¿ç”¨äº†é”™è¯¯çš„å½¢å¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{min =} \FunctionTok{min}\NormalTok{(x, y, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{max =} \FunctionTok{max}\NormalTok{(x, y, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 4}
\CommentTok{\#\textgreater{}       x     y   min   max}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1     3     1     7}
\CommentTok{\#\textgreater{} 2     5     2     1     7}
\CommentTok{\#\textgreater{} 3     7    NA     1     7}
\end{Highlighting}
\end{Shaded}

\subsection{æ¨¡è¿ç®—}\label{ux6a21ux8fd0ux7b97}

æ¨¡è¿ç®—ï¼ˆmodular
arithmeticï¼‰æ˜¯ä½ åœ¨å­¦ä¹ åè¿›åˆ¶ä¹‹å‰æ‰€åšçš„æ•°å­¦è¿ç®—çš„æŠ€æœ¯åç§°ï¼Œå³é™¤æ³•äº§ç”Ÿä¸€ä¸ªæ•´æ•°å•†å’Œä¸€ä¸ªä½™æ•°ã€‚åœ¨
Rä¸­ï¼Œ\texttt{\%/\%}æ‰§è¡Œæ•´æ•°é™¤æ³•ï¼Œè€Œ\texttt{\%\%}è®¡ç®—ä½™æ•°ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{1}\SpecialCharTok{:}\DecValTok{10} \SpecialCharTok{\%/\%} \DecValTok{3}
\CommentTok{\#\textgreater{}  [1] 0 0 1 1 1 2 2 2 3 3}
\DecValTok{1}\SpecialCharTok{:}\DecValTok{10} \SpecialCharTok{\%\%} \DecValTok{3}
\CommentTok{\#\textgreater{}  [1] 1 2 0 1 2 0 1 2 0 1}
\end{Highlighting}
\end{Shaded}

æ¨¡è¿ç®—å¯¹äº\texttt{flights}æ•°æ®é›†æ¥è¯´å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥å°†\texttt{sched\_dep\_time}å˜é‡åˆ†è§£ä¸º\texttt{hour}å’Œ\texttt{minute}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{hour =}\NormalTok{ sched\_dep\_time }\SpecialCharTok{\%/\%} \DecValTok{100}\NormalTok{,}
    \AttributeTok{minute =}\NormalTok{ sched\_dep\_time }\SpecialCharTok{\%\%} \DecValTok{100}\NormalTok{,}
    \AttributeTok{.keep =} \StringTok{"used"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 3}
\CommentTok{\#\textgreater{}   sched\_dep\_time  hour minute}
\CommentTok{\#\textgreater{}            \textless{}int\textgreater{} \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1            515     5     15}
\CommentTok{\#\textgreater{} 2            529     5     29}
\CommentTok{\#\textgreater{} 3            540     5     40}
\CommentTok{\#\textgreater{} 4            545     5     45}
\CommentTok{\#\textgreater{} 5            600     6      0}
\CommentTok{\#\textgreater{} 6            558     5     58}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å¯ä»¥å°†ä¸Šè¿°æ–¹æ³•ä¸æ¥è‡ª å°èŠ‚~\ref{sec-logical-summaries}
çš„\texttt{mean(is.na(x))}æŠ€å·§ç»“åˆèµ·æ¥æŸ¥çœ‹å–æ¶ˆèˆªç­çš„æ¯”ä¾‹åœ¨ä¸€å¤©ä¸­çš„å˜åŒ–æƒ…å†µã€‚ç»“
æœå¦‚å›¾ å›¾~\ref{fig-prop-cancelled} æ‰€ç¤ºã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(}\AttributeTok{hour =}\NormalTok{ sched\_dep\_time }\SpecialCharTok{\%/\%} \DecValTok{100}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{prop\_cancelled =} \FunctionTok{mean}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(dep\_time)), }\AttributeTok{n =} \FunctionTok{n}\NormalTok{()) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(hour }\SpecialCharTok{\textgreater{}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ hour, }\AttributeTok{y =}\NormalTok{ prop\_cancelled)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{color =} \StringTok{"grey50"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{size =}\NormalTok{ n))}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics[width=18.75in,height=\textheight]{numbers_files/figure-pdf/fig-prop-cancelled-1.pdf}

}

\caption{\label{fig-prop-cancelled}A line plot with scheduled departure
hour on the x-axis, and proportion of cancelled flights on the y-axis.
Cancellations seem to accumulate over the course of the day until 8pm,
very late flights are much less likely to be cancelled.}

\end{figure}%

\subsection{å¯¹æ•°}\label{ux5bf9ux6570}

å¯¹æ•°åœ¨å¤„ç†è·¨è¶Šå¤šä¸ªæ•°é‡çº§çš„æ•°æ®ä»¥åŠå°†æŒ‡æ•°å¢é•¿è½¬æ¢ä¸ºçº¿æ€§å¢é•¿æ—¶æ˜¯éå¸¸æœ‰ç”¨çš„è½¬æ¢æ–¹æ³•ã€‚åœ¨
Rä¸­ï¼Œä½ å¯ä»¥é€‰æ‹©ä¸‰ç§å¯¹æ•°ï¼š\texttt{log()}ï¼ˆè‡ªç„¶å¯¹æ•°ï¼Œåº•ä¸ºeï¼‰ã€\texttt{log2()}ï¼ˆåº•ä¸º2ï¼‰å’Œ\texttt{log10()}ï¼ˆåº•ä¸º10ï¼‰ã€‚æˆ‘
ä»¬æ¨èä½¿ç”¨\texttt{log2()}æˆ–\texttt{log10()}ã€‚\texttt{l}
\texttt{og2()}æ˜“äºè§£é‡Šï¼Œå› ä¸ºåœ¨å¯¹æ•°å°ºåº¦ä¸Šç›¸å·®1å¯¹åº”äºåŸå§‹å°ºåº¦ä¸Šçš„åŠ å€ï¼Œç›¸å·®-1å¯¹åº”äºå‡åŠï¼›è€Œ\texttt{log10()}æ˜“äºåå‘è½¬æ¢ï¼Œå› ä¸ºï¼ˆä¾‹å¦‚ï¼‰3
æ˜¯ 10 çš„ 3 æ¬¡æ–¹ï¼Œå³ 1000ã€‚\texttt{l}
\texttt{og()}çš„åå‡½æ•°æ˜¯\texttt{exp()}ï¼›è¦è®¡ç®—\texttt{log2()}æˆ–\texttt{log10()}çš„åå‡½æ•°ï¼Œä½ éœ€è¦ä½¿ç”¨\texttt{2\^{}}æˆ–\texttt{10\^{}}ã€‚

\subsection{å››èˆäº”å…¥}\label{sec-rounding}

ä½¿ç”¨\texttt{round(x)}å°†ä¸€ä¸ªæ•°å­—å››èˆäº”å…¥åˆ°æœ€æ¥è¿‘çš„æ•´æ•°:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{round}\NormalTok{(}\FloatTok{123.456}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] 123}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°\texttt{digits}æ¥æ§åˆ¶å››èˆäº”å…¥çš„ç²¾åº¦ã€‚\texttt{r}
\texttt{ound(x,\ digits)}ä¼šå°†\texttt{x}å››èˆäº”å…¥åˆ°æœ€è¿‘çš„
\texttt{10\^{}-n}ï¼Œæ‰€ä»¥\texttt{digits\ =\ 2}ä¼šå°†\texttt{x}å››èˆäº”å…¥åˆ°æœ€è¿‘çš„
0.01ã€‚è¿™
ä¸ªå®šä¹‰å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒæ„å‘³ç€\texttt{round(x,\ -3)}ä¼šå°†\texttt{x}å››èˆäº”å…¥åˆ°æœ€è¿‘çš„åƒä½ï¼Œè€Œå®ƒç¡®å®æ˜¯è¿™æ ·åšçš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{round}\NormalTok{(}\FloatTok{123.456}\NormalTok{, }\DecValTok{2}\NormalTok{)  }\CommentTok{\# two digits}
\CommentTok{\#\textgreater{} [1] 123.46}
\FunctionTok{round}\NormalTok{(}\FloatTok{123.456}\NormalTok{, }\DecValTok{1}\NormalTok{)  }\CommentTok{\# one digit}
\CommentTok{\#\textgreater{} [1] 123.5}
\FunctionTok{round}\NormalTok{(}\FloatTok{123.456}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{) }\CommentTok{\# round to nearest ten}
\CommentTok{\#\textgreater{} [1] 120}
\FunctionTok{round}\NormalTok{(}\FloatTok{123.456}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{2}\NormalTok{) }\CommentTok{\# round to nearest hundred}
\CommentTok{\#\textgreater{} [1] 100}
\end{Highlighting}
\end{Shaded}

\texttt{round()}æœ‰ä¸€ä¸ªçœ‹èµ·æ¥æœ‰äº›å¥‡æ€ªçš„ç‰¹æ€§ï¼Œç¬¬ä¸€çœ¼çœ‹ä¸Šå»è¿™å¯èƒ½ä¼šè®©äººåƒæƒŠï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{round}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\FloatTok{1.5}\NormalTok{, }\FloatTok{2.5}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] 2 2}
\end{Highlighting}
\end{Shaded}

\texttt{round()}ä½¿ç”¨çš„æ˜¯æ‰€è°“çš„``å‘å¶æ•°èˆå…¥''æˆ–``é“¶è¡Œå®¶èˆå…¥''æ–¹æ³•ï¼šå¦‚æœä¸€ä¸ªæ•°å­—æ­£å¥½åœ¨ä¸¤ä¸ªæ•´æ•°ä¹‹é—´ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«èˆå…¥åˆ°å¶æ•°æ•´æ•°ã€‚è¿™
æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç­–ç•¥ï¼Œå› ä¸ºå®ƒä½¿å¾—èˆå…¥æ˜¯æ— åçš„ï¼šä¸€åŠçš„ 0.5
è¢«å‘ä¸Šèˆå…¥ï¼Œè€Œå¦ä¸€åŠè¢«å‘ä¸‹èˆå…¥ã€‚

\texttt{round()}ä¸\texttt{floor()}å’Œ\texttt{ceiling()}ç›¸å¯¹åº”ã€‚\texttt{f}
\texttt{loor()}æ€»æ˜¯å‘ä¸‹èˆå…¥ï¼Œè€Œ\texttt{ceiling()}æ€»æ˜¯å‘ä¸Šèˆå…¥ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FloatTok{123.456}

\FunctionTok{floor}\NormalTok{(x)}
\CommentTok{\#\textgreater{} [1] 123}
\FunctionTok{ceiling}\NormalTok{(x)}
\CommentTok{\#\textgreater{} [1] 124}
\end{Highlighting}
\end{Shaded}

è¿™äº›å‡½æ•°ï¼ˆ\texttt{floor()}å’Œ\texttt{ceiling()}ï¼‰æ²¡æœ‰\texttt{digits}å‚æ•°ï¼Œæ‰€ä»¥ä½ å¯ä»¥å…ˆå°†æ•°å­—ç¼©å°æ¯”ä¾‹ï¼Œç„¶åå››èˆäº”å…¥ï¼Œæœ€åå†æ‰©å¤§å›åŸæ¥çš„æ¯”ä¾‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Round down to nearest two digits}
\FunctionTok{floor}\NormalTok{(x }\SpecialCharTok{/} \FloatTok{0.01}\NormalTok{) }\SpecialCharTok{*} \FloatTok{0.01}
\CommentTok{\#\textgreater{} [1] 123.45}
\CommentTok{\# Round up to nearest two digits}
\FunctionTok{ceiling}\NormalTok{(x }\SpecialCharTok{/} \FloatTok{0.01}\NormalTok{) }\SpecialCharTok{*} \FloatTok{0.01}
\CommentTok{\#\textgreater{} [1] 123.46}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ æƒ³è¦å°†\texttt{round()}èˆå…¥åˆ°æŸä¸ªæ•°çš„å€æ•°ï¼Œä½ å¯ä»¥ä½¿ç”¨ç›¸åŒçš„æŠ€å·§ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Round to nearest multiple of 4}
\FunctionTok{round}\NormalTok{(x }\SpecialCharTok{/} \DecValTok{4}\NormalTok{) }\SpecialCharTok{*} \DecValTok{4}
\CommentTok{\#\textgreater{} [1] 124}

\CommentTok{\# Round to nearest 0.25}
\FunctionTok{round}\NormalTok{(x }\SpecialCharTok{/} \FloatTok{0.25}\NormalTok{) }\SpecialCharTok{*} \FloatTok{0.25}
\CommentTok{\#\textgreater{} [1] 123.5}
\end{Highlighting}
\end{Shaded}

\subsection{å°†æ•°å­—åˆ‡åˆ†æˆåŒºé—´}\label{ux5c06ux6570ux5b57ux5207ux5206ux6210ux533aux95f4}

ä½¿ç”¨\texttt{cut()}\footnote{\texttt{ggplot2}æä¾›äº†ä¸€äº›è¾…åŠ©å‡½æ•°æ¥å¤„ç†\texttt{cut\_interval()},\texttt{cut\_number()}å’Œ\texttt{cut\_width()}ä¸­çš„å¸¸è§æƒ…å†µã€‚è™½
  ç„¶\texttt{ggplot2}æ˜¯è¿™äº›å‡½æ•°å­˜æ”¾çš„ä¸€ä¸ªç¨æ˜¾å¥‡æ€ªçš„åœ°æ–¹ï¼Œä½†å®ƒä»¬ä½œä¸ºç›´æ–¹å›¾è®¡ç®—çš„ä¸€éƒ¨åˆ†éå¸¸æœ‰ç”¨ï¼Œå¹¶ä¸”åœ¨
  tidyverse çš„å…¶ä»–éƒ¨åˆ†å‡ºç°ä¹‹å‰å°±å·²ç»è¢«ç¼–å†™å‡ºæ¥äº†ã€‚}å‡½æ•°å¯ä»¥å°†ä¸€ä¸ªæ•°å€¼å‘é‡æ‹†åˆ†ï¼ˆä¹Ÿç§°ä¸ºåˆ†ç®±æˆ–åˆ†ç»„ï¼‰æˆç¦»æ•£çš„åŒºé—´ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{20}\NormalTok{)}
\FunctionTok{cut}\NormalTok{(x, }\AttributeTok{breaks =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{20}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] (0,5]   (0,5]   (0,5]   (5,10]  (10,15] (15,20]}
\CommentTok{\#\textgreater{} Levels: (0,5] (5,10] (10,15] (15,20]}
\end{Highlighting}
\end{Shaded}

\texttt{breaks}ä¸éœ€è¦æ˜¯ç­‰è·çš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cut}\NormalTok{(x, }\AttributeTok{breaks =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{100}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] (0,5]    (0,5]    (0,5]    (5,10]   (10,100] (10,100]}
\CommentTok{\#\textgreater{} Levels: (0,5] (5,10] (10,100]}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥é€‰æ‹©æ€§åœ°æä¾›ä½ è‡ªå·±çš„\texttt{labels}ã€‚è¯·
æ³¨æ„ï¼Œ\texttt{labels}çš„æ•°é‡åº”è¯¥æ¯”\texttt{breaks}å°‘ä¸€ä¸ªã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cut}\NormalTok{(x, }
  \AttributeTok{breaks =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{20}\NormalTok{), }
  \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"sm"}\NormalTok{, }\StringTok{"md"}\NormalTok{, }\StringTok{"lg"}\NormalTok{, }\StringTok{"xl"}\NormalTok{)}
\NormalTok{)}
\CommentTok{\#\textgreater{} [1] sm sm sm md lg xl}
\CommentTok{\#\textgreater{} Levels: sm md lg xl}
\end{Highlighting}
\end{Shaded}

ä»»ä½•è¶…å‡º\texttt{breaks}èŒƒå›´çš„å€¼éƒ½ä¼šå˜æˆ\texttt{NA}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{10}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{30}\NormalTok{)}
\FunctionTok{cut}\NormalTok{(y, }\AttributeTok{breaks =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{20}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] \textless{}NA\textgreater{}   \textless{}NA\textgreater{}   (0,5]  (5,10] \textless{}NA\textgreater{}  }
\CommentTok{\#\textgreater{} Levels: (0,5] (5,10] (10,15] (15,20]}
\end{Highlighting}
\end{Shaded}

æŸ¥çœ‹æ–‡æ¡£ä»¥äº†è§£å…¶ä»–æœ‰ç”¨çš„å‚æ•°ï¼Œå¦‚\texttt{right}å’Œ\texttt{include.lowest}ï¼Œè¿™äº›å‚æ•°æ§åˆ¶åŒºé—´æ˜¯\texttt{{[}a,\ b)}è¿˜æ˜¯~\texttt{(a,\ b{]}}ï¼Œä»¥åŠæ˜¯å¦åº”å°†æœ€ä½åŒºé—´è®¾ä¸º\texttt{{[}a,\ b{]}}ã€‚

\subsection{ç´¯ç§¯å’Œæ»šåŠ¨èšåˆ}\label{sec-cumulative-and-rolling-aggregates}

åŸºç¡€ R
æä¾›äº†\texttt{cumsum()},\texttt{cumprod()},\texttt{cummin()},\texttt{cummax()}å‡½æ•°ï¼Œç”¨äºè®¡ç®—è¿ç»­æˆ–ç´¯ç§¯çš„å’Œã€ç§¯ã€æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚d
plyr åŒ…æä¾›äº†\texttt{cummean()}å‡½æ•°ç”¨äºè®¡ç®—ç´¯ç§¯å¹³å‡å€¼ã€‚åœ¨
å®è·µä¸­ï¼Œç´¯ç§¯å’Œæ˜¯æœ€å¸¸é‡åˆ°çš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}
\FunctionTok{cumsum}\NormalTok{(x)}
\CommentTok{\#\textgreater{}  [1]  1  3  6 10 15 21 28 36 45 55}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ éœ€è¦æ›´å¤æ‚çš„æ»šåŠ¨æˆ–æ»‘åŠ¨èšåˆï¼Œå¯ä»¥å°è¯•ä½¿ç”¨\href{https://slider.r-lib.org/}{slider}åŒ…ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-33}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ç”¨æ–‡å­—è§£é‡Šç”¨äºç”Ÿæˆ@fig-prop-cancelled çš„æ¯ä¸€è¡Œä»£ç çš„ä½œç”¨ã€‚
\item
  Ræä¾›äº†ä»€ä¹ˆä¸‰è§’å‡½æ•°ï¼ŸçŒœ æµ‹ä¸€äº›åå­—å¹¶æŸ¥æ‰¾æ–‡æ¡£ã€‚è¿™
  äº›å‡½æ•°ç”¨åº¦æ•°è¿˜æ˜¯å¼§åº¦ï¼Ÿ
\item
  ç›®å‰ï¼Œ\texttt{dep\_time}å’Œ\texttt{sched\_dep\_time}çœ‹èµ·æ¥å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯éš¾ä»¥ç”¨äºè®¡ç®—ï¼Œå› ä¸ºå®ƒä»¬å¹¶ä¸æ˜¯çœŸæ­£çš„è¿ç»­æ•°å­—ã€‚ä½ 
  å¯ä»¥é€šè¿‡è¿è¡Œä¸‹é¢çš„ä»£ç æ¥çœ‹åˆ°åŸºæœ¬é—®é¢˜ï¼šæ¯å°æ—¶ä¹‹é—´éƒ½å­˜åœ¨é—´éš™ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(month }\SpecialCharTok{==} \DecValTok{1}\NormalTok{, day }\SpecialCharTok{==} \DecValTok{1}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ sched\_dep\_time, }\AttributeTok{y =}\NormalTok{ dep\_delay)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

  å°†å®ƒä»¬è½¬æ¢ä¸ºæ›´çœŸå®çš„æ—¶é—´è¡¨ç¤ºï¼ˆå¯ä»¥æ˜¯è‡ªåˆå¤œèµ·çš„å°æ—¶æ•°ï¼ˆä»¥å°æ•°å½¢å¼ï¼‰æˆ–åˆ†é’Ÿæ•°ï¼‰ã€‚
\item
  å°†\texttt{dep\_time}å’Œ\texttt{arr\_time}å››èˆäº”å…¥åˆ°æœ€è¿‘çš„äº”åˆ†é’Ÿã€‚
\end{enumerate}

\section{é€šç”¨è½¬æ¢}\label{ux901aux7528ux8f6cux6362}

ä»¥ä¸‹éƒ¨åˆ†æè¿°äº†ä¸€äº›é€šå¸¸ä¸æ•°å€¼å‘é‡ä¸€èµ·ä½¿ç”¨çš„é€šç”¨è½¬æ¢ï¼Œä½†å®ƒä»¬ä¹Ÿå¯ä»¥åº”ç”¨äºæ‰€æœ‰å…¶ä»–åˆ—ç±»å‹ã€‚

\subsection{ç§©ï¼ˆRanksï¼‰}\label{ux79e9ranks}

dplyr æä¾›äº†ä¸€ç³»åˆ—å— SQL
å¯å‘çš„æ’ç§©å‡½æ•°ï¼Œä½†ä½ åº”è¯¥å§‹ç»ˆä»\texttt{dplyr::min\_rank()}å¼€å§‹ã€‚å®ƒ
ä½¿ç”¨äº†å¤„ç†å¹¶åˆ—åæ¬¡ï¼ˆç›¸æŒï¼‰çš„æ ‡å‡†æ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œç¬¬1åã€ç¬¬2åã€ç¬¬2åã€ç¬¬4åã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\ConstantTok{NA}\NormalTok{)}
\FunctionTok{min\_rank}\NormalTok{(x)}
\CommentTok{\#\textgreater{} [1]  1  2  2  4  5 NA}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„ï¼Œæœ€å°çš„å€¼è·å¾—æœ€å°çš„ç§©ï¼›åˆ©ç”¨\texttt{desc(x)}å¯ä»¥è®©æœ€å¤§çš„å€¼è·å¾—æœ€å°çš„ç§©ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{min\_rank}\NormalTok{(}\FunctionTok{desc}\NormalTok{(x))}
\CommentTok{\#\textgreater{} [1]  5  3  3  2  1 NA}
\end{Highlighting}
\end{Shaded}

å¦‚æœ\texttt{min\_rank()}ä¸ç¬¦åˆä½ çš„éœ€æ±‚ï¼Œè¯·æŸ¥çœ‹å®ƒçš„å˜ä½“å‡½æ•°\texttt{dplyr::row\_number()}ã€\texttt{dplyr::dense\_rank()}ã€\texttt{dplyr::percent\_rank()}å’Œ\texttt{dplyr::cume\_dist()}ã€‚æŸ¥
çœ‹æ–‡æ¡£ä»¥è·å–è¯¦ç»†ä¿¡æ¯ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x)}
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{row\_number =} \FunctionTok{row\_number}\NormalTok{(x),}
    \AttributeTok{dense\_rank =} \FunctionTok{dense\_rank}\NormalTok{(x),}
    \AttributeTok{percent\_rank =} \FunctionTok{percent\_rank}\NormalTok{(x),}
    \AttributeTok{cume\_dist =} \FunctionTok{cume\_dist}\NormalTok{(x)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 5}
\CommentTok{\#\textgreater{}       x row\_number dense\_rank percent\_rank cume\_dist}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{}      \textless{}int\textgreater{}      \textless{}int\textgreater{}        \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1          1          1         0          0.2}
\CommentTok{\#\textgreater{} 2     2          2          2         0.25       0.6}
\CommentTok{\#\textgreater{} 3     2          3          2         0.25       0.6}
\CommentTok{\#\textgreater{} 4     3          4          3         0.75       0.8}
\CommentTok{\#\textgreater{} 5     4          5          4         1          1  }
\CommentTok{\#\textgreater{} 6    NA         NA         NA        NA         NA}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥é€šè¿‡é€‰æ‹©é€‚å½“çš„\texttt{ties.method}å‚æ•°æ¥ä½¿ç”¨ R
çš„åŸºç¡€å‡½æ•°\texttt{rank()}æ¥è¾¾åˆ°è®¸å¤šç›¸åŒçš„ç»“æœï¼›ä½ ä¹Ÿå¯èƒ½å¸Œæœ›é€šè¿‡è®¾ç½®\texttt{na.last\ =\ "keep"}å°†
\texttt{NA}s å€¼ä¿ç•™ä¸º \texttt{NA}ã€‚

\texttt{row\_number()}åœ¨ dplyr çš„å‡½æ•°å†…éƒ¨ä½¿ç”¨æ—¶ä¹Ÿå¯ä»¥ä¸å¸¦ä»»ä½•å‚æ•°ã€‚åœ¨
è¿™ç§æƒ…å†µä¸‹å®ƒä¼šç»™å‡º``å½“å‰''è¡Œçš„ç¼–å·ã€‚å½“
ä¸\texttt{\%\%}æˆ–\texttt{\%/\%}ç»“åˆä½¿ç”¨æ—¶ï¼Œå®ƒå¯ä»¥æˆä¸ºå°†æ•°æ®åˆ’åˆ†ä¸ºå¤§å°ç›¸ä¼¼çš„ç»„çš„æœ‰ç”¨å·¥å…·ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{id =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{)}

\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{row0 =} \FunctionTok{row\_number}\NormalTok{() }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{,}
    \AttributeTok{three\_groups =}\NormalTok{ row0 }\SpecialCharTok{\%\%} \DecValTok{3}\NormalTok{,}
    \AttributeTok{three\_in\_each\_group =}\NormalTok{ row0 }\SpecialCharTok{\%/\%} \DecValTok{3}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 10 x 4}
\CommentTok{\#\textgreater{}      id  row0 three\_groups three\_in\_each\_group}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}dbl\textgreater{}        \textless{}dbl\textgreater{}               \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1     0            0                   0}
\CommentTok{\#\textgreater{} 2     2     1            1                   0}
\CommentTok{\#\textgreater{} 3     3     2            2                   0}
\CommentTok{\#\textgreater{} 4     4     3            0                   1}
\CommentTok{\#\textgreater{} 5     5     4            1                   1}
\CommentTok{\#\textgreater{} 6     6     5            2                   1}
\CommentTok{\#\textgreater{} \# i 4 more rows}
\end{Highlighting}
\end{Shaded}

\subsection{åç§»é‡ï¼ˆOffsetsï¼‰}\label{ux504fux79fbux91cfoffsets}

\texttt{dplyr::lead()}å’Œ\texttt{dplyr::lag()}å…è®¸ä½ å¼•ç”¨``å½“å‰''å€¼ä¹‹å‰æˆ–ä¹‹åçš„å€¼ã€‚å®ƒ
ä»¬ä¼šè¿”å›ä¸€ä¸ªä¸è¾“å…¥é•¿åº¦ç›¸åŒçš„å‘é‡ï¼Œå¹¶åœ¨å¼€å§‹æˆ–ç»“æŸæ—¶ç”¨ \texttt{NA}s å¡«å……ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{11}\NormalTok{, }\DecValTok{11}\NormalTok{, }\DecValTok{19}\NormalTok{, }\DecValTok{35}\NormalTok{)}
\FunctionTok{lag}\NormalTok{(x)}
\CommentTok{\#\textgreater{} [1] NA  2  5 11 11 19}
\FunctionTok{lead}\NormalTok{(x)}
\CommentTok{\#\textgreater{} [1]  5 11 11 19 35 NA}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\item
  \texttt{x\ -\ lag(x)} ç»™å‡ºå½“å‰å€¼å’Œå‰ä¸€ä¸ªå€¼ä¹‹é—´çš„å·®å€¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\SpecialCharTok{{-}} \FunctionTok{lag}\NormalTok{(x)}
\CommentTok{\#\textgreater{} [1] NA  3  6  0  8 16}
\end{Highlighting}
\end{Shaded}
\item
  \texttt{x\ ==\ lag(x)} å‘Šè¯‰ä½ å½“å‰å€¼ä½•æ—¶å‘ç”Ÿæ”¹å˜ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\SpecialCharTok{==} \FunctionTok{lag}\NormalTok{(x)}
\CommentTok{\#\textgreater{} [1]    NA FALSE FALSE  TRUE FALSE FALSE}
\end{Highlighting}
\end{Shaded}
\end{itemize}

ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°\texttt{n}æ¥å®ç°è¶…è¿‡ä¸€ä¸ªä½ç½®çš„å‘å‰æˆ–å‘åå–å€¼ã€‚

\subsection{è¿ç»­æ ‡è¯†ç¬¦}\label{ux8fdeux7eedux6807ux8bc6ux7b26}

æœ‰æ—¶ï¼Œæ¯å½“æŸä¸ªäº‹ä»¶å‘ç”Ÿæ—¶ä½ éƒ½å¸Œæœ›å¼€å§‹ä¸€ä¸ªæ–°ç»„ã€‚ä¾‹
å¦‚åœ¨æŸ¥çœ‹ç½‘ç«™æ•°æ®æ—¶ï¼Œä½ é€šå¸¸ä¼šå¸Œæœ›å°†äº‹ä»¶åˆ’åˆ†ä¸ºä¸åŒä¼šè¯ï¼ˆsessionsï¼‰ï¼Œå³å½“è·ç¦»ä¸Šæ¬¡æ´»åŠ¨è¶…è¿‡
\texttt{x} åˆ†é’Ÿæ—¶ä½ ä¼šå¼€å§‹ä¸€ä¸ªæ–°ä¼šè¯ã€‚æ¯”
å¦‚ï¼Œæƒ³è±¡ä½ æœ‰æŸäººè®¿é—®ç½‘ç«™çš„æ—¶é—´è®°å½•ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{events }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{time =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{17}\NormalTok{, }\DecValTok{19}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{27}\NormalTok{, }\DecValTok{28}\NormalTok{, }\DecValTok{30}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

å¹¶ä¸”ä½ å·²ç»è®¡ç®—äº†æ¯ä¸ªäº‹ä»¶ä¹‹é—´çš„æ—¶é—´é—´éš”ï¼Œå¹¶åˆ¤æ–­äº†æ˜¯å¦å­˜åœ¨è¶³å¤Ÿå¤§çš„é—´éš”ä»¥ç¬¦åˆæ ‡å‡†ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{events }\OtherTok{\textless{}{-}}\NormalTok{ events }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{diff =}\NormalTok{ time }\SpecialCharTok{{-}} \FunctionTok{lag}\NormalTok{(time, }\AttributeTok{default =} \FunctionTok{first}\NormalTok{(time)),}
    \AttributeTok{has\_gap =}\NormalTok{ diff }\SpecialCharTok{\textgreater{}=} \DecValTok{5}
\NormalTok{  )}
\NormalTok{events}
\CommentTok{\#\textgreater{} \# A tibble: 14 x 3}
\CommentTok{\#\textgreater{}    time  diff has\_gap}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}lgl\textgreater{}  }
\CommentTok{\#\textgreater{} 1     0     0 FALSE  }
\CommentTok{\#\textgreater{} 2     1     1 FALSE  }
\CommentTok{\#\textgreater{} 3     2     1 FALSE  }
\CommentTok{\#\textgreater{} 4     3     1 FALSE  }
\CommentTok{\#\textgreater{} 5     5     2 FALSE  }
\CommentTok{\#\textgreater{} 6    10     5 TRUE   }
\CommentTok{\#\textgreater{} \# i 8 more rows}
\end{Highlighting}
\end{Shaded}

ä½†æ˜¯ï¼Œæˆ‘ä»¬å¦‚ä½•ä»é€»è¾‘å‘é‡è½¬æ¢ä¸ºå¯ä»¥ä½¿ç”¨\texttt{group\_by()}è¿›è¡Œåˆ†ç»„çš„ä¸œè¥¿å‘¢ï¼Ÿ\texttt{c}
\texttt{umsum()}å‡½æ•°ï¼ˆæ¥è‡ª
å°èŠ‚~\ref{sec-cumulative-and-rolling-aggregates}
ï¼‰æ­¤æ—¶å°±æ´¾ä¸Šäº†ç”¨åœºï¼Œå½“å­˜åœ¨é—´éš”ï¼ˆå³\texttt{has\_gap}ä¸º\texttt{TRUE}ï¼‰æ—¶ï¼Œå®ƒä¼šå¢åŠ åˆ†ç»„ç¼–å·ï¼ˆæ¥è‡ª@sec-numeric-summaries-of-logicals
ï¼‰ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{events }\SpecialCharTok{|\textgreater{}} \FunctionTok{mutate}\NormalTok{(}
  \AttributeTok{group =} \FunctionTok{cumsum}\NormalTok{(has\_gap)}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 14 x 4}
\CommentTok{\#\textgreater{}    time  diff has\_gap group}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}lgl\textgreater{}   \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1     0     0 FALSE       0}
\CommentTok{\#\textgreater{} 2     1     1 FALSE       0}
\CommentTok{\#\textgreater{} 3     2     1 FALSE       0}
\CommentTok{\#\textgreater{} 4     3     1 FALSE       0}
\CommentTok{\#\textgreater{} 5     5     2 FALSE       0}
\CommentTok{\#\textgreater{} 6    10     5 TRUE        1}
\CommentTok{\#\textgreater{} \# i 8 more rows}
\end{Highlighting}
\end{Shaded}

åˆ›å»ºåˆ†ç»„å˜é‡çš„å¦ä¸€ç§æ–¹æ³•æ˜¯\texttt{consecutive\_id()}ï¼Œå®ƒä¼šåœ¨å…¶å‚æ•°ä¹‹ä¸€å‘ç”Ÿå˜åŒ–æ—¶å¼€å§‹ä¸€ä¸ªæ–°ç»„ã€‚ä¾‹
å¦‚ï¼Œå—åˆ°\href{https://stackoverflow.com/questions/27482712}{this
stackoverflow question}çš„å¯å‘ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ªåŒ…å«è®¸å¤šé‡å¤å€¼çš„æ•°æ®æ¡†ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"a"}\NormalTok{, }\StringTok{"a"}\NormalTok{, }\StringTok{"b"}\NormalTok{, }\StringTok{"c"}\NormalTok{, }\StringTok{"c"}\NormalTok{, }\StringTok{"d"}\NormalTok{, }\StringTok{"e"}\NormalTok{, }\StringTok{"a"}\NormalTok{, }\StringTok{"a"}\NormalTok{, }\StringTok{"b"}\NormalTok{, }\StringTok{"b"}\NormalTok{),}
  \AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{9}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{199}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ æƒ³è¦ä¿ç•™æ¯ä¸ªé‡å¤å€¼\texttt{x}çš„ç¬¬ä¸€è¡Œï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{group\_by()}ã€\texttt{consecutive\_id()}å’Œ\texttt{slice\_head()}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(}\AttributeTok{id =} \FunctionTok{consecutive\_id}\NormalTok{(x)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{slice\_head}\NormalTok{(}\AttributeTok{n =} \DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 7 x 3}
\CommentTok{\#\textgreater{} \# Groups:   id [7]}
\CommentTok{\#\textgreater{}   x         y    id}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}dbl\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 a         1     1}
\CommentTok{\#\textgreater{} 2 b         2     2}
\CommentTok{\#\textgreater{} 3 c         4     3}
\CommentTok{\#\textgreater{} 4 d         3     4}
\CommentTok{\#\textgreater{} 5 e         9     5}
\CommentTok{\#\textgreater{} 6 a         4     6}
\CommentTok{\#\textgreater{} \# i 1 more row}
\end{Highlighting}
\end{Shaded}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-34}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ä½¿ç”¨æ’ç§©å‡½æ•°æ‰¾å‡ºå»¶è¯¯æ—¶é—´æœ€é•¿çš„10ä¸ªèˆªç­ã€‚å¦‚
  æœå‡ºç°å¹¶åˆ—çš„æƒ…å†µï¼Œä½ æ‰“ç®—å¦‚ä½•å¤„ç†ï¼Ÿè¯·
  ä»”ç»†é˜…è¯»\texttt{min\_rank()}å‡½æ•°çš„æ–‡æ¡£ã€‚
\item
  å“ªæ¶é£æœºï¼ˆ\texttt{tailnum}ï¼‰çš„å‡†æ—¶è®°å½•æœ€å·®ï¼Ÿ
\item
  å¦‚æœä½ æƒ³å°½å¯èƒ½é¿å…å»¶è¯¯ï¼Œä½ åº”è¯¥åœ¨ä¸€å¤©ä¸­çš„å“ªä¸ªæ—¶é—´æ®µé£è¡Œï¼Ÿ
\item
  \texttt{flights\ \textbar{}\textgreater{}\ group\_by(dest)\ \textbar{}\textgreater{}\ filter(row\_number()\ \textless{}\ 4)}è¿™æ®µä»£ç åšäº†ä»€ä¹ˆï¼Ÿ\texttt{f}
  \texttt{lights\ \textbar{}\textgreater{}\ group\_by(dest)\ \textbar{}\textgreater{}\ filter(row\_number(dep\_delay)\ \textless{}\ 4)}è¿™æ®µä»£ç åˆåšäº†ä»€ä¹ˆï¼Ÿ
\item
  å¯¹äºæ¯ä¸ªç›®çš„åœ°ï¼Œè®¡ç®—å»¶è¯¯çš„æ€»åˆ†é’Ÿæ•°ï¼›å¯¹äºæ¯ä¸ªèˆªç­ï¼Œè®¡ç®—å…¶ç›®çš„åœ°å»¶è¯¯æ€»æ—¶é—´ä¸­æ‰€å çš„æ¯”ä¾‹ã€‚
\item
  å»¶è¯¯é€šå¸¸æ˜¯æ—¶é—´ç›¸å…³çš„ï¼šå³ä½¿å¯¼è‡´åˆå§‹å»¶è¯¯çš„é—®é¢˜å·²ç»è§£å†³ï¼Œåç»­çš„èˆªç­ä»ç„¶ä¼šå»¶è¯¯ä»¥å…è®¸å‰é¢çš„èˆªç­èµ·é£ã€‚ä½¿
  ç”¨\texttt{lag()}å‡½æ•°ï¼Œæ¢ç´¢æŸå°æ—¶çš„å¹³å‡èˆªç­å»¶è¯¯ä¸å‰ä¸€å°æ—¶çš„å¹³å‡å»¶è¯¯ä¹‹é—´çš„å…³ç³»ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{hour =}\NormalTok{ dep\_time }\SpecialCharTok{\%/\%} \DecValTok{100}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(year, month, day, hour) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{dep\_delay =} \FunctionTok{mean}\NormalTok{(dep\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(n }\SpecialCharTok{\textgreater{}} \DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  æŸ¥çœ‹æ¯ä¸ªç›®çš„åœ°ï¼Œä½ èƒ½æ‰¾åˆ°é‚£äº›å¯ç–‘çš„å¿«é€Ÿèˆªç­ï¼ˆå³å¯èƒ½å­˜åœ¨æ•°æ®å½•å…¥é”™è¯¯çš„èˆªç­ï¼‰å—ï¼Ÿè®¡
  ç®—æŸèˆªç­çš„ç©ºä¸­é£è¡Œæ—¶é—´ä¸è¯¥ç›®çš„åœ°æœ€çŸ­é£è¡Œæ—¶é—´çš„ç›¸å¯¹å€¼ã€‚å“ª
  äº›èˆªç­åœ¨ç©ºä¸­å»¶è¯¯æœ€ä¸¥é‡ï¼Ÿ
\item
  æ‰¾å‡ºè‡³å°‘ç”±ä¸¤å®¶èˆªç©ºå…¬å¸è¿è¥çš„æ‰€æœ‰ç›®çš„åœ°ã€‚ä½¿
  ç”¨è¿™äº›ç›®çš„åœ°ï¼Œæ ¹æ®åŒä¸€ç›®çš„åœ°çš„è¡¨ç°ï¼Œå¯¹èˆªç©ºå…¬å¸è¿›è¡Œç›¸å¯¹æ’åã€‚
\end{enumerate}

\section{æ•°å€¼æ±‡æ€»}\label{ux6570ux503cux6c47ux603b}

ä»…ä½¿ç”¨æˆ‘ä»¬å·²ç»ä»‹ç»è¿‡çš„\texttt{counts}ã€\texttt{means}å’Œ\texttt{sums}å°±å¯ä»¥è®©ä½ èµ°å¾—å¾ˆè¿œï¼Œä½†Ræä¾›äº†è®¸å¤šå…¶ä»–æœ‰ç”¨çš„æ±‡æ€»å‡½æ•°ã€‚ä»¥
ä¸‹æ˜¯å¯èƒ½ä¼šæœ‰ç”¨çš„ä¸€äº›å‡½æ•°ã€‚

\subsection{ä¸­å¿ƒ}\label{ux4e2dux5fc3}

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸»è¦ä½¿ç”¨\texttt{mean()}æ¥æ±‡æ€»æ•°å€¼å‘é‡çš„ä¸­å¿ƒã€‚æ­£
å¦‚åœ¨@sec-sample-size
çœ‹åˆ°çš„ï¼Œç”±äºå‡æ•°æ˜¯æ€»å’Œé™¤ä»¥æ€»æ•°å¾—åˆ°çš„ï¼Œå› æ­¤å³ä½¿å¯¹å‡ ä¸ªå¼‚å¸¸é«˜æˆ–å¼‚å¸¸ä½çš„å€¼å®ƒä¹Ÿå¾ˆæ•æ„Ÿã€‚ä¸€
ç§æ›¿ä»£æ–¹æ³•æ˜¯ä½¿ç”¨\texttt{median()}ï¼Œå®ƒä¼šæ‰¾åˆ°ä¸€ä¸ªä½äºå‘é‡``ä¸­é—´''çš„å€¼ï¼Œå³50\%çš„å€¼é«˜äºå®ƒï¼Œ50\%çš„å€¼ä½äºå®ƒã€‚æ ¹
æ®ä½ æ„Ÿå…´è¶£çš„å˜é‡çš„åˆ†å¸ƒå½¢çŠ¶ï¼Œé€‰å–å‡æ•°æˆ–è€…ä¸­ä½æ•°ä½œä¸ºåˆé€‚çš„ä¸­å¿ƒåº¦é‡æ ‡å‡†ã€‚ä¾‹
å¦‚å¯¹äºå¯¹ç§°åˆ†å¸ƒæˆ‘ä»¬é€šå¸¸æŠ¥å‘Šå‡æ•°ï¼Œè€Œå¯¹äºåæ€åˆ†å¸ƒåˆ™æŠ¥å‘Šä¸­ä½æ•°ã€‚

å›¾~\ref{fig-mean-vs-median}
æ¯”è¾ƒäº†æ¯ä¸ªç›®çš„åœ°çš„èµ·é£å»¶è¯¯å‡æ•°ä¸ä¸­ä½æ•°ï¼ˆä»¥åˆ†é’Ÿä¸ºå•ä½ï¼‰ã€‚å»¶
è¯¯ä¸­ä½æ•°æ€»æ˜¯å°äºå»¶è¯¯å‡æ•°ï¼Œå› ä¸ºèˆªç­æœ‰æ—¶ä¼šå»¶è¯¯æ•°å°æ—¶ï¼Œä½†æ°¸è¿œä¸ä¼šæå‰æ•°å°æ—¶èµ·é£ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(year, month, day) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{mean =} \FunctionTok{mean}\NormalTok{(dep\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{median =} \FunctionTok{median}\NormalTok{(dep\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ mean, }\AttributeTok{y =}\NormalTok{ median)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_abline}\NormalTok{(}\AttributeTok{slope =} \DecValTok{1}\NormalTok{, }\AttributeTok{intercept =} \DecValTok{0}\NormalTok{, }\AttributeTok{color =} \StringTok{"white"}\NormalTok{, }\AttributeTok{linewidth =} \DecValTok{2}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

\centering{

\includegraphics[width=18.75in,height=\textheight]{numbers_files/figure-pdf/fig-mean-vs-median-1.pdf}

}

\caption{\label{fig-mean-vs-median}A scatterplot showing the differences
of summarizing daily departure delay with median instead of mean.}

\end{figure}%

ä½ å¯èƒ½è¿˜æƒ³çŸ¥é“ä¼—æ•°ï¼ˆmodeï¼‰ï¼Œä¹Ÿå°±æ˜¯æœ€å¸¸è§çš„å€¼ã€‚è¿™
æ˜¯ä¸€ç§ä»…åœ¨éå¸¸ç®€å•çš„æƒ…å†µä¸‹æ‰æœ‰æ•ˆçš„æ±‡æ€»ç»Ÿè®¡é‡ï¼ˆè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ å¯èƒ½åœ¨é«˜ä¸­å­¦è¿‡å®ƒï¼‰ï¼Œä½†å®ƒåœ¨è®¸å¤šçœŸå®æ•°æ®é›†ä¸Šå¹¶ä¸é€‚ç”¨ã€‚å¦‚
æœæ•°æ®æ˜¯ç¦»æ•£çš„ï¼Œå¯èƒ½å­˜åœ¨å¤šä¸ªæœ€å¸¸è§çš„å€¼ï¼Œè€Œå¦‚æœæ•°æ®æ˜¯è¿ç»­çš„ï¼Œåˆ™å¯èƒ½æ²¡æœ‰æœ€å¸¸è§çš„å€¼ï¼Œå› ä¸ºæ¯ä¸ªå€¼éƒ½ç•¥æœ‰ä¸åŒã€‚ç”±
äºè¿™äº›åŸå› ï¼Œç»Ÿè®¡å­¦å®¶å¾€å¾€ä¸ä½¿ç”¨ä¼—æ•°ï¼Œå¹¶ä¸”åœ¨Rçš„åŸºç¡€åŒ…ä¸­ä¹Ÿæ²¡æœ‰åŒ…å«è®¡ç®—ä¼—æ•°\footnote{\texttt{mode()}
  å‡½æ•°åšçš„æ˜¯å®Œå…¨ä¸åŒçš„äº‹æƒ…!}çš„å‡½æ•°ã€‚

\subsection{æœ€å°å€¼ã€æœ€å¤§å€¼å’Œåˆ†ä½æ•°}\label{sec-min-max-summary}

å¦‚æœä½ å¯¹ä¸­å¿ƒä½ç½®ä»¥å¤–çš„å…¶ä»–ä½ç½®æ„Ÿå…´è¶£æ€ä¹ˆåŠï¼Ÿ\texttt{m}
\texttt{in()}å’Œ\texttt{max()}ä¼šç»™ä½ æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚å¦
ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·æ˜¯\texttt{quantile()}ï¼Œå®ƒæ˜¯ä¸­ä½æ•°çš„æ³›åŒ–ï¼š\texttt{quantile(x,\ 0.25)}ä¼šæ‰¾åˆ°å¤§äº
25\%
çš„\texttt{x}çš„å€¼ï¼Œ\texttt{quantile(x,\ 0.5)}ç›¸å½“äºä¸­ä½æ•°ï¼Œè€Œ\texttt{quantile(x,\ 0.95)}ä¼šæ‰¾åˆ°å¤§äº
95\% çš„\texttt{x}çš„å€¼ã€‚

å¯¹äº\texttt{flights}æ•°æ®ï¼Œä½ å¯èƒ½æƒ³æŸ¥çœ‹å»¶è¯¯çš„ 95\%
åˆ†ä½æ•°è€Œä¸æ˜¯æœ€å¤§å€¼ï¼Œå› ä¸ºå®ƒä¼šå¿½ç•¥å»¶è¯¯æœ€ä¸¥é‡çš„ 5\%
èˆªç­ï¼Œè¿™éƒ¨åˆ†èˆªç­å¯èƒ½éå¸¸æç«¯ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(year, month, day) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{max =} \FunctionTok{max}\NormalTok{(dep\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{q95 =} \FunctionTok{quantile}\NormalTok{(dep\_delay, }\FloatTok{0.95}\NormalTok{, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 365 x 5}
\CommentTok{\#\textgreater{}    year month   day   max   q95}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1   853  70.1}
\CommentTok{\#\textgreater{} 2  2013     1     2   379  85  }
\CommentTok{\#\textgreater{} 3  2013     1     3   291  68  }
\CommentTok{\#\textgreater{} 4  2013     1     4   288  60  }
\CommentTok{\#\textgreater{} 5  2013     1     5   327  41  }
\CommentTok{\#\textgreater{} 6  2013     1     6   202  51  }
\CommentTok{\#\textgreater{} \# i 359 more rows}
\end{Highlighting}
\end{Shaded}

\subsection{ç¦»æ•£æ€§ï¼ˆSpreadï¼‰}\label{ux79bbux6563ux6027spread}

æœ‰æ—¶ä½ å¹¶ä¸æ˜¯é‚£ä¹ˆå…³å¿ƒå¤§éƒ¨åˆ†æ•°æ®æ‰€åœ¨çš„ä½ç½®ï¼Œè€Œæ˜¯å…³å¿ƒå®ƒçš„ç¦»æ•£ç¨‹åº¦ã€‚ä¸¤
ä¸ªå¸¸ç”¨çš„æ±‡æ€»ç»Ÿè®¡é‡æ˜¯æ ‡å‡†å·®\texttt{sd(x)}å’Œå››åˆ†ä½è·\texttt{IQR()}ã€‚æˆ‘
ä»¬åœ¨è¿™é‡Œä¸ä¼šè§£é‡Š\texttt{sd()}ï¼Œå› ä¸ºä½ å¯èƒ½å·²ç»å¾ˆç†Ÿæ‚‰äº†ï¼Œä½†\texttt{IQR()}å¯èƒ½æ¯”è¾ƒæ–°é¢–ï¼Œå®ƒç­‰äº\texttt{quantile(x,\ 0.75)\ -\ quantile(x,\ 0.25)}ï¼Œç»™å‡ºäº†åŒ…å«ä¸­é—´
50\% æ•°æ®çš„èŒƒå›´ã€‚

æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–¹æ³•æ¥æ­ç¤º\texttt{flights}æ•°æ®ä¸­çš„ä¸€ä¸ªå°å¼‚å¸¸ã€‚ä½ 
å¯èƒ½ä¼šè®¤ä¸ºï¼Œç”±äºæœºåœºæ€»æ˜¯åœ¨å›ºå®šçš„ä½ç½®ï¼Œæ‰€ä»¥èµ·ç‚¹å’Œç»ˆç‚¹ä¹‹é—´è·ç¦»çš„ç¦»æ•£æ€§åº”è¯¥æ˜¯é›¶ã€‚ä½†
æ˜¯ä¸‹é¢çš„ä»£ç æ­ç¤ºäº†æœºåœº
\href{https://en.wikipedia.org/wiki/Eagle_County_Regional_Airport}{EGE}
çš„ä¸€ä¸ªæ•°æ®å¼‚å¸¸ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(origin, dest) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{distance\_iqr =} \FunctionTok{IQR}\NormalTok{(distance), }
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(distance\_iqr }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 4}
\CommentTok{\#\textgreater{}   origin dest  distance\_iqr     n}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}  \textless{}chr\textgreater{}        \textless{}dbl\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 EWR    EGE              1   110}
\CommentTok{\#\textgreater{} 2 JFK    EGE              1   103}
\end{Highlighting}
\end{Shaded}

\subsection{åˆ†å¸ƒ}\label{ux5206ux5e03}

å€¼å¾—è®°ä½çš„æ˜¯ï¼Œä¸Šè¿°æ‰€æœ‰æè¿°çš„æ±‡æ€»ç»Ÿè®¡é‡éƒ½æ˜¯å°†åˆ†å¸ƒç®€åŒ–ä¸ºå•ä¸ªæ•°å­—çš„ä¸€ç§æ–¹å¼ã€‚è¿™
æ„å‘³ç€å®ƒä»¬æœ¬è´¨ä¸Šæ˜¯ç®€åŒ–çš„ï¼Œå¦‚æœä½ é€‰æ‹©äº†é”™è¯¯çš„æ±‡æ€»æ–¹å¼ï¼Œå¾ˆå®¹æ˜“å¿½ç•¥å„ç»„ä¹‹é—´çš„é‡è¦å·®å¼‚ã€‚å› 
æ­¤ï¼Œåœ¨ç¡®å®šæ±‡æ€»ç»Ÿè®¡é‡ä¹‹å‰ï¼Œå…ˆå¯¹æ•°æ®è¿›è¡Œå¯è§†åŒ–å§‹ç»ˆæ˜¯ä¸ªå¥½ä¸»æ„ã€‚

å›¾~\ref{fig-flights-dist} æ˜¾ç¤ºäº†å‡ºå‘å»¶è¯¯çš„æ•´ä½“åˆ†å¸ƒã€‚è¿™
ä¸ªåˆ†å¸ƒæ˜¯å¦‚æ­¤åæ–œï¼Œä»¥è‡³äºæˆ‘ä»¬å¿…é¡»æ”¾å¤§æ‰èƒ½çœ‹åˆ°å¤§éƒ¨åˆ†æ•°æ®ã€‚è¿™
è¡¨æ˜å‡æ•°å¯èƒ½ä¸æ˜¯ä¸€ä¸ªå¥½çš„æ±‡æ€»æ–¹å¼ï¼Œæˆ‘ä»¬å¯èƒ½æ›´å–œæ¬¢ä½¿ç”¨ä¸­ä½æ•°ã€‚

\begin{figure}

\centering{

\includegraphics[width=18.75in,height=\textheight]{numbers_files/figure-pdf/fig-flights-dist-1.pdf}

}

\caption{\label{fig-flights-dist}(Left) The histogram of the full data
is extremely skewed making it hard to get any details. (Right) Zooming
into delays of less than two hours makes it possible to see what's
happening with the bulk of the observations.}

\end{figure}%

åŒæ ·ï¼Œæ£€æŸ¥å­ç»„çš„åˆ†å¸ƒæ˜¯å¦ä¸æ•´ä½“ç›¸ä¼¼ä¹Ÿæ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚åœ¨
ä¸‹é¢çš„å›¾ä¸­ï¼Œ\texttt{dep\_delay}çš„365ä¸ªé¢‘æ•°å¤šè¾¹å½¢å›¾ï¼ˆfrequency
polygonsï¼‰è¢«å åŠ åœ¨ä¸€èµ·ï¼Œæ¯å¤©ä¸€ä¸ªã€‚è¿™
äº›åˆ†å¸ƒä¼¼ä¹éµå¾ªä¸€ä¸ªå…±åŒçš„æ¨¡å¼ï¼Œè¿™è¡¨æ˜æ¯å¤©ä½¿ç”¨ç›¸åŒçš„æ±‡æ€»æ–¹å¼æ˜¯åˆé€‚çš„ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{filter}\NormalTok{(dep\_delay }\SpecialCharTok{\textless{}} \DecValTok{120}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ dep\_delay, }\AttributeTok{group =} \FunctionTok{interaction}\NormalTok{(day, month))) }\SpecialCharTok{+} 
  \FunctionTok{geom\_freqpoly}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{5}\NormalTok{, }\AttributeTok{alpha =} \DecValTok{1}\SpecialCharTok{/}\DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{numbers_files/figure-pdf/unnamed-chunk-50-1.pdf}

ä¸è¦å®³æ€•æ¢è®¨é’ˆå¯¹ä½ æ­£åœ¨å¤„ç†çš„æ•°æ®è‡ªå®šä¹‰çš„æ±‡æ€»æ–¹æ³•ã€‚åœ¨
è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™å¯èƒ½æ„å‘³ç€åˆ†åˆ«æ±‡æ€»æå‰èµ·é£çš„èˆªç­å’Œæ™šèµ·é£çš„èˆªç­çš„åˆ†å¸ƒï¼Œæˆ–è€…é‰´äºè¿™äº›å€¼ä¸¥é‡åæ–œï¼Œä½ å¯èƒ½è¿˜éœ€å°è¯•è¿›è¡Œå¯¹æ•°è½¬æ¢ã€‚æœ€
åï¼Œä¸è¦å¿˜è®°åœ¨@sec-sample-size
ä¸­å­¦åˆ°çš„å†…å®¹ï¼šæ¯å½“åˆ›å»ºæ•°å€¼æ±‡æ€»æ—¶ï¼Œæœ€å¥½åŒ…æ‹¬æ¯ä¸ªç»„çš„è§‚æµ‹æ•°ã€‚

\subsection{ä½ç½®}\label{ux4f4dux7f6e}

å¯¹äºæ•°å€¼å‘é‡ï¼Œè¿˜æœ‰æœ€åä¸€ç§ç±»å‹çš„æ±‡æ€»ç»Ÿè®¡é‡éå¸¸æœ‰ç”¨ï¼Œå®ƒä¹Ÿé€‚ç”¨äºå…¶ä»–ç±»å‹çš„å€¼ï¼šæå–ç‰¹å®šä½ç½®çš„å€¼ï¼š\texttt{first(x)}ã€\texttt{last(x)}
å’Œ \texttt{nth(x,\ n)}ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°æ¯å¤©ç¬¬ä¸€æ¬¡ã€ç¬¬äº”æ¬¡å’Œæœ€åä¸€æ¬¡çš„å‡ºå‘æ—¶é—´ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(year, month, day) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{first\_dep =} \FunctionTok{first}\NormalTok{(dep\_time, }\AttributeTok{na\_rm =} \ConstantTok{TRUE}\NormalTok{), }
    \AttributeTok{fifth\_dep =} \FunctionTok{nth}\NormalTok{(dep\_time, }\DecValTok{5}\NormalTok{, }\AttributeTok{na\_rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{last\_dep =} \FunctionTok{last}\NormalTok{(dep\_time, }\AttributeTok{na\_rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \textasciigrave{}summarise()\textasciigrave{} has grouped output by \textquotesingle{}year\textquotesingle{}, \textquotesingle{}month\textquotesingle{}. You can override using}
\CommentTok{\#\textgreater{} the \textasciigrave{}.groups\textasciigrave{} argument.}
\CommentTok{\#\textgreater{} \# A tibble: 365 x 6}
\CommentTok{\#\textgreater{} \# Groups:   year, month [12]}
\CommentTok{\#\textgreater{}    year month   day first\_dep fifth\_dep last\_dep}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}     \textless{}int\textgreater{}     \textless{}int\textgreater{}    \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1       517       554     2356}
\CommentTok{\#\textgreater{} 2  2013     1     2        42       535     2354}
\CommentTok{\#\textgreater{} 3  2013     1     3        32       520     2349}
\CommentTok{\#\textgreater{} 4  2013     1     4        25       531     2358}
\CommentTok{\#\textgreater{} 5  2013     1     5        14       534     2357}
\CommentTok{\#\textgreater{} 6  2013     1     6        16       555     2355}
\CommentTok{\#\textgreater{} \# i 359 more rows}
\end{Highlighting}
\end{Shaded}

(æ³¨æ„ï¼šå› ä¸ºdplyrå‡½æ•°ä½¿ç”¨\texttt{\_}æ¥åˆ†éš”å‡½æ•°åå’Œå‚æ•°åçš„ç»„ä»¶ï¼Œæ‰€ä»¥è¿™äº›å‡½æ•°ä½¿ç”¨\texttt{na\_rm}è€Œä¸æ˜¯\texttt{na.rm}ï¼‰

å¦‚æœä½ ç†Ÿæ‚‰\texttt{{[}}æ“ä½œç¬¦ï¼Œæˆ‘ä»¬å°†åœ¨@sec-subset-many
ä¸­å†æ¬¡è®¨è®ºå®ƒï¼Œä½ å¯èƒ½ä¼šæƒ³æ˜¯å¦éœ€è¦è¿™äº›å‡½æ•°ã€‚æœ‰
ä¸‰ä¸ªåŸå› ï¼šé»˜è®¤å‚æ•°å…è®¸ä½ åœ¨æŒ‡å®šçš„ä½ç½®ä¸å­˜åœ¨æ—¶æä¾›ä¸€ä¸ªé»˜è®¤å€¼ï¼Œ\texttt{order\_by}å‚æ•°å…è®¸ä½ å±€éƒ¨è¦†ç›–è¡Œçš„é¡ºåºï¼Œè€Œ\texttt{na\_rm}å‚æ•°å…è®¸ä½ åˆ é™¤ç¼ºå¤±å€¼ã€‚

æŒ‰ä½ç½®æå–å€¼æ˜¯å¯¹æŒ‰ç§©ç­›é€‰çš„è¡¥å……ã€‚ç­›
é€‰æ“ä½œä¼šè¿”å›æ‰€æœ‰å˜é‡ï¼Œæ¯ä¸ªè§‚æµ‹éƒ½åœ¨å•ç‹¬çš„ä¸€è¡Œä¸­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(year, month, day) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{r =} \FunctionTok{min\_rank}\NormalTok{(sched\_dep\_time)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(r }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\FunctionTok{max}\NormalTok{(r)))}
\CommentTok{\#\textgreater{} \# A tibble: 1,195 x 20}
\CommentTok{\#\textgreater{} \# Groups:   year, month, day [365]}
\CommentTok{\#\textgreater{}    year month   day dep\_time sched\_dep\_time dep\_delay arr\_time sched\_arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      517            515         2      830            819}
\CommentTok{\#\textgreater{} 2  2013     1     1     2353           2359        {-}6      425            445}
\CommentTok{\#\textgreater{} 3  2013     1     1     2353           2359        {-}6      418            442}
\CommentTok{\#\textgreater{} 4  2013     1     1     2356           2359        {-}3      425            437}
\CommentTok{\#\textgreater{} 5  2013     1     2       42           2359        43      518            442}
\CommentTok{\#\textgreater{} 6  2013     1     2      458            500        {-}2      703            650}
\CommentTok{\#\textgreater{} \# i 1,189 more rows}
\CommentTok{\#\textgreater{} \# i 12 more variables: arr\_delay \textless{}dbl\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

\subsection{\texorpdfstring{åˆ©ç”¨
\texttt{mutate()}}{åˆ©ç”¨ mutate()}}\label{ux5229ux7528-mutate}

é¡¾åæ€ä¹‰ï¼Œæ±‡æ€»å‡½æ•°é€šå¸¸ä¸\texttt{summarize()}ä¸€èµ·ä½¿ç”¨ã€‚ä½†
æ˜¯ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨@sec-recycling
ä¸­è®¨è®ºçš„å¾ªç¯è§„åˆ™ï¼Œå®ƒä»¬ä¹Ÿå¯ä»¥ä¸\texttt{mutate()}ä¸€èµ·ä½¿ç”¨ï¼Œç‰¹åˆ«æ˜¯å½“ä½ æƒ³è¿›è¡ŒæŸç§åˆ†ç»„æ ‡å‡†åŒ–æ—¶ã€‚ä¾‹
å¦‚ï¼š

\begin{itemize}
\tightlist
\item
  \texttt{x\ /\ sum(x)} è®¡ç®—äº†\texttt{x}ä¸­æ¯ä¸ªå…ƒç´ å æ€»å’Œçš„æ¯”ä¾‹ï¼›
\item
  \texttt{(x\ -\ mean(x))\ /\ sd(x)}
  è®¡ç®—Z-scoreï¼ˆå°†\texttt{x}æ ‡å‡†åŒ–ä¸ºå‡æ•°ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1ï¼‰ï¼›
\item
  \texttt{(x\ -\ min(x))\ /\ (max(x)\ -\ min(x))}
  å°†\texttt{x}æ ‡å‡†åŒ–åˆ°èŒƒå›´{[}0, 1{]}ï¼›
\item
  \texttt{x\ /\ first(x)} åŸºäºç¬¬ä¸€ä¸ªè§‚æµ‹å€¼è®¡ç®—ä¸€ä¸ªæŒ‡æ•°ã€‚
\end{itemize}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-35}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  å¤´è„‘é£æš´è‡³å°‘5ç§ä¸åŒçš„æ–¹æ³•æ¥è¯„ä¼°ä¸€ç»„èˆªç­çš„å…¸å‹å»¶è¯¯ç‰¹æ€§ã€‚ä»€
  ä¹ˆæ—¶å€™ç”¨\texttt{mean()}ï¼Ÿä»€ ä¹ˆæ—¶å€™ç”¨\texttt{median()}ï¼Ÿä»€
  ä¹ˆæƒ…å†µä¸‹ä½ å¯èƒ½æƒ³ä½¿ç”¨å…¶ä»–æ–¹æ³•ï¼Ÿä½  åº”è¯¥ä½¿ç”¨åˆ°è¾¾å»¶è¯¯è¿˜æ˜¯èµ·é£å»¶è¯¯ï¼Ÿä¸º
  ä»€ä¹ˆä½ å¯èƒ½æƒ³ä½¿ç”¨æ¥è‡ª\texttt{planes}çš„æ•°æ®ï¼Ÿ
\item
  å“ªäº›ç›®çš„åœ°çš„èˆªé€Ÿå˜åŒ–æœ€å¤§ï¼Ÿ
\item
  åˆ›å»ºä¸€ä¸ªå›¾æ¥è¿›ä¸€æ­¥æ¢ç´¢EGEçš„å†’é™©ç»å†ã€‚
  ä½ èƒ½æ‰¾åˆ°æœºåœºå˜æ¢ä½ç½®çš„ä»»ä½•è¯æ®å—ï¼Ÿä½ 
  èƒ½æ‰¾åˆ°å¯è§£é‡Šè¿™ç§å·®å¼‚çš„å¦ä¸€ä¸ªå˜é‡å—ï¼Ÿ
\end{enumerate}

\section{å°ç»“}\label{ux5c0fux7ed3-12}

ä½ å·²ç»ç†Ÿæ‚‰äº†è®¸å¤šç”¨äºæ•°å­—å¤„ç†çš„å·¥å…·ï¼Œåœ¨é˜…è¯»æœ¬ç« ä¹‹åä¹ŸçŸ¥é“äº†å¦‚ä½•åœ¨Rä¸­ä½¿ç”¨å®ƒä»¬ã€‚ä½ 
è¿˜å­¦ä¹ äº†ä¸€äº›æœ‰ç”¨çš„é€šç”¨è½¬æ¢æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•é€šå¸¸ï¼ˆä½†ä¸ä»…é™äºï¼‰åº”ç”¨äºæ•°å­—å‘é‡ï¼Œå¦‚ç§©å’Œåç§»é‡ã€‚æœ€
åï¼Œé€šè¿‡ä¸€äº›æ•°å­—æ±‡æ€»è¿›è¡Œäº†å®è·µï¼Œå¹¶è®¨è®ºäº†å‡ ä¸ªä½ åº”è¯¥è€ƒè™‘çš„ç»Ÿè®¡å­¦æŒ‘æˆ˜ã€‚

åœ¨æ¥ä¸‹æ¥çš„ä¸¤ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨\texttt{stringr}åŒ…æ·±å…¥ç ”ç©¶å­—ç¬¦ä¸²çš„å¤„ç†ã€‚å­—
ç¬¦ä¸²æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„ä¸»é¢˜ï¼Œå› æ­¤å®ƒä»¬è¢«åˆ†ä¸ºä¸¤ç« ï¼Œä¸€ç« å…³äºå­—ç¬¦ä¸²çš„åŸºç¡€çŸ¥è¯†ï¼Œå¦ä¸€ç« å…³äºæ­£åˆ™è¡¨è¾¾å¼ã€‚

\chapter{å­—ç¬¦ä¸²}\label{sec-strings}

\section{å¼•è¨€}\label{ux5f15ux8a00-9}

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å·²ç»ä½¿ç”¨äº†ä¸€å †å­—ç¬¦ä¸²ï¼Œä½†å¯¹å®ƒä»¬çš„ç»†èŠ‚äº†è§£å¹¶ä¸å¤šï¼Œç°åœ¨æ˜¯æ—¶å€™æ·±å…¥äº†è§£å®ƒä»¬äº†ã€‚å­¦
ä¹ å­—ç¬¦ä¸²çš„å·¥ä½œåŸç†ï¼Œå¹¶æŒæ¡ä¸€äº›å¯ä»¥ä½¿ç”¨çš„å­—ç¬¦ä¸²æ“ä½œå·¥å…·ã€‚

æˆ‘ä»¬å°†ä»åˆ›å»ºå­—ç¬¦ä¸²å’Œå­—ç¬¦å‘é‡çš„ç»†èŠ‚å¼€å§‹ã€‚ç„¶
åï¼Œä½ å°†æ·±å…¥äº†è§£å¦‚ä½•ä»æ•°æ®ä¸­åˆ›å»ºå­—ç¬¦ä¸²ï¼Œç„¶åæ˜¯ä»æ•°æ®ä¸­æå–å­—ç¬¦ä¸²ã€‚æ¥
ç€ï¼Œæˆ‘ä»¬å°†è®¨è®ºå¤„ç†å•ä¸ªå­—æ¯çš„å·¥å…·ã€‚æœ¬
ç« æœ€åä»‹ç»äº†ä¸€äº›å¤„ç†å•ä¸ªå­—æ¯çš„å‡½æ•°ï¼Œå¹¶ç®€è¦è®¨è®ºäº†åœ¨ä½¿ç”¨å…¶ä»–è¯­è¨€æ—¶ï¼Œä½ å¯¹è‹±è¯­çš„é¢„æœŸå¯èƒ½ä¼šå¼•å¯¼ä½ è¯¯å…¥æ­§é€”çš„æƒ…å†µã€‚

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­ä½¿ç”¨å­—ç¬¦ä¸²ï¼Œå±Šæ—¶ä½ å°†æ·±å…¥äº†è§£æ­£åˆ™è¡¨è¾¾å¼çš„å¼ºå¤§åŠŸèƒ½ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-9}

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨\texttt{stringr}åŒ…ä¸­çš„å‡½æ•°ï¼Œ\texttt{stringr}æ˜¯tidyverseçš„ä¸€éƒ¨åˆ†ã€‚æˆ‘
ä»¬è¿˜å°†ä½¿ç”¨\texttt{babynames}æ•°æ®ï¼Œå› ä¸ºå®ƒæä¾›äº†ä¸€äº›æœ‰è¶£çš„å­—ç¬¦ä¸²ä¾›æ“ä½œã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(babynames)}
\end{Highlighting}
\end{Shaded}

å½“ä½ ä½¿ç”¨ stringr å‡½æ•°æ—¶ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°è¯†åˆ«å‡ºæ¥ï¼Œå› ä¸ºæ‰€æœ‰çš„ stringr
å‡½æ•°éƒ½ä»¥\texttt{str\_}å¼€å¤´ã€‚å¦‚ æœä½ ä½¿ç”¨
RStudioï¼Œè¿™å°¤å…¶æœ‰ç”¨ï¼Œå› ä¸ºè¾“å…¥\texttt{str\_}ä¼šè§¦å‘è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼Œå¸®åŠ©ä½ å›å¿†èµ·å¯ç”¨çš„å‡½æ•°ã€‚

\includegraphics[width=2.26in,height=\textheight]{screenshots/stringr-autocomplete.png}

\section{ç”Ÿæˆä¸€ä¸ªå­—ç¬¦ä¸²}\label{ux751fux6210ux4e00ux4e2aux5b57ux7b26ux4e32}

åœ¨æœ¬ä¹¦çš„å‰é¢éƒ¨åˆ†ï¼Œæˆ‘ä»¬æ›¾ç»åˆ›å»ºè¿‡å­—ç¬¦ä¸²ï¼Œä½†æ²¡æœ‰è®¨è®ºç»†èŠ‚ã€‚é¦–
å…ˆï¼Œä½ å¯ä»¥ä½¿ç”¨å•å¼•å·ï¼ˆ\texttt{\textquotesingle{}}ï¼‰æˆ–åŒå¼•å·ï¼ˆ\texttt{"}ï¼‰æ¥åˆ›å»ºå­—ç¬¦ä¸²ã€‚ä¸¤
è€…åœ¨è¡Œä¸ºä¸Šæ²¡æœ‰åŒºåˆ«ï¼Œå› æ­¤ï¼Œä¸ºäº†ä¿æŒä¸€è‡´æ€§ï¼Œ\href{https://style.tidyverse.org/syntax.html\#character-vectors}{tidyverse
é£æ ¼æŒ‡å—} å»ºè®®ä½¿ç”¨åŒå¼•å·ï¼ˆ\texttt{"}ï¼‰ï¼Œé™¤éå­—ç¬¦ä¸²ä¸­åŒ…å«å¤šä¸ª\texttt{"}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{string1 }\OtherTok{\textless{}{-}} \StringTok{"This is a string"}
\NormalTok{string2 }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}If I want to include a "quote" inside a string, I use single quotes\textquotesingle{}}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ æ¼å†™äº†ç»“æŸå¼•å·ï¼Œä½ ä¼šçœ‹åˆ°\texttt{+}ï¼Œè¿™æ˜¯ç»§ç»­æç¤ºç¬¦ï¼š

\begin{verbatim}
> "This is a string without a closing quote
+ 
+ 
+ HELP I'M STUCK IN A STRING
\end{verbatim}

å¦‚æœç¢°åˆ°äº†è¿™ç§æƒ…å†µï¼Œè€Œä½ åˆä¸çŸ¥é“æ¼å†™äº†å“ªä¸ªå¼•å·ï¼Œå¯ä»¥æŒ‰ Esc
é”®å–æ¶ˆå¹¶é‡æ–°å°è¯•ã€‚

\subsection{è½¬ä¹‰ç¬¦ï¼ˆEscapesï¼‰}\label{ux8f6cux4e49ux7b26escapes}

è¦åœ¨å­—ç¬¦ä¸²ä¸­åŒ…å«å•å¼•å·æˆ–åŒå¼•å·ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨\texttt{\textbackslash{}}
æ¥``è½¬ä¹‰''å®ƒï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{double\_quote }\OtherTok{\textless{}{-}} \StringTok{"}\SpecialCharTok{\textbackslash{}"}\StringTok{"} \CommentTok{\# or \textquotesingle{}"\textquotesingle{}}
\NormalTok{single\_quote }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}}\SpecialCharTok{\textbackslash{}\textquotesingle{}}\StringTok{\textquotesingle{}} \CommentTok{\# or "\textquotesingle{}"}
\end{Highlighting}
\end{Shaded}

æ‰€ä»¥å¦‚æœä½ æƒ³åœ¨å­—ç¬¦ä¸²ä¸­åŒ…å«ä¸€ä¸ªåæ–œæ ï¼Œä½ éœ€è¦è½¬ä¹‰å®ƒ:\texttt{"\textbackslash{}\textbackslash{}"}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{backslash }\OtherTok{\textless{}{-}} \StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{"}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„ï¼Œå­—ç¬¦ä¸²çš„è¾“å‡ºå½¢å¼ä¸å­—ç¬¦ä¸²æœ¬èº«å¹¶ä¸ç›¸åŒï¼Œå› ä¸ºè¾“å‡ºå½¢å¼ä¼šæ˜¾ç¤ºè½¬ä¹‰ç¬¦ï¼ˆæ¢å¥è¯è¯´ï¼Œå½“ä½ è¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸²æ—¶ï¼Œä½ å¯ä»¥å¤åˆ¶å¹¶ç²˜è´´è¾“å‡ºæ¥é‡æ–°åˆ›å»ºè¯¥å­—ç¬¦ä¸²ï¼‰ã€‚è¦
æŸ¥çœ‹å­—ç¬¦ä¸²çš„åŸå§‹å†…å®¹ï¼Œè¯·ä½¿ç”¨\texttt{str\_view()}\footnote{æˆ–ä½¿ç”¨åŸºç¡€Rå‡½æ•°
  \texttt{writeLines()}.}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(single\_quote, double\_quote, backslash)}
\NormalTok{x}
\CommentTok{\#\textgreater{} [1] "\textquotesingle{}"  "\textbackslash{}"" "\textbackslash{}\textbackslash{}"}

\FunctionTok{str\_view}\NormalTok{(x)}
\CommentTok{\#\textgreater{} [1] | \textquotesingle{}}
\CommentTok{\#\textgreater{} [2] | "}
\CommentTok{\#\textgreater{} [3] | \textbackslash{}}
\end{Highlighting}
\end{Shaded}

\subsection{åŸå§‹å­—ç¬¦ä¸²}\label{sec-raw-strings}

ä½¿ç”¨å¤šä¸ªå¼•å·æˆ–åæ–œæ åˆ›å»ºå­—ç¬¦ä¸²å¾ˆå¿«å°±ä¼šè®©äººå›°æƒ‘ã€‚ä¸º
äº†è¯´æ˜è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶ä¸­åŒ…å«å®šä¹‰\texttt{double\_quote}å’Œ\texttt{single\_quote}å˜é‡çš„ä»£ç å—çš„å†…å®¹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tricky }\OtherTok{\textless{}{-}} \StringTok{"double\_quote \textless{}{-} }\SpecialCharTok{\textbackslash{}"\textbackslash{}\textbackslash{}\textbackslash{}"\textbackslash{}"}\StringTok{ \# or \textquotesingle{}}\SpecialCharTok{\textbackslash{}"}\StringTok{\textquotesingle{}}
\StringTok{single\_quote \textless{}{-} \textquotesingle{}}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{\textquotesingle{}\textquotesingle{} \# or }\SpecialCharTok{\textbackslash{}"}\StringTok{\textquotesingle{}}\SpecialCharTok{\textbackslash{}"}\StringTok{"}
\FunctionTok{str\_view}\NormalTok{(tricky)}
\CommentTok{\#\textgreater{} [1] | double\_quote \textless{}{-} "\textbackslash{}"" \# or \textquotesingle{}"\textquotesingle{}}
\CommentTok{\#\textgreater{}     | single\_quote \textless{}{-} \textquotesingle{}\textbackslash{}\textquotesingle{}\textquotesingle{} \# or "\textquotesingle{}"}
\end{Highlighting}
\end{Shaded}

è¿™ä¹ˆå¤šåæ–œæ !(
è¿™æœ‰æ—¶è¢«ç§°ä¸º\href{https://en.wikipedia.org/wiki/Leaning_toothpick_syndrome}{æ–œæ ç»¼åˆç—‡})ä¸ºäº†æ¶ˆé™¤è½¬ä¹‰ï¼Œä½ å¯ä»¥ä½¿ç”¨åŸå§‹å­—ç¬¦ä¸²\footnote{åœ¨R
  4.0.0åŠæ›´é«˜ç‰ˆæœ¬ä¸­å¯ç”¨ã€‚}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tricky }\OtherTok{\textless{}{-}}\NormalTok{ r}\StringTok{"(double\_quote \textless{}{-} "}\NormalTok{\textbackslash{}}\StringTok{""} \CommentTok{\# or \textquotesingle{}"\textquotesingle{}}
\NormalTok{single\_quote }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}}\SpecialCharTok{\textbackslash{}\textquotesingle{}}\StringTok{\textquotesingle{}} \CommentTok{\# or "\textquotesingle{}")"}
\FunctionTok{str\_view}\NormalTok{(tricky)}
\CommentTok{\#\textgreater{} [1] | double\_quote \textless{}{-} "\textbackslash{}"" \# or \textquotesingle{}"\textquotesingle{}}
\CommentTok{\#\textgreater{}     | single\_quote \textless{}{-} \textquotesingle{}\textbackslash{}\textquotesingle{}\textquotesingle{} \# or "\textquotesingle{}"}
\end{Highlighting}
\end{Shaded}

åŸå§‹å­—ç¬¦ä¸²é€šå¸¸ä»¥\texttt{r"(}å¼€å¤´å¹¶ä»¥\texttt{)"}ç»“å°¾ã€‚ä½†
æ˜¯ï¼Œå¦‚æœä½ çš„å­—ç¬¦ä¸²åŒ…å«\texttt{)"}ï¼Œä½ å¯ä»¥æ”¹ç”¨\texttt{r"{[}{]}"}æˆ–\texttt{r"\{\}"}ï¼Œå¦‚æœè¿™è¿˜ä¸å¤Ÿï¼Œä½ å¯ä»¥æ’å…¥ä»»æ„æ•°é‡çš„çŸ­æ¨ªçº¿æ¥ä½¿å¼€é—­å¯¹å˜å¾—å”¯ä¸€ï¼Œä¾‹å¦‚\texttt{r"-\/-()-\/-"}ã€\texttt{r"-\/-\/-()-\/-\/-"}ç­‰ã€‚åŸå§‹å­—ç¬¦ä¸²è¶³å¤Ÿçµæ´»ï¼Œå¯ä»¥å¤„ç†ä»»ä½•æ–‡æœ¬ã€‚

\subsection{å…¶ä»–ç‰¹æ®Šå­—ç¬¦}\label{ux5176ux4ed6ux7279ux6b8aux5b57ux7b26}

é™¤äº†\texttt{\textbackslash{}"}ã€\texttt{\textbackslash{}\textquotesingle{}}å’Œ\texttt{\textbackslash{}\textbackslash{}}ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–ä¸€äº›å¯èƒ½æœ‰ç”¨çš„ç‰¹æ®Šå­—ç¬¦ã€‚æœ€å¸¸è§çš„æ˜¯\texttt{\textbackslash{}n}ï¼ˆæ¢è¡Œï¼‰å’Œ\texttt{\textbackslash{}t}ï¼ˆåˆ¶è¡¨ç¬¦ï¼‰ã€‚æœ‰æ—¶ä½ è¿˜ä¼šçœ‹åˆ°åŒ…å«ä»¥\texttt{\textbackslash{}u}æˆ–\texttt{\textbackslash{}U}~å¼€å¤´çš„
Unicode
è½¬ä¹‰åºåˆ—çš„å­—ç¬¦ä¸²ã€‚è¿™æ˜¯ä¸€ç§åœ¨æ‰€æœ‰ç³»ç»Ÿä¸Šéƒ½èƒ½å·¥ä½œçš„éè‹±æ–‡å­—ç¬¦çš„å†™æ³•ã€‚ä½ å¯ä»¥åœ¨\texttt{?Quotes}ä¸­æŸ¥çœ‹å…¶ä»–ç‰¹æ®Šå­—ç¬¦çš„å®Œæ•´åˆ—è¡¨ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"one}\SpecialCharTok{\textbackslash{}n}\StringTok{two"}\NormalTok{, }\StringTok{"one}\SpecialCharTok{\textbackslash{}t}\StringTok{two"}\NormalTok{, }\StringTok{"\textbackslash{}u00b5"}\NormalTok{, }\StringTok{"\textbackslash{}U0001f604"}\NormalTok{)}
\NormalTok{x}
\CommentTok{\#\textgreater{} [1] "one\textbackslash{}ntwo" "one\textbackslash{}ttwo" "Âµ"        "ğŸ˜„"}
\FunctionTok{str\_view}\NormalTok{(x)}
\CommentTok{\#\textgreater{} [1] | one}
\CommentTok{\#\textgreater{}     | two}
\CommentTok{\#\textgreater{} [2] | one\{\textbackslash{}t\}two}
\CommentTok{\#\textgreater{} [3] | Âµ}
\CommentTok{\#\textgreater{} [4] | ğŸ˜„}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„ï¼Œ\texttt{str\_view()}ä½¿ç”¨èŠ±æ‹¬å·æ¥è¡¨ç¤ºåˆ¶è¡¨ç¬¦ï¼Œä»¥ä¾¿æ›´å®¹æ˜“åœ°å‘ç°å®ƒä»¬\footnote{\texttt{str\_view()}
  ä¹Ÿä½¿ç”¨é¢œè‰²æ¥å¼•èµ·ä½ å¯¹åˆ¶è¡¨ç¬¦ã€ç©ºæ ¼ã€åŒ¹é…ç­‰çš„æ³¨æ„ã€‚è¿™
  äº›é¢œè‰²ç›®å‰ä¸ä¼šåœ¨ä¹¦ä¸­æ˜¾ç¤ºï¼Œä½†åœ¨äº¤äº’å¼è¿è¡Œä»£ç æ—¶ä½ ä¼šæ³¨æ„åˆ°å®ƒä»¬ã€‚}ã€‚
å¤„ç†æ–‡æœ¬æ—¶çš„ä¸€ä¸ªæŒ‘æˆ˜æ˜¯æ–‡æœ¬ä¸­å¯èƒ½å­˜åœ¨å¤šç§ä¸åŒå½¢å¼çš„ç©ºç™½å­—ç¬¦ï¼Œå› æ­¤äº†è§£è¿™ç§èƒŒæ™¯çŸ¥è¯†æœ‰åŠ©äºä½ è¯†åˆ«æ˜¯å¦å‘ç”Ÿäº†å¼‚å¸¸æƒ…å†µã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-36}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  åˆ›å»ºåŒ…å«ä»¥ä¸‹å€¼çš„å­—ç¬¦ä¸²:

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \item
    \texttt{He\ said\ "That\textquotesingle{}s\ amazing!"}
  \item
    \texttt{\textbackslash{}a\textbackslash{}b\textbackslash{}c\textbackslash{}d}
  \item
    \texttt{\textbackslash{}\textbackslash{}\textbackslash{}\textbackslash{}\textbackslash{}\textbackslash{}}
  \end{enumerate}
\item
  åœ¨Rä¼šè¯ä¸­åˆ›å»ºå­—ç¬¦ä¸²å¹¶è¾“å‡ºå®ƒã€‚ç‰¹
  æ®Šå­—ç¬¦``\textbackslash u00a0''å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ\texttt{s}
  \texttt{tr\_view()}æ˜¯å¦‚ä½•æ˜¾ç¤ºå®ƒçš„ï¼Ÿä½ 
  èƒ½åœ¨è°·æ­Œä¸ŠæŸ¥ä¸€ä¸‹è¿™ä¸ªç‰¹æ®Šå­—ç¬¦æ˜¯ä»€ä¹ˆå—ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \StringTok{"This\textbackslash{}u00a0is\textbackslash{}u00a0tricky"}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{ä»æ•°æ®ä¸­åˆ›å»ºè®¸å¤šå­—ç¬¦ä¸²}\label{ux4eceux6570ux636eux4e2dux521bux5efaux8bb8ux591aux5b57ux7b26ux4e32}

æ—¢ç„¶ä½ å·²ç»å­¦ä¼šäº†``æ‰‹åŠ¨''åˆ›å»ºä¸€ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åŸºç¡€çŸ¥è¯†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†è¯¦ç»†è®¨è®ºå¦‚ä½•ä»å…¶ä»–å­—ç¬¦ä¸²ä¸­åˆ›å»ºå­—ç¬¦ä¸²ã€‚è¿™
å°†å¸®åŠ©ä½ è§£å†³ä¸€ä¸ªå¸¸è§é—®é¢˜ï¼Œå³å½“ä½ æœ‰ä¸€äº›è‡ªå·±å†™çš„æ–‡æœ¬å¹¶å¸Œæœ›å°†å…¶ä¸æ•°æ®æ¡†ä¸­çš„å­—ç¬¦ä¸²ç»“åˆæ—¶ã€‚ä¾‹
å¦‚ï¼Œä½ å¯èƒ½æƒ³è¦å°†``Hello''ä¸ä¸€ä¸ªåå­—å˜é‡ç»“åˆèµ·æ¥åˆ›å»ºä¸€ä¸ªé—®å€™è¯­ã€‚æˆ‘
ä»¬å°†å‘ä½ å±•ç¤ºå¦‚ä½•ä½¿ç”¨\texttt{str\_c()}å’Œ\texttt{str\_glue()}å‡½æ•°æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œä»¥åŠå¦‚ä½•åœ¨\texttt{mutate()}å‡½æ•°ä¸­ä½¿ç”¨å®ƒä»¬ã€‚è¿™
è‡ªç„¶ä¼šå¼•å‡ºä¸€ä¸ªé—®é¢˜ï¼Œå³ä½ å¯èƒ½åœ¨\texttt{summarize()}å‡½æ•°ä¸­ä½¿ç”¨å“ªäº›\texttt{stringr}å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬å°†ä»¥è®¨è®º\texttt{str\_flatten()}å‡½æ•°æ¥ç»“æŸè¿™ä¸€èŠ‚ï¼Œå®ƒæ˜¯ä¸€ä¸ªç”¨äºå­—ç¬¦ä¸²çš„æ±‡æ€»å‡½æ•°ã€‚

\subsection{\texorpdfstring{\texttt{str\_c()}}{str\_c()}}\label{str_c}

\texttt{str\_c()} å¯ä»¥æ¥å—ä»»æ„æ•°é‡çš„å‘é‡ä½œä¸ºå‚æ•°å¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦å‘é‡:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_c}\NormalTok{(}\StringTok{"x"}\NormalTok{, }\StringTok{"y"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "xy"}
\FunctionTok{str\_c}\NormalTok{(}\StringTok{"x"}\NormalTok{, }\StringTok{"y"}\NormalTok{, }\StringTok{"z"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "xyz"}
\FunctionTok{str\_c}\NormalTok{(}\StringTok{"Hello "}\NormalTok{, }\FunctionTok{c}\NormalTok{(}\StringTok{"John"}\NormalTok{, }\StringTok{"Susan"}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] "Hello John"  "Hello Susan"}
\end{Highlighting}
\end{Shaded}

\texttt{str\_c()}çš„åŠŸèƒ½ç±»ä¼¼äºåŸºç¡€Rçš„\texttt{paste0()}ï¼Œä½†å®ƒæ˜¯ä¸ºäº†ä¸\texttt{mutate()}ä¸€èµ·ä½¿ç”¨è€Œè®¾è®¡çš„ï¼Œå®ƒéµå®ˆ
tidyverse ä¸­å…³äºå¾ªç¯ï¼ˆrecyclingï¼‰å’Œç¼ºå¤±å€¼ä¼ æ’­ï¼ˆpropagating missing
valuesï¼‰çš„æƒ¯å¸¸è§„åˆ™ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{name =} \FunctionTok{c}\NormalTok{(}\StringTok{"Flora"}\NormalTok{, }\StringTok{"David"}\NormalTok{, }\StringTok{"Terra"}\NormalTok{, }\ConstantTok{NA}\NormalTok{))}
\NormalTok{df }\SpecialCharTok{|\textgreater{}} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{greeting =} \FunctionTok{str\_c}\NormalTok{(}\StringTok{"Hi "}\NormalTok{, name, }\StringTok{"!"}\NormalTok{))}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 2}
\CommentTok{\#\textgreater{}   name  greeting }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}chr\textgreater{}    }
\CommentTok{\#\textgreater{} 1 Flora Hi Flora!}
\CommentTok{\#\textgreater{} 2 David Hi David!}
\CommentTok{\#\textgreater{} 3 Terra Hi Terra!}
\CommentTok{\#\textgreater{} 4 \textless{}NA\textgreater{}  \textless{}NA\textgreater{}}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ æƒ³ä»¥å¦ä¸€ç§æ–¹å¼æ˜¾ç¤ºç¼ºå¤±å€¼ï¼Œå¯ä»¥ä½¿ç”¨\texttt{coalesce()}å‡½æ•°æ¥æ›¿æ¢å®ƒä»¬ã€‚æ ¹
æ®ä½ çš„éœ€æ±‚ï¼Œå¯ä»¥åœ¨\texttt{str\_c()}å‡½æ•°å†…éƒ¨æˆ–å¤–éƒ¨ä½¿ç”¨\texttt{coalesce()}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{greeting1 =} \FunctionTok{str\_c}\NormalTok{(}\StringTok{"Hi "}\NormalTok{, }\FunctionTok{coalesce}\NormalTok{(name, }\StringTok{"you"}\NormalTok{), }\StringTok{"!"}\NormalTok{),}
    \AttributeTok{greeting2 =} \FunctionTok{coalesce}\NormalTok{(}\FunctionTok{str\_c}\NormalTok{(}\StringTok{"Hi "}\NormalTok{, name, }\StringTok{"!"}\NormalTok{), }\StringTok{"Hi!"}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 3}
\CommentTok{\#\textgreater{}   name  greeting1 greeting2}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}chr\textgreater{}     \textless{}chr\textgreater{}    }
\CommentTok{\#\textgreater{} 1 Flora Hi Flora! Hi Flora!}
\CommentTok{\#\textgreater{} 2 David Hi David! Hi David!}
\CommentTok{\#\textgreater{} 3 Terra Hi Terra! Hi Terra!}
\CommentTok{\#\textgreater{} 4 \textless{}NA\textgreater{}  Hi you!   Hi!}
\end{Highlighting}
\end{Shaded}

\subsection{\texorpdfstring{\texttt{str\_glue()}}{str\_glue()}}\label{sec-glue}

å¦‚æœåœ¨ä½¿ç”¨\texttt{str\_c()}æ—¶æ··åˆäº†å¾ˆå¤šå›ºå®šçš„å’Œå¯å˜çš„å­—ç¬¦ä¸²ï¼Œä½ ä¼šå‘ç°éœ€è¦è¾“å…¥å¾ˆå¤š\texttt{"}sï¼Œè¿™ä½¿å¾—å¾ˆéš¾çœ‹æ¸…ä»£ç çš„æ€»ä½“ç›®æ ‡ã€‚ä¸ºæ­¤ï¼Œ\href{https://glue.tidyverse.org}{glue}åŒ…æä¾›äº†ä¸€ä¸ªæ›¿ä»£æ–¹æ³•ï¼Œå³\texttt{str\_glue()}\footnote{å¦‚æœä¸ä½¿ç”¨stringrï¼Œä½ ä¹Ÿå¯ä»¥ç”¨\texttt{glue::glue()}ç›´æ¥è®¿é—®å®ƒã€‚}å‡½æ•°ã€‚ä½ åªéœ€ç»™å®ƒä¸€ä¸ªå…·æœ‰ç‰¹æ®ŠåŠŸèƒ½çš„å•ä¸€å­—ç¬¦ä¸²ï¼š\texttt{\{\}}å†…çš„ä»»ä½•å†…å®¹éƒ½ä¼šåƒåœ¨å¼•å·å¤–éƒ¨ä¸€æ ·è¢«è¯„ä¼°ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{greeting =} \FunctionTok{str\_glue}\NormalTok{(}\StringTok{"Hi \{name\}!"}\NormalTok{))}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 2}
\CommentTok{\#\textgreater{}   name  greeting }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}glue\textgreater{}   }
\CommentTok{\#\textgreater{} 1 Flora Hi Flora!}
\CommentTok{\#\textgreater{} 2 David Hi David!}
\CommentTok{\#\textgreater{} 3 Terra Hi Terra!}
\CommentTok{\#\textgreater{} 4 \textless{}NA\textgreater{}  Hi NA!}
\end{Highlighting}
\end{Shaded}

æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œ\texttt{str\_glue()}ç›®å‰å°†ç¼ºå¤±å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²
``\texttt{NA}''ï¼Œä¸å¹¸çš„æ˜¯è¿™ä¸\texttt{str\_c()}çš„å¤„ç†æ–¹å¼ä¸ä¸€è‡´ã€‚

ä½ ä¹Ÿå¯èƒ½ä¼šæƒ³ï¼Œå¦‚æœéœ€è¦åœ¨å­—ç¬¦ä¸²ä¸­åŒ…å«å¸¸è§„çš„\texttt{\{}æˆ–\texttt{\}}ç¬¦å·æ—¶åº”è¯¥æ€ä¹ˆåŠã€‚å¦‚
æœä½ çŒœæµ‹éœ€è¦ä»¥æŸç§æ–¹å¼è½¬ä¹‰å®ƒï¼Œé‚£ä¹ˆä½ çš„æ€è·¯æ˜¯æ­£ç¡®çš„ã€‚çª
é—¨åœ¨äº\texttt{glue}ä½¿ç”¨äº†ä¸€ç§ç•¥æœ‰ä¸åŒçš„è½¬ä¹‰æŠ€æœ¯ï¼šä¸æ˜¯ä½¿ç”¨åƒ\texttt{\textbackslash{}}è¿™æ ·çš„ç‰¹æ®Šå­—ç¬¦ä½œä¸ºå‰ç¼€ï¼Œè€Œæ˜¯å°†ç‰¹æ®Šå­—ç¬¦é‡å¤ä¸¤æ¬¡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{greeting =} \FunctionTok{str\_glue}\NormalTok{(}\StringTok{"\{\{Hi \{name\}!\}\}"}\NormalTok{))}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 2}
\CommentTok{\#\textgreater{}   name  greeting   }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}glue\textgreater{}     }
\CommentTok{\#\textgreater{} 1 Flora \{Hi Flora!\}}
\CommentTok{\#\textgreater{} 2 David \{Hi David!\}}
\CommentTok{\#\textgreater{} 3 Terra \{Hi Terra!\}}
\CommentTok{\#\textgreater{} 4 \textless{}NA\textgreater{}  \{Hi NA!\}}
\end{Highlighting}
\end{Shaded}

\subsection{\texorpdfstring{\texttt{str\_flatten()}}{str\_flatten()}}\label{str_flatten}

\texttt{str\_c()}å’Œ\texttt{str\_glue()}åœ¨ä¸\texttt{mutate()}ä¸€èµ·ä½¿ç”¨æ—¶æ•ˆæœå¾ˆå¥½ï¼Œå› ä¸ºå®ƒä»¬çš„è¾“å‡ºä¸è¾“å…¥å…·æœ‰ç›¸åŒçš„é•¿åº¦ã€‚ä½†
æ˜¯ï¼Œå¦‚æœä½ æƒ³è¦ä¸€ä¸ªä¸\texttt{summarize()}é…åˆè‰¯å¥½çš„å‡½æ•°ï¼Œå³ä¸€ä¸ªæ€»æ˜¯è¿”å›ä¸€ä¸ªå•ç‹¬å­—ç¬¦ä¸²çš„å‡½æ•°ï¼Œé‚£ä¹ˆ\texttt{str\_flatten()}\footnote{The
  base R equivalent is \texttt{paste()} used with the \texttt{collapse}
  argument.}å°±æ˜¯ä¸ºæ­¤è€Œè®¾è®¡çš„ï¼šå®ƒæ¥å—ä¸€ä¸ªå­—ç¬¦å‘é‡ï¼Œå¹¶å°†å‘é‡çš„æ¯ä¸ªå…ƒç´ ç»„åˆæˆä¸€ä¸ªå•ç‹¬çš„å­—ç¬¦ä¸²ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_flatten}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"x"}\NormalTok{, }\StringTok{"y"}\NormalTok{, }\StringTok{"z"}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] "xyz"}
\FunctionTok{str\_flatten}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"x"}\NormalTok{, }\StringTok{"y"}\NormalTok{, }\StringTok{"z"}\NormalTok{), }\StringTok{", "}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "x, y, z"}
\FunctionTok{str\_flatten}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"x"}\NormalTok{, }\StringTok{"y"}\NormalTok{, }\StringTok{"z"}\NormalTok{), }\StringTok{", "}\NormalTok{, }\AttributeTok{last =} \StringTok{", and "}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "x, y, and z"}
\end{Highlighting}
\end{Shaded}

è¿™ä½¿å¾—å®ƒå¯ä»¥å¾ˆå¥½åœ°ä¸ \texttt{summarize()} ä¸€èµ·å·¥ä½œï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{ name, }\SpecialCharTok{\textasciitilde{}}\NormalTok{ fruit,}
  \StringTok{"Carmen"}\NormalTok{, }\StringTok{"banana"}\NormalTok{,}
  \StringTok{"Carmen"}\NormalTok{, }\StringTok{"apple"}\NormalTok{,}
  \StringTok{"Marvin"}\NormalTok{, }\StringTok{"nectarine"}\NormalTok{,}
  \StringTok{"Terence"}\NormalTok{, }\StringTok{"cantaloupe"}\NormalTok{,}
  \StringTok{"Terence"}\NormalTok{, }\StringTok{"papaya"}\NormalTok{,}
  \StringTok{"Terence"}\NormalTok{, }\StringTok{"mandarin"}
\NormalTok{)}
\NormalTok{df }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(name) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{fruits =} \FunctionTok{str\_flatten}\NormalTok{(fruit, }\StringTok{", "}\NormalTok{))}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 2}
\CommentTok{\#\textgreater{}   name    fruits                      }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}   \textless{}chr\textgreater{}                       }
\CommentTok{\#\textgreater{} 1 Carmen  banana, apple               }
\CommentTok{\#\textgreater{} 2 Marvin  nectarine                   }
\CommentTok{\#\textgreater{} 3 Terence cantaloupe, papaya, mandarin}
\end{Highlighting}
\end{Shaded}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-37}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  æ¯”è¾ƒå’Œå¯¹æ¯”\texttt{paste0()}å’Œ\texttt{str\_c()}å¯¹äºä»¥ä¸‹è¾“å…¥çš„ç»“æœ:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_c}\NormalTok{(}\StringTok{"hi "}\NormalTok{, }\ConstantTok{NA}\NormalTok{)}
\FunctionTok{str\_c}\NormalTok{(letters[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{], letters[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{])}
\end{Highlighting}
\end{Shaded}
\item
  \texttt{paste()}å’Œ\texttt{paste0()}æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå¦‚
  ä½•ç”¨\texttt{str\_c()}é‡å»ºä¸\texttt{paste()}ç­‰æ•ˆçš„åŠŸèƒ½ï¼Ÿ
\item
  å°†ä»¥ä¸‹è¡¨è¾¾å¼ä»\texttt{str\_c()}è½¬æ¢ä¸º\texttt{str\_glue()}ï¼Œåä¹‹äº¦ç„¶:

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \tightlist
  \item
    \texttt{str\_c("The\ price\ of\ ",\ food,\ "\ is\ ",\ price)}
  \item
    \texttt{str\_glue("I\textquotesingle{}m\ \{age\}\ years\ old\ and\ live\ in\ \{country\}")}
  \item
    \texttt{str\_c("\textbackslash{}\textbackslash{}section\{",\ title,\ "\}")}
  \end{enumerate}
\end{enumerate}

\section{ä»å­—ç¬¦ä¸²æå–æ•°æ®}\label{ux4eceux5b57ux7b26ux4e32ux63d0ux53d6ux6570ux636e}

å°†å¤šä¸ªå˜é‡å‹ç¼©åˆ°å•ä¸ªå­—ç¬¦ä¸²ä¸­æ˜¯å¾ˆå¸¸è§çš„ã€‚åœ¨
æœ¬èŠ‚ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨å››ä¸ª\texttt{tidyr}å‡½æ•°æ¥æå–å®ƒä»¬ï¼š

\begin{itemize}
\tightlist
\item
  \texttt{df\ \textbar{}\textgreater{}\ separate\_longer\_delim(col,\ delim)}
\item
  \texttt{df\ \textbar{}\textgreater{}\ separate\_longer\_position(col,\ width)}
\item
  \texttt{df\ \textbar{}\textgreater{}\ separate\_wider\_delim(col,\ delim,\ names)}
\item
  \texttt{df\ \textbar{}\textgreater{}\ separate\_wider\_position(col,\ widths)}
\end{itemize}

å¦‚æœä»”ç»†è§‚å¯Ÿï¼Œå°±ä¼šå‘ç°è¿™é‡Œæœ‰ä¸€ä¸ªå…±åŒçš„æ¨¡å¼ï¼šé¦–å…ˆ\texttt{separate\_}ï¼Œç„¶å\texttt{longer}
æˆ– \texttt{wider}ï¼Œæ¥ç€\texttt{\_}ï¼Œæœ€åé€šè¿‡åˆ†éš”ç¬¦æˆ–ä½ç½®æ¥è¿›ä¸€æ­¥å¤„ç†ã€‚è¿™
æ˜¯å› ä¸ºè¿™å››ä¸ªå‡½æ•°æ˜¯ç”±ä¸¤ä¸ªæ›´ç®€å•çš„åŸè¯­ç»„æˆçš„ï¼š

\begin{itemize}
\tightlist
\item
  æ­£å¦‚\texttt{pivot\_longer()}å’Œ\texttt{pivot\_wider()}ä¸€æ ·ï¼Œä»¥\texttt{\_longer}ç»“å°¾çš„å‡½æ•°é€šè¿‡åˆ›å»ºæ–°çš„è¡Œæ¥ä½¿è¾“å…¥çš„æ•°æ®æ¡†å˜é•¿ï¼Œè€Œä»¥\texttt{\_wider}ç»“å°¾çš„å‡½æ•°åˆ™é€šè¿‡ç”Ÿæˆæ–°çš„åˆ—æ¥ä½¿è¾“å…¥çš„æ•°æ®æ¡†å˜å®½ã€‚
\item
  \texttt{delim}ä½¿ç”¨åƒ\texttt{",\ "}''æˆ–
  \texttt{"\ "}è¿™æ ·çš„åˆ†éš”ç¬¦æ¥æ‹†åˆ†å­—ç¬¦ä¸²ï¼›è€Œ\texttt{position}åˆ™æŒ‰ç…§æŒ‡å®šçš„å®½åº¦è¿›è¡Œæ‹†åˆ†ï¼Œå¦‚\texttt{c(3,\ 5,\ 2)}ã€‚
\end{itemize}

æˆ‘ä»¬å°†åœ¨@sec-regular-expressions
ä¸­å†æ¬¡å›åˆ°è¿™ä¸ªå®¶æ—ä¸­çš„æœ€åä¸€ä¸ªæˆå‘˜\texttt{separate\_wider\_regex()}ã€‚å®ƒ
æ˜¯è¿™äº›\texttt{wider}å‡½æ•°ä¸­æœ€çµæ´»çš„ï¼Œä½†ä½ éœ€è¦å¯¹æ­£åˆ™è¡¨è¾¾å¼æœ‰æ‰€äº†è§£æ‰èƒ½ä½¿ç”¨å®ƒã€‚

æ¥ä¸‹æ¥çš„ä¸¤ä¸ªéƒ¨åˆ†å°†å‘ä½ ä»‹ç»è¿™äº›æ‹†åˆ†å‡½æ•°èƒŒåçš„åŸºæœ¬æ€æƒ³ï¼Œé¦–å…ˆæ˜¯æŒ‰è¡Œæ‹†åˆ†ï¼ˆè¿™ç¨å¾®ç®€å•ä¸€äº›ï¼‰ï¼Œç„¶åæ˜¯æŒ‰åˆ—æ‹†åˆ†ã€‚æœ€
åï¼Œå°†è®¨è®º\texttt{wider}å‡½æ•°æä¾›çš„ç”¨äºè¯Šæ–­é—®é¢˜çš„å·¥å…·ã€‚

\subsection{æ‹†åˆ†æˆè¡Œ}\label{ux62c6ux5206ux6210ux884c}

å½“å­—ç¬¦ä¸²ä¸­ç»„ä»¶çš„æ•°é‡åœ¨æ¯è¡Œä¹‹é—´å˜åŒ–æ—¶ï¼Œå°†å­—ç¬¦ä¸²æ‹†åˆ†æˆè¡Œå¾€å¾€æ˜¯æœ€æœ‰ç”¨çš„ã€‚æœ€
å¸¸è§çš„æƒ…å†µæ˜¯ï¼Œéœ€è¦\texttt{separate\_longer\_delim()}åŸºäºåˆ†éš”ç¬¦è¿›è¡Œæ‹†åˆ†ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df1 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\StringTok{"a,b,c"}\NormalTok{, }\StringTok{"d,e"}\NormalTok{, }\StringTok{"f"}\NormalTok{))}
\NormalTok{df1 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{separate\_longer\_delim}\NormalTok{(x, }\AttributeTok{delim =} \StringTok{","}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 1}
\CommentTok{\#\textgreater{}   x    }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 a    }
\CommentTok{\#\textgreater{} 2 b    }
\CommentTok{\#\textgreater{} 3 c    }
\CommentTok{\#\textgreater{} 4 d    }
\CommentTok{\#\textgreater{} 5 e    }
\CommentTok{\#\textgreater{} 6 f}
\end{Highlighting}
\end{Shaded}

åœ¨å®é™…æƒ…å†µä¸­ï¼Œ\texttt{separate\_longer\_position()}çš„ä½¿ç”¨è¾ƒå°‘è§ï¼Œä½†ä¸€äº›è¾ƒæ—§çš„æ•°æ®é›†ç¡®å®ä½¿ç”¨äº†éå¸¸ç´§å‡‘çš„æ ¼å¼ï¼Œå…¶ä¸­æ¯ä¸ªå­—ç¬¦éƒ½ç”¨äºè®°å½•ä¸€ä¸ªå€¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df2 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\StringTok{"1211"}\NormalTok{, }\StringTok{"131"}\NormalTok{, }\StringTok{"21"}\NormalTok{))}
\NormalTok{df2 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{separate\_longer\_position}\NormalTok{(x, }\AttributeTok{width =} \DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 9 x 1}
\CommentTok{\#\textgreater{}   x    }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 1    }
\CommentTok{\#\textgreater{} 2 2    }
\CommentTok{\#\textgreater{} 3 1    }
\CommentTok{\#\textgreater{} 4 1    }
\CommentTok{\#\textgreater{} 5 1    }
\CommentTok{\#\textgreater{} 6 3    }
\CommentTok{\#\textgreater{} \# i 3 more rows}
\end{Highlighting}
\end{Shaded}

\subsection{æ‹†åˆ†æˆåˆ—}\label{sec-string-columns}

å½“æ¯ä¸ªå­—ç¬¦ä¸²ä¸­ç»„ä»¶æ•°é‡å›ºå®šï¼Œå¹¶ä¸”å¸Œæœ›å°†å®ƒä»¬åˆ†æ•£åˆ°åˆ—ä¸­æ—¶ï¼Œå°†å­—ç¬¦ä¸²æ‹†åˆ†æˆåˆ—å¾€å¾€æ˜¯æœ€æœ‰ç”¨çš„ã€‚å®ƒ
ä»¬æ¯”å…¶\texttt{longer}å¯¹ç­‰é¡¹ç¨å¾®å¤æ‚ä¸€äº›ï¼Œå› ä¸ºä½ éœ€è¦ä¸ºåˆ—å‘½åã€‚ä¾‹
å¦‚ï¼Œåœ¨ä»¥ä¸‹æ•°æ®é›†ä¸­ï¼Œ\texttt{x}ç”±ä»£ç ã€ç‰ˆå·å’Œå¹´ä»½ç»„æˆï¼Œå®ƒä»¬ä¹‹é—´ç”±\texttt{"."}åˆ†éš”ã€‚è¦
ä½¿ç”¨\texttt{separate\_wider\_delim()}ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸¤ä¸ªå‚æ•°ä¸­æä¾›åˆ†éš”ç¬¦å’Œåˆ—åï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df3 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\StringTok{"a10.1.2022"}\NormalTok{, }\StringTok{"b10.2.2011"}\NormalTok{, }\StringTok{"e15.1.2015"}\NormalTok{))}
\NormalTok{df3 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{separate\_wider\_delim}\NormalTok{(}
\NormalTok{    x,}
    \AttributeTok{delim =} \StringTok{"."}\NormalTok{,}
    \AttributeTok{names =} \FunctionTok{c}\NormalTok{(}\StringTok{"code"}\NormalTok{, }\StringTok{"edition"}\NormalTok{, }\StringTok{"year"}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 3}
\CommentTok{\#\textgreater{}   code  edition year }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}chr\textgreater{}   \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 a10   1       2022 }
\CommentTok{\#\textgreater{} 2 b10   2       2011 }
\CommentTok{\#\textgreater{} 3 e15   1       2015}
\end{Highlighting}
\end{Shaded}

å¦‚æœæŸä¸ªç‰¹å®šéƒ¨åˆ†æ²¡æœ‰ç”¨ï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{NA}ä½œä¸ºåˆ—åæ¥åœ¨ç»“æœä¸­çœç•¥å®ƒï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df3 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{separate\_wider\_delim}\NormalTok{(}
\NormalTok{    x,}
    \AttributeTok{delim =} \StringTok{"."}\NormalTok{,}
    \AttributeTok{names =} \FunctionTok{c}\NormalTok{(}\StringTok{"code"}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\StringTok{"year"}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 2}
\CommentTok{\#\textgreater{}   code  year }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 a10   2022 }
\CommentTok{\#\textgreater{} 2 b10   2011 }
\CommentTok{\#\textgreater{} 3 e15   2015}
\end{Highlighting}
\end{Shaded}

\texttt{separate\_wider\_position()}çš„å·¥ä½œæ–¹å¼ç•¥æœ‰ä¸åŒï¼Œå› ä¸ºä½ é€šå¸¸éœ€è¦æŒ‡å®šæ¯ä¸ªåˆ—çš„å®½åº¦ã€‚å› 
æ­¤ï¼Œä½ ç»™å®ƒä¸€ä¸ªå‘½åçš„æ•´æ•°å‘é‡ï¼Œå…¶ä¸­åç§°ç»™å‡ºæ–°åˆ—çš„åç§°ï¼Œè€Œå€¼æ˜¯å®ƒæ‰€å æ®çš„å­—ç¬¦æ•°ã€‚ä½ 
å¯ä»¥é€šè¿‡ä¸å‘½åæŸäº›å€¼æ¥ä»è¾“å‡ºä¸­çœç•¥å®ƒä»¬ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df4 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\StringTok{"202215TX"}\NormalTok{, }\StringTok{"202122LA"}\NormalTok{, }\StringTok{"202325CA"}\NormalTok{)) }
\NormalTok{df4 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{separate\_wider\_position}\NormalTok{(}
\NormalTok{    x,}
    \AttributeTok{widths =} \FunctionTok{c}\NormalTok{(}\AttributeTok{year =} \DecValTok{4}\NormalTok{, }\AttributeTok{age =} \DecValTok{2}\NormalTok{, }\AttributeTok{state =} \DecValTok{2}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 3}
\CommentTok{\#\textgreater{}   year  age   state}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}chr\textgreater{} \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 2022  15    TX   }
\CommentTok{\#\textgreater{} 2 2021  22    LA   }
\CommentTok{\#\textgreater{} 3 2023  25    CA}
\end{Highlighting}
\end{Shaded}

\subsection{è¯Šæ–­æ‰©å±•é—®é¢˜}\label{ux8bcaux65adux6269ux5c55ux95eeux9898}

\texttt{separate\_wider\_delim()}\footnote{åŒæ ·çš„åŸåˆ™ä¹Ÿé€‚ç”¨äº
  \texttt{separate\_wider\_position()} å’Œ
  \texttt{separate\_wider\_regex()}ã€‚} éœ€è¦ä¸€ä¸ªå›ºå®šä¸”å·²çŸ¥æ•°é‡çš„åˆ—ã€‚
å¦‚æœæŸäº›è¡Œæ²¡æœ‰é¢„æœŸæ•°é‡çš„ç»„ä»¶æ€ä¹ˆåŠï¼Ÿ
å¯èƒ½å­˜åœ¨ä¸¤ç§é—®é¢˜ï¼Œå³ç»„ä»¶å¤ªå°‘æˆ–å¤ªå¤šï¼Œå› æ­¤\texttt{separate\_wider\_delim()}æä¾›äº†\texttt{too\_few}å’Œ\texttt{too\_many}ä¸¤ä¸ªå‚æ•°æ¥å¸®åŠ©å¤„ç†è¿™äº›é—®é¢˜ã€‚
é¦–å…ˆï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹ç¤ºä¾‹æ•°æ®é›†æ¥æŸ¥çœ‹\texttt{too\_few}çš„æƒ…å†µï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\StringTok{"1{-}1{-}1"}\NormalTok{, }\StringTok{"1{-}1{-}2"}\NormalTok{, }\StringTok{"1{-}3"}\NormalTok{, }\StringTok{"1{-}3{-}2"}\NormalTok{, }\StringTok{"1"}\NormalTok{))}

\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{separate\_wider\_delim}\NormalTok{(}
\NormalTok{    x,}
    \AttributeTok{delim =} \StringTok{"{-}"}\NormalTok{,}
    \AttributeTok{names =} \FunctionTok{c}\NormalTok{(}\StringTok{"x"}\NormalTok{, }\StringTok{"y"}\NormalTok{, }\StringTok{"z"}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} Error in \textasciigrave{}separate\_wider\_delim()\textasciigrave{}:}
\CommentTok{\#\textgreater{} ! Expected 3 pieces in each element of \textasciigrave{}x\textasciigrave{}.}
\CommentTok{\#\textgreater{} ! 2 values were too short.}
\CommentTok{\#\textgreater{} i Use \textasciigrave{}too\_few = "debug"\textasciigrave{} to diagnose the problem.}
\CommentTok{\#\textgreater{} i Use \textasciigrave{}too\_few = "align\_start"/"align\_end"\textasciigrave{} to silence this message.}
\end{Highlighting}
\end{Shaded}

ä½ ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯æç¤ºï¼Œä½†é”™è¯¯æ¶ˆæ¯ç»™å‡ºäº†ä¸€äº›å…³äºå¦‚ä½•ç»§ç»­è¿›è¡Œçš„å»ºè®®ã€‚è®©
æˆ‘ä»¬å¼€å§‹è°ƒè¯•è¿™ä¸ªé—®é¢˜ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{debug }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{separate\_wider\_delim}\NormalTok{(}
\NormalTok{    x,}
    \AttributeTok{delim =} \StringTok{"{-}"}\NormalTok{,}
    \AttributeTok{names =} \FunctionTok{c}\NormalTok{(}\StringTok{"x"}\NormalTok{, }\StringTok{"y"}\NormalTok{, }\StringTok{"z"}\NormalTok{),}
    \AttributeTok{too\_few =} \StringTok{"debug"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} Warning: Debug mode activated: adding variables \textasciigrave{}x\_ok\textasciigrave{}, \textasciigrave{}x\_pieces\textasciigrave{}, and}
\CommentTok{\#\textgreater{} \textasciigrave{}x\_remainder\textasciigrave{}.}
\NormalTok{debug}
\CommentTok{\#\textgreater{} \# A tibble: 5 x 6}
\CommentTok{\#\textgreater{}   x     y     z     x\_ok  x\_pieces x\_remainder}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}chr\textgreater{} \textless{}chr\textgreater{} \textless{}lgl\textgreater{}    \textless{}int\textgreater{} \textless{}chr\textgreater{}      }
\CommentTok{\#\textgreater{} 1 1{-}1{-}1 1     1     TRUE         3 ""         }
\CommentTok{\#\textgreater{} 2 1{-}1{-}2 1     2     TRUE         3 ""         }
\CommentTok{\#\textgreater{} 3 1{-}3   3     \textless{}NA\textgreater{}  FALSE        2 ""         }
\CommentTok{\#\textgreater{} 4 1{-}3{-}2 3     2     TRUE         3 ""         }
\CommentTok{\#\textgreater{} 5 1     \textless{}NA\textgreater{}  \textless{}NA\textgreater{}  FALSE        1 ""}
\end{Highlighting}
\end{Shaded}

å½“ä½¿ç”¨è°ƒè¯•æ¨¡å¼æ—¶ï¼Œä½ ä¼šåœ¨è¾“å‡ºä¸­çœ‹åˆ°æ·»åŠ äº†ä¸‰ä¸ªé¢å¤–çš„åˆ—ï¼š\texttt{x\_ok}ã€\texttt{x\_pieces}å’Œ\texttt{x\_remainder}ï¼ˆå¦‚æœä½ ä½¿ç”¨ä¸åŒåç§°çš„å˜é‡è¿›è¡Œæ‹†åˆ†ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªä¸åŒçš„å‰ç¼€ï¼‰ã€‚åœ¨
è¿™é‡Œï¼Œ\texttt{x\_ok}å…è®¸ä½ å¿«é€Ÿæ‰¾åˆ°é‚£äº›å¤±è´¥çš„è¾“å…¥ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{debug }\SpecialCharTok{|\textgreater{}} \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\NormalTok{x\_ok)}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 6}
\CommentTok{\#\textgreater{}   x     y     z     x\_ok  x\_pieces x\_remainder}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}chr\textgreater{} \textless{}chr\textgreater{} \textless{}lgl\textgreater{}    \textless{}int\textgreater{} \textless{}chr\textgreater{}      }
\CommentTok{\#\textgreater{} 1 1{-}3   3     \textless{}NA\textgreater{}  FALSE        2 ""         }
\CommentTok{\#\textgreater{} 2 1     \textless{}NA\textgreater{}  \textless{}NA\textgreater{}  FALSE        1 ""}
\end{Highlighting}
\end{Shaded}

\texttt{x\_pieces}å‘Šè¯‰æˆ‘ä»¬æ‰¾åˆ°äº†å¤šå°‘ç»„ä»¶ã€‚ä¸ é¢„æœŸçš„ 3
ä¸ªï¼ˆ\texttt{names}çš„é•¿åº¦ï¼‰ç›¸æ¯”ï¼Œå½“å¾—åˆ°çš„ç»„ä»¶æ•°é‡å°‘äºé¢„æœŸæ—¶ï¼Œ\texttt{x\_remainder}å¹¶ä¸å¤ªæœ‰ç”¨ï¼Œä½†ç¨åæˆ‘ä»¬ä¼šå†æ¬¡çœ‹åˆ°å®ƒã€‚

æœ‰æ—¶æŸ¥çœ‹è¿™äº›è°ƒè¯•ä¿¡æ¯ä¼šå‘ç°ä½ çš„åˆ†éš”ç¬¦ç­–ç•¥æœ‰é—®é¢˜ï¼Œæˆ–è€…å»ºè®®ä½ åœ¨æ‹†åˆ†ä¹‹å‰éœ€è¦è¿›è¡Œæ›´å¤šçš„é¢„å¤„ç†ã€‚åœ¨
è¿™ç§æƒ…å†µä¸‹ï¼Œè§£å†³ä¸Šæ¸¸é—®é¢˜å¹¶ç¡®ä¿ç§»é™¤\texttt{too\_few\ =\ "debug"}ä»¥ç¡®ä¿æ–°é—®é¢˜å˜æˆé”™è¯¯ã€‚

åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½æƒ³ç”¨ \texttt{NA}så¡«å……ç¼ºå¤±çš„ç»„ä»¶å¹¶ç»§ç»­ã€‚è¿™
å°±æ˜¯\texttt{too\_few\ =\ "align\_start"}å’Œ\texttt{too\_few\ =\ "align\_end"}çš„ä½œç”¨ï¼Œå®ƒä»¬å…è®¸ä½ æ§åˆ¶
\texttt{NA}såº”è¯¥æ”¾åœ¨å“ªé‡Œï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{separate\_wider\_delim}\NormalTok{(}
\NormalTok{    x,}
    \AttributeTok{delim =} \StringTok{"{-}"}\NormalTok{,}
    \AttributeTok{names =} \FunctionTok{c}\NormalTok{(}\StringTok{"x"}\NormalTok{, }\StringTok{"y"}\NormalTok{, }\StringTok{"z"}\NormalTok{),}
    \AttributeTok{too\_few =} \StringTok{"align\_start"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 5 x 3}
\CommentTok{\#\textgreater{}   x     y     z    }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}chr\textgreater{} \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 1     1     1    }
\CommentTok{\#\textgreater{} 2 1     1     2    }
\CommentTok{\#\textgreater{} 3 1     3     \textless{}NA\textgreater{} }
\CommentTok{\#\textgreater{} 4 1     3     2    }
\CommentTok{\#\textgreater{} 5 1     \textless{}NA\textgreater{}  \textless{}NA\textgreater{}}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ æœ‰å¤ªå¤šçš„ç»„ä»¶ï¼ŒåŒæ ·çš„åŸåˆ™ä¹Ÿé€‚ç”¨:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\StringTok{"1{-}1{-}1"}\NormalTok{, }\StringTok{"1{-}1{-}2"}\NormalTok{, }\StringTok{"1{-}3{-}5{-}6"}\NormalTok{, }\StringTok{"1{-}3{-}2"}\NormalTok{, }\StringTok{"1{-}3{-}5{-}7{-}9"}\NormalTok{))}

\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{separate\_wider\_delim}\NormalTok{(}
\NormalTok{    x,}
    \AttributeTok{delim =} \StringTok{"{-}"}\NormalTok{,}
    \AttributeTok{names =} \FunctionTok{c}\NormalTok{(}\StringTok{"x"}\NormalTok{, }\StringTok{"y"}\NormalTok{, }\StringTok{"z"}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} Error in \textasciigrave{}separate\_wider\_delim()\textasciigrave{}:}
\CommentTok{\#\textgreater{} ! Expected 3 pieces in each element of \textasciigrave{}x\textasciigrave{}.}
\CommentTok{\#\textgreater{} ! 2 values were too long.}
\CommentTok{\#\textgreater{} i Use \textasciigrave{}too\_many = "debug"\textasciigrave{} to diagnose the problem.}
\CommentTok{\#\textgreater{} i Use \textasciigrave{}too\_many = "drop"/"merge"\textasciigrave{} to silence this message.}
\end{Highlighting}
\end{Shaded}

ä½†æ˜¯ç°åœ¨ï¼Œå½“æˆ‘ä»¬è°ƒè¯•ç»“æœæ—¶ï¼Œä½ å¯ä»¥çœ‹åˆ° \texttt{x\_remainder} çš„ç›®çš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{debug }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{separate\_wider\_delim}\NormalTok{(}
\NormalTok{    x,}
    \AttributeTok{delim =} \StringTok{"{-}"}\NormalTok{,}
    \AttributeTok{names =} \FunctionTok{c}\NormalTok{(}\StringTok{"x"}\NormalTok{, }\StringTok{"y"}\NormalTok{, }\StringTok{"z"}\NormalTok{),}
    \AttributeTok{too\_many =} \StringTok{"debug"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} Warning: Debug mode activated: adding variables \textasciigrave{}x\_ok\textasciigrave{}, \textasciigrave{}x\_pieces\textasciigrave{}, and}
\CommentTok{\#\textgreater{} \textasciigrave{}x\_remainder\textasciigrave{}.}
\NormalTok{debug }\SpecialCharTok{|\textgreater{}} \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\NormalTok{x\_ok)}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 6}
\CommentTok{\#\textgreater{}   x         y     z     x\_ok  x\_pieces x\_remainder}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}     \textless{}chr\textgreater{} \textless{}chr\textgreater{} \textless{}lgl\textgreater{}    \textless{}int\textgreater{} \textless{}chr\textgreater{}      }
\CommentTok{\#\textgreater{} 1 1{-}3{-}5{-}6   3     5     FALSE        4 {-}6         }
\CommentTok{\#\textgreater{} 2 1{-}3{-}5{-}7{-}9 3     5     FALSE        5 {-}7{-}9}
\end{Highlighting}
\end{Shaded}

å¤„ç†è¿‡å¤šç»„ä»¶æ—¶ï¼Œä¼šæœ‰ä¸€äº›ç¨å¾®ä¸åŒçš„é€‰é¡¹ï¼šä½ å¯ä»¥é€‰æ‹©é™é»˜åœ°``åˆ é™¤''ä»»ä½•é¢å¤–çš„ç»„ä»¶ï¼Œæˆ–è€…å°†å®ƒä»¬å…¨éƒ¨``åˆå¹¶''åˆ°æœ€åä¸€åˆ—ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{separate\_wider\_delim}\NormalTok{(}
\NormalTok{    x,}
    \AttributeTok{delim =} \StringTok{"{-}"}\NormalTok{,}
    \AttributeTok{names =} \FunctionTok{c}\NormalTok{(}\StringTok{"x"}\NormalTok{, }\StringTok{"y"}\NormalTok{, }\StringTok{"z"}\NormalTok{),}
    \AttributeTok{too\_many =} \StringTok{"drop"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 5 x 3}
\CommentTok{\#\textgreater{}   x     y     z    }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}chr\textgreater{} \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 1     1     1    }
\CommentTok{\#\textgreater{} 2 1     1     2    }
\CommentTok{\#\textgreater{} 3 1     3     5    }
\CommentTok{\#\textgreater{} 4 1     3     2    }
\CommentTok{\#\textgreater{} 5 1     3     5}


\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{separate\_wider\_delim}\NormalTok{(}
\NormalTok{    x,}
    \AttributeTok{delim =} \StringTok{"{-}"}\NormalTok{,}
    \AttributeTok{names =} \FunctionTok{c}\NormalTok{(}\StringTok{"x"}\NormalTok{, }\StringTok{"y"}\NormalTok{, }\StringTok{"z"}\NormalTok{),}
    \AttributeTok{too\_many =} \StringTok{"merge"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 5 x 3}
\CommentTok{\#\textgreater{}   x     y     z    }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}chr\textgreater{} \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 1     1     1    }
\CommentTok{\#\textgreater{} 2 1     1     2    }
\CommentTok{\#\textgreater{} 3 1     3     5{-}6  }
\CommentTok{\#\textgreater{} 4 1     3     2    }
\CommentTok{\#\textgreater{} 5 1     3     5{-}7{-}9}
\end{Highlighting}
\end{Shaded}

\section{å­—æ¯}\label{ux5b57ux6bcd}

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€äº›å‡½æ•°ï¼Œè¿™äº›å‡½æ•°å…è®¸ä½ å¤„ç†å­—ç¬¦ä¸²ä¸­çš„å•ä¸ªå­—æ¯ã€‚ä½ 
å°†å­¦ä¹ å¦‚ä½•æŸ¥æ‰¾å­—ç¬¦ä¸²çš„é•¿åº¦ã€æå–å­å­—ç¬¦ä¸²ä»¥åŠåœ¨å›¾å’Œè¡¨ä¸­å¤„ç†é•¿å­—ç¬¦ä¸²ã€‚

\subsection{é•¿åº¦}\label{ux957fux5ea6}

\texttt{str\_length()}å‘Šè¯‰ä½ å­—ç¬¦ä¸²ä¸­å­—æ¯çš„æ•°é‡:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_length}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"R for data science"}\NormalTok{, }\ConstantTok{NA}\NormalTok{))}
\CommentTok{\#\textgreater{} [1]  1 18 NA}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥ä½¿ç”¨\texttt{count()}æ¥æŸ¥æ‰¾ç¾å›½å©´å„¿åå­—é•¿åº¦çš„åˆ†å¸ƒæƒ…å†µï¼Œç„¶åä½¿ç”¨\texttt{filter()}æ¥æŸ¥çœ‹æœ€é•¿çš„åå­—ï¼Œè¿™äº›åå­—æ°å¥½æœ‰
15 ä¸ªå­—æ¯\footnote{çœ‹çœ‹è¿™äº›æ¡ç›®ï¼Œæˆ‘ä»¬çŒœæµ‹\texttt{babynames}æ•°æ®ä¼šçœç•¥ç©ºæ ¼æˆ–è¿å­—ç¬¦ï¼Œå¹¶åœ¨15ä¸ªå­—æ¯ä¹‹åæˆªæ–­ã€‚}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{babynames }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{count}\NormalTok{(}\AttributeTok{length =} \FunctionTok{str\_length}\NormalTok{(name), }\AttributeTok{wt =}\NormalTok{ n)}
\CommentTok{\#\textgreater{} \# A tibble: 14 x 2}
\CommentTok{\#\textgreater{}   length        n}
\CommentTok{\#\textgreater{}    \textless{}int\textgreater{}    \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1      2   338150}
\CommentTok{\#\textgreater{} 2      3  8589596}
\CommentTok{\#\textgreater{} 3      4 48506739}
\CommentTok{\#\textgreater{} 4      5 87011607}
\CommentTok{\#\textgreater{} 5      6 90749404}
\CommentTok{\#\textgreater{} 6      7 72120767}
\CommentTok{\#\textgreater{} \# i 8 more rows}

\NormalTok{babynames }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(}\FunctionTok{str\_length}\NormalTok{(name) }\SpecialCharTok{==} \DecValTok{15}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count}\NormalTok{(name, }\AttributeTok{wt =}\NormalTok{ n, }\AttributeTok{sort =} \ConstantTok{TRUE}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 34 x 2}
\CommentTok{\#\textgreater{}   name                n}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}           \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 Franciscojavier   123}
\CommentTok{\#\textgreater{} 2 Christopherjohn   118}
\CommentTok{\#\textgreater{} 3 Johnchristopher   118}
\CommentTok{\#\textgreater{} 4 Christopherjame   108}
\CommentTok{\#\textgreater{} 5 Christophermich    52}
\CommentTok{\#\textgreater{} 6 Ryanchristopher    45}
\CommentTok{\#\textgreater{} \# i 28 more rows}
\end{Highlighting}
\end{Shaded}

\subsection{æå–å­é›†}\label{ux63d0ux53d6ux5b50ux96c6}

ä½ å¯ä»¥ä½¿ç”¨\texttt{str\_sub(string,\ start,\ end)}æ¥æå–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œå…¶ä¸­\texttt{start}å’Œ\texttt{end}æ˜¯å­å­—ç¬¦ä¸²å¼€å§‹å’Œç»“æŸçš„ä½ç½®ã€‚\texttt{s}
\texttt{tart}å’Œ\texttt{end}å‚æ•°æ˜¯åŒ…å«æ€§çš„ï¼Œå› æ­¤è¿”å›çš„å­—ç¬¦ä¸²çš„é•¿åº¦å°†æ˜¯\texttt{end\ -\ start\ +\ 1}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Apple"}\NormalTok{, }\StringTok{"Banana"}\NormalTok{, }\StringTok{"Pear"}\NormalTok{)}
\FunctionTok{str\_sub}\NormalTok{(x, }\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "App" "Ban" "Pea"}
\end{Highlighting}
\end{Shaded}

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨è´Ÿå€¼æ¥ä»å­—ç¬¦ä¸²çš„æœ«å°¾å¼€å§‹è®¡æ•°ï¼š-1 æ˜¯æœ€åä¸€ä¸ªå­—ç¬¦ï¼Œ-2
æ˜¯å€’æ•°ç¬¬äºŒä¸ªå­—ç¬¦ï¼Œä¾æ­¤ç±»æ¨ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_sub}\NormalTok{(x, }\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "ple" "ana" "ear"}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„ï¼Œå¦‚æœå­—ç¬¦ä¸²å¤ªçŸ­ï¼Œ\texttt{str\_sub()}ä¸ä¼šå¤±è´¥ï¼Œå®ƒå°†è¿”å›å°½å¯èƒ½å¤šçš„å­—ç¬¦ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_sub}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{5}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "a"}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{str\_sub()}ä¸\texttt{mutate()}æ¥æ‰¾åˆ°æ¯ä¸ªåå­—çš„é¦–å­—æ¯å’Œæœ«å­—æ¯ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{babynames }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{first =} \FunctionTok{str\_sub}\NormalTok{(name, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{),}
    \AttributeTok{last =} \FunctionTok{str\_sub}\NormalTok{(name, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 1,924,665 x 7}
\CommentTok{\#\textgreater{}    year sex   name          n   prop first last }
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}chr\textgreater{} \textless{}chr\textgreater{}     \textless{}int\textgreater{}  \textless{}dbl\textgreater{} \textless{}chr\textgreater{} \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1  1880 F     Mary       7065 0.0724 M     y    }
\CommentTok{\#\textgreater{} 2  1880 F     Anna       2604 0.0267 A     a    }
\CommentTok{\#\textgreater{} 3  1880 F     Emma       2003 0.0205 E     a    }
\CommentTok{\#\textgreater{} 4  1880 F     Elizabeth  1939 0.0199 E     h    }
\CommentTok{\#\textgreater{} 5  1880 F     Minnie     1746 0.0179 M     e    }
\CommentTok{\#\textgreater{} 6  1880 F     Margaret   1578 0.0162 M     t    }
\CommentTok{\#\textgreater{} \# i 1,924,659 more rows}
\end{Highlighting}
\end{Shaded}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-38}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  åœ¨è®¡ç®—å©´å„¿åå­—é•¿åº¦çš„åˆ†å¸ƒæ—¶ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä½¿ç”¨ \texttt{wt\ =\ n}ï¼Ÿ
\item
  ä½¿ç”¨\texttt{str\_length()}å’Œ\texttt{str\_sub()}ä»æ¯ä¸ªå©´å„¿çš„åå­—ä¸­æå–ä¸­é—´çš„å­—æ¯ã€‚å¦‚æœå­—ç¬¦ä¸²æœ‰å¶æ•°ä¸ªå­—ç¬¦ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿ
\item
  éšç€æ—¶é—´çš„æ¨ç§»ï¼Œ\texttt{babynames}çš„é•¿åº¦æœ‰ä»€ä¹ˆä¸»è¦è¶‹åŠ¿å—ï¼Ÿé¦–å­—æ¯å’Œå°¾å­—æ¯çš„æµè¡Œç¨‹åº¦å¦‚ä½•ï¼Ÿ
\end{enumerate}

\section{éè‹±è¯­æ–‡æœ¬}\label{sec-other-languages}

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨è‹±æ–‡æ–‡æœ¬ï¼Œè¿™æ˜¯å› ä¸ºä¸¤ä¸ªåŸå› ä½¿å…¶ç‰¹åˆ«æ˜“äºå¤„ç†ã€‚é¦–
å…ˆï¼Œè‹±æ–‡å­—æ¯è¡¨ç›¸å¯¹ç®€å•ï¼šåªæœ‰26ä¸ªå­—æ¯ã€‚å…¶
æ¬¡ï¼ˆä¹Ÿè®¸æ˜¯æ›´é‡è¦çš„ï¼‰ï¼Œæˆ‘ä»¬ä»Šå¤©ä½¿ç”¨çš„è®¡ç®—åŸºç¡€è®¾æ–½ä¸»è¦æ˜¯ç”±è‹±è¯­ä½¿ç”¨è€…è®¾è®¡çš„ã€‚ä¸
å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬æ²¡æœ‰ç¯‡å¹…å…¨é¢ä»‹ç»éè‹±è¯­è¯­è¨€ã€‚ä¸
è¿‡ï¼Œæˆ‘ä»¬è¿˜æ˜¯æƒ³æé†’ä½ ä»¬æ³¨æ„å¯èƒ½ä¼šé‡åˆ°çš„ä¸€äº›æœ€å¤§æŒ‘æˆ˜ï¼šç¼–ç ã€å­—æ¯å˜åŒ–å’Œä¾èµ–äºåœ°åŒºçš„å‡½æ•°ã€‚

\subsection{ç¼–ç }\label{ux7f16ux7801}

åœ¨å¤„ç†éè‹±æ–‡æ–‡æœ¬æ—¶ï¼Œç¬¬ä¸€ä¸ªæŒ‘æˆ˜é€šå¸¸æ˜¯ç¼–ç ã€‚ä¸º
äº†äº†è§£æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ï¼Œæˆ‘ä»¬éœ€è¦æ·±å…¥äº†è§£è®¡ç®—æœºå¦‚ä½•è¡¨ç¤ºå­—ç¬¦ä¸²ã€‚åœ¨
Rä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{charToRaw()}æ¥è·å–å­—ç¬¦ä¸²çš„åº•å±‚è¡¨ç¤ºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{charToRaw}\NormalTok{(}\StringTok{"Hadley"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] 48 61 64 6c 65 79}
\end{Highlighting}
\end{Shaded}

è¿™å…­ä¸ªåå…­è¿›åˆ¶æ•°å­—ä¸­çš„æ¯ä¸€ä¸ªéƒ½ä»£è¡¨ä¸€ä¸ªå­—æ¯ï¼š\texttt{48} æ˜¯
Hï¼Œ\texttt{61} æ˜¯ aï¼Œä»¥æ­¤ç±»æ¨ã€‚ä»
åå…­è¿›åˆ¶æ•°å­—åˆ°å­—ç¬¦çš„æ˜ å°„ç§°ä¸ºç¼–ç ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™ç§ç¼–ç ç§°ä¸º ASCIIã€‚A
SCII åœ¨è¡¨ç¤ºè‹±æ–‡å­—ç¬¦æ–¹é¢åšå¾—å¾ˆå¥½ï¼Œå› ä¸ºå®ƒæ˜¯ç¾å›½ä¿¡æ¯äº¤æ¢æ ‡å‡†ä»£ç ï¼ˆAmerican
Standard Code for Information Interchangeï¼‰ã€‚

å¯¹äºéè‹±æ–‡è¯­è¨€æ¥è¯´ï¼Œäº‹æƒ…å°±æ²¡é‚£ä¹ˆç®€å•äº†ã€‚åœ¨
è®¡ç®—æœºå‘å±•çš„æ—©æœŸï¼Œæœ‰è®¸å¤šç›¸äº’ç«äº‰çš„æ ‡å‡†ç”¨äºç¼–ç éè‹±æ–‡å­—ç¬¦ã€‚ä¾‹
å¦‚ï¼Œæ¬§æ´²æœ‰ä¸¤ç§ä¸åŒçš„ç¼–ç ï¼šLatin1ï¼ˆä¹Ÿç§°ä¸º ISO-8859-1ï¼‰ç”¨äºè¥¿æ¬§è¯­è¨€ï¼Œè€Œ
Latin2ï¼ˆä¹Ÿç§°ä¸º ISO-8859-2ï¼‰ç”¨äºä¸­æ¬§è¯­è¨€ã€‚åœ¨ Latin1 ä¸­ï¼Œå­—èŠ‚ b1
æ˜¯``Â±''ï¼Œä½†åœ¨ Latin2 ä¸­ï¼Œå®ƒæ˜¯``Ä…''ï¼å¹¸
è¿çš„æ˜¯ï¼Œä»Šå¤©å‡ ä¹åœ¨æ‰€æœ‰åœ°æ–¹éƒ½æ”¯æŒä¸€ä¸ªæ ‡å‡†ï¼šUTF-8ã€‚U TF-8
å¯ä»¥ç¼–ç ä»Šå¤©äººç±»ä½¿ç”¨çš„å‡ ä¹æ‰€æœ‰å­—ç¬¦ï¼Œä»¥åŠè®¸å¤šé¢å¤–çš„ç¬¦å·ï¼Œå¦‚è¡¨æƒ…ç¬¦å·ã€‚

\texttt{readr}åœ¨æ‰€æœ‰åœ°æ–¹éƒ½ä½¿ç”¨ UTF-8ã€‚è¿™
æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é»˜è®¤è®¾ç½®ï¼Œä½†å¯¹äºä¸ä½¿ç”¨ UTF-8 çš„æ—§ç³»ç»Ÿç”Ÿæˆçš„æ•°æ®å°†ä¼šå¤±è´¥ã€‚å¦‚
æœå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œå½“ä½ è¾“å‡ºå­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä»¬çœ‹èµ·æ¥ä¼šå¾ˆå¥‡æ€ªã€‚æœ‰
æ—¶åªæ˜¯ä¸€ä¸ªæˆ–ä¸¤ä¸ªå­—ç¬¦å¯èƒ½ä¼šå‡ºé”™ï¼›åœ¨å…¶ä»–æ—¶å€™ï¼Œä½ ä¼šå¾—åˆ°å®Œå…¨ä¹±ç ã€‚ä¾‹
å¦‚ï¼Œä»¥ä¸‹æ˜¯ä¸¤ä¸ªå…·æœ‰å¼‚å¸¸ç¼–ç çš„å†…è” CSV\footnote{è¿™é‡Œæˆ‘ä½¿ç”¨ç‰¹æ®Šçš„\texttt{\textbackslash{}x}å°†äºŒè¿›åˆ¶æ•°æ®ç›´æ¥ç¼–ç ä¸ºå­—ç¬¦ä¸²ã€‚}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x1 }\OtherTok{\textless{}{-}} \StringTok{"text}\SpecialCharTok{\textbackslash{}n}\StringTok{El Ni}\SpecialCharTok{\textbackslash{}xf1}\StringTok{o was particularly bad this year"}
\FunctionTok{read\_csv}\NormalTok{(x1)}\SpecialCharTok{$}\NormalTok{text}
\CommentTok{\#\textgreater{} [1] "El Ni\textbackslash{}xf1o was particularly bad this year"}

\NormalTok{x2 }\OtherTok{\textless{}{-}} \StringTok{"text}\SpecialCharTok{\textbackslash{}n\textbackslash{}x82\textbackslash{}xb1\textbackslash{}x82\textbackslash{}xf1\textbackslash{}x82\textbackslash{}xc9\textbackslash{}x82\textbackslash{}xbf\textbackslash{}x82\textbackslash{}xcd}\StringTok{"}
\FunctionTok{read\_csv}\NormalTok{(x2)}\SpecialCharTok{$}\NormalTok{text}
\CommentTok{\#\textgreater{} [1] "\textbackslash{}x82\textbackslash{}xb1\textbackslash{}x82\textbackslash{}xf1\textbackslash{}x82É‚\textbackslash{}xbf\textbackslash{}x82\textbackslash{}xcd"}
\end{Highlighting}
\end{Shaded}

è¦æ­£ç¡®è¯»å–è¿™äº›ï¼Œæ‚¨å¯ä»¥é€šè¿‡\texttt{locale} å‚æ•°æŒ‡å®šç¼–ç :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{read\_csv}\NormalTok{(x1, }\AttributeTok{locale =} \FunctionTok{locale}\NormalTok{(}\AttributeTok{encoding =} \StringTok{"Latin1"}\NormalTok{))}\SpecialCharTok{$}\NormalTok{text}
\CommentTok{\#\textgreater{} [1] "El NiÃ±o was particularly bad this year"}

\FunctionTok{read\_csv}\NormalTok{(x2, }\AttributeTok{locale =} \FunctionTok{locale}\NormalTok{(}\AttributeTok{encoding =} \StringTok{"Shift{-}JIS"}\NormalTok{))}\SpecialCharTok{$}\NormalTok{text}
\CommentTok{\#\textgreater{} [1] "ã“ã‚“ã«ã¡ã¯"}
\end{Highlighting}
\end{Shaded}

å¦‚ä½•æ‰¾åˆ°æ­£ç¡®çš„ç¼–ç ï¼Ÿå¦‚
æœä½ å¾ˆå¹¸è¿ï¼Œå®ƒå¯èƒ½ä¼šåœ¨æ•°æ®æ–‡æ¡£ä¸­çš„æŸä¸ªåœ°æ–¹è¢«æåŠã€‚ä¸
å¹¸çš„æ˜¯ï¼Œè¿™ç§æƒ…å†µå¾ˆå°‘è§ï¼Œæ‰€ä»¥\texttt{readr}æä¾›äº†\texttt{guess\_encoding()}æ¥å¸®åŠ©ä½ æ‰¾å‡ºå®ƒã€‚è¿™
å¹¶ä¸æ˜¯ä¸‡æ— ä¸€å¤±çš„ï¼Œå¹¶ä¸”åœ¨æœ‰å¤§é‡æ–‡æœ¬æ—¶ï¼ˆä¸è¿™é‡Œä¸åŒï¼‰æ•ˆæœä¼šæ›´å¥½ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªåˆç†çš„èµ·ç‚¹ã€‚é¢„
è®¡åœ¨ä½ æ‰¾åˆ°æ­£ç¡®çš„ç¼–ç ä¹‹å‰ï¼Œéœ€è¦å°è¯•å‡ ç§ä¸åŒçš„ç¼–ç ã€‚

ç¼–ç æ˜¯ä¸€ä¸ªä¸°å¯Œä¸”å¤æ‚çš„è¯é¢˜ï¼›æˆ‘ä»¬åœ¨è¿™é‡Œåªæ˜¯è§¦åŠäº†çš®æ¯›ã€‚å¦‚
æœä½ æƒ³äº†è§£æ›´å¤šï¼Œæˆ‘ä»¬æ¨èé˜…è¯»~\url{http://kunststube.net/encoding/}ä¸Šçš„è¯¦ç»†è§£é‡Šã€‚

\subsection{\texorpdfstring{\textbf{å­—æ¯å˜ä½“}}{å­—æ¯å˜ä½“}}\label{ux5b57ux6bcdux53d8ux4f53}

åœ¨ä½¿ç”¨å¸¦æœ‰é‡éŸ³çš„è¯­è¨€æ—¶ï¼Œç¡®å®šå­—æ¯çš„ä½ç½®ï¼ˆä¾‹å¦‚ä½¿ç”¨\texttt{str\_length()}å’Œ\texttt{str\_sub()}ï¼‰ä¼šé¢ä¸´é‡å¤§æŒ‘æˆ˜ï¼Œå› ä¸ºé‡éŸ³å­—æ¯å¯èƒ½ä¼šè¢«ç¼–ç ä¸ºä¸€ä¸ªå•ç‹¬çš„å­—ç¬¦ï¼ˆä¾‹å¦‚ï¼ŒÃ¼ï¼‰æˆ–è€…é€šè¿‡å°†ä¸å¸¦é‡éŸ³çš„å­—æ¯ï¼ˆä¾‹å¦‚ï¼Œuï¼‰ä¸å˜éŸ³ç¬¦å·ï¼ˆä¾‹å¦‚ï¼ŒÂ¨ï¼‰ç»„åˆæˆä¸¤ä¸ªå­—ç¬¦æ¥è¡¨ç¤ºã€‚ä¾‹
å¦‚ï¼Œä»¥ä¸‹ä»£ç å±•ç¤ºäº†ä¸¤ç§çœ‹èµ·æ¥ç›¸åŒçš„è¡¨ç¤º Ã¼ çš„æ–¹å¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{u }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"\textbackslash{}u00fc"}\NormalTok{, }\StringTok{"u\textbackslash{}u0308"}\NormalTok{)}
\FunctionTok{str\_view}\NormalTok{(u)}
\CommentTok{\#\textgreater{} [1] | Ã¼}
\CommentTok{\#\textgreater{} [2] | uÌˆ}
\end{Highlighting}
\end{Shaded}

ä½†æ˜¯ä¸¤ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ä¸åŒï¼Œå®ƒä»¬çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¹Ÿä¸åŒ:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_length}\NormalTok{(u)}
\CommentTok{\#\textgreater{} [1] 1 2}
\FunctionTok{str\_sub}\NormalTok{(u, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "Ã¼" "u"}
\end{Highlighting}
\end{Shaded}

æœ€åï¼Œè¯·æ³¨æ„ï¼Œä½¿ç”¨\texttt{==}æ¥æ¯”è¾ƒè¿™äº›å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä»¬ä¼šè¢«è§£é‡Šä¸ºä¸åŒçš„å­—ç¬¦ä¸²ï¼Œè€Œ\texttt{stringr}åŒ…ä¸­çš„\texttt{str\_equal()}å‡½æ•°åˆ™ä¼šè¯†åˆ«å‡ºä¸¤è€…å…·æœ‰ç›¸åŒçš„å¤–è§‚ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{u[[}\DecValTok{1}\NormalTok{]] }\SpecialCharTok{==}\NormalTok{ u[[}\DecValTok{2}\NormalTok{]]}
\CommentTok{\#\textgreater{} [1] FALSE}

\FunctionTok{str\_equal}\NormalTok{(u[[}\DecValTok{1}\NormalTok{]], u[[}\DecValTok{2}\NormalTok{]])}
\CommentTok{\#\textgreater{} [1] TRUE}
\end{Highlighting}
\end{Shaded}

\subsection{åŒºåŸŸä¾èµ–å‡½æ•°}\label{ux533aux57dfux4f9dux8d56ux51fdux6570}

æœ€åï¼Œæœ‰ä¸€äº›\texttt{stringr}å‡½æ•°çš„è¡Œä¸ºå–å†³äºä½ çš„åŒºåŸŸï¼ˆlocaleï¼‰ã€‚åŒº
åŸŸç±»ä¼¼äºä¸€ç§è¯­è¨€ï¼Œä½†åŒ…æ‹¬ä¸€ä¸ªå¯é€‰çš„åŒºåŸŸæ ‡è¯†ç¬¦æ¥å¤„ç†è¯­è¨€å†…çš„åœ°åŒºå·®å¼‚ã€‚åŒº
åŸŸç”±å°å†™è¯­è¨€ç¼©å†™æŒ‡å®šï¼Œåé¢å¯ä»¥é€‰æ‹©æ€§åœ°è·Ÿä¸Šä¸€ä¸ªä¸‹åˆ’çº¿å’Œä¸€ä¸ªå¤§å†™åŒºåŸŸæ ‡è¯†ç¬¦ã€‚ä¾‹
å¦‚ï¼Œ``en''ä»£è¡¨è‹±è¯­ï¼Œ``en\_GB''ä»£è¡¨è‹±å›½è‹±è¯­ï¼Œè€Œ``en\_US''ä»£è¡¨ç¾å›½è‹±è¯­ã€‚å¦‚
æœä½ è¿˜ä¸çŸ¥é“ä½ çš„è¯­è¨€çš„ä»£ç ï¼Œ\href{https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes}{ç»´åŸºç™¾ç§‘}æœ‰ä¸€ä¸ªå¾ˆå¥½çš„åˆ—è¡¨ï¼Œä½ å¯ä»¥é€šè¿‡æŸ¥çœ‹\texttt{stringi::stri\_locale\_list()}æ¥æŸ¥çœ‹\texttt{stringr}æ”¯æŒå“ªäº›åŒºåŸŸã€‚

åŸºç¡€Rçš„å­—ç¬¦ä¸²å‡½æ•°ä¼šè‡ªåŠ¨ä½¿ç”¨ä½ çš„æ“ä½œç³»ç»Ÿè®¾ç½®çš„åŒºåŸŸã€‚è¿™
æ„å‘³ç€åŸºç¡€Rçš„å­—ç¬¦ä¸²å‡½æ•°ä¼šæŒ‰ç…§ä½ æœŸæœ›çš„æ–¹å¼å¤„ç†ä½ çš„è¯­è¨€ï¼Œä½†å¦‚æœä½ ä¸æ¥è‡ªä¸åŒå›½å®¶çš„äººåˆ†äº«ä½ çš„ä»£ç ï¼Œä»£ç çš„è¡Œä¸ºå¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ä¸º
äº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œstringré»˜è®¤ä½¿ç”¨``en''åŒºåŸŸï¼ˆå³è‹±è¯­è§„åˆ™ï¼‰ï¼Œå¹¶è¦æ±‚ä½ æŒ‡å®š\texttt{locale}
å‚æ•°æ¥è¦†ç›–å®ƒã€‚å¹¸
è¿çš„æ˜¯ï¼Œåªæœ‰ä¸¤ç»„å‡½æ•°åœ¨å¤„ç†æ—¶éœ€è¦è€ƒè™‘åŒºåŸŸï¼šæ”¹å˜å¤§å°å†™å’Œæ’åºã€‚

æ”¹å˜å¤§å°å†™çš„è§„åˆ™åœ¨ä¸åŒè¯­è¨€ä¹‹é—´æœ‰æ‰€ä¸åŒã€‚ä¾‹
å¦‚ï¼ŒåœŸè€³å…¶è¯­æœ‰ä¸¤ç§iï¼šå¸¦ç‚¹å’Œä¸å¸¦ç‚¹ã€‚ç”±
äºå®ƒä»¬æ˜¯ä¸¤ä¸ªä¸åŒçš„å­—æ¯ï¼Œæ‰€ä»¥å®ƒä»¬çš„å¤§å†™å½¢å¼ä¹Ÿä¸åŒï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_to\_upper}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"i"}\NormalTok{, }\StringTok{"Ä±"}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] "I" "I"}
\FunctionTok{str\_to\_upper}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"i"}\NormalTok{, }\StringTok{"Ä±"}\NormalTok{), }\AttributeTok{locale =} \StringTok{"tr"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "Ä°" "I"}
\end{Highlighting}
\end{Shaded}

å­—ç¬¦ä¸²æ’åºä¾èµ–äºå­—æ¯è¡¨çš„é¡ºåºï¼Œè€Œå­—æ¯è¡¨çš„é¡ºåºå¹¶ä¸æ˜¯æ¯ç§è¯­è¨€éƒ½ç›¸åŒçš„\footnote{åœ¨æ²¡æœ‰å­—æ¯è¡¨çš„è¯­è¨€ä¸­æ’åºï¼Œæ¯”å¦‚ä¸­æ–‡ï¼Œå°±æ›´åŠ å¤æ‚äº†ã€‚}ï¼
ä¸¾ä¸ªä¾‹å­ï¼šåœ¨æ·å…‹è¯­ä¸­ï¼Œ``ch''æ˜¯ä¸€ä¸ªå¤åˆå­—æ¯ï¼Œå®ƒåœ¨å­—æ¯è¡¨ä¸­å‡ºç°åœ¨å­—æ¯\texttt{h}ä¹‹åã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_sort}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"c"}\NormalTok{, }\StringTok{"ch"}\NormalTok{, }\StringTok{"h"}\NormalTok{, }\StringTok{"z"}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] "a"  "c"  "ch" "h"  "z"}
\FunctionTok{str\_sort}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"c"}\NormalTok{, }\StringTok{"ch"}\NormalTok{, }\StringTok{"h"}\NormalTok{, }\StringTok{"z"}\NormalTok{), }\AttributeTok{locale =} \StringTok{"cs"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "a"  "c"  "h"  "ch" "z"}
\end{Highlighting}
\end{Shaded}

This also comes up when sorting strings with \texttt{dplyr::arrange()},
which is why it also has a \texttt{locale} argument.

\section{å°ç»“}\label{ux5c0fux7ed3-13}

åœ¨æœ¬ç« ä¸­ï¼Œä½ å·²ç»äº†è§£äº†\texttt{stringr}åŒ…çš„ä¸€äº›å¼ºå¤§åŠŸèƒ½ï¼šå¦‚ä½•åˆ›å»ºã€ç»„åˆå’Œæå–å­—ç¬¦ä¸²ï¼Œä»¥åŠåœ¨ä½¿ç”¨éè‹±æ–‡å­—ç¬¦ä¸²æ—¶å¯èƒ½é‡åˆ°çš„ä¸€äº›æŒ‘æˆ˜ã€‚ç°
åœ¨æ˜¯æ—¶å€™å­¦ä¹ å¤„ç†å­—ç¬¦ä¸²çš„æœ€é‡è¦å’Œå¼ºå¤§çš„å·¥å…·ä¹‹ä¸€ï¼šæ­£åˆ™è¡¨è¾¾å¼äº†ã€‚æ­£
åˆ™è¡¨è¾¾å¼æ˜¯ä¸€ç§éå¸¸ç®€æ´ä½†éå¸¸å¯Œæœ‰è¡¨ç°åŠ›çš„è¯­è¨€ï¼Œç”¨äºæè¿°å­—ç¬¦ä¸²ä¸­çš„æ¨¡å¼ï¼Œå…¶æ˜¯ä¸‹ä¸€ç« è®¨è®ºçš„ä¸»é¢˜ã€‚

\chapter{æ­£åˆ™è¡¨è¾¾å¼}\label{sec-regular-expressions}

\section{å¼•è¨€}\label{ux5f15ux8a00-10}

åœ¨ ç« èŠ‚~\ref{sec-strings}
éƒ¨åˆ†ï¼Œä½ å­¦ä¹ äº†ä¸€ç³»åˆ—ç”¨äºå¤„ç†å­—ç¬¦ä¸²çš„æœ‰ç”¨å‡½æ•°ã€‚æœ¬
ç« å°†é‡ç‚¹ä»‹ç»ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„å‡½æ•°ï¼Œæ­£åˆ™è¡¨è¾¾å¼ï¼ˆregular
expressionï¼‰æ˜¯ä¸€ç§ç®€æ´è€Œå¼ºå¤§çš„è¯­è¨€ï¼Œç”¨äºæè¿°å­—ç¬¦ä¸²ä¸­çš„æ¨¡å¼ã€‚æœ¯
è¯­``æ­£åˆ™è¡¨è¾¾å¼''æœ‰ç‚¹é•¿ï¼Œæ‰€ä»¥å¤§å¤šæ•°äººå°†å…¶ç¼©å†™ä¸º``regex''\footnote{ä½ å¯ä»¥ç”¨ç¡¬éŸ³
  gï¼ˆreg-xï¼‰æˆ–è½¯éŸ³ gï¼ˆrej-xï¼‰æ¥å‘éŸ³ã€‚}æˆ–``regexp''ã€‚

æœ¬ç« é¦–å…ˆä»‹ç»æ­£åˆ™è¡¨è¾¾å¼çš„åŸºç¡€çŸ¥è¯†ä»¥åŠæ•°æ®åˆ†æä¸­æœ€æœ‰ç”¨çš„\texttt{stringr}å‡½æ•°ã€‚ç„¶
åï¼Œæˆ‘ä»¬å°†æ‰©å±•ä½ å¯¹æ¨¡å¼çš„äº†è§£ï¼Œå¹¶ä»‹ç»ä¸ƒä¸ªé‡è¦çš„æ–°ä¸»é¢˜ï¼ˆè½¬ä¹‰ã€é”šå®šã€å­—ç¬¦ç±»ã€ç®€å†™ç±»ã€é‡è¯ã€ä¼˜å…ˆçº§å’Œåˆ†ç»„ï¼‰ã€‚æ¥
ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†è®¨è®º\texttt{stringr}å‡½æ•°å¯ä»¥å¤„ç†çš„å…¶ä»–ç±»å‹çš„æ¨¡å¼ï¼Œä»¥åŠå…è®¸ä½ è°ƒæ•´æ­£åˆ™è¡¨è¾¾å¼æ“ä½œçš„å„ç§``æ ‡å¿—''ã€‚æœ€
åï¼Œæˆ‘ä»¬å°†æ¦‚è¿°tidyverseå’Œbase Rä¸­å¯èƒ½ä¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„å…¶ä»–åœ°æ–¹ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-10}

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨tidyverseçš„æ ¸å¿ƒæˆå‘˜stringrå’Œtidyrä¸­çš„æ­£åˆ™è¡¨è¾¾å¼å‡½æ•°ï¼Œä»¥åŠ\texttt{babynames}åŒ…ä¸­çš„æ•°æ®ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(babynames)}
\end{Highlighting}
\end{Shaded}

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨éå¸¸ç®€å•çš„å†…è”ç¤ºä¾‹çš„æ··åˆæ–¹å¼ï¼Œä»¥ä¾¿ä½ èƒ½å¤Ÿç†è§£åŸºæœ¬æ¦‚å¿µï¼Œè¿˜ä¼šä½¿ç”¨babynamesæ•°æ®é›†ä¸­çš„æ•°æ®ï¼Œä»¥åŠæ¥è‡ªstringrçš„ä¸‰ä¸ªå­—ç¬¦å‘é‡ï¼š

\begin{itemize}
\tightlist
\item
  \texttt{fruit} åŒ…å«äº†80ç§æ°´æœçš„åç§°ã€‚
\item
  \texttt{words} åŒ…å«äº†980ä¸ªå¸¸è§çš„è‹±è¯­å•è¯ã€‚
\item
  \texttt{sentences} åŒ…å«äº†720ä¸ªçŸ­å¥ã€‚
\end{itemize}

\section{æ¨¡å¼çš„åŸºç¡€}\label{sec-reg-basics}

æˆ‘ä»¬å°†ä½¿ç”¨\texttt{str\_view()}æ¥å­¦ä¹ æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚åœ¨
ä¸Šä¸€ç« ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨\texttt{str\_view()}æ¥æ›´å¥½åœ°ç†è§£å­—ç¬¦ä¸²ä¸å…¶è¾“å‡ºè¡¨ç¤ºä¹‹é—´çš„åŒºåˆ«ï¼Œç°åœ¨æˆ‘ä»¬å°†ä½¿ç”¨å®ƒçš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œå³æ­£åˆ™è¡¨è¾¾å¼ã€‚å½“
æä¾›è¿™ä¸ªå‚æ•°æ—¶ï¼Œ\texttt{str\_view()}å°†ä»…æ˜¾ç¤ºå­—ç¬¦ä¸²å‘é‡ä¸­åŒ¹é…çš„éƒ¨åˆ†ï¼Œå°†æ¯ä¸ªåŒ¹é…é¡¹ç”¨\texttt{\textless{}\ \textgreater{}}æ‹¬èµ·æ¥ï¼Œå¹¶åœ¨å¯èƒ½çš„æƒ…å†µä¸‹å°†åŒ¹é…é¡¹ä»¥è“è‰²é«˜äº®æ˜¾ç¤ºã€‚

æœ€ç®€å•çš„æ¨¡å¼ç”±å­—æ¯å’Œæ•°å­—ç»„æˆï¼Œå®ƒä»¬ä¼šç²¾ç¡®åŒ¹é…è¿™äº›å­—ç¬¦ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(fruit, }\StringTok{"berry"}\NormalTok{)}
\CommentTok{\#\textgreater{}  [6] | bil\textless{}berry\textgreater{}}
\CommentTok{\#\textgreater{}  [7] | black\textless{}berry\textgreater{}}
\CommentTok{\#\textgreater{} [10] | blue\textless{}berry\textgreater{}}
\CommentTok{\#\textgreater{} [11] | boysen\textless{}berry\textgreater{}}
\CommentTok{\#\textgreater{} [19] | cloud\textless{}berry\textgreater{}}
\CommentTok{\#\textgreater{} [21] | cran\textless{}berry\textgreater{}}
\CommentTok{\#\textgreater{} ... and 8 more}
\end{Highlighting}
\end{Shaded}

å­—æ¯å’Œæ•°å­—è¿›è¡Œç²¾ç¡®åŒ¹é…ï¼Œè¢«ç§°ä¸ºå­—é¢å­—ç¬¦ï¼ˆliteral charactersï¼‰ã€‚å¤§
å¤šæ•°æ ‡ç‚¹ç¬¦å·å­—ç¬¦ï¼Œå¦‚\texttt{.}ã€\texttt{+}ã€\texttt{*}ã€\texttt{{[}}ã€\texttt{{]}}å’Œ\texttt{?}
å…·æœ‰ç‰¹æ®Šå«ä¹‰\footnote{ä½ å°†åœ¨ å°èŠ‚~\ref{sec-regexp-escaping}
  ä¸­å­¦ä¹ å¦‚ä½•è½¬ä¹‰è¿™äº›ç‰¹æ®Šå«ä¹‰ã€‚}ï¼Œè¢«ç§°ä¸ºå…ƒå­—ç¬¦ï¼ˆmetacharactersï¼‰ã€‚
ä¾‹å¦‚ï¼Œ\texttt{.}å°†åŒ¹é…ä»»ä½•å­—ç¬¦\footnote{é™¤äº†\texttt{\textbackslash{}n}ä»¥å¤–çš„ä»»ä½•å­—ç¬¦ã€‚}ï¼Œæ‰€ä»¥
\texttt{"a."} å°†åŒ¹é…ä»»ä½•åŒ…å« ``a'' åé¢è·Ÿç€å¦ä¸€ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸² ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"ab"}\NormalTok{, }\StringTok{"ae"}\NormalTok{, }\StringTok{"bd"}\NormalTok{, }\StringTok{"ea"}\NormalTok{, }\StringTok{"eab"}\NormalTok{), }\StringTok{"a."}\NormalTok{)}
\CommentTok{\#\textgreater{} [2] | \textless{}ab\textgreater{}}
\CommentTok{\#\textgreater{} [3] | \textless{}ae\textgreater{}}
\CommentTok{\#\textgreater{} [6] | e\textless{}ab\textgreater{}}
\end{Highlighting}
\end{Shaded}

æˆ–è€…ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°æ‰€æœ‰åŒ…å«``a''ï¼Œåè·Ÿä¸‰ä¸ªå­—æ¯ï¼Œå†åè·Ÿ``e''çš„æ°´æœï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(fruit, }\StringTok{"a...e"}\NormalTok{)}
\CommentTok{\#\textgreater{}  [1] | \textless{}apple\textgreater{}}
\CommentTok{\#\textgreater{}  [7] | bl\textless{}ackbe\textgreater{}rry}
\CommentTok{\#\textgreater{} [48] | mand\textless{}arine\textgreater{}}
\CommentTok{\#\textgreater{} [51] | nect\textless{}arine\textgreater{}}
\CommentTok{\#\textgreater{} [62] | pine\textless{}apple\textgreater{}}
\CommentTok{\#\textgreater{} [64] | pomegr\textless{}anate\textgreater{}}
\CommentTok{\#\textgreater{} ... and 2 more}
\end{Highlighting}
\end{Shaded}

\textbf{é‡è¯ï¼ˆQuantifiersï¼‰} æ§åˆ¶æ¨¡å¼å¯ä»¥åŒ¹é…çš„æ¬¡æ•°ï¼š

\begin{itemize}
\tightlist
\item
  \texttt{?} ä½¿å¾—ä¸€ä¸ªæ¨¡å¼å˜ä¸ºå¯é€‰çš„ï¼ˆå³å®ƒåŒ¹é…0æ¬¡æˆ–1æ¬¡ï¼‰
\item
  \texttt{+} å…è®¸ä¸€ä¸ªæ¨¡å¼é‡å¤ï¼ˆå³å®ƒè‡³å°‘åŒ¹é…ä¸€æ¬¡ï¼‰
\item
  \texttt{*} å…è®¸ä¸€ä¸ªæ¨¡å¼å˜ä¸ºå¯é€‰çš„æˆ–é‡å¤ï¼ˆå³å®ƒåŒ¹é…ä»»æ„æ¬¡æ•°ï¼ŒåŒ…æ‹¬0æ¬¡ï¼‰
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ab? matches an "a", optionally followed by a "b".}
\FunctionTok{str\_view}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"ab"}\NormalTok{, }\StringTok{"abb"}\NormalTok{), }\StringTok{"ab?"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | \textless{}a\textgreater{}}
\CommentTok{\#\textgreater{} [2] | \textless{}ab\textgreater{}}
\CommentTok{\#\textgreater{} [3] | \textless{}ab\textgreater{}b}

\CommentTok{\# ab+ matches an "a", followed by at least one "b".}
\FunctionTok{str\_view}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"ab"}\NormalTok{, }\StringTok{"abb"}\NormalTok{), }\StringTok{"ab+"}\NormalTok{)}
\CommentTok{\#\textgreater{} [2] | \textless{}ab\textgreater{}}
\CommentTok{\#\textgreater{} [3] | \textless{}abb\textgreater{}}

\CommentTok{\# ab* matches an "a", followed by any number of "b"s.}
\FunctionTok{str\_view}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"ab"}\NormalTok{, }\StringTok{"abb"}\NormalTok{), }\StringTok{"ab*"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | \textless{}a\textgreater{}}
\CommentTok{\#\textgreater{} [2] | \textless{}ab\textgreater{}}
\CommentTok{\#\textgreater{} [3] | \textless{}abb\textgreater{}}
\end{Highlighting}
\end{Shaded}

\textbf{å­—ç¬¦ç±»ï¼ˆCharacter
classesï¼‰}ç”±\texttt{{[}{]}}å®šä¹‰ï¼Œå…è®¸ä½ åŒ¹é…ä¸€ç»„å­—ç¬¦ï¼Œä¾‹å¦‚ï¼Œ\texttt{{[}abcd{]}}åŒ¹é…``a''ã€``b''ã€``c''æˆ–``d''ã€‚ä½ 
ä¹Ÿå¯ä»¥é€šè¿‡åœ¨å¼€å¤´ä½¿ç”¨\texttt{\^{}}æ¥åè½¬åŒ¹é…ï¼š\texttt{{[}\^{}abcd{]}}åŒ¹é…é™¤``a''ã€``b''ã€``c''æˆ–``d''ä¹‹å¤–çš„ä»»ä½•å­—ç¬¦ã€‚æˆ‘
ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ€è·¯æ¥æŸ¥æ‰¾è¢«å…ƒéŸ³å­—æ¯åŒ…å›´çš„``x''ï¼Œæˆ–è€…è¢«è¾…éŸ³å­—æ¯åŒ…å›´çš„``y''ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(words, }\StringTok{"[aeiou]x[aeiou]"}\NormalTok{)}
\CommentTok{\#\textgreater{} [284] | \textless{}exa\textgreater{}ct}
\CommentTok{\#\textgreater{} [285] | \textless{}exa\textgreater{}mple}
\CommentTok{\#\textgreater{} [288] | \textless{}exe\textgreater{}rcise}
\CommentTok{\#\textgreater{} [289] | \textless{}exi\textgreater{}st}
\FunctionTok{str\_view}\NormalTok{(words, }\StringTok{"[\^{}aeiou]y[\^{}aeiou]"}\NormalTok{)}
\CommentTok{\#\textgreater{} [836] | \textless{}sys\textgreater{}tem}
\CommentTok{\#\textgreater{} [901] | \textless{}typ\textgreater{}e}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥ä½¿ç”¨\textbf{åˆ†éš”ç¬¦ï¼ˆalternationï¼‰}\texttt{\textbar{}}
åœ¨ä¸€ä¸ªæˆ–å¤šä¸ªå¤‡é€‰æ¨¡å¼ä¸­è¿›è¡Œé€‰æ‹©ã€‚ä¾‹
å¦‚ï¼Œä¸‹é¢çš„æ¨¡å¼ä¼šæŸ¥æ‰¾åŒ…å«``apple''ã€``melon''æˆ–``nut''ï¼Œæˆ–è€…ä¸€ä¸ªé‡å¤å…ƒéŸ³å­—æ¯çš„æ°´æœã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(fruit, }\StringTok{"apple|melon|nut"}\NormalTok{)}
\CommentTok{\#\textgreater{}  [1] | \textless{}apple\textgreater{}}
\CommentTok{\#\textgreater{} [13] | canary \textless{}melon\textgreater{}}
\CommentTok{\#\textgreater{} [20] | coco\textless{}nut\textgreater{}}
\CommentTok{\#\textgreater{} [52] | \textless{}nut\textgreater{}}
\CommentTok{\#\textgreater{} [62] | pine\textless{}apple\textgreater{}}
\CommentTok{\#\textgreater{} [72] | rock \textless{}melon\textgreater{}}
\CommentTok{\#\textgreater{} ... and 1 more}
\FunctionTok{str\_view}\NormalTok{(fruit, }\StringTok{"aa|ee|ii|oo|uu"}\NormalTok{)}
\CommentTok{\#\textgreater{}  [9] | bl\textless{}oo\textgreater{}d orange}
\CommentTok{\#\textgreater{} [33] | g\textless{}oo\textgreater{}seberry}
\CommentTok{\#\textgreater{} [47] | lych\textless{}ee\textgreater{}}
\CommentTok{\#\textgreater{} [66] | purple mangost\textless{}ee\textgreater{}n}
\end{Highlighting}
\end{Shaded}

æ­£åˆ™è¡¨è¾¾å¼éå¸¸ç´§å‡‘ï¼Œä½¿ç”¨äº†å¤§é‡æ ‡ç‚¹ç¬¦å·å­—ç¬¦ï¼Œæ‰€ä»¥ä¸€å¼€å§‹å¯èƒ½ä¼šæ˜¾å¾—è®©äººéš¾ä»¥ç†è§£å’Œéš¾ä»¥é˜…è¯»ã€‚ä¸
è¿‡ä¸ç”¨æ‹…å¿ƒï¼Œéšç€ä¸æ–­å®è·µï¼Œä½ ä¼šè¶Šæ¥è¶Šç†Ÿç»ƒï¼Œç®€å•çš„æ¨¡å¼å¾ˆå¿«å°±ä¼šå˜å¾—é©¾è½»å°±ç†Ÿã€‚è®©
æˆ‘ä»¬é€šè¿‡ç»ƒä¹ ä¸€äº›æœ‰ç”¨çš„\texttt{stringr}å‡½æ•°æ¥å¼€å§‹è¿™ä¸ªè¿‡ç¨‹å§ã€‚

\section{å…³é”®å‡½æ•°}\label{sec-stringr-regex-funs}

æ—¢ç„¶ä½ å·²ç»æŒæ¡äº†æ­£åˆ™è¡¨è¾¾å¼çš„åŸºç¡€çŸ¥è¯†ï¼Œæ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬ä½¿ç”¨\texttt{stringr}å’Œ\texttt{tidyr}å‡½æ•°æ¥åº”ç”¨å®ƒä»¬å§ã€‚åœ¨
ä»¥ä¸‹éƒ¨åˆ†ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•æ£€æµ‹åŒ¹é…é¡¹æ˜¯å¦å­˜åœ¨ï¼Œå¦‚ä½•è®¡ç®—åŒ¹é…é¡¹çš„æ•°é‡ï¼Œå¦‚ä½•ç”¨å›ºå®šæ–‡æœ¬æ›¿æ¢åŒ¹é…é¡¹ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨æ¨¡å¼æ¥æå–æ–‡æœ¬ã€‚

\subsection{æ£€æµ‹åŒ¹é…é¡¹}\label{ux68c0ux6d4bux5339ux914dux9879}

\texttt{str\_detect()}
å‡½æ•°è¿”å›ä¸€ä¸ªé€»è¾‘å‘é‡ï¼Œå¦‚æœæ¨¡å¼ä¸å­—ç¬¦å‘é‡ä¸­çš„æŸä¸ªå…ƒç´ åŒ¹é…ï¼Œåˆ™è¿”å›\texttt{TRUE}ï¼Œå¦åˆ™è¿”å›\texttt{FALSE}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_detect}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"b"}\NormalTok{, }\StringTok{"c"}\NormalTok{), }\StringTok{"[aeiou]"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1]  TRUE FALSE FALSE}
\end{Highlighting}
\end{Shaded}

ç”±äº\texttt{str\_detect()}è¿”å›ä¸€ä¸ªä¸åˆå§‹å‘é‡é•¿åº¦ç›¸åŒçš„é€»è¾‘å‘é‡ï¼Œå› æ­¤èƒ½ä¸\texttt{filter()}æ­é…å¾ˆå¥½ã€‚ä¾‹
å¦‚ï¼Œè¿™æ®µä»£ç ç”¨äºæŸ¥æ‰¾æ‰€æœ‰åŒ…å«å°å†™å­—æ¯''x''çš„æœ€å—æ¬¢è¿çš„åå­—ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{babynames }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(}\FunctionTok{str\_detect}\NormalTok{(name, }\StringTok{"x"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count}\NormalTok{(name, }\AttributeTok{wt =}\NormalTok{ n, }\AttributeTok{sort =} \ConstantTok{TRUE}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 974 x 2}
\CommentTok{\#\textgreater{}   name           n}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}      \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 Alexander 665492}
\CommentTok{\#\textgreater{} 2 Alexis    399551}
\CommentTok{\#\textgreater{} 3 Alex      278705}
\CommentTok{\#\textgreater{} 4 Alexandra 232223}
\CommentTok{\#\textgreater{} 5 Max       148787}
\CommentTok{\#\textgreater{} 6 Alexa     123032}
\CommentTok{\#\textgreater{} \# i 968 more rows}
\end{Highlighting}
\end{Shaded}

è¿˜å¯ä»¥é€šè¿‡å°†\texttt{str\_detect()}ä¸\texttt{summarize()}ç»“åˆï¼Œå¹¶æ­é…\texttt{sum()}æˆ–\texttt{mean()}æ¥ä½¿ç”¨ã€‚\texttt{s}
\texttt{um(str\_detect(x,\ pattern))}å‘Šè¯‰ä½ åŒ¹é…çš„è§‚æµ‹çš„æ•°é‡ï¼Œè€Œ\texttt{mean(str\_detect(x,\ pattern))}å‘Šè¯‰ä½ åŒ¹é…çš„æ¯”ä¾‹ã€‚ä¾‹
å¦‚ï¼Œä»¥ä¸‹ä»£ç æ®µè®¡ç®—å’Œå¯è§†åŒ–äº†æŒ‰å¹´ä»½åˆ’åˆ†çš„å©´å„¿åå­—\footnote{è¿™ç»™å‡ºäº†åŒ…å«''x''çš„åå­—çš„æ¯”ä¾‹ï¼›å¦‚æœä½ æƒ³è¦çŸ¥é“åå­—ä¸­åŒ…å«''x''çš„å©´å„¿çš„æ¯”ä¾‹ï¼Œä½ éœ€è¦è®¡ç®—ä¸€ä¸ªåŠ æƒå¹³å‡å€¼ã€‚}
åŒ…å«''x''çš„æ¯”ä¾‹ã€‚ çœ‹æ¥æœ€è¿‘å®ƒä»¬çš„å—æ¬¢è¿ç¨‹åº¦å¤§å¹…å¢åŠ äº†ï¼

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{babynames }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(year) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{prop\_x =} \FunctionTok{mean}\NormalTok{(}\FunctionTok{str\_detect}\NormalTok{(name, }\StringTok{"x"}\NormalTok{))) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ year, }\AttributeTok{y =}\NormalTok{ prop\_x)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{regexps_files/figure-pdf/unnamed-chunk-11-1.pdf}

ä¸\texttt{str\_detect()}å¯†åˆ‡ç›¸å…³çš„ä¸¤ä¸ªå‡½æ•°æ˜¯\texttt{str\_subset()}å’Œ\texttt{str\_which()}ã€‚\texttt{s}
\texttt{tr\_subset()}è¿”å›ä¸€ä¸ªåªåŒ…å«åŒ¹é…å­—ç¬¦ä¸²çš„å­—ç¬¦å‘é‡ï¼›\texttt{str\_which()}è¿”å›ä¸€ä¸ªç»™å‡ºåŒ¹é…å­—ç¬¦ä¸²ä½ç½®çš„æ•´æ•°å‘é‡ã€‚

\subsection{åŒ¹é…æ¬¡æ•°}\label{ux5339ux914dux6b21ux6570}

ä»å¤æ‚åº¦æ¥çœ‹ï¼Œæ¯”\texttt{str\_detect()}æ›´è¿›ä¸€æ­¥çš„æ˜¯\texttt{str\_count()}ï¼šå®ƒä¸ä»…ä»…å‘Šè¯‰ä½ åŒ¹é…ä¸å¦ï¼Œè¿˜ä¼šå‘Šè¯‰ä½ æ¯ä¸ªå­—ç¬¦ä¸²ä¸­æœ‰å¤šå°‘åŒ¹é…é¡¹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"apple"}\NormalTok{, }\StringTok{"banana"}\NormalTok{, }\StringTok{"pear"}\NormalTok{)}
\FunctionTok{str\_count}\NormalTok{(x, }\StringTok{"p"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] 2 0 1}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„ï¼Œæ¯ä¸ªåŒ¹é…éƒ½ä»ä¸Šä¸€ä¸ªåŒ¹é…çš„æœ«å°¾å¼€å§‹ï¼Œå³æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æ°¸è¿œä¸ä¼šé‡å ã€‚ä¾‹
å¦‚ï¼Œåœ¨\texttt{"abababa"}ä¸­ï¼Œ\texttt{"aba"}æ¨¡å¼å°†åŒ¹é…å¤šå°‘æ¬¡ï¼Ÿæ­£
åˆ™è¡¨è¾¾å¼è¯´æ˜¯ä¸¤æ¬¡ï¼Œè€Œä¸æ˜¯ä¸‰æ¬¡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_count}\NormalTok{(}\StringTok{"abababa"}\NormalTok{, }\StringTok{"aba"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] 2}
\FunctionTok{str\_view}\NormalTok{(}\StringTok{"abababa"}\NormalTok{, }\StringTok{"aba"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | \textless{}aba\textgreater{}b\textless{}aba\textgreater{}}
\end{Highlighting}
\end{Shaded}

\texttt{str\_count()}ä¸\texttt{mutate()}ç»“åˆä½¿ç”¨æ˜¯å¾ˆè‡ªç„¶çš„ã€‚ä¸‹
é¢çš„ç¤ºä¾‹ä½¿ç”¨\texttt{str\_count()}ä¸å­—ç¬¦ç±»æ¥è®¡ç®—æ¯ä¸ªåå­—ä¸­çš„å…ƒéŸ³å’Œè¾…éŸ³å­—æ¯çš„æ•°é‡ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{babynames }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count}\NormalTok{(name) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{vowels =} \FunctionTok{str\_count}\NormalTok{(name, }\StringTok{"[aeiou]"}\NormalTok{),}
    \AttributeTok{consonants =} \FunctionTok{str\_count}\NormalTok{(name, }\StringTok{"[\^{}aeiou]"}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 97,310 x 4}
\CommentTok{\#\textgreater{}   name          n vowels consonants}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}     \textless{}int\textgreater{}  \textless{}int\textgreater{}      \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 Aaban        10      2          3}
\CommentTok{\#\textgreater{} 2 Aabha         5      2          3}
\CommentTok{\#\textgreater{} 3 Aabid         2      2          3}
\CommentTok{\#\textgreater{} 4 Aabir         1      2          3}
\CommentTok{\#\textgreater{} 5 Aabriella     5      4          5}
\CommentTok{\#\textgreater{} 6 Aada          1      2          2}
\CommentTok{\#\textgreater{} \# i 97,304 more rows}
\end{Highlighting}
\end{Shaded}

å¦‚æœä»”ç»†è§‚å¯Ÿï¼Œä½ ä¼šæ³¨æ„åˆ°æˆ‘ä»¬çš„è®¡ç®—æœ‰äº›é—®é¢˜ï¼š``Aaban'' åŒ…å«ä¸‰ä¸ª
``a''ï¼Œä½†æˆ‘ä»¬çš„æ±‡æ€»æŠ¥å‘Šåªæ˜¾ç¤ºäº†ä¸¤ä¸ªå…ƒéŸ³å­—æ¯ã€‚è¿™
æ˜¯å› ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ˜¯åŒºåˆ†å¤§å°å†™çš„ã€‚æœ‰ ä¸‰ç§æ–¹æ³•å¯ä»¥ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼š

\begin{itemize}
\item
  å°†å¤§å†™å…ƒéŸ³å­—æ¯æ·»åŠ åˆ°å­—ç¬¦ç±»ä¸­ï¼š

  \texttt{str\_count(name,\ "{[}aeiouAEIOU{]}")}ã€‚
\item
  å‘Šè¯‰æ­£åˆ™è¡¨è¾¾å¼å¿½ç•¥å¤§å°å†™ï¼š

  \texttt{str\_count(name,\ regex("{[}aeiou{]}",\ ignore\_case\ =\ TRUE))}ã€‚

  æˆ‘ä»¬å°†åœ¨ å°èŠ‚~\ref{sec-flags} è®¨è®ºæ›´å¤šå†…å®¹ã€‚
\item
  ä½¿ç”¨\texttt{str\_to\_lower()}å°†åå­—è½¬æ¢ä¸ºå°å†™ï¼š

  \texttt{str\_count(str\_to\_lower(name),\ "{[}aeiou{]}")}ã€‚
\end{itemize}

åœ¨å¤„ç†å­—ç¬¦ä¸²æ—¶ï¼Œè¿™ç§å¤šæ ·åŒ–çš„æ–¹æ³•æ˜¯éå¸¸å…¸å‹çš„------é€šå¸¸æœ‰å¤šç§æ–¹å¼å¯ä»¥è¾¾åˆ°ä½ çš„ç›®æ ‡ï¼Œè¦ä¹ˆæ˜¯é€šè¿‡ä½¿ä½ çš„æ¨¡å¼æ›´å¤æ‚ï¼Œè¦ä¹ˆæ˜¯å¯¹ä½ çš„å­—ç¬¦ä¸²è¿›è¡Œä¸€äº›é¢„å¤„ç†ã€‚å¦‚
æœä½ åœ¨ä½¿ç”¨ä¸€ç§æ–¹æ³•æ—¶é‡åˆ°å›°éš¾ï¼Œä»å¦ä¸€ä¸ªè§’åº¦è§£å†³é—®é¢˜å¾€å¾€æ˜¯æœ‰ç”¨çš„ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äºæˆ‘ä»¬å¯¹åå­—åº”ç”¨äº†ä¸¤ä¸ªå‡½æ•°ï¼Œæˆ‘è®¤ä¸ºå…ˆè½¬æ¢å®ƒæ›´å®¹æ˜“ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{babynames }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count}\NormalTok{(name) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{name =} \FunctionTok{str\_to\_lower}\NormalTok{(name),}
    \AttributeTok{vowels =} \FunctionTok{str\_count}\NormalTok{(name, }\StringTok{"[aeiou]"}\NormalTok{),}
    \AttributeTok{consonants =} \FunctionTok{str\_count}\NormalTok{(name, }\StringTok{"[\^{}aeiou]"}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 97,310 x 4}
\CommentTok{\#\textgreater{}   name          n vowels consonants}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}     \textless{}int\textgreater{}  \textless{}int\textgreater{}      \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 aaban        10      3          2}
\CommentTok{\#\textgreater{} 2 aabha         5      3          2}
\CommentTok{\#\textgreater{} 3 aabid         2      3          2}
\CommentTok{\#\textgreater{} 4 aabir         1      3          2}
\CommentTok{\#\textgreater{} 5 aabriella     5      5          4}
\CommentTok{\#\textgreater{} 6 aada          1      3          1}
\CommentTok{\#\textgreater{} \# i 97,304 more rows}
\end{Highlighting}
\end{Shaded}

\subsection{æ›¿æ¢å€¼}\label{ux66ffux6362ux503c}

é™¤äº†æ£€æµ‹å’Œè®¡ç®—åŒ¹é…é¡¹ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨\texttt{str\_replace()}å’Œ\texttt{str\_replace\_all()}æ¥ä¿®æ”¹å®ƒä»¬ã€‚\texttt{s}
\texttt{tr\_replace()}æ›¿æ¢ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ï¼Œå¦‚å…¶åæ‰€ç¤ºï¼›\texttt{str\_replace\_all()}åˆ™ä¼šæ›¿æ¢æ‰€æœ‰åŒ¹é…é¡¹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"apple"}\NormalTok{, }\StringTok{"pear"}\NormalTok{, }\StringTok{"banana"}\NormalTok{)}
\FunctionTok{str\_replace\_all}\NormalTok{(x, }\StringTok{"[aeiou]"}\NormalTok{, }\StringTok{"{-}"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "{-}ppl{-}"  "p{-}{-}r"   "b{-}n{-}n{-}"}
\end{Highlighting}
\end{Shaded}

\texttt{str\_remove()} and \texttt{str\_remove\_all()} are handy
shortcuts for \texttt{str\_replace(x,\ pattern,\ "")}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"apple"}\NormalTok{, }\StringTok{"pear"}\NormalTok{, }\StringTok{"banana"}\NormalTok{)}
\FunctionTok{str\_remove\_all}\NormalTok{(x, }\StringTok{"[aeiou]"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "ppl" "pr"  "bnn"}
\end{Highlighting}
\end{Shaded}

åœ¨è¿›è¡Œæ•°æ®æ¸…æ´—æ—¶ï¼Œè¿™äº›å‡½æ•°é€šå¸¸ä¼šä¸\texttt{mutate()}ä¸€èµ·ä½¿ç”¨ï¼Œå¹¶ä¸”ä½ ä¼šç»å¸¸åå¤åº”ç”¨å®ƒä»¬æ¥æ¶ˆé™¤ä¸ä¸€è‡´æ ¼å¼çš„å¤šå±‚ç»“æ„ã€‚

\subsection{æå–å˜é‡}\label{sec-extract-variables}

æˆ‘ä»¬è¦è®¨è®ºçš„æœ€åä¸€ä¸ªå‡½æ•°\texttt{separate\_wider\_regex()}ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å°†æ•°æ®ä»ä¸€ä¸ªåˆ—æå–åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªæ–°åˆ—ä¸­ã€‚å®ƒ
ä¸ä½ åœ¨ å°èŠ‚~\ref{sec-string-columns}
ä¸­äº†è§£çš„\texttt{separate\_wider\_position()}å’Œ\texttt{separate\_wider\_delim()}æ˜¯åŒç±»å‡½æ•°ã€‚è¿™
äº›å‡½æ•°å­˜åœ¨äº\texttt{tidyr}ä¸­ï¼Œå› ä¸ºå®ƒä»¬æ“ä½œçš„æ˜¯æ•°æ®æ¡†ï¼ˆçš„åˆ—ï¼‰ï¼Œè€Œä¸æ˜¯å•ç‹¬çš„å‘é‡ã€‚

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„æ•°æ®é›†æ¥å±•ç¤ºå®ƒçš„å·¥ä½œåŸç†ã€‚è¿™
é‡Œæˆ‘ä»¬æœ‰ä¸€äº›ä»\texttt{babynames}æ´¾ç”Ÿçš„æ•°æ®ï¼Œå…¶ä¸­åŒ…å«äº†ä¸€äº›äººçš„åå­—ã€æ€§åˆ«å’Œå¹´é¾„ï¼Œä½†è¿™äº›æ•°æ®çš„æ ¼å¼ç›¸å½“å¥‡æ€ªçš„\footnote{æˆ‘ä»¬å¸Œæœ›èƒ½å‘ä½ ä¿è¯ï¼Œåœ¨ç°å®ç”Ÿæ´»ä¸­ä½ æ°¸è¿œä¸ä¼šçœ‹åˆ°è¿™ç§å¥‡æ€ªçš„æ•°æ®æ ¼å¼ï¼›ä½†ä¸å¹¸çš„æ˜¯ï¼Œåœ¨ä½ çš„èŒä¸šç”Ÿæ¶¯ä¸­ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°æ¯”è¿™æ›´å¥‡æ€ªçš„æ•°æ®æ ¼å¼ï¼}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{str,}
  \StringTok{"\textless{}Sheryl\textgreater{}{-}F\_34"}\NormalTok{,}
  \StringTok{"\textless{}Kisha\textgreater{}{-}F\_45"}\NormalTok{, }
  \StringTok{"\textless{}Brandon\textgreater{}{-}N\_33"}\NormalTok{,}
  \StringTok{"\textless{}Sharon\textgreater{}{-}F\_38"}\NormalTok{, }
  \StringTok{"\textless{}Penny\textgreater{}{-}F\_58"}\NormalTok{,}
  \StringTok{"\textless{}Justin\textgreater{}{-}M\_41"}\NormalTok{, }
  \StringTok{"\textless{}Patricia\textgreater{}{-}F\_84"}\NormalTok{, }
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

è¦ä½¿ç”¨\texttt{separate\_wider\_regex()}æå–è¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬åªéœ€è¦æ„å»ºä¸€ç³»åˆ—ä¸æ¯ä¸ªéƒ¨åˆ†åŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚å¦‚
æœå¸Œæœ›è¯¥éƒ¨åˆ†å†…å®¹å‡ºç°åœ¨è¾“å‡ºä¸­ï¼Œç»™å®ƒæŒ‡å®šä¸€ä¸ªåç§°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{separate\_wider\_regex}\NormalTok{(}
\NormalTok{    str,}
    \AttributeTok{patterns =} \FunctionTok{c}\NormalTok{(}
      \StringTok{"\textless{}"}\NormalTok{, }
      \AttributeTok{name =} \StringTok{"[A{-}Za{-}z]+"}\NormalTok{, }
      \StringTok{"\textgreater{}{-}"}\NormalTok{, }
      \AttributeTok{gender =} \StringTok{"."}\NormalTok{,}
      \StringTok{"\_"}\NormalTok{,}
      \AttributeTok{age =} \StringTok{"[0{-}9]+"}
\NormalTok{    )}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 7 x 3}
\CommentTok{\#\textgreater{}   name    gender age  }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}   \textless{}chr\textgreater{}  \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 Sheryl  F      34   }
\CommentTok{\#\textgreater{} 2 Kisha   F      45   }
\CommentTok{\#\textgreater{} 3 Brandon N      33   }
\CommentTok{\#\textgreater{} 4 Sharon  F      38   }
\CommentTok{\#\textgreater{} 5 Penny   F      58   }
\CommentTok{\#\textgreater{} 6 Justin  M      41   }
\CommentTok{\#\textgreater{} \# i 1 more row}
\end{Highlighting}
\end{Shaded}

å¦‚æœåŒ¹é…å¤±è´¥ï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{too\_few\ =\ "debug"}æ¥æ‰¾å‡ºé—®é¢˜æ‰€åœ¨ï¼Œå°±åƒ\texttt{separate\_wider\_delim()}å’Œ\texttt{separate\_wider\_position()}ä¸€æ ·ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-39}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  å“ªä¸ªå©´å„¿åå­—ä¸­å«æœ‰çš„å…ƒéŸ³å­—æ¯æœ€å¤šï¼Ÿå“ª ä¸ªåå­—çš„å…ƒéŸ³å­—æ¯æ¯”ä¾‹æœ€é«˜ï¼Ÿï¼ˆ
  æç¤ºï¼šåˆ†æ¯æ˜¯ä»€ä¹ˆï¼Ÿï¼‰
\item
  å°† \texttt{"a/b/c/d/e"}
  ä¸­çš„æ‰€æœ‰æ­£æ–œæ ï¼ˆ/ï¼‰æ›¿æ¢ä¸ºåæ–œæ ï¼ˆ\textbackslashï¼‰ã€‚å¦‚ æœ
  è¯•å›¾é€šè¿‡å°†æ‰€æœ‰åæ–œæ æ›¿æ¢ä¸ºæ­£æ–œæ æ¥æ’¤é”€è¿™ä¸ªè½¬æ¢ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿï¼ˆ
  æˆ‘ä»¬å¾ˆå¿«å°±ä¼šè®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚ï¼‰
\item
  ä½¿ç”¨\texttt{str\_replace\_all()}å®ç°ä¸€ä¸ªç®€å•çš„\texttt{str\_to\_lower()}ç‰ˆæœ¬ã€‚
\item
  åˆ›å»ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨æ¥åŒ¹é…ä½ æ‰€åœ¨å›½å®¶å¸¸è§çš„ç”µè¯å·ç ä¹¦å†™æ–¹å¼ã€‚
\end{enumerate}

\section{æ¨¡å¼çš„ç»†èŠ‚}\label{ux6a21ux5f0fux7684ux7ec6ux8282}

ç°åœ¨ä½ å·²ç»äº†è§£äº†æ¨¡å¼è¯­è¨€çš„åŸºç¡€çŸ¥è¯†ï¼Œä»¥åŠå¦‚ä½•å°†å…¶ä¸ä¸€äº›\texttt{stringr}å’Œ\texttt{tidyr}å‡½æ•°ä¸€èµ·ä½¿ç”¨ï¼Œç°åœ¨æ˜¯æ—¶å€™æ·±å…¥äº†è§£æ›´å¤šç»†èŠ‚äº†ã€‚é¦–
å…ˆï¼Œæˆ‘ä»¬å°†ä»è½¬ä¹‰ï¼ˆ\textbf{escaping}ï¼‰å¼€å§‹ï¼Œå®ƒå…è®¸ä½ åŒ¹é…é€šå¸¸ä¼šè¢«ç‰¹æ®Šå¤„ç†çš„å…ƒå­—ç¬¦ã€‚æ¥
ä¸‹æ¥ï¼Œä½ å°†å­¦ä¹ é”šç‚¹ï¼ˆ\textbf{anchors}ï¼‰ï¼Œå®ƒå…è®¸ä½ åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹æˆ–ç»“æŸã€‚ç„¶
åï¼Œä½ å°†æ›´æ·±å…¥åœ°äº†è§£å­—ç¬¦ç±»ï¼ˆ\textbf{character
classes}ï¼‰å’Œå®ƒä»¬çš„å¿«æ·æ–¹å¼ï¼Œå®ƒä»¬å…è®¸ä½ åŒ¹é…é›†åˆä¸­çš„ä»»ä½•å­—ç¬¦ã€‚æ¥
ç€ï¼Œä½ å°†å­¦ä¹ é‡è¯ï¼ˆ\textbf{quantifiers}ï¼‰çš„æœ€åä¸€äº›ç»†èŠ‚ï¼Œå®ƒä»¬æ§åˆ¶æ¨¡å¼å¯ä»¥åŒ¹é…å¤šå°‘æ¬¡ã€‚ä¹‹
åï¼Œæˆ‘ä»¬å¿…é¡»è¦†ç›–é‡è¦ï¼ˆä½†å¤æ‚ï¼‰çš„ä¸»é¢˜ï¼Œå³è¿ç®—ç¬¦ä¼˜å…ˆçº§ï¼ˆ\textbf{operator
precedence}ï¼‰å’Œæ‹¬å·ã€‚æœ€
åï¼Œæˆ‘ä»¬å°†ä»¥æ¨¡å¼åˆ†ç»„ï¼ˆ\textbf{grouping}ï¼‰ç»„ä»¶çš„ä¸€äº›ç»†èŠ‚ç»“æŸã€‚

æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨çš„æœ¯è¯­æ˜¯æ¯ä¸ªç»„ä»¶çš„æŠ€æœ¯åç§°ã€‚å®ƒ
ä»¬å¹¶ä¸æ€»æ˜¯æœ€èƒ½ä½“ç°å…¶ç›®çš„ï¼Œä½†å¦‚æœä½ ä»¥åæƒ³åœ¨ç½‘ä¸Šæœç´¢æ›´å¤šç»†èŠ‚ï¼ŒçŸ¥é“æ­£ç¡®çš„æœ¯è¯­ä¼šå¾ˆæœ‰å¸®åŠ©ã€‚

\subsection{è½¬ä¹‰}\label{sec-regexp-escaping}

ä¸ºäº†åŒ¹é…å­—é¢ä¸Šçš„\texttt{.}ï¼Œä½ éœ€è¦ä¸€ä¸ªè½¬ä¹‰ç¬¦ï¼Œå®ƒå‘Šè¯‰æ­£åˆ™è¡¨è¾¾å¼è¦ä»å­—é¢ä¸ŠåŒ¹é…å…ƒå­—ç¬¦\footnote{å…ƒå­—ç¬¦çš„å®Œå¤‡é›†ä¸º
  \texttt{.\^{}\$\textbackslash{}\textbar{}*+?\{\}{[}{]}()}}ã€‚
å’Œå­—ç¬¦ä¸²ä¸€æ ·ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨åæ–œæ è¿›è¡Œè½¬ä¹‰ã€‚
å› æ­¤ï¼Œè¦åŒ¹é…\texttt{.}ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¸º\texttt{\textbackslash{}.}ã€‚ä¸å¹¸çš„æ˜¯è¿™ä¼šé€ æˆä¸€ä¸ªé—®é¢˜ã€‚
æˆ‘ä»¬ä½¿ç”¨å­—ç¬¦ä¸²æ¥è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œè€Œ\texttt{\textbackslash{}}ä¹Ÿåœ¨å­—ç¬¦ä¸²ä¸­ç”¨ä½œè½¬ä¹‰ç¬¦ã€‚
å› æ­¤ï¼Œè¦åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼\texttt{\textbackslash{}.}ï¼Œæˆ‘ä»¬éœ€è¦å­—ç¬¦ä¸²\texttt{"\textbackslash{}\textbackslash{}."}ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# To create the regular expression \textbackslash{}., we need to use \textbackslash{}\textbackslash{}.}
\NormalTok{dot }\OtherTok{\textless{}{-}} \StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{."}

\CommentTok{\# But the expression itself only contains one \textbackslash{}}
\FunctionTok{str\_view}\NormalTok{(dot)}
\CommentTok{\#\textgreater{} [1] | \textbackslash{}.}

\CommentTok{\# And this tells R to look for an explicit .}
\FunctionTok{str\_view}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"abc"}\NormalTok{, }\StringTok{"a.c"}\NormalTok{, }\StringTok{"bef"}\NormalTok{), }\StringTok{"a}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{.c"}\NormalTok{)}
\CommentTok{\#\textgreater{} [2] | \textless{}a.c\textgreater{}}
\end{Highlighting}
\end{Shaded}

åœ¨è¿™æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šåœ¨æ²¡æœ‰å¼•å·çš„æƒ…å†µä¸‹ç¼–å†™æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ¯”å¦‚\texttt{\textbackslash{}.}ã€‚å¦‚
æœæˆ‘ä»¬éœ€è¦å¼ºè°ƒå®é™…è¾“å…¥çš„å†…å®¹ï¼Œæˆ‘ä»¬ä¼šç”¨å¼•å·å°†å…¶æ‹¬èµ·æ¥å¹¶æ·»åŠ é¢å¤–çš„è½¬ä¹‰å­—ç¬¦ï¼Œæ¯”å¦‚\texttt{"\textbackslash{}\textbackslash{}."}ã€‚

å¦‚æœ\texttt{\textbackslash{}}åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­è¢«ç”¨ä½œè½¬ä¹‰å­—ç¬¦ï¼Œé‚£ä¹ˆå¦‚ä½•åŒ¹é…ä¸€ä¸ªå®é™…çš„\texttt{\textbackslash{}}å‘¢ï¼Ÿä½ 
éœ€è¦å¯¹å®ƒè¿›è¡Œè½¬ä¹‰ï¼Œåˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼\texttt{\textbackslash{}\textbackslash{}}ã€‚ä¸º
äº†åˆ›å»ºè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œä½ éœ€è¦ä½¿ç”¨å­—ç¬¦ä¸²ï¼Œè€Œå­—ç¬¦ä¸²æœ¬èº«ä¹Ÿéœ€è¦å¯¹\texttt{\textbackslash{}}è¿›è¡Œè½¬ä¹‰ã€‚è¿™
æ„å‘³ç€è¦åŒ¹é…ä¸€ä¸ªå®é™…çš„\texttt{\textbackslash{}}ï¼Œä½ éœ€è¦å†™\texttt{"\textbackslash{}\textbackslash{}\textbackslash{}\textbackslash{}"}------ä½ éœ€è¦å››ä¸ªåæ–œæ æ¥åŒ¹é…ä¸€ä¸ªï¼

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \StringTok{"a}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{b"}
\FunctionTok{str\_view}\NormalTok{(x)}
\CommentTok{\#\textgreater{} [1] | a\textbackslash{}b}
\FunctionTok{str\_view}\NormalTok{(x, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}\textbackslash{}\textbackslash{}}\StringTok{"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | a\textless{}\textbackslash{}\textgreater{}b}
\end{Highlighting}
\end{Shaded}

æˆ–è€…ï¼Œä½ å¯èƒ½å‘ç°ä½¿ç”¨ å°èŠ‚~\ref{sec-raw-strings}
ä¸­å­¦åˆ°çš„åŸå§‹å­—ç¬¦ä¸²ä¼šæ›´åŠ ç®€å•ã€‚è¿™ æ ·å¯ä»¥è®©ä½ é¿å…ä¸€å±‚çš„è½¬ä¹‰ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(x, r}\StringTok{"\{}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{\}"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | a\textless{}\textbackslash{}\textgreater{}b}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ è¯•å›¾åŒ¹é…ä¸€ä¸ªå­—é¢ä¸Šçš„\texttt{.}ã€\texttt{\$}ã€\texttt{\textbar{}}ã€\texttt{*}ã€\texttt{+}ã€\texttt{?}ã€\texttt{\{}ã€\texttt{\}}ã€\texttt{(}æˆ–\texttt{)}ï¼Œé™¤äº†ä½¿ç”¨åæ–œæ è½¬ä¹‰ä¹‹å¤–è¿˜æœ‰ä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆï¼šä½ å¯ä»¥ä½¿ç”¨å­—ç¬¦ç±»ï¼š\texttt{.}ã€\texttt{\$}ã€\texttt{\textbar{}}ã€\ldots{}
éƒ½åŒ¹é…å…¶å­—é¢å€¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"abc"}\NormalTok{, }\StringTok{"a.c"}\NormalTok{, }\StringTok{"a*c"}\NormalTok{, }\StringTok{"a c"}\NormalTok{), }\StringTok{"a[.]c"}\NormalTok{)}
\CommentTok{\#\textgreater{} [2] | \textless{}a.c\textgreater{}}
\FunctionTok{str\_view}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"abc"}\NormalTok{, }\StringTok{"a.c"}\NormalTok{, }\StringTok{"a*c"}\NormalTok{, }\StringTok{"a c"}\NormalTok{), }\StringTok{".[*]c"}\NormalTok{)}
\CommentTok{\#\textgreater{} [3] | \textless{}a*c\textgreater{}}
\end{Highlighting}
\end{Shaded}

\subsection{é”šç‚¹}\label{ux951aux70b9}

é»˜è®¤æƒ…å†µä¸‹ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¼šåŒ¹é…å­—ç¬¦ä¸²çš„ä»»ä½•éƒ¨åˆ†ã€‚å¦‚
æœä½ æƒ³åœ¨å¼€å¤´æˆ–ç»“å°¾å¤„è¿›è¡ŒåŒ¹é…ï¼Œä½ éœ€è¦ä½¿ç”¨\texttt{\^{}}æ¥é”šå®šæ­£åˆ™è¡¨è¾¾å¼çš„å¼€å§‹ï¼Œæˆ–è€…ä½¿ç”¨\texttt{\$}æ¥é”šå®šæ­£åˆ™è¡¨è¾¾å¼çš„ç»“æŸï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(fruit, }\StringTok{"\^{}a"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | \textless{}a\textgreater{}pple}
\CommentTok{\#\textgreater{} [2] | \textless{}a\textgreater{}pricot}
\CommentTok{\#\textgreater{} [3] | \textless{}a\textgreater{}vocado}
\FunctionTok{str\_view}\NormalTok{(fruit, }\StringTok{"a$"}\NormalTok{)}
\CommentTok{\#\textgreater{}  [4] | banan\textless{}a\textgreater{}}
\CommentTok{\#\textgreater{} [15] | cherimoy\textless{}a\textgreater{}}
\CommentTok{\#\textgreater{} [30] | feijo\textless{}a\textgreater{}}
\CommentTok{\#\textgreater{} [36] | guav\textless{}a\textgreater{}}
\CommentTok{\#\textgreater{} [56] | papay\textless{}a\textgreater{}}
\CommentTok{\#\textgreater{} [74] | satsum\textless{}a\textgreater{}}
\end{Highlighting}
\end{Shaded}

å¯èƒ½ä¼šè®©äººè¯¯ä»¥ä¸º\texttt{\$}åº”è¯¥åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹ï¼Œå› ä¸ºæˆ‘ä»¬å¸¸å¸¸è¿™æ ·å†™é‡‘é¢ï¼Œä½†è¿™å¹¶ä¸æ˜¯æ­£åˆ™è¡¨è¾¾å¼æ‰€æœŸæœ›çš„ã€‚

è¦å¼ºåˆ¶æ­£åˆ™è¡¨è¾¾å¼ä»…åŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œéœ€è¦ç”¨\texttt{\^{}}å’Œ\texttt{\$}åŒæ—¶è¿›è¡Œé”šå®šï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(fruit, }\StringTok{"apple"}\NormalTok{)}
\CommentTok{\#\textgreater{}  [1] | \textless{}apple\textgreater{}}
\CommentTok{\#\textgreater{} [62] | pine\textless{}apple\textgreater{}}
\FunctionTok{str\_view}\NormalTok{(fruit, }\StringTok{"\^{}apple$"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | \textless{}apple\textgreater{}}
\end{Highlighting}
\end{Shaded}

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨\texttt{\textbackslash{}b}æ¥åŒ¹é…å•è¯ä¹‹é—´çš„è¾¹ç•Œï¼ˆå³å•è¯çš„å¼€å§‹æˆ–ç»“æŸï¼‰ã€‚è¿™
åœ¨ä½¿ç”¨ RStudio çš„æŸ¥æ‰¾å’Œæ›¿æ¢å·¥å…·æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚ä¾‹
å¦‚ï¼Œå¦‚æœä½ æƒ³æŸ¥æ‰¾æ‰€æœ‰\texttt{sum()}çš„ç”¨æ³•ï¼Œä½ å¯ä»¥æœç´¢\texttt{\textbackslash{}bsum\textbackslash{}b}æ¥é¿å…åŒ¹é…åˆ°\texttt{summarize}ã€\texttt{summary}ã€\texttt{rowsum}ç­‰å•è¯ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"summary(x)"}\NormalTok{, }\StringTok{"summarize(df)"}\NormalTok{, }\StringTok{"rowsum(x)"}\NormalTok{, }\StringTok{"sum(x)"}\NormalTok{)}
\FunctionTok{str\_view}\NormalTok{(x, }\StringTok{"sum"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | \textless{}sum\textgreater{}mary(x)}
\CommentTok{\#\textgreater{} [2] | \textless{}sum\textgreater{}marize(df)}
\CommentTok{\#\textgreater{} [3] | row\textless{}sum\textgreater{}(x)}
\CommentTok{\#\textgreater{} [4] | \textless{}sum\textgreater{}(x)}
\FunctionTok{str\_view}\NormalTok{(x, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{bsum}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{b"}\NormalTok{)}
\CommentTok{\#\textgreater{} [4] | \textless{}sum\textgreater{}(x)}
\end{Highlighting}
\end{Shaded}

å½“å•ç‹¬ä½¿ç”¨æ—¶ï¼Œé”šç‚¹ä¼šäº§ç”Ÿä¸€ä¸ªé›¶å®½åº¦çš„åŒ¹é…ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(}\StringTok{"abc"}\NormalTok{, }\FunctionTok{c}\NormalTok{(}\StringTok{"$"}\NormalTok{, }\StringTok{"\^{}"}\NormalTok{, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{b"}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] | abc\textless{}\textgreater{}}
\CommentTok{\#\textgreater{} [2] | \textless{}\textgreater{}abc}
\CommentTok{\#\textgreater{} [3] | \textless{}\textgreater{}abc\textless{}\textgreater{}}
\end{Highlighting}
\end{Shaded}

è¿™æœ‰åŠ©äºä½ ç†è§£å½“æ›¿æ¢ä¸€ä¸ªå•ç‹¬çš„é”šç‚¹æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_replace\_all}\NormalTok{(}\StringTok{"abc"}\NormalTok{, }\FunctionTok{c}\NormalTok{(}\StringTok{"$"}\NormalTok{, }\StringTok{"\^{}"}\NormalTok{, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{b"}\NormalTok{), }\StringTok{"{-}{-}"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "abc{-}{-}"   "{-}{-}abc"   "{-}{-}abc{-}{-}"}
\end{Highlighting}
\end{Shaded}

\subsection{å­—ç¬¦ç±»}\label{ux5b57ux7b26ux7c7b}

å­—ç¬¦ç±»ï¼ˆæˆ–å­—ç¬¦é›†ï¼‰å…è®¸ä½ åŒ¹é…é›†åˆä¸­çš„ä»»ä½•å­—ç¬¦ã€‚å¦‚
ä¸Šæ‰€è¿°ï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{{[}{]}}æ¥æ„å»ºè‡ªå·±çš„é›†åˆï¼Œå…¶ä¸­\texttt{{[}abc{]}}åŒ¹é…
``a''ã€``b'' æˆ– ``c''ï¼Œè€Œ\texttt{{[}\^{}abc{]}}åŒ¹é…é™¤äº† ``a''ã€``b'' æˆ–
``c'' ä¹‹å¤–çš„ä»»ä½•å­—ç¬¦ã€‚é™¤
äº†\texttt{\^{}}ä¹‹å¤–ï¼Œ\texttt{{[}{]}}å†…è¿˜æœ‰ä¸¤ä¸ªå­—ç¬¦å…·æœ‰ç‰¹æ®Šå«ä¹‰ï¼š

\begin{itemize}
\tightlist
\item
  \texttt{-} å®šä¹‰äº†ä¸€ä¸ªèŒƒå›´ï¼Œä¾‹å¦‚ï¼Œ\texttt{{[}a-z{]}}
  åŒ¹é…ä»»ä½•å°å†™å­—æ¯ï¼Œè€Œ \texttt{{[}0-9{]}} åŒ¹é…ä»»ä½•æ•°å­—ã€‚
\item
  \texttt{\textbackslash{}}
  ç”¨äºè½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ï¼Œå› æ­¤\texttt{{[}\textbackslash{}\^{}\textbackslash{}-\textbackslash{}{]}{]}}åŒ¹é…å­—ç¬¦\texttt{\^{}}ã€\texttt{-}æˆ–\texttt{{]}}ã€‚
\end{itemize}

è¿™é‡Œæœ‰å‡ ä¸ªä¾‹å­

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \StringTok{"abcd ABCD 12345 {-}!@\#\%."}
\FunctionTok{str\_view}\NormalTok{(x, }\StringTok{"[abc]+"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | \textless{}abc\textgreater{}d ABCD 12345 {-}!@\#\%.}
\FunctionTok{str\_view}\NormalTok{(x, }\StringTok{"[a{-}z]+"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | \textless{}abcd\textgreater{} ABCD 12345 {-}!@\#\%.}
\FunctionTok{str\_view}\NormalTok{(x, }\StringTok{"[\^{}a{-}z0{-}9]+"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | abcd\textless{} ABCD \textgreater{}12345\textless{} {-}!@\#\%.\textgreater{}}

\CommentTok{\# You need an escape to match characters that are otherwise}
\CommentTok{\# special inside of []}
\FunctionTok{str\_view}\NormalTok{(}\StringTok{"a{-}b{-}c"}\NormalTok{, }\StringTok{"[a{-}c]"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | \textless{}a\textgreater{}{-}\textless{}b\textgreater{}{-}\textless{}c\textgreater{}}
\FunctionTok{str\_view}\NormalTok{(}\StringTok{"a{-}b{-}c"}\NormalTok{, }\StringTok{"[a}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{{-}c]"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | \textless{}a\textgreater{}\textless{}{-}\textgreater{}b\textless{}{-}\textgreater{}\textless{}c\textgreater{}}
\end{Highlighting}
\end{Shaded}

ä¸€äº›å­—ç¬¦ç±»ç”±äºä½¿ç”¨å¾—éå¸¸é¢‘ç¹ï¼Œå› æ­¤å®ƒä»¬æœ‰è‡ªå·±çš„å¿«æ·æ–¹å¼ã€‚ä½ 
å·²ç»è§è¿‡\texttt{.}ï¼Œå®ƒåŒ¹é…é™¤äº†æ¢è¡Œç¬¦ä¹‹å¤–çš„ä»»ä½•å­—ç¬¦ã€‚è¿™
é‡Œè¿˜æœ‰å¦å¤–ä¸‰å¯¹ç‰¹åˆ«æœ‰ç”¨çš„å¿«æ·æ–¹å¼\footnote{è®°ä½ï¼Œè¦åˆ›å»ºä¸€ä¸ªåŒ…å«\texttt{\textbackslash{}d}æˆ–\texttt{\textbackslash{}s}çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œä½ éœ€è¦å¯¹å­—ç¬¦ä¸²ä¸­çš„\texttt{\textbackslash{}}è¿›è¡Œè½¬ä¹‰ï¼Œæ‰€ä»¥ä½ éœ€è¦è¾“å…¥\texttt{\textbackslash{}\textbackslash{}d}æˆ–\texttt{\textbackslash{}\textbackslash{}s}ã€‚}ï¼š

\begin{itemize}
\tightlist
\item
  \texttt{\textbackslash{}d} åŒ¹é…ä»»ä½•æ•°å­—ï¼›\\
  \texttt{\textbackslash{}D} åŒ¹é…ä»»ä½•ä¸æ˜¯æ•°å­—çš„å­—ç¬¦ï¼›
\item
  \texttt{\textbackslash{}s}
  åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼ˆå¦‚ï¼Œç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ï¼‰ï¼›\\
  \texttt{\textbackslash{}S} åŒ¹é…ä»»ä½•ä¸æ˜¯ç©ºç™½å­—ç¬¦çš„å­—ç¬¦ï¼›
\item
  \texttt{\textbackslash{}w} åŒ¹é…ä»»ä½•``å•è¯''å­—ç¬¦ï¼Œå³å­—æ¯å’Œæ•°å­—ï¼›\\
  \texttt{\textbackslash{}W} åŒ¹é…ä»»ä½•``éå•è¯''å­—ç¬¦ã€‚
\end{itemize}

ä»¥ä¸‹ä»£ç é€šè¿‡é€‰æ‹©å­—æ¯ã€æ•°å­—å’Œæ ‡ç‚¹ç¬¦å·å­—ç¬¦æ¥æ¼”ç¤ºè¿™å…­ä¸ªå¿«æ·æ–¹å¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \StringTok{"abcd ABCD 12345 {-}!@\#\%."}
\FunctionTok{str\_view}\NormalTok{(x, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{d+"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | abcd }\hspace*{\fill}\NormalTok{\circled{12345}}
\FunctionTok{str\_view}\NormalTok{(x, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{D+"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | \textless{}abcd ABCD \textgreater{}12345\textless{} {-}!@\#\%.\textgreater{}}
\FunctionTok{str\_view}\NormalTok{(x, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{s+"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | abcd\textless{} \textgreater{}ABCD\textless{} \textgreater{}12345\textless{} \textgreater{}{-}!@\#\%.}
\FunctionTok{str\_view}\NormalTok{(x, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{S+"}\NormalTok{)}

\FunctionTok{str\_view}\NormalTok{(x, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{w+"}\NormalTok{)}

\FunctionTok{str\_view}\NormalTok{(x, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{W+"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | abcd\textless{} \textgreater{}ABCD\textless{} \textgreater{}12345\textless{} {-}!@\#\%.\textgreater{}}
\end{Highlighting}
\end{Shaded}

\subsection{é‡è¯}\label{sec-quantifiers}

é‡è¯ï¼ˆ\textbf{Quantifiers}ï¼‰æ§åˆ¶æ¨¡å¼åŒ¹é…çš„æ¬¡æ•°ã€‚åœ¨
å°èŠ‚~\ref{sec-reg-basics} ä¸­å­¦ä¹ äº†
\texttt{?}ï¼ˆåŒ¹é…0æ¬¡æˆ–1æ¬¡ï¼‰ã€\texttt{+}ï¼ˆåŒ¹é…1æ¬¡æˆ–å¤šæ¬¡ï¼‰å’Œ\texttt{*}ï¼ˆåŒ¹é…0æ¬¡æˆ–å¤šæ¬¡ï¼‰ã€‚ä¾‹
å¦‚ï¼Œ\texttt{colou?r} å°†åŒ¹é…ç¾å¼æˆ–è‹±å¼æ‹¼å†™ï¼Œ\texttt{\textbackslash{}d+}
å°†åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªæ•°å­—ï¼Œè€Œ \texttt{\textbackslash{}s?}
å°†å¯é€‰åœ°åŒ¹é…ä¸€ä¸ªç©ºç™½å­—ç¬¦ã€‚ä½  è¿˜å¯ä»¥ä½¿ç”¨ \texttt{\{\}}
æ¥ç²¾ç¡®æŒ‡å®šåŒ¹é…æ¬¡æ•°ï¼š

\begin{itemize}
\tightlist
\item
  \texttt{\{n\}} æ°å¥½åŒ¹é… n æ¬¡ï¼›
\item
  \texttt{\{n,\}} åŒ¹é…è‡³å°‘ n æ¬¡ï¼›
\item
  \texttt{\{n,m\}} åŒ¹é… n åˆ° m æ¬¡ã€‚
\end{itemize}

\subsection{è¿ç®—ç¬¦ä¼˜å…ˆçº§å’Œæ‹¬å·}\label{ux8fd0ux7b97ux7b26ux4f18ux5148ux7ea7ux548cux62ecux53f7}

\texttt{ab+} åŒ¹é…ä»€ä¹ˆï¼Ÿæ˜¯
åŒ¹é…``a''åé¢è·Ÿç€ä¸€ä¸ªæˆ–å¤šä¸ª``b''ï¼Œè¿˜æ˜¯åŒ¹é…``ab''é‡å¤ä»»æ„æ¬¡æ•°ï¼Ÿ\texttt{\^{}}
\texttt{a\textbar{}b\$} åŒ¹é…ä»€ä¹ˆï¼Ÿæ˜¯
åŒ¹é…å®Œæ•´çš„å­—ç¬¦ä¸²``a''æˆ–å®Œæ•´çš„å­—ç¬¦ä¸²``b''ï¼Œè¿˜æ˜¯åŒ¹é…ä»¥``a''å¼€å¤´çš„å­—ç¬¦ä¸²æˆ–ä»¥``b''ç»“å°¾çš„å­—ç¬¦ä¸²ï¼Ÿ

è¿™äº›é—®é¢˜çš„ç­”æ¡ˆç”±è¿ç®—ç¬¦ä¼˜å…ˆçº§ç¡®å®šï¼Œç±»ä¼¼äºä½ åœ¨å­¦æ ¡å¯èƒ½å­¦è¿‡çš„ PEMDAS æˆ–
BEDMAS è§„åˆ™ã€‚ä½  çŸ¥é“ \texttt{a\ +\ b\ *\ c} ç›¸å½“äº
\texttt{a\ +\ (b\ *\ c)} è€Œä¸æ˜¯ \texttt{(a\ +\ b)\ *\ c}ï¼Œå› ä¸º
\texttt{*} çš„ä¼˜å…ˆçº§é«˜äº \texttt{+}ï¼Œå…ˆè®¡ç®— \texttt{*} å†è®¡ç®—
\texttt{+}ã€‚

ç±»ä¼¼åœ°ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¹Ÿæœ‰è‡ªå·±çš„ä¼˜å…ˆçº§è§„åˆ™ï¼šé‡è¯çš„ä¼˜å…ˆçº§é«˜ï¼Œè€Œæ›¿æ¢çš„ä¼˜å…ˆçº§ä½ï¼Œè¿™æ„å‘³ç€
\texttt{ab+} ç›¸å½“äº \texttt{a(b+)}ï¼Œè€Œ
\texttt{\^{}a\textbar{}b\$}ç›¸å½“äº\texttt{(\^{}a)\textbar{}(b\$)}ã€‚å°±
åƒä»£æ•°ä¸€æ ·ï¼Œä½ å¯ä»¥ä½¿ç”¨æ‹¬å·æ¥è¦†ç›–é€šå¸¸çš„é¡ºåºã€‚ä½†
ä¸ä»£æ•°ä¸åŒï¼Œä½ ä¸å¤ªå¯èƒ½è®°ä½æ­£åˆ™è¡¨è¾¾å¼çš„ä¼˜å…ˆçº§è§„åˆ™ï¼Œæ‰€ä»¥è¯·éšæ„ä½¿ç”¨æ‹¬å·ã€‚

\subsection{åˆ†ç»„å’Œæ•è·}\label{ux5206ux7ec4ux548cux6355ux83b7}

é™¤äº†è¦†ç›–è¿ç®—ç¬¦ä¼˜å…ˆçº§å¤–ï¼Œæ‹¬å·è¿˜æœ‰å¦ä¸€ä¸ªé‡è¦ä½œç”¨ï¼šåˆ›å»ºæ•è·ç»„ï¼ˆ\textbf{capturing
groups}ï¼‰ï¼Œæ•è·ç»„å…è®¸ä½ ä½¿ç”¨åŒ¹é…çš„å­ç»„ä»¶ã€‚

ä½¿ç”¨æ•è·ç»„çš„ç¬¬ä¸€ç§æ–¹æ³•æ˜¯åœ¨åŒ¹é…å†…éƒ¨ä½¿ç”¨åå‘å¼•ç”¨ï¼ˆ\textbf{back
reference}ï¼‰å¼•ç”¨å®ƒï¼š\texttt{\textbackslash{}1}
å¼•ç”¨ç¬¬ä¸€ä¸ªæ‹¬å·ä¸­çš„åŒ¹é…é¡¹ï¼Œ\texttt{\textbackslash{}2}
å¼•ç”¨ç¬¬äºŒä¸ªæ‹¬å·ä¸­çš„åŒ¹é…é¡¹ï¼Œä¾æ­¤ç±»æ¨ã€‚ä¾‹
å¦‚ï¼Œä»¥ä¸‹æ¨¡å¼æŸ¥æ‰¾å…·æœ‰é‡å¤å­—æ¯å¯¹çš„æ‰€æœ‰æ°´æœï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(fruit, }\StringTok{"(..)}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{1"}\NormalTok{)}
\CommentTok{\#\textgreater{}  [4] | b\textless{}anan\textgreater{}a}
\CommentTok{\#\textgreater{} [20] | \textless{}coco\textgreater{}nut}
\CommentTok{\#\textgreater{} [22] | \textless{}cucu\textgreater{}mber}
\CommentTok{\#\textgreater{} [41] | \textless{}juju\textgreater{}be}
\CommentTok{\#\textgreater{} [56] | \textless{}papa\textgreater{}ya}
\CommentTok{\#\textgreater{} [73] | s\textless{}alal\textgreater{} berry}
\end{Highlighting}
\end{Shaded}

è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¼šæ‰¾åˆ°æ‰€æœ‰ä»¥ç›¸åŒå­—æ¯å¯¹å¼€å¤´å’Œç»“å°¾çš„å•è¯ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(words, }\StringTok{"\^{}(..).*}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{1$"}\NormalTok{)}
\CommentTok{\#\textgreater{} [152] | \textless{}church\textgreater{}}
\CommentTok{\#\textgreater{} [217] | \textless{}decide\textgreater{}}
\CommentTok{\#\textgreater{} [617] | \textless{}photograph\textgreater{}}
\CommentTok{\#\textgreater{} [699] | \textless{}require\textgreater{}}
\CommentTok{\#\textgreater{} [739] | \textless{}sense\textgreater{}}
\end{Highlighting}
\end{Shaded}

ä½ ä¹Ÿå¯ä»¥åœ¨\texttt{str\_replace()}ä¸­ä½¿ç”¨åå‘å¼•ç”¨ã€‚ä¾‹
å¦‚ï¼Œä»¥ä¸‹ä»£ç ä¼šäº¤æ¢\texttt{sentences}ä¸­ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå•è¯çš„é¡ºåºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sentences }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{str\_replace}\NormalTok{(}\StringTok{"(}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{w+) (}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{w+) (}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{w+)"}\NormalTok{, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{1 }\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{3 }\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{2"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{str\_view}\NormalTok{()}
\CommentTok{\#\textgreater{} [1] | The canoe birch slid on the smooth planks.}
\CommentTok{\#\textgreater{} [2] | Glue sheet the to the dark blue background.}
\CommentTok{\#\textgreater{} [3] | It\textquotesingle{}s to easy tell the depth of a well.}
\CommentTok{\#\textgreater{} [4] | These a days chicken leg is a rare dish.}
\CommentTok{\#\textgreater{} [5] | Rice often is served in round bowls.}
\CommentTok{\#\textgreater{} [6] | The of juice lemons makes fine punch.}
\CommentTok{\#\textgreater{} ... and 714 more}
\end{Highlighting}
\end{Shaded}

å¦‚æœæƒ³æå–æ¯ä¸ªç»„çš„åŒ¹é…é¡¹ï¼Œå¯ä»¥ä½¿ç”¨\texttt{str\_match()}ã€‚ä½†
\texttt{str\_match()}è¿”å›ä¸€ä¸ªçŸ©é˜µï¼Œå› æ­¤ä½¿ç”¨èµ·æ¥ä¸æ˜¯ç‰¹åˆ«æ–¹ä¾¿\footnote{ä¸»è¦æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨æœ¬ä¹¦ä¸­ä»æœªè®¨è®ºè¿‡çŸ©é˜µ!}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sentences }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{str\_match}\NormalTok{(}\StringTok{"the (}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{w+) (}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{w+)"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{head}\NormalTok{()}
\CommentTok{\#\textgreater{}      [,1]                [,2]     [,3]    }
\CommentTok{\#\textgreater{} [1,] "the smooth planks" "smooth" "planks"}
\CommentTok{\#\textgreater{} [2,] "the sheet to"      "sheet"  "to"    }
\CommentTok{\#\textgreater{} [3,] "the depth of"      "depth"  "of"    }
\CommentTok{\#\textgreater{} [4,] NA                  NA       NA      }
\CommentTok{\#\textgreater{} [5,] NA                  NA       NA      }
\CommentTok{\#\textgreater{} [6,] NA                  NA       NA}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥å°†å…¶è½¬æ¢ä¸º tibble å¹¶ç»™åˆ—å‘½åï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sentences }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{str\_match}\NormalTok{(}\StringTok{"the (}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{w+) (}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{w+)"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{as\_tibble}\NormalTok{(}\AttributeTok{.name\_repair =} \StringTok{"minimal"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{set\_names}\NormalTok{(}\StringTok{"match"}\NormalTok{, }\StringTok{"word1"}\NormalTok{, }\StringTok{"word2"}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 720 x 3}
\CommentTok{\#\textgreater{}   match             word1  word2 }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}             \textless{}chr\textgreater{}  \textless{}chr\textgreater{} }
\CommentTok{\#\textgreater{} 1 the smooth planks smooth planks}
\CommentTok{\#\textgreater{} 2 the sheet to      sheet  to    }
\CommentTok{\#\textgreater{} 3 the depth of      depth  of    }
\CommentTok{\#\textgreater{} 4 \textless{}NA\textgreater{}              \textless{}NA\textgreater{}   \textless{}NA\textgreater{}  }
\CommentTok{\#\textgreater{} 5 \textless{}NA\textgreater{}              \textless{}NA\textgreater{}   \textless{}NA\textgreater{}  }
\CommentTok{\#\textgreater{} 6 \textless{}NA\textgreater{}              \textless{}NA\textgreater{}   \textless{}NA\textgreater{}  }
\CommentTok{\#\textgreater{} \# i 714 more rows}
\end{Highlighting}
\end{Shaded}

ä½†æ˜¯ï¼Œä½ åŸºæœ¬ä¸Šå·²ç»é‡æ–°åˆ›å»ºäº†è‡ªå·±çš„\texttt{separate\_wider\_regex()}ç‰ˆæœ¬ã€‚å®
é™…ä¸Šï¼Œåœ¨å¹•åï¼Œ\texttt{separate\_wider\_regex()}å°†ä½ çš„æ¨¡å¼å‘é‡è½¬æ¢ä¸ºä¸€ä¸ªä½¿ç”¨åˆ†ç»„æ¥æ•è·å‘½åç»„ä»¶çš„å•ä¸€æ­£åˆ™è¡¨è¾¾å¼ã€‚

å¶å°”ï¼Œä½ ä¼šæƒ³è¦ä½¿ç”¨æ‹¬å·è€Œä¸åˆ›å»ºåŒ¹é…ç»„ã€‚ä½ 
å¯ä»¥ä½¿ç”¨\texttt{(?:)}æ¥åˆ›å»ºä¸€ä¸ªéæ•è·ç»„ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"a gray cat"}\NormalTok{, }\StringTok{"a grey dog"}\NormalTok{)}
\FunctionTok{str\_match}\NormalTok{(x, }\StringTok{"gr(e|a)y"}\NormalTok{)}
\CommentTok{\#\textgreater{}      [,1]   [,2]}
\CommentTok{\#\textgreater{} [1,] "gray" "a" }
\CommentTok{\#\textgreater{} [2,] "grey" "e"}
\FunctionTok{str\_match}\NormalTok{(x, }\StringTok{"gr(?:e|a)y"}\NormalTok{)}
\CommentTok{\#\textgreater{}      [,1]  }
\CommentTok{\#\textgreater{} [1,] "gray"}
\CommentTok{\#\textgreater{} [2,] "grey"}
\end{Highlighting}
\end{Shaded}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-40}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  å¦‚ä½•åŒ¹é…å­—é¢å­—ç¬¦ä¸²\texttt{"\textquotesingle{}\textbackslash{}}ï¼Ÿé‚£ä¹ˆ
  \texttt{"\$\^{}\$"} å‘¢ï¼Ÿ
\item
  ä¸ºä»€ä¹ˆ \texttt{"\textbackslash{}"},
  \texttt{"\textbackslash{}\textbackslash{}"},
  \texttt{"\textbackslash{}\textbackslash{}\textbackslash{}"}è¿™äº›æ¨¡å¼éƒ½ä¸åŒ¹é…åæ–œæ \texttt{\textbackslash{}}ï¼Ÿ
\item
  ç»™å®š\texttt{stringr::words}ä¸­çš„å¸¸ç”¨è¯æ±‡åº“ï¼Œåˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼ä»¥æŸ¥æ‰¾æ‰€æœ‰æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„å•è¯ï¼š

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \tightlist
  \item
    ä»¥ ``y'' å¼€å¤´ï¼›
  \item
    ä¸ä»¥ ``y'' å¼€å¤´ï¼›
  \item
    ä»¥ ``x'' ç»“å°¾ï¼›
  \item
    æ°å¥½ä¸‰ä¸ªå­—æ¯é•¿ï¼ˆä¸è¦é€šè¿‡ä½¿ç”¨\texttt{str\_length()}æ¥ä½œå¼Šï¼)
  \item
    æœ‰ä¸ƒä¸ªæˆ–æ›´å¤šå­—æ¯ï¼›
  \item
    åŒ…å«å…ƒéŸ³-è¾…éŸ³å¯¹ï¼›
  \item
    åœ¨ä¸€è¡Œä¸­è‡³å°‘åŒ…å«ä¸¤ä¸ªå…ƒéŸ³-è¾…éŸ³å¯¹ï¼›
  \item
    ä»…ç”±é‡å¤çš„å…ƒéŸ³-è¾…éŸ³å¯¹ç»„æˆã€‚
  \end{enumerate}
\item
  åˆ›å»º11ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œæ¯ä¸ªè¡¨è¾¾å¼éƒ½åŒ¹é…ä»¥ä¸‹å•è¯çš„è‹±å¼æˆ–ç¾å¼æ‹¼å†™ï¼šairplane/aeroplane,
  aluminum/aluminium, analog/analogue, ass/arse, center/centre,
  defense/defence, donut/doughnut, gray/grey, modeling/modelling,
  skeptic/sceptic, summarize/summariseã€‚å° è¯•ç¼–å†™å°½å¯èƒ½çŸ­çš„æ­£åˆ™è¡¨è¾¾å¼ï¼
\item
  äº¤æ¢\texttt{words}ä¸­çš„é¦–å°¾å­—æ¯ï¼Œå“ªäº›å­—ç¬¦ä¸²ä»ç„¶æ˜¯\texttt{words}ï¼Ÿ
\item
  ç”¨æ–‡å­—æè¿°è¿™äº›æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ä»€ä¹ˆå†…å®¹:ï¼ˆä»”ç»†é˜…è¯»ä»¥ç¡®å®šæ¯ä¸ªæ¡ç›®æ˜¯æ­£åˆ™è¡¨è¾¾å¼è¿˜æ˜¯å®šä¹‰æ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²ï¼‰

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \tightlist
  \item
    \texttt{\^{}.*\$}
  \item
    \texttt{"\textbackslash{}\textbackslash{}\{.+\textbackslash{}\textbackslash{}\}"}
  \item
    \texttt{\textbackslash{}d\{4\}-\textbackslash{}d\{2\}-\textbackslash{}d\{2\}}
  \item
    \texttt{"\textbackslash{}\textbackslash{}\textbackslash{}\textbackslash{}\{4\}"}
  \item
    \texttt{\textbackslash{}..\textbackslash{}..\textbackslash{}..}
  \item
    \texttt{(.)\textbackslash{}1\textbackslash{}1}
  \item
    \texttt{"(..)\textbackslash{}\textbackslash{}1"}
  \end{enumerate}
\item
  å®Œæˆä½äº\url{https://regexcrossword.com/challenges/beginner}çš„æ­£åˆ™è¡¨è¾¾å¼åˆå­¦è€…å¡«å­—æ¸¸æˆã€‚
\end{enumerate}

\section{æ¨¡å¼æ§åˆ¶}\label{ux6a21ux5f0fux63a7ux5236}

é€šè¿‡ä½¿ç”¨æ¨¡å¼å¯¹è±¡è€Œä¸æ˜¯ä»…ä½¿ç”¨å­—ç¬¦ä¸²ï¼Œå¯ä»¥å¯¹åŒ¹é…çš„ç»†èŠ‚è¿›è¡Œé¢å¤–çš„æ§åˆ¶ã€‚è¿™
å…è®¸ä½ æ§åˆ¶æ‰€è°“çš„æ­£åˆ™è¡¨è¾¾å¼æ ‡å¿—ï¼Œå¹¶åŒ¹é…å„ç§ç±»å‹çš„å›ºå®šå­—ç¬¦ä¸²ï¼Œå¦‚ä¸‹æ‰€è¿°ã€‚

\subsection{Regex æ ‡å¿—}\label{sec-flags}

æœ‰ä¸€äº›è®¾ç½®å¯ä»¥ç”¨æ¥æ§åˆ¶æ­£åˆ™è¡¨è¾¾å¼çš„ç»†èŠ‚ï¼Œè¿™äº›è®¾ç½®åœ¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­é€šå¸¸è¢«ç§°ä¸ºæ ‡å¿—ï¼ˆ\textbf{flags}ï¼‰ã€‚åœ¨
\texttt{stringr}
ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡å°†æ¨¡å¼å°è£…åœ¨å‡½æ•°\texttt{regex()}çš„è°ƒç”¨ä¸­æ¥ä½¿ç”¨è¿™äº›è®¾ç½®ã€‚æœ€
æœ‰ç”¨çš„æ ‡å¿—å¯èƒ½æ˜¯
\texttt{ignore\_case\ =\ TRUE}ï¼Œå› ä¸ºå®ƒå…è®¸å­—ç¬¦ä¸å…¶å¤§å†™æˆ–å°å†™å½¢å¼åŒ¹é…ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bananas }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"banana"}\NormalTok{, }\StringTok{"Banana"}\NormalTok{, }\StringTok{"BANANA"}\NormalTok{)}
\FunctionTok{str\_view}\NormalTok{(bananas, }\StringTok{"banana"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | \textless{}banana\textgreater{}}
\FunctionTok{str\_view}\NormalTok{(bananas, }\FunctionTok{regex}\NormalTok{(}\StringTok{"banana"}\NormalTok{, }\AttributeTok{ignore\_case =} \ConstantTok{TRUE}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] | \textless{}banana\textgreater{}}
\CommentTok{\#\textgreater{} [2] | \textless{}Banana\textgreater{}}
\CommentTok{\#\textgreater{} [3] | \textless{}BANANA\textgreater{}}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ ç»å¸¸å¤„ç†å¤šè¡Œå­—ç¬¦ä¸²ï¼ˆå³åŒ…å«\texttt{\textbackslash{}n}çš„å­—ç¬¦ä¸²ï¼‰ï¼Œ\texttt{dotall}å’Œ\texttt{multiline}ä¹Ÿå¯èƒ½æ˜¯æœ‰ç”¨çš„ï¼š

\begin{itemize}
\item
  \texttt{dotall\ =\ TRUE}
  å…è®¸\texttt{.}åŒ¹é…åŒ…æ‹¬\texttt{\textbackslash{}n}åœ¨å†…çš„æ‰€æœ‰å­—ç¬¦ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \StringTok{"Line 1}\SpecialCharTok{\textbackslash{}n}\StringTok{Line 2}\SpecialCharTok{\textbackslash{}n}\StringTok{Line 3"}
\FunctionTok{str\_view}\NormalTok{(x, }\StringTok{".Line"}\NormalTok{)}
\FunctionTok{str\_view}\NormalTok{(x, }\FunctionTok{regex}\NormalTok{(}\StringTok{".Line"}\NormalTok{, }\AttributeTok{dotall =} \ConstantTok{TRUE}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] | Line 1\textless{}}
\CommentTok{\#\textgreater{}     | Line\textgreater{} 2\textless{}}
\CommentTok{\#\textgreater{}     | Line\textgreater{} 3}
\end{Highlighting}
\end{Shaded}
\item
  \texttt{multiline\ =\ TRUE} ä½¿å¾— \texttt{\^{}} å’Œ \texttt{\$}
  åˆ†åˆ«åŒ¹é…æ¯è¡Œçš„å¼€å§‹å’Œç»“æŸï¼Œè€Œä¸æ˜¯æ•´ä¸ªå­—ç¬¦ä¸²çš„å¼€å§‹å’Œç»“æŸï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \StringTok{"Line 1}\SpecialCharTok{\textbackslash{}n}\StringTok{Line 2}\SpecialCharTok{\textbackslash{}n}\StringTok{Line 3"}
\FunctionTok{str\_view}\NormalTok{(x, }\StringTok{"\^{}Line"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | \textless{}Line\textgreater{} 1}
\CommentTok{\#\textgreater{}     | Line 2}
\CommentTok{\#\textgreater{}     | Line 3}
\FunctionTok{str\_view}\NormalTok{(x, }\FunctionTok{regex}\NormalTok{(}\StringTok{"\^{}Line"}\NormalTok{, }\AttributeTok{multiline =} \ConstantTok{TRUE}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] | \textless{}Line\textgreater{} 1}
\CommentTok{\#\textgreater{}     | \textless{}Line\textgreater{} 2}
\CommentTok{\#\textgreater{}     | \textless{}Line\textgreater{} 3}
\end{Highlighting}
\end{Shaded}
\end{itemize}

æœ€åï¼Œå¦‚æœä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªå¤æ‚çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¹¶æ‹…å¿ƒå°†æ¥å¯èƒ½ä¸ç†è§£å®ƒï¼Œä½ å¯ä»¥å°è¯•ä½¿ç”¨\texttt{comments\ =\ TRUE}ã€‚è¿™
ä¼šä¿®æ”¹æ¨¡å¼è¯­è¨€ä»¥å¿½ç•¥ç©ºæ ¼å’Œæ¢è¡Œç¬¦ï¼Œä»¥åŠ\texttt{\#}ä¹‹åçš„æ‰€æœ‰å†…å®¹ã€‚è¿™
å…è®¸ä½ ä½¿ç”¨æ³¨é‡Šå’Œç©ºæ ¼æ¥ä½¿å¤æ‚çš„æ­£åˆ™è¡¨è¾¾å¼æ›´æ˜“äºç†è§£ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{phone }\OtherTok{\textless{}{-}} \FunctionTok{regex}\NormalTok{(}
\NormalTok{  r}\StringTok{"(}
\StringTok{    \textbackslash{}(?     \# optional opening parens}
\StringTok{    (\textbackslash{}d\{3\}) \# area code}
\StringTok{    [)\textbackslash{}{-}]?  \# optional closing parens or dash}
\StringTok{    \textbackslash{} ?     \# optional space}
\StringTok{    (\textbackslash{}d\{3\}) \# another three numbers}
\StringTok{    [\textbackslash{} {-}]?  \# optional space or dash}
\StringTok{    (\textbackslash{}d\{4\}) \# four more numbers}
\StringTok{  )"}\NormalTok{, }
  \AttributeTok{comments =} \ConstantTok{TRUE}
\NormalTok{)}

\FunctionTok{str\_extract}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"514{-}791{-}8141"}\NormalTok{, }\StringTok{"(123) 456 7890"}\NormalTok{, }\StringTok{"123456"}\NormalTok{), phone)}
\CommentTok{\#\textgreater{} [1] "514{-}791{-}8141"   "(123) 456 7890" NA}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ åœ¨ä½¿ç”¨æ³¨é‡Šå¹¶ä¸”æƒ³è¦åŒ¹é…ç©ºæ ¼ã€æ¢è¡Œç¬¦æˆ–
\texttt{\#}ï¼Œä½ éœ€è¦ä½¿ç”¨\texttt{\textbackslash{}}å¯¹å…¶è¿›è¡Œè½¬ä¹‰ã€‚

\subsection{\texorpdfstring{å›ºå®šåŒ¹é…ï¼ˆ\textbf{Fixed
matches}ï¼‰}{å›ºå®šåŒ¹é…ï¼ˆFixed matchesï¼‰}}\label{ux56faux5b9aux5339ux914dfixed-matches}

ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨\texttt{fixed()}æ¥é€‰æ‹©ä¸éµå¾ªæ­£åˆ™è¡¨è¾¾å¼è§„åˆ™ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{""}\NormalTok{, }\StringTok{"a"}\NormalTok{, }\StringTok{"."}\NormalTok{), }\FunctionTok{fixed}\NormalTok{(}\StringTok{"."}\NormalTok{))}
\CommentTok{\#\textgreater{} [3] | \textless{}.\textgreater{}}
\end{Highlighting}
\end{Shaded}

\texttt{fixed()} è¿˜å…è®¸ä½ å¿½ç•¥å¤§å°å†™ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(}\StringTok{"x X"}\NormalTok{, }\StringTok{"X"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] | x \textless{}X\textgreater{}}
\FunctionTok{str\_view}\NormalTok{(}\StringTok{"x X"}\NormalTok{, }\FunctionTok{fixed}\NormalTok{(}\StringTok{"X"}\NormalTok{, }\AttributeTok{ignore\_case =} \ConstantTok{TRUE}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] | \textless{}x\textgreater{} \textless{}X\textgreater{}}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ åœ¨å¤„ç†éè‹±æ–‡æ–‡æœ¬ï¼Œä½ å¯èƒ½ä¼šä½¿ç”¨\texttt{coll()}è€Œä¸æ˜¯\texttt{fixed()}ï¼Œå› ä¸º\texttt{coll()}å®ç°äº†æ‰€æŒ‡å®šåŒºåŸŸä½¿ç”¨çš„å…¨éƒ¨å¤§å°å†™è§„åˆ™ã€‚å…³
äºåŒºåŸŸçš„æ›´å¤šç»†èŠ‚ï¼Œè¯·å‚è§ å°èŠ‚~\ref{sec-other-languages} ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(}\StringTok{"i Ä° Ä± I"}\NormalTok{, }\FunctionTok{fixed}\NormalTok{(}\StringTok{"Ä°"}\NormalTok{, }\AttributeTok{ignore\_case =} \ConstantTok{TRUE}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] | i \textless{}Ä°\textgreater{} Ä± I}
\FunctionTok{str\_view}\NormalTok{(}\StringTok{"i Ä° Ä± I"}\NormalTok{, }\FunctionTok{coll}\NormalTok{(}\StringTok{"Ä°"}\NormalTok{, }\AttributeTok{ignore\_case =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{locale =} \StringTok{"tr"}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] | \textless{}i\textgreater{} \textless{}Ä°\textgreater{} Ä± I}
\end{Highlighting}
\end{Shaded}

\section{å®è·µ}\label{ux5b9eux8df5}

ä¸ºäº†å°†è¿™äº›æƒ³æ³•ä»˜è¯¸å®è·µï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†è§£å†³ä¸€äº›åŠçœŸå®çš„é—®é¢˜ã€‚æˆ‘
ä»¬å°†è®¨è®ºä¸‰ç§ä¸€èˆ¬æ–¹æ³•ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  é€šè¿‡åˆ›å»ºç®€å•çš„æ­£æ§åˆ¶å’Œè´Ÿæ§åˆ¶æ¥æ£€æŸ¥å·¥ä½œ
\item
  å°†æ­£åˆ™è¡¨è¾¾å¼ä¸å¸ƒå°”ä»£æ•°ç»“åˆä½¿ç”¨
\item
  ä½¿ç”¨å­—ç¬¦ä¸²æ“ä½œåˆ›å»ºå¤æ‚æ¨¡å¼
\end{enumerate}

\subsection{æ£€æŸ¥ä½ çš„å·¥ä½œ}\label{ux68c0ux67e5ux4f60ux7684ux5de5ux4f5c}

é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ‰¾å‡ºæ‰€æœ‰ä»¥``The''å¼€å¤´çš„å¥å­ã€‚ä»…
ä½¿ç”¨\texttt{\^{}}é”šç‚¹æ˜¯ä¸å¤Ÿçš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(sentences, }\StringTok{"\^{}The"}\NormalTok{)}
\CommentTok{\#\textgreater{}  [1] | \textless{}The\textgreater{} birch canoe slid on the smooth planks.}
\CommentTok{\#\textgreater{}  [4] | \textless{}The\textgreater{}se days a chicken leg is a rare dish.}
\CommentTok{\#\textgreater{}  [6] | \textless{}The\textgreater{} juice of lemons makes fine punch.}
\CommentTok{\#\textgreater{}  [7] | \textless{}The\textgreater{} box was thrown beside the parked truck.}
\CommentTok{\#\textgreater{}  [8] | \textless{}The\textgreater{} hogs were fed chopped corn and garbage.}
\CommentTok{\#\textgreater{} [11] | \textless{}The\textgreater{} boy was there when the sun rose.}
\CommentTok{\#\textgreater{} ... and 271 more}
\end{Highlighting}
\end{Shaded}

å› ä¸ºè¿™ä¸ªæ¨¡å¼ä¹Ÿä¼šåŒ¹é…ä»¥ \texttt{They} æˆ– \texttt{These}
ç­‰å•è¯å¼€å¤´çš„å¥å­ã€‚ä¸º äº†éœ€è¦ç¡®ä¿ ``e''
æ˜¯å•è¯çš„æœ€åä¸€ä¸ªå­—æ¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ ä¸€ä¸ªå•è¯è¾¹ç•Œæ¥å®ç°è¿™ä¸€ç‚¹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(sentences, }\StringTok{"\^{}The}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{b"}\NormalTok{)}
\CommentTok{\#\textgreater{}  [1] | \textless{}The\textgreater{} birch canoe slid on the smooth planks.}
\CommentTok{\#\textgreater{}  [6] | \textless{}The\textgreater{} juice of lemons makes fine punch.}
\CommentTok{\#\textgreater{}  [7] | \textless{}The\textgreater{} box was thrown beside the parked truck.}
\CommentTok{\#\textgreater{}  [8] | \textless{}The\textgreater{} hogs were fed chopped corn and garbage.}
\CommentTok{\#\textgreater{} [11] | \textless{}The\textgreater{} boy was there when the sun rose.}
\CommentTok{\#\textgreater{} [13] | \textless{}The\textgreater{} source of the huge river is the clear spring.}
\CommentTok{\#\textgreater{} ... and 250 more}
\end{Highlighting}
\end{Shaded}

å¦‚ä½•æŸ¥æ‰¾æ‰€æœ‰ä»¥ä»£è¯å¼€å¤´çš„å¥å­å‘¢ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(sentences, }\StringTok{"\^{}She|He|It|They}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{b"}\NormalTok{)}
\CommentTok{\#\textgreater{}  [3] | \textless{}It\textgreater{}\textquotesingle{}s easy to tell the depth of a well.}
\CommentTok{\#\textgreater{} [15] | \textless{}He\textgreater{}lp the woman get back to her feet.}
\CommentTok{\#\textgreater{} [27] | \textless{}He\textgreater{}r purse was full of useless trash.}
\CommentTok{\#\textgreater{} [29] | \textless{}It\textgreater{} snowed, rained, and hailed the same morning.}
\CommentTok{\#\textgreater{} [63] | \textless{}He\textgreater{} ran half way to the hardware store.}
\CommentTok{\#\textgreater{} [90] | \textless{}He\textgreater{} lay prone and hardly moved a limb.}
\CommentTok{\#\textgreater{} ... and 57 more}
\end{Highlighting}
\end{Shaded}

å¿«é€Ÿæ£€æŸ¥ç»“æœæ˜¾ç¤ºæˆ‘ä»¬å¾—åˆ°äº†ä¸€äº›é”™è¯¯çš„åŒ¹é…ã€‚è¿™ æ˜¯å› ä¸ºæˆ‘ä»¬å¿˜è®°äº†ä½¿ç”¨æ‹¬å·ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(sentences, }\StringTok{"\^{}(She|He|It|They)}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{b"}\NormalTok{)}
\CommentTok{\#\textgreater{}   [3] | \textless{}It\textgreater{}\textquotesingle{}s easy to tell the depth of a well.}
\CommentTok{\#\textgreater{}  [29] | \textless{}It\textgreater{} snowed, rained, and hailed the same morning.}
\CommentTok{\#\textgreater{}  [63] | \textless{}He\textgreater{} ran half way to the hardware store.}
\CommentTok{\#\textgreater{}  [90] | \textless{}He\textgreater{} lay prone and hardly moved a limb.}
\CommentTok{\#\textgreater{} [116] | \textless{}He\textgreater{} ordered peach pie with ice cream.}
\CommentTok{\#\textgreater{} [127] | \textless{}It\textgreater{} caught its hind paw in a rusty trap.}
\CommentTok{\#\textgreater{} ... and 51 more}
\end{Highlighting}
\end{Shaded}

ä½ å¯èƒ½ä¼šæƒ³ï¼Œå¦‚æœè¿™ç§é”™è¯¯æ²¡æœ‰å‡ºç°åœ¨å‰å‡ ä¸ªåŒ¹é…é¡¹ä¸­ï¼Œæˆ‘å¦‚ä½•æ‰èƒ½å‘ç°å®ƒã€‚ä¸€
ä¸ªå¥½çš„æŠ€å·§æ˜¯åˆ›å»ºä¸€äº›æ­£åŒ¹é…å’Œè´ŸåŒ¹é…é¡¹ï¼Œå¹¶ç”¨å®ƒä»¬æ¥æµ‹è¯•ä½ çš„æ¨¡å¼æ˜¯å¦æŒ‰é¢„æœŸå·¥ä½œï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pos }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"He is a boy"}\NormalTok{, }\StringTok{"She had a good time"}\NormalTok{)}
\NormalTok{neg }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Shells come from the sea"}\NormalTok{, }\StringTok{"Hadley said \textquotesingle{}It\textquotesingle{}s a great day\textquotesingle{}"}\NormalTok{)}

\NormalTok{pattern }\OtherTok{\textless{}{-}} \StringTok{"\^{}(She|He|It|They)}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{b"}
\FunctionTok{str\_detect}\NormalTok{(pos, pattern)}
\CommentTok{\#\textgreater{} [1] TRUE TRUE}
\FunctionTok{str\_detect}\NormalTok{(neg, pattern)}
\CommentTok{\#\textgreater{} [1] FALSE FALSE}
\end{Highlighting}
\end{Shaded}

é€šå¸¸æ¥è¯´ï¼Œä¸¾å‡ºå¥½çš„æ­£é¢ä¾‹å­æ¯”ä¸¾å‡ºè´Ÿé¢ä¾‹å­è¦å®¹æ˜“å¾—å¤šï¼Œå› ä¸ºä½ éœ€è¦ä¸€æ®µæ—¶é—´æ‰èƒ½ç†Ÿç»ƒåœ°ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥é¢„æµ‹ä½ çš„å¼±ç‚¹åœ¨å“ªé‡Œã€‚å°½
ç®¡å¦‚æ­¤ï¼Œå®ƒä»¬ä»ç„¶æ˜¯æœ‰ç”¨çš„:å½“ä½ å¤„ç†é—®é¢˜æ—¶ï¼Œä½ å¯ä»¥æ…¢æ…¢ç§¯ç´¯é”™è¯¯çš„é›†åˆï¼Œç¡®ä¿è‡ªå·±æ°¸è¿œä¸ä¼šçŠ¯åŒæ ·çš„é”™è¯¯ä¸¤æ¬¡ã€‚

\subsection{å¸ƒå°”è¿ç®—}\label{sec-boolean-operations}

æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æ‰¾åˆ°åªåŒ…å«è¾…éŸ³çš„å•è¯ï¼Œä¸€ç§æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªå­—ç¬¦ç±»ï¼ŒåŒ…å«é™¤äº†å…ƒéŸ³ï¼ˆ\texttt{{[}\^{}aeiou{]}}ï¼‰ä¹‹å¤–çš„æ‰€æœ‰å­—æ¯ï¼Œç„¶åå…è®¸è¿™ä¸ªå­—ç¬¦ç±»åŒ¹é…ä»»æ„æ•°é‡çš„å­—æ¯ï¼ˆ\texttt{{[}\^{}aeiou{]}+}ï¼‰ï¼Œç„¶åé€šè¿‡å°†å…¶é”šå®šåˆ°å­—ç¬¦ä¸²çš„å¼€å§‹å’Œç»“æŸæ¥å¼ºåˆ¶å®ƒåŒ¹é…æ•´ä¸ªå­—ç¬¦ä¸²ï¼ˆ\texttt{\^{}{[}\^{}aeiou{]}+\$}ï¼‰ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(words, }\StringTok{"\^{}[\^{}aeiou]+$"}\NormalTok{)}
\CommentTok{\#\textgreater{} [123] | \textless{}by\textgreater{}}
\CommentTok{\#\textgreater{} [249] | \textless{}dry\textgreater{}}
\CommentTok{\#\textgreater{} [328] | \textless{}fly\textgreater{}}
\CommentTok{\#\textgreater{} [538] | \textless{}mrs\textgreater{}}
\CommentTok{\#\textgreater{} [895] | \textless{}try\textgreater{}}
\CommentTok{\#\textgreater{} [952] | \textless{}why\textgreater{}}
\end{Highlighting}
\end{Shaded}

ä½†ä½ åå‘æ€è€ƒå°±ä¼šä½¿è¿™ä¸ªé—®é¢˜å˜å¾—æ›´ç®€å•ã€‚æˆ‘
ä»¬ä¸æ˜¯å¯»æ‰¾åªåŒ…å«è¾…éŸ³çš„å•è¯ï¼Œè€Œæ˜¯å¯»æ‰¾ä¸åŒ…å«ä»»ä½•å…ƒéŸ³çš„å•è¯ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(words[}\SpecialCharTok{!}\FunctionTok{str\_detect}\NormalTok{(words, }\StringTok{"[aeiou]"}\NormalTok{)])}
\CommentTok{\#\textgreater{} [1] | by}
\CommentTok{\#\textgreater{} [2] | dry}
\CommentTok{\#\textgreater{} [3] | fly}
\CommentTok{\#\textgreater{} [4] | mrs}
\CommentTok{\#\textgreater{} [5] | try}
\CommentTok{\#\textgreater{} [6] | why}
\end{Highlighting}
\end{Shaded}

å½“ä½ å¤„ç†é€»è¾‘ç»„åˆæ—¶ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠ``å’Œ''æˆ–``é''çš„é€»è¾‘ç»„åˆæ—¶ï¼Œè¿™æ˜¯ä¸€ç§æœ‰ç”¨çš„æ–¹æ³•ã€‚ä¾‹
å¦‚ï¼Œå‡è®¾ä½ æƒ³æ‰¾åˆ°æ‰€æœ‰åŒ…å«``a''å’Œ``b''çš„å•è¯ã€‚æ­£
åˆ™è¡¨è¾¾å¼ä¸­æ²¡æœ‰å†…ç½®çš„``å’Œ''è¿ç®—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»é€šè¿‡æŸ¥æ‰¾æ‰€æœ‰åŒ…å«``a''åè·Ÿ``b''æˆ–``b''åè·Ÿ``a''çš„å•è¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(words, }\StringTok{"a.*b|b.*a"}\NormalTok{)}
\CommentTok{\#\textgreater{}  [2] | \textless{}ab\textgreater{}le}
\CommentTok{\#\textgreater{}  [3] | \textless{}ab\textgreater{}out}
\CommentTok{\#\textgreater{}  [4] | \textless{}ab\textgreater{}solute}
\CommentTok{\#\textgreater{} [62] | \textless{}availab\textgreater{}le}
\CommentTok{\#\textgreater{} [66] | \textless{}ba\textgreater{}by}
\CommentTok{\#\textgreater{} [67] | \textless{}ba\textgreater{}ck}
\CommentTok{\#\textgreater{} ... and 24 more}
\end{Highlighting}
\end{Shaded}

ç»“åˆä¸¤æ¬¡è°ƒç”¨\texttt{str\_detect()}çš„ç»“æœä¼šæ›´ç®€å•ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{words[}\FunctionTok{str\_detect}\NormalTok{(words, }\StringTok{"a"}\NormalTok{) }\SpecialCharTok{\&} \FunctionTok{str\_detect}\NormalTok{(words, }\StringTok{"b"}\NormalTok{)]}
\CommentTok{\#\textgreater{}  [1] "able"      "about"     "absolute"  "available" "baby"      "back"     }
\CommentTok{\#\textgreater{}  [7] "bad"       "bag"       "balance"   "ball"      "bank"      "bar"      }
\CommentTok{\#\textgreater{} [13] "base"      "basis"     "bear"      "beat"      "beauty"    "because"  }
\CommentTok{\#\textgreater{} [19] "black"     "board"     "boat"      "break"     "brilliant" "britain"  }
\CommentTok{\#\textgreater{} [25] "debate"    "husband"   "labour"    "maybe"     "probable"  "table"}
\end{Highlighting}
\end{Shaded}

å¦‚æœæˆ‘ä»¬æƒ³æŸ¥çœ‹æ˜¯å¦æœ‰å•è¯åŒ…å«æ‰€æœ‰å…ƒéŸ³å­—æ¯æ€ä¹ˆåŠï¼Ÿå¦‚
æœæˆ‘ä»¬ä½¿ç”¨æ¨¡å¼æ¥åšï¼Œæˆ‘ä»¬éœ€è¦ç”Ÿæˆ 5!ï¼ˆ 120ï¼‰ç§ä¸åŒçš„æ¨¡å¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{words[}\FunctionTok{str\_detect}\NormalTok{(words, }\StringTok{"a.*e.*i.*o.*u"}\NormalTok{)]}
\CommentTok{\# ...}
\NormalTok{words[}\FunctionTok{str\_detect}\NormalTok{(words, }\StringTok{"u.*o.*i.*e.*a"}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

ç»“åˆäº”æ¬¡å¯¹\texttt{str\_detect()}çš„è°ƒç”¨ä¼šç®€å•å¾—å¤šï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{words[}
  \FunctionTok{str\_detect}\NormalTok{(words, }\StringTok{"a"}\NormalTok{) }\SpecialCharTok{\&}
  \FunctionTok{str\_detect}\NormalTok{(words, }\StringTok{"e"}\NormalTok{) }\SpecialCharTok{\&}
  \FunctionTok{str\_detect}\NormalTok{(words, }\StringTok{"i"}\NormalTok{) }\SpecialCharTok{\&}
  \FunctionTok{str\_detect}\NormalTok{(words, }\StringTok{"o"}\NormalTok{) }\SpecialCharTok{\&}
  \FunctionTok{str\_detect}\NormalTok{(words, }\StringTok{"u"}\NormalTok{)}
\NormalTok{]}
\CommentTok{\#\textgreater{} character(0)}
\end{Highlighting}
\end{Shaded}

ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœä½ å°è¯•åˆ›å»ºä¸€ä¸ªå•ä¸€çš„æ­£åˆ™è¡¨è¾¾å¼æ¥è§£å†³ä½ çš„é—®é¢˜å´é™·å…¥äº†å›°å¢ƒï¼Œä¸å¦¨é€€ä¸€æ­¥ï¼Œæƒ³æƒ³æ˜¯å¦å¯ä»¥å°†é—®é¢˜åˆ†è§£æˆæ›´å°çš„éƒ¨åˆ†ï¼Œé€ä¸€è§£å†³æ¯ä¸ªæŒ‘æˆ˜ï¼Œç„¶åå†è¿›è¡Œä¸‹ä¸€ä¸ªã€‚

\subsection{ç”¨ä»£ç åˆ›å»ºæ¨¡å¼}\label{ux7528ux4ee3ux7801ux521bux5efaux6a21ux5f0f}

å¦‚æœæˆ‘ä»¬æƒ³æ‰¾åˆ°æ‰€æœ‰æåˆ°é¢œè‰²çš„\texttt{sentences}æ€ä¹ˆåŠï¼ŸåŸº
æœ¬æ€è·¯å¾ˆç®€å•ï¼šæˆ‘ä»¬åªéœ€è¦å°†åˆ†éš”ç¬¦ä¸å•è¯è¾¹ç•Œç»“åˆèµ·æ¥ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(sentences, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{b(red|green|blue)}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{b"}\NormalTok{)}
\CommentTok{\#\textgreater{}   [2] | Glue the sheet to the dark \textless{}blue\textgreater{} background.}
\CommentTok{\#\textgreater{}  [26] | Two \textless{}blue\textgreater{} fish swam in the tank.}
\CommentTok{\#\textgreater{}  [92] | A wisp of cloud hung in the \textless{}blue\textgreater{} air.}
\CommentTok{\#\textgreater{} [148] | The spot on the blotter was made by \textless{}green\textgreater{} ink.}
\CommentTok{\#\textgreater{} [160] | The sofa cushion is \textless{}red\textgreater{} and of light weight.}
\CommentTok{\#\textgreater{} [174] | The sky that morning was clear and bright \textless{}blue\textgreater{}.}
\CommentTok{\#\textgreater{} ... and 20 more}
\end{Highlighting}
\end{Shaded}

ä½†æ˜¯éšç€é¢œè‰²çš„æ•°é‡å¢åŠ ï¼Œæ‰‹åŠ¨æ„å»ºè¿™ä¸ªæ¨¡å¼ä¼šå˜å¾—éå¸¸ç¹çã€‚å¦‚
æœæˆ‘ä»¬èƒ½æŠŠé¢œè‰²å­˜å‚¨åœ¨ä¸€ä¸ªå‘é‡é‡Œï¼Œé‚£ä¸æ˜¯å¾ˆå¥½å—ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rgb }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"red"}\NormalTok{, }\StringTok{"green"}\NormalTok{, }\StringTok{"blue"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å¯ä»¥ï¼åª
éœ€è¦ä½¿ç”¨\texttt{str\_c()}å’Œ\texttt{str\_flatten()}ä»å‘é‡ä¸­åˆ›å»ºæ¨¡å¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_c}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{b("}\NormalTok{, }\FunctionTok{str\_flatten}\NormalTok{(rgb, }\StringTok{"|"}\NormalTok{), }\StringTok{")}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{b"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "\textbackslash{}\textbackslash{}b(red|green|blue)\textbackslash{}\textbackslash{}b"}
\end{Highlighting}
\end{Shaded}

å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªå¥½çš„é¢œè‰²åˆ—è¡¨ï¼Œå¯ä»¥ä½¿è¿™ä¸ªæ¨¡å¼æ›´åŠ å…¨é¢ã€‚æˆ‘
ä»¬å¯ä»¥ä»Rç”¨äºç»˜å›¾çš„å†…ç½®é¢œè‰²åˆ—è¡¨å¼€å§‹:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str\_view}\NormalTok{(}\FunctionTok{colors}\NormalTok{())}
\CommentTok{\#\textgreater{} [1] | white}
\CommentTok{\#\textgreater{} [2] | aliceblue}
\CommentTok{\#\textgreater{} [3] | antiquewhite}
\CommentTok{\#\textgreater{} [4] | antiquewhite1}
\CommentTok{\#\textgreater{} [5] | antiquewhite2}
\CommentTok{\#\textgreater{} [6] | antiquewhite3}
\CommentTok{\#\textgreater{} ... and 651 more}
\end{Highlighting}
\end{Shaded}

ä½†æ˜¯è®©æˆ‘ä»¬é¦–å…ˆæ’é™¤ç¼–å·çš„é¢œè‰²å˜ä½“ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cols }\OtherTok{\textless{}{-}} \FunctionTok{colors}\NormalTok{()}
\NormalTok{cols }\OtherTok{\textless{}{-}}\NormalTok{ cols[}\SpecialCharTok{!}\FunctionTok{str\_detect}\NormalTok{(cols, }\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{d"}\NormalTok{)]}
\FunctionTok{str\_view}\NormalTok{(cols)}
\CommentTok{\#\textgreater{} [1] | white}
\CommentTok{\#\textgreater{} [2] | aliceblue}
\CommentTok{\#\textgreater{} [3] | antiquewhite}
\CommentTok{\#\textgreater{} [4] | aquamarine}
\CommentTok{\#\textgreater{} [5] | azure}
\CommentTok{\#\textgreater{} [6] | beige}
\CommentTok{\#\textgreater{} ... and 137 more}
\end{Highlighting}
\end{Shaded}

ç„¶åæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªåˆ—è¡¨è½¬æ¢æˆä¸€ä¸ªå·¨å¤§çš„æ¨¡å¼ã€‚æˆ‘
ä»¬ä¸ä¼šåœ¨è¿™é‡Œæ˜¾ç¤ºè¿™ä¸ªæ¨¡å¼ï¼Œå› ä¸ºå®ƒéå¸¸åºå¤§ï¼Œä½†ä½ å¯ä»¥çœ‹åˆ°å®ƒçš„å·¥ä½œæ•ˆæœï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pattern }\OtherTok{\textless{}{-}} \FunctionTok{str\_c}\NormalTok{(}\StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{b("}\NormalTok{, }\FunctionTok{str\_flatten}\NormalTok{(cols, }\StringTok{"|"}\NormalTok{), }\StringTok{")}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{b"}\NormalTok{)}
\FunctionTok{str\_view}\NormalTok{(sentences, pattern)}
\CommentTok{\#\textgreater{}   [2] | Glue the sheet to the dark \textless{}blue\textgreater{} background.}
\CommentTok{\#\textgreater{}  [12] | A rod is used to catch \textless{}pink\textgreater{} \textless{}salmon\textgreater{}.}
\CommentTok{\#\textgreater{}  [26] | Two \textless{}blue\textgreater{} fish swam in the tank.}
\CommentTok{\#\textgreater{}  [66] | Cars and busses stalled in \textless{}snow\textgreater{} drifts.}
\CommentTok{\#\textgreater{}  [92] | A wisp of cloud hung in the \textless{}blue\textgreater{} air.}
\CommentTok{\#\textgreater{} [112] | Leaves turn \textless{}brown\textgreater{} and \textless{}yellow\textgreater{} in the fall.}
\CommentTok{\#\textgreater{} ... and 57 more}
\end{Highlighting}
\end{Shaded}

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ\texttt{cols}åªåŒ…å«æ•°å­—å’Œå­—æ¯ï¼Œæ‰€ä»¥ä½ ä¸éœ€è¦æ‹…å¿ƒå…ƒå­—ç¬¦ã€‚ä½†
æ˜¯ä¸€èˆ¬æ¥è¯´ï¼Œæ¯å½“ä½ ä»ç°æœ‰å­—ç¬¦ä¸²åˆ›å»ºæ¨¡å¼æ—¶ï¼Œæœ€å¥½é€šè¿‡\texttt{str\_escape()}å¯¹å®ƒä»¬è¿›è¡Œå¤„ç†ï¼Œä»¥ç¡®ä¿å®ƒä»¬æŒ‰å­—é¢æ„ä¹‰è¿›è¡ŒåŒ¹é…ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-41}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  å¯¹äºä»¥ä¸‹æ¯ä¸€ä¸ªæŒ‘æˆ˜ï¼Œå°è¯•ä½¿ç”¨å•ä¸ªæ­£åˆ™è¡¨è¾¾å¼å’Œå¤šä¸ª\texttt{str\_detect()}è°ƒç”¨çš„ç»„åˆæ¥è§£å†³å®ƒã€‚F
  or each of the following challenges, try solving it by using both a
  single regular expression, and a combination of multiple
  \texttt{str\_detect()} calls.

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \tightlist
  \item
    æ‰¾å‡ºæ‰€æœ‰ä»¥xå¼€å¤´æˆ–ä»¥xç»“å°¾çš„\texttt{words}ï¼›
  \item
    æ‰¾å‡ºæ‰€æœ‰ä»¥å…ƒéŸ³å­—æ¯å¼€å¤´å¹¶ä»¥è¾…éŸ³å­—æ¯ç»“å°¾çš„\texttt{words}ï¼›
  \item
    æ˜¯å¦å­˜åœ¨åŒ…å«è‡³å°‘æ¯ä¸€ç§å…ƒéŸ³å­—æ¯çš„\texttt{words} ï¼Ÿ
  \end{enumerate}
\item
  æ„å»ºæ¨¡å¼æ¥æ‰¾åˆ°æ”¯æŒæˆ–åå¯¹``iåœ¨eå‰é¢ï¼Œé™¤éåœ¨cåé¢''è¿™ä¸€è§„åˆ™çš„è¯æ®ã€‚
\item
  \texttt{colors()}åŒ…å«äº†ä¸€äº›åƒ``lightgray''å’Œ``darkblue''è¿™æ ·çš„ä¿®é¥°ç¬¦ã€‚å¦‚
  ä½•è‡ªåŠ¨è¯†åˆ«è¿™äº›ä¿®é¥°ç¬¦ï¼Ÿï¼ˆ è€ƒè™‘å¦‚ä½•æ£€æµ‹å’Œç§»é™¤è¢«ä¿®é¥°çš„é¢œè‰²ï¼‰ã€‚
\item
  åˆ›å»ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¥æŸ¥æ‰¾ä»»ä½•åŸºç¡€Ræ•°æ®é›†ã€‚ä½ 
  å¯ä»¥é€šè¿‡\texttt{data()}çš„ç‰¹æ®Šç”¨æ³•æ¥è·å–è¿™äº›æ•°æ®é›†çš„åˆ—è¡¨ï¼š\texttt{data(package\ =\ "datasets")\$results{[},\ "Item"{]}}ã€‚è¯·
  æ³¨æ„ï¼Œä¸€äº›æ—§çš„æ•°æ®é›†æ˜¯å•ç‹¬çš„å‘é‡ï¼Œè¿™äº›å‘é‡åœ¨æ‹¬å·ä¸­åŒ…å«``æ•°æ®æ¡†''çš„åç§°ï¼Œå› æ­¤ä½ éœ€è¦å»æ‰è¿™äº›æ‹¬å·ã€‚
\end{enumerate}

\section{å…¶ä»–åœ°æ–¹çš„æ­£åˆ™è¡¨è¾¾å¼}\label{ux5176ux4ed6ux5730ux65b9ux7684ux6b63ux5219ux8868ux8fbeux5f0f}

å°±åƒåœ¨\texttt{stringr}å’Œ\texttt{tidyr}å‡½æ•°ä¸­ä¸€æ ·ï¼ŒRä¸­è¿˜æœ‰è®¸å¤šå…¶ä»–åœ°æ–¹å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€‚ä¸‹
é¢å°†æè¿°åœ¨tidyverseç”Ÿæ€ç³»ç»Ÿå’ŒåŸºç¡€Rä¸­å…¶ä»–ä¸€äº›æœ‰ç”¨çš„å‡½æ•°ã€‚

\subsection{tidyverse}\label{tidyverse-1}

è¿˜æœ‰ä¸‰ä¸ªç‰¹åˆ«æœ‰ç”¨çš„åœ°æ–¹å¯èƒ½éœ€è¦ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼š

\begin{itemize}
\item
  \texttt{matches(pattern)} å‡½æ•°ä¼šé€‰æ‹©æ‰€æœ‰åç§°ä¸ç»™å®šæ¨¡å¼åŒ¹é…çš„å˜é‡ã€‚å®ƒ
  æ˜¯ä¸€ä¸ª``tidyselect''å‡½æ•°ï¼Œä½ å¯ä»¥åœ¨tidyverseç”Ÿæ€ç³»ç»Ÿä¸­ä»»ä½•é€‰æ‹©å˜é‡çš„å‡½æ•°ï¼ˆä¾‹å¦‚\texttt{select()},\texttt{rename\_with()}å’Œ\texttt{across()}ï¼‰ä¸­ä½¿ç”¨å®ƒã€‚
\item
  \texttt{pivot\_longer()\textquotesingle{}s}
  å‡½æ•°çš„\texttt{names\_pattern}å‚æ•°æ¥å—ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å‘é‡ï¼Œä¸\texttt{separate\_wider\_regex()}ç±»ä¼¼ï¼Œåœ¨ä»å…·æœ‰å¤æ‚ç»“æ„çš„å˜é‡åç§°ä¸­æå–æ•°æ®æ—¶éå¸¸æœ‰ç”¨ã€‚
\item
  \texttt{separate\_longer\_delim()}å’Œ\texttt{separate\_wider\_delim()}å‡½æ•°ä¸­çš„\texttt{delim}å‚æ•°é€šå¸¸ç”¨äºåŒ¹é…ä¸€ä¸ªå›ºå®šçš„å­—ç¬¦ä¸²ï¼Œä½†ä½ å¯ä»¥ä½¿ç”¨\texttt{regex()}æ¥ä½¿å…¶åŒ¹é…ä¸€ä¸ªæ¨¡å¼ã€‚è¿™
  åœ¨ä½ æƒ³åŒ¹é…ä¸€ä¸ªé€—å·ï¼ˆåé¢å¯èƒ½è·Ÿç€ä¸€ä¸ªç©ºæ ¼ï¼‰æ—¶éå¸¸æœ‰ç”¨ï¼Œä¾‹å¦‚\texttt{regex(",\ ?")}ã€‚
\end{itemize}

\subsection{åŸºç¡€R}\label{ux57faux7840r}

\texttt{apropos(pattern)} ä¼šæœç´¢å…¨å±€ç¯å¢ƒä¸­æ‰€æœ‰ä¸ç»™å®šæ¨¡å¼åŒ¹é…çš„å¯¹è±¡ã€‚å¦‚
æœä½ ä¸å¤ªè®°å¾—æŸä¸ªå‡½æ•°çš„åç§°ï¼Œè¿™æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{apropos}\NormalTok{(}\StringTok{"replace"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "\%+replace\%"       "replace"          "replace\_na"      }
\CommentTok{\#\textgreater{} [4] "setReplaceMethod" "str\_replace"      "str\_replace\_all" }
\CommentTok{\#\textgreater{} [7] "str\_replace\_na"   "theme\_replace"}
\end{Highlighting}
\end{Shaded}

\texttt{list.files(path,\ pattern)}ä¼šåˆ—å‡º\texttt{path}ä¸­æ‰€æœ‰åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼\texttt{pattern}çš„æ–‡ä»¶ã€‚ä¾‹
å¦‚ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ R Markdown æ–‡ä»¶ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(}\FunctionTok{list.files}\NormalTok{(}\AttributeTok{pattern =} \StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{.Rmd$"}\NormalTok{))}
\CommentTok{\#\textgreater{} character(0)}
\end{Highlighting}
\end{Shaded}

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒåŸºç¡€Rä½¿ç”¨çš„æ¨¡å¼è¯­è¨€ä¸\texttt{stringr}ä½¿ç”¨çš„ç•¥æœ‰ä¸åŒã€‚è¿™
æ˜¯å› ä¸º\texttt{stringr}æ˜¯å»ºç«‹åœ¨\href{https://stringi.gagolewski.com}{stringi}åŒ…ä¹‹ä¸Šçš„ï¼Œè€Œ\texttt{stringi}åŒ…åˆæ˜¯å»ºç«‹åœ¨\href{https://unicode-org.github.io/icu/userguide/strings/regexp.html}{ICU}å¼•æ“ä¹‹ä¸Šçš„ï¼Œè€ŒåŸºç¡€Rå‡½æ•°åˆ™ä½¿ç”¨\href{https://github.com/laurikari/tre}{TRE}å¼•æ“æˆ–\href{https://www.pcre.org}{PCRE}å¼•æ“ï¼Œè¿™å–å†³äºä½ æ˜¯å¦è®¾ç½®äº†\texttt{perl\ =\ TRUE}ã€‚å¹¸
è¿çš„æ˜¯ï¼Œæ­£åˆ™è¡¨è¾¾å¼çš„åŸºç¡€çŸ¥è¯†å·²ç»éå¸¸å®Œå–„ï¼Œå› æ­¤ä½ åœ¨ä½¿ç”¨æœ¬ä¹¦ä¸­å°†è¦å­¦ä¹ çš„æ¨¡å¼æ—¶ï¼Œå¾ˆå°‘ä¼šé‡åˆ°å˜åŒ–ã€‚åª
æœ‰å½“ä½ å¼€å§‹ä¾èµ–é«˜çº§ç‰¹æ€§ï¼Œå¦‚å¤æ‚çš„Unicodeå­—ç¬¦èŒƒå›´æˆ–ä½¿ç”¨\texttt{(?â€¦)}è¯­æ³•çš„ç‰¹æ®Šç‰¹æ€§æ—¶æ‰éœ€è¦æ„è¯†åˆ°è¿™ç§å·®å¼‚ã€‚

\section{å°ç»“}\label{ux5c0fux7ed3-14}

ç”±äºæ¯ä¸ªæ ‡ç‚¹ç¬¦å·éƒ½å¯èƒ½è¢«èµ‹äºˆå¤šé‡å«ä¹‰ï¼Œæ­£åˆ™è¡¨è¾¾å¼æ˜¯ç°å­˜æœ€ç´§å‡‘çš„è¯­è¨€ä¹‹ä¸€ã€‚å®ƒ
ä»¬ä¸€å¼€å§‹ç¡®å®ä¼šè®©äººæ„Ÿåˆ°å›°æƒ‘ï¼Œä½†å½“ä½ è®­ç»ƒè‡ªå·±çš„çœ¼ç›å»é˜…è¯»å®ƒä»¬ï¼Œå¤§è„‘å»ç†è§£å®ƒä»¬æ—¶ï¼Œä½ å°±æŒæ¡äº†ä¸€é¡¹å¼ºå¤§çš„æŠ€èƒ½ï¼Œä½ å¯ä»¥åœ¨Rå’Œå…¶ä»–è®¸å¤šåœ°æ–¹ä½¿ç”¨è¿™é¡¹æŠ€èƒ½ã€‚

åœ¨æœ¬ç« ä¸­ï¼Œé€šè¿‡å­¦ä¹ æœ€æœ‰ç”¨çš„\texttt{stringr}å‡½æ•°å’Œæ­£åˆ™è¡¨è¾¾å¼è¯­è¨€çš„æœ€é‡è¦ç»„ä»¶ï¼Œå¼€å§‹äº†æˆä¸ºæ­£åˆ™è¡¨è¾¾å¼å¤§å¸ˆçš„æ—…ç¨‹ã€‚è€Œ
ä¸”è¿˜æœ‰å¾ˆå¤šèµ„æºå¯ä»¥è¿›ä¸€æ­¥å­¦ä¹ ã€‚

ä¸€ä¸ªä¸é”™çš„å‡ºå‘ç‚¹æ˜¯\texttt{vignette("regular-expressions",\ package\ =\ "stringr")}ï¼Œå®ƒè®°å½•äº†\texttt{stringr}æ”¯æŒçš„å…¨éƒ¨è¯­æ³•ï¼›å¦å¤–å¯ä»¥ä»\href{https://www.regular-expressions.info/\%E3\%80\%82}{https://www.regular-expressions.info/}è·å–æœ‰ç”¨çš„å‚è€ƒä¿¡æ¯ã€‚è¿™
ä¸ªç½‘ç«™ä¸æ˜¯é’ˆå¯¹Rçš„ï¼Œä½†å¯ä»¥ç”¨å®ƒæ¥å­¦ä¹ æ­£åˆ™è¡¨è¾¾å¼çš„æœ€å…ˆè¿›ç‰¹æ€§å’Œå·¥ä½œåŸç†ã€‚

å¦å¤–éœ€è¦çŸ¥é“çš„æ˜¯ï¼Œ\texttt{stringr}æ˜¯ç”±Marek
Gagolewskiåœ¨\texttt{stringi}çš„åŸºç¡€ä¸Šå®ç°çš„ï¼Œå¦‚æœåœ¨\texttt{stringr}ä¸­æ‰¾ä¸åˆ°ä½ éœ€è¦çš„å‡½æ•°ï¼Œä¸è¦æ‹…å¿ƒæŸ¥é˜…\texttt{stringi}ã€‚ä½ 
ä¼šå‘ç°\texttt{stringi}éå¸¸å®¹æ˜“ä¸Šæ‰‹ï¼Œå› ä¸ºå®ƒéµå¾ªäº†\texttt{stringr}çš„è®¸å¤šç›¸åŒçº¦å®šã€‚

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºä¸å­—ç¬¦ä¸²å¯†åˆ‡ç›¸å…³çš„æ•°æ®ç»“æ„ï¼šå› å­ï¼ˆfactorsï¼‰ã€‚å› 
å­ç”¨äºåœ¨Rä¸­è¡¨ç¤ºåˆ†ç±»æ•°æ®ï¼Œå³å…·æœ‰å›ºå®šå’Œå·²çŸ¥å¯èƒ½å€¼é›†çš„æ•°æ®ï¼Œè¿™äº›å¯èƒ½å€¼ç”±å­—ç¬¦ä¸²å‘é‡æ ‡è¯†ã€‚

\chapter{å› å­}\label{sec-factors}

\section{å¼•è¨€}\label{ux5f15ux8a00-11}

å› å­ç”¨äºåˆ†ç±»å˜é‡ï¼Œè¿™äº›å˜é‡å…·æœ‰ä¸€ç»„å›ºå®šä¸”å·²çŸ¥çš„å¯èƒ½å–å€¼ã€‚å½“
ä½ å¸Œæœ›ä»¥éå­—æ¯é¡ºåºæ˜¾ç¤ºå­—ç¬¦å‘é‡æ—¶ï¼Œå®ƒä»¬ä¹Ÿå¾ˆæœ‰ç”¨ã€‚

æˆ‘ä»¬å°†ä»è§£é‡Šä¸ºä»€ä¹ˆæ•°æ®åˆ†æéœ€è¦å› å­ (factor)\footnote{å®ƒä»¬å¯¹å»ºæ¨¡ä¹Ÿå¾ˆé‡è¦ã€‚}
ä»¥åŠå¦‚ä½•ä½¿ç”¨\texttt{factor()}å‡½æ•°åˆ›å»ºå®ƒä»¬å¼€å§‹ã€‚
æ¥ç€ï¼Œæˆ‘ä»¬å°†å‘æ‚¨ä»‹ç»\texttt{gss\_cat}æ•°æ®é›†ï¼Œå®ƒåŒ…å«ä¸€ç³»åˆ—å¯ä¾›å®éªŒçš„åˆ†ç±»å˜é‡ã€‚
ä¹‹åï¼Œä½ å°†ä½¿ç”¨æ­¤æ•°æ®é›†ç»ƒä¹ ä¿®æ”¹å› å­çš„é¡ºåºå’Œå€¼ï¼Œæœ€åæˆ‘ä»¬å°†è®¨è®ºæœ‰åºå› å­ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-11}

åŸºç¡€ R æä¾›äº†ä¸€äº›ç”¨äºåˆ›å»ºå’Œæ“ä½œå› å­çš„åŸºæœ¬å·¥å…·ã€‚æˆ‘ ä»¬å°†ä½¿ç”¨
\texttt{forcats} åŒ…æ¥è¡¥å……è¿™äº›å·¥å…·ï¼Œ\texttt{forcats} æ˜¯ tidyverse
çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæä¾›äº†å¤„ç†åˆ†ç±»å˜é‡ (å®ƒæ˜¯ factors çš„å­—æ¯é‡æ–°æ’åˆ—!)
çš„å·¥å…·ï¼Œå¹¶æä¾›äº†å¤šç§ä¸å› å­ä¸€èµ·å·¥ä½œçš„è¾…åŠ©å‡½æ•°ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\section{å› å­åŸºç¡€}\label{ux56e0ux5b50ux57faux7840}

å‡è®¾ä½ æœ‰ä¸€ä¸ªè®°å½•æœˆä»½çš„å˜é‡:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x1 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Dec"}\NormalTok{, }\StringTok{"Apr"}\NormalTok{, }\StringTok{"Jan"}\NormalTok{, }\StringTok{"Mar"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

ä½¿ç”¨å­—ç¬¦ä¸²è®°å½•è¿™ä¸ªå˜é‡æœ‰ä¸¤ä¸ªé—®é¢˜:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  åªæœ‰åäºŒä¸ªå¯èƒ½çš„æœˆä»½ï¼Œè€Œä¸”æ²¡æœ‰ä»€ä¹ˆèƒ½é˜»æ­¢ä½ å‡ºç°æ‰“å­—é”™è¯¯ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x2 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Dec"}\NormalTok{, }\StringTok{"Apr"}\NormalTok{, }\StringTok{"Jam"}\NormalTok{, }\StringTok{"Mar"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  å®ƒå¹¶æ²¡æœ‰ä»¥æœ‰ç”¨çš„æ–¹å¼è¿›è¡Œæ’åºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sort}\NormalTok{(x1)}
\CommentTok{\#\textgreater{} [1] "Apr" "Dec" "Jan" "Mar"}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

ä½ å¯ä»¥ä½¿ç”¨å› å­ï¼ˆfactorï¼‰æ¥è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ã€‚è¦
åˆ›å»ºä¸€ä¸ªå› å­ï¼Œé¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ªæœ‰æ•ˆæ°´å¹³ (\textbf{levels}) çš„åˆ—è¡¨ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{month\_levels }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}
  \StringTok{"Jan"}\NormalTok{, }\StringTok{"Feb"}\NormalTok{, }\StringTok{"Mar"}\NormalTok{, }\StringTok{"Apr"}\NormalTok{, }\StringTok{"May"}\NormalTok{, }\StringTok{"Jun"}\NormalTok{, }
  \StringTok{"Jul"}\NormalTok{, }\StringTok{"Aug"}\NormalTok{, }\StringTok{"Sep"}\NormalTok{, }\StringTok{"Oct"}\NormalTok{, }\StringTok{"Nov"}\NormalTok{, }\StringTok{"Dec"}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

ç°åœ¨ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªå› å­:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y1 }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(x1, }\AttributeTok{levels =}\NormalTok{ month\_levels)}
\NormalTok{y1}
\CommentTok{\#\textgreater{} [1] Dec Apr Jan Mar}
\CommentTok{\#\textgreater{} Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec}

\FunctionTok{sort}\NormalTok{(y1)}
\CommentTok{\#\textgreater{} [1] Jan Mar Apr Dec}
\CommentTok{\#\textgreater{} Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec}
\end{Highlighting}
\end{Shaded}

ä»»ä½•ä¸åœ¨æ°´å¹³åˆ—è¡¨ä¸­çš„å€¼éƒ½å°†è¢«é™é»˜åœ°è½¬æ¢ä¸ºNAï¼ˆç¼ºå¤±å€¼ï¼‰ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y2 }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(x2, }\AttributeTok{levels =}\NormalTok{ month\_levels)}
\NormalTok{y2}
\CommentTok{\#\textgreater{} [1] Dec  Apr  \textless{}NA\textgreater{} Mar }
\CommentTok{\#\textgreater{} Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec}
\end{Highlighting}
\end{Shaded}

è¿™ä¼¼ä¹æœ‰ç‚¹é£é™©ï¼Œå› æ­¤ä½ å¯èƒ½æƒ³ç”¨\texttt{forcats::fct()}æ¥ä»£æ›¿ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y2 }\OtherTok{\textless{}{-}} \FunctionTok{fct}\NormalTok{(x2, }\AttributeTok{levels =}\NormalTok{ month\_levels)}
\CommentTok{\#\textgreater{} Error in \textasciigrave{}fct()\textasciigrave{}:}
\CommentTok{\#\textgreater{} ! All values of \textasciigrave{}x\textasciigrave{} must appear in \textasciigrave{}levels\textasciigrave{} or \textasciigrave{}na\textasciigrave{}}
\CommentTok{\#\textgreater{} i Missing level: "Jam"}
\end{Highlighting}
\end{Shaded}

å¦‚æœçœç•¥äº†æ°´å¹³ï¼Œåˆ™å°†æŒ‰ç…§å­—æ¯é¡ºåºä»æ•°æ®ä¸­è·å–:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{factor}\NormalTok{(x1)}
\CommentTok{\#\textgreater{} [1] Dec Apr Jan Mar}
\CommentTok{\#\textgreater{} Levels: Apr Dec Jan Mar}
\end{Highlighting}
\end{Shaded}

æŒ‰å­—æ¯é¡ºåºæ’åºç¨æœ‰é£é™©ï¼Œå› ä¸ºå¹¶éæ¯å°è®¡ç®—æœºéƒ½ä¼šä»¥ç›¸åŒçš„æ–¹å¼å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ’åºã€‚å› 
æ­¤ï¼Œ\texttt{forcats::fct()}æ˜¯æŒ‰ç…§é¦–æ¬¡å‡ºç°çš„é¡ºåºè¿›è¡Œæ’åºçš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fct}\NormalTok{(x1)}
\CommentTok{\#\textgreater{} [1] Dec Apr Jan Mar}
\CommentTok{\#\textgreater{} Levels: Dec Apr Jan Mar}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ éœ€è¦ç›´æ¥è®¿é—®æœ‰æ•ˆçš„æ°´å¹³é›†åˆï¼Œå¯ä»¥ä½¿ç”¨\texttt{levels()}å‡½æ•°æ¥åšåˆ°è¿™ä¸€ç‚¹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{levels}\NormalTok{(y2)}
\CommentTok{\#\textgreater{}  [1] "Jan" "Feb" "Mar" "Apr" "May" "Jun" "Jul" "Aug" "Sep" "Oct" "Nov" "Dec"}
\end{Highlighting}
\end{Shaded}

ä½ ä¹Ÿå¯ä»¥åœ¨ä½¿ç”¨\texttt{readr}åŒ…è¯»å–æ•°æ®æ—¶ï¼Œé€šè¿‡\texttt{col\_factor()}æ¥åˆ›å»ºä¸€ä¸ªå› å­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{csv }\OtherTok{\textless{}{-}} \StringTok{"}
\StringTok{month,value}
\StringTok{Jan,12}
\StringTok{Feb,56}
\StringTok{Mar,12"}

\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(csv, }\AttributeTok{col\_types =} \FunctionTok{cols}\NormalTok{(}\AttributeTok{month =} \FunctionTok{col\_factor}\NormalTok{(month\_levels)))}
\NormalTok{df}\SpecialCharTok{$}\NormalTok{month}
\CommentTok{\#\textgreater{} [1] Jan Feb Mar}
\CommentTok{\#\textgreater{} Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec}
\end{Highlighting}
\end{Shaded}

\section{ä¸€èˆ¬ç¤¾ä¼šè°ƒæŸ¥}\label{ux4e00ux822cux793eux4f1aux8c03ux67e5}

åœ¨æœ¬ç« çš„å‰©ä½™éƒ¨åˆ†æˆ‘ä»¬å°†ä½¿ç”¨\texttt{forcats::gss\_cat}ï¼Œå®ƒæ˜¯æ¥è‡ªä¸€èˆ¬ç¤¾ä¼šè°ƒæŸ¥
(\href{https://gss.norc.org}{General Social Survey}) çš„æ ·æœ¬æ•°æ®ã€‚è¯¥
è°ƒæŸ¥æ˜¯ç”±èŠåŠ å“¥å¤§å­¦ç‹¬ç«‹ç ”ç©¶æœºæ„NORCä¸»å¯¼ï¼Œåœ¨ç¾å›½è¿›è¡Œçš„ä¸€é¡¹é•¿æœŸè°ƒæŸ¥ã€‚è¿™
é¡¹è°ƒæŸ¥åŒ…å«æ•°åƒä¸ªé—®é¢˜ï¼Œå› æ­¤åœ¨\texttt{gss\_cat}ä¸­Hadleyé€‰æ‹©äº†ä¸€äº›é—®é¢˜æ¥è¯´æ˜ä½ åœ¨å¤„ç†å› å­æ—¶ä¼šé‡åˆ°çš„ä¸€äº›å¸¸è§æŒ‘æˆ˜ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gss\_cat}
\CommentTok{\#\textgreater{} \# A tibble: 21,483 x 9}
\CommentTok{\#\textgreater{}    year marital         age race  rincome        partyid           }
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}fct\textgreater{}         \textless{}int\textgreater{} \textless{}fct\textgreater{} \textless{}fct\textgreater{}          \textless{}fct\textgreater{}             }
\CommentTok{\#\textgreater{} 1  2000 Never married    26 White $8000 to 9999  Ind,near rep      }
\CommentTok{\#\textgreater{} 2  2000 Divorced         48 White $8000 to 9999  Not str republican}
\CommentTok{\#\textgreater{} 3  2000 Widowed          67 White Not applicable Independent       }
\CommentTok{\#\textgreater{} 4  2000 Never married    39 White Not applicable Ind,near rep      }
\CommentTok{\#\textgreater{} 5  2000 Divorced         25 White Not applicable Not str democrat  }
\CommentTok{\#\textgreater{} 6  2000 Married          25 White $20000 {-} 24999 Strong democrat   }
\CommentTok{\#\textgreater{} \# i 21,477 more rows}
\CommentTok{\#\textgreater{} \# i 3 more variables: relig \textless{}fct\textgreater{}, denom \textless{}fct\textgreater{}, tvhours \textless{}int\textgreater{}}
\end{Highlighting}
\end{Shaded}

(è®°ä½ï¼Œç”±äºè¯¥æ•°æ®é›†æ˜¯ç”±åŒ…æä¾›çš„ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨\texttt{?gss\_cat}è·å–æœ‰å…³å˜é‡çš„æ›´å¤šä¿¡æ¯)

å½“å› å­ (factors)
å­˜å‚¨åœ¨tibbleä¸­æ—¶ï¼Œä½ ä¸èƒ½é‚£ä¹ˆå®¹æ˜“åœ°çœ‹åˆ°å®ƒä»¬çš„æ°´å¹³ï¼ˆlevelsï¼‰ã€‚æŸ¥
çœ‹å®ƒä»¬çš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨\texttt{count()}å‡½æ•°ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gss\_cat }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{count}\NormalTok{(race)}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 2}
\CommentTok{\#\textgreater{}   race      n}
\CommentTok{\#\textgreater{}   \textless{}fct\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 Other  1959}
\CommentTok{\#\textgreater{} 2 Black  3129}
\CommentTok{\#\textgreater{} 3 White 16395}
\end{Highlighting}
\end{Shaded}

åœ¨å¤„ç†å› å­æ—¶ï¼Œä¸¤ç§æœ€å¸¸è§çš„æ“ä½œæ˜¯æ”¹å˜æ°´å¹³çš„é¡ºåºå’Œæ”¹å˜æ°´å¹³çš„å€¼ã€‚è¿™
äº›æ“ä½œå°†åœ¨ä¸‹é¢çš„éƒ¨åˆ†ä¸­æè¿°ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-42}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  æ¢ç´¢\texttt{rincome} (ç”³æŠ¥æ”¶å…¥) çš„åˆ†å¸ƒã€‚é»˜
  è®¤çš„æ¡å½¢å›¾ä¸ºä»€ä¹ˆéš¾ä»¥ç†è§£ï¼Ÿå¦‚ ä½•æ”¹è¿›è¯¥å›¾ï¼Ÿ
\item
  è¿™ä¸ªè°ƒæŸ¥ä¸­å“ªä¸ª\texttt{relig}æœ€å¸¸è§ï¼Ÿå“ª ä¸ª\texttt{partyid}æœ€å¸¸è§ï¼Ÿ
\item
  \texttt{denom}ï¼ˆæ•™æ´¾ï¼‰é€‚ç”¨äºå“ªä¸ªå®—æ•™ï¼Ÿä½  å¦‚ä½•ç”¨è¡¨æ ¼æ¥æŸ¥æ‰¾ï¼Ÿä½ 
  å¦‚ä½•ç”¨å¯è§†åŒ–æ¥æŸ¥æ‰¾ï¼Ÿ
\end{enumerate}

\section{ä¿®æ”¹å› å­é¡ºåº}\label{sec-modifying-factor-order}

åœ¨å¯è§†åŒ–ä¸­æ”¹å˜å› å­æ°´å¹³çš„é¡ºåºé€šå¸¸å¾ˆæœ‰ç”¨ã€‚ä¾‹
å¦‚ï¼Œå‡è®¾ä½ æƒ³è¦æ¢ç´¢ä¸åŒå®—æ•™æ¯å¤©å¹³å‡çœ‹ç”µè§†çš„å°æ—¶æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{relig\_summary }\OtherTok{\textless{}{-}}\NormalTok{ gss\_cat }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(relig) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{tvhours =} \FunctionTok{mean}\NormalTok{(tvhours, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{()}
\NormalTok{  )}

\FunctionTok{ggplot}\NormalTok{(relig\_summary, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ tvhours, }\AttributeTok{y =}\NormalTok{ relig)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{factors_files/figure-pdf/unnamed-chunk-16-1.pdf}

è¿™ä¸ªå›¾å¾ˆéš¾é˜…è¯»ï¼Œå› ä¸ºæ²¡æœ‰æ•´ä½“çš„æ¨¡å¼ã€‚æˆ‘
ä»¬å¯ä»¥ä½¿ç”¨\texttt{fct\_reorder()}å‡½æ•°æ¥é‡æ–°æ’åº\texttt{relig}çš„æ°´å¹³ä»¥æ”¹è¿›å®ƒã€‚\texttt{f}
\texttt{ct\_reorder()}æ¥å—ä¸‰ä¸ªå‚æ•°ï¼š

\begin{itemize}
\tightlist
\item
  \texttt{.f}, è¦ä¿®æ”¹æ°´å¹³çš„å› å­ï¼›
\item
  \texttt{.x}, ä¸€ä¸ªç”¨äºå¯¹æ°´å¹³é‡æ–°æ’åºçš„æ•°å­—å‘é‡ï¼›
\item
  å¯é€‰å‚æ•°ï¼Œ\texttt{.fun}æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨\texttt{.f}çš„æ¯ä¸ªå€¼å¯¹åº”å¤šä¸ª\texttt{.x}å€¼æ—¶ä½¿ç”¨ã€‚é»˜è®¤å€¼æ˜¯\texttt{median}ã€‚
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(relig\_summary, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ tvhours, }\AttributeTok{y =} \FunctionTok{fct\_reorder}\NormalTok{(relig, tvhours))) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{factors_files/figure-pdf/unnamed-chunk-17-1.pdf}

å®—æ•™é‡æ–°æ’åºåï¼Œå¯ä»¥æ›´å®¹æ˜“çœ‹å‡º``ä¸çŸ¥é“''ç±»åˆ«çš„äººçœ‹ç”µè§†æ›´å¤šï¼Œè€Œå°åº¦æ•™å’Œå…¶ä»–ä¸œæ–¹å®—æ•™çš„äººåˆ™çœ‹å¾—æ›´å°‘ã€‚

å½“ä½ å¼€å§‹è¿›è¡Œæ›´å¤æ‚çš„è½¬æ¢æ—¶ï¼Œæˆ‘ä»¬å»ºè®®ä½ å°†å®ƒä»¬ä»\texttt{aes()}ä¸­ç§»å‡ºï¼Œå¹¶æ”¾å…¥ä¸€ä¸ªå•ç‹¬çš„\texttt{mutate()}æ­¥éª¤ä¸­ã€‚ä¾‹
å¦‚ï¼Œä½ å¯ä»¥å°†ä¸Šé¢çš„å›¾å½¢é‡å†™ä¸ºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{relig\_summary }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{relig =} \FunctionTok{fct\_reorder}\NormalTok{(relig, tvhours)}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ tvhours, }\AttributeTok{y =}\NormalTok{ relig)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

å¦‚æœæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç±»ä¼¼çš„å›¾å½¢æ¥æŸ¥çœ‹ç”³æŠ¥çš„æ”¶å…¥æ°´å¹³å¦‚ä½•éšç€å¹³å‡å¹´é¾„è€Œå˜åŒ–ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rincome\_summary }\OtherTok{\textless{}{-}}\NormalTok{ gss\_cat }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(rincome) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{age =} \FunctionTok{mean}\NormalTok{(age, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{()}
\NormalTok{  )}

\FunctionTok{ggplot}\NormalTok{(rincome\_summary, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ age, }\AttributeTok{y =} \FunctionTok{fct\_reorder}\NormalTok{(rincome, age))) }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{factors_files/figure-pdf/unnamed-chunk-19-1.pdf}

åœ¨è¿™é‡Œï¼Œéšæ„é‡æ–°æ’åºæ°´å¹³ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼å› 
ä¸º\texttt{rincome}å·²ç»æœ‰äº†ä¸€ä¸ªåŸºäºåŸåˆ™çš„é¡ºåºï¼Œæˆ‘ä»¬ä¸åº”è¯¥éšæ„æ‰“ä¹±å®ƒã€‚\texttt{f}
\texttt{ct\_reorder()}ç”¨äºé‚£äº›æ°´å¹³æ˜¯ä»»æ„æ’åºçš„å› å­ã€‚

ä½†æ˜¯ï¼Œå°†``Not applicable''ä¸å…¶ä»–ç‰¹æ®Šæ°´å¹³ä¸€èµ·æ”¾åœ¨å‰é¢æ˜¯æœ‰æ„ä¹‰çš„ã€‚è¿™
æ—¶å¯ä»¥ä½¿ç”¨\texttt{fct\_relevel()}ï¼Œè¿™ä¸ªå‡½æ•°æ¥æ”¶ä¸€ä¸ªå› å­\texttt{.f}ï¼Œç„¶åæ˜¯ä½ æƒ³ç§»åŠ¨åˆ°è¡Œå‰é¢çš„ä»»æ„æ•°é‡çš„æ°´å¹³ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(rincome\_summary, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ age, }\AttributeTok{y =} \FunctionTok{fct\_relevel}\NormalTok{(rincome, }\StringTok{"Not applicable"}\NormalTok{))) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{factors_files/figure-pdf/unnamed-chunk-20-1.pdf}

ä½ è§‰å¾—ä¸ºä»€ä¹ˆ``ä¸é€‚ç”¨''çš„å¹³å‡å¹´é¾„è¿™ä¹ˆé«˜ï¼Ÿ

å¦ä¸€ç§é‡æ–°æ’åºåœ¨ä½ ä¸ºå›¾å½¢ä¸Šçš„çº¿æ¡ç€è‰²æ—¶å¾ˆæœ‰ç”¨ã€‚\texttt{f}
\texttt{ct\_reorder2(.f,\ .x,\ .y)}é€šè¿‡ä¸\texttt{.x}å€¼ä¸­æœ€å¤§çš„å€¼ç›¸å…³è”çš„\texttt{.y}å€¼æ¥é‡æ–°æ’åºå› å­\texttt{.f}ã€‚è¿™
ä½¿å¾—å›¾å½¢æ›´å®¹æ˜“é˜…è¯»ï¼Œå› ä¸ºå›¾å½¢æœ€å³è¾¹çš„çº¿æ¡é¢œè‰²å°†ä¸å›¾ä¾‹å¯¹é½ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{by\_age }\OtherTok{\textless{}{-}}\NormalTok{ gss\_cat }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(age)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count}\NormalTok{(age, marital) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(age) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{prop =}\NormalTok{ n }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(n)}
\NormalTok{  )}

\FunctionTok{ggplot}\NormalTok{(by\_age, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ age, }\AttributeTok{y =}\NormalTok{ prop, }\AttributeTok{color =}\NormalTok{ marital)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{linewidth =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{scale\_color\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"Set1"}\NormalTok{)}

\FunctionTok{ggplot}\NormalTok{(by\_age, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ age, }\AttributeTok{y =}\NormalTok{ prop, }\AttributeTok{color =} \FunctionTok{fct\_reorder2}\NormalTok{(marital, age, prop))) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{linewidth =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{scale\_color\_brewer}\NormalTok{(}\AttributeTok{palette =} \StringTok{"Set1"}\NormalTok{) }\SpecialCharTok{+} 
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{color =} \StringTok{"marital"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{factors_files/figure-pdf/unnamed-chunk-21-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{factors_files/figure-pdf/unnamed-chunk-21-2.pdf}\end{minipage}%

\end{figure}%

æœ€åï¼Œå¯¹äºæ¡å½¢å›¾ï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{fct\_infreq()}æ¥æŒ‰é¢‘æ•°é€’å‡çš„é¡ºåºæ’åˆ—æ°´å¹³ï¼šè¿™æ˜¯æœ€ç®€å•çš„é‡æ–°æ’åºç±»å‹ï¼Œå› ä¸ºå®ƒä¸éœ€è¦ä»»ä½•é¢å¤–çš„å˜é‡ã€‚å¦‚
æœä½ å¸Œæœ›æŒ‰é¢‘æ•°é€’å¢çš„é¡ºåºæ’åˆ—å®ƒä»¬ï¼ˆè¿™æ ·åœ¨æ¡å½¢å›¾ä¸­æœ€å¤§çš„å€¼ä½äºå³ä¾§è€Œä¸æ˜¯å·¦ä¾§ï¼‰ï¼Œå¯ä»¥å°†å®ƒä¸\texttt{fct\_rev()}ç»“åˆä½¿ç”¨ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gss\_cat }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{marital =}\NormalTok{ marital }\SpecialCharTok{|\textgreater{}} \FunctionTok{fct\_infreq}\NormalTok{() }\SpecialCharTok{|\textgreater{}} \FunctionTok{fct\_rev}\NormalTok{()) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ marital)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{factors_files/figure-pdf/unnamed-chunk-22-1.pdf}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-43}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \texttt{tvhours}ä¸­æœ‰ä¸€äº›å¯ç–‘çš„å¤§æ•°ã€‚å‡ æ•°æ˜¯ä¸€ä¸ªå¥½çš„æ±‡æ€»å—ï¼Ÿ
\item
  å¯¹äº\texttt{gss\_cat}ä¸­çš„æ¯ä¸ªå› å­ï¼Œç¡®å®šå…¶æ°´å¹³çš„é¡ºåºæ˜¯ä»»æ„çš„è¿˜æ˜¯éµå¾ªåŸåˆ™çš„ã€‚
\item
  ä¸ºä»€ä¹ˆå°†``Not applicable''ç§»è‡³æ°´å¹³çš„å‰ç«¯ä¼šä½¿å…¶åœ¨å›¾çš„åº•éƒ¨æ˜¾ç¤ºï¼Ÿ
\end{enumerate}

\section{ä¿®æ”¹å› å­æ°´å¹³}\label{ux4feeux6539ux56e0ux5b50ux6c34ux5e73}

æ¯”æ”¹å˜æ°´å¹³é¡ºåºæ›´æœ‰å½±å“åŠ›çš„æ˜¯ä¿®æ”¹å®ƒä»¬çš„å€¼ã€‚è¿™
å…è®¸ä½ æ˜ç¡®æ ‡ç­¾ä»¥ä¾¿é€‚åˆå‘è¡¨ï¼Œåˆå¹¶æ°´å¹³ä»¥ä¾¿æ›´å¥½æ˜¾ç¤ºã€‚æœ€
é€šç”¨ä¸”å¼ºå¤§çš„å·¥å…·æ˜¯\texttt{fct\_recode()}ï¼Œå®ƒå…è®¸ä½ é‡ç¼–ç æˆ–æ”¹å˜æ¯ä¸ªæ°´å¹³çš„å€¼ã€‚ä¾‹
å¦‚ï¼Œä»\texttt{gss\_cat}æ•°æ®æ¡†ä¸­å–å‡º\texttt{partyid}å˜é‡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gss\_cat }\SpecialCharTok{|\textgreater{}} \FunctionTok{count}\NormalTok{(partyid)}
\CommentTok{\#\textgreater{} \# A tibble: 10 x 2}
\CommentTok{\#\textgreater{}   partyid                n}
\CommentTok{\#\textgreater{}   \textless{}fct\textgreater{}              \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 No answer            154}
\CommentTok{\#\textgreater{} 2 Don\textquotesingle{}t know             1}
\CommentTok{\#\textgreater{} 3 Other party          393}
\CommentTok{\#\textgreater{} 4 Strong republican   2314}
\CommentTok{\#\textgreater{} 5 Not str republican  3032}
\CommentTok{\#\textgreater{} 6 Ind,near rep        1791}
\CommentTok{\#\textgreater{} \# i 4 more rows}
\end{Highlighting}
\end{Shaded}

è¿™äº›æ°´å¹³çš„æ ‡ç­¾ç®€æ´ä¸”ä¸ä¸€è‡´ã€‚è®©
æˆ‘ä»¬è°ƒæ•´ä¸€ä¸‹ä½¿å®ƒä»¬æ›´é•¿ï¼Œå¹¶ä¸”ä½¿ç”¨å¹³è¡Œç»“æ„ã€‚å’Œ
tidyverseä¸­å¤§å¤šæ•°é‡å‘½åå’Œé‡æ–°ç¼–ç å‡½æ•°ä¸€æ ·ï¼Œæ–°å€¼åœ¨å·¦ä¾§ï¼Œæ—§å€¼åœ¨å³ä¾§ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gss\_cat }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{partyid =} \FunctionTok{fct\_recode}\NormalTok{(partyid,}
      \StringTok{"Republican, strong"}    \OtherTok{=} \StringTok{"Strong republican"}\NormalTok{,}
      \StringTok{"Republican, weak"}      \OtherTok{=} \StringTok{"Not str republican"}\NormalTok{,}
      \StringTok{"Independent, near rep"} \OtherTok{=} \StringTok{"Ind,near rep"}\NormalTok{,}
      \StringTok{"Independent, near dem"} \OtherTok{=} \StringTok{"Ind,near dem"}\NormalTok{,}
      \StringTok{"Democrat, weak"}        \OtherTok{=} \StringTok{"Not str democrat"}\NormalTok{,}
      \StringTok{"Democrat, strong"}      \OtherTok{=} \StringTok{"Strong democrat"}
\NormalTok{    )}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{count}\NormalTok{(partyid)}
\CommentTok{\#\textgreater{} \# A tibble: 10 x 2}
\CommentTok{\#\textgreater{}   partyid                   n}
\CommentTok{\#\textgreater{}   \textless{}fct\textgreater{}                 \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 No answer               154}
\CommentTok{\#\textgreater{} 2 Don\textquotesingle{}t know                1}
\CommentTok{\#\textgreater{} 3 Other party             393}
\CommentTok{\#\textgreater{} 4 Republican, strong     2314}
\CommentTok{\#\textgreater{} 5 Republican, weak       3032}
\CommentTok{\#\textgreater{} 6 Independent, near rep  1791}
\CommentTok{\#\textgreater{} \# i 4 more rows}
\end{Highlighting}
\end{Shaded}

\texttt{fct\_recode()}ä¼šä¿ç•™æ²¡æœ‰æ˜ç¡®æåŠçš„æ°´å¹³ä¸å˜ï¼Œå¹¶ä¸”å¦‚æœä½ ä¸å°å¿ƒå¼•ç”¨äº†ä¸å­˜åœ¨çš„æ°´å¹³ï¼Œå®ƒä¼šè­¦å‘Šä½ ã€‚

è¦åˆå¹¶æ°´å¹³ï¼Œä½ å¯ä»¥å°†å¤šä¸ªæ—§æ°´å¹³åˆ†é…ç»™åŒä¸€ä¸ªæ–°æ°´å¹³ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gss\_cat }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{partyid =} \FunctionTok{fct\_recode}\NormalTok{(partyid,}
      \StringTok{"Republican, strong"}    \OtherTok{=} \StringTok{"Strong republican"}\NormalTok{,}
      \StringTok{"Republican, weak"}      \OtherTok{=} \StringTok{"Not str republican"}\NormalTok{,}
      \StringTok{"Independent, near rep"} \OtherTok{=} \StringTok{"Ind,near rep"}\NormalTok{,}
      \StringTok{"Independent, near dem"} \OtherTok{=} \StringTok{"Ind,near dem"}\NormalTok{,}
      \StringTok{"Democrat, weak"}        \OtherTok{=} \StringTok{"Not str democrat"}\NormalTok{,}
      \StringTok{"Democrat, strong"}      \OtherTok{=} \StringTok{"Strong democrat"}\NormalTok{,}
      \StringTok{"Other"}                 \OtherTok{=} \StringTok{"No answer"}\NormalTok{,}
      \StringTok{"Other"}                 \OtherTok{=} \StringTok{"Don\textquotesingle{}t know"}\NormalTok{,}
      \StringTok{"Other"}                 \OtherTok{=} \StringTok{"Other party"}
\NormalTok{    )}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

è¯·è°¨æ…ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼šå¦‚æœä½ å°†çœŸæ­£ä¸åŒçš„ç±»åˆ«ç»„åˆåœ¨ä¸€èµ·ï¼Œæœ€ç»ˆå¯èƒ½ä¼šå¾—åˆ°è¯¯å¯¼æ€§çš„ç»“æœã€‚

å¦‚æœä½ æƒ³è¦åˆå¹¶å¾ˆå¤šæ°´å¹³ï¼Œ\texttt{fct\_collapse()}æ˜¯\texttt{fct\_recode()}çš„ä¸€ä¸ªæœ‰ç”¨çš„å˜ä½“ã€‚å¯¹
äºæ¯ä¸ªæ–°å˜é‡ï¼Œä½ å¯ä»¥æä¾›ä¸€ä¸ªæ—§æ°´å¹³çš„å‘é‡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gss\_cat }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{partyid =} \FunctionTok{fct\_collapse}\NormalTok{(partyid,}
      \StringTok{"other"} \OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"No answer"}\NormalTok{, }\StringTok{"Don\textquotesingle{}t know"}\NormalTok{, }\StringTok{"Other party"}\NormalTok{),}
      \StringTok{"rep"} \OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"Strong republican"}\NormalTok{, }\StringTok{"Not str republican"}\NormalTok{),}
      \StringTok{"ind"} \OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"Ind,near rep"}\NormalTok{, }\StringTok{"Independent"}\NormalTok{, }\StringTok{"Ind,near dem"}\NormalTok{),}
      \StringTok{"dem"} \OtherTok{=} \FunctionTok{c}\NormalTok{(}\StringTok{"Not str democrat"}\NormalTok{, }\StringTok{"Strong democrat"}\NormalTok{)}
\NormalTok{    )}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{count}\NormalTok{(partyid)}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 2}
\CommentTok{\#\textgreater{}   partyid     n}
\CommentTok{\#\textgreater{}   \textless{}fct\textgreater{}   \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 other     548}
\CommentTok{\#\textgreater{} 2 rep      5346}
\CommentTok{\#\textgreater{} 3 ind      8409}
\CommentTok{\#\textgreater{} 4 dem      7180}
\end{Highlighting}
\end{Shaded}

æœ‰æ—¶ä½ åªæ˜¯æƒ³å°†å°çš„ç»„åˆå¹¶åœ¨ä¸€èµ·ï¼Œä»¥ä½¿ç»˜å›¾æˆ–è¡¨æ ¼æ›´ç®€æ´ã€‚è¿™
å°±æ˜¯\texttt{fct\_lump\_*()}å‡½æ•°å®¶æ—çš„ä»»åŠ¡ã€‚\texttt{f}
\texttt{ct\_lump\_lowfreq()}æ˜¯ä¸€ä¸ªç®€å•çš„èµ·ç‚¹ï¼Œå®ƒé€æ­¥å°†æœ€å°çš„ç»„ç±»åˆ«åˆå¹¶ä¸º``Other''ï¼Œå¹¶å§‹ç»ˆä¿æŒ``Other''ä¸ºæœ€å°çš„ç±»åˆ«ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gss\_cat }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{relig =} \FunctionTok{fct\_lump\_lowfreq}\NormalTok{(relig)) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{count}\NormalTok{(relig)}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 2}
\CommentTok{\#\textgreater{}   relig          n}
\CommentTok{\#\textgreater{}   \textless{}fct\textgreater{}      \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 Protestant 10846}
\CommentTok{\#\textgreater{} 2 Other      10637}
\end{Highlighting}
\end{Shaded}

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒä¸æ˜¯å¾ˆæœ‰ç”¨ï¼šè¿™é¡¹è°ƒæŸ¥ä¸­çš„å¤§å¤šæ•°ç¾å›½äººæ˜¯æ–°æ•™å¾’ï¼Œä½†æˆ‘ä»¬å¯èƒ½æƒ³çœ‹åˆ°æ›´å¤šç»†èŠ‚ï¼ç›¸
åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{fct\_lump\_n()}æ¥æŒ‡å®šæˆ‘ä»¬æ­£å¥½æƒ³è¦10ä¸ªç»„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gss\_cat }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{relig =} \FunctionTok{fct\_lump\_n}\NormalTok{(relig, }\AttributeTok{n =} \DecValTok{10}\NormalTok{)) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{count}\NormalTok{(relig, }\AttributeTok{sort =} \ConstantTok{TRUE}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 10 x 2}
\CommentTok{\#\textgreater{}   relig          n}
\CommentTok{\#\textgreater{}   \textless{}fct\textgreater{}      \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 Protestant 10846}
\CommentTok{\#\textgreater{} 2 Catholic    5124}
\CommentTok{\#\textgreater{} 3 None        3523}
\CommentTok{\#\textgreater{} 4 Christian    689}
\CommentTok{\#\textgreater{} 5 Other        458}
\CommentTok{\#\textgreater{} 6 Jewish       388}
\CommentTok{\#\textgreater{} \# i 4 more rows}
\end{Highlighting}
\end{Shaded}

é˜…è¯»æ–‡æ¡£äº†è§£\texttt{fct\_lump\_min()}å’Œ\texttt{fct\_lump\_prop()}ï¼Œå®ƒä»¬åœ¨å…¶ä»–æƒ…å†µä¸‹å¾ˆæœ‰ç”¨ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-44}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  äººä»¬å°†è‡ªå·±è§†ä¸ºæ°‘ä¸»å…šäººã€å…±å’Œå…šäººå’Œæ— å…šæ´¾äººå£«çš„æ¯”ä¾‹æ˜¯å¦‚ä½•éšæ—¶é—´å˜åŒ–çš„ï¼Ÿ
\item
  ä½ å¦‚ä½•å°†\texttt{rincome}åˆå¹¶æˆä¸€å°ç±»ï¼Ÿ
\item
  è¯·æ³¨æ„ä¸Šé¢çš„\texttt{fct\_lump}ç¤ºä¾‹ä¸­æœ‰9ä¸ªç»„ (ä¸åŒ…æ‹¬å…¶ä»–)
  ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯10ä¸ªï¼Ÿ(
  æç¤ºï¼šé”®å…¥\texttt{?fct\_lump}ï¼Œå¹¶æ‰¾åˆ°å‚æ•°\texttt{other\_level}çš„é»˜è®¤å€¼ä¸º''Other'')
\end{enumerate}

\section{æœ‰åºå› å­}\label{sec-ordered-factors}

åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œæœ‰ä¸€ç§ç‰¹æ®Šçš„å› å­éœ€è¦ç®€è¦åœ°æä¸€ä¸‹ï¼šæœ‰åºå› å­ã€‚æœ‰
åºå› å­ä½¿ç”¨\texttt{ordered()}åˆ›å»ºï¼Œè¡¨ç¤ºæ°´å¹³ä¹‹é—´å­˜åœ¨ä¸¥æ ¼çš„é¡ºåºå’Œç›¸ç­‰çš„è·ç¦»ï¼šç¬¬ä¸€ä¸ªæ°´å¹³``å°äº''ç¬¬äºŒä¸ªæ°´å¹³çš„ç¨‹åº¦ä¸ç¬¬äºŒä¸ªæ°´å¹³``å°äº''ç¬¬ä¸‰ä¸ªæ°´å¹³çš„ç¨‹åº¦ç›¸åŒï¼Œä»¥æ­¤ç±»æ¨ã€‚åœ¨
è¾“å‡ºæ—¶å¯ä»¥é€šè¿‡å› å­æ°´å¹³ä¹‹é—´ä½¿ç”¨çš„\texttt{\textless{}}æ¥è¯†åˆ«å®ƒä»¬ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ordered}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"b"}\NormalTok{, }\StringTok{"c"}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] a b c}
\CommentTok{\#\textgreater{} Levels: a \textless{} b \textless{} c}
\end{Highlighting}
\end{Shaded}

åœ¨å®è·µä¸­ï¼Œ\texttt{ordered()}å› å­ä¸å¸¸è§„å› å­çš„è¡Œä¸ºéå¸¸ç›¸ä¼¼ã€‚ä½ 
åªæœ‰åœ¨ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¸‹å¯èƒ½ä¼šæ³¨æ„åˆ°ä¸åŒçš„è¡Œä¸ºï¼š

\begin{itemize}
\tightlist
\item
  å¦‚æœä½ åœ¨\texttt{ggplot2}ä¸­å°†æœ‰åºå› å­æ˜ å°„åˆ°é¢œè‰²æˆ–å¡«å……ä¸Šï¼Œå®ƒå°†é»˜è®¤ä½¿ç”¨\texttt{scale\_color\_viridis()}/\texttt{scale\_fill\_viridis()}ï¼Œè¿™æ˜¯ä¸€ç§æš—å«æ’åçš„é¢œè‰²æ¯”ä¾‹å°ºã€‚
\item
  å¦‚æœä½ åœ¨çº¿æ€§æ¨¡å‹ä¸­ä½¿ç”¨æœ‰åºå‡½æ•°ï¼Œå®ƒå°†ä½¿ç”¨``å¤šè¾¹å½¢å¯¹æ¯”''ã€‚è¿™äº›å¯¹æ¯”æœ‰äº›ç”¨å¤„ï¼Œä½†é™¤éä½ æ‹¥æœ‰ç»Ÿè®¡å­¦åšå£«å­¦ä½ï¼Œå¦åˆ™ä½ å¯èƒ½ä¸ä¼šå¬è¯´è¿‡å®ƒä»¬ï¼Œå³ä½¿ä½ æœ‰ï¼Œä½ ä¹Ÿå¯èƒ½ä¸ä¼šå¸¸è§„åœ°è§£é‡Šå®ƒä»¬ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šï¼Œæˆ‘ä»¬æ¨èé˜…è¯»
  Lisa DeBruine
  å†™çš„\texttt{vignette("contrasts",\ package\ =\ "faux")}ã€‚
\end{itemize}

é‰´äºè¿™äº›å·®å¼‚æœ‰äº‰è®®ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸æ¨èä½¿ç”¨æœ‰åºå› å­ã€‚

\section{å°ç»“}\label{ux5c0fux7ed3-15}

æœ¬ç« å‘ä½ ä»‹ç»äº†ç”¨äºå¤„ç†å› å­çš„å®ç”¨åŒ…forcatsï¼Œå¹¶ä»‹ç»äº†æœ€å¸¸ç”¨çš„å‡½æ•°ã€‚f
orcatsè¿˜åŒ…å«äº†è®¸å¤šå…¶ä»–è¾…åŠ©å‡½æ•°ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬æ²¡æœ‰è¶³å¤Ÿçš„ç¯‡å¹…è®¨è®ºå®ƒä»¬ï¼›å› æ­¤ï¼Œæ¯å½“ä½ é¢ä¸´ä»¥å‰ä»æœªé‡åˆ°çš„å› å­åˆ†ææŒ‘æˆ˜æ—¶ï¼Œæˆ‘å¼ºçƒˆå»ºè®®ä½ æµè§ˆ\href{https://forcats.tidyverse.org/reference/index.html}{reference
index}ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰ç°æˆçš„å‡½æ•°å¯ä»¥å¸®åŠ©ä½ è§£å†³é—®é¢˜ã€‚

å¦‚æœä½ åœ¨é˜…è¯»æœ¬ç« åæƒ³äº†è§£æ›´å¤šå…³äºå› å­çš„å†…å®¹ï¼Œæˆ‘ä»¬å»ºè®®æ‚¨é˜…è¯»Amelia
McNamaraå’ŒNicholas
Hortonçš„è®ºæ–‡ã€Š\href{https://peerj.com/preprints/3163/}{Wrangling
categorical data in R}ã€‹ã€‚è¿™
ç¯‡è®ºæ–‡æ¦‚è¿°äº†\href{https://simplystatistics.org/posts/2015-07-24-stringsasfactors-an-unauthorized-biography/}{stringsAsFactors:
An unauthorized
biography}å’Œ\href{https://notstatschat.tumblr.com/post/124987394001/stringsasfactors-sigh}{stringsAsFactors
=
\textless sigh\textgreater{}}ä¸­è®¨è®ºçš„ä¸€äº›å†å²ï¼Œå¹¶å°†æœ¬ä¹¦ä¸­æ¦‚è¿°çš„åˆ†ç±»æ•°æ®çš„æ•´é½æ–¹æ³•ä¸RåŸºç¡€æ–¹æ³•è¿›è¡Œäº†æ¯”è¾ƒã€‚è¿™
ç¯‡è®ºæ–‡çš„æ—©æœŸç‰ˆæœ¬æœ‰åŠ©äºæ¨åŠ¨forcatsåŒ…çš„å¼€å‘å’ŒèŒƒå›´ç¡®å®šï¼›æ„Ÿè°¢Ameliaå’ŒNickï¼

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†è½¬å˜è¯é¢˜ï¼Œå¼€å§‹å­¦ä¹ Rä¸­çš„æ—¥æœŸå’Œæ—¶é—´ã€‚æ—¥
æœŸå’Œæ—¶é—´çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†ä½ å¾ˆå¿«å°±ä¼šçœ‹åˆ°ï¼Œéšç€å¯¹å®ƒä»¬äº†è§£å¾—è¶Šå¤šï¼Œå®ƒä»¬ä¼¼ä¹å˜å¾—è¶Šå¤æ‚ï¼

\chapter{æ—¥æœŸå’Œæ—¶é—´}\label{sec-dates-and-times}

\section{å¼•è¨€}\label{ux5f15ux8a00-12}

æœ¬ç« å°†å‘ä½ å±•ç¤ºå¦‚ä½•åœ¨Rä¸­å¤„ç†æ—¥æœŸå’Œæ—¶é—´ã€‚ä¹
ä¸€çœ‹ï¼Œæ—¥æœŸå’Œæ—¶é—´ä¼¼ä¹å¾ˆç®€å•ï¼Œåœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ä¼šç»å¸¸ä½¿ç”¨å®ƒä»¬ï¼Œä¼¼ä¹å¹¶ä¸ä¼šå¼•èµ·å¤ªå¤šæ··æ·†ã€‚ç„¶
è€Œï¼Œä½ å¯¹æ—¥æœŸå’Œæ—¶é—´äº†è§£å¾—è¶Šå¤šï¼Œå®ƒä»¬ä¼¼ä¹å°±å˜å¾—è¶Šå¤æ‚ï¼

ä¸ºäº†é¢„çƒ­ï¼Œè¯·æ€è€ƒä¸€å¹´ä¸­æœ‰å¤šå°‘å¤©ï¼Œä¸€å¤©ä¸­æœ‰å¤šå°‘å°æ—¶ã€‚ä½ 
å¯èƒ½è®°å¾—å¤§å¤šæ•°å¹´ä»½æœ‰365å¤©ï¼Œä½†é—°å¹´æœ‰366å¤©ã€‚ä½ 
çŸ¥é“ç¡®å®šæŸå¹´æ˜¯å¦ä¸ºé—°å¹´çš„å®Œæ•´è§„åˆ™å—ï¼Ÿä¸€
å¤©ä¸­çš„å°æ—¶æ•°å°±ä¸å¤ªæ˜æ˜¾äº†ï¼šå¤§å¤šæ•°æ—¥å­æœ‰24å°æ—¶ï¼Œä½†åœ¨ä½¿ç”¨å¤ä»¤æ—¶ï¼ˆDSTï¼‰çš„åœ°æ–¹ï¼Œæ¯å¹´æœ‰ä¸€å¤©æ˜¯23å°æ—¶ï¼Œå¦ä¸€å¤©æ˜¯25å°æ—¶ã€‚

æ—¥æœŸå’Œæ—¶é—´ä¹‹æ‰€ä»¥éš¾ä»¥å¤„ç†ï¼Œæ˜¯å› ä¸ºå®ƒä»¬å¿…é¡»åè°ƒä¸¤ç§ç‰©ç†ç°è±¡ï¼ˆåœ°çƒçš„è‡ªè½¬å’Œç»•å¤ªé˜³çš„å…¬è½¬ï¼‰ä»¥åŠåŒ…æ‹¬æœˆä»½ã€æ—¶åŒºå’Œå¤ä»¤æ—¶åœ¨å†…çš„ä¸€ç³»åˆ—åœ°ç¼˜æ”¿æ²»ç°è±¡ã€‚æœ¬
ç« ä¸ä¼šå‘Šè¯‰ä½ å…³äºæ—¥æœŸå’Œæ—¶é—´çš„æ¯ä¸€ä¸ªç»†èŠ‚ï¼Œä½†å°†ä¸ºä½ æä¾›æ‰å®çš„å®è·µæŠ€èƒ½åŸºç¡€ï¼Œå¸®åŠ©ä½ åº”å¯¹å¸¸è§çš„æ•°æ®åˆ†ææŒ‘æˆ˜ã€‚

æˆ‘ä»¬å°†é¦–å…ˆå‘ä½ å±•ç¤ºå¦‚ä½•ä»å„ç§è¾“å…¥ä¸­åˆ›å»ºæ—¥æœŸ-æ—¶é—´ï¼›ä¸€æ—¦ä½ æœ‰äº†æ—¥æœŸ-æ—¶é—´ï¼Œä½ å°±å¯ä»¥æå–è¯¸å¦‚å¹´ã€æœˆå’Œæ—¥ç­‰ç»„ä»¶ã€‚æ¥
ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨å¤„ç†æ—¶é—´è·¨åº¦çš„æ£˜æ‰‹è¯é¢˜ï¼Œæ ¹æ®ä½ è¦åšçš„äº‹æƒ…ä¸åŒï¼Œæ—¶é—´è·¨åº¦ä¼šæœ‰å„ç§å„æ ·çš„å½¢å¼ã€‚æœ€
åï¼Œæˆ‘ä»¬å°†ç®€è¦è®¨è®ºæ—¶åŒºå¸¦æ¥çš„é¢å¤–æŒ‘æˆ˜ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-12}

æœ¬ç« å°†é‡ç‚¹å…³æ³¨\textbf{lubridate}åŒ…ï¼Œå®ƒä½¿åœ¨Rä¸­å¤„ç†æ—¥æœŸå’Œæ—¶é—´å˜å¾—æ›´åŠ å®¹æ˜“ã€‚åœ¨
æœ€æ–°çš„ tidyverse å‘è¡Œç‰ˆä¸­ï¼Œlubridate æ˜¯æ ¸å¿ƒåŒ…tidyverseçš„ä¸€éƒ¨åˆ†ã€‚æˆ‘
ä»¬è¿˜å°†éœ€è¦nycflights13æ•°æ®é›†ä½œä¸ºç»ƒä¹ æ•°æ®ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(nycflights13)}
\end{Highlighting}
\end{Shaded}

\section{åˆ›å»ºæ—¥æœŸ/æ—¶é—´}\label{sec-creating-datetimes}

æœ‰ä¸‰ç§æ—¥æœŸ/æ—¶é—´æ•°æ®ç±»å‹ï¼Œå®ƒä»¬æŒ‡çš„éƒ½æ˜¯æ—¶é—´çš„ä¸€ä¸ªç¬é—´ï¼š

\begin{itemize}
\item
  \textbf{æ—¥æœŸ}ï¼ˆ\textbf{date}ï¼‰ï¼šTibbles
  è¾“å‡ºä¸º\texttt{\textless{}date\textgreater{}}ã€‚
\item
  \textbf{æ—¶é—´}ï¼ˆ\textbf{time}ï¼‰ï¼šTibbles
  è¾“å‡ºä¸º\texttt{\textless{}time\textgreater{}}ã€‚
\item
  \textbf{æ—¥æœŸ-æ—¶é—´}ï¼ˆ\textbf{date-time}ï¼‰ï¼šæ—¥æœŸåŠ ä¸Šæ—¶é—´ï¼Œå”¯ä¸€åœ°æ ‡è¯†äº†ä¸€ä¸ªç¬æ—¶æ—¶é—´ï¼ˆé€šå¸¸ç²¾ç¡®åˆ°ç§’ï¼‰ã€‚T
  ibbles è¾“å‡ºä¸º\texttt{\textless{}dttm\textgreater{}}ã€‚B ase Rå°†è¿™äº›ç§°ä¸º
  POSIXctï¼Œä½†è¿™ä¸ªåç§°å¹¶ä¸æ˜¯å¾ˆå¥½è¯´ã€‚
\end{itemize}

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨æ—¥æœŸå’Œæ—¥æœŸ-æ—¶é—´ï¼Œå› ä¸º R
æ²¡æœ‰ç”¨äºå­˜å‚¨æ—¶é—´çš„åŸç”Ÿç±»ã€‚å¦‚ æœä½ éœ€è¦è¿™æ ·çš„ç±»ï¼Œä½ å¯ä»¥ä½¿ç”¨ \textbf{hms}
åŒ…ã€‚

ä½ åº”è¯¥å§‹ç»ˆä½¿ç”¨æœ€ç®€å•çš„å¯èƒ½æ»¡è¶³ä½ éœ€æ±‚çš„æ•°æ®ç±»å‹ã€‚è¿™
æ„å‘³ç€ï¼Œå¦‚æœä½ å¯ä»¥ä½¿ç”¨æ—¥æœŸè€Œä¸æ˜¯æ—¥æœŸ-æ—¶é—´ï¼Œé‚£ä¹ˆä½ å°±åº”è¯¥è¿™æ ·åšã€‚æ—¥
æœŸ-æ—¶é—´è¦å¤æ‚å¾—å¤šï¼Œå› ä¸ºéœ€è¦å¤„ç†æ—¶åŒºï¼Œæˆ‘ä»¬å°†åœ¨æœ¬ç« æœ«å°¾å†è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚

è¦è·å–å½“å‰æ—¥æœŸæˆ–æ—¥æœŸ-æ—¶é—´ï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{today()}æˆ–\texttt{now()}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{today}\NormalTok{()}
\CommentTok{\#\textgreater{} [1] "2024{-}06{-}02"}
\FunctionTok{now}\NormalTok{()}
\CommentTok{\#\textgreater{} [1] "2024{-}06{-}02 16:30:49 CST"}
\end{Highlighting}
\end{Shaded}

å¦å¤–ï¼Œä¸‹é¢çš„éƒ¨åˆ†æè¿°äº†ä½ å¯èƒ½åˆ›å»ºæ—¥æœŸ/æ—¶é—´çš„å››ç§æ–¹æ³•:

\begin{itemize}
\tightlist
\item
  åœ¨ä½¿ç”¨readrè¯»å–æ–‡ä»¶æ—¶ï¼›
\item
  ä»å­—ç¬¦ä¸²ï¼›
\item
  ä»å•ä¸ªæ—¥æœŸ-æ—¶é—´ç»„ä»¶ï¼›
\item
  ä»ç°æœ‰çš„æ—¥æœŸ-æ—¶é—´å¯¹è±¡ã€‚
\end{itemize}

\subsection{During import}\label{during-import}

å¦‚æœä½ çš„CSVæ–‡ä»¶åŒ…å«ISO8601æ—¥æœŸæˆ–æ—¥æœŸ-æ—¶é—´ï¼Œåˆ™ä¸éœ€è¦åšä»»ä½•æ“ä½œï¼Œreadrä¼šè‡ªåŠ¨è¯†åˆ«å®ƒ:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{csv }\OtherTok{\textless{}{-}} \StringTok{"}
\StringTok{  date,datetime}
\StringTok{  2022{-}01{-}02,2022{-}01{-}02 05:12}
\StringTok{"}
\FunctionTok{read\_csv}\NormalTok{(csv)}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 2}
\CommentTok{\#\textgreater{}   date       datetime           }
\CommentTok{\#\textgreater{}   \textless{}date\textgreater{}     \textless{}dttm\textgreater{}             }
\CommentTok{\#\textgreater{} 1 2022{-}01{-}02 2022{-}01{-}02 05:12:00}
\end{Highlighting}
\end{Shaded}

å¯èƒ½ä½ ä¹‹å‰æ²¡å¬è¯´è¿‡
\textbf{ISO8601}ï¼Œå®ƒæ˜¯ä¸€ç§å›½é™…æ—¥æœŸç¼–å†™æ ‡å‡†ï¼Œå…¶ä¸­æ—¥æœŸçš„ç»„æˆéƒ¨åˆ†æŒ‰ç…§ä»å¤§åˆ°å°çš„é¡ºåºç”¨çŸ­æ¨ªçº¿ï¼ˆ-ï¼‰åˆ†éš”ã€‚ä¾‹
å¦‚ï¼Œåœ¨ ISO8601 ä¸­ï¼Œ2022å¹´5æœˆ3æ—¥å†™ä½œ \texttt{2022-05-03}ã€‚I
SO8601æ—¥æœŸè¿˜å¯ä»¥åŒ…å«æ—¶é—´ï¼Œå…¶ä¸­å°æ—¶ã€åˆ†é’Ÿå’Œç§’ç”¨å†’å·\texttt{:}åˆ†éš”ï¼Œæ—¥æœŸå’Œæ—¶é—´ç»„ä»¶ç”¨
\texttt{T} æˆ–ç©ºæ ¼åˆ†éš”ã€‚ä¾‹ å¦‚ï¼Œä½ å¯ä»¥å°†
2022å¹´5æœˆ3æ—¥ä¸‹åˆ4ç‚¹26åˆ†å†™ä½œ\texttt{2022-05-03} 16:26 æˆ–
2\texttt{022-05-03T16:26}ã€‚

å¯¹äºå…¶ä»–æ—¥æœŸ-æ—¶é—´æ ¼å¼ï¼Œä½ éœ€è¦ä½¿ç”¨\texttt{col\_types}åŠ ä¸Š\texttt{col\_date()}æˆ–\texttt{col\_datetime()}ä»¥åŠä¸€ä¸ªæ—¥æœŸ-æ—¶é—´æ ¼å¼ã€‚\texttt{r}
\texttt{eadr}ä½¿ç”¨çš„æ—¥æœŸæ—¶é—´æ ¼å¼æ˜¯è®¸å¤šç¼–ç¨‹è¯­è¨€é€šç”¨çš„æ ‡å‡†ï¼Œä½¿ç”¨\texttt{\%}åè·Ÿä¸€ä¸ªå•å­—ç¬¦æ¥æè¿°æ—¥æœŸç»„ä»¶ã€‚ä¾‹
å¦‚ï¼Œ\texttt{\%Y-\%m-\%d}æŒ‡å®šäº†ä¸€ä¸ªæ ¼å¼ä¸ºå¹´\texttt{-}æœˆï¼ˆæ•°å­—ï¼‰\texttt{-}æ—¥çš„æ—¥æœŸã€‚@
tbl-date-formats åˆ—å‡ºäº†æ‰€æœ‰é€‰é¡¹ã€‚

\begin{longtable}[]{@{}llll@{}}
\caption{readr
ç†è§£çš„æ‰€æœ‰æ—¥æœŸæ ¼å¼}\label{tbl-date-formats}\tabularnewline
\toprule\noalign{}
ç±»å‹ & ä»£ç  & æ„ä¹‰ & å®ä¾‹ \\
\midrule\noalign{}
\endfirsthead
\toprule\noalign{}
ç±»å‹ & ä»£ç  & æ„ä¹‰ & å®ä¾‹ \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
å¹´ & \texttt{\%Y} & 4 ä½æ•° å¹´ & 2021 \\
& \texttt{\%y} & 2 ä½æ•° å¹´ & 21 \\
æœˆ & \texttt{\%m} & æ•°å­— & 2 \\
& \texttt{\%b} & ç¼©å†™å & Feb \\
& \texttt{\%B} & å…¨å & February \\
æ—¥ & \texttt{\%d} & ä¸€ä¸ªæˆ–ä¸¤ä¸ªæ•°å­— & 2 \\
& \texttt{\%e} & ä¸¤ä¸ªæ•°å­— & 02 \\
æ—¶é—´ & \texttt{\%H} & 24-å°æ—¶ å°æ—¶ & 13 \\
& \texttt{\%I} & 12-å°æ—¶ å°æ—¶ & 1 \\
& \texttt{\%p} & AM/PM & pm \\
& \texttt{\%M} & åˆ†é’Ÿ & 35 \\
& \texttt{\%S} & ç§’ & 45 \\
& \texttt{\%OS} & å¸¦æœ‰å°æ•°çš„ç§’ & 45.35 \\
& \texttt{\%Z} & æ—¶åŒºåç§° & America/Chicago \\
& \texttt{\%z} & UTCåç§»é‡ & +0800 \\
å…¶ä»– & \texttt{\%.} & è·³è¿‡ä¸€ä¸ªéæ•°å­— & : \\
& \texttt{\%*} & è·³è¿‡ä»»ä½•éæ•°å­—çš„æ•°å­— & \\
\end{longtable}

ä¸‹é¢è¿™æ®µä»£ç å±•ç¤ºäº†å‡ ä¸ªåº”ç”¨äºä¸€ä¸ªéå¸¸æ¨¡ç³Šçš„æ—¥æœŸçš„é€‰é¡¹:

And this code shows a few options applied to a very ambiguous date:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{csv }\OtherTok{\textless{}{-}} \StringTok{"}
\StringTok{  date}
\StringTok{  01/02/15}
\StringTok{"}

\FunctionTok{read\_csv}\NormalTok{(csv, }\AttributeTok{col\_types =} \FunctionTok{cols}\NormalTok{(}\AttributeTok{date =} \FunctionTok{col\_date}\NormalTok{(}\StringTok{"\%m/\%d/\%y"}\NormalTok{)))}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 1}
\CommentTok{\#\textgreater{}   date      }
\CommentTok{\#\textgreater{}   \textless{}date\textgreater{}    }
\CommentTok{\#\textgreater{} 1 2015{-}01{-}02}

\FunctionTok{read\_csv}\NormalTok{(csv, }\AttributeTok{col\_types =} \FunctionTok{cols}\NormalTok{(}\AttributeTok{date =} \FunctionTok{col\_date}\NormalTok{(}\StringTok{"\%d/\%m/\%y"}\NormalTok{)))}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 1}
\CommentTok{\#\textgreater{}   date      }
\CommentTok{\#\textgreater{}   \textless{}date\textgreater{}    }
\CommentTok{\#\textgreater{} 1 2015{-}02{-}01}

\FunctionTok{read\_csv}\NormalTok{(csv, }\AttributeTok{col\_types =} \FunctionTok{cols}\NormalTok{(}\AttributeTok{date =} \FunctionTok{col\_date}\NormalTok{(}\StringTok{"\%y/\%m/\%d"}\NormalTok{)))}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 1}
\CommentTok{\#\textgreater{}   date      }
\CommentTok{\#\textgreater{}   \textless{}date\textgreater{}    }
\CommentTok{\#\textgreater{} 1 2001{-}02{-}15}
\end{Highlighting}
\end{Shaded}

æ³¨æ„ï¼Œæ— è®ºä½ å¦‚ä½•æŒ‡å®šæ—¥æœŸæ ¼å¼ï¼Œä¸€æ—¦å°†æ—¥æœŸå¯¼å…¥ R
ä¸­ï¼Œå®ƒæ€»æ˜¯ä»¥ç›¸åŒçš„æ–¹å¼æ˜¾ç¤ºã€‚

å¦‚æœæ‚¨ä½¿ç”¨\texttt{\%b}æˆ–\texttt{\%B}å¹¶å¤„ç†éè‹±è¯­æ—¥æœŸï¼Œæ‚¨è¿˜éœ€è¦æä¾›ä¸€ä¸ª\texttt{locale()}ã€‚è¯·
æŸ¥çœ‹\texttt{date\_names\_langs()}ä¸­çš„å†…ç½®è¯­è¨€åˆ—è¡¨ï¼Œæˆ–è€…ä½¿ç”¨\texttt{date\_names()}åˆ›å»ºæ‚¨è‡ªå·±çš„è¯­è¨€è®¾ç½®ã€‚

\subsection{ä»å­—ç¬¦ä¸²}\label{ux4eceux5b57ux7b26ux4e32}

æ—¥æœŸ-æ—¶é—´è§„èŒƒè¯­è¨€åŠŸèƒ½å¼ºå¤§ï¼Œä½†éœ€è¦ä»”ç»†åˆ†ææ—¥æœŸæ ¼å¼ã€‚å¦ ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨
lubridate çš„è¾…åŠ©å‡½æ•°ï¼Œè¿™äº›å‡½æ•°å°è¯•åœ¨ä½ æŒ‡å®šç»„ä»¶é¡ºåºåè‡ªåŠ¨ç¡®å®šæ ¼å¼ã€‚è¦
ä½¿ç”¨å®ƒä»¬ï¼Œè¯·ç¡®å®šå¹´ã€æœˆå’Œæ—¥ç­‰ç»„ä»¶åœ¨æ—¥æœŸä¸­å‡ºç°çš„é¡ºåºï¼Œç„¶åæŒ‰ç…§ç›¸åŒçš„é¡ºåºæ’åˆ—
``y''ã€``m'' å’Œ ``d''ã€‚è¿™ å°†ç»™å‡ºå¯ç”¨äºè§£ææ—¥æœŸçš„ lubridate
å‡½æ•°çš„åç§°ã€‚ä¾‹ å¦‚ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ymd}\NormalTok{(}\StringTok{"2017{-}01{-}31"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "2017{-}01{-}31"}
\FunctionTok{mdy}\NormalTok{(}\StringTok{"January 31st, 2017"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "2017{-}01{-}31"}
\FunctionTok{dmy}\NormalTok{(}\StringTok{"31{-}Jan{-}2017"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "2017{-}01{-}31"}
\end{Highlighting}
\end{Shaded}

\texttt{ymd()}åŠå…¶ç›¸å…³å‡½æ•°ç”¨äºåˆ›å»ºæ—¥æœŸã€‚è¦
åˆ›å»ºæ—¥æœŸ-æ—¶é—´ï¼Œè¯·åœ¨è§£æå‡½æ•°åç§°åæ·»åŠ ä¸€ä¸ªä¸‹åˆ’çº¿å’Œä¸€ä¸ªæˆ–å¤šä¸ª ``h''ã€``m''
å’Œ ``s''ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ymd\_hms}\NormalTok{(}\StringTok{"2017{-}01{-}31 20:11:59"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "2017{-}01{-}31 20:11:59 UTC"}
\FunctionTok{mdy\_hm}\NormalTok{(}\StringTok{"01/31/2017 08:01"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "2017{-}01{-}31 08:01:00 UTC"}
\end{Highlighting}
\end{Shaded}

ä½ ä¹Ÿå¯ä»¥é€šè¿‡æä¾›æ—¶åŒºæ¥å¼ºåˆ¶ä»æ—¥æœŸåˆ›å»ºæ—¥æœŸ-æ—¶é—´ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ymd}\NormalTok{(}\StringTok{"2017{-}01{-}31"}\NormalTok{, }\AttributeTok{tz =} \StringTok{"UTC"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "2017{-}01{-}31 UTC"}
\end{Highlighting}
\end{Shaded}

è¿™é‡Œä½¿ç”¨çš„æ˜¯ UTC\footnote{æ‚¨å¯èƒ½æƒ³çŸ¥é“UTCä»£è¡¨ä»€ä¹ˆã€‚å®ƒ
  æ˜¯è‹±å›½``åè°ƒä¸–ç•Œæ—¶ï¼ˆ\textbf{C}oordinated \textbf{U}niversal
  \textbf{T}imeï¼‰''å’Œæ³•å›½``åè°ƒä¸–ç•Œæ—¶ï¼ˆ\textbf{T}emps \textbf{U}niversel
  \textbf{C}oordonnÃ©ï¼‰''ä¹‹é—´çš„æŠ˜è¡·ã€‚} æ—¶åŒºï¼Œä½ çŸ¥é“çš„å¯èƒ½æ˜¯
GMTï¼Œæˆ–è€…æ ¼æ—å¨æ²»æ ‡å‡†æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯ 0Â° ç»çº¿\footnote{çŒœçŒœæ˜¯å“ªä¸ªå›½å®¶æå‡ºäº†ç»åº¦ç³»ç»Ÿï¼Œè¿™å¹¶ä¸éš¾çŒœã€‚}çš„æ—¶é—´
ã€‚å®ƒä¸ä½¿ç”¨å¤ä»¤æ—¶ï¼Œä½¿å¾—è®¡ç®—æ›´åŠ æ–¹ä¾¿ ã€‚

\subsection{ä»å•ä¸ªç»„ä»¶}\label{ux4eceux5355ux4e2aux7ec4ux4ef6}

æœ‰æ—¶ï¼Œæ—¥æœŸ-æ—¶é—´çš„å„ä¸ªç»„ä»¶ä¼šåˆ†æ•£åœ¨å¤šä¸ªåˆ—ä¸­ï¼Œè€Œä¸æ˜¯åœ¨å•ä¸ªå­—ç¬¦ä¸²ã€‚ä¾‹
å¦‚ä¸‹é¢çš„\texttt{flights} æ•°æ®:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(year, month, day, hour, minute)}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 5}
\CommentTok{\#\textgreater{}    year month   day  hour minute}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1     5     15}
\CommentTok{\#\textgreater{} 2  2013     1     1     5     29}
\CommentTok{\#\textgreater{} 3  2013     1     1     5     40}
\CommentTok{\#\textgreater{} 4  2013     1     1     5     45}
\CommentTok{\#\textgreater{} 5  2013     1     1     6      0}
\CommentTok{\#\textgreater{} 6  2013     1     1     5     58}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\end{Highlighting}
\end{Shaded}

è¦ä»è¿™ç§ç±»å‹çš„è¾“å…¥åˆ›å»ºæ—¥æœŸ/æ—¶é—´ï¼Œä½¿ç”¨\texttt{make\_date()}è¡¨ç¤ºæ—¥æœŸï¼Œæˆ–ä½¿ç”¨\texttt{make\_datetime()}è¡¨ç¤ºæ—¥æœŸ-æ—¶é—´:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(year, month, day, hour, minute) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{departure =} \FunctionTok{make\_datetime}\NormalTok{(year, month, day, hour, minute))}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 6}
\CommentTok{\#\textgreater{}    year month   day  hour minute departure          }
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{} \textless{}dttm\textgreater{}             }
\CommentTok{\#\textgreater{} 1  2013     1     1     5     15 2013{-}01{-}01 05:15:00}
\CommentTok{\#\textgreater{} 2  2013     1     1     5     29 2013{-}01{-}01 05:29:00}
\CommentTok{\#\textgreater{} 3  2013     1     1     5     40 2013{-}01{-}01 05:40:00}
\CommentTok{\#\textgreater{} 4  2013     1     1     5     45 2013{-}01{-}01 05:45:00}
\CommentTok{\#\textgreater{} 5  2013     1     1     6      0 2013{-}01{-}01 06:00:00}
\CommentTok{\#\textgreater{} 6  2013     1     1     5     58 2013{-}01{-}01 05:58:00}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\end{Highlighting}
\end{Shaded}

è®©æˆ‘ä»¬å¯¹ \texttt{flights} æ•°æ®é›†ä¸­çš„å››ä¸ªæ—¶é—´åˆ—è¿›è¡ŒåŒæ ·çš„æ“ä½œã€‚å› 
ä¸ºæ—¶é—´ä»¥ä¸€ç§æœ‰ç‚¹å¥‡æ€ªçš„æ ¼å¼è¡¨ç¤ºï¼Œæ‰€ä»¥ä½¿ç”¨æ¨¡è¿ç®—æ¥æå–å°æ—¶å’Œåˆ†é’Ÿç»„ä»¶ã€‚ä¸€
æ—¦åˆ›å»ºäº†æ—¥æœŸ-æ—¶é—´å˜é‡ä¹‹åï¼Œæˆ‘ä»¬å°†å…¶ä½œä¸ºæœ¬ç« å…¶ä½™éƒ¨åˆ†è¦æ¢ç´¢çš„å˜é‡ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{make\_datetime\_100 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(year, month, day, time) \{}
  \FunctionTok{make\_datetime}\NormalTok{(year, month, day, time }\SpecialCharTok{\%/\%} \DecValTok{100}\NormalTok{, time }\SpecialCharTok{\%\%} \DecValTok{100}\NormalTok{)}
\NormalTok{\}}

\NormalTok{flights\_dt }\OtherTok{\textless{}{-}}\NormalTok{ flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(dep\_time), }\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(arr\_time)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{dep\_time =} \FunctionTok{make\_datetime\_100}\NormalTok{(year, month, day, dep\_time),}
    \AttributeTok{arr\_time =} \FunctionTok{make\_datetime\_100}\NormalTok{(year, month, day, arr\_time),}
    \AttributeTok{sched\_dep\_time =} \FunctionTok{make\_datetime\_100}\NormalTok{(year, month, day, sched\_dep\_time),}
    \AttributeTok{sched\_arr\_time =} \FunctionTok{make\_datetime\_100}\NormalTok{(year, month, day, sched\_arr\_time)}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(origin, dest, }\FunctionTok{ends\_with}\NormalTok{(}\StringTok{"delay"}\NormalTok{), }\FunctionTok{ends\_with}\NormalTok{(}\StringTok{"time"}\NormalTok{))}

\NormalTok{flights\_dt}
\CommentTok{\#\textgreater{} \# A tibble: 328,063 x 9}
\CommentTok{\#\textgreater{}   origin dest  dep\_delay arr\_delay dep\_time            sched\_dep\_time     }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}  \textless{}chr\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{} \textless{}dttm\textgreater{}              \textless{}dttm\textgreater{}             }
\CommentTok{\#\textgreater{} 1 EWR    IAH           2        11 2013{-}01{-}01 05:17:00 2013{-}01{-}01 05:15:00}
\CommentTok{\#\textgreater{} 2 LGA    IAH           4        20 2013{-}01{-}01 05:33:00 2013{-}01{-}01 05:29:00}
\CommentTok{\#\textgreater{} 3 JFK    MIA           2        33 2013{-}01{-}01 05:42:00 2013{-}01{-}01 05:40:00}
\CommentTok{\#\textgreater{} 4 JFK    BQN          {-}1       {-}18 2013{-}01{-}01 05:44:00 2013{-}01{-}01 05:45:00}
\CommentTok{\#\textgreater{} 5 LGA    ATL          {-}6       {-}25 2013{-}01{-}01 05:54:00 2013{-}01{-}01 06:00:00}
\CommentTok{\#\textgreater{} 6 EWR    ORD          {-}4        12 2013{-}01{-}01 05:54:00 2013{-}01{-}01 05:58:00}
\CommentTok{\#\textgreater{} \# i 328,057 more rows}
\CommentTok{\#\textgreater{} \# i 3 more variables: arr\_time \textless{}dttm\textgreater{}, sched\_arr\_time \textless{}dttm\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

æœ‰äº†è¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¨å¹´çš„å‡ºå‘æ—¶é—´åˆ†å¸ƒ:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights\_dt }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ dep\_time)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_freqpoly}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{86400}\NormalTok{) }\CommentTok{\# 86400 seconds = 1 day}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{datetimes_files/figure-pdf/unnamed-chunk-12-1.pdf}

æˆ–è€…ä¸€å¤©ä¹‹å†…çš„:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights\_dt }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(dep\_time }\SpecialCharTok{\textless{}} \FunctionTok{ymd}\NormalTok{(}\DecValTok{20130102}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ dep\_time)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_freqpoly}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{600}\NormalTok{) }\CommentTok{\# 600 s = 10 minutes}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{datetimes_files/figure-pdf/unnamed-chunk-13-1.pdf}

è¯·æ³¨æ„ï¼Œå½“æ‚¨åœ¨æ•°å€¼ç¯å¢ƒä¸­ä½¿ç”¨æ—¥æœŸ-æ—¶é—´ï¼ˆå¦‚åœ¨ç›´æ–¹å›¾ä¸­ï¼‰æ—¶ï¼Œ1 è¡¨ç¤º 1
ç§’ï¼Œå› æ­¤ 86400 çš„ binwidth è¡¨ç¤ºä¸€å¤©ï¼›å¯¹äºæ—¥æœŸï¼Œ1 è¡¨ç¤º 1 å¤©ã€‚

\subsection{ä»å…¶ä»–ç±»å‹}\label{ux4eceux5176ux4ed6ux7c7bux578b}

ä½ å¯èƒ½æƒ³è¦åœ¨æ—¥æœŸ-æ—¶é—´å’Œæ—¥æœŸä¹‹é—´åˆ‡æ¢ã€‚è¿™
å°±æ˜¯\texttt{as\_datetime()}å’Œ\texttt{as\_date()}çš„å·¥ä½œ:

You may want to switch between a date-time and a date. That's the job of
\texttt{as\_datetime()} and \texttt{as\_date()}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{as\_datetime}\NormalTok{(}\FunctionTok{today}\NormalTok{())}
\CommentTok{\#\textgreater{} [1] "2024{-}06{-}02 UTC"}
\FunctionTok{as\_date}\NormalTok{(}\FunctionTok{now}\NormalTok{())}
\CommentTok{\#\textgreater{} [1] "2024{-}06{-}02"}
\end{Highlighting}
\end{Shaded}

æœ‰æ—¶ï¼Œä½ å°†è·å¾—æ—¥æœŸ/æ—¶é—´ä½œä¸º``Unix Epoch''1970-01-01çš„æ•°å­—åç§»é‡ã€‚å¦‚
æœåç§»é‡ä»¥ç§’ä¸ºå•ä½ï¼Œåˆ™ä½¿ç”¨as\_datetime()ï¼›å¦‚æœä»¥å¤©ä¸ºå•ä½ï¼Œåˆ™ä½¿ç”¨as\_date()ã€‚

æœ‰æ—¶ä½ ä¼šå¾—åˆ°ä»¥``Unix æ—¶é—´æˆ³''ï¼ˆå³
1970-01-01ï¼‰ä¸ºåŸºå‡†çš„æ—¥æœŸ/æ—¶é—´æ•°å€¼åç§»é‡ã€‚å¦‚
æœåç§»é‡ä»¥ç§’ä¸ºå•ä½çš„ï¼Œä½¿ç”¨\texttt{as\_datetime()}ï¼›å¦‚æœä»¥å¤©ä¸ºå•ä½ï¼Œä½¿ç”¨\texttt{as\_date()}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{as\_datetime}\NormalTok{(}\DecValTok{60} \SpecialCharTok{*} \DecValTok{60} \SpecialCharTok{*} \DecValTok{10}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "1970{-}01{-}01 10:00:00 UTC"}
\FunctionTok{as\_date}\NormalTok{(}\DecValTok{365} \SpecialCharTok{*} \DecValTok{10} \SpecialCharTok{+} \DecValTok{2}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "1980{-}01{-}01"}
\end{Highlighting}
\end{Shaded}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-45}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  å¦‚æœè§£æåŒ…å«æ— æ•ˆæ—¥æœŸçš„å­—ç¬¦ä¸²ä¼šå‘ç”Ÿä»€ä¹ˆ?

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ymd}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"2010{-}10{-}10"}\NormalTok{, }\StringTok{"bananas"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}
\item
  \texttt{today()}çš„\texttt{tzone}å‚æ•°æ˜¯åšä»€ä¹ˆçš„ï¼Ÿä¸º ä»€ä¹ˆå®ƒå¾ˆé‡è¦ï¼Ÿ
\item
  å¯¹äºä»¥ä¸‹æ¯ä¸ªæ—¥æœŸ-æ—¶é—´ï¼Œæ¼”ç¤ºä½ å¦‚ä½•ä½¿ç”¨ readr çš„åˆ—è§„èŒƒå’Œ lubridate
  å‡½æ•°æ¥è§£æå®ƒã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d1 }\OtherTok{\textless{}{-}} \StringTok{"January 1, 2010"}
\NormalTok{d2 }\OtherTok{\textless{}{-}} \StringTok{"2015{-}Mar{-}07"}
\NormalTok{d3 }\OtherTok{\textless{}{-}} \StringTok{"06{-}Jun{-}2017"}
\NormalTok{d4 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"August 19 (2015)"}\NormalTok{, }\StringTok{"July 1 (2015)"}\NormalTok{)}
\NormalTok{d5 }\OtherTok{\textless{}{-}} \StringTok{"12/30/14"} \CommentTok{\# Dec 30, 2014}
\NormalTok{t1 }\OtherTok{\textless{}{-}} \StringTok{"1705"}
\NormalTok{t2 }\OtherTok{\textless{}{-}} \StringTok{"11:15:10.12 PM"}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{æ—¥æœŸ-æ—¶é—´ç»„ä»¶}\label{ux65e5ux671f-ux65f6ux95f4ux7ec4ux4ef6}

ç°åœ¨ä½ å·²ç»çŸ¥é“äº†å¦‚ä½•å°†æ—¥æœŸ-æ—¶é—´æ•°æ®å¯¼å…¥åˆ° R
çš„æ—¥æœŸ-æ—¶é—´æ•°æ®ç»“æ„ä¸­ï¼Œæ¥ä¸‹æ¥æ¢ç´¢ä¸€ä¸‹å¯ä»¥ç”¨å®ƒä»¬åšäº›ä»€ä¹ˆã€‚æœ¬
èŠ‚å°†é‡ç‚¹ä»‹ç»è·å–å’Œè®¾ç½®å•ä¸ªç»„ä»¶çš„å­˜å–å‡½æ•°ï¼ˆaccessor
functionsï¼‰ï¼Œä¸‹ä¸€èŠ‚å°†æ¢è®¨æ—¥æœŸ-æ—¶é—´çš„ç®—æœ¯è¿ç®—ã€‚

\subsection{è·å–ç»„ä»¶}\label{ux83b7ux53d6ux7ec4ux4ef6}

ä½ å¯ä»¥ä½¿ç”¨å­˜å–å‡½æ•°\texttt{year()}ã€\texttt{month()}ã€\texttt{mday()}ï¼ˆä¸€æœˆä¸­çš„æŸå¤©ï¼‰ã€\texttt{yday()}ï¼ˆä¸€å¹´ä¸­çš„æŸå¤©ï¼‰ã€\texttt{wday()}ï¼ˆä¸€å‘¨ä¸­çš„æŸå¤©ï¼‰ã€\texttt{hour()}ã€\texttt{minute()}å’Œ\texttt{second()}æ¥æå–æ—¥æœŸçš„å„ä¸ªéƒ¨åˆ†ã€‚è¿™
äº›å‡½æ•°å®é™…ä¸Šæ˜¯\texttt{make\_datetime()}çš„åç›¸æ“ä½œã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{datetime }\OtherTok{\textless{}{-}} \FunctionTok{ymd\_hms}\NormalTok{(}\StringTok{"2026{-}07{-}08 12:34:56"}\NormalTok{)}

\FunctionTok{year}\NormalTok{(datetime)}
\CommentTok{\#\textgreater{} [1] 2026}
\FunctionTok{month}\NormalTok{(datetime)}
\CommentTok{\#\textgreater{} [1] 7}
\FunctionTok{mday}\NormalTok{(datetime)}
\CommentTok{\#\textgreater{} [1] 8}

\FunctionTok{yday}\NormalTok{(datetime)}
\CommentTok{\#\textgreater{} [1] 189}
\FunctionTok{wday}\NormalTok{(datetime)}
\CommentTok{\#\textgreater{} [1] 4}
\end{Highlighting}
\end{Shaded}

å¯¹äº\texttt{month()}å’Œ\texttt{wday()}ï¼Œä½ å¯ä»¥è®¾ç½®\texttt{label\ =\ TRUE}æ¥è¿”å›æœˆä»½çš„ç¼©å†™åæˆ–æ˜ŸæœŸå‡ çš„ç¼©å†™åã€‚è®¾
ç½®\texttt{abbr\ =\ FALSE}æ¥è¿”å›å…¨åã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{month}\NormalTok{(datetime, }\AttributeTok{label =} \ConstantTok{TRUE}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] Jul}
\CommentTok{\#\textgreater{} 12 Levels: Jan \textless{} Feb \textless{} Mar \textless{} Apr \textless{} May \textless{} Jun \textless{} Jul \textless{} Aug \textless{} Sep \textless{} ... \textless{} Dec}
\FunctionTok{wday}\NormalTok{(datetime, }\AttributeTok{label =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{abbr =} \ConstantTok{FALSE}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] Wednesday}
\CommentTok{\#\textgreater{} 7 Levels: Sunday \textless{} Monday \textless{} Tuesday \textless{} Wednesday \textless{} Thursday \textless{} ... \textless{} Saturday}
\end{Highlighting}
\end{Shaded}

ä½¿ç”¨\texttt{wday()}ä¼šå‘ç°å·¥ä½œæ—¥èµ·é£çš„èˆªç­æ¯”å‘¨æœ«èµ·é£çš„èˆªç­å¤šï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights\_dt }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{wday =} \FunctionTok{wday}\NormalTok{(dep\_time, }\AttributeTok{label =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ wday)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{datetimes_files/figure-pdf/unnamed-chunk-20-1.pdf}

è¿˜å¯ä»¥æŸ¥çœ‹ä¸€å°æ—¶å†…çš„å¹³å‡èµ·é£å»¶è¯¯æ—¶é—´ï¼ˆä»¥åˆ†é’Ÿä¸ºå•ä½ï¼‰ã€‚ä½ 
ä¼šå‘ç°ä¸€ä¸ªæœ‰è¶£çš„æ¨¡å¼ï¼š20ï½30åˆ†é’Ÿå’Œ50ï½60åˆ†é’Ÿèµ·é£çš„èˆªç­æ¯”å…¶ä»–æ—¶é—´çš„èˆªç­å»¶è¯¯è¦å°‘å¾—å¤šï¼

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights\_dt }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{minute =} \FunctionTok{minute}\NormalTok{(dep\_time)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(minute) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{avg\_delay =} \FunctionTok{mean}\NormalTok{(dep\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{()}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ minute, }\AttributeTok{y =}\NormalTok{ avg\_delay)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{datetimes_files/figure-pdf/unnamed-chunk-21-1.pdf}

æœ‰è¶£çš„æ˜¯ï¼Œå¦‚æœæŸ¥çœ‹é¢„å®šçš„èµ·é£æ—¶é—´ï¼Œåˆ™ä¸ä¼šå‘ç°è¿™ç§æ˜æ˜¾çš„æ¨¡å¼:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sched\_dep }\OtherTok{\textless{}{-}}\NormalTok{ flights\_dt }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{minute =} \FunctionTok{minute}\NormalTok{(sched\_dep\_time)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(minute) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{avg\_delay =} \FunctionTok{mean}\NormalTok{(arr\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{()}
\NormalTok{  )}

\FunctionTok{ggplot}\NormalTok{(sched\_dep, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ minute, }\AttributeTok{y =}\NormalTok{ avg\_delay)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{datetimes_files/figure-pdf/unnamed-chunk-22-1.pdf}

é‚£ä¹ˆä¸ºä»€ä¹ˆåœ¨å®é™…èµ·é£æ—¶é—´ä¸­çœ‹åˆ°äº†è¿™ä¸ªæ¨¡å¼å‘¢ï¼Ÿè¿™
å°±åƒäººç±»æ”¶é›†çš„å¾ˆå¤šæ•°æ®ä¸€æ ·ï¼Œäººä»¬å¼ºçƒˆå€¾å‘äºåœ¨``åˆé€‚''çš„èµ·é£æ—¶é—´èµ·é£çš„èˆªç­ï¼Œæ­£å¦‚
å›¾~\ref{fig-human-rounding}
æ‰€å±•ç¤ºçš„ï¼Œæ¯å½“ä½ å¤„ç†æ¶‰åŠäººç±»åˆ¤æ–­çš„æ•°æ®æ—¶ï¼Œéƒ½è¦è­¦æƒ•è¿™ç§æ¨¡å¼çš„å‡ºç°ï¼

\begin{figure}

\centering{

\includegraphics[width=18.75in,height=\textheight]{datetimes_files/figure-pdf/fig-human-rounding-1.pdf}

}

\caption{\label{fig-human-rounding}A frequency polygon showing the
number of flights scheduled to depart each hour. You can see a strong
preference for round numbers like 0 and 30 and generally for numbers
that are a multiple of five.}

\end{figure}%

\subsection{å››èˆäº”å…¥ï¼ˆroundingï¼‰}\label{ux56dbux820dux4e94ux5165rounding}

ç»˜åˆ¶å•ä¸ªç»„ä»¶çš„å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨\texttt{floor\_date()}ã€\texttt{round\_date()}å’Œ\texttt{ceiling\_date()}å°†æ—¥æœŸå››èˆäº”å…¥åˆ°é™„è¿‘çš„æ—¶é—´å•ä½ã€‚æ¯
ä¸ªå‡½æ•°éƒ½æ¥å—ä¸€ä¸ªæ—¥æœŸå‘é‡è¿›è¡Œè°ƒæ•´ï¼Œç„¶åæ˜¯è¦å‘ä¸‹ï¼ˆfloorï¼‰ã€å‘ä¸Šå–æ•´ï¼ˆceilingï¼‰æˆ–å››èˆäº”å…¥åˆ°çš„å•ä½åç§°ã€‚ä¾‹
å¦‚ï¼Œä¸‹é¢çš„ä»£ç å¯ä»¥ç»˜åˆ¶æ¯å‘¨çš„èˆªç­æ•°é‡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights\_dt }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count}\NormalTok{(}\AttributeTok{week =} \FunctionTok{floor\_date}\NormalTok{(dep\_time, }\StringTok{"week"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ week, }\AttributeTok{y =}\NormalTok{ n)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+} 
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{datetimes_files/figure-pdf/unnamed-chunk-24-1.pdf}

ä½ å¯ä»¥ä½¿ç”¨å››èˆäº”å…¥æ¥è®¡ç®—\texttt{dep\_time}ä¸å½“å¤©æœ€æ—©æ—¶é—´ä¹‹é—´çš„å·®å€¼ï¼Œä»è€Œæ˜¾ç¤ºèˆªç­åœ¨ä¸€å¤©å†…çš„åˆ†å¸ƒæƒ…å†µã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights\_dt }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{dep\_hour =}\NormalTok{ dep\_time }\SpecialCharTok{{-}} \FunctionTok{floor\_date}\NormalTok{(dep\_time, }\StringTok{"day"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ dep\_hour)) }\SpecialCharTok{+}
  \FunctionTok{geom\_freqpoly}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{60} \SpecialCharTok{*} \DecValTok{30}\NormalTok{)}
\CommentTok{\#\textgreater{} Don\textquotesingle{}t know how to automatically pick scale for object of type \textless{}difftime\textgreater{}.}
\CommentTok{\#\textgreater{} Defaulting to continuous.}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{datetimes_files/figure-pdf/unnamed-chunk-25-1.pdf}

è®¡ç®—ä¸€å¯¹æ—¥æœŸ-æ—¶é—´ä¹‹é—´çš„å·®å€¼ä¼šäº§ç”Ÿdifftime(æ›´å¤šä¿¡æ¯è¯·å‚è§@sec-intervals)ã€‚æˆ‘
ä»¬å¯ä»¥å°†å…¶è½¬æ¢ä¸º\texttt{hms}å¯¹è±¡ä»¥è·å¾—æ›´æœ‰ç”¨çš„xè½´:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights\_dt }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{dep\_hour =}\NormalTok{ hms}\SpecialCharTok{::}\FunctionTok{as\_hms}\NormalTok{(dep\_time }\SpecialCharTok{{-}} \FunctionTok{floor\_date}\NormalTok{(dep\_time, }\StringTok{"day"}\NormalTok{))) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ dep\_hour)) }\SpecialCharTok{+}
  \FunctionTok{geom\_freqpoly}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{60} \SpecialCharTok{*} \DecValTok{30}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{datetimes_files/figure-pdf/unnamed-chunk-26-1.pdf}

\subsection{ä¿®æ”¹ç»„ä»¶}\label{ux4feeux6539ux7ec4ux4ef6}

å¯ä»¥ä½¿ç”¨æ¯ä¸ªå­˜å–å‡½æ•°æ¥ä¿®æ”¹æ—¥æœŸ/æ—¶é—´çš„ç»„ä»¶ã€‚è¿™
åœ¨æ•°æ®åˆ†æä¸­å¹¶ä¸å¸¸è§ï¼Œä½†åœ¨æ¸…ç†æ—¥æœŸæ˜æ˜¾ä¸æ­£ç¡®çš„æ•°æ®æ—¶å¾ˆæœ‰ç”¨ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(datetime }\OtherTok{\textless{}{-}} \FunctionTok{ymd\_hms}\NormalTok{(}\StringTok{"2026{-}07{-}08 12:34:56"}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] "2026{-}07{-}08 12:34:56 UTC"}

\FunctionTok{year}\NormalTok{(datetime) }\OtherTok{\textless{}{-}} \DecValTok{2030}
\NormalTok{datetime}
\CommentTok{\#\textgreater{} [1] "2030{-}07{-}08 12:34:56 UTC"}
\FunctionTok{month}\NormalTok{(datetime) }\OtherTok{\textless{}{-}} \DecValTok{01}
\NormalTok{datetime}
\CommentTok{\#\textgreater{} [1] "2030{-}01{-}08 12:34:56 UTC"}
\FunctionTok{hour}\NormalTok{(datetime) }\OtherTok{\textless{}{-}} \FunctionTok{hour}\NormalTok{(datetime) }\SpecialCharTok{+} \DecValTok{1}
\NormalTok{datetime}
\CommentTok{\#\textgreater{} [1] "2030{-}01{-}08 13:34:56 UTC"}
\end{Highlighting}
\end{Shaded}

å¦å¤–ï¼Œå¯ä»¥ä½¿ç”¨\texttt{update()}åˆ›å»ºä¸€ä¸ªæ–°çš„æ—¥æœŸ-æ—¶é—´ï¼Œè€Œä¸æ˜¯ä¿®æ”¹ç°æœ‰çš„å˜é‡ã€‚è¿™
å…è®¸ä½ åœ¨ä¸€æ­¥ä¸­è®¾ç½®å¤šä¸ªå€¼:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{update}\NormalTok{(datetime, }\AttributeTok{year =} \DecValTok{2030}\NormalTok{, }\AttributeTok{month =} \DecValTok{2}\NormalTok{, }\AttributeTok{mday =} \DecValTok{2}\NormalTok{, }\AttributeTok{hour =} \DecValTok{2}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "2030{-}02{-}02 02:34:56 UTC"}
\end{Highlighting}
\end{Shaded}

å¦‚æœå€¼å¤ªå¤§, åˆ™ä¼šæ»šåŠ¨è®¡ç®—:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{update}\NormalTok{(}\FunctionTok{ymd}\NormalTok{(}\StringTok{"2023{-}02{-}01"}\NormalTok{), }\AttributeTok{mday =} \DecValTok{30}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "2023{-}03{-}02"}
\FunctionTok{update}\NormalTok{(}\FunctionTok{ymd}\NormalTok{(}\StringTok{"2023{-}02{-}01"}\NormalTok{), }\AttributeTok{hour =} \DecValTok{400}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "2023{-}02{-}17 16:00:00 UTC"}
\end{Highlighting}
\end{Shaded}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-46}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ä¸€å¤©å†…çš„é£è¡Œæ—¶é—´åˆ†å¸ƒåœ¨ä¸€å¹´ä¸­æ˜¯å¦‚ä½•å˜åŒ–çš„?
\item
  æ¯”è¾ƒ \texttt{dep\_time}, \texttt{sched\_dep\_time} å’Œ
  \texttt{dep\_delay}ï¼Œå®ƒä»¬æ˜¯ä¸€è‡´çš„å—ï¼Ÿè§£ é‡Šä½ çš„å‘ç°ã€‚
\item
  æ¯”è¾ƒ\texttt{air\_time}ä¸èµ·é£å’Œåˆ°è¾¾ä¹‹é—´çš„æ—¶é—´é—´éš”ï¼Œå¹¶è§£é‡Šä½ çš„å‘ç°ã€‚ï¼ˆ
  æç¤º: è€ƒè™‘æœºåœºä½ç½®ï¼‰
\item
  ä¸€å¤©ä¸­å¹³å‡å»¶è¯¯æ—¶é—´æ˜¯å¦‚ä½•å˜åŒ–çš„ï¼Ÿåº”
  è¯¥ä½¿ç”¨\texttt{dep\_time}è¿˜æ˜¯\texttt{sched\_dep\_time}ï¼Ÿä¸º ä»€ä¹ˆï¼Ÿ
\item
  å¦‚æœæƒ³æœ€å°åŒ–å»¶è¯¯çš„å¯èƒ½æ€§ï¼Œä½ åº”è¯¥é€‰æ‹©ä¸€å‘¨ä¸­çš„å“ªä¸€å¤©ç¦»å¼€ï¼Ÿ
\item
  ä»€ä¹ˆä½¿å¾—\texttt{diamonds\$carat}å’Œ\texttt{flights\$sched\_dep\_time}çš„åˆ†å¸ƒç›¸ä¼¼ï¼Ÿ
\item
  è¯å®è¿™ä¸ªå‡è®¾ï¼šèˆªç­åœ¨20ï½30åˆ†é’Ÿå’Œ50ï½60åˆ†é’Ÿå†…ææ—©å‡ºå‘æ˜¯å› ä¸ºè¿™äº›èˆªç­åŸæœ¬å°±å®‰æ’åœ¨è¿™ä¸ªæ—¶é—´æå‰å‡ºå‘ã€‚(
  æç¤º: åˆ›å»ºä¸€ä¸ªäºŒåˆ†ç±»å˜é‡æ¥å‘Šè¯‰ä½ èˆªç­æ˜¯å¦å»¶è¯¯)
\end{enumerate}

\section{æ—¶é—´è·¨åº¦}\label{ux65f6ux95f4ux8de8ux5ea6}

æ¥ä¸‹æ¥ï¼Œä½ å°†å­¦ä¹ æ—¥æœŸçš„ç®—æœ¯è¿ç®—ï¼ŒåŒ…æ‹¬å‡æ³•ã€åŠ æ³•å’Œé™¤æ³•ã€‚åœ¨
è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œäº†è§£ä¸‰ç§è¡¨ç¤ºæ—¶é—´è·¨åº¦çš„é‡è¦ç±»ï¼š

\begin{itemize}
\tightlist
\item
  \textbf{æ—¶é•¿}ï¼ˆDurationsï¼‰ï¼Œç²¾ç¡®åˆ°ç§’çš„ä¸€ä¸ªæ•°å­—ã€‚
\item
  \textbf{å‘¨æœŸ}ï¼ˆPeriodsï¼‰ï¼Œäººç±»å®šä¹‰çš„æ—¶é—´å•ä½ï¼Œå¦‚å‘¨å’Œæœˆã€‚
\item
  \textbf{åŒºé—´}ï¼ˆIntervalsï¼‰ï¼Œè¡¨ç¤ºèµ·ç‚¹å’Œç»ˆç‚¹ã€‚
\end{itemize}

å¦‚ä½•åœ¨æŒç»­æ—¶é—´ã€å‘¨æœŸå’Œé—´éš”ä¹‹é—´åšå‡ºé€‰æ‹©ï¼Ÿå’Œ
å¾€å¸¸ä¸€æ ·ï¼Œé€‰æ‹©æœ€ç®€å•çš„èƒ½è§£å†³ä½ é—®é¢˜çš„æ•°æ®ç»“æ„ã€‚å¦‚
æœä½ åªå…³å¿ƒç‰©ç†æ—¶é—´ï¼Œä½¿ç”¨æŒç»­æ—¶é—´ï¼›å¦‚æœä½ éœ€è¦æ·»åŠ äººç±»çš„æ—¶é—´å•ä½ï¼Œä½¿ç”¨å‘¨æœŸï¼›å¦‚æœä½ éœ€è¦è®¡ç®—å‡ºäººç±»æ—¶é—´å•ä½ä¸‹çš„æ—¶é—´è·¨åº¦æœ‰å¤šé•¿ï¼Œä½¿ç”¨é—´éš”ã€‚

\subsection{æ—¶é•¿}\label{ux65f6ux957f}

åœ¨Rä¸­ï¼Œå½“ä¸¤ä¸ªæ—¥æœŸç›¸å‡åä½ ä¼šå¾—åˆ°ä¸€ä¸ªdifftimeå¯¹è±¡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# How old is Hadley?}
\NormalTok{h\_age }\OtherTok{\textless{}{-}} \FunctionTok{today}\NormalTok{() }\SpecialCharTok{{-}} \FunctionTok{ymd}\NormalTok{(}\StringTok{"1979{-}10{-}14"}\NormalTok{)}
\NormalTok{h\_age}
\CommentTok{\#\textgreater{} Time difference of 16303 days}
\end{Highlighting}
\end{Shaded}

\texttt{difftime}ç±»çš„ä¸€ä¸ªå¯¹è±¡è®°å½•äº†ä¸€ä¸ªæ—¶é—´è·¨åº¦ï¼Œå¯ä»¥æ˜¯ç§’ã€åˆ†ã€å°æ—¶ã€å¤©æˆ–å‘¨ã€‚è¿™
ç§ä¸ç¡®å®šæ€§å¯èƒ½ä¼šè®©difftimesä½¿ç”¨èµ·æ¥æœ‰äº›éº»çƒ¦ã€‚å› 
æ­¤ï¼Œlubridateæä¾›äº†ä¸€ä¸ªæ€»æ˜¯ä»¥ç§’ä¸ºå•ä½çš„æ›¿ä»£æ–¹æ¡ˆï¼šæ—¶é•¿ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{as.duration}\NormalTok{(h\_age)}
\CommentTok{\#\textgreater{} [1] "1408579200s (\textasciitilde{}44.64 years)"}
\end{Highlighting}
\end{Shaded}

æ—¶é•¿æä¾›äº†ä¸€ç³»åˆ—æ–¹ä¾¿çš„æ„é€ å‡½æ•°:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dseconds}\NormalTok{(}\DecValTok{15}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "15s"}
\FunctionTok{dminutes}\NormalTok{(}\DecValTok{10}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "600s (\textasciitilde{}10 minutes)"}
\FunctionTok{dhours}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{12}\NormalTok{, }\DecValTok{24}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] "43200s (\textasciitilde{}12 hours)" "86400s (\textasciitilde{}1 days)"}
\FunctionTok{ddays}\NormalTok{(}\DecValTok{0}\SpecialCharTok{:}\DecValTok{5}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "0s"                "86400s (\textasciitilde{}1 days)"  "172800s (\textasciitilde{}2 days)"}
\CommentTok{\#\textgreater{} [4] "259200s (\textasciitilde{}3 days)" "345600s (\textasciitilde{}4 days)" "432000s (\textasciitilde{}5 days)"}
\FunctionTok{dweeks}\NormalTok{(}\DecValTok{3}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "1814400s (\textasciitilde{}3 weeks)"}
\FunctionTok{dyears}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "31557600s (\textasciitilde{}1 years)"}
\end{Highlighting}
\end{Shaded}

æ—¶é•¿æ€»æ˜¯ä»¥ç§’ä¸ºå•ä½è®°å½•æ—¶é—´è·¨åº¦ã€‚è¾ƒ
å¤§çš„å•ä½æ˜¯é€šè¿‡å°†åˆ†é’Ÿã€å°æ—¶ã€å¤©ã€å‘¨å’Œå¹´è½¬æ¢ä¸ºç§’æ¥åˆ›å»ºçš„ï¼šä¸€åˆ†é’Ÿæœ‰60ç§’ï¼Œä¸€å°æ—¶æœ‰60åˆ†é’Ÿï¼Œä¸€å¤©æœ‰24å°æ—¶ï¼Œä¸€å‘¨æœ‰7å¤©ã€‚æ›´
å¤§çš„æ—¶é—´å•ä½åˆ™æ›´æˆé—®é¢˜ã€‚ä¸€ å¹´ä½¿ç”¨ä¸€å¹´ä¸­çš„``å¹³å‡''å¤©æ•°ï¼Œå³365.25ã€‚æ²¡
æœ‰åŠæ³•å°†æœˆè½¬æ¢ä¸ºæ—¶é•¿ï¼Œå› ä¸ºå˜åŒ–å¤ªå¤šäº†ã€‚

å¯ä»¥å¯¹æ—¶é•¿è¿›è¡ŒåŠ æ³•å’Œä¹˜æ³•è¿ç®—ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{2} \SpecialCharTok{*} \FunctionTok{dyears}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "63115200s (\textasciitilde{}2 years)"}
\FunctionTok{dyears}\NormalTok{(}\DecValTok{1}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{dweeks}\NormalTok{(}\DecValTok{12}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{dhours}\NormalTok{(}\DecValTok{15}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "38869200s (\textasciitilde{}1.23 years)"}
\end{Highlighting}
\end{Shaded}

ä¹Ÿå¯ä»¥ç”¨æ—¥æœŸä¸æ—¶é•¿è¿›è¡ŒåŠ æ³•æˆ–å‡æ³•è¿ç®—ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tomorrow }\OtherTok{\textless{}{-}} \FunctionTok{today}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{ddays}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\NormalTok{last\_year }\OtherTok{\textless{}{-}} \FunctionTok{today}\NormalTok{() }\SpecialCharTok{{-}} \FunctionTok{dyears}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

ç„¶è€Œï¼Œç”±äºæ—¶é•¿æ˜¯ä»¥ç§’ä¸ºå•ä½çš„ç¡®åˆ‡æ•°å­—ï¼Œæœ‰æ—¶å¯èƒ½ä¼šå¾—åˆ°æ„æƒ³ä¸åˆ°çš„ç»“æœï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{one\_am }\OtherTok{\textless{}{-}} \FunctionTok{ymd\_hms}\NormalTok{(}\StringTok{"2026{-}03{-}08 01:00:00"}\NormalTok{, }\AttributeTok{tz =} \StringTok{"America/New\_York"}\NormalTok{)}

\NormalTok{one\_am}
\CommentTok{\#\textgreater{} [1] "2026{-}03{-}08 01:00:00 EST"}
\NormalTok{one\_am }\SpecialCharTok{+} \FunctionTok{ddays}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "2026{-}03{-}09 02:00:00 EDT"}
\end{Highlighting}
\end{Shaded}

ä¸ºä»€ä¹ˆ3æœˆ8æ—¥å‡Œæ™¨1ç‚¹çš„ä¸€å¤©ä¹‹åæ˜¯3æœˆ9æ—¥å‡Œæ™¨2ç‚¹ï¼Ÿå¦‚
æœä»”ç»†è§‚å¯Ÿæ—¥æœŸï¼Œå°±ä¼šæ³¨æ„åˆ°æ—¶åŒºå·²ç»æ”¹å˜äº†ã€‚3
æœˆ8æ—¥åªæœ‰23å°æ—¶ï¼Œå› ä¸ºè¿™ä¸€å¤©æ˜¯å¤ä»¤æ—¶å¼€å§‹çš„æ—¶é—´ï¼Œæ‰€ä»¥å¦‚æœåŠ ä¸Šä¸€æ•´å¤©æ‰€åŒ…å«çš„ç§’æ•°ï¼Œæœ€ç»ˆä¼šå¾—åˆ°ä¸åŒçš„æ—¶é—´ã€‚

\subsection{å‘¨æœŸ}\label{ux5468ux671f}

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œlubridateæä¾›äº†å‘¨æœŸã€‚
å‘¨æœŸæ˜¯æ—¶é—´è·¨åº¦ï¼Œä½†å®ƒä»¬ä¸ä»¥å›ºå®šçš„ç§’æ•°æ¥è¡¨ç¤ºï¼Œè€Œæ˜¯ä½¿ç”¨``äººç±»''çš„æ—¶é—´å•ä½ï¼Œå¦‚å¤©å’Œæœˆï¼Œè¿™ä½¿å¾—å®ƒä»¬ä»¥æ›´ç›´è§‚çš„æ–¹å¼å·¥ä½œï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{one\_am}
\CommentTok{\#\textgreater{} [1] "2026{-}03{-}08 01:00:00 EST"}
\NormalTok{one\_am }\SpecialCharTok{+} \FunctionTok{days}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "2026{-}03{-}09 01:00:00 EDT"}
\end{Highlighting}
\end{Shaded}

ä¸æ—¶é•¿ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨è®¸å¤šå‹å¥½çš„æ„é€ å‡½æ•°åˆ›å»ºå‘¨æœŸã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{hours}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{12}\NormalTok{, }\DecValTok{24}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] "12H 0M 0S" "24H 0M 0S"}
\FunctionTok{days}\NormalTok{(}\DecValTok{7}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "7d 0H 0M 0S"}
\FunctionTok{months}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{6}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "1m 0d 0H 0M 0S" "2m 0d 0H 0M 0S" "3m 0d 0H 0M 0S" "4m 0d 0H 0M 0S"}
\CommentTok{\#\textgreater{} [5] "5m 0d 0H 0M 0S" "6m 0d 0H 0M 0S"}
\end{Highlighting}
\end{Shaded}

å‘¨æœŸæ”¯æŒåŠ æ³•å’Œä¹˜æ³•è¿ç®—:

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{10} \SpecialCharTok{*}\NormalTok{ (}\FunctionTok{months}\NormalTok{(}\DecValTok{6}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{days}\NormalTok{(}\DecValTok{1}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] "60m 10d 0H 0M 0S"}
\FunctionTok{days}\NormalTok{(}\DecValTok{50}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{hours}\NormalTok{(}\DecValTok{25}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{minutes}\NormalTok{(}\DecValTok{2}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "50d 25H 2M 0S"}
\end{Highlighting}
\end{Shaded}

å½“ç„¶, ä¹Ÿå¯ä»¥ä¸æ—¥æœŸç›¸åŠ ï¼›ä¸æ—¶é•¿ç›¸æ¯”ï¼Œå‘¨æœŸç»æœŸæ›´æœ‰å¯èƒ½åšä½ é¢„æœŸçš„äº‹æƒ…ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# A leap year}
\FunctionTok{ymd}\NormalTok{(}\StringTok{"2024{-}01{-}01"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{dyears}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "2024{-}12{-}31 06:00:00 UTC"}
\FunctionTok{ymd}\NormalTok{(}\StringTok{"2024{-}01{-}01"}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{years}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "2025{-}01{-}01"}

\CommentTok{\# Daylight saving time}
\NormalTok{one\_am }\SpecialCharTok{+} \FunctionTok{ddays}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "2026{-}03{-}09 02:00:00 EDT"}
\NormalTok{one\_am }\SpecialCharTok{+} \FunctionTok{days}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "2026{-}03{-}09 01:00:00 EDT"}
\end{Highlighting}
\end{Shaded}

è®©æˆ‘ä»¬ä½¿ç”¨\texttt{å‘¨æœŸ}æ¥ä¿®å¤ä¸èˆªç­æ—¥æœŸç›¸å…³çš„ä¸€ä¸ªå¼‚å¸¸é—®é¢˜ã€‚ä¸€
äº›é£æœºä¼¼ä¹åœ¨ç¦»å¼€çº½çº¦å¸‚ä¹‹å‰å°±å·²ç»åˆ°è¾¾äº†ç›®çš„åœ°ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights\_dt }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(arr\_time }\SpecialCharTok{\textless{}}\NormalTok{ dep\_time) }
\CommentTok{\#\textgreater{} \# A tibble: 10,633 x 9}
\CommentTok{\#\textgreater{}   origin dest  dep\_delay arr\_delay dep\_time            sched\_dep\_time     }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}  \textless{}chr\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{} \textless{}dttm\textgreater{}              \textless{}dttm\textgreater{}             }
\CommentTok{\#\textgreater{} 1 EWR    BQN           9        {-}4 2013{-}01{-}01 19:29:00 2013{-}01{-}01 19:20:00}
\CommentTok{\#\textgreater{} 2 JFK    DFW          59        NA 2013{-}01{-}01 19:39:00 2013{-}01{-}01 18:40:00}
\CommentTok{\#\textgreater{} 3 EWR    TPA          {-}2         9 2013{-}01{-}01 20:58:00 2013{-}01{-}01 21:00:00}
\CommentTok{\#\textgreater{} 4 EWR    SJU          {-}6       {-}12 2013{-}01{-}01 21:02:00 2013{-}01{-}01 21:08:00}
\CommentTok{\#\textgreater{} 5 EWR    SFO          11       {-}14 2013{-}01{-}01 21:08:00 2013{-}01{-}01 20:57:00}
\CommentTok{\#\textgreater{} 6 LGA    FLL         {-}10        {-}2 2013{-}01{-}01 21:20:00 2013{-}01{-}01 21:30:00}
\CommentTok{\#\textgreater{} \# i 10,627 more rows}
\CommentTok{\#\textgreater{} \# i 3 more variables: arr\_time \textless{}dttm\textgreater{}, sched\_arr\_time \textless{}dttm\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

è¿™äº›éƒ½æ˜¯å¤œé—´èˆªç­ã€‚æˆ‘
ä»¬ä¸ºå‡ºå‘å’Œåˆ°è¾¾æ—¶é—´ä½¿ç”¨äº†ç›¸åŒçš„æ—¥æœŸä¿¡æ¯ï¼Œä½†è¿™äº›èˆªç­åœ¨ç¬¬äºŒå¤©åˆ°è¾¾ã€‚æˆ‘
ä»¬å¯ä»¥é€šè¿‡åœ¨æ¯ä¸ªå¤œé—´èˆªç­çš„åˆ°è¾¾æ—¶é—´ä¸Šå¢åŠ \texttt{days(1)}æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights\_dt }\OtherTok{\textless{}{-}}\NormalTok{ flights\_dt }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{overnight =}\NormalTok{ arr\_time }\SpecialCharTok{\textless{}}\NormalTok{ dep\_time,}
    \AttributeTok{arr\_time =}\NormalTok{ arr\_time }\SpecialCharTok{+} \FunctionTok{days}\NormalTok{(overnight),}
    \AttributeTok{sched\_arr\_time =}\NormalTok{ sched\_arr\_time }\SpecialCharTok{+} \FunctionTok{days}\NormalTok{(overnight)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

ç°åœ¨æ‰€æœ‰èˆªç­éƒ½éµå¾ªç‰©ç†å®šå¾‹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights\_dt }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(arr\_time }\SpecialCharTok{\textless{}}\NormalTok{ dep\_time) }
\CommentTok{\#\textgreater{} \# A tibble: 0 x 10}
\CommentTok{\#\textgreater{} \# i 10 variables: origin \textless{}chr\textgreater{}, dest \textless{}chr\textgreater{}, dep\_delay \textless{}dbl\textgreater{},}
\CommentTok{\#\textgreater{} \#   arr\_delay \textless{}dbl\textgreater{}, dep\_time \textless{}dttm\textgreater{}, sched\_dep\_time \textless{}dttm\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

\subsection{åŒºé—´}\label{sec-intervals}

\texttt{dyears(1)\ /\ ddays(365)}è¿”å›çš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿå¹¶
ä¸æ˜¯1ï¼Œå› ä¸º\texttt{dyears()}è¢«å®šä¹‰ä¸ºå¹³å‡æ¯å¹´æœ‰å¤šå°‘ç§’ï¼Œè¿™ç­‰äº365.25å¤©ã€‚

\texttt{years(1)\ /\ days(1)}è¿”å›ä»€ä¹ˆå€¼å‘¢ï¼Ÿå¦‚
æœå¹´ä»½æ˜¯2015å¹´ï¼Œå®ƒåº”è¯¥è¿”å›365ï¼Œä½†å¦‚æœå¹´ä»½æ˜¯2016å¹´ï¼Œå®ƒåº”è¯¥è¿”å›366ï¼l
ubridate æ²¡æœ‰è¶³å¤Ÿçš„ä¿¡æ¯æ¥ç»™å‡ºä¸€ä¸ªæ˜ç¡®çš„ç­”æ¡ˆï¼Œç›¸åï¼Œå®ƒç»™å‡ºäº†ä¸€ä¸ªä¼°è®¡å€¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{years}\NormalTok{(}\DecValTok{1}\NormalTok{) }\SpecialCharTok{/} \FunctionTok{days}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] 365.25}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ æƒ³è¦ä¸€ä¸ªæ›´å‡†ç¡®çš„æµ‹é‡ï¼Œä½ å°†éœ€è¦ä½¿ç”¨åŒºé—´ã€‚åŒº
é—´æ˜¯ä¸€å¯¹å¼€å§‹å’Œç»“æŸæ—¥æœŸæ—¶é—´ï¼Œæˆ–è€…ä½ å¯ä»¥å°†å…¶è§†ä¸ºå¸¦æœ‰èµ·å§‹ç‚¹çš„æ—¶é•¿ã€‚

ä½ å¯ä»¥é€šè¿‡ç¼–å†™\texttt{start\ \%-\/-\%\ end}æ¥åˆ›å»ºä¸€ä¸ªåŒºé—´ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y2023 }\OtherTok{\textless{}{-}} \FunctionTok{ymd}\NormalTok{(}\StringTok{"2023{-}01{-}01"}\NormalTok{) }\SpecialCharTok{\%{-}{-}\%} \FunctionTok{ymd}\NormalTok{(}\StringTok{"2024{-}01{-}01"}\NormalTok{)}
\NormalTok{y2024 }\OtherTok{\textless{}{-}} \FunctionTok{ymd}\NormalTok{(}\StringTok{"2024{-}01{-}01"}\NormalTok{) }\SpecialCharTok{\%{-}{-}\%} \FunctionTok{ymd}\NormalTok{(}\StringTok{"2025{-}01{-}01"}\NormalTok{)}

\NormalTok{y2023}
\CommentTok{\#\textgreater{} [1] 2023{-}01{-}01 UTC{-}{-}2024{-}01{-}01 UTC}
\NormalTok{y2024}
\CommentTok{\#\textgreater{} [1] 2024{-}01{-}01 UTC{-}{-}2025{-}01{-}01 UTC}
\end{Highlighting}
\end{Shaded}

ç„¶åä½ å¯ä»¥ç”¨å®ƒé™¤ä»¥\texttt{days()}æ¥è®¡ç®—ä¸€å¹´ä¸­æœ‰å¤šå°‘å¤©:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y2023 }\SpecialCharTok{/} \FunctionTok{days}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] 365}
\NormalTok{y2024 }\SpecialCharTok{/} \FunctionTok{days}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] 366}
\end{Highlighting}
\end{Shaded}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-47}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  å‘åˆšå¼€å§‹å­¦ä¹ Rçš„äººè§£é‡Š\texttt{days(!overnight)}å’Œ\texttt{days(overnight)}ï¼šä½ éœ€è¦çŸ¥é“çš„å…³é”®äº‹å®æ˜¯ä»€ä¹ˆï¼Ÿ
\item
  åˆ›å»ºä¸€ä¸ªå‘é‡ï¼ŒåŒ…å«2015å¹´æ¯ä¸ªæœˆçš„ç¬¬ä¸€å¤©ï¼›å†åˆ›å»ºä¸€ä¸ªå‘é‡ï¼ŒåŒ…å«å½“å‰å¹´ä»½æ¯ä¸ªæœˆçš„ç¬¬ä¸€å¤©ï¼›
\item
  ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œç»™å®šä½ çš„ç”Ÿæ—¥ï¼ˆä½œä¸ºæ—¥æœŸï¼‰ï¼Œè¿”å›ä½ çš„å¹´é¾„ï¼ˆä»¥å¹´ä¸ºå•ä½ï¼‰ï¼›
\item
  ä¸ºä»€ä¹ˆ
  \texttt{(today()\ \%-\/-\%\ (today()\ +\ years(1)))\ /\ months(1)}
  ä¸èƒ½æ­£å¸¸è¿è¡Œ?
\end{enumerate}

\section{æ—¶åŒº}\label{ux65f6ux533a}

æ—¶åŒºæ˜¯ä¸€ä¸ªæå…¶å¤æ‚çš„è¯é¢˜ï¼Œå› ä¸ºå®ƒä»¬ä¸åœ°ç¼˜æ”¿æ²»å®ä½“ç›¸äº’äº¤ç»‡ã€‚å¹¸
è¿çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ·±å…¥æ¢ç©¶æ‰€æœ‰ç»†èŠ‚ï¼Œå› ä¸ºå®ƒä»¬å¯¹äºæ•°æ®åˆ†ææ¥è¯´å¹¶ééƒ½æ˜¯é‡è¦çš„ï¼Œä½†æœ‰å‡ ä¸ªæŒ‘æˆ˜æˆ‘ä»¬éœ€è¦ç›´æ¥é¢å¯¹ã€‚

ç¬¬ä¸€ä¸ªæŒ‘æˆ˜æ˜¯æ—¥å¸¸ä½¿ç”¨çš„æ—¶åŒºåç§°å¾€å¾€å…·æœ‰æ­§ä¹‰ã€‚ä¾‹
å¦‚ï¼Œå¦‚æœä½ æ˜¯ç¾å›½äººï¼Œä½ å¯èƒ½ç†Ÿæ‚‰ESTï¼Œå³ä¸œéƒ¨æ ‡å‡†æ—¶é—´ï¼ˆEastern Standard
Timeï¼‰ã€‚ç„¶ è€Œï¼Œæ¾³å¤§åˆ©äºšå’ŒåŠ æ‹¿å¤§ä¹Ÿéƒ½æœ‰ESTï¼ä¸º
äº†é¿å…æ··æ·†ï¼ŒRä½¿ç”¨å›½é™…æ ‡å‡†IANAæ—¶åŒºã€‚I
ANAä½¿ç”¨ä¸€è‡´çš„å‘½åæ–¹æ¡ˆ\texttt{\{area\}/\{location\}}ï¼Œé€šå¸¸å½¢å¼ä¸º\texttt{\{continent\}/\{city\}}æˆ–
\texttt{\{ocean\}/\{city\}}ã€‚ä¾‹
å¦‚``America/New\_York''ã€``Europe/Paris''å’Œ``Pacific/Auckland''ã€‚

ä½ å¯èƒ½ä¼šå¥½å¥‡ä¸ºä»€ä¹ˆæ—¶åŒºä¼šä½¿ç”¨åŸå¸‚åï¼Œè€Œé€šå¸¸ä½ ä¼šè®¤ä¸ºæ—¶åŒºæ˜¯ä¸ä¸€ä¸ªå›½å®¶æˆ–å›½å®¶å†…çš„æŸä¸ªåœ°åŒºç›¸å…³è”çš„ã€‚è¿™
æ˜¯å› ä¸ºIANAæ•°æ®åº“éœ€è¦è®°å½•å‡ åå¹´æ¥çš„æ—¶åŒºè§„åˆ™ã€‚åœ¨
è¿‡å»çš„å‡ åå¹´é‡Œï¼Œå›½å®¶çš„åç§°ï¼ˆæˆ–åˆ†è£‚ï¼‰ç»å¸¸å‘ç”Ÿå˜åŒ–ï¼Œä½†åŸå¸‚åç§°å¾€å¾€ä¿æŒä¸å˜ã€‚å¦
ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œåç§°ä¸ä»…éœ€è¦åæ˜ å½“å‰çš„è¡Œä¸ºï¼Œè¿˜éœ€è¦åæ˜ å®Œæ•´çš„å†å²ã€‚ä¾‹
å¦‚ï¼Œå­˜åœ¨``America/New\_York''å’Œ``America/Detroit''è¿™ä¸¤ä¸ªæ—¶åŒºã€‚è¿™
ä¸¤ä¸ªåŸå¸‚ç›®å‰éƒ½ä½¿ç”¨ä¸œéƒ¨æ ‡å‡†æ—¶é—´ï¼Œä½†åœ¨1969-1972å¹´æœŸé—´ï¼Œå¯†æ­‡æ ¹å·ï¼ˆåº•ç‰¹å¾‹æ‰€åœ¨çš„å·ï¼‰æ²¡æœ‰å®è¡Œå¤ä»¤æ—¶ï¼Œå› æ­¤å®ƒéœ€è¦ä¸€ä¸ªä¸åŒçš„åç§°ã€‚å€¼
å¾—ä¸€è¯»çš„æ˜¯åŸå§‹çš„æ—¶åŒºæ•°æ®åº“ï¼ˆ\url{https://www.iana.org/time-zones}ï¼‰ï¼Œå…¶ä¸­è®²è¿°äº†ä¸€äº›è¿™æ ·çš„æ•…äº‹ï¼

ä½ å¯ä»¥ä½¿ç”¨\texttt{Sys.timezone()}å‡½æ•°æ¥æ‰¾å‡ºRè®¤ä¸ºä½ çš„å½“å‰æ—¶åŒºæ˜¯ä»€ä¹ˆã€‚

You can find out what R thinks your current time zone is with
\texttt{Sys.timezone()}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{Sys.timezone}\NormalTok{()}
\CommentTok{\#\textgreater{} [1] "Asia/Shanghai"}
\end{Highlighting}
\end{Shaded}

(å¦‚æœR ä¸çŸ¥é“, è¿”å› \texttt{NA}.)

ä½¿ç”¨ \texttt{OlsonNames()}æŸ¥çœ‹æ‰€æœ‰æ—¶åŒºåç§°çš„å®Œæ•´åˆ—è¡¨:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(}\FunctionTok{OlsonNames}\NormalTok{())}
\CommentTok{\#\textgreater{} [1] 597}
\FunctionTok{head}\NormalTok{(}\FunctionTok{OlsonNames}\NormalTok{())}
\CommentTok{\#\textgreater{} [1] "Africa/Abidjan"     "Africa/Accra"       "Africa/Addis\_Ababa"}
\CommentTok{\#\textgreater{} [4] "Africa/Algiers"     "Africa/Asmara"      "Africa/Asmera"}
\end{Highlighting}
\end{Shaded}

åœ¨Rä¸­ï¼Œæ—¶åŒºæ˜¯æ—¥æœŸ-æ—¶é—´çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒåªæ§åˆ¶è¾“å‡ºã€‚ä¾‹
å¦‚ï¼Œè¿™ä¸‰ä¸ªå¯¹è±¡è¡¨ç¤ºæ—¶é—´ä¸Šçš„åŒä¸€ç¬é—´

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x1 }\OtherTok{\textless{}{-}} \FunctionTok{ymd\_hms}\NormalTok{(}\StringTok{"2024{-}06{-}01 12:00:00"}\NormalTok{, }\AttributeTok{tz =} \StringTok{"America/New\_York"}\NormalTok{)}
\NormalTok{x1}
\CommentTok{\#\textgreater{} [1] "2024{-}06{-}01 12:00:00 EDT"}

\NormalTok{x2 }\OtherTok{\textless{}{-}} \FunctionTok{ymd\_hms}\NormalTok{(}\StringTok{"2024{-}06{-}01 18:00:00"}\NormalTok{, }\AttributeTok{tz =} \StringTok{"Europe/Copenhagen"}\NormalTok{)}
\NormalTok{x2}
\CommentTok{\#\textgreater{} [1] "2024{-}06{-}01 18:00:00 CEST"}

\NormalTok{x3 }\OtherTok{\textless{}{-}} \FunctionTok{ymd\_hms}\NormalTok{(}\StringTok{"2024{-}06{-}02 04:00:00"}\NormalTok{, }\AttributeTok{tz =} \StringTok{"Pacific/Auckland"}\NormalTok{)}
\NormalTok{x3}
\CommentTok{\#\textgreater{} [1] "2024{-}06{-}02 04:00:00 NZST"}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥ç”¨å‡æ³•æ¥éªŒè¯å®ƒä»¬æ˜¯ç›¸åŒçš„æ—¶é—´:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x1 }\SpecialCharTok{{-}}\NormalTok{ x2}
\CommentTok{\#\textgreater{} Time difference of 0 secs}
\NormalTok{x1 }\SpecialCharTok{{-}}\NormalTok{ x3}
\CommentTok{\#\textgreater{} Time difference of 0 secs}
\end{Highlighting}
\end{Shaded}

é™¤éå¦æœ‰æŒ‡å®šï¼Œlubridate æ€»æ˜¯ä½¿ç”¨ UTCã€‚U TCæ˜¯ç§‘å­¦ç•Œä½¿ç”¨çš„æ ‡å‡†æ—¶åŒºï¼Œç›¸å½“äº
GMTï¼ˆGreenwich Mean Timeï¼Œæ ¼æ—å¨æ²»æ ‡å‡†æ—¶é—´ï¼‰ã€‚U TC
ä¸åŒ…å«å¤ä»¤æ—¶ï¼Œè¿™ä½¿å¾—å®ƒåœ¨è®¡ç®—æ—¶éå¸¸æ–¹ä¾¿ã€‚åƒ \texttt{c()}
è¿™æ ·çš„å°†æ—¥æœŸå’Œæ—¶é—´ç»„åˆèµ·æ¥çš„æ“ä½œé€šå¸¸ä¼šä¸¢å¤±æ—¶åŒºä¿¡æ¯ã€‚åœ¨
è¿™ç§æƒ…å†µä¸‹ï¼Œæ—¥æœŸå’Œæ—¶é—´å°†ä»¥ç¬¬ä¸€ä¸ªå…ƒç´ çš„æ—¶åŒºæ˜¾ç¤ºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x4 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(x1, x2, x3)}
\NormalTok{x4}
\CommentTok{\#\textgreater{} [1] "2024{-}06{-}01 12:00:00 EDT" "2024{-}06{-}01 12:00:00 EDT"}
\CommentTok{\#\textgreater{} [3] "2024{-}06{-}01 12:00:00 EDT"}
\end{Highlighting}
\end{Shaded}

å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹æ³•æ›´æ”¹æ—¶åŒº:

\begin{itemize}
\item
  ä¿æŒç¬æ—¶æ—¶é—´ä¸å˜ï¼Œä½†æ”¹å˜å…¶æ˜¾ç¤ºæ–¹å¼ã€‚å½“
  å³æ—¶æ—¶é—´æ­£ç¡®ï¼Œä½†ä½ æƒ³è¦ä¸€ä¸ªæ›´è‡ªç„¶çš„æ–¹å¼æ˜¾ç¤ºæ—¶ä½¿ç”¨è¿™ç§æ–¹æ³•ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x4a }\OtherTok{\textless{}{-}} \FunctionTok{with\_tz}\NormalTok{(x4, }\AttributeTok{tzone =} \StringTok{"Australia/Lord\_Howe"}\NormalTok{)}
\NormalTok{x4a}
\CommentTok{\#\textgreater{} [1] "2024{-}06{-}02 02:30:00 +1030" "2024{-}06{-}02 02:30:00 +1030"}
\CommentTok{\#\textgreater{} [3] "2024{-}06{-}02 02:30:00 +1030"}
\NormalTok{x4a }\SpecialCharTok{{-}}\NormalTok{ x4}
\CommentTok{\#\textgreater{} Time differences in secs}
\CommentTok{\#\textgreater{} [1] 0 0 0}
\end{Highlighting}
\end{Shaded}

  (è¿™ä¹Ÿè¯´æ˜äº†æ—¶åŒºçš„å¦ä¸€ä¸ªæŒ‘æˆ˜ï¼šå®ƒä»¬çš„åç§»é‡å¹¶ä¸éƒ½æ˜¯ä»¥å°æ—¶ä¸ºå•ä½çš„æ•´æ•°ï¼ï¼‰
\item
  æ”¹å˜åº•å±‚çš„ç¬æ—¶æ—¶é—´ã€‚å½“
  æœ‰ä¸€ä¸ªç¬é—´è¢«æ ‡è®°äº†é”™è¯¯çš„æ—¶åŒºï¼Œå¹¶ä¸”éœ€è¦ä¿®å¤å®ƒæ—¶ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ã€‚C hange
  the underlying instant in time. Use this when you have an instant that
  has been labelled with the incorrect time zone, and you need to fix
  it.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x4b }\OtherTok{\textless{}{-}} \FunctionTok{force\_tz}\NormalTok{(x4, }\AttributeTok{tzone =} \StringTok{"Australia/Lord\_Howe"}\NormalTok{)}
\NormalTok{x4b}
\CommentTok{\#\textgreater{} [1] "2024{-}06{-}01 12:00:00 +1030" "2024{-}06{-}01 12:00:00 +1030"}
\CommentTok{\#\textgreater{} [3] "2024{-}06{-}01 12:00:00 +1030"}
\NormalTok{x4b }\SpecialCharTok{{-}}\NormalTok{ x4}
\CommentTok{\#\textgreater{} Time differences in hours}
\CommentTok{\#\textgreater{} [1] {-}14.5 {-}14.5 {-}14.5}
\end{Highlighting}
\end{Shaded}
\end{itemize}

\section{å°ç»“}\label{ux5c0fux7ed3-16}

æœ¬ç« ä»‹ç»äº†lubridateæä¾›çš„å·¥å…·ï¼Œè¿™äº›å·¥å…·å¯ä»¥å¸®åŠ©ä½ å¤„ç†æ—¥æœŸ-æ—¶é—´æ•°æ®ã€‚å¤„
ç†æ—¥æœŸå’Œæ—¶é—´å¯èƒ½çœ‹èµ·æ¥æ¯”å¿…éœ€çš„è¦å¤æ‚ï¼Œä½†å¸Œæœ›æœ¬ç« èƒ½å¸®åŠ©ä½ æ˜ç™½åŸå› ------æ—¥æœŸ-æ—¶é—´æ¯”ä¹çœ‹ä¹‹ä¸‹è¦å¤æ‚å¾—å¤šï¼Œå¤„ç†æ¯ä¸€ç§å¯èƒ½çš„æƒ…å†µéƒ½ä¼šå¢åŠ å¤æ‚æ€§ã€‚å³
ä½¿æ‚¨çš„æ•°æ®ä»æœªè·¨è¶Šå¤ä»¤æ—¶è¾¹ç•Œæˆ–æ¶‰åŠé—°å¹´ï¼Œè¿™äº›å‡½æ•°ä¹Ÿéœ€è¦èƒ½å¤Ÿå¤„ç†è¿™äº›æƒ…å†µã€‚

ä¸‹ä¸€ç« å°†æ€»ç»“ç¼ºå¤±å€¼ã€‚æ‚¨
å·²ç»åœ¨å‡ ä¸ªåœ°æ–¹çœ‹åˆ°äº†å®ƒä»¬ï¼Œå¹¶ä¸”åœ¨æ‚¨è‡ªå·±çš„åˆ†æä¸­æ— ç–‘ä¹Ÿé‡åˆ°äº†å®ƒä»¬ï¼Œç°åœ¨æ˜¯æ—¶å€™æä¾›ä¸€ç³»åˆ—æœ‰ç”¨çš„æŠ€æœ¯æ¥å¤„ç†å®ƒä»¬äº†ã€‚

\chapter{ç¼ºå¤±å€¼}\label{sec-missing-values}

\section{å¼•è¨€}\label{ux5f15ux8a00-13}

åœ¨æœ¬ä¹¦çš„æ—©æœŸéƒ¨åˆ†ï¼Œä½ å·²ç»å­¦ä¹ äº†ç¼ºå¤±å€¼çš„åŸºç¡€çŸ¥è¯†ã€‚ä½  é¦–å…ˆåœ¨
ç« èŠ‚~\ref{sec-data-visualization}
é‡åˆ°äº†å®ƒä»¬ï¼Œè¿™äº›ç¼ºå¤±å€¼åœ¨ä½œå›¾æ—¶ä¼šå¯¼è‡´è­¦å‘Šï¼Œä¹Ÿåœ¨ å°èŠ‚~\ref{sec-summarize}
å¹²æ‰°äº†è®¡ç®—æ±‡æ€»ç»Ÿè®¡é‡ã€‚åœ¨ å°èŠ‚~\ref{sec-na-comparison}
ï¼Œä½ äº†è§£äº†å®ƒä»¬çš„``ä¼ æŸ“æ€§''ä»¥åŠå¦‚ä½•æ£€æŸ¥å®ƒä»¬çš„å­˜åœ¨ã€‚ç°
åœ¨æˆ‘ä»¬å°†æ›´æ·±å…¥åœ°è®¨è®ºå®ƒä»¬ï¼Œä»¥ä¾¿ä½ å¯ä»¥äº†è§£æ›´å¤šç»†èŠ‚ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å°†è®¨è®ºä¸€äº›ç”¨äºå¤„ç†è®°å½•ä¸º\texttt{NA}sçš„ç¼ºå¤±å€¼çš„é€šç”¨å·¥å…·ã€‚ç„¶
åï¼Œæ¢è®¨éšå¼ç¼ºå¤±å€¼çš„æ¦‚å¿µï¼Œå³é‚£äº›åœ¨æ•°æ®ä¸­å®Œå…¨ç¼ºå¤±çš„å€¼ï¼Œå¹¶å±•ç¤ºä¸€äº›å¯ä»¥ç”¨æ¥ä½¿å®ƒä»¬å˜æˆæ˜¾å¼çš„å·¥å…·ã€‚æœ€
åï¼Œè®¨è®ºç”±ä¸åœ¨æ•°æ®ä¸­å‡ºç°çš„å› å­æ°´å¹³å¼•èµ·çš„ç©ºç»„çš„ç›¸å…³é—®é¢˜ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-13}

å¤„ç†ç¼ºå¤±æ•°æ®çš„å‡½æ•°ä¸»è¦æ¥è‡ª \texttt{dplyr} å’Œ \texttt{tidyr}ï¼Œè¿™ä¸¤ä¸ªåº“æ˜¯
\texttt{tidyverse} çš„æ ¸å¿ƒæˆå‘˜ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\section{æ˜¾å¼ç¼ºå¤±å€¼}\label{ux663eux5f0fux7f3aux5931ux503c}

é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ¥æ¢ç´¢ä¸€äº›ç”¨äºåˆ›å»ºæˆ–æ¶ˆé™¤æ˜¾å¼ç¼ºå¤±å€¼ï¼ˆå³ä½ çœ‹åˆ° \texttt{NA}
çš„å•å…ƒæ ¼ï¼‰çš„å®ç”¨å·¥å…·ã€‚

\subsection{æœ«æ¬¡è§‚æµ‹å€¼ç»“è½¬ï¼ˆLOCFï¼‰}\label{ux672bux6b21ux89c2ux6d4bux503cux7ed3ux8f6clocf}

ç¼ºå¤±å€¼çš„ä¸€ä¸ªå¸¸è§ç”¨é€”æ˜¯ä½œä¸ºä¸€ç§æ•°æ®è¾“å…¥çš„ä¾¿åˆ©æ–¹å¼ã€‚å½“
æ•°æ®æ˜¯æ‰‹åŠ¨è¾“å…¥æ—¶ï¼Œç¼ºå¤±å€¼æœ‰æ—¶è¡¨ç¤ºå‰ä¸€è¡Œçš„å€¼è¢«é‡å¤ï¼ˆæˆ–ç»“è½¬ï¼‰ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{treatment }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{person,           }\SpecialCharTok{\textasciitilde{}}\NormalTok{treatment, }\SpecialCharTok{\textasciitilde{}}\NormalTok{response,}
  \StringTok{"Derrick Whitmore"}\NormalTok{, }\DecValTok{1}\NormalTok{,         }\DecValTok{7}\NormalTok{,}
  \ConstantTok{NA}\NormalTok{,                 }\DecValTok{2}\NormalTok{,         }\DecValTok{10}\NormalTok{,}
  \ConstantTok{NA}\NormalTok{,                 }\DecValTok{3}\NormalTok{,         }\ConstantTok{NA}\NormalTok{,}
  \StringTok{"Katherine Burke"}\NormalTok{,  }\DecValTok{1}\NormalTok{,         }\DecValTok{4}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥ä½¿ç”¨\texttt{tidyr::fill()}æ¥å¡«å……è¿™äº›ç¼ºå¤±å€¼ã€‚å®ƒ
çš„å·¥ä½œæ–¹å¼ä¸\texttt{select()}ç±»ä¼¼ï¼Œæ¥å—ä¸€ç»„åˆ—ä½œä¸ºå‚æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{treatment }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{fill}\NormalTok{(}\FunctionTok{everything}\NormalTok{())}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 3}
\CommentTok{\#\textgreater{}   person           treatment response}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}                \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 Derrick Whitmore         1        7}
\CommentTok{\#\textgreater{} 2 Derrick Whitmore         2       10}
\CommentTok{\#\textgreater{} 3 Derrick Whitmore         3       10}
\CommentTok{\#\textgreater{} 4 Katherine Burke          1        4}
\end{Highlighting}
\end{Shaded}

è¿™ç§å¤„ç†æ–¹æ³•æœ‰æ—¶è¢«ç§°ä¸º``æœ«æ¬¡è§‚æµ‹å€¼ç»“è½¬ (last observation carried
forward) ''ï¼Œç®€ç§° locfã€‚ä½  å¯ä»¥ä½¿ç”¨ \texttt{.direction}
å‚æ•°æ¥å¡«å……ä»¥æ›´ç‰¹æ®Šæ–¹å¼ç”Ÿæˆçš„ç¼ºå¤±å€¼ã€‚

\subsection{å›ºå®šå€¼}\label{ux56faux5b9aux503c}

æœ‰æ—¶ï¼Œç¼ºå¤±å€¼ä»£è¡¨æŸä¸ªå›ºå®šä¸”å·²çŸ¥çš„å€¼ï¼Œæœ€å¸¸è§çš„æ˜¯0ã€‚ä½ 
å¯ä»¥ä½¿ç”¨\texttt{dplyr::coalesce()}å‡½æ•°æ¥æ›¿æ¢å®ƒä»¬ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{7}\NormalTok{, }\ConstantTok{NA}\NormalTok{)}
\FunctionTok{coalesce}\NormalTok{(x, }\DecValTok{0}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] 1 4 5 7 0}
\end{Highlighting}
\end{Shaded}

æœ‰æ—¶ä½ ä¼šé‡åˆ°ç›¸åçš„é—®é¢˜ï¼Œå³æŸä¸ªå…·ä½“çš„å€¼å®é™…ä¸Šä»£è¡¨äº†ä¸€ä¸ªç¼ºå¤±å€¼ã€‚è¿™
é€šå¸¸å‡ºç°åœ¨ç”±è¾ƒæ—§è½¯ä»¶ç”Ÿæˆçš„æ•°æ®ä¸­ï¼Œè¿™äº›è½¯ä»¶æ²¡æœ‰æ­£ç¡®è¡¨ç¤ºç¼ºå¤±å€¼çš„æ–¹å¼ï¼Œå› æ­¤å®ƒä»¬å¿…é¡»ä½¿ç”¨ä¸€äº›ç‰¹æ®Šçš„å€¼ï¼Œå¦‚99æˆ–-999æ¥ä»£æ›¿ã€‚

å¦‚æœå¯èƒ½çš„è¯ï¼Œåœ¨è¯»å–æ•°æ®æ—¶å¤„ç†è¿™ç§æƒ…å†µï¼Œä¾‹å¦‚ï¼Œä½¿ç”¨\texttt{readr::read\_csv()}å‡½æ•°çš„\texttt{na}å‚æ•°ï¼Œä¾‹å¦‚\texttt{read\_csv(path,\ na\ =\ "99")}ã€‚å¦‚
æœä½ ç¨åæ‰å‘ç°è¿™ä¸ªé—®é¢˜ï¼Œæˆ–è€…ä½ çš„æ•°æ®æºåœ¨è¯»å–æ—¶æ²¡æœ‰æä¾›å¤„ç†å®ƒçš„æ–¹å¼ï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{dplyr::na\_if()}å‡½æ•°æ¥å¤„ç†ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{7}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{99}\NormalTok{)}
\FunctionTok{na\_if}\NormalTok{(x, }\SpecialCharTok{{-}}\DecValTok{99}\NormalTok{)}
\CommentTok{\#\textgreater{} [1]  1  4  5  7 NA}
\end{Highlighting}
\end{Shaded}

\subsection{NaN}\label{nan}

åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œæœ‰ä¸€ç§ç‰¹æ®Šçš„ç¼ºå¤±å€¼ç±»å‹æ˜¯ä½ ä¼šä¸æ—¶é‡åˆ°çš„ï¼š\texttt{NaN}
(è¯»ä½œ``nan''ï¼Œè¡¨ç¤º``\textbf{n}ot \textbf{a} \textbf{n}umber'') ã€‚äº†
è§£å®ƒå¹¶ä¸é‚£ä¹ˆé‡è¦ï¼Œå› ä¸ºå®ƒé€šå¸¸çš„è¡Œä¸ºä¸\texttt{NA}ç›¸åŒï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\ConstantTok{NaN}\NormalTok{)}
\NormalTok{x }\SpecialCharTok{*} \DecValTok{10}
\CommentTok{\#\textgreater{} [1]  NA NaN}
\NormalTok{x }\SpecialCharTok{==} \DecValTok{1}
\CommentTok{\#\textgreater{} [1] NA NA}
\FunctionTok{is.na}\NormalTok{(x)}
\CommentTok{\#\textgreater{} [1] TRUE TRUE}
\end{Highlighting}
\end{Shaded}

åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œå¦‚æœä½ éœ€è¦åŒºåˆ†\texttt{NA}å’Œ\texttt{NaN}ï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{is.nan(x)}å‡½æ•°ã€‚

å½“ä½ æ‰§è¡Œå…·æœ‰ä¸ç¡®å®šç»“æœçš„æ•°å­¦è¿ç®—æ—¶ï¼Œé€šå¸¸ä¼šé‡åˆ°\texttt{NaN}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\DecValTok{0} \SpecialCharTok{/} \DecValTok{0} 
\CommentTok{\#\textgreater{} [1] NaN}
\DecValTok{0} \SpecialCharTok{*} \ConstantTok{Inf}
\CommentTok{\#\textgreater{} [1] NaN}
\ConstantTok{Inf} \SpecialCharTok{{-}} \ConstantTok{Inf}
\CommentTok{\#\textgreater{} [1] NaN}
\FunctionTok{sqrt}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} Warning in sqrt({-}1): NaNs produced}
\CommentTok{\#\textgreater{} [1] NaN}
\end{Highlighting}
\end{Shaded}

\section{éšå¼ç¼ºå¤±å€¼}\label{sec-missing-implicit}

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è°ˆè®ºçš„ç¼ºå¤±å€¼éƒ½æ˜¯æ˜¾å¼ç¼ºå¤±çš„ï¼Œå³ä½ å¯ä»¥åœ¨æ•°æ®ä¸­çœ‹åˆ°\texttt{NA}ã€‚ä½†
æ˜¯ï¼Œå¦‚æœæ•´è¡Œæ•°æ®å®Œå…¨ç¼ºå¤±ï¼Œé‚£ä¹ˆç¼ºå¤±å€¼ä¹Ÿå¯ä»¥æ˜¯éšå¼çš„ã€‚è®©
æˆ‘ä»¬ç”¨ä¸€ä¸ªç®€å•çš„æ•°æ®é›†æ¥è¯´æ˜è¿™ç§åŒºåˆ«ï¼Œè¯¥æ•°æ®é›†è®°å½•äº†æŸäº›è‚¡ç¥¨æ¯ä¸ªå­£åº¦çš„ä»·æ ¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stocks }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{year  =} \FunctionTok{c}\NormalTok{(}\DecValTok{2020}\NormalTok{, }\DecValTok{2020}\NormalTok{, }\DecValTok{2020}\NormalTok{, }\DecValTok{2020}\NormalTok{, }\DecValTok{2021}\NormalTok{, }\DecValTok{2021}\NormalTok{, }\DecValTok{2021}\NormalTok{),}
  \AttributeTok{qtr   =} \FunctionTok{c}\NormalTok{(   }\DecValTok{1}\NormalTok{,    }\DecValTok{2}\NormalTok{,    }\DecValTok{3}\NormalTok{,    }\DecValTok{4}\NormalTok{,    }\DecValTok{2}\NormalTok{,    }\DecValTok{3}\NormalTok{,    }\DecValTok{4}\NormalTok{),}
  \AttributeTok{price =} \FunctionTok{c}\NormalTok{(}\FloatTok{1.88}\NormalTok{, }\FloatTok{0.59}\NormalTok{, }\FloatTok{0.35}\NormalTok{,   }\ConstantTok{NA}\NormalTok{, }\FloatTok{0.92}\NormalTok{, }\FloatTok{0.17}\NormalTok{, }\FloatTok{2.66}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

è¿™ä¸ªæ•°æ®é›†æœ‰ä¸¤ä¸ªç¼ºå¤±çš„è§‚æµ‹å€¼ï¼š

\begin{itemize}
\item
  2020å¹´ç¬¬å››å­£åº¦çš„\texttt{price}æ˜¯æ˜¾å¼ç¼ºå¤±çš„ï¼Œå› ä¸ºå®ƒçš„å€¼æ˜¯\texttt{NA}ï¼›
\item
  2021å¹´ç¬¬ä¸€å­£åº¦çš„\texttt{price}æ˜¯éšå¼ç¼ºå¤±çš„ï¼Œå› ä¸ºå®ƒåœ¨æ•°æ®é›†ä¸­æ ¹æœ¬æ²¡æœ‰å‡ºç°ã€‚
\end{itemize}

ç†è§£è¿™ç§åŒºåˆ«çš„ä¸€ç§æ–¹å¼æ˜¯å€ŸåŠ©è¿™ä¸ªç±»ä¼¼ç¦…å®—çš„å…¬æ¡ˆï¼š

\begin{quote}
æ˜¾å¼çš„ç¼ºå¤±å€¼æ˜¯ç¼ºå¤±çš„å­˜åœ¨ã€‚

éšå¼çš„ç¼ºå¤±å€¼æ˜¯å­˜åœ¨çš„ç¼ºå¤±ã€‚
\end{quote}

æœ‰æ—¶ä½ æƒ³å°†éšå¼ç¼ºå¤±å˜ä¸ºæ˜¾å¼ç¼ºå¤±ï¼Œä»¥ä¾¿æœ‰å…·ä½“çš„ä¸œè¥¿å¯ä»¥å¤„ç†ã€‚åœ¨
å…¶ä»–æƒ…å†µä¸‹ï¼Œç”±äºæ•°æ®çš„ç»“æ„ï¼Œæ˜¾å¼ç¼ºå¤±æ˜¯å¼ºåŠ äºä½ çš„ï¼Œä½ å¸Œæœ›æ¶ˆé™¤å®ƒä»¬ã€‚ä»¥
ä¸‹éƒ¨åˆ†å°†è®¨è®ºä¸€äº›åœ¨éšå¼å’Œæ˜¾å¼ç¼ºå¤±ä¹‹é—´è½¬æ¢çš„å·¥å…·ã€‚

\subsection{é‡å¡‘ (Pivoting)}\label{ux91cdux5851-pivoting}

ä½ å·²ç»è§è¿‡ä¸€ä¸ªå·¥å…·å¯ä»¥å°†éšå¼ç¼ºå¤±å˜ä¸ºæ˜¾å¼ç¼ºå¤±ï¼Œåä¹‹äº¦ç„¶ï¼šå³é‡å¡‘ã€‚å°†
æ•°æ®å˜å®½å¯ä»¥ä½¿éšå¼ç¼ºå¤±å€¼å˜ä¸ºæ˜¾å¼ç¼ºå¤±å€¼ï¼Œå› ä¸ºè¡Œå’Œæ–°åˆ—çš„æ¯ä¸ªç»„åˆéƒ½å¿…é¡»å…·æœ‰æŸä¸ªå€¼ã€‚ä¾‹
å¦‚ï¼Œå¦‚æœæˆ‘ä»¬é€è§†\texttt{stocks}æ•°æ®ï¼Œå°†\texttt{quarter}æ”¾å…¥åˆ—ä¸­ï¼Œé‚£ä¹ˆä¸¤ä¸ªç¼ºå¤±å€¼éƒ½ä¼šå˜ä¸ºæ˜¾å¼ç¼ºå¤±å€¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stocks }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{pivot\_wider}\NormalTok{(}
    \AttributeTok{names\_from =}\NormalTok{ qtr, }
    \AttributeTok{values\_from =}\NormalTok{ price}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 5}
\CommentTok{\#\textgreater{}    year   \textasciigrave{}1\textasciigrave{}   \textasciigrave{}2\textasciigrave{}   \textasciigrave{}3\textasciigrave{}   \textasciigrave{}4\textasciigrave{}}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1  2020  1.88  0.59  0.35 NA   }
\CommentTok{\#\textgreater{} 2  2021 NA     0.92  0.17  2.66}
\end{Highlighting}
\end{Shaded}

é»˜è®¤æƒ…å†µä¸‹ï¼Œå°†æ•°æ®å˜é•¿ä¼šä¿ç•™æ˜¾å¼ç¼ºå¤±å€¼ï¼Œä½†æ˜¯å¦‚æœå®ƒä»¬æ˜¯ç”±äºæ•°æ®ä¸æ•´é½è€Œå­˜åœ¨çš„ç»“æ„æ€§ç¼ºå¤±å€¼ï¼Œä½ å¯ä»¥é€šè¿‡è®¾ç½®\texttt{values\_drop\_na\ =\ TRUE}æ¥åˆ é™¤å®ƒä»¬ï¼ˆä½¿å®ƒä»¬å˜ä¸ºéšå¼ï¼‰ã€‚æ›´
å¤šç»†èŠ‚è¯·å‚è§ å°èŠ‚~\ref{sec-tidy-data} ä¸­çš„ç¤ºä¾‹ã€‚

\subsection{å®Œæ•´(Complete)}\label{ux5b8cux6574complete}

\texttt{tidyr::complete()}å…è®¸ä½ é€šè¿‡æä¾›ä¸€ç»„å˜é‡æ¥ç”Ÿæˆæ˜¾å¼ç¼ºå¤±å€¼ï¼Œè¿™äº›å˜é‡å®šä¹‰äº†åº”è¯¥å­˜åœ¨çš„è¡Œçš„ç»„åˆã€‚ä¾‹
å¦‚ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨\texttt{stocks}æ•°æ®ä¸­åº”è¯¥å­˜åœ¨\texttt{year}å’Œ\texttt{qtr}çš„æ‰€æœ‰ç»„åˆï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stocks }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{complete}\NormalTok{(year, qtr)}
\CommentTok{\#\textgreater{} \# A tibble: 8 x 3}
\CommentTok{\#\textgreater{}    year   qtr price}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1  2020     1  1.88}
\CommentTok{\#\textgreater{} 2  2020     2  0.59}
\CommentTok{\#\textgreater{} 3  2020     3  0.35}
\CommentTok{\#\textgreater{} 4  2020     4 NA   }
\CommentTok{\#\textgreater{} 5  2021     1 NA   }
\CommentTok{\#\textgreater{} 6  2021     2  0.92}
\CommentTok{\#\textgreater{} \# i 2 more rows}
\end{Highlighting}
\end{Shaded}

é€šå¸¸ï¼Œä½ ä¼šä½¿ç”¨ç°æœ‰å˜é‡çš„åç§°æ¥è°ƒç”¨\texttt{complete()}å‡½æ•°ï¼Œä»¥å¡«å……ç¼ºå¤±çš„ç»„åˆã€‚ç„¶
è€Œï¼Œæœ‰æ—¶å•ä¸ªå˜é‡æœ¬èº«ä¹Ÿæ˜¯ä¸å®Œæ•´çš„ï¼Œå› æ­¤ä½ å¯ä»¥æä¾›è‡ªå·±çš„æ•°æ®ã€‚ä¾‹
å¦‚ï¼Œä½ å¯èƒ½çŸ¥é“\texttt{stocks}
æ•°æ®é›†åº”è¯¥ä»2019å¹´åˆ°2021å¹´ï¼Œæ‰€ä»¥ä½ å¯ä»¥ä¸º\texttt{year}æ˜ç¡®æä¾›è¿™äº›å€¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{stocks }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{complete}\NormalTok{(}\AttributeTok{year =} \DecValTok{2019}\SpecialCharTok{:}\DecValTok{2021}\NormalTok{, qtr)}
\CommentTok{\#\textgreater{} \# A tibble: 12 x 3}
\CommentTok{\#\textgreater{}    year   qtr price}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1  2019     1 NA   }
\CommentTok{\#\textgreater{} 2  2019     2 NA   }
\CommentTok{\#\textgreater{} 3  2019     3 NA   }
\CommentTok{\#\textgreater{} 4  2019     4 NA   }
\CommentTok{\#\textgreater{} 5  2020     1  1.88}
\CommentTok{\#\textgreater{} 6  2020     2  0.59}
\CommentTok{\#\textgreater{} \# i 6 more rows}
\end{Highlighting}
\end{Shaded}

å¦‚æœå˜é‡çš„èŒƒå›´æ˜¯æ­£ç¡®çš„ï¼Œä½†ä¸æ˜¯æ‰€æœ‰å€¼éƒ½å­˜åœ¨ï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{full\_seq(x,\ 1)}æ¥ç”Ÿæˆä»\texttt{min(x)}åˆ°\texttt{max(x)}ä¹‹é—´é—´éš”ä¸º1çš„æ‰€æœ‰å€¼ã€‚

åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®Œæ•´çš„è§‚æµ‹é›†ä¸èƒ½ä»…é€šè¿‡å˜é‡çš„ç®€å•ç»„åˆæ¥ç”Ÿæˆã€‚åœ¨
è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥æ‰‹åŠ¨æ‰§è¡Œ\texttt{complete()}ä¸ºä½ æ‰€åšçš„æ“ä½œï¼šåˆ›å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰åº”è¯¥å­˜åœ¨çš„è¡Œçš„æ•°æ®æ¡†ï¼ˆä½¿ç”¨ä½ éœ€è¦çš„ä»»ä½•æ–¹æ³•ç»„åˆï¼‰ï¼Œç„¶åä½¿ç”¨\texttt{dplyr::full\_join()}å°†å…¶ä¸ä½ çš„åŸå§‹æ•°æ®é›†ç»“åˆèµ·æ¥ã€‚

\subsection{è¿æ¥ (Joins)}\label{ux8fdeux63a5-joins}

è¿™è®©æˆ‘ä»¬å¼•å‡ºäº†å¦ä¸€ç§æ­ç¤ºéšå¼ç¼ºå¤±è§‚æµ‹å€¼çš„é‡è¦æ–¹æ³•ï¼šè¿æ¥ã€‚ä½  å°†åœ¨
ç« èŠ‚~\ref{sec-joins}
å­¦ä¹ æ›´å¤šå…³äºè¿æ¥çš„å†…å®¹ï¼Œä½†æˆ‘ä»¬æƒ³åœ¨è¿™é‡Œå¿«é€Ÿå‘ä½ æåŠå®ƒä»¬ï¼Œå› ä¸ºé€šå¸¸åªæœ‰å½“ä½ å°†ä¸€ä¸ªæ•°æ®é›†ä¸å¦ä¸€ä¸ªæ•°æ®é›†è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œä½ æ‰èƒ½çŸ¥é“æŸä¸ªæ•°æ®é›†ä¸­ç¼ºå¤±äº†å“ªäº›å€¼ã€‚

\texttt{dplyr::anti\_join(x,\ y)}åœ¨è¿™é‡Œæ˜¯ä¸€ä¸ªç‰¹åˆ«æœ‰ç”¨çš„å·¥å…·ï¼Œå› ä¸ºå®ƒåªé€‰æ‹©é‚£äº›åœ¨\texttt{x}ä¸­ä½†åœ¨\texttt{y}ä¸­æ²¡æœ‰åŒ¹é…çš„è¡Œã€‚ä¾‹
å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸¤æ¬¡\texttt{anti\_join()}æ¥æ­ç¤º\texttt{flights}ä¸­æåˆ°çš„å››ä¸ªæœºåœºå’Œ722æ¶é£æœºçš„ä¿¡æ¯ç¼ºå¤±äº†ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(nycflights13)}

\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{distinct}\NormalTok{(}\AttributeTok{faa =}\NormalTok{ dest) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{anti\_join}\NormalTok{(airports)}
\CommentTok{\#\textgreater{} Joining with \textasciigrave{}by = join\_by(faa)\textasciigrave{}}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 1}
\CommentTok{\#\textgreater{}   faa  }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 BQN  }
\CommentTok{\#\textgreater{} 2 SJU  }
\CommentTok{\#\textgreater{} 3 STT  }
\CommentTok{\#\textgreater{} 4 PSE}

\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{distinct}\NormalTok{(tailnum) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{anti\_join}\NormalTok{(planes)}
\CommentTok{\#\textgreater{} Joining with \textasciigrave{}by = join\_by(tailnum)\textasciigrave{}}
\CommentTok{\#\textgreater{} \# A tibble: 722 x 1}
\CommentTok{\#\textgreater{}   tailnum}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}  }
\CommentTok{\#\textgreater{} 1 N3ALAA }
\CommentTok{\#\textgreater{} 2 N3DUAA }
\CommentTok{\#\textgreater{} 3 N542MQ }
\CommentTok{\#\textgreater{} 4 N730MQ }
\CommentTok{\#\textgreater{} 5 N9EAMQ }
\CommentTok{\#\textgreater{} 6 N532UA }
\CommentTok{\#\textgreater{} \# i 716 more rows}
\end{Highlighting}
\end{Shaded}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-48}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  ä½ èƒ½æ‰¾åˆ°æ‰¿è¿äººå’Œ\texttt{planes}ä¸Šç¼ºå¤±çš„è¡Œä¹‹é—´çš„å…³ç³»å—ï¼Ÿ
\end{enumerate}

\section{å› å­å’Œç©ºç»„}\label{ux56e0ux5b50ux548cux7a7aux7ec4}

ç¼ºå¤±æ•°æ®çš„æœ€åä¸€ç§ç±»å‹æ˜¯ç©ºç»„ (empty
group)ï¼Œå³ä¸åŒ…å«ä»»ä½•è§‚æµ‹å€¼çš„ç»„ï¼Œè¿™åœ¨å¤„ç†å› å­æ—¶å¯èƒ½ä¼šå‡ºç°ã€‚ä¾‹
å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ•°æ®é›†ï¼Œå…¶ä¸­åŒ…å«äº†ä¸€äº›å…³äºäººçš„å¥åº·ä¿¡æ¯ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{health }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{name   =} \FunctionTok{c}\NormalTok{(}\StringTok{"Ikaia"}\NormalTok{, }\StringTok{"Oletta"}\NormalTok{, }\StringTok{"Leriah"}\NormalTok{, }\StringTok{"Dashay"}\NormalTok{, }\StringTok{"Tresaun"}\NormalTok{),}
  \AttributeTok{smoker =} \FunctionTok{factor}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"no"}\NormalTok{, }\StringTok{"no"}\NormalTok{, }\StringTok{"no"}\NormalTok{, }\StringTok{"no"}\NormalTok{, }\StringTok{"no"}\NormalTok{), }\AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\StringTok{"yes"}\NormalTok{, }\StringTok{"no"}\NormalTok{)),}
  \AttributeTok{age    =} \FunctionTok{c}\NormalTok{(}\DecValTok{34}\NormalTok{, }\DecValTok{88}\NormalTok{, }\DecValTok{75}\NormalTok{, }\DecValTok{47}\NormalTok{, }\DecValTok{56}\NormalTok{),}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬æƒ³ä½¿ç”¨\texttt{dplyr::count()}æ¥è®¡ç®—å¸çƒŸè€…çš„æ•°é‡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{health }\SpecialCharTok{|\textgreater{}} \FunctionTok{count}\NormalTok{(smoker)}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 2}
\CommentTok{\#\textgreater{}   smoker     n}
\CommentTok{\#\textgreater{}   \textless{}fct\textgreater{}  \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 no         5}
\end{Highlighting}
\end{Shaded}

è¿™ä¸ªæ•°æ®é›†åªåŒ…å«äº†éå¸çƒŸè€…ï¼Œä½†æˆ‘ä»¬çŸ¥é“å¸çƒŸè€…æ˜¯å­˜åœ¨çš„ï¼Œå¸çƒŸè€…è¿™ä¸€ç»„æ˜¯ç©ºçš„ã€‚æˆ‘
ä»¬å¯ä»¥é€šè¿‡è®¾ç½®\texttt{.drop\ =\ FALSE}æ¥è¯·æ±‚\texttt{count()}ä¿ç•™æ‰€æœ‰ç»„ï¼Œå³ä½¿è¿™äº›ç»„åœ¨æ•°æ®ä¸­ä¸å­˜åœ¨ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{health }\SpecialCharTok{|\textgreater{}} \FunctionTok{count}\NormalTok{(smoker, }\AttributeTok{.drop =} \ConstantTok{FALSE}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 2}
\CommentTok{\#\textgreater{}   smoker     n}
\CommentTok{\#\textgreater{}   \textless{}fct\textgreater{}  \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 yes        0}
\CommentTok{\#\textgreater{} 2 no         5}
\end{Highlighting}
\end{Shaded}

åŒæ ·çš„åŸç†ä¹Ÿé€‚ç”¨äº\texttt{ggplot2}çš„ç¦»æ•£è½´ï¼Œå®ƒä»¬ä¹Ÿä¼šä¸¢å¼ƒæ²¡æœ‰ä»»ä½•å€¼çš„æ°´å¹³ã€‚ä½ 
å¯ä»¥é€šè¿‡å°†\texttt{drop\ =\ FALSE}å‚æ•°ä¼ é€’ç»™é€‚å½“çš„ç¦»æ•£è½´æ¥å¼ºåˆ¶å®ƒä»¬æ˜¾ç¤ºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(health, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ smoker)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{()}

\FunctionTok{ggplot}\NormalTok{(health, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ smoker)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_discrete}\NormalTok{(}\AttributeTok{drop =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{missing-values_files/figure-pdf/unnamed-chunk-17-1.pdf}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=9.375in,height=\textheight]{missing-values_files/figure-pdf/unnamed-chunk-17-2.pdf}\end{minipage}%

\end{figure}%

åŒæ ·çš„é—®é¢˜ä¹Ÿä¼šåœ¨ä½¿ç”¨\texttt{dplyr::group\_by()}æ—¶ç»å¸¸å‡ºç°ã€‚åŒ
æ ·åœ°ï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{.drop\ =\ FALSE}æ¥ä¿ç•™æ‰€æœ‰çš„å› å­æ°´å¹³ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{health }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(smoker, }\AttributeTok{.drop =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{mean\_age =} \FunctionTok{mean}\NormalTok{(age),}
    \AttributeTok{min\_age =} \FunctionTok{min}\NormalTok{(age),}
    \AttributeTok{max\_age =} \FunctionTok{max}\NormalTok{(age),}
    \AttributeTok{sd\_age =} \FunctionTok{sd}\NormalTok{(age)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 6}
\CommentTok{\#\textgreater{}   smoker     n mean\_age min\_age max\_age sd\_age}
\CommentTok{\#\textgreater{}   \textless{}fct\textgreater{}  \textless{}int\textgreater{}    \textless{}dbl\textgreater{}   \textless{}dbl\textgreater{}   \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 yes        0      NaN     Inf    {-}Inf   NA  }
\CommentTok{\#\textgreater{} 2 no         5       60      34      88   21.6}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬åœ¨è¿™é‡Œå¾—åˆ°äº†ä¸€äº›æœ‰è¶£çš„ç»“æœï¼Œå› ä¸ºå½“å¯¹ç©ºç»„è¿›è¡Œæ±‡æ€»æ—¶ï¼Œæ±‡æ€»å‡½æ•°ä¼šåº”ç”¨äºé•¿åº¦ä¸º0çš„å‘é‡ã€‚è¿™
é‡Œæœ‰ä¸€ä¸ªé‡è¦çš„åŒºåˆ«ï¼Œå³é•¿åº¦ä¸º0çš„ç©ºå‘é‡å’Œæ¯ä¸ªé•¿åº¦ä¸º1çš„ç¼ºå¤±å€¼ã€‚

We get some interesting results here because when summarizing an empty
group, the summary functions are applied to zero-length vectors. There's
an important distinction between empty vectors, which have length 0, and
missing values, each of which has length 1.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# A vector containing two missing values}
\NormalTok{x1 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\ConstantTok{NA}\NormalTok{)}
\FunctionTok{length}\NormalTok{(x1)}
\CommentTok{\#\textgreater{} [1] 2}

\CommentTok{\# A vector containing nothing}
\NormalTok{x2 }\OtherTok{\textless{}{-}} \FunctionTok{numeric}\NormalTok{()}
\FunctionTok{length}\NormalTok{(x2)}
\CommentTok{\#\textgreater{} [1] 0}
\end{Highlighting}
\end{Shaded}

æ‰€æœ‰çš„æ±‡æ€»å‡½æ•°éƒ½å¯ä»¥å¤„ç†é•¿åº¦ä¸º0çš„å‘é‡ï¼Œä½†å®ƒä»¬å¯èƒ½ä¼šè¿”å›ä¸€äº›ä¹çœ‹ä¹‹ä¸‹ä»¤äººæƒŠè®¶çš„ç»“æœã€‚åœ¨
è¿™é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°\texttt{mean(age)}è¿”å›äº†\texttt{NaN}ï¼Œå› ä¸º\texttt{mean(age)\ =\ sum(age)/length(age)}ï¼Œåœ¨è¿™é‡Œå°±å˜æˆäº†\texttt{0/0}ã€‚\texttt{m}
\texttt{ax()}å’Œ\texttt{min()}å¯¹äºç©ºå‘é‡è¿”å›-Infå’ŒInfï¼Œæ‰€ä»¥å¦‚æœä½ å°†è¿™äº›ç»“æœä¸éç©ºçš„æ–°æ•°æ®å‘é‡ç»“åˆå¹¶é‡æ–°è®¡ç®—ï¼Œä½ ä¼šå¾—åˆ°æ–°æ•°æ®çš„æœ€å°å€¼æˆ–æœ€å¤§å€¼ã€‚

æœ‰æ—¶ï¼Œä¸€ä¸ªæ›´ç®€å•çš„æ–¹æ³•æ˜¯å…ˆè¿›è¡Œæ±‡æ€»ï¼Œç„¶åä½¿ç”¨\texttt{complete()}å°†éšå¼ç¼ºå¤±æ˜¾å¼åŒ–ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{health }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(smoker) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{mean\_age =} \FunctionTok{mean}\NormalTok{(age),}
    \AttributeTok{min\_age =} \FunctionTok{min}\NormalTok{(age),}
    \AttributeTok{max\_age =} \FunctionTok{max}\NormalTok{(age),}
    \AttributeTok{sd\_age =} \FunctionTok{sd}\NormalTok{(age)}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{complete}\NormalTok{(smoker)}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 6}
\CommentTok{\#\textgreater{}   smoker     n mean\_age min\_age max\_age sd\_age}
\CommentTok{\#\textgreater{}   \textless{}fct\textgreater{}  \textless{}int\textgreater{}    \textless{}dbl\textgreater{}   \textless{}dbl\textgreater{}   \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 yes       NA       NA      NA      NA   NA  }
\CommentTok{\#\textgreater{} 2 no         5       60      34      88   21.6}
\end{Highlighting}
\end{Shaded}

è¿™ç§æ–¹æ³•çš„ä¸»è¦ç¼ºç‚¹æ˜¯ï¼Œå³ä½¿ä½ çŸ¥é“è®¡æ•°åº”è¯¥æ˜¯é›¶ï¼Œä½ ä¹Ÿä¼šå¾—åˆ°ä¸€ä¸ª\texttt{NA}ä½œä¸ºè®¡æ•°ç»“æœã€‚

\section{å°ç»“}\label{ux5c0fux7ed3-17}

ç¼ºå¤±å€¼å¾ˆå¥‡æ€ªï¼æœ‰
æ—¶å®ƒä»¬è¢«è®°å½•ä¸ºæ˜ç¡®çš„\texttt{NA}ï¼Œä½†å…¶ä»–æ—¶å€™ä½ åªèƒ½é€šè¿‡å®ƒä»¬çš„ç¼ºå¤±æ¥æ³¨æ„åˆ°å®ƒä»¬ã€‚æœ¬
ç« ä¸ºä½ æä¾›äº†ä¸€äº›å¤„ç†æ˜¾å¼ç¼ºå¤±å€¼çš„å·¥å…·ï¼Œä»¥åŠå‘ç°éšå¼ç¼ºå¤±å€¼çš„å·¥å…·ï¼Œå¹¶è®¨è®ºäº†éšå¼ç¼ºå¤±å€¼å¦‚ä½•å˜ä¸ºæ˜¾å¼ç¼ºå¤±å€¼çš„ä¸€äº›æ–¹æ³•ï¼Œåä¹‹äº¦ç„¶ã€‚

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†å¤„ç†æœ¬ä¹¦è¿™éƒ¨åˆ†çš„æœ€åä¸€ç« ï¼šè¿æ¥ã€‚è¿™
ä¸ä¹‹å‰çš„ç« èŠ‚æœ‰æ‰€ä¸åŒï¼Œå› ä¸ºæˆ‘ä»¬å°†è®¨è®ºä¸€äº›å¯¹æ•´ä¸ªæ•°æ®æ¡†è¿›è¡Œæ“ä½œçš„å·¥å…·ï¼Œè€Œä¸æ˜¯æ•°æ®æ¡†å†…éƒ¨çš„å†…å®¹ã€‚

\chapter{è¿æ¥}\label{sec-joins}

\section{å¼•è¨€}\label{ux5f15ux8a00-14}

åœ¨æ•°æ®åˆ†æä¸­ï¼Œå¾ˆå°‘åªæ¶‰åŠå•ä¸ªæ•°æ®æ¡†ã€‚é€š
å¸¸ä½ ä¼šæœ‰å¤šä¸ªæ•°æ®æ¡†ï¼Œå¹¶ä¸”éœ€è¦å°†å®ƒä»¬\textbf{è¿æ¥}åœ¨ä¸€èµ·æ¥å›ç­”ä½ æ„Ÿå…´è¶£çš„é—®é¢˜ã€‚æœ¬
ç« å°†å‘ä½ ä»‹ç»ä¸¤ç§é‡è¦çš„è¿æ¥ç±»å‹ï¼š

\begin{itemize}
\tightlist
\item
  å˜å¼‚è¿æ¥ï¼ˆMutating
  joinsï¼‰ï¼Œé€šè¿‡åŒ¹é…å¦ä¸€ä¸ªæ•°æ®æ¡†ä¸­çš„è§‚æµ‹å€¼å‘ä¸€ä¸ªæ•°æ®æ¡†æ·»åŠ æ–°å˜é‡ï¼›
\item
  ç­›é€‰è¿æ¥ï¼ˆFiltering
  joinsï¼‰ï¼Œæ ¹æ®ä¸€ä¸ªæ•°æ®æ¡†ä¸­çš„è§‚æµ‹å€¼æ˜¯å¦ä¸å¦ä¸€ä¸ªæ•°æ®æ¡†ä¸­çš„è§‚æµ‹å€¼åŒ¹é…æ¥ç­›é€‰è§‚æµ‹å€¼ã€‚
\end{itemize}

æˆ‘ä»¬å°†é¦–å…ˆè®¨è®ºé”® (keys)ï¼Œå³ç”¨äºåœ¨è¿æ¥ä¸­è¿æ¥ä¸€å¯¹æ•°æ®æ¡†çš„å˜é‡ã€‚æˆ‘
ä»¬å°†é€šè¿‡æ£€æŸ¥\texttt{nycflights13}åŒ…ä¸­æ•°æ®é›†çš„é”®æ¥å·©å›ºè¿™ä¸€ç†è®ºï¼Œç„¶ååˆ©ç”¨è¿™äº›çŸ¥è¯†å¼€å§‹è¿æ¥æ•°æ®æ¡†ã€‚æ¥
ä¸‹æ¥æˆ‘ä»¬å°†è®¨è®ºè¿æ¥çš„å·¥ä½œåŸç†ï¼Œé‡ç‚¹å…³æ³¨å®ƒä»¬å¯¹è¡Œçš„æ“ä½œã€‚æœ€
åï¼Œæˆ‘ä»¬å°†è®¨è®ºéç­‰å€¼è¿æ¥ï¼ˆnon-equi
joinsï¼‰ï¼Œè¿™æ˜¯ä¸€ç§æ¯”é»˜è®¤çš„ç­‰å€¼å…³ç³»æ›´çµæ´»çš„é”®åŒ¹é…æ–¹å¼è¿æ¥å®¶æ—ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-14}

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ªdplyrçš„joinå‡½æ•°æ¥æ¢ç´¢æ¥è‡ª\texttt{nycflights13}çš„äº”ä¸ªç›¸å…³æ•°æ®é›†ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(nycflights13)}
\end{Highlighting}
\end{Shaded}

\section{é”®ï¼ˆKeysï¼‰}\label{ux952ekeys}

è¦ç†è§£è¿æ¥ï¼ˆjoinï¼‰æ“ä½œï¼Œé¦–å…ˆéœ€è¦ç†è§£å¦‚ä½•é€šè¿‡æ¯ä¸ªè¡¨ä¸­çš„ä¸€å¯¹é”®æ¥è¿æ¥ä¸¤ä¸ªè¡¨ã€‚åœ¨
æœ¬èŠ‚ä¸­ï¼Œä½ å°†å­¦ä¹ ä¸¤ç§ç±»å‹çš„é”®ï¼Œå¹¶åœ¨nycflights13åŒ…çš„æ•°æ®é›†ä¸­çœ‹åˆ°è¿™ä¸¤ç§é”®çš„ç¤ºä¾‹ã€‚ä½ 
è¿˜å°†å­¦ä¹ å¦‚ä½•æ£€æŸ¥ä½ çš„é”®æ˜¯å¦æœ‰æ•ˆï¼Œä»¥åŠå¦‚æœè¡¨ä¸­ç¼ºå°‘é”®è¯¥å¦‚ä½•å¤„ç†ã€‚

\subsection{ä¸»é”®å’Œå¤–é”®}\label{ux4e3bux952eux548cux5916ux952e}

æ¯æ¬¡è¿æ¥æ“ä½œéƒ½æ¶‰åŠä¸€å¯¹é”®ï¼šä¸»é”® (primary key) å’Œå¤–é”® (foreign key)
ã€‚\textbf{ä¸»} \textbf{é”®}æ˜¯ä¸€ä¸ªå˜é‡æˆ–ä¸€ç»„å˜é‡ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†æ¯ä¸ªè§‚æµ‹ã€‚å½“
éœ€è¦å¤šä¸ªå˜é‡æ—¶ï¼Œè¿™ä¸ªé”®è¢«ç§°ä¸ºå¤åˆé”®ã€‚ä¾‹ å¦‚ï¼Œåœ¨nycflights13åŒ…ä¸­ï¼š

\begin{itemize}
\item
  \texttt{airlines} è®°å½•å…³äºæ¯å®¶èˆªç©ºå…¬å¸çš„ä¸¤é¡¹æ•°æ®ï¼šæ‰¿è¿äººä»£ç å’Œå…¨åã€‚ä½ 
  å¯ä»¥ä½¿ç”¨å…¶ä¸¤ä¸ªå­—æ¯çš„æ‰¿è¿äººä»£ç æ¥è¯†åˆ«èˆªç©ºå…¬å¸ï¼Œä½¿\texttt{carrier}
  (æ‰¿è¿äºº) æˆä¸ºä¸»é”®ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{airlines}
\CommentTok{\#\textgreater{} \# A tibble: 16 x 2}
\CommentTok{\#\textgreater{}   carrier name                    }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}   \textless{}chr\textgreater{}                   }
\CommentTok{\#\textgreater{} 1 9E      Endeavor Air Inc.       }
\CommentTok{\#\textgreater{} 2 AA      American Airlines Inc.  }
\CommentTok{\#\textgreater{} 3 AS      Alaska Airlines Inc.    }
\CommentTok{\#\textgreater{} 4 B6      JetBlue Airways         }
\CommentTok{\#\textgreater{} 5 DL      Delta Air Lines Inc.    }
\CommentTok{\#\textgreater{} 6 EV      ExpressJet Airlines Inc.}
\CommentTok{\#\textgreater{} \# i 10 more rows}
\end{Highlighting}
\end{Shaded}
\item
  \texttt{airports} è®°å½•äº†å…³äºæ¯ä¸ªæœºåœºçš„æ•°æ®ã€‚ä½ 
  å¯ä»¥é€šè¿‡å…¶ä¸‰ä¸ªå­—æ¯çš„æœºåœºä»£ç æ¥è¯†åˆ«æ¯ä¸ªæœºåœºï¼Œä½¿\texttt{faa}æˆä¸ºä¸»é”®ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{airports}
\CommentTok{\#\textgreater{} \# A tibble: 1,458 x 8}
\CommentTok{\#\textgreater{}   faa   name                            lat   lon   alt    tz dst  }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}chr\textgreater{}                         \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 04G   Lansdowne Airport              41.1 {-}80.6  1044    {-}5 A    }
\CommentTok{\#\textgreater{} 2 06A   Moton Field Municipal Airport  32.5 {-}85.7   264    {-}6 A    }
\CommentTok{\#\textgreater{} 3 06C   Schaumburg Regional            42.0 {-}88.1   801    {-}6 A    }
\CommentTok{\#\textgreater{} 4 06N   Randall Airport                41.4 {-}74.4   523    {-}5 A    }
\CommentTok{\#\textgreater{} 5 09J   Jekyll Island Airport          31.1 {-}81.4    11    {-}5 A    }
\CommentTok{\#\textgreater{} 6 0A9   Elizabethton Municipal Airpo\textasciitilde{}  36.4 {-}82.2  1593    {-}5 A    }
\CommentTok{\#\textgreater{} \# i 1,452 more rows}
\CommentTok{\#\textgreater{} \# i 1 more variable: tzone \textless{}chr\textgreater{}}
\end{Highlighting}
\end{Shaded}
\item
  \texttt{planes} è®°å½•å…³äºæ¯æ¶é£æœºçš„æ•°æ®ã€‚ä½ 
  å¯ä»¥é€šè¿‡å…¶å°¾å·æ¥è¯†åˆ«ä¸€æ¶é£æœºï¼Œä½¿\texttt{tailnum}æˆä¸ºä¸»é”®ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{planes}
\CommentTok{\#\textgreater{} \# A tibble: 3,322 x 9}
\CommentTok{\#\textgreater{}   tailnum  year type              manufacturer    model     engines}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}   \textless{}int\textgreater{} \textless{}chr\textgreater{}             \textless{}chr\textgreater{}           \textless{}chr\textgreater{}       \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 N10156   2004 Fixed wing multi\textasciitilde{} EMBRAER         EMB{-}145XR       2}
\CommentTok{\#\textgreater{} 2 N102UW   1998 Fixed wing multi\textasciitilde{} AIRBUS INDUSTR\textasciitilde{} A320{-}214        2}
\CommentTok{\#\textgreater{} 3 N103US   1999 Fixed wing multi\textasciitilde{} AIRBUS INDUSTR\textasciitilde{} A320{-}214        2}
\CommentTok{\#\textgreater{} 4 N104UW   1999 Fixed wing multi\textasciitilde{} AIRBUS INDUSTR\textasciitilde{} A320{-}214        2}
\CommentTok{\#\textgreater{} 5 N10575   2002 Fixed wing multi\textasciitilde{} EMBRAER         EMB{-}145LR       2}
\CommentTok{\#\textgreater{} 6 N105UW   1999 Fixed wing multi\textasciitilde{} AIRBUS INDUSTR\textasciitilde{} A320{-}214        2}
\CommentTok{\#\textgreater{} \# i 3,316 more rows}
\CommentTok{\#\textgreater{} \# i 3 more variables: seats \textless{}int\textgreater{}, speed \textless{}int\textgreater{}, engine \textless{}chr\textgreater{}}
\end{Highlighting}
\end{Shaded}
\item
  \texttt{weather} è®°å½•å…³äºå‡ºå‘æœºåœºçš„å¤©æ°”æ•°æ®ã€‚ä½ 
  å¯ä»¥é€šè¿‡ä½ç½®å’Œæ—¶é—´çš„ç»„åˆæ¥è¯†åˆ«æ¯ä¸ªè§‚æµ‹ï¼Œä½¿\texttt{origin}å’Œ\texttt{time\_hour}æˆä¸ºå¤åˆä¸»é”®ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{weather}
\CommentTok{\#\textgreater{} \# A tibble: 26,115 x 15}
\CommentTok{\#\textgreater{}   origin  year month   day  hour  temp  dewp humid wind\_dir}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}  \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 EWR     2013     1     1     1  39.0  26.1  59.4      270}
\CommentTok{\#\textgreater{} 2 EWR     2013     1     1     2  39.0  27.0  61.6      250}
\CommentTok{\#\textgreater{} 3 EWR     2013     1     1     3  39.0  28.0  64.4      240}
\CommentTok{\#\textgreater{} 4 EWR     2013     1     1     4  39.9  28.0  62.2      250}
\CommentTok{\#\textgreater{} 5 EWR     2013     1     1     5  39.0  28.0  64.4      260}
\CommentTok{\#\textgreater{} 6 EWR     2013     1     1     6  37.9  28.0  67.2      240}
\CommentTok{\#\textgreater{} \# i 26,109 more rows}
\CommentTok{\#\textgreater{} \# i 6 more variables: wind\_speed \textless{}dbl\textgreater{}, wind\_gust \textless{}dbl\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}
\end{itemize}

å¤–é”®æ˜¯ä¸€ä¸ªå˜é‡ï¼ˆæˆ–å˜é‡é›†ï¼‰ï¼Œå®ƒå¯¹åº”äºå¦ä¸€ä¸ªè¡¨ä¸­çš„ä¸»é”®ã€‚ä¾‹ å¦‚ï¼š

\begin{itemize}
\tightlist
\item
  \texttt{flights\$tailnum} æ˜¯ä¸€ä¸ªå¤–é”®ï¼Œå®ƒå¯¹åº”äºä¸»é”®
  \texttt{planes\$tailnum}.
\item
  \texttt{flights\$carrier} æ˜¯ä¸€ä¸ªå¤–é”®ï¼Œå®ƒå¯¹åº”äºä¸»é”®
  \texttt{airlines\$carrier}.
\item
  \texttt{flights\$origin} æ˜¯ä¸€ä¸ªå¤–é”®ï¼Œå®ƒå¯¹åº”äºä¸»é”®
  \texttt{airports\$faa}.
\item
  \texttt{flights\$dest} æ˜¯ä¸€ä¸ªå¤–é”®ï¼Œå®ƒå¯¹åº”äºä¸»é”®
  \texttt{airports\$faa}.
\item
  \texttt{flights\$origin}-\texttt{flights\$time\_hour}
  æ˜¯ä¸€ä¸ªå¤åˆå¤–é”®ï¼Œå®ƒå¯¹åº”äºå¤åˆä¸»é”®
  \texttt{weather\$origin}-\texttt{weather\$time\_hour}.
\end{itemize}

è¿™äº›å…³ç³»åœ¨ å›¾~\ref{fig-flights-relationships} ä¸­ä»¥å›¾å½¢æ–¹å¼è¿›è¡Œäº†æ€»ç»“ã€‚

\begin{figure}

\centering{

\includegraphics[width=5.23in,height=\textheight]{diagrams/relational.png}

}

\caption{\label{fig-flights-relationships}Connections between all five
data frames in the nycflights13 package. Variables making up a primary
key are colored grey, and are connected to their corresponding foreign
keys with arrows.}

\end{figure}%

ä½ ä¼šæ³¨æ„åˆ°è¿™äº›é”®çš„è®¾è®¡ä¸­çš„ä¸€ä¸ªå¾ˆå¥½çš„ç‰¹å¾ï¼šä¸»é”®å’Œå¤–é”®å‡ ä¹æ€»æ˜¯å…·æœ‰ç›¸åŒçš„åç§°ï¼Œæ­£å¦‚ä½ å¾ˆå¿«å°±ä¼šçœ‹åˆ°çš„ï¼Œè¿™å°†ä½¿ä½ çš„è¿æ¥æ“ä½œå˜å¾—æ›´åŠ å®¹æ˜“ã€‚åŒ
æ ·å€¼å¾—æ³¨æ„çš„æ˜¯ç›¸åçš„å…³ç³»ï¼šåœ¨å¤šä¸ªè¡¨ä¸­ä½¿ç”¨çš„å‡ ä¹æ¯ä¸ªå˜é‡ååœ¨æ¯ä¸ªä½ç½®éƒ½æœ‰ç›¸åŒçš„å«ä¹‰ã€‚åª
æœ‰ä¸€ä¸ªä¾‹å¤–ï¼šåœ¨\texttt{flights}è¡¨ä¸­\texttt{year}è¡¨ç¤ºå‡ºå‘å¹´ä»½ï¼Œè€Œåœ¨\texttt{planes}è¡¨ä¸­ï¼Œ\texttt{year}è¡¨ç¤ºåˆ¶é€ å¹´ä»½ã€‚å½“
æˆ‘ä»¬å¼€å§‹å®é™…å°†è¡¨è¿æ¥åœ¨ä¸€èµ·æ—¶ï¼Œè¿™ä¸€ç‚¹å°†å˜å¾—å¾ˆé‡è¦ã€‚

\subsection{æ£€æŸ¥ä¸»é”®}\label{ux68c0ux67e5ux4e3bux952e}

æ—¢ç„¶æˆ‘ä»¬å·²ç»ç¡®å®šäº†æ¯ä¸ªè¡¨çš„ä¸»é”®ï¼Œé‚£ä¹ˆéªŒè¯å®ƒä»¬ç¡®å®èƒ½å”¯ä¸€åœ°æ ‡è¯†æ¯ä¸ªè§‚æµ‹æ˜¯æ˜æ™ºçš„åšæ³•ã€‚ä¸€
ç§æ–¹æ³•æ˜¯\texttt{count()}ä¸»é”®çš„æ•°é‡ï¼Œå¹¶æŸ¥æ‰¾\texttt{n}å¤§äº 1 çš„æ¡ç›®ã€‚ç»“
æœè¡¨æ˜\texttt{planes}å’Œ\texttt{weather}ä¸¤ä¸ªè¡¨éƒ½æ²¡æœ‰é—®é¢˜ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{planes }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count}\NormalTok{(tailnum) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(n }\SpecialCharTok{\textgreater{}} \DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 0 x 2}
\CommentTok{\#\textgreater{} \# i 2 variables: tailnum \textless{}chr\textgreater{}, n \textless{}int\textgreater{}}

\NormalTok{weather }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count}\NormalTok{(time\_hour, origin) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(n }\SpecialCharTok{\textgreater{}} \DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 0 x 3}
\CommentTok{\#\textgreater{} \# i 3 variables: time\_hour \textless{}dttm\textgreater{}, origin \textless{}chr\textgreater{}, n \textless{}int\textgreater{}}
\end{Highlighting}
\end{Shaded}

ä½ ä¹Ÿåº”è¯¥æ£€æŸ¥ä¸»é”®ä¸­æ˜¯å¦æœ‰ç¼ºå¤±å€¼ï¼šå¦‚æœæŸä¸ªå€¼ç¼ºå¤±äº†ï¼Œé‚£ä¹ˆå®ƒå°±æ— æ³•æ ‡è¯†ä¸€ä¸ªè§‚æµ‹ï¼

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{planes }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(tailnum))}
\CommentTok{\#\textgreater{} \# A tibble: 0 x 9}
\CommentTok{\#\textgreater{} \# i 9 variables: tailnum \textless{}chr\textgreater{}, year \textless{}int\textgreater{}, type \textless{}chr\textgreater{}, manufacturer \textless{}chr\textgreater{},}
\CommentTok{\#\textgreater{} \#   model \textless{}chr\textgreater{}, engines \textless{}int\textgreater{}, seats \textless{}int\textgreater{}, speed \textless{}int\textgreater{}, engine \textless{}chr\textgreater{}}

\NormalTok{weather }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(time\_hour) }\SpecialCharTok{|} \FunctionTok{is.na}\NormalTok{(origin))}
\CommentTok{\#\textgreater{} \# A tibble: 0 x 15}
\CommentTok{\#\textgreater{} \# i 15 variables: origin \textless{}chr\textgreater{}, year \textless{}int\textgreater{}, month \textless{}int\textgreater{}, day \textless{}int\textgreater{},}
\CommentTok{\#\textgreater{} \#   hour \textless{}int\textgreater{}, temp \textless{}dbl\textgreater{}, dewp \textless{}dbl\textgreater{}, humid \textless{}dbl\textgreater{}, wind\_dir \textless{}dbl\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

\subsection{ä»£ç†é”® (Surrogate
keys)}\label{ux4ee3ux7406ux952e-surrogate-keys}

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰è°ˆåˆ°\texttt{flights}çš„ä¸»é”®ã€‚åœ¨
è¿™é‡Œå®ƒä¸æ˜¯ç‰¹åˆ«é‡è¦ï¼Œå› ä¸ºæ²¡æœ‰æ•°æ®æ¡†ä½¿ç”¨å®ƒä½œä¸ºå¤–é”®ï¼›ä½†è€ƒè™‘å®ƒä»ç„¶æ˜¯æœ‰ç”¨çš„ï¼Œå› ä¸ºå¦‚æœæˆ‘ä»¬æœ‰æŸç§æ–¹å¼å¯ä»¥å‘å…¶ä»–äººæè¿°è§‚æµ‹ï¼Œé‚£ä¹ˆå¤„ç†è¿™äº›è§‚æµ‹ä¼šæ›´åŠ å®¹æ˜“ã€‚

ç»è¿‡ä¸€äº›æ€è€ƒå’Œå°è¯•ï¼Œæˆ‘ä»¬ç¡®å®šæœ‰ä¸‰ä¸ªå˜é‡ä¸€èµ·èƒ½å¤Ÿå”¯ä¸€åœ°æ ‡è¯†æ¯æ¬¡èˆªç­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count}\NormalTok{(time\_hour, carrier, flight) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(n }\SpecialCharTok{\textgreater{}} \DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 0 x 4}
\CommentTok{\#\textgreater{} \# i 4 variables: time\_hour \textless{}dttm\textgreater{}, carrier \textless{}chr\textgreater{}, flight \textless{}int\textgreater{}, n \textless{}int\textgreater{}}
\end{Highlighting}
\end{Shaded}

ç¼ºå°‘é‡å¤é¡¹æ˜¯å¦è‡ªåŠ¨ä½¿\texttt{time\_hour}-\texttt{carrier}-\texttt{flight}æˆä¸ºä¸»é”®ï¼Ÿå½“
ç„¶è¿™æ˜¯ä¸€ä¸ªå¥½çš„å¼€å§‹ï¼Œä½†å¹¶ä¸èƒ½ä¿è¯æˆåŠŸã€‚ä¾‹
å¦‚ï¼Œæµ·æ‹”å’Œçº¬åº¦æ˜¯å¦é€‚åˆä½œä¸º\texttt{airports}çš„ä¸»é”®ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{airports }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{count}\NormalTok{(alt, lat) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(n }\SpecialCharTok{\textgreater{}} \DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 3}
\CommentTok{\#\textgreater{}     alt   lat     n}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1    13  40.6     2}
\end{Highlighting}
\end{Shaded}

ä»…é€šè¿‡æµ·æ‹”å’Œçº¬åº¦æ¥è¯†åˆ«æœºåœºæ˜¾ç„¶æ˜¯ä¸€ä¸ªç³Ÿç³•çš„ä¸»æ„ï¼Œè€Œä¸”é€šå¸¸ä»…å‡­æ•°æ®æœ¬èº«æ˜¯æ— æ³•çŸ¥é“å˜é‡ç»„åˆæ˜¯å¦å¯ä»¥æˆä¸ºä¸€ä¸ªå¥½çš„ä¸»é”®çš„ã€‚ä½†
æ˜¯å¯¹äºèˆªç­æ¥è¯´ï¼Œ\texttt{time\_hour}ã€\texttt{carrier}å’Œ\texttt{flight}çš„ç»„åˆçœ‹èµ·æ¥æ˜¯åˆç†çš„ï¼Œå› ä¸ºå¦‚æœåŒæ—¶æœ‰å¤šä¸ªèˆªç­åœ¨ç©ºä¸­ä½¿ç”¨ç›¸åŒçš„èˆªç­å·ï¼Œå¯¹äºèˆªç©ºå…¬å¸å’Œå…¶å®¢æˆ·æ¥è¯´ä¼šéå¸¸æ··ä¹±çš„ã€‚

ä¸è¿‡ï¼Œæˆ‘ä»¬æœ€å¥½ä½¿ç”¨è¡Œå·æ¥å¼•å…¥ä¸€ä¸ªç®€å•çš„æ•°å­—ä»£ç†é”®ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights2 }\OtherTok{\textless{}{-}}\NormalTok{ flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{id =} \FunctionTok{row\_number}\NormalTok{(), }\AttributeTok{.before =} \DecValTok{1}\NormalTok{)}
\NormalTok{flights2}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 20}
\CommentTok{\#\textgreater{}      id  year month   day dep\_time sched\_dep\_time dep\_delay arr\_time}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}    \textless{}int\textgreater{}          \textless{}int\textgreater{}     \textless{}dbl\textgreater{}    \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1     1  2013     1     1      517            515         2      830}
\CommentTok{\#\textgreater{} 2     2  2013     1     1      533            529         4      850}
\CommentTok{\#\textgreater{} 3     3  2013     1     1      542            540         2      923}
\CommentTok{\#\textgreater{} 4     4  2013     1     1      544            545        {-}1     1004}
\CommentTok{\#\textgreater{} 5     5  2013     1     1      554            600        {-}6      812}
\CommentTok{\#\textgreater{} 6     6  2013     1     1      554            558        {-}4      740}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 12 more variables: sched\_arr\_time \textless{}int\textgreater{}, arr\_delay \textless{}dbl\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

ä»£ç†é”®åœ¨ä¸ä»–äººäº¤æµæ—¶ç‰¹åˆ«æœ‰ç”¨ï¼šå‘Šè¯‰æŸäººæŸ¥çœ‹èˆªç­2001æ¯”å‘Šè¯‰æŸäººæŸ¥çœ‹2013å¹´1æœˆ3æ—¥ä¸Šåˆ9ç‚¹èµ·é£çš„UA430èˆªç­è¦å®¹æ˜“å¾—å¤šã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-49}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  åœ¨ å›¾~\ref{fig-flights-relationships}
  ä¸­ï¼Œæˆ‘ä»¬å¿˜è®°äº†ç”»å‡º\texttt{weather} å’Œ\texttt{airports}ä¹‹é—´çš„å…³ç³»ã€‚è¿™
  ç§å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿå®ƒ åº”è¯¥å¦‚ä½•å‡ºç°åœ¨å›¾ä¸­ï¼Ÿ
\item
  \texttt{weather} æ•°æ®åªåŒ…å«çº½çº¦å¸‚ä¸‰ä¸ªå‡ºå‘æœºåœºçš„ä¿¡æ¯ã€‚å¦‚
  æœå®ƒåŒ…å«äº†ç¾å›½æ‰€æœ‰æœºåœºçš„å¤©æ°”è®°å½•ï¼Œé‚£ä¹ˆå®ƒä¼šä¸\texttt{flights}äº§ç”Ÿä»€ä¹ˆæ ·çš„é¢å¤–å…³è”ï¼Ÿ
\item
  \texttt{year}, \texttt{month}, \texttt{day}, \texttt{hour}, å’Œ
  \texttt{origin}
  å‡ ä¹æ„æˆäº†å¤©æ°”çš„å¤åˆé”®ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªå°æ—¶æœ‰é‡å¤çš„è§‚å¯Ÿè®°å½•ã€‚ä½ 
  èƒ½æ‰¾å‡ºé‚£ä¸ªå°æ—¶æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„å—ï¼Ÿ
\item
  æˆ‘ä»¬çŸ¥é“ä¸€å¹´ä¸­çš„æŸäº›å¤©æ˜¯ç‰¹æ®Šçš„ï¼Œé€šå¸¸ä¼šæ¯”å¹³æ—¶å°‘äººä¹˜åé£æœºï¼ˆä¾‹å¦‚ï¼Œå¹³å®‰å¤œå’Œåœ£è¯èŠ‚ï¼‰ã€‚ä½ 
  å¦‚ä½•å°†è¿™äº›æ•°æ®è¡¨ç¤ºä¸ºæ•°æ®æ¡†ï¼Ÿä¸» é”®ä¼šæ˜¯ä»€ä¹ˆï¼Ÿå®ƒ
  å°†å¦‚ä½•ä¸ç°æœ‰çš„æ•°æ®æ¡†è¿æ¥ï¼Ÿ
\item
  ç”»ä¸€ä¸ªå›¾ï¼Œè¯´æ˜LahmanåŒ…ä¸­\texttt{Batting}ã€\texttt{People}å’Œ\texttt{Salaries}æ•°æ®æ¡†ä¹‹é—´çš„è¿æ¥å…³ç³»ã€‚å†
  ç”»ä¸€ä¸ªå›¾ï¼Œæ˜¾ç¤º\texttt{People}ã€\texttt{Managers}å’Œ\texttt{AwardsManagers}ä¹‹é—´çš„å…³ç³»ã€‚ä½ 
  ä¼šå¦‚ä½•æè¿°\texttt{Batting}ã€\texttt{Pitching}å’Œ\texttt{Fielding}æ•°æ®æ¡†ä¹‹é—´çš„å…³ç³»ï¼Ÿ
\end{enumerate}

\section{åŸºæœ¬è¿æ¥}\label{sec-mutating-joins}

æ—¢ç„¶ä½ å·²ç»ç†è§£äº†å¦‚ä½•é€šè¿‡é”®æ¥è¿æ¥æ•°æ®æ¡†ï¼Œç°åœ¨å°±å¯ä»¥å¼€å§‹ä½¿ç”¨è¿æ¥æ¥æ›´å¥½åœ°ç†è§£\texttt{flights}æ•°æ®é›†äº†ã€‚d
plyræä¾›äº†å…­ç§è¿æ¥å‡½æ•°ï¼š\texttt{left\_join()}ã€\texttt{inner\_join()}ã€\texttt{right\_join()}ã€\texttt{full\_join()}ã€\texttt{semi\_join()}å’Œ\texttt{anti\_join()}ã€‚è¿™
äº›å‡½æ•°éƒ½å…·æœ‰ç›¸åŒçš„æ¥å£ï¼šå®ƒä»¬æ¥å—ä¸€å¯¹æ•°æ®æ¡†ï¼ˆ\texttt{x}å’Œ\texttt{y}ï¼‰å¹¶è¿”å›ä¸€ä¸ªæ•°æ®æ¡†ã€‚è¾“
å‡ºä¸­è¡Œå’Œåˆ—çš„é¡ºåºä¸»è¦ç”±\texttt{x}å†³å®šã€‚

åœ¨æœ¬èŠ‚ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨ä¸€ä¸ªå˜å¼‚è¿æ¥\texttt{left\_join()}å’Œä¸¤ä¸ªç­›é€‰è¿æ¥\texttt{semi\_join()}å’Œ\texttt{anti\_join()}ã€‚åœ¨
ä¸‹ä¸€èŠ‚ä¸­ï¼Œä½ å°†è¯¦ç»†äº†è§£è¿™äº›å‡½æ•°æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼ŒåŒ…æ‹¬å‰©ä¸‹çš„\texttt{inner\_join()}ã€\texttt{right\_join()}å’Œ\texttt{full\_join()}ã€‚

\subsection{å˜å¼‚è¿æ¥}\label{ux53d8ux5f02ux8fdeux63a5}

\textbf{å˜å¼‚è¿æ¥}å…è®¸ä½ å°†ä¸¤ä¸ªæ•°æ®æ¡†ä¸­çš„å˜é‡ç»„åˆèµ·æ¥ï¼šå®ƒé¦–å…ˆé€šè¿‡é”®æ¥åŒ¹é…è§‚æµ‹å€¼ï¼Œç„¶åå°†ä¸€ä¸ªæ•°æ®æ¡†ä¸­çš„å˜é‡å¤åˆ¶åˆ°å¦ä¸€ä¸ªæ•°æ®æ¡†ä¸­ã€‚ä¸
\texttt{mutate()}å‡½æ•°ç±»ä¼¼ï¼Œè¿æ¥å‡½æ•°å°†å˜é‡æ·»åŠ åˆ°å³ä¾§ï¼Œå› æ­¤å¦‚æœä½ çš„æ•°æ®é›†æœ‰å¾ˆå¤šå˜é‡ï¼Œä½ å¯èƒ½ä¸ä¼šç«‹å³çœ‹åˆ°æ–°æ·»åŠ çš„å˜é‡ã€‚ä¸º
äº†è¿™äº›ç¤ºä¾‹ï¼Œæˆ‘ä»¬å°†é€šè¿‡åˆ›å»ºä¸€ä¸ªä»…åŒ…å«å…­ä¸ªå˜é‡çš„è¾ƒçª„æ•°æ®é›†æ¥æ›´å®¹æ˜“åœ°æŸ¥çœ‹å‘ç”Ÿäº†ä»€ä¹ˆ\footnote{è®°ä½ï¼Œåœ¨RStudioä¸­ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨\texttt{View()}æ¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights2 }\OtherTok{\textless{}{-}}\NormalTok{ flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(year, time\_hour, origin, dest, tailnum, carrier)}
\NormalTok{flights2}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 6}
\CommentTok{\#\textgreater{}    year time\_hour           origin dest  tailnum carrier}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}dttm\textgreater{}              \textless{}chr\textgreater{}  \textless{}chr\textgreater{} \textless{}chr\textgreater{}   \textless{}chr\textgreater{}  }
\CommentTok{\#\textgreater{} 1  2013 2013{-}01{-}01 05:00:00 EWR    IAH   N14228  UA     }
\CommentTok{\#\textgreater{} 2  2013 2013{-}01{-}01 05:00:00 LGA    IAH   N24211  UA     }
\CommentTok{\#\textgreater{} 3  2013 2013{-}01{-}01 05:00:00 JFK    MIA   N619AA  AA     }
\CommentTok{\#\textgreater{} 4  2013 2013{-}01{-}01 05:00:00 JFK    BQN   N804JB  B6     }
\CommentTok{\#\textgreater{} 5  2013 2013{-}01{-}01 06:00:00 LGA    ATL   N668DN  DL     }
\CommentTok{\#\textgreater{} 6  2013 2013{-}01{-}01 05:00:00 EWR    ORD   N39463  UA     }
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\end{Highlighting}
\end{Shaded}

å˜å¼‚è¿æ¥æœ‰å››ç§ç±»å‹ï¼Œä½†æœ‰ä¸€ç§ä½ å‡ ä¹æ€»æ˜¯ä¼šç”¨åˆ°ï¼š\texttt{left\_join()}ã€‚å®ƒ
å¾ˆç‰¹åˆ«ï¼Œå› ä¸ºè¾“å‡ºæ€»æ˜¯ä¸\texttt{x}ï¼ˆä½ æ­£åœ¨è¿æ¥çš„æ•°æ®æ¡†ï¼‰æœ‰ç›¸åŒçš„è¡Œ\footnote{è¿™å¹¶ä¸æ˜¯ç™¾åˆ†ç™¾æ­£ç¡®ï¼Œä½†å¦‚æœä¸æ˜¯ï¼Œä½ å°±ä¼šå¾—åˆ°è­¦å‘Šã€‚}ã€‚
\texttt{left\_join()}çš„ä¸»è¦ç”¨é€”æ˜¯æ·»åŠ é¢å¤–çš„å…ƒæ•°æ®ã€‚
ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{left\_join()}å‘\texttt{flights2}æ•°æ®ä¸­æ·»åŠ å®Œæ•´çš„èˆªç©ºå…¬å¸åç§°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights2 }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{left\_join}\NormalTok{(airlines)}
\CommentTok{\#\textgreater{} Joining with \textasciigrave{}by = join\_by(carrier)\textasciigrave{}}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 7}
\CommentTok{\#\textgreater{}    year time\_hour           origin dest  tailnum carrier name                }
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}dttm\textgreater{}              \textless{}chr\textgreater{}  \textless{}chr\textgreater{} \textless{}chr\textgreater{}   \textless{}chr\textgreater{}   \textless{}chr\textgreater{}               }
\CommentTok{\#\textgreater{} 1  2013 2013{-}01{-}01 05:00:00 EWR    IAH   N14228  UA      United Air Lines In\textasciitilde{}}
\CommentTok{\#\textgreater{} 2  2013 2013{-}01{-}01 05:00:00 LGA    IAH   N24211  UA      United Air Lines In\textasciitilde{}}
\CommentTok{\#\textgreater{} 3  2013 2013{-}01{-}01 05:00:00 JFK    MIA   N619AA  AA      American Airlines I\textasciitilde{}}
\CommentTok{\#\textgreater{} 4  2013 2013{-}01{-}01 05:00:00 JFK    BQN   N804JB  B6      JetBlue Airways     }
\CommentTok{\#\textgreater{} 5  2013 2013{-}01{-}01 06:00:00 LGA    ATL   N668DN  DL      Delta Air Lines Inc.}
\CommentTok{\#\textgreater{} 6  2013 2013{-}01{-}01 05:00:00 EWR    ORD   N39463  UA      United Air Lines In\textasciitilde{}}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\end{Highlighting}
\end{Shaded}

æˆ–è€…æˆ‘ä»¬å¯ä»¥æŸ¥æ‰¾æ¯æ¶é£æœºèµ·é£æ—¶çš„æ¸©åº¦å’Œé£é€Ÿï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights2 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{left\_join}\NormalTok{(weather }\SpecialCharTok{|\textgreater{}} \FunctionTok{select}\NormalTok{(origin, time\_hour, temp, wind\_speed))}
\CommentTok{\#\textgreater{} Joining with \textasciigrave{}by = join\_by(time\_hour, origin)\textasciigrave{}}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 8}
\CommentTok{\#\textgreater{}    year time\_hour           origin dest  tailnum carrier  temp wind\_speed}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}dttm\textgreater{}              \textless{}chr\textgreater{}  \textless{}chr\textgreater{} \textless{}chr\textgreater{}   \textless{}chr\textgreater{}   \textless{}dbl\textgreater{}      \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013 2013{-}01{-}01 05:00:00 EWR    IAH   N14228  UA       39.0       12.7}
\CommentTok{\#\textgreater{} 2  2013 2013{-}01{-}01 05:00:00 LGA    IAH   N24211  UA       39.9       15.0}
\CommentTok{\#\textgreater{} 3  2013 2013{-}01{-}01 05:00:00 JFK    MIA   N619AA  AA       39.0       15.0}
\CommentTok{\#\textgreater{} 4  2013 2013{-}01{-}01 05:00:00 JFK    BQN   N804JB  B6       39.0       15.0}
\CommentTok{\#\textgreater{} 5  2013 2013{-}01{-}01 06:00:00 LGA    ATL   N668DN  DL       39.9       16.1}
\CommentTok{\#\textgreater{} 6  2013 2013{-}01{-}01 05:00:00 EWR    ORD   N39463  UA       39.0       12.7}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\end{Highlighting}
\end{Shaded}

æˆ–è€…æŸ¥çœ‹å½“æ—¶é£è¡Œçš„æ˜¯å“ªç§å¤§å°çš„é£æœºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights2 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{left\_join}\NormalTok{(planes }\SpecialCharTok{|\textgreater{}} \FunctionTok{select}\NormalTok{(tailnum, type, engines, seats))}
\CommentTok{\#\textgreater{} Joining with \textasciigrave{}by = join\_by(tailnum)\textasciigrave{}}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 9}
\CommentTok{\#\textgreater{}    year time\_hour           origin dest  tailnum carrier type                }
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}dttm\textgreater{}              \textless{}chr\textgreater{}  \textless{}chr\textgreater{} \textless{}chr\textgreater{}   \textless{}chr\textgreater{}   \textless{}chr\textgreater{}               }
\CommentTok{\#\textgreater{} 1  2013 2013{-}01{-}01 05:00:00 EWR    IAH   N14228  UA      Fixed wing multi en\textasciitilde{}}
\CommentTok{\#\textgreater{} 2  2013 2013{-}01{-}01 05:00:00 LGA    IAH   N24211  UA      Fixed wing multi en\textasciitilde{}}
\CommentTok{\#\textgreater{} 3  2013 2013{-}01{-}01 05:00:00 JFK    MIA   N619AA  AA      Fixed wing multi en\textasciitilde{}}
\CommentTok{\#\textgreater{} 4  2013 2013{-}01{-}01 05:00:00 JFK    BQN   N804JB  B6      Fixed wing multi en\textasciitilde{}}
\CommentTok{\#\textgreater{} 5  2013 2013{-}01{-}01 06:00:00 LGA    ATL   N668DN  DL      Fixed wing multi en\textasciitilde{}}
\CommentTok{\#\textgreater{} 6  2013 2013{-}01{-}01 05:00:00 EWR    ORD   N39463  UA      Fixed wing multi en\textasciitilde{}}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 2 more variables: engines \textless{}int\textgreater{}, seats \textless{}int\textgreater{}}
\end{Highlighting}
\end{Shaded}

å½“\texttt{left\_join()}æ‰¾ä¸åˆ°ä¸\texttt{x}ä¸­æŸè¡Œç›¸åŒ¹é…çš„è®°å½•æ—¶ï¼Œå®ƒä¼šç”¨ç¼ºå¤±å€¼æ¥å¡«å……æ–°çš„å˜é‡ã€‚ä¾‹
å¦‚ï¼Œæ²¡æœ‰å…³äºå°¾å·ä¸º\texttt{N3ALAA}çš„é£æœºçš„ä¿¡æ¯ï¼Œå› æ­¤å…¶\texttt{type}ã€\texttt{engines}å’Œ\texttt{seats}å°†æ˜¯ç¼ºå¤±çš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights2 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(tailnum }\SpecialCharTok{==} \StringTok{"N3ALAA"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{left\_join}\NormalTok{(planes }\SpecialCharTok{|\textgreater{}} \FunctionTok{select}\NormalTok{(tailnum, type, engines, seats))}
\CommentTok{\#\textgreater{} Joining with \textasciigrave{}by = join\_by(tailnum)\textasciigrave{}}
\CommentTok{\#\textgreater{} \# A tibble: 63 x 9}
\CommentTok{\#\textgreater{}    year time\_hour           origin dest  tailnum carrier type  engines seats}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}dttm\textgreater{}              \textless{}chr\textgreater{}  \textless{}chr\textgreater{} \textless{}chr\textgreater{}   \textless{}chr\textgreater{}   \textless{}chr\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013 2013{-}01{-}01 06:00:00 LGA    ORD   N3ALAA  AA      \textless{}NA\textgreater{}       NA    NA}
\CommentTok{\#\textgreater{} 2  2013 2013{-}01{-}02 18:00:00 LGA    ORD   N3ALAA  AA      \textless{}NA\textgreater{}       NA    NA}
\CommentTok{\#\textgreater{} 3  2013 2013{-}01{-}03 06:00:00 LGA    ORD   N3ALAA  AA      \textless{}NA\textgreater{}       NA    NA}
\CommentTok{\#\textgreater{} 4  2013 2013{-}01{-}07 19:00:00 LGA    ORD   N3ALAA  AA      \textless{}NA\textgreater{}       NA    NA}
\CommentTok{\#\textgreater{} 5  2013 2013{-}01{-}08 17:00:00 JFK    ORD   N3ALAA  AA      \textless{}NA\textgreater{}       NA    NA}
\CommentTok{\#\textgreater{} 6  2013 2013{-}01{-}16 06:00:00 LGA    ORD   N3ALAA  AA      \textless{}NA\textgreater{}       NA    NA}
\CommentTok{\#\textgreater{} \# i 57 more rows}
\end{Highlighting}
\end{Shaded}

åœ¨æœ¬ç« å‰©ä¸‹çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬è¿˜ä¼šå¤šæ¬¡å›åˆ°è¿™ä¸ªé—®é¢˜ã€‚

\subsection{æŒ‡å®šè¿æ¥é”®}\label{ux6307ux5b9aux8fdeux63a5ux952e}

é»˜è®¤æƒ…å†µä¸‹ï¼Œ\texttt{left\_join()}ä¼šä½¿ç”¨ä¸¤ä¸ªæ•°æ®æ¡†ä¸­éƒ½å‡ºç°çš„æ‰€æœ‰å˜é‡ä½œä¸ºè¿æ¥é”®ï¼Œè¿™è¢«ç§°ä¸ºè‡ªç„¶è¿æ¥
(\textbf{natural} join)ã€‚è¿™ æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„å¯å‘å¼æ–¹æ³•ï¼Œä½†å¹¶ä¸æ€»æ˜¯æœ‰æ•ˆã€‚ä¾‹
å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å°è¯•å°†\texttt{flights2}ä¸å®Œæ•´çš„\texttt{planes}æ•°æ®é›†è¿æ¥ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights2 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{left\_join}\NormalTok{(planes)}
\CommentTok{\#\textgreater{} Joining with \textasciigrave{}by = join\_by(year, tailnum)\textasciigrave{}}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 13}
\CommentTok{\#\textgreater{}    year time\_hour           origin dest  tailnum carrier type  manufacturer}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}dttm\textgreater{}              \textless{}chr\textgreater{}  \textless{}chr\textgreater{} \textless{}chr\textgreater{}   \textless{}chr\textgreater{}   \textless{}chr\textgreater{} \textless{}chr\textgreater{}       }
\CommentTok{\#\textgreater{} 1  2013 2013{-}01{-}01 05:00:00 EWR    IAH   N14228  UA      \textless{}NA\textgreater{}  \textless{}NA\textgreater{}        }
\CommentTok{\#\textgreater{} 2  2013 2013{-}01{-}01 05:00:00 LGA    IAH   N24211  UA      \textless{}NA\textgreater{}  \textless{}NA\textgreater{}        }
\CommentTok{\#\textgreater{} 3  2013 2013{-}01{-}01 05:00:00 JFK    MIA   N619AA  AA      \textless{}NA\textgreater{}  \textless{}NA\textgreater{}        }
\CommentTok{\#\textgreater{} 4  2013 2013{-}01{-}01 05:00:00 JFK    BQN   N804JB  B6      \textless{}NA\textgreater{}  \textless{}NA\textgreater{}        }
\CommentTok{\#\textgreater{} 5  2013 2013{-}01{-}01 06:00:00 LGA    ATL   N668DN  DL      \textless{}NA\textgreater{}  \textless{}NA\textgreater{}        }
\CommentTok{\#\textgreater{} 6  2013 2013{-}01{-}01 05:00:00 EWR    ORD   N39463  UA      \textless{}NA\textgreater{}  \textless{}NA\textgreater{}        }
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 5 more variables: model \textless{}chr\textgreater{}, engines \textless{}int\textgreater{}, seats \textless{}int\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å¾—åˆ°äº†å¾ˆå¤šç¼ºå¤±çš„åŒ¹é…é¡¹ï¼Œå› ä¸ºè¿æ¥è¯•å›¾ä½¿ç”¨\texttt{tailnum}å’Œ\texttt{year}ä½œä¸ºå¤åˆé”®ã€‚\texttt{f}
\texttt{lights}å’Œ\texttt{planes}éƒ½æœ‰ä¸€ä¸ª\texttt{year}åˆ—ï¼Œä½†å®ƒä»¬è¡¨ç¤ºçš„æ˜¯ä¸åŒçš„å«ä¹‰ï¼š\texttt{flights\$year}æ˜¯èˆªç­å‘ç”Ÿçš„å¹´ä»½ï¼Œè€Œ\texttt{planes\$year}æ˜¯é£æœºåˆ¶é€ çš„å¹´ä»½ã€‚æˆ‘
ä»¬åªæƒ³é€šè¿‡\texttt{tailnum}è¿›è¡Œè¿æ¥ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨\texttt{join\_by()}æ¥æä¾›ä¸€ä¸ªæ˜ç¡®çš„è§„èŒƒã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights2 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{left\_join}\NormalTok{(planes, }\FunctionTok{join\_by}\NormalTok{(tailnum))}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 14}
\CommentTok{\#\textgreater{}   year.x time\_hour           origin dest  tailnum carrier year.y}
\CommentTok{\#\textgreater{}    \textless{}int\textgreater{} \textless{}dttm\textgreater{}              \textless{}chr\textgreater{}  \textless{}chr\textgreater{} \textless{}chr\textgreater{}   \textless{}chr\textgreater{}    \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1   2013 2013{-}01{-}01 05:00:00 EWR    IAH   N14228  UA        1999}
\CommentTok{\#\textgreater{} 2   2013 2013{-}01{-}01 05:00:00 LGA    IAH   N24211  UA        1998}
\CommentTok{\#\textgreater{} 3   2013 2013{-}01{-}01 05:00:00 JFK    MIA   N619AA  AA        1990}
\CommentTok{\#\textgreater{} 4   2013 2013{-}01{-}01 05:00:00 JFK    BQN   N804JB  B6        2012}
\CommentTok{\#\textgreater{} 5   2013 2013{-}01{-}01 06:00:00 LGA    ATL   N668DN  DL        1991}
\CommentTok{\#\textgreater{} 6   2013 2013{-}01{-}01 05:00:00 EWR    ORD   N39463  UA        2012}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 7 more variables: type \textless{}chr\textgreater{}, manufacturer \textless{}chr\textgreater{}, model \textless{}chr\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„ï¼Œåœ¨è¾“å‡ºä¸­\texttt{year}å˜é‡é€šè¿‡åç¼€ï¼ˆ\texttt{year.x} å’Œ
\texttt{year.y}ï¼‰æ¥åŒºåˆ†ï¼Œä»¥å‘Šè¯‰ä½ è¯¥å˜é‡æ¥è‡ª\texttt{x}è¿˜æ˜¯\texttt{y}å‚æ•°ã€‚ä½ 
å¯ä»¥ä½¿ç”¨\texttt{suffix}å‚æ•°æ¥è¦†ç›–é»˜è®¤åç¼€ã€‚

\texttt{join\_by(tailnum)}æ˜¯\texttt{join\_by(tailnum\ ==\ tailnum)}çš„ç®€å†™ã€‚äº†
è§£è¿™ç§å®Œæ•´å½¢å¼å¾ˆé‡è¦ï¼ŒåŸå› æœ‰ä¸¤ä¸ªï¼šé¦–å…ˆï¼Œå®ƒæè¿°äº†ä¸¤ä¸ªè¡¨ä¹‹é—´çš„å…³ç³»ï¼šé”®å¿…é¡»ç›¸ç­‰ã€‚è¿™
å°±æ˜¯ä¸ºä»€ä¹ˆè¿™ç§è¿æ¥ç±»å‹é€šå¸¸è¢«ç§°ä¸ºç­‰å€¼è¿æ¥ (\textbf{equi join})ã€‚ä½ 
å°†åœ¨@sec-non-equi-joins å­¦ä¹ éç­‰å€¼è¿æ¥ã€‚

å…¶æ¬¡ï¼Œè¿™æ˜¯ä½ åœ¨æ¯ä¸ªè¡¨ä¸­æŒ‡å®šä¸åŒè¿æ¥é”®çš„æ–¹å¼ã€‚ä¾‹
å¦‚ï¼Œæœ‰ä¸¤ç§æ–¹å¼å¯ä»¥å°†\texttt{flight2}å’Œ\texttt{airports}è¡¨è¿æ¥èµ·æ¥ï¼šé€šè¿‡\texttt{dest}æˆ–\texttt{origin}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights2 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{left\_join}\NormalTok{(airports, }\FunctionTok{join\_by}\NormalTok{(dest }\SpecialCharTok{==}\NormalTok{ faa))}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 13}
\CommentTok{\#\textgreater{}    year time\_hour           origin dest  tailnum carrier name                }
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}dttm\textgreater{}              \textless{}chr\textgreater{}  \textless{}chr\textgreater{} \textless{}chr\textgreater{}   \textless{}chr\textgreater{}   \textless{}chr\textgreater{}               }
\CommentTok{\#\textgreater{} 1  2013 2013{-}01{-}01 05:00:00 EWR    IAH   N14228  UA      George Bush Interco\textasciitilde{}}
\CommentTok{\#\textgreater{} 2  2013 2013{-}01{-}01 05:00:00 LGA    IAH   N24211  UA      George Bush Interco\textasciitilde{}}
\CommentTok{\#\textgreater{} 3  2013 2013{-}01{-}01 05:00:00 JFK    MIA   N619AA  AA      Miami Intl          }
\CommentTok{\#\textgreater{} 4  2013 2013{-}01{-}01 05:00:00 JFK    BQN   N804JB  B6      \textless{}NA\textgreater{}                }
\CommentTok{\#\textgreater{} 5  2013 2013{-}01{-}01 06:00:00 LGA    ATL   N668DN  DL      Hartsfield Jackson \textasciitilde{}}
\CommentTok{\#\textgreater{} 6  2013 2013{-}01{-}01 05:00:00 EWR    ORD   N39463  UA      Chicago Ohare Intl  }
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 6 more variables: lat \textless{}dbl\textgreater{}, lon \textless{}dbl\textgreater{}, alt \textless{}dbl\textgreater{}, tz \textless{}dbl\textgreater{}, ...}

\NormalTok{flights2 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{left\_join}\NormalTok{(airports, }\FunctionTok{join\_by}\NormalTok{(origin }\SpecialCharTok{==}\NormalTok{ faa))}
\CommentTok{\#\textgreater{} \# A tibble: 336,776 x 13}
\CommentTok{\#\textgreater{}    year time\_hour           origin dest  tailnum carrier name               }
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}dttm\textgreater{}              \textless{}chr\textgreater{}  \textless{}chr\textgreater{} \textless{}chr\textgreater{}   \textless{}chr\textgreater{}   \textless{}chr\textgreater{}              }
\CommentTok{\#\textgreater{} 1  2013 2013{-}01{-}01 05:00:00 EWR    IAH   N14228  UA      Newark Liberty Intl}
\CommentTok{\#\textgreater{} 2  2013 2013{-}01{-}01 05:00:00 LGA    IAH   N24211  UA      La Guardia         }
\CommentTok{\#\textgreater{} 3  2013 2013{-}01{-}01 05:00:00 JFK    MIA   N619AA  AA      John F Kennedy Intl}
\CommentTok{\#\textgreater{} 4  2013 2013{-}01{-}01 05:00:00 JFK    BQN   N804JB  B6      John F Kennedy Intl}
\CommentTok{\#\textgreater{} 5  2013 2013{-}01{-}01 06:00:00 LGA    ATL   N668DN  DL      La Guardia         }
\CommentTok{\#\textgreater{} 6  2013 2013{-}01{-}01 05:00:00 EWR    ORD   N39463  UA      Newark Liberty Intl}
\CommentTok{\#\textgreater{} \# i 336,770 more rows}
\CommentTok{\#\textgreater{} \# i 6 more variables: lat \textless{}dbl\textgreater{}, lon \textless{}dbl\textgreater{}, alt \textless{}dbl\textgreater{}, tz \textless{}dbl\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

åœ¨æ—§ä»£ç ä¸­ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°ä½¿ç”¨å­—ç¬¦å‘é‡æ¥æŒ‡å®šè¿æ¥é”®çš„ä¸åŒæ–¹å¼ï¼š

\begin{itemize}
\tightlist
\item
  \texttt{by\ =\ "x"}å¯¹åº”äº\texttt{join\_by(x)}ã€‚
\item
  \texttt{by\ =\ c("a"\ =\ "x")}å¯¹åº”äº\texttt{join\_by(a\ ==\ x)}ã€‚
\end{itemize}

æ—¢ç„¶ç°åœ¨æœ‰äº†\texttt{join\_by()}ï¼Œæˆ‘ä»¬æ›´å€¾å‘äºä½¿ç”¨å®ƒï¼Œå› ä¸ºå®ƒæä¾›äº†æ›´æ¸…æ™°ä¸”æ›´çµæ´»çš„è§„èŒƒã€‚

\texttt{inner\_join()}ã€\texttt{right\_join()}ã€\texttt{full\_join()}ä¸\texttt{left\_join()}çš„æ¥å£ç›¸åŒã€‚å®ƒ
ä»¬ä¹‹é—´çš„åŒºåˆ«åœ¨äºä¿ç•™å“ªäº›è¡Œï¼šå·¦è¿æ¥ä¿ç•™\texttt{x}ä¸­çš„æ‰€æœ‰è¡Œï¼Œå³è¿æ¥ä¿ç•™\texttt{y}ä¸­çš„æ‰€æœ‰è¡Œï¼Œå…¨è¿æ¥ä¿ç•™\texttt{x}æˆ–\texttt{y}ä¸­çš„æ‰€æœ‰è¡Œï¼Œè€Œå†…è¿æ¥ä»…ä¿ç•™åœ¨\texttt{x}å’Œ\texttt{y}ä¸­éƒ½å‡ºç°çš„è¡Œã€‚æˆ‘
ä»¬å°†åœ¨ç¨åæ›´è¯¦ç»†åœ°è®¨è®ºè¿™äº›è¿æ¥ç±»å‹ã€‚

\subsection{ç­›é€‰è¿æ¥}\label{ux7b5bux9009ux8fdeux63a5}

æ­£å¦‚ä½ å¯èƒ½çŒœåˆ°çš„ï¼Œç­›é€‰è¿æ¥çš„ä¸»è¦æ“ä½œæ˜¯ç­›é€‰è¡Œã€‚æœ‰
ä¸¤ç§ç±»å‹ï¼šåŠè¿æ¥ï¼ˆsemi-joinï¼‰å’Œåè¿æ¥ï¼ˆanti-joinï¼‰ã€‚åŠ
è¿æ¥ä¿ç•™\texttt{x}åœ¨\texttt{y}ä¸­æœ‰åŒ¹é…é¡¹çš„æ‰€æœ‰è¡Œã€‚ä¾‹
å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŠè¿æ¥æ¥ç­›é€‰æœºåœºæ•°æ®é›†ï¼Œä»…æ˜¾ç¤ºå§‹å‘æœºåœºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{airports }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{semi\_join}\NormalTok{(flights2, }\FunctionTok{join\_by}\NormalTok{(faa }\SpecialCharTok{==}\NormalTok{ origin))}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 8}
\CommentTok{\#\textgreater{}   faa   name                  lat   lon   alt    tz dst   tzone           }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}chr\textgreater{}               \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}chr\textgreater{} \textless{}chr\textgreater{}           }
\CommentTok{\#\textgreater{} 1 EWR   Newark Liberty Intl  40.7 {-}74.2    18    {-}5 A     America/New\_York}
\CommentTok{\#\textgreater{} 2 JFK   John F Kennedy Intl  40.6 {-}73.8    13    {-}5 A     America/New\_York}
\CommentTok{\#\textgreater{} 3 LGA   La Guardia           40.8 {-}73.9    22    {-}5 A     America/New\_York}
\end{Highlighting}
\end{Shaded}

æˆ–è€…ä»…ä»…æ˜¯ç›®çš„åœ°:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{airports }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{semi\_join}\NormalTok{(flights2, }\FunctionTok{join\_by}\NormalTok{(faa }\SpecialCharTok{==}\NormalTok{ dest))}
\CommentTok{\#\textgreater{} \# A tibble: 101 x 8}
\CommentTok{\#\textgreater{}   faa   name                     lat    lon   alt    tz dst   tzone          }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}chr\textgreater{}                  \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}chr\textgreater{} \textless{}chr\textgreater{}          }
\CommentTok{\#\textgreater{} 1 ABQ   Albuquerque Internati\textasciitilde{}  35.0 {-}107.   5355    {-}7 A     America/Denver }
\CommentTok{\#\textgreater{} 2 ACK   Nantucket Mem           41.3  {-}70.1    48    {-}5 A     America/New\_Yo\textasciitilde{}}
\CommentTok{\#\textgreater{} 3 ALB   Albany Intl             42.7  {-}73.8   285    {-}5 A     America/New\_Yo\textasciitilde{}}
\CommentTok{\#\textgreater{} 4 ANC   Ted Stevens Anchorage\textasciitilde{}  61.2 {-}150.    152    {-}9 A     America/Anchor\textasciitilde{}}
\CommentTok{\#\textgreater{} 5 ATL   Hartsfield Jackson At\textasciitilde{}  33.6  {-}84.4  1026    {-}5 A     America/New\_Yo\textasciitilde{}}
\CommentTok{\#\textgreater{} 6 AUS   Austin Bergstrom Intl   30.2  {-}97.7   542    {-}6 A     America/Chicago}
\CommentTok{\#\textgreater{} \# i 95 more rows}
\end{Highlighting}
\end{Shaded}

åè¿æ¥åˆ™ç›¸åï¼šå®ƒä»¬è¿”å›xåœ¨yä¸­æ²¡æœ‰åŒ¹é…é¡¹çš„æ‰€æœ‰è¡Œã€‚å®ƒ
ä»¬åœ¨å¯»æ‰¾æ•°æ®ä¸­éšå¼çš„ç¼ºå¤±å€¼æ–¹é¢å¾ˆæœ‰ç”¨ï¼Œè¿™æ˜¯
å°èŠ‚~\ref{sec-missing-implicit} çš„ä¸»é¢˜ã€‚éš
å¼çš„ç¼ºå¤±å€¼ä¸ä¼šæ˜¾ç¤ºä¸º\texttt{NA}ï¼Œè€Œä»…è¡¨ç°ä¸ºç¼ºå¤±ã€‚ä¾‹
å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥æ‰¾æ²¡æœ‰åŒ¹é…ç›®çš„åœ°æœºåœºçš„èˆªç­æ¥æ‰¾åˆ°\texttt{airports}æ•°æ®é›†ä¸­ç¼ºå¤±çš„è¡Œï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights2 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{anti\_join}\NormalTok{(airports, }\FunctionTok{join\_by}\NormalTok{(dest }\SpecialCharTok{==}\NormalTok{ faa)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{distinct}\NormalTok{(dest)}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 1}
\CommentTok{\#\textgreater{}   dest }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 BQN  }
\CommentTok{\#\textgreater{} 2 SJU  }
\CommentTok{\#\textgreater{} 3 STT  }
\CommentTok{\#\textgreater{} 4 PSE}
\end{Highlighting}
\end{Shaded}

æˆ–è€…æˆ‘ä»¬å¯ä»¥æ‰¾å‡ºå“ªäº›\texttt{tailnum}åœ¨\texttt{planes}æ•°æ®é›†ä¸­ç¼ºå¤±ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights2 }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{anti\_join}\NormalTok{(planes, }\FunctionTok{join\_by}\NormalTok{(tailnum)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{distinct}\NormalTok{(tailnum)}
\CommentTok{\#\textgreater{} \# A tibble: 722 x 1}
\CommentTok{\#\textgreater{}   tailnum}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}  }
\CommentTok{\#\textgreater{} 1 N3ALAA }
\CommentTok{\#\textgreater{} 2 N3DUAA }
\CommentTok{\#\textgreater{} 3 N542MQ }
\CommentTok{\#\textgreater{} 4 N730MQ }
\CommentTok{\#\textgreater{} 5 N9EAMQ }
\CommentTok{\#\textgreater{} 6 N532UA }
\CommentTok{\#\textgreater{} \# i 716 more rows}
\end{Highlighting}
\end{Shaded}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-50}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  æ‰¾å‡ºå…¨å¹´ä¸­å»¶è¯¯æœ€ä¸¥é‡çš„48å°æ—¶ï¼Œå¹¶ä¸\texttt{weather}æ•°æ®è¿›è¡Œäº¤å‰æ¯”å¯¹ã€‚ä½ 
  èƒ½å¦çœ‹åˆ°ä»»ä½•æ¨¡å¼ï¼Ÿ
\item
  å‡è®¾ä½ ä½¿ç”¨è¿™æ®µä»£ç æ‰¾åˆ°äº†æœ€å—æ¬¢è¿çš„10ä¸ªç›®çš„åœ°:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{top\_dest }\OtherTok{\textless{}{-}}\NormalTok{ flights2 }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{count}\NormalTok{(dest, }\AttributeTok{sort =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{head}\NormalTok{(}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  ä½ æ€æ ·æ‰èƒ½æ‰¾åˆ°å»è¿™äº›ç›®çš„åœ°çš„æ‰€æœ‰èˆªç­å‘¢?
\item
  æ˜¯å¦æ¯ä¸ªèµ·é£çš„èˆªç­éƒ½æœ‰å¯¹åº”çš„è¯¥å°æ—¶å¤©æ°”æ•°æ®ï¼Ÿ
\item
  é‚£äº›åœ¨\texttt{planes}ä¸­æ²¡æœ‰åŒ¹é…è®°å½•çš„å°¾å·æœ‰ä»€ä¹ˆå…±åŒä¹‹å¤„ï¼Ÿ( æç¤º:
  ä¸€ä¸ªå˜é‡è§£é‡Šäº†çº¦90\%çš„é—®é¢˜ï¼‰
\item
  ç»™\texttt{planes}æ•°æ®æ¡†æ·»åŠ ä¸€ä¸ªåˆ—ï¼Œåˆ—å‡ºé£è¿‡è¯¥é£æœºçš„æ‰€æœ‰èˆªç©ºå…¬å¸ã€‚ä½ 
  å¯èƒ½ä¼šæœŸæœ›é£æœºå’Œèˆªç©ºå…¬å¸ä¹‹é—´å­˜åœ¨ä¸€ç§éšå¼å…³ç³»ï¼Œå› ä¸ºæ¯æ¶é£æœºéƒ½ç”±å•ä¸€çš„èˆªç©ºå…¬å¸è¿è¥ã€‚ä½¿
  ç”¨ä½ åœ¨å‰å‡ ç« ä¸­å­¦åˆ°çš„å·¥å…·æ¥è¯å®æˆ–åé©³è¿™ä¸€å‡è®¾ã€‚
\item
  å°†èµ·é£æœºåœºå’Œç›®çš„åœ°æœºåœºçš„çº¬åº¦å’Œç»åº¦æ·»åŠ åˆ°\texttt{flights}æ•°æ®æ¡†ä¸­ã€‚åœ¨
  è¿æ¥ä¹‹å‰è¿˜æ˜¯ä¹‹åé‡å‘½ååˆ—æ›´å®¹æ˜“ï¼Ÿ
\item
  æŒ‰ç›®çš„åœ°è®¡ç®—å¹³å‡å»¶è¯¯æ—¶é—´ï¼Œç„¶åä¸\texttt{airports}æ•°æ®æ¡†è¿›è¡Œè¿æ¥ï¼Œä»¥ä¾¿ä½ å¯ä»¥å±•ç¤ºå»¶è¯¯çš„ç©ºé—´åˆ†å¸ƒã€‚ä»¥
  ä¸‹æ˜¯ä¸€ä¸ªç»˜åˆ¶ç¾å›½åœ°å›¾çš„ç®€å•æ–¹æ³•ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{airports }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{semi\_join}\NormalTok{(flights, }\FunctionTok{join\_by}\NormalTok{(faa }\SpecialCharTok{==}\NormalTok{ dest)) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ lon, }\AttributeTok{y =}\NormalTok{ lat)) }\SpecialCharTok{+}
    \FunctionTok{borders}\NormalTok{(}\StringTok{"state"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{coord\_quickmap}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

  ä½ å¯èƒ½æƒ³ä½¿ç”¨ç‚¹çš„å¤§å°æˆ–é¢œè‰²æ¥æ˜¾ç¤ºæ¯ä¸ªæœºåœºçš„å¹³å‡å»¶è¯¯æ—¶é—´ã€‚
\item
  2013å¹´6æœˆ13æ—¥å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿç”»
  ä¸€å¼ å»¶è¯¯åœ°å›¾ï¼Œç„¶åä½¿ç”¨Googleä¸å¤©æ°”è¿›è¡Œäº¤å‰æ¯”å¯¹ã€‚
\end{enumerate}

\section{è¿æ¥æ˜¯å¦‚ä½•å·¥ä½œçš„?}\label{ux8fdeux63a5ux662fux5982ux4f55ux5de5ux4f5cux7684}

æ—¢ç„¶ä½ å·²ç»ä½¿ç”¨è¿æ¥æ“ä½œå‡ æ¬¡äº†ï¼Œç°åœ¨æ˜¯æ—¶å€™æ·±å…¥äº†è§£å®ƒä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„äº†ï¼Œé‡ç‚¹å…³æ³¨\texttt{x}ä¸­çš„æ¯ä¸€è¡Œå¦‚ä½•ä¸\texttt{y}ä¸­çš„è¡Œè¿›è¡ŒåŒ¹é…ã€‚æˆ‘
ä»¬å°†ä»å¼•å…¥è¿æ¥çš„è§†è§‰è¡¨ç¤ºå¼€å§‹ï¼Œä½¿ç”¨ä¸‹é¢å®šä¹‰çš„ç®€å•tibbleï¼Œå¹¶åœ¨
å›¾~\ref{fig-join-setup} ä¸­å±•ç¤ºã€‚åœ¨
è¿™äº›ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨åä¸º\texttt{key}çš„å•ä¸ªé”®å’Œä¸€ä¸ªå€¼åˆ—ï¼ˆ\texttt{val\_x}å’Œval\_yï¼‰ï¼Œä½†è¿™äº›æƒ³æ³•éƒ½å¯ä»¥æ¨å¹¿åˆ°å¤šä¸ªé”®å’Œå¤šä¸ªå€¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{key, }\SpecialCharTok{\textasciitilde{}}\NormalTok{val\_x,}
     \DecValTok{1}\NormalTok{, }\StringTok{"x1"}\NormalTok{,}
     \DecValTok{2}\NormalTok{, }\StringTok{"x2"}\NormalTok{,}
     \DecValTok{3}\NormalTok{, }\StringTok{"x3"}
\NormalTok{)}
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{key, }\SpecialCharTok{\textasciitilde{}}\NormalTok{val\_y,}
     \DecValTok{1}\NormalTok{, }\StringTok{"y1"}\NormalTok{,}
     \DecValTok{2}\NormalTok{, }\StringTok{"y2"}\NormalTok{,}
     \DecValTok{4}\NormalTok{, }\StringTok{"y3"}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\centering{

\includegraphics[width=1.66in,height=\textheight]{diagrams/join/setup.png}

}

\caption{\label{fig-join-setup}Graphical representation of two simple
tables. The colored \texttt{key} columns map background color to key
value. The grey columns represent the ``value'' columns that are carried
along for the ride.}

\end{figure}%

å›¾~\ref{fig-join-setup2} ä¸ºæˆ‘ä»¬çš„è§†è§‰è¡¨ç¤ºæ³•å¥ å®šäº†åŸºç¡€ã€‚å®ƒ
å±•ç¤ºäº†\texttt{x}å’Œ\texttt{y}ä¹‹é—´æ‰€æœ‰å¯èƒ½çš„åŒ¹é…ï¼Œè¿™äº›åŒ¹é…æ˜¯ä»\texttt{x}çš„æ¯ä¸€è¡Œå’Œ\texttt{y}çš„æ¯ä¸€è¡Œç»˜åˆ¶å‡ºçš„çº¿æ¡çš„äº¤ç‚¹ã€‚è¾“
å‡ºç»“æœä¸­çš„è¡Œå’Œåˆ—ä¸»è¦ç”±\texttt{x}å†³å®šï¼Œå› æ­¤\texttt{x}è¡¨æ ¼æ˜¯æ°´å¹³çš„ï¼Œå¹¶ä¸”ä¸è¾“å‡ºç»“æœå¯¹é½ã€‚

\begin{figure}

\centering{

\includegraphics[width=1.77in,height=\textheight]{diagrams/join/setup2.png}

}

\caption{\label{fig-join-setup2}To understand how joins work, it's
useful to think of every possible match. Here we show that with a grid
of connecting lines.}

\end{figure}%

ä¸ºäº†æè¿°ä¸€ç§ç‰¹å®šçš„è¿æ¥ç±»å‹ï¼Œæˆ‘ä»¬ç”¨ç‚¹æ¥è¡¨ç¤ºåŒ¹é…é¡¹ï¼Œè¿™äº›åŒ¹é…é¡¹å†³å®šäº†è¾“å‡ºçš„è¡Œã€‚è¾“
å‡ºæ˜¯ä¸€ä¸ªæ–°çš„æ•°æ®æ¡†ï¼ŒåŒ…å«é”®ã€xå€¼å’Œyå€¼ã€‚ä¾‹ å¦‚ï¼Œå›¾~\ref{fig-join-inner}
å±•ç¤ºäº†å†…è¿æ¥ï¼Œåªæœ‰å½“é”®ç›¸ç­‰æ—¶ï¼Œè¡Œæ‰ä¼šè¢«ä¿ç•™ã€‚

\begin{figure}

\centering{

\includegraphics[width=3.78in,height=\textheight]{diagrams/join/inner.png}

}

\caption{\label{fig-join-inner}An inner join matches each row in
\texttt{x} to the row in \texttt{y} that has the same value of
\texttt{key}. Each match becomes a row in the output.}

\end{figure}%

æˆ‘ä»¬å¯ä»¥åº”ç”¨åŒæ ·çš„åŸç†æ¥è§£é‡Šå¤–è¿æ¥ (\textbf{outer
joins})ï¼Œå¤–è¿æ¥ä¼šä¿ç•™è‡³å°‘åœ¨ä¸€ä¸ªæ•°æ®æ¡†ä¸­å‡ºç°çš„è§‚æµ‹å€¼ã€‚è¿™
äº›è¿æ¥é€šè¿‡åœ¨æ¯ä¸ªæ•°æ®æ¡†ä¸­æ·»åŠ ä¸€ä¸ªé¢å¤–çš„``è™šæ‹Ÿ''è§‚æµ‹å€¼æ¥å®ç°ã€‚è¿™
ä¸ªè§‚æµ‹å€¼å…·æœ‰ä¸€ä¸ªé”®ï¼Œå½“æ²¡æœ‰å…¶ä»–é”®åŒ¹é…æ—¶ï¼Œå®ƒä¼šåŒ¹é…ï¼Œå¹¶å°†å€¼å¡«å……ä¸º\texttt{NA}ã€‚æœ‰
ä¸‰ç§ç±»å‹çš„å¤–è¿æ¥ï¼š

\begin{itemize}
\item
  å·¦è¿æ¥ä¿ç•™\texttt{x}ä¸­çš„æ‰€æœ‰è§‚æµ‹å€¼ï¼Œå¦‚ å›¾~\ref{fig-join-left}
  æ‰€ç¤ºã€‚\texttt{x}
  çš„æ¯ä¸€è¡Œéƒ½ä¿ç•™åœ¨è¾“å‡ºä¸­ï¼Œå› ä¸ºå®ƒå¯ä»¥é€€å›åˆ°ä¸\texttt{y}ä¸­çš„\texttt{NA}è¡Œè¿›è¡ŒåŒ¹é…ã€‚

  \begin{figure}

  \centering{

  \includegraphics[width=4.01in,height=\textheight]{diagrams/join/left.png}

  }

  \caption{\label{fig-join-left}A visual representation of the left join
  where every row in \texttt{x} appears in the output.}

  \end{figure}%
\item
  å³è¿æ¥ä¿ç•™\texttt{y}ä¸­çš„æ‰€æœ‰è§‚æµ‹å€¼ï¼Œå¦‚å›¾ å›¾~\ref{fig-join-right}
  æ‰€ç¤ºã€‚\texttt{y}
  çš„æ¯ä¸€è¡Œéƒ½ä¿ç•™åœ¨è¾“å‡ºä¸­ï¼Œå› ä¸ºå®ƒå¯ä»¥é€€å›åˆ°ä¸\texttt{x}ä¸­çš„\texttt{NA}è¡Œè¿›è¡ŒåŒ¹é…ã€‚è¾“
  å‡ºä»ç„¶å°½å¯èƒ½ä¸\texttt{x}è¿›è¡ŒåŒ¹é…ï¼›\texttt{y}ä¸­çš„ä»»ä½•é¢å¤–è¡Œéƒ½ä¼šæ·»åŠ åˆ°æœ«å°¾ã€‚

  \begin{figure}

  \centering{

  \includegraphics[width=3.96in,height=\textheight]{diagrams/join/right.png}

  }

  \caption{\label{fig-join-right}A visual representation of the right
  join where every row of \texttt{y} appears in the output.}

  \end{figure}%
\item
  å…¨è¿æ¥ä¿ç•™å‡ºç°åœ¨\texttt{x}æˆ–\texttt{y}ä¸­çš„æ‰€æœ‰è§‚æµ‹å€¼ï¼Œå¦‚å›¾
  å›¾~\ref{fig-join-full} æ‰€ç¤ºã€‚\texttt{x}
  å’Œ\texttt{y}çš„æ¯ä¸€è¡Œéƒ½åŒ…å«åœ¨è¾“å‡ºä¸­ï¼Œå› ä¸º\texttt{x}å’Œ\texttt{y}éƒ½æœ‰ä¸€ä¸ªå›é€€è¡Œä¸º\texttt{NA}ã€‚åŒ
  æ ·ï¼Œè¾“å‡ºä»¥\texttt{x}çš„æ‰€æœ‰è¡Œå¼€å§‹ï¼Œç„¶åæ˜¯å‰©ä½™çš„æœªåŒ¹é…çš„\texttt{y}è¡Œã€‚

  \begin{figure}

  \centering{

  \includegraphics[width=4.04in,height=\textheight]{diagrams/join/full.png}

  }

  \caption{\label{fig-join-full}A visual representation of the full join
  where every row in \texttt{x} and \texttt{y} appears in the output.}

  \end{figure}%
\end{itemize}

å¦ä¸€ç§å±•ç¤ºä¸åŒç±»å‹çš„å¤–è¿æ¥å·®å¼‚çš„æ–¹æ³•æ˜¯ä½¿ç”¨æ–‡æ°å›¾ (Venn diagram)ï¼Œå¦‚
å›¾~\ref{fig-join-venn} æ‰€ç¤ºã€‚ç„¶
è€Œï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è¡¨ç¤ºæ–¹æ³•ï¼Œå› ä¸ºå®ƒè™½ç„¶å¯èƒ½ä¼šå”¤èµ·ä½ å¯¹å“ªäº›è¡Œè¢«ä¿ç•™çš„è®°å¿†ï¼Œä½†å®ƒæ— æ³•è¯´æ˜åˆ—å‘ç”Ÿäº†ä»€ä¹ˆã€‚

\begin{figure}

\centering{

\includegraphics[width=4.01in,height=\textheight]{diagrams/join/venn.png}

}

\caption{\label{fig-join-venn}Venn diagrams showing the difference
between inner, left, right, and full joins.}

\end{figure}%

è¿™é‡Œå±•ç¤ºçš„è¿æ¥è¢«ç§°ä¸ºç­‰å€¼è¿æ¥ï¼Œå³å½“é”®ç›¸ç­‰æ—¶è¡Œä¼šåŒ¹é…ã€‚ç­‰
å€¼è¿æ¥æ˜¯æœ€å¸¸è§çš„è¿æ¥ç±»å‹ï¼Œå› æ­¤æˆ‘ä»¬é€šå¸¸ä¼šçœç•¥equiå‰ç¼€ï¼Œåªè¯´``å†…è¿æ¥''è€Œä¸æ˜¯``ç­‰å€¼å†…è¿æ¥''ã€‚æˆ‘
ä»¬å°†åœ¨@sec-non-equi-joins è®¨è®ºéç­‰å€¼è¿æ¥ã€‚

\subsection{è¡ŒåŒ¹é…}\label{ux884cux5339ux914d}

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»æ¢è®¨äº†\texttt{x}ä¸­çš„ä¸€è¡Œä¸\texttt{y}ä¸­çš„é›¶è¡Œæˆ–ä¸€è¡ŒåŒ¹é…æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚ä½†
å¦‚æœå®ƒåŒ¹é…å¤šè¡Œæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿä¸º
äº†ç†è§£è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬é¦–å…ˆå…³æ³¨\texttt{inner\_join()}å‡½æ•°ï¼Œç„¶åç”»ä¸€å¼ å›¾ï¼Œå¦‚
å›¾~\ref{fig-join-match-types} æ‰€ç¤ºã€‚

\begin{figure}

\centering{

\includegraphics[width=3.63in,height=\textheight]{diagrams/join/match-types.png}

}

\caption{\label{fig-join-match-types}The three ways a row in \texttt{x}
can match. \texttt{x1} matches one row in \texttt{y}, \texttt{x2}
matches two rows in \texttt{y}, \texttt{x3} matches zero rows in y. Note
that while there are three rows in \texttt{x} and three rows in the
output, there isn't a direct correspondence between the rows.}

\end{figure}%

\texttt{x}ä¸­çš„è¡Œæœ‰ä¸‰ç§å¯èƒ½çš„ç»“æœï¼š

\begin{itemize}
\tightlist
\item
  å¦‚æœå®ƒä¸åŒ¹é…ä»»ä½•è¡Œï¼Œå®ƒå°†è¢«åˆ é™¤ï¼›
\item
  å¦‚æœå®ƒä¸\texttt{y}ä¸­çš„ä¸€è¡ŒåŒ¹é…ï¼Œå®ƒå°†è¢«ä¿ç•™ï¼›
\item
  å¦‚æœå®ƒä¸\texttt{y}ä¸­çš„å¤šè¡ŒåŒ¹é…ï¼Œå®ƒå°†ä¸ºæ¯ä¸ªåŒ¹é…é¡¹å¤åˆ¶ä¸€æ¬¡ã€‚
\end{itemize}

åŸåˆ™ä¸Šï¼Œè¿™æ„å‘³ç€è¾“å‡ºä¸­çš„è¡Œä¸\texttt{x}ä¸­çš„è¡Œä¹‹é—´æ²¡æœ‰ä¿è¯çš„å¯¹åº”å…³ç³»ï¼Œä½†åœ¨å®è·µä¸­ï¼Œè¿™ç§æƒ…å†µå¾ˆå°‘ä¼šå¼•èµ·é—®é¢˜ã€‚ç„¶
è€Œï¼Œæœ‰ä¸€ç§ç‰¹åˆ«å±é™©çš„æƒ…å†µå¯èƒ½å¯¼è‡´è¡Œçš„ç»„åˆçˆ†ç‚¸ï¼Œæƒ³è±¡ä¸€ä¸‹è¿æ¥ä»¥ä¸‹ä¸¤ä¸ªè¡¨ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df1 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{key =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{val\_x =} \FunctionTok{c}\NormalTok{(}\StringTok{"x1"}\NormalTok{, }\StringTok{"x2"}\NormalTok{, }\StringTok{"x3"}\NormalTok{))}
\NormalTok{df2 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{key =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{val\_y =} \FunctionTok{c}\NormalTok{(}\StringTok{"y1"}\NormalTok{, }\StringTok{"y2"}\NormalTok{, }\StringTok{"y3"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

è™½ç„¶\texttt{df1}çš„ç¬¬ä¸€è¡Œåªä¸\texttt{df2}ä¸­çš„ä¸€è¡ŒåŒ¹é…ï¼Œä½†ç¬¬äºŒè¡Œå’Œç¬¬ä¸‰è¡Œéƒ½ä¸ä¸¤è¡ŒåŒ¹é…ã€‚è¿™
ä¸ªæœ‰æ—¶è¢«ç§°ä¸ºå¤šå¯¹å¤š (\texttt{many-to-many}) è¿æ¥ï¼Œå°†ä¼šå¯¼è‡´dplyrå‘å‡ºè­¦å‘Šï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df1 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{inner\_join}\NormalTok{(df2, }\FunctionTok{join\_by}\NormalTok{(key))}
\CommentTok{\#\textgreater{} Warning in inner\_join(df1, df2, join\_by(key)): Detected an unexpected many{-}to{-}many relationship between \textasciigrave{}x\textasciigrave{} and \textasciigrave{}y\textasciigrave{}.}
\CommentTok{\#\textgreater{} i Row 2 of \textasciigrave{}x\textasciigrave{} matches multiple rows in \textasciigrave{}y\textasciigrave{}.}
\CommentTok{\#\textgreater{} i Row 2 of \textasciigrave{}y\textasciigrave{} matches multiple rows in \textasciigrave{}x\textasciigrave{}.}
\CommentTok{\#\textgreater{} i If a many{-}to{-}many relationship is expected, set \textasciigrave{}relationship =}
\CommentTok{\#\textgreater{}   "many{-}to{-}many"\textasciigrave{} to silence this warning.}
\CommentTok{\#\textgreater{} \# A tibble: 5 x 3}
\CommentTok{\#\textgreater{}     key val\_x val\_y}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}chr\textgreater{} \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1     1 x1    y1   }
\CommentTok{\#\textgreater{} 2     2 x2    y2   }
\CommentTok{\#\textgreater{} 3     2 x2    y3   }
\CommentTok{\#\textgreater{} 4     2 x3    y2   }
\CommentTok{\#\textgreater{} 5     2 x3    y3}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ æœ‰æ„è¿™ä¹ˆåšï¼Œå¯ä»¥æŒ‰ç…§è­¦å‘Šçš„æç¤ºè®¾ç½®
\texttt{relationship\ =\ "many-to-many"}ã€‚

\subsection{ç­›é€‰è¿æ¥}\label{ux7b5bux9009ux8fdeux63a5-1}

åŒ¹é…çš„æ•°é‡ä¹Ÿå†³å®šäº†ç­›é€‰è¿æ¥çš„è¡Œä¸ºã€‚åŠ
è¿æ¥ä¿ç•™\texttt{x}åœ¨\texttt{y}ä¸­æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªåŒ¹é…çš„è¡Œï¼Œå¦‚
å›¾~\ref{fig-join-semi} æ‰€ç¤ºã€‚å
è¿æ¥ä¿ç•™\texttt{x}åœ¨\texttt{y}ä¸­é›¶ä¸ªåŒ¹é…çš„è¡Œï¼Œå¦‚ å›¾~\ref{fig-join-anti}
æ‰€ç¤ºã€‚åœ¨ è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œä»…åŒ¹é…çš„å­˜åœ¨æ˜¯é‡è¦çš„ï¼ŒåŒ¹é…çš„æ¬¡æ•°å¹¶ä¸é‡è¦ã€‚è¿™
æ„å‘³ç€ç­›é€‰è¿æ¥æ°¸è¿œä¸ä¼šåƒå˜å¼‚è¿æ¥é‚£æ ·é‡å¤è¡Œã€‚

\begin{figure}

\centering{

\includegraphics[width=3.31in,height=\textheight]{diagrams/join/semi.png}

}

\caption{\label{fig-join-semi}In a semi-join it only matters that there
is a match; otherwise values in \texttt{y} don't affect the output.}

\end{figure}%

\begin{figure}

\centering{

\includegraphics[width=3.3in,height=\textheight]{diagrams/join/anti.png}

}

\caption{\label{fig-join-anti}An anti-join is the inverse of a
semi-join, dropping rows from \texttt{x} that have a match in
\texttt{y}.}

\end{figure}%

\section{éç­‰å€¼è¿æ¥}\label{sec-non-equi-joins}

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ åªçœ‹åˆ°äº†ç­‰è¿æ¥ï¼ˆequi
joinsï¼‰ï¼Œä¹Ÿå°±æ˜¯å½“\texttt{x}çš„é”®ç­‰äº\texttt{y}çš„é”®æ—¶è¡Œæ‰ä¼šåŒ¹é…ã€‚ç°
åœ¨æˆ‘ä»¬æ”¾å®½è¿™ä¸ªé™åˆ¶ï¼Œå¹¶è®¨è®ºç¡®å®šä¸€å¯¹è¡Œæ˜¯å¦åŒ¹é…çš„å…¶ä»–æ–¹æ³•ã€‚

ä½†æ˜¯ï¼Œåœ¨æˆ‘ä»¬è¿™æ ·åšä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å›é¡¾ä¸€ä¸‹ä¸Šé¢æ‰€åšçš„ç®€åŒ–ã€‚åœ¨
ç­‰è¿æ¥ä¸­ï¼Œ\texttt{x}çš„é”®å’Œ\texttt{y}çš„é”®æ€»æ˜¯ç›¸ç­‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åœ¨è¾“å‡ºä¸­æ˜¾ç¤ºä¸€ä¸ªã€‚æˆ‘
ä»¬å¯ä»¥è¦æ±‚dplyré€šè¿‡\texttt{keep\ =\ TRUE}ä¿ç•™ä¸¤ä¸ªé”®ï¼Œè¿™å°†å¯¼è‡´ä¸‹é¢çš„ä»£ç å’Œ
å›¾~\ref{fig-inner-both} ä¸­é‡æ–°ç»˜åˆ¶çš„\texttt{inner\_join()}ã€‚

So far you've only seen equi joins, joins where the rows match if the
\texttt{x} key equals the \texttt{y} key. Now we're going to relax that
restriction and discuss other ways of determining if a pair of rows
match.

But before we can do that, we need to revisit a simplification we made
above. In equi joins the \texttt{x} keys and \texttt{y} are always
equal, so we only need to show one in the output. We can request that
dplyr keep both keys with \texttt{keep\ =\ TRUE}, leading to the code
below and the re-drawn \texttt{inner\_join()} in
å›¾~\ref{fig-inner-both}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\SpecialCharTok{|\textgreater{}} \FunctionTok{inner\_join}\NormalTok{(y, }\FunctionTok{join\_by}\NormalTok{(key }\SpecialCharTok{==}\NormalTok{ key), }\AttributeTok{keep =} \ConstantTok{TRUE}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 4}
\CommentTok{\#\textgreater{}   key.x val\_x key.y val\_y}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}chr\textgreater{} \textless{}dbl\textgreater{} \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1     1 x1        1 y1   }
\CommentTok{\#\textgreater{} 2     2 x2        2 y2}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\centering{

\includegraphics[width=4.32in,height=\textheight]{diagrams/join/inner-both.png}

}

\caption{\label{fig-inner-both}An inner join showing both \texttt{x} and
\texttt{y} keys in the output.}

\end{figure}%

å½“æˆ‘ä»¬ä»ç­‰å€¼è¿æ¥è½¬å‘éç­‰å€¼è¿æ¥æ—¶ï¼Œæˆ‘ä»¬æ€»æ˜¯ä¼šæ˜¾ç¤ºé”®ï¼Œå› ä¸ºé”®å€¼é€šå¸¸ä¼šæœ‰æ‰€ä¸åŒã€‚ä¾‹
å¦‚ï¼Œæˆ‘ä»¬ä¸å†ä»…åœ¨\texttt{x\$key}å’Œ\texttt{y\$key}ç›¸ç­‰æ—¶æ‰è¿›è¡ŒåŒ¹é…ï¼Œè€Œæ˜¯å¯ä»¥åœ¨\texttt{x\$key}å¤§äºæˆ–ç­‰äº\texttt{y\$key}æ—¶è¿›è¡ŒåŒ¹é…ï¼Œå¦‚
å›¾~\ref{fig-join-gte} æ‰€ç¤ºã€‚d
plyrçš„è¿æ¥å‡½æ•°ç†è§£ç­‰å€¼è¿æ¥å’Œéç­‰å€¼è¿æ¥ä¹‹é—´çš„åŒºåˆ«ï¼Œå› æ­¤å½“ä½ æ‰§è¡Œéç­‰å€¼è¿æ¥æ—¶ï¼Œå®ƒæ€»æ˜¯ä¼šæ˜¾ç¤ºä¸¤ä¸ªé”®ã€‚

\begin{figure}

\centering{

\includegraphics[width=4.01in,height=\textheight]{diagrams/join/gte.png}

}

\caption{\label{fig-join-gte}A non-equi join where the \texttt{x} key
must be greater than or equal to the \texttt{y} key. Many rows generate
multiple matches.}

\end{figure}%

``éç­‰å€¼è¿æ¥''è¿™ä¸ªæœ¯è¯­ä¸æ˜¯ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå®ƒåªå‘Šè¯‰ä½ è¿™ä¸ªè¿æ¥ä¸æ˜¯ä»€ä¹ˆï¼Œè€Œä¸æ˜¯å®ƒæ˜¯ä»€ä¹ˆã€‚d
plyré€šè¿‡è¯†åˆ«å››ç§ç‰¹åˆ«æœ‰ç”¨çš„éç­‰å€¼è¿æ¥ç±»å‹æ¥å¸®åŠ©ä½ ï¼š

\begin{itemize}
\tightlist
\item
  \textbf{äº¤å‰è¿æ¥ (cross joins)} åŒ¹é…æ¯ä¸€å¯¹è¡Œï¼›
\item
  \textbf{ä¸ç­‰å¼(inequality joins)} ä½¿ç”¨
  \texttt{\textless{}}ã€\texttt{\textless{}=}ã€\texttt{\textgreater{}}
  å’Œ \texttt{\textgreater{}=} è€Œä¸æ˜¯ \texttt{==}ï¼›
\item
  \textbf{æ»šåŠ¨è¿æ¥ (rolling joins)}
  ç±»ä¼¼äºä¸ç­‰å¼è¿æ¥ï¼Œä½†åªæ‰¾åˆ°æœ€æ¥è¿‘çš„åŒ¹é…é¡¹ï¼›
\item
  \textbf{é‡å è¿æ¥ (overlap joins)}
  æ˜¯ä¸€ç§ç‰¹æ®Šçš„ä¸ç­‰å¼è¿æ¥ç±»å‹ï¼Œä¸“ä¸ºå¤„ç†èŒƒå›´è€Œè®¾è®¡ã€‚
\end{itemize}

è¿™äº›ç±»å‹å°†åœ¨ä»¥ä¸‹éƒ¨åˆ†ä¸­æ›´è¯¦ç»†åœ°æè¿°ã€‚

\subsection{äº¤å‰è¿æ¥}\label{ux4ea4ux53c9ux8fdeux63a5}

äº¤å‰è¿æ¥ä¼šåŒ¹é…æ‰€æœ‰å†…å®¹ï¼Œå¦‚ å›¾~\ref{fig-join-cross}
æ‰€ç¤ºï¼Œç”Ÿæˆè¡Œçš„ç¬›å¡å°”ç§¯ã€‚è¿™
æ„å‘³ç€è¾“å‡ºå°†å…·æœ‰\texttt{nrow(x)\ *\ nrow(y)}è¡Œã€‚

\begin{figure}

\centering{

\includegraphics[width=1.62in,height=\textheight]{diagrams/join/cross.png}

}

\caption{\label{fig-join-cross}A cross join matches each row in
\texttt{x} with every row in \texttt{y}.}

\end{figure}%

äº¤å‰è¿æ¥åœ¨ç”Ÿæˆæ’åˆ—æ—¶å¾ˆæœ‰ç”¨ã€‚ä¾‹ å¦‚ä¸‹é¢çš„ä»£ç ç”Ÿæˆäº†æ‰€æœ‰å¯èƒ½çš„åç§°å¯¹ã€‚å› 
ä¸ºæˆ‘ä»¬æ­£åœ¨å°†\texttt{df}ä¸å…¶è‡ªèº«è¿æ¥ï¼Œæ‰€ä»¥è¿™æœ‰æ—¶è¢«ç§°ä¸ºè‡ªè¿æ¥
(\textbf{self-join})ã€‚äº¤
å‰è¿æ¥ä½¿ç”¨ä¸åŒçš„è¿æ¥å‡½æ•°ï¼Œå› ä¸ºåœ¨åŒ¹é…æ¯ä¸€è¡Œæ—¶ï¼Œæ²¡æœ‰å†…è¿æ¥/å·¦è¿æ¥/å³è¿æ¥/å…¨è¿æ¥ä¹‹é—´çš„åŒºåˆ«ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{name =} \FunctionTok{c}\NormalTok{(}\StringTok{"John"}\NormalTok{, }\StringTok{"Simon"}\NormalTok{, }\StringTok{"Tracy"}\NormalTok{, }\StringTok{"Max"}\NormalTok{))}
\NormalTok{df }\SpecialCharTok{|\textgreater{}} \FunctionTok{cross\_join}\NormalTok{(df)}
\CommentTok{\#\textgreater{} \# A tibble: 16 x 2}
\CommentTok{\#\textgreater{}   name.x name.y}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}  \textless{}chr\textgreater{} }
\CommentTok{\#\textgreater{} 1 John   John  }
\CommentTok{\#\textgreater{} 2 John   Simon }
\CommentTok{\#\textgreater{} 3 John   Tracy }
\CommentTok{\#\textgreater{} 4 John   Max   }
\CommentTok{\#\textgreater{} 5 Simon  John  }
\CommentTok{\#\textgreater{} 6 Simon  Simon }
\CommentTok{\#\textgreater{} \# i 10 more rows}
\end{Highlighting}
\end{Shaded}

\subsection{ä¸ç­‰å¼è¿æ¥}\label{ux4e0dux7b49ux5f0fux8fdeux63a5}

ä¸ç­‰è¿æ¥ä½¿ç”¨
\texttt{\textless{}}ã€\texttt{\textless{}=}ã€\texttt{\textgreater{}} æˆ–
\texttt{\textgreater{}=} æ¥é™åˆ¶å¯èƒ½åŒ¹é…çš„é›†åˆï¼Œå¦‚ å›¾~\ref{fig-join-gte}
å’Œ å›¾~\ref{fig-join-lt} æ‰€ç¤ºã€‚

\begin{figure}

\centering{

\includegraphics[width=1.93in,height=\textheight]{diagrams/join/lt.png}

}

\caption{\label{fig-join-lt}An inequality join where \texttt{x} is
joined to \texttt{y} on rows where the key of \texttt{x} is less than
the key of \texttt{y}. This makes a triangular shape in the top-left
corner.}

\end{figure}%

ä¸ç­‰è¿æ¥éå¸¸é€šç”¨ï¼Œä»¥è‡³äºå¾ˆéš¾æå‡ºæœ‰æ„ä¹‰çš„ç‰¹å®šç”¨ä¾‹ã€‚ä¸€
ä¸ªæœ‰ç”¨çš„å°æŠ€å·§æ˜¯ä½¿ç”¨å®ƒä»¬æ¥é™åˆ¶äº¤å‰è¿æ¥ï¼Œä»¥ä¾¿æˆ‘ä»¬ä¸æ˜¯ç”Ÿæˆæ‰€æœ‰æ’åˆ—ï¼Œè€Œæ˜¯ç”Ÿæˆæ‰€æœ‰ç»„åˆï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{id =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{, }\AttributeTok{name =} \FunctionTok{c}\NormalTok{(}\StringTok{"John"}\NormalTok{, }\StringTok{"Simon"}\NormalTok{, }\StringTok{"Tracy"}\NormalTok{, }\StringTok{"Max"}\NormalTok{))}

\NormalTok{df }\SpecialCharTok{|\textgreater{}} \FunctionTok{inner\_join}\NormalTok{(df, }\FunctionTok{join\_by}\NormalTok{(id }\SpecialCharTok{\textless{}}\NormalTok{ id))}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 4}
\CommentTok{\#\textgreater{}    id.x name.x  id.y name.y}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}chr\textgreater{}  \textless{}int\textgreater{} \textless{}chr\textgreater{} }
\CommentTok{\#\textgreater{} 1     1 John       2 Simon }
\CommentTok{\#\textgreater{} 2     1 John       3 Tracy }
\CommentTok{\#\textgreater{} 3     1 John       4 Max   }
\CommentTok{\#\textgreater{} 4     2 Simon      3 Tracy }
\CommentTok{\#\textgreater{} 5     2 Simon      4 Max   }
\CommentTok{\#\textgreater{} 6     3 Tracy      4 Max}
\end{Highlighting}
\end{Shaded}

\subsection{æ»šåŠ¨è¿æ¥}\label{ux6edaux52a8ux8fdeux63a5}

æ»šåŠ¨è¿æ¥æ˜¯ä¸€ç§ç‰¹æ®Šçš„ä¸ç­‰å¼è¿æ¥ï¼Œå…¶ä¸­ä¸æ˜¯è·å–æ»¡è¶³ä¸ç­‰å¼çš„æ¯ä¸€è¡Œï¼Œè€Œæ˜¯ä»…è·å–æœ€æ¥è¿‘çš„è¡Œï¼Œå¦‚
å›¾~\ref{fig-join-closest} æ‰€ç¤ºã€‚ä½ 
å¯ä»¥é€šè¿‡å°†\texttt{closest()}æ·»åŠ åˆ°ä¸ç­‰è¿æ¥ä¸­æ¥å°†å…¶è½¬æ¢ä¸ºæ»šåŠ¨è¿æ¥ã€‚ä¾‹
å¦‚\texttt{join\_by(closest(x\ \textless{}=\ y))}å°†åŒ¹é…å¤§äºæˆ–ç­‰äº\texttt{x}çš„æœ€å°çš„\texttt{y}ï¼Œè€Œ\texttt{join\_by(closest(x\ \textgreater{}\ y))}å°†åŒ¹é…å°äº\texttt{x}çš„æœ€å¤§çš„\texttt{y}ã€‚

\begin{figure}

\centering{

\includegraphics[width=2.73in,height=\textheight]{diagrams/join/closest.png}

}

\caption{\label{fig-join-closest}A rolling join is similar to a
greater-than-or-equal inequality join but only matches the first value.}

\end{figure}%

æ»šåŠ¨è¿æ¥åœ¨ä»¥ä¸‹åœºæ™¯ç‰¹åˆ«æœ‰ç”¨ï¼šå‡å¦‚ä½ æœ‰ä¸¤ä¸ªæ—¥æœŸè¡¨ï¼Œä½†æ—¥æœŸå¹¶ä¸å®Œå…¨å¯¹åº”ï¼›ä½ æƒ³è¦åœ¨è¡¨1ä¸­æ‰¾åˆ°ä¸è¡¨2ä¸­æŸä¸ªæ—¥æœŸæœ€æ¥è¿‘çš„æ—¥æœŸ
(ä¹‹å‰æˆ–ä¹‹å)ã€‚

ä¾‹å¦‚ï¼Œå‡è®¾ä½ è´Ÿè´£ä½ ä»¬åŠå…¬å®¤çš„æ´¾å¯¹ç­–åˆ’å§”å‘˜ä¼šã€‚ç”±
äºå…¬å¸æ¯”è¾ƒèŠ‚ä¿­ï¼Œä¸æ˜¯ä¸¾åŠå•ç‹¬çš„æ´¾å¯¹ï¼Œè€Œæ˜¯æ¯ä¸ªå­£åº¦åªä¸¾åŠä¸€æ¬¡ã€‚ç¡®
å®šæ´¾å¯¹æ—¥æœŸçš„è§„åˆ™æœ‰äº›å¤æ‚ï¼šæ´¾å¯¹æ€»æ˜¯åœ¨æ˜ŸæœŸä¸€ä¸¾è¡Œï¼Œè€Œä¸”ä½ è·³è¿‡äº†1æœˆçš„ç¬¬ä¸€å‘¨ï¼Œå› ä¸ºå¾ˆå¤šäººéƒ½åœ¨ä¼‘å‡ã€‚æ­¤
å¤–ï¼Œ2022å¹´ç¬¬ä¸‰å­£åº¦çš„ç¬¬ä¸€ä¸ªæ˜ŸæœŸä¸€æ˜¯7æœˆ4æ—¥ï¼Œæ‰€ä»¥æ´¾å¯¹å¿…é¡»æ¨è¿Ÿä¸€å‘¨ã€‚åŸº
äºè¿™äº›è§„åˆ™ï¼Œä»¥ä¸‹æ˜¯ç¡®å®šçš„æ´¾å¯¹æ—¥æœŸï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{parties }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{q =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{,}
  \AttributeTok{party =} \FunctionTok{ymd}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"2022{-}01{-}10"}\NormalTok{, }\StringTok{"2022{-}04{-}04"}\NormalTok{, }\StringTok{"2022{-}07{-}11"}\NormalTok{, }\StringTok{"2022{-}10{-}03"}\NormalTok{))}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

ç°åœ¨ï¼Œå‡è®¾ä½ æœ‰ä¸€å¼ å‘˜å·¥ç”Ÿæ—¥çš„è¡¨æ ¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}
\NormalTok{employees }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{name =} \FunctionTok{sample}\NormalTok{(babynames}\SpecialCharTok{::}\NormalTok{babynames}\SpecialCharTok{$}\NormalTok{name, }\DecValTok{100}\NormalTok{),}
  \AttributeTok{birthday =} \FunctionTok{ymd}\NormalTok{(}\StringTok{"2022{-}01{-}01"}\NormalTok{) }\SpecialCharTok{+}\NormalTok{ (}\FunctionTok{sample}\NormalTok{(}\DecValTok{365}\NormalTok{, }\DecValTok{100}\NormalTok{, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{)}
\NormalTok{)}
\NormalTok{employees}
\CommentTok{\#\textgreater{} \# A tibble: 100 x 2}
\CommentTok{\#\textgreater{}   name     birthday  }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}    \textless{}date\textgreater{}    }
\CommentTok{\#\textgreater{} 1 Kemba    2022{-}01{-}22}
\CommentTok{\#\textgreater{} 2 Orean    2022{-}06{-}26}
\CommentTok{\#\textgreater{} 3 Kirstyn  2022{-}02{-}11}
\CommentTok{\#\textgreater{} 4 Amparo   2022{-}11{-}11}
\CommentTok{\#\textgreater{} 5 Belen    2022{-}03{-}25}
\CommentTok{\#\textgreater{} 6 Rayshaun 2022{-}01{-}11}
\CommentTok{\#\textgreater{} \# i 94 more rows}
\end{Highlighting}
\end{Shaded}

å¯¹äºæ¯ä¸ªå‘˜å·¥ï¼Œæˆ‘ä»¬éƒ½æƒ³æ‰¾åˆ°åœ¨ä»–ä»¬ç”Ÿæ—¥ä¹‹åï¼ˆæˆ–å½“å¤©ï¼‰çš„ç¬¬ä¸€ä¸ªæ´¾å¯¹æ—¥æœŸã€‚æˆ‘
ä»¬å¯ä»¥ç”¨æ»šåŠ¨è¿æ¥æ¥è¡¨ç¤ºè¿™ä¸€ç‚¹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{employees }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{left\_join}\NormalTok{(parties, }\FunctionTok{join\_by}\NormalTok{(}\FunctionTok{closest}\NormalTok{(birthday }\SpecialCharTok{\textgreater{}=}\NormalTok{ party)))}
\CommentTok{\#\textgreater{} \# A tibble: 100 x 4}
\CommentTok{\#\textgreater{}   name     birthday       q party     }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}    \textless{}date\textgreater{}     \textless{}int\textgreater{} \textless{}date\textgreater{}    }
\CommentTok{\#\textgreater{} 1 Kemba    2022{-}01{-}22     1 2022{-}01{-}10}
\CommentTok{\#\textgreater{} 2 Orean    2022{-}06{-}26     2 2022{-}04{-}04}
\CommentTok{\#\textgreater{} 3 Kirstyn  2022{-}02{-}11     1 2022{-}01{-}10}
\CommentTok{\#\textgreater{} 4 Amparo   2022{-}11{-}11     4 2022{-}10{-}03}
\CommentTok{\#\textgreater{} 5 Belen    2022{-}03{-}25     1 2022{-}01{-}10}
\CommentTok{\#\textgreater{} 6 Rayshaun 2022{-}01{-}11     1 2022{-}01{-}10}
\CommentTok{\#\textgreater{} \# i 94 more rows}
\end{Highlighting}
\end{Shaded}

ç„¶è€Œï¼Œè¿™ç§æ–¹æ³•å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šåœ¨1æœˆ10æ—¥ä¹‹å‰è¿‡ç”Ÿæ—¥çš„äººæ²¡æœ‰æ´¾å¯¹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{employees }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{anti\_join}\NormalTok{(parties, }\FunctionTok{join\_by}\NormalTok{(}\FunctionTok{closest}\NormalTok{(birthday }\SpecialCharTok{\textgreater{}=}\NormalTok{ party)))}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 2}
\CommentTok{\#\textgreater{}   name   birthday  }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}  \textless{}date\textgreater{}    }
\CommentTok{\#\textgreater{} 1 Maks   2022{-}01{-}07}
\CommentTok{\#\textgreater{} 2 Nalani 2022{-}01{-}04}
\end{Highlighting}
\end{Shaded}

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ä¸åŒçš„æ–¹å¼å¤„ç†å®ƒï¼Œå³ä½¿ç”¨é‡å è¿æ¥ã€‚

\subsection{é‡å è¿æ¥}\label{ux91cdux53e0ux8fdeux63a5}

é‡å è¿æ¥æä¾›äº†ä¸‰ä¸ªè¾…åŠ©å‡½æ•°ï¼Œè¿™äº›å‡½æ•°ä½¿ç”¨ä¸ç­‰å¼è¿æ¥æ¥ç®€åŒ–åŒºé—´æ“ä½œï¼š

\begin{itemize}
\tightlist
\item
  \texttt{between(x,\ y\_lower,\ y\_upper)} æ˜¯
  \texttt{x\ \textgreater{}=\ y\_lower,\ x\ \textless{}=\ y\_upper}çš„ç®€å†™ï¼›
\item
  \texttt{within(x\_lower,\ x\_upper,\ y\_lower,\ y\_upper)} æ˜¯
  \texttt{x\_lower\ \textgreater{}=\ y\_lower,\ x\_upper\ \textless{}=\ y\_upper}çš„ç®€å†™ï¼›
\item
  \texttt{overlaps(x\_lower,\ x\_upper,\ y\_lower,\ y\_upper)} æ˜¯
  \texttt{x\_lower\ \textless{}=\ y\_upper,\ x\_upper\ \textgreater{}=\ y\_lower}çš„ç®€å†™ã€‚
\end{itemize}

è®©æˆ‘ä»¬ç»§ç»­ç”Ÿæ—¥çš„ä¾‹å­ï¼Œçœ‹çœ‹å¦‚ä½•ä½¿ç”¨è¿™äº›å‡½æ•°ã€‚æˆ‘
ä»¬ä¹‹å‰ä½¿ç”¨çš„ç­–ç•¥æœ‰ä¸€ä¸ªé—®é¢˜ï¼š1æœˆ1æ—¥åˆ°9æ—¥ä¹‹é—´è¿‡ç”Ÿæ—¥çš„äººæ²¡æœ‰æ´¾å¯¹ã€‚å› 
æ­¤ï¼Œæ˜ç¡®æ¯ä¸ªæ´¾å¯¹æ¶µç›–çš„æ—¥æœŸèŒƒå›´ï¼Œå¹¶ä¸ºè¿™äº›æ—©è¿‡ç”Ÿæ—¥çš„äººè®¾ç½®ä¸€ä¸ªç‰¹æ®Šæƒ…å†µå¯èƒ½ä¼šæ›´å¥½ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{parties }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{q =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{,}
  \AttributeTok{party =} \FunctionTok{ymd}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"2022{-}01{-}10"}\NormalTok{, }\StringTok{"2022{-}04{-}04"}\NormalTok{, }\StringTok{"2022{-}07{-}11"}\NormalTok{, }\StringTok{"2022{-}10{-}03"}\NormalTok{)),}
  \AttributeTok{start =} \FunctionTok{ymd}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"2022{-}01{-}01"}\NormalTok{, }\StringTok{"2022{-}04{-}04"}\NormalTok{, }\StringTok{"2022{-}07{-}11"}\NormalTok{, }\StringTok{"2022{-}10{-}03"}\NormalTok{)),}
  \AttributeTok{end =} \FunctionTok{ymd}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"2022{-}04{-}03"}\NormalTok{, }\StringTok{"2022{-}07{-}11"}\NormalTok{, }\StringTok{"2022{-}10{-}02"}\NormalTok{, }\StringTok{"2022{-}12{-}31"}\NormalTok{))}
\NormalTok{)}
\NormalTok{parties}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 4}
\CommentTok{\#\textgreater{}       q party      start      end       }
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}date\textgreater{}     \textless{}date\textgreater{}     \textless{}date\textgreater{}    }
\CommentTok{\#\textgreater{} 1     1 2022{-}01{-}10 2022{-}01{-}01 2022{-}04{-}03}
\CommentTok{\#\textgreater{} 2     2 2022{-}04{-}04 2022{-}04{-}04 2022{-}07{-}11}
\CommentTok{\#\textgreater{} 3     3 2022{-}07{-}11 2022{-}07{-}11 2022{-}10{-}02}
\CommentTok{\#\textgreater{} 4     4 2022{-}10{-}03 2022{-}10{-}03 2022{-}12{-}31}
\end{Highlighting}
\end{Shaded}

Hadley åœ¨æ•°æ®å½•å…¥æ–¹é¢ç³Ÿç³•é€é¡¶ï¼Œå› æ­¤ä»–è¿˜æƒ³æ£€æŸ¥æ´¾å¯¹æ—¶é—´æ®µæ˜¯å¦é‡å ã€‚ä¸€
ç§æ–¹æ³•æ˜¯é€šè¿‡è‡ªè¿æ¥æ¥æ£€æŸ¥æ˜¯å¦æœ‰ä»»ä½•å¼€å§‹-ç»“æŸåŒºé—´ä¸å…¶ä»–åŒºé—´é‡å ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{parties }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{inner\_join}\NormalTok{(parties, }\FunctionTok{join\_by}\NormalTok{(}\FunctionTok{overlaps}\NormalTok{(start, end, start, end), q }\SpecialCharTok{\textless{}}\NormalTok{ q)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(start.x, end.x, start.y, end.y)}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 4}
\CommentTok{\#\textgreater{}   start.x    end.x      start.y    end.y     }
\CommentTok{\#\textgreater{}   \textless{}date\textgreater{}     \textless{}date\textgreater{}     \textless{}date\textgreater{}     \textless{}date\textgreater{}    }
\CommentTok{\#\textgreater{} 1 2022{-}04{-}04 2022{-}07{-}11 2022{-}07{-}11 2022{-}10{-}02}
\end{Highlighting}
\end{Shaded}

å“å‘€ï¼Œæœ‰é‡å çš„åŒºé—´ï¼Œè®©æˆ‘ä»¬ä¿®å¤è¿™ä¸ªé—®é¢˜å¹¶ç»§ç»­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{parties }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{q =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{,}
  \AttributeTok{party =} \FunctionTok{ymd}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"2022{-}01{-}10"}\NormalTok{, }\StringTok{"2022{-}04{-}04"}\NormalTok{, }\StringTok{"2022{-}07{-}11"}\NormalTok{, }\StringTok{"2022{-}10{-}03"}\NormalTok{)),}
  \AttributeTok{start =} \FunctionTok{ymd}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"2022{-}01{-}01"}\NormalTok{, }\StringTok{"2022{-}04{-}04"}\NormalTok{, }\StringTok{"2022{-}07{-}11"}\NormalTok{, }\StringTok{"2022{-}10{-}03"}\NormalTok{)),}
  \AttributeTok{end =} \FunctionTok{ymd}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"2022{-}04{-}03"}\NormalTok{, }\StringTok{"2022{-}07{-}10"}\NormalTok{, }\StringTok{"2022{-}10{-}02"}\NormalTok{, }\StringTok{"2022{-}12{-}31"}\NormalTok{))}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†æ¯ä¸ªå‘˜å·¥ä¸ä»–ä»¬çš„æ´¾å¯¹åŒ¹é…èµ·æ¥ã€‚è¿™
é‡Œéå¸¸é€‚åˆä½¿ç”¨\texttt{unmatched\ =\ "error"}é€‰é¡¹ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³å¿«é€Ÿæ‰¾å‡ºæ˜¯å¦æœ‰å‘˜å·¥æ²¡æœ‰è¢«åˆ†é…åˆ°æ´¾å¯¹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{employees }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{inner\_join}\NormalTok{(parties, }\FunctionTok{join\_by}\NormalTok{(}\FunctionTok{between}\NormalTok{(birthday, start, end)), }\AttributeTok{unmatched =} \StringTok{"error"}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 100 x 6}
\CommentTok{\#\textgreater{}   name     birthday       q party      start      end       }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}    \textless{}date\textgreater{}     \textless{}int\textgreater{} \textless{}date\textgreater{}     \textless{}date\textgreater{}     \textless{}date\textgreater{}    }
\CommentTok{\#\textgreater{} 1 Kemba    2022{-}01{-}22     1 2022{-}01{-}10 2022{-}01{-}01 2022{-}04{-}03}
\CommentTok{\#\textgreater{} 2 Orean    2022{-}06{-}26     2 2022{-}04{-}04 2022{-}04{-}04 2022{-}07{-}10}
\CommentTok{\#\textgreater{} 3 Kirstyn  2022{-}02{-}11     1 2022{-}01{-}10 2022{-}01{-}01 2022{-}04{-}03}
\CommentTok{\#\textgreater{} 4 Amparo   2022{-}11{-}11     4 2022{-}10{-}03 2022{-}10{-}03 2022{-}12{-}31}
\CommentTok{\#\textgreater{} 5 Belen    2022{-}03{-}25     1 2022{-}01{-}10 2022{-}01{-}01 2022{-}04{-}03}
\CommentTok{\#\textgreater{} 6 Rayshaun 2022{-}01{-}11     1 2022{-}01{-}10 2022{-}01{-}01 2022{-}04{-}03}
\CommentTok{\#\textgreater{} \# i 94 more rows}
\end{Highlighting}
\end{Shaded}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-51}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ä½ èƒ½è§£é‡Šä¸‹é¢ç­‰å€¼è¿æ¥çš„é”®æ˜¯å¦‚ä½•å·¥ä½œçš„å—ï¼Ÿå®ƒ ä»¬çš„ç»“æœä¸ºä»€ä¹ˆæ˜¯ä¸åŒçš„ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\SpecialCharTok{|\textgreater{}} \FunctionTok{full\_join}\NormalTok{(y, }\FunctionTok{join\_by}\NormalTok{(key }\SpecialCharTok{==}\NormalTok{ key))}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 3}
\CommentTok{\#\textgreater{}     key val\_x val\_y}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}chr\textgreater{} \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1     1 x1    y1   }
\CommentTok{\#\textgreater{} 2     2 x2    y2   }
\CommentTok{\#\textgreater{} 3     3 x3    \textless{}NA\textgreater{} }
\CommentTok{\#\textgreater{} 4     4 \textless{}NA\textgreater{}  y3}

\NormalTok{x }\SpecialCharTok{|\textgreater{}} \FunctionTok{full\_join}\NormalTok{(y, }\FunctionTok{join\_by}\NormalTok{(key }\SpecialCharTok{==}\NormalTok{ key), }\AttributeTok{keep =} \ConstantTok{TRUE}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 4}
\CommentTok{\#\textgreater{}   key.x val\_x key.y val\_y}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}chr\textgreater{} \textless{}dbl\textgreater{} \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1     1 x1        1 y1   }
\CommentTok{\#\textgreater{} 2     2 x2        2 y2   }
\CommentTok{\#\textgreater{} 3     3 x3       NA \textless{}NA\textgreater{} }
\CommentTok{\#\textgreater{} 4    NA \textless{}NA\textgreater{}      4 y3}
\end{Highlighting}
\end{Shaded}
\item
  åœ¨æ£€æŸ¥ä»»ä½•æ´¾å¯¹æ—¶é—´æ®µæ˜¯å¦ä¸å¦ä¸€ä¸ªæ´¾å¯¹æ—¶é—´æ®µé‡å æ—¶ï¼Œæˆ‘ä»¬åœ¨\texttt{join\_by()}ä¸­ä½¿ç”¨äº†\texttt{q\ \textless{}\ q}ã€‚ä¸º
  ä»€ä¹ˆï¼Ÿå¦‚ æœå»æ‰è¿™ä¸ªä¸ç­‰å¼ä¼šå‘ç”Ÿä»€ä¹ˆ?
\end{enumerate}

\section{å°ç»“}\label{ux5c0fux7ed3-18}

åœ¨æœ¬ç« ä¸­ï¼Œä½ å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨å˜å¼‚è¿æ¥å’Œè¿‡æ»¤è¿æ¥æ¥åˆå¹¶æ¥è‡ªä¸¤ä¸ªæ•°æ®æ¡†çš„æ•°æ®ã€‚åœ¨
æ­¤è¿‡ç¨‹ä¸­ï¼Œä½ å­¦ä¹ äº†å¦‚ä½•è¯†åˆ«é”®ï¼Œä»¥åŠä¸»é”®å’Œå¤–é”®ä¹‹é—´çš„åŒºåˆ«ã€‚ä½ 
è¿˜äº†è§£äº†è¿æ¥çš„å·¥ä½œåŸç†ï¼Œä»¥åŠå¦‚ä½•è®¡ç®—è¾“å‡ºå°†æœ‰å¤šå°‘è¡Œã€‚æœ€
åï¼Œåˆæ­¥äº†è§£äº†éç­‰å€¼è¿æ¥çš„å¼ºå¤§åŠŸèƒ½ï¼Œå¹¶çœ‹åˆ°äº†ä¸€äº›æœ‰è¶£çš„åº”ç”¨æ¡ˆä¾‹ã€‚

æœ¬ç« ç»“æŸäº†æœ¬ä¹¦``è½¬æ¢''éƒ¨åˆ†çš„å†…å®¹ï¼Œè¯¥éƒ¨åˆ†é‡ç‚¹å…³æ³¨äº†ä½ å¯ä»¥ä½¿ç”¨å•ä¸ªåˆ—å’Œtibbleçš„å·¥å…·ã€‚ä½ 
å­¦ä¹ äº†dplyrå’ŒåŸºç¡€å‡½æ•°æ¥å¤„ç†é€»è¾‘å‘é‡ã€æ•°å­—å’Œå®Œæ•´è¡¨æ ¼ï¼Œå­¦ä¹ äº†stringrå‡½æ•°æ¥å¤„ç†å­—ç¬¦ä¸²ï¼Œlubridateå‡½æ•°æ¥å¤„ç†æ—¥æœŸå’Œæ—¶é—´ï¼Œä»¥åŠforcatså‡½æ•°æ¥å¤„ç†å› å­ã€‚

åœ¨æœ¬ä¹¦çš„ä¸‹ä¸€éƒ¨åˆ†ï¼Œä½ å°†å­¦ä¹ æ›´å¤šå…³äºå¦‚ä½•å°†å„ç§ç±»å‹çš„æ•°æ®ä»¥æ•´é½çš„å½¢å¼å¯¼å…¥åˆ°Rä¸­ã€‚

\part{å¯¼å…¥}

åœ¨æœ¬ä¹¦çš„è¿™ä¸€éƒ¨åˆ†ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•å°†æ›´å¹¿æ³›çš„æ•°æ®å¯¼å…¥Rï¼Œä»¥åŠå¦‚ä½•å°†å…¶è½¬æ¢ä¸ºå¯¹åˆ†ææœ‰ç”¨çš„å½¢å¼ã€‚æœ‰
æ—¶ï¼Œè¿™åªéœ€è¦è°ƒç”¨é€‚å½“çš„æ•°æ®å¯¼å…¥åŒ…ä¸­çš„å‡½æ•°å³å¯ã€‚ä½†
åœ¨æ›´å¤æ‚çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½éœ€è¦åŒæ—¶è¿›è¡Œæ•°æ®æ•´ç†å’Œè½¬æ¢ï¼Œä»¥å¾—åˆ°ä½ æ›´å–œæ¬¢ä½¿ç”¨çš„æ•´é½çŸ©å½¢æ•°æ®ã€‚

\begin{figure}

\centering{

\includegraphics[width=5.57in,height=\textheight]{diagrams/data-science/import.png}

}

\caption{\label{fig-ds-import}Data import is the beginning of the data
science process; without data you can't do data science!}

\end{figure}%

åœ¨æœ¬ä¹¦çš„è¿™ä¸€éƒ¨åˆ†ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•è®¿é—®ä»¥ä»¥ä¸‹æ–¹å¼å­˜å‚¨çš„æ•°æ®:

\begin{itemize}
\item
  åœ¨ ç« èŠ‚~\ref{sec-import-spreadsheets}
  å­¦ä¹ å¦‚ä½•ä»Excelç”µå­è¡¨æ ¼å’ŒGoogleè¡¨æ ¼å¯¼å…¥æ•°æ®ã€‚
\item
  åœ¨ ç« èŠ‚~\ref{sec-import-databases}
  å­¦ä¹ å¦‚ä½•ä»æ•°æ®åº“ä¸­è·å–æ•°æ®å¹¶å°†å…¶å¯¼å…¥Rï¼ˆåŒæ—¶å°†å­¦ä¹ ä¸€ç‚¹å¦‚ä½•å°†æ•°æ®ä»Rå¯¼å‡ºåˆ°æ•°æ®åº“ï¼‰ã€‚
\item
  åœ¨ ç« èŠ‚~\ref{sec-arrow}
  å­¦ä¹ Arrowï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†å†…å­˜å¤–æ•°æ®çš„å¼ºå¤§å·¥å…·ï¼Œç‰¹åˆ«æ˜¯å½“æ•°æ®ä»¥Parquetæ ¼å¼å­˜å‚¨æ—¶ã€‚
\item
  åœ¨ ç« èŠ‚~\ref{sec-rectangling}
  å­¦ä¹ å¦‚ä½•å¤„ç†å±‚æ¬¡åŒ–æ•°æ®ï¼ŒåŒ…æ‹¬ç”±JSONæ ¼å¼å­˜å‚¨çš„æ•°æ®äº§ç”Ÿçš„æ·±åº¦åµŒå¥—åˆ—è¡¨ã€‚
\item
  åœ¨ ç« èŠ‚~\ref{sec-scraping}
  å­¦ä¹ ç½‘é¡µ``æŠ“å–''ï¼Œå³ä»ç½‘é¡µä¸­æå–æ•°æ®çš„è‰ºæœ¯å’Œç§‘å­¦ã€‚
\end{itemize}

è¿™é‡Œæœ‰ä¸¤ä¸ªé‡è¦çš„tidyverseåŒ…æˆ‘ä»¬æ²¡æœ‰è®¨è®ºï¼šhavenå’Œxml2ã€‚å¦‚
æœä½ æ­£åœ¨å¤„ç†SPSSã€Stataå’ŒSASæ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œè¯·æŸ¥çœ‹havenåŒ…
(\url{https://haven.tidyverse.org})ã€‚å¦‚
æœä½ æ­£åœ¨å¤„ç†XMLæ•°æ®ï¼Œè¯·æŸ¥çœ‹xml2åŒ…
(\url{https://haven.tidyverse.org})ã€‚ä¸
ç„¶ï¼Œä½ å¯èƒ½éœ€è¦è¿›è¡Œä¸€äº›ç ”ç©¶æ¥ç¡®å®šéœ€è¦ä½¿ç”¨å“ªä¸ªåŒ…ï¼›æ­¤æ—¶ï¼Œè°·æ­Œä¼šæ˜¯ä½ çš„å¾—åŠ›åŠ©æ‰‹ğŸ˜ƒã€‚

\chapter{ç”µå­è¡¨æ ¼}\label{sec-import-spreadsheets}

\section{å¼•è¨€}\label{ux5f15ux8a00-15}

åœ¨ ç« èŠ‚~\ref{sec-data-import} ï¼Œä½ å­¦ä¹ äº†å¦‚ä½•ä»çº¯æ–‡æœ¬æ–‡ä»¶
(å¦‚\texttt{.csv}å’Œ\texttt{.tsv}) ä¸­å¯¼å…¥æ•°æ®ã€‚ç°
åœ¨æ˜¯æ—¶å€™å­¦ä¹ å¦‚ä½•ä»ç”µå­è¡¨æ ¼ï¼ˆæ— è®ºæ˜¯Excelç”µå­è¡¨æ ¼è¿˜æ˜¯Googleè¡¨å•ï¼‰ä¸­æå–æ•°æ®äº†ã€‚è¿™
å°†åœ¨å¾ˆå¤§ç¨‹åº¦ä¸ŠåŸºäºä½ åœ¨ ç« èŠ‚~\ref{sec-data-import}
æ‰€å­¦çš„å†…å®¹ï¼Œä½†å½“æˆ‘ä»¬å¤„ç†æ¥è‡ªç”µå­è¡¨æ ¼çš„æ•°æ®æ—¶ï¼Œæˆ‘ä»¬è¿˜å°†è®¨è®ºå…¶ä»–è€ƒè™‘äº‹é¡¹å’Œå¤æ‚æ€§ã€‚

å¦‚æœä½ æˆ–ä½ çš„åˆä½œè€…æ­£åœ¨ä½¿ç”¨ç”µå­è¡¨æ ¼ç»„ç»‡æ•°æ®ï¼Œæˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½ é˜…è¯»Karl
Bromanå’ŒKara Wooæ’°å†™çš„è®ºæ–‡``Data Organization in
Spreadsheets''ï¼š\url{https://doi.org/10.1080/00031305.2017.1375989}ã€‚è¯¥
è®ºæ–‡ä¸­æå‡ºçš„æœ€ä½³å®è·µå°†è®©ä½ åœ¨å°†ç”µå­è¡¨æ ¼ä¸­çš„æ•°æ®å¯¼å…¥Rè¿›è¡Œåˆ†æå’Œå¯è§†åŒ–æ—¶çœå»è®¸å¤šéº»çƒ¦ã€‚

\section{Excel}\label{excel}

Microsoft Excel
æ˜¯ä¸€æ¬¾å¹¿æ³›ä½¿ç”¨çš„ç”µå­è¡¨æ ¼è½¯ä»¶ç¨‹åºï¼Œå…¶ä¸­æ•°æ®åœ¨ç”µå­è¡¨æ ¼æ–‡ä»¶å†…çš„å·¥ä½œè¡¨ä¸­ç»„ç»‡ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-15}

åœ¨æœ¬èŠ‚ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨\texttt{readxl}åŒ…åœ¨Rä¸­åŠ è½½Excelç”µå­è¡¨æ ¼ä¸­çš„æ•°æ®ã€‚è¿™
ä¸ªåŒ…ä¸æ˜¯tidyverseçš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œæ‰€ä»¥ä½ éœ€è¦æ˜ç¡®åœ°åŠ è½½å®ƒï¼Œä½†æ˜¯å½“æ‚¨å®‰è£…tidyverseåŒ…æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨å®‰è£…ã€‚ç¨
åï¼Œæˆ‘ä»¬è¿˜å°†ä½¿ç”¨\texttt{writexl}åŒ…ï¼Œå®ƒå…è®¸æˆ‘ä»¬åˆ›å»ºExcelç”µå­è¡¨æ ¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(readxl)}
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(writexl)}
\end{Highlighting}
\end{Shaded}

\subsection{å…¥é—¨}\label{ux5165ux95e8}

readxlåŒ…çš„å¤§éƒ¨åˆ†å‡½æ•°éƒ½å…è®¸ä½ å°†Excelç”µå­è¡¨æ ¼åŠ è½½åˆ°Rä¸­ï¼š

\begin{itemize}
\tightlist
\item
  \texttt{read\_xls()} ç”¨äºè¯»å–\texttt{xls}æ ¼å¼çš„Excelæ–‡ä»¶ï¼›
\item
  \texttt{read\_xlsx()} ç”¨äºè¯»å–\texttt{xlsx}æ ¼å¼çš„Excelæ–‡ä»¶ï¼›
\item
  \texttt{read\_excel()}
  å¯ä»¥è¯»å–\texttt{xls}å’Œ\texttt{xlsx}ä¸¤ç§æ ¼å¼çš„æ–‡ä»¶ï¼Œå®ƒæ ¹æ®è¾“å…¥çš„æ–‡ä»¶æ¥çŒœæµ‹æ–‡ä»¶ç±»å‹ã€‚
\end{itemize}

è¿™äº›å‡½æ•°çš„è¯­æ³•éƒ½ä¸å…¶ä»–æˆ‘ä»¬ä¹‹å‰ä»‹ç»çš„è¯»å–å…¶ä»–ç±»å‹æ–‡ä»¶çš„å‡½æ•°
(ä¾‹å¦‚\texttt{read\_csv()}ï¼Œ\texttt{read\_table()}ç­‰) ç±»ä¼¼ã€‚åœ¨
æœ¬ç« çš„å‰©ä½™éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†é‡ç‚¹ä»‹ç»\texttt{read\_excel()}å‡½æ•°ã€‚

\subsection{è¯»å–Excelç”µå­è¡¨æ ¼}\label{sec-reading-spreadsheets-excel}

å›¾~\ref{fig-students-excel}
å±•ç¤ºäº†æˆ‘ä»¬å°†è¦è¯»å…¥Rçš„Excelç”µå­è¡¨æ ¼åœ¨Excelä¸­çš„æ ·å­ã€‚è¿™
ä¸ªç”µå­è¡¨æ ¼å¯ä»¥ä»ä»¥ä¸‹é“¾æ¥ä¸‹è½½ä¸ºExcelæ–‡ä»¶ï¼š
\url{https://docs.google.com/spreadsheets/d/1V1nPp1tzOuutXFLb3G9Eyxi3qxeEhnOXUzL5_BcCQ0w/}ã€‚

\begin{figure}

\centering{

\includegraphics[width=4in,height=\textheight]{screenshots/import-spreadsheets-students.png}

}

\caption{\label{fig-students-excel}Spreadsheet called students.xlsx in
Excel.}

\end{figure}%

\texttt{read\_excel()}çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦è¯»å–çš„æ–‡ä»¶çš„è·¯å¾„ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{students }\OtherTok{\textless{}{-}} \FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/students.xlsx"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\texttt{read\_excel()}ä¼šå°†æ–‡ä»¶è¯»å–ä¸ºä¸€ä¸ª tibbleã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{students}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 5}
\CommentTok{\#\textgreater{}   \textasciigrave{}Student ID\textasciigrave{} \textasciigrave{}Full Name\textasciigrave{}      favourite.food     mealPlan            AGE  }
\CommentTok{\#\textgreater{}          \textless{}dbl\textgreater{} \textless{}chr\textgreater{}            \textless{}chr\textgreater{}              \textless{}chr\textgreater{}               \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1            1 Sunil Huffmann   Strawberry yoghurt Lunch only          4    }
\CommentTok{\#\textgreater{} 2            2 Barclay Lynn     French fries       Lunch only          5    }
\CommentTok{\#\textgreater{} 3            3 Jayendra Lyne    N/A                Breakfast and lunch 7    }
\CommentTok{\#\textgreater{} 4            4 Leon Rossini     Anchovies          Lunch only          \textless{}NA\textgreater{} }
\CommentTok{\#\textgreater{} 5            5 Chidiegwu Dunkel Pizza              Breakfast and lunch five }
\CommentTok{\#\textgreater{} 6            6 GÃ¼venÃ§ Attila    Ice cream          Lunch only          6}
\end{Highlighting}
\end{Shaded}

æ•°æ®ä¸­æœ‰å…­åå­¦ç”Ÿï¼Œæ¯ä¸ªå­¦ç”Ÿæœ‰äº”ä¸ªå˜é‡ã€‚ä½†
æ˜¯ï¼Œåœ¨è¿™ä¸ªæ•°æ®é›†ä¸­æˆ‘ä»¬å¯èƒ½éœ€è¦è§£å†³å‡ ä¸ªé—®é¢˜ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  åˆ—åéå¸¸æ··ä¹±ã€‚ä½ 
  å¯ä»¥æä¾›éµå¾ªä¸€è‡´æ ¼å¼çš„åˆ—åï¼›æˆ‘ä»¬æ¨èä½¿ç”¨\texttt{col\_names}å‚æ•°å¹¶éµå¾ª\texttt{snake\_case}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{read\_excel}\NormalTok{(}
  \StringTok{"data/students.xlsx"}\NormalTok{,}
  \AttributeTok{col\_names =} \FunctionTok{c}\NormalTok{(}\StringTok{"student\_id"}\NormalTok{, }\StringTok{"full\_name"}\NormalTok{, }\StringTok{"favourite\_food"}\NormalTok{, }\StringTok{"meal\_plan"}\NormalTok{, }\StringTok{"age"}\NormalTok{)}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 7 x 5}
\CommentTok{\#\textgreater{}   student\_id full\_name        favourite\_food     meal\_plan           age  }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}      \textless{}chr\textgreater{}            \textless{}chr\textgreater{}              \textless{}chr\textgreater{}               \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 Student ID Full Name        favourite.food     mealPlan            AGE  }
\CommentTok{\#\textgreater{} 2 1          Sunil Huffmann   Strawberry yoghurt Lunch only          4    }
\CommentTok{\#\textgreater{} 3 2          Barclay Lynn     French fries       Lunch only          5    }
\CommentTok{\#\textgreater{} 4 3          Jayendra Lyne    N/A                Breakfast and lunch 7    }
\CommentTok{\#\textgreater{} 5 4          Leon Rossini     Anchovies          Lunch only          \textless{}NA\textgreater{} }
\CommentTok{\#\textgreater{} 6 5          Chidiegwu Dunkel Pizza              Breakfast and lunch five }
\CommentTok{\#\textgreater{} 7 6          GÃ¼venÃ§ Attila    Ice cream          Lunch only          6}
\end{Highlighting}
\end{Shaded}

  ä¸å¹¸çš„æ˜¯ï¼Œè¿™å¹¶ä¸å®Œå…¨å¥æ•ˆã€‚æˆ‘
  ä»¬ç°åœ¨æœ‰äº†æƒ³è¦çš„å˜é‡åï¼Œä½†æ˜¯ä¹‹å‰ä½œä¸ºè¡¨å¤´çš„è¡Œç°åœ¨æ˜¾ç¤ºä¸ºæ•°æ®ä¸­çš„ç¬¬ä¸€è¡Œè§‚æµ‹å€¼ã€‚ä½ 
  å¯ä»¥ä½¿ç”¨\texttt{skip}å‚æ•°æ¥æ˜ç¡®è·³è¿‡é‚£ä¸€è¡Œã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{read\_excel}\NormalTok{(}
  \StringTok{"data/students.xlsx"}\NormalTok{,}
  \AttributeTok{col\_names =} \FunctionTok{c}\NormalTok{(}\StringTok{"student\_id"}\NormalTok{, }\StringTok{"full\_name"}\NormalTok{, }\StringTok{"favourite\_food"}\NormalTok{, }\StringTok{"meal\_plan"}\NormalTok{, }\StringTok{"age"}\NormalTok{),}
  \AttributeTok{skip =} \DecValTok{1}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 5}
\CommentTok{\#\textgreater{}   student\_id full\_name        favourite\_food     meal\_plan           age  }
\CommentTok{\#\textgreater{}        \textless{}dbl\textgreater{} \textless{}chr\textgreater{}            \textless{}chr\textgreater{}              \textless{}chr\textgreater{}               \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1          1 Sunil Huffmann   Strawberry yoghurt Lunch only          4    }
\CommentTok{\#\textgreater{} 2          2 Barclay Lynn     French fries       Lunch only          5    }
\CommentTok{\#\textgreater{} 3          3 Jayendra Lyne    N/A                Breakfast and lunch 7    }
\CommentTok{\#\textgreater{} 4          4 Leon Rossini     Anchovies          Lunch only          \textless{}NA\textgreater{} }
\CommentTok{\#\textgreater{} 5          5 Chidiegwu Dunkel Pizza              Breakfast and lunch five }
\CommentTok{\#\textgreater{} 6          6 GÃ¼venÃ§ Attila    Ice cream          Lunch only          6}
\end{Highlighting}
\end{Shaded}
\item
  åœ¨\texttt{favourite\_food}åˆ—ä¸­ï¼Œå…¶ä¸­ä¸€ä¸ªè§‚æµ‹å€¼æ˜¯\texttt{N/A}ï¼Œå®ƒä»£è¡¨``ä¸å¯ç”¨''ï¼Œä½†å½“å‰å®ƒå¹¶æ²¡æœ‰è¢«è¯†åˆ«ä¸º\texttt{NA}ï¼ˆè¯·æ³¨æ„è¿™ä¸ª\texttt{N/A}å’Œåˆ—è¡¨ä¸­ç¬¬å››ä¸ªå­¦ç”Ÿçš„å¹´é¾„ä¸­çš„\texttt{NA}æ˜¯ä¸åŒçš„ï¼‰ã€‚ä½ 
  å¯ä»¥ä½¿ç”¨\texttt{na}å‚æ•°æ¥æŒ‡å®šå“ªäº›å­—ç¬¦ä¸²åº”è¯¥è¢«è¯†åˆ«ä¸º\texttt{NA}ã€‚é»˜
  è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰\texttt{""}ï¼ˆç©ºå­—ç¬¦ä¸²ï¼Œæˆ–è€…åœ¨ä»ç”µå­è¡¨æ ¼ä¸­è¯»å–æ•°æ®æ—¶ä¸€ä¸ªç©ºå•å…ƒæ ¼æˆ–è€…ä¸€ä¸ªåŒ…å«å…¬å¼\texttt{=NA()}çš„å•å…ƒæ ¼ï¼‰ä¼šè¢«è¯†åˆ«ä¸º\texttt{NA}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{read\_excel}\NormalTok{(}
  \StringTok{"data/students.xlsx"}\NormalTok{,}
  \AttributeTok{col\_names =} \FunctionTok{c}\NormalTok{(}\StringTok{"student\_id"}\NormalTok{, }\StringTok{"full\_name"}\NormalTok{, }\StringTok{"favourite\_food"}\NormalTok{, }\StringTok{"meal\_plan"}\NormalTok{, }\StringTok{"age"}\NormalTok{),}
  \AttributeTok{skip =} \DecValTok{1}\NormalTok{,}
  \AttributeTok{na =} \FunctionTok{c}\NormalTok{(}\StringTok{""}\NormalTok{, }\StringTok{"N/A"}\NormalTok{)}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 5}
\CommentTok{\#\textgreater{}   student\_id full\_name        favourite\_food     meal\_plan           age  }
\CommentTok{\#\textgreater{}        \textless{}dbl\textgreater{} \textless{}chr\textgreater{}            \textless{}chr\textgreater{}              \textless{}chr\textgreater{}               \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1          1 Sunil Huffmann   Strawberry yoghurt Lunch only          4    }
\CommentTok{\#\textgreater{} 2          2 Barclay Lynn     French fries       Lunch only          5    }
\CommentTok{\#\textgreater{} 3          3 Jayendra Lyne    \textless{}NA\textgreater{}               Breakfast and lunch 7    }
\CommentTok{\#\textgreater{} 4          4 Leon Rossini     Anchovies          Lunch only          \textless{}NA\textgreater{} }
\CommentTok{\#\textgreater{} 5          5 Chidiegwu Dunkel Pizza              Breakfast and lunch five }
\CommentTok{\#\textgreater{} 6          6 GÃ¼venÃ§ Attila    Ice cream          Lunch only          6}
\end{Highlighting}
\end{Shaded}
\item
  å¦ä¸€ä¸ªå¾…è§£å†³çš„é—®é¢˜æ˜¯ï¼Œ\texttt{age}è¢«è¯»å–ä¸ºå­—ç¬¦å˜é‡ï¼Œä½†å®é™…ä¸Šå®ƒåº”è¯¥æ˜¯æ•°å€¼å‹çš„ã€‚å°±
  åƒä½¿ç”¨\texttt{read\_csv()}å’Œå®ƒçš„ç›¸å…³å‡½æ•°ä»å¹³é¢æ–‡ä»¶ä¸­è¯»å–æ•°æ®ä¸€æ ·ï¼Œä½ å¯ä»¥ä¸º\texttt{read\_excel()}æä¾›ä¸€ä¸ª\texttt{col\_types}å‚æ•°ï¼Œå¹¶æŒ‡å®šä½ è¯»å–çš„å˜é‡çš„åˆ—ç±»å‹ã€‚ä¸
  è¿‡ï¼Œè¯­æ³•æœ‰ç‚¹ä¸åŒï¼Œé€‰é¡¹æœ‰\texttt{"skip"}ã€\texttt{"guess"}ã€\texttt{"logical"}ã€\texttt{"numeric"}ã€\texttt{"date"}ã€\texttt{"text"}æˆ–\texttt{"list"}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{read\_excel}\NormalTok{(}
  \StringTok{"data/students.xlsx"}\NormalTok{,}
  \AttributeTok{col\_names =} \FunctionTok{c}\NormalTok{(}\StringTok{"student\_id"}\NormalTok{, }\StringTok{"full\_name"}\NormalTok{, }\StringTok{"favourite\_food"}\NormalTok{, }\StringTok{"meal\_plan"}\NormalTok{, }\StringTok{"age"}\NormalTok{),}
  \AttributeTok{skip =} \DecValTok{1}\NormalTok{,}
  \AttributeTok{na =} \FunctionTok{c}\NormalTok{(}\StringTok{""}\NormalTok{, }\StringTok{"N/A"}\NormalTok{),}
  \AttributeTok{col\_types =} \FunctionTok{c}\NormalTok{(}\StringTok{"numeric"}\NormalTok{, }\StringTok{"text"}\NormalTok{, }\StringTok{"text"}\NormalTok{, }\StringTok{"text"}\NormalTok{, }\StringTok{"numeric"}\NormalTok{)}
\NormalTok{)}
\CommentTok{\#\textgreater{} Warning: Expecting numeric in E6 / R6C5: got \textquotesingle{}five\textquotesingle{}}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 5}
\CommentTok{\#\textgreater{}   student\_id full\_name        favourite\_food     meal\_plan             age}
\CommentTok{\#\textgreater{}        \textless{}dbl\textgreater{} \textless{}chr\textgreater{}            \textless{}chr\textgreater{}              \textless{}chr\textgreater{}               \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1          1 Sunil Huffmann   Strawberry yoghurt Lunch only              4}
\CommentTok{\#\textgreater{} 2          2 Barclay Lynn     French fries       Lunch only              5}
\CommentTok{\#\textgreater{} 3          3 Jayendra Lyne    \textless{}NA\textgreater{}               Breakfast and lunch     7}
\CommentTok{\#\textgreater{} 4          4 Leon Rossini     Anchovies          Lunch only             NA}
\CommentTok{\#\textgreater{} 5          5 Chidiegwu Dunkel Pizza              Breakfast and lunch    NA}
\CommentTok{\#\textgreater{} 6          6 GÃ¼venÃ§ Attila    Ice cream          Lunch only              6}
\end{Highlighting}
\end{Shaded}

  ç„¶è€Œï¼Œè¿™ä¹Ÿæ²¡æœ‰äº§ç”ŸæœŸæœ›çš„ç»“æœã€‚é€š
  è¿‡æŒ‡å®š\texttt{age}åº”è¯¥æ˜¯æ•°å€¼å‹çš„ï¼Œæˆ‘ä»¬å·²ç»å°†åŒ…å«éæ•°å€¼æ¡ç›®ï¼ˆå…¶å€¼ä¸ºfiveï¼‰çš„å•å…ƒæ ¼è½¬æ¢æˆäº†\texttt{NA}ã€‚åœ¨
  è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥å°†å¹´é¾„è¯»å–ä¸º\texttt{"text"}ç±»å‹ï¼Œç„¶ååœ¨æ•°æ®åŠ è½½åˆ°Rä¸­åå†è¿›è¡Œæ›´æ”¹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{students }\OtherTok{\textless{}{-}} \FunctionTok{read\_excel}\NormalTok{(}
  \StringTok{"data/students.xlsx"}\NormalTok{,}
  \AttributeTok{col\_names =} \FunctionTok{c}\NormalTok{(}\StringTok{"student\_id"}\NormalTok{, }\StringTok{"full\_name"}\NormalTok{, }\StringTok{"favourite\_food"}\NormalTok{, }\StringTok{"meal\_plan"}\NormalTok{, }\StringTok{"age"}\NormalTok{),}
  \AttributeTok{skip =} \DecValTok{1}\NormalTok{,}
  \AttributeTok{na =} \FunctionTok{c}\NormalTok{(}\StringTok{""}\NormalTok{, }\StringTok{"N/A"}\NormalTok{),}
  \AttributeTok{col\_types =} \FunctionTok{c}\NormalTok{(}\StringTok{"numeric"}\NormalTok{, }\StringTok{"text"}\NormalTok{, }\StringTok{"text"}\NormalTok{, }\StringTok{"text"}\NormalTok{, }\StringTok{"text"}\NormalTok{)}
\NormalTok{)}

\NormalTok{students }\OtherTok{\textless{}{-}}\NormalTok{ students }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{age =} \FunctionTok{if\_else}\NormalTok{(age }\SpecialCharTok{==} \StringTok{"five"}\NormalTok{, }\StringTok{"5"}\NormalTok{, age),}
    \AttributeTok{age =} \FunctionTok{parse\_number}\NormalTok{(age)}
\NormalTok{  )}

\NormalTok{students}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 5}
\CommentTok{\#\textgreater{}   student\_id full\_name        favourite\_food     meal\_plan             age}
\CommentTok{\#\textgreater{}        \textless{}dbl\textgreater{} \textless{}chr\textgreater{}            \textless{}chr\textgreater{}              \textless{}chr\textgreater{}               \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1          1 Sunil Huffmann   Strawberry yoghurt Lunch only              4}
\CommentTok{\#\textgreater{} 2          2 Barclay Lynn     French fries       Lunch only              5}
\CommentTok{\#\textgreater{} 3          3 Jayendra Lyne    \textless{}NA\textgreater{}               Breakfast and lunch     7}
\CommentTok{\#\textgreater{} 4          4 Leon Rossini     Anchovies          Lunch only             NA}
\CommentTok{\#\textgreater{} 5          5 Chidiegwu Dunkel Pizza              Breakfast and lunch     5}
\CommentTok{\#\textgreater{} 6          6 GÃ¼venÃ§ Attila    Ice cream          Lunch only              6}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

åŠ è½½æ•°æ®ä»¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç²¾ç¡®æ ¼å¼éœ€è¦å¤šä¸ªæ­¥éª¤å’Œåå¤å°è¯•ï¼Œè¿™å¹¶ä¸æ„å¤–ã€‚æ•°
æ®ç§‘å­¦æ˜¯ä¸€ä¸ªè¿­ä»£çš„è¿‡ç¨‹ï¼Œè€Œä¸å…¶ä»–çº¯æ–‡æœ¬ã€çŸ©å½¢æ•°æ®æ–‡ä»¶ç›¸æ¯”ï¼Œä»ç”µå­è¡¨æ ¼ä¸­è¯»å–æ•°æ®æ—¶çš„è¿­ä»£è¿‡ç¨‹å¯èƒ½æ›´åŠ ç¹çï¼Œå› ä¸ºäººç±»å€¾å‘äºå°†æ•°æ®è¾“å…¥åˆ°ç”µå­è¡¨æ ¼ä¸­ï¼Œå¹¶ä¸ä»…ä»…ç”¨äºæ•°æ®å­˜å‚¨ï¼Œè¿˜ç”¨äºå…±äº«å’Œäº¤æµã€‚

åœ¨åŠ è½½æ•°æ®å¹¶æŸ¥çœ‹ä¹‹å‰ï¼Œæˆ‘ä»¬æ— æ³•ç¡®åˆ‡çŸ¥é“æ•°æ®å°†æ˜¯ä»€ä¹ˆæ ·å­ã€‚ä¸
è¿‡ï¼Œå®é™…ä¸Šè¿˜æ˜¯æœ‰ä¸€ç§æ–¹æ³•çš„ã€‚ä½  å¯ä»¥åœ¨Excelä¸­æ‰“å¼€æ–‡ä»¶å¹¶æŸ¥çœ‹ã€‚å¦‚
æœä½ æ‰“ç®—è¿™æ ·åšï¼Œæˆ‘ä»¬å»ºè®®ä½ å¤åˆ¶Excelæ–‡ä»¶ä»¥è¿›è¡Œäº¤äº’å¼æ‰“å¼€å’Œæµè§ˆï¼ŒåŒæ—¶ä¿æŒåŸå§‹æ•°æ®æ–‡ä»¶ä¸å˜ï¼Œå¹¶ä»åŸå§‹æ–‡ä»¶ä¸­è¯»å–åˆ°Rä¸­ã€‚è¿™
å°†ç¡®ä¿ä½ åœ¨æ£€æŸ¥æ•°æ®æ—¶ä¸ä¼šæ„å¤–åœ°è¦†ç›–ç”µå­è¡¨æ ¼ä¸­çš„ä»»ä½•å†…å®¹ã€‚ä½ 
ä¹Ÿä¸åº”è¯¥å®³æ€•åƒæˆ‘ä»¬è¿™æ ·åšï¼šåŠ è½½æ•°æ®ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ï¼Œè°ƒæ•´ä½ çš„ä»£ç ï¼Œå†æ¬¡åŠ è½½ï¼Œé‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°ä½ å¯¹ç»“æœæ»¡æ„ä¸ºæ­¢ã€‚

\subsection{è¯»å–å·¥ä½œè¡¨}\label{ux8bfbux53d6ux5de5ux4f5cux8868}

ç”µå­è¡¨æ ¼ä¸å¹³é¢æ–‡ä»¶ä¹‹é—´çš„ä¸€ä¸ªé‡è¦åŒºåˆ«åœ¨äºç”µå­è¡¨æ ¼æœ‰å¤šä¸ªè¡¨å•ï¼Œè¿™äº›è¡¨å•è¢«ç§°ä¸ºå·¥ä½œè¡¨ã€‚@
fig-penguins-islands æ˜¾ç¤ºäº†ä¸€ä¸ªåŒ…å«å¤šä¸ªå·¥ä½œè¡¨çš„Excelç”µå­è¡¨æ ¼ã€‚è¿™
äº›æ•°æ®æ¥è‡ª\textbf{palmerpenguins}åŒ…ï¼Œä½ å¯ä»¥ä»
\hyperref[0]{https://docs.google.com/spreadsheets/d/1aFu8lnD\_g0yjF5O-K6SFgSEWiHPpgvFCF0NY9D6LXnY/}
ä¸‹è½½è¿™ä¸ªç”µå­è¡¨æ ¼ä½œä¸ºExcelæ–‡ä»¶ã€‚æ¯
ä¸ªå·¥ä½œè¡¨éƒ½åŒ…å«äº†ä»ä¸åŒå²›å±¿æ”¶é›†åˆ°çš„ä¼é¹…ä¿¡æ¯ã€‚

\begin{figure}

\centering{

\includegraphics[width=5.05in,height=\textheight]{screenshots/import-spreadsheets-penguins-islands.png}

}

\caption{\label{fig-penguins-islands}Spreadsheet called penguins.xlsx in
Excel containing three worksheets.}

\end{figure}%

ä½ å¯ä»¥åˆ©ç”¨\texttt{read\_excel()}ä¸­çš„\texttt{sheet}å‚æ•°ä»ç”µå­è¡¨æ ¼ä¸­è¯»å–å•ä¸ªå·¥ä½œè¡¨ã€‚åˆ°
ç›®å‰ä¸ºæ­¢ï¼Œé»˜è®¤å€¼æ˜¯ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/penguins.xlsx"}\NormalTok{, }\AttributeTok{sheet =} \StringTok{"Torgersen Island"}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 52 x 8}
\CommentTok{\#\textgreater{}   species island    bill\_length\_mm     bill\_depth\_mm      flipper\_length\_mm}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}   \textless{}chr\textgreater{}     \textless{}chr\textgreater{}              \textless{}chr\textgreater{}              \textless{}chr\textgreater{}            }
\CommentTok{\#\textgreater{} 1 Adelie  Torgersen 39.1               18.7               181              }
\CommentTok{\#\textgreater{} 2 Adelie  Torgersen 39.5               17.399999999999999 186              }
\CommentTok{\#\textgreater{} 3 Adelie  Torgersen 40.299999999999997 18                 195              }
\CommentTok{\#\textgreater{} 4 Adelie  Torgersen NA                 NA                 NA               }
\CommentTok{\#\textgreater{} 5 Adelie  Torgersen 36.700000000000003 19.3               193              }
\CommentTok{\#\textgreater{} 6 Adelie  Torgersen 39.299999999999997 20.6               190              }
\CommentTok{\#\textgreater{} \# i 46 more rows}
\CommentTok{\#\textgreater{} \# i 3 more variables: body\_mass\_g \textless{}chr\textgreater{}, sex \textless{}chr\textgreater{}, year \textless{}dbl\textgreater{}}
\end{Highlighting}
\end{Shaded}

ç”±äºå­—ç¬¦ä¸² \texttt{"NA"} æ²¡æœ‰è¢«è¯†åˆ«ä¸ºçœŸæ­£çš„
\texttt{NA}ï¼ˆç¼ºå¤±å€¼ï¼‰ï¼Œä¸€äº›çœ‹èµ·æ¥åŒ…å«æ•°å€¼æ•°æ®çš„å˜é‡è¢«è¯»å–ä¸ºå­—ç¬¦ç±»å‹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins\_torgersen }\OtherTok{\textless{}{-}} \FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/penguins.xlsx"}\NormalTok{, }\AttributeTok{sheet =} \StringTok{"Torgersen Island"}\NormalTok{, }\AttributeTok{na =} \StringTok{"NA"}\NormalTok{)}

\NormalTok{penguins\_torgersen}
\CommentTok{\#\textgreater{} \# A tibble: 52 x 8}
\CommentTok{\#\textgreater{}   species island    bill\_length\_mm bill\_depth\_mm flipper\_length\_mm}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}   \textless{}chr\textgreater{}              \textless{}dbl\textgreater{}         \textless{}dbl\textgreater{}             \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 Adelie  Torgersen           39.1          18.7               181}
\CommentTok{\#\textgreater{} 2 Adelie  Torgersen           39.5          17.4               186}
\CommentTok{\#\textgreater{} 3 Adelie  Torgersen           40.3          18                 195}
\CommentTok{\#\textgreater{} 4 Adelie  Torgersen           NA            NA                  NA}
\CommentTok{\#\textgreater{} 5 Adelie  Torgersen           36.7          19.3               193}
\CommentTok{\#\textgreater{} 6 Adelie  Torgersen           39.3          20.6               190}
\CommentTok{\#\textgreater{} \# i 46 more rows}
\CommentTok{\#\textgreater{} \# i 3 more variables: body\_mass\_g \textless{}dbl\textgreater{}, sex \textless{}chr\textgreater{}, year \textless{}dbl\textgreater{}}
\end{Highlighting}
\end{Shaded}

æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨\texttt{excel\_sheets()}æ¥è·å– Excel
ç”µå­è¡¨æ ¼ä¸­æ‰€æœ‰å·¥ä½œè¡¨çš„ä¿¡æ¯ï¼Œç„¶åè¯»å–ä½ æ„Ÿå…´è¶£çš„ä¸€ä¸ªæˆ–å¤šä¸ªå·¥ä½œè¡¨ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{excel\_sheets}\NormalTok{(}\StringTok{"data/penguins.xlsx"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "Torgersen Island" "Biscoe Island"    "Dream Island"}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ çŸ¥é“å·¥ä½œè¡¨çš„åç§°ï¼Œå¯ä»¥ä½¿ç”¨\texttt{read\_excel()}å‡½æ•°å•ç‹¬è¯»å–å®ƒä»¬ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins\_biscoe }\OtherTok{\textless{}{-}} \FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/penguins.xlsx"}\NormalTok{, }\AttributeTok{sheet =} \StringTok{"Biscoe Island"}\NormalTok{, }\AttributeTok{na =} \StringTok{"NA"}\NormalTok{)}
\NormalTok{penguins\_dream  }\OtherTok{\textless{}{-}} \FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/penguins.xlsx"}\NormalTok{, }\AttributeTok{sheet =} \StringTok{"Dream Island"}\NormalTok{, }\AttributeTok{na =} \StringTok{"NA"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®Œæ•´çš„ä¼é¹…æ•°æ®é›†åˆ†å¸ƒåœ¨ç”µå­è¡¨æ ¼çš„ä¸‰ä¸ªå·¥ä½œè¡¨ä¸­ã€‚æ¯
ä¸ªå·¥ä½œè¡¨éƒ½æœ‰ç›¸åŒæ•°é‡çš„åˆ—ï¼Œä½†è¡Œæ•°ä¸åŒã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dim}\NormalTok{(penguins\_torgersen)}
\CommentTok{\#\textgreater{} [1] 52  8}
\FunctionTok{dim}\NormalTok{(penguins\_biscoe)}
\CommentTok{\#\textgreater{} [1] 168   8}
\FunctionTok{dim}\NormalTok{(penguins\_dream)}
\CommentTok{\#\textgreater{} [1] 124   8}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{bind\_rows()}å°†å®ƒä»¬æ”¾åœ¨ä¸€èµ·ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{penguins }\OtherTok{\textless{}{-}} \FunctionTok{bind\_rows}\NormalTok{(penguins\_torgersen, penguins\_biscoe, penguins\_dream)}
\NormalTok{penguins}
\CommentTok{\#\textgreater{} \# A tibble: 344 x 8}
\CommentTok{\#\textgreater{}   species island    bill\_length\_mm bill\_depth\_mm flipper\_length\_mm}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}   \textless{}chr\textgreater{}              \textless{}dbl\textgreater{}         \textless{}dbl\textgreater{}             \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 Adelie  Torgersen           39.1          18.7               181}
\CommentTok{\#\textgreater{} 2 Adelie  Torgersen           39.5          17.4               186}
\CommentTok{\#\textgreater{} 3 Adelie  Torgersen           40.3          18                 195}
\CommentTok{\#\textgreater{} 4 Adelie  Torgersen           NA            NA                  NA}
\CommentTok{\#\textgreater{} 5 Adelie  Torgersen           36.7          19.3               193}
\CommentTok{\#\textgreater{} 6 Adelie  Torgersen           39.3          20.6               190}
\CommentTok{\#\textgreater{} \# i 338 more rows}
\CommentTok{\#\textgreater{} \# i 3 more variables: body\_mass\_g \textless{}dbl\textgreater{}, sex \textless{}chr\textgreater{}, year \textless{}dbl\textgreater{}}
\end{Highlighting}
\end{Shaded}

åœ¨ ç« èŠ‚~\ref{sec-iteration}
ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºåœ¨ä¸é‡å¤ä»£ç çš„æƒ…å†µä¸‹å®Œæˆè¿™ç±»ä»»åŠ¡çš„æ–¹æ³•ã€‚

\subsection{è¯»å–éƒ¨åˆ†å·¥ä½œè¡¨}\label{ux8bfbux53d6ux90e8ux5206ux5de5ux4f5cux8868}

ç”±äºå¾ˆå¤šäººä½¿ç”¨ Excel
ç”µå­è¡¨æ ¼è¿›è¡Œå±•ç¤ºä»¥åŠæ•°æ®å­˜å‚¨ï¼Œå› æ­¤ç»å¸¸ä¼šåœ¨ç”µå­è¡¨æ ¼ä¸­æ‰¾åˆ°ä¸å±äºä½ æƒ³è¦è¯»å…¥
R çš„æ•°æ®çš„å•å…ƒæ ¼æ¡ç›®ã€‚@ fig-deaths-excel
å±•ç¤ºäº†è¿™æ ·ä¸€ä¸ªç”µå­è¡¨æ ¼ï¼šåœ¨è¡¨æ ¼ä¸­é—´æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°æ®æ¡†çš„å†…å®¹ï¼Œä½†åœ¨æ•°æ®çš„ä¸Šæ–¹å’Œä¸‹æ–¹æœ‰ä¸€äº›é¢å¤–çš„æ–‡æœ¬å•å…ƒæ ¼ã€‚

\begin{figure}

\centering{

\includegraphics[width=5.38in,height=\textheight]{screenshots/import-spreadsheets-deaths.png}

}

\caption{\label{fig-deaths-excel}Spreadsheet called deaths.xlsx in
Excel.}

\end{figure}%

è¿™ä¸ªç”µå­è¡¨æ ¼æ˜¯ readxl åŒ…æä¾›çš„ä¸€ä¸ªç¤ºä¾‹ç”µå­è¡¨æ ¼ã€‚ä½ 
å¯ä»¥ä½¿ç”¨\texttt{readxl\_example()}å‡½æ•°æ¥å®šä½è¿™ä¸ªç”µå­è¡¨æ ¼åœ¨ä½ ç³»ç»Ÿä¸Šå®‰è£…è¯¥åŒ…çš„ç›®å½•ä¸­çš„ä½ç½®ã€‚è¿™
ä¸ªå‡½æ•°ä¼šè¿”å›ç”µå­è¡¨æ ¼çš„è·¯å¾„ï¼Œä½ å¯ä»¥åƒå¹³å¸¸ä¸€æ ·åœ¨\texttt{read\_excel()}ä¸­ä½¿ç”¨å®ƒã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{deaths\_path }\OtherTok{\textless{}{-}} \FunctionTok{readxl\_example}\NormalTok{(}\StringTok{"deaths.xlsx"}\NormalTok{)}
\NormalTok{deaths }\OtherTok{\textless{}{-}} \FunctionTok{read\_excel}\NormalTok{(deaths\_path)}
\CommentTok{\#\textgreater{} New names:}
\CommentTok{\#\textgreater{} * \textasciigrave{}\textasciigrave{} {-}\textgreater{} \textasciigrave{}...2\textasciigrave{}}
\CommentTok{\#\textgreater{} * \textasciigrave{}\textasciigrave{} {-}\textgreater{} \textasciigrave{}...3\textasciigrave{}}
\CommentTok{\#\textgreater{} * \textasciigrave{}\textasciigrave{} {-}\textgreater{} \textasciigrave{}...4\textasciigrave{}}
\CommentTok{\#\textgreater{} * \textasciigrave{}\textasciigrave{} {-}\textgreater{} \textasciigrave{}...5\textasciigrave{}}
\CommentTok{\#\textgreater{} * \textasciigrave{}\textasciigrave{} {-}\textgreater{} \textasciigrave{}...6\textasciigrave{}}
\NormalTok{deaths}
\CommentTok{\#\textgreater{} \# A tibble: 18 x 6}
\CommentTok{\#\textgreater{}   \textasciigrave{}Lots of people\textasciigrave{}    ...2       ...3  ...4     ...5          ...6           }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}               \textless{}chr\textgreater{}      \textless{}chr\textgreater{} \textless{}chr\textgreater{}    \textless{}chr\textgreater{}         \textless{}chr\textgreater{}          }
\CommentTok{\#\textgreater{} 1 simply cannot resi\textasciitilde{} \textless{}NA\textgreater{}       \textless{}NA\textgreater{}  \textless{}NA\textgreater{}     \textless{}NA\textgreater{}          some notes     }
\CommentTok{\#\textgreater{} 2 at                  the        top   \textless{}NA\textgreater{}     of            their spreadsh\textasciitilde{}}
\CommentTok{\#\textgreater{} 3 or                  merging    \textless{}NA\textgreater{}  \textless{}NA\textgreater{}     \textless{}NA\textgreater{}          cells          }
\CommentTok{\#\textgreater{} 4 Name                Profession Age   Has kids Date of birth Date of death  }
\CommentTok{\#\textgreater{} 5 David Bowie         musician   69    TRUE     17175         42379          }
\CommentTok{\#\textgreater{} 6 Carrie Fisher       actor      60    TRUE     20749         42731          }
\CommentTok{\#\textgreater{} \# i 12 more rows}
\end{Highlighting}
\end{Shaded}

å‰ä¸‰è¡Œå’Œæœ€åå››è¡Œä¸å±äºæ•°æ®æ¡†ã€‚è™½
ç„¶å¯ä»¥ä½¿ç”¨\texttt{skip}å’Œ\texttt{n\_max}å‚æ•°æ¥æ¶ˆé™¤è¿™äº›å¤šä½™çš„è¡Œï¼Œä½†æˆ‘ä»¬å»ºè®®ä½¿ç”¨å•å…ƒæ ¼èŒƒå›´ã€‚åœ¨
Excel ä¸­ï¼Œå·¦ä¸Šè§’çš„å•å…ƒæ ¼æ˜¯ A1ã€‚å½“
ä½ å‘å³ç§»åŠ¨åˆ°å…¶ä»–åˆ—æ—¶ï¼Œå•å…ƒæ ¼æ ‡ç­¾ä¼šæŒ‰ç…§å­—æ¯é¡ºåºå‘ä¸‹ç§»åŠ¨ï¼Œå³ B1ã€C1 ç­‰ã€‚å½“
ä½ å‘ä¸‹ç§»åŠ¨åˆ°ä¸€ä¸ªåˆ—æ—¶ï¼Œå•å…ƒæ ¼æ ‡ç­¾ä¸­çš„æ•°å­—ä¼šå¢åŠ ï¼Œå³ A2ã€A3 ç­‰ã€‚

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æƒ³è¦è¯»å–çš„æ•°æ®ä» A5 å•å…ƒæ ¼å¼€å§‹ï¼Œåˆ° F15 å•å…ƒæ ¼ç»“æŸã€‚åœ¨
ç”µå­è¡¨æ ¼è¡¨ç¤ºæ³•ä¸­ï¼Œè¿™æ˜¯ A5:F15ï¼Œæˆ‘ä»¬å°†å®ƒæä¾›ç»™\texttt{range}å‚æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{read\_excel}\NormalTok{(deaths\_path, }\AttributeTok{range =} \StringTok{"A5:F15"}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 10 x 6}
\CommentTok{\#\textgreater{}   Name          Profession   Age \textasciigrave{}Has kids\textasciigrave{} \textasciigrave{}Date of birth\textasciigrave{}    }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}         \textless{}chr\textgreater{}      \textless{}dbl\textgreater{} \textless{}lgl\textgreater{}      \textless{}dttm\textgreater{}             }
\CommentTok{\#\textgreater{} 1 David Bowie   musician      69 TRUE       1947{-}01{-}08 00:00:00}
\CommentTok{\#\textgreater{} 2 Carrie Fisher actor         60 TRUE       1956{-}10{-}21 00:00:00}
\CommentTok{\#\textgreater{} 3 Chuck Berry   musician      90 TRUE       1926{-}10{-}18 00:00:00}
\CommentTok{\#\textgreater{} 4 Bill Paxton   actor         61 TRUE       1955{-}05{-}17 00:00:00}
\CommentTok{\#\textgreater{} 5 Prince        musician      57 TRUE       1958{-}06{-}07 00:00:00}
\CommentTok{\#\textgreater{} 6 Alan Rickman  actor         69 FALSE      1946{-}02{-}21 00:00:00}
\CommentTok{\#\textgreater{} \# i 4 more rows}
\CommentTok{\#\textgreater{} \# i 1 more variable: \textasciigrave{}Date of death\textasciigrave{} \textless{}dttm\textgreater{}}
\end{Highlighting}
\end{Shaded}

\subsection{æ•°æ®ç±»å‹}\label{ux6570ux636eux7c7bux578b}

åœ¨ CSV æ–‡ä»¶ä¸­æ‰€æœ‰çš„å€¼éƒ½æ˜¯å­—ç¬¦ä¸²ã€‚è¿™
å¹¶ä¸ä¸€å®šç¬¦åˆæ•°æ®çš„å®é™…æƒ…å†µï¼Œä½†å®ƒæ˜¯ç®€å•çš„ï¼šä¸€åˆ‡éƒ½æ˜¯å­—ç¬¦ä¸²ã€‚I n CSV files,
all values are strings. This is not particularly true to the data, but
it is simple: everything is a string.

Excel ç”µå­è¡¨æ ¼ä¸­çš„åº•å±‚æ•°æ®æ›´ä¸ºå¤æ‚ã€‚ä¸€ ä¸ªå•å…ƒæ ¼å¯ä»¥æ˜¯ä»¥ä¸‹å››ç§ç±»å‹ä¹‹ä¸€ï¼š

\begin{itemize}
\item
  ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå¦‚ \texttt{TRUE}ã€\texttt{FALSE} æˆ– \texttt{NA}ï¼›
\item
  ä¸€ä¸ªæ•°å­—ï¼Œå¦‚ ``10'' æˆ– ``10.5''ï¼›
\item
  ä¸€ä¸ªæ—¥æœŸæ—¶é—´ï¼Œä¹Ÿå¯ä»¥åŒ…å«æ—¶é—´ï¼Œå¦‚ ``11/1/21'' æˆ– ``11/1/21 3:00 PM''ï¼›
\item
  ä¸€ä¸ªæ–‡æœ¬å­—ç¬¦ä¸²ï¼Œå¦‚ ``ten''ã€‚
\end{itemize}

åœ¨å¤„ç†ç”µå­è¡¨æ ¼æ•°æ®æ—¶ï¼Œé‡è¦çš„æ˜¯è¦è®°ä½åº•å±‚æ•°æ®å¯èƒ½ä¸æ‚¨åœ¨å•å…ƒæ ¼ä¸­çœ‹åˆ°çš„å†…å®¹å¤§ä¸ç›¸åŒã€‚ä¾‹
å¦‚ï¼ŒExcel æ²¡æœ‰æ•´æ•°çš„æ¦‚å¿µã€‚æ‰€
æœ‰æ•°å­—éƒ½ä»¥æµ®ç‚¹æ•°å½¢å¼å­˜å‚¨ï¼Œä½†æ‚¨å¯ä»¥é€‰æ‹©ä»¥å¯è‡ªå®šä¹‰çš„å°æ•°ä½æ•°æ˜¾ç¤ºæ•°æ®ã€‚ç±»
ä¼¼åœ°ï¼Œæ—¥æœŸå®é™…ä¸Šæ˜¯ä½œä¸ºæ•°å­—å­˜å‚¨çš„ï¼Œç‰¹åˆ«æ˜¯è‡ª 1970 å¹´ 1 æœˆ 1
æ—¥ä»¥æ¥çš„ç§’æ•°ã€‚æ‚¨ å¯ä»¥åœ¨ Excel ä¸­åº”ç”¨æ ¼å¼è®¾ç½®æ¥è‡ªå®šä¹‰æ—¥æœŸçš„æ˜¾ç¤ºæ–¹å¼ã€‚ä»¤
äººå›°æƒ‘çš„æ˜¯ï¼Œè¿˜å¯èƒ½æœ‰çœ‹èµ·æ¥åƒæ˜¯æ•°å­—ä½†å®é™…ä¸Šæ˜¯å­—ç¬¦ä¸²çš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œåœ¨ Excel
å•å…ƒæ ¼ä¸­è¾“å…¥ \texttt{\textquotesingle{}10}ï¼‰ã€‚

åº•å±‚æ•°æ®å­˜å‚¨æ–¹å¼ä¸æ˜¾ç¤ºæ–¹å¼ä¹‹é—´çš„å·®å¼‚å¯èƒ½ä¼šåœ¨å°†æ•°æ®åŠ è½½åˆ° R
æ—¶é€ æˆæ„å¤–ã€‚é»˜ è®¤æƒ…å†µä¸‹ï¼Œreadxl ä¼šçŒœæµ‹ç»™å®šåˆ—çš„æ•°æ®ç±»å‹ã€‚å»º
è®®çš„å·¥ä½œæµç¨‹æ˜¯è®© readxl
çŒœæµ‹åˆ—ç±»å‹ï¼Œç¡®è®¤ä½ å¯¹çŒœæµ‹çš„åˆ—ç±»å‹æ»¡æ„ï¼Œå¦‚æœä¸æ»¡æ„ï¼Œåˆ™è¿”å›å¹¶é‡æ–°å¯¼å…¥ï¼ŒæŒ‡å®š\texttt{col\_types}ï¼Œå¦‚
å°èŠ‚~\ref{sec-reading-spreadsheets-excel} æ‰€ç¤ºã€‚

å¦ä¸€ä¸ªæŒ‘æˆ˜æ˜¯å½“ä½ çš„ Excel
ç”µå­è¡¨æ ¼ä¸­çš„æŸä¸€åˆ—åŒ…å«è¿™äº›ç±»å‹çš„æ··åˆæ•°æ®æ—¶ï¼Œä¾‹å¦‚ï¼Œä¸€äº›å•å…ƒæ ¼æ˜¯æ•°å­—ï¼Œå…¶ä»–æ˜¯æ–‡æœ¬ï¼Œå…¶ä»–æ˜¯æ—¥æœŸã€‚å½“
å°†æ•°æ®å¯¼å…¥ R æ—¶ï¼Œreadxl å¿…é¡»åšå‡ºä¸€äº›å†³ç­–ã€‚åœ¨
è¿™äº›æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥å°†è¯¥åˆ—çš„ç±»å‹è®¾ç½®ä¸º \texttt{"list"}ï¼Œå°†è¯¥åˆ—åŠ è½½ä¸ºé•¿åº¦ä¸º
1 çš„å‘é‡åˆ—è¡¨ï¼Œå…¶ä¸­å‘é‡çš„æ¯ä¸ªå…ƒç´ çš„ç±»å‹éƒ½å°†è¢«çŒœæµ‹ã€‚

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, titlerule=0mm, breakable, colback=white, opacityback=0, bottomtitle=1mm, colbacktitle=quarto-callout-note-color!10!white, toptitle=1mm, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{æ³¨è®°}, arc=.35mm, left=2mm, opacitybacktitle=0.6, rightrule=.15mm, bottomrule=.15mm, colframe=quarto-callout-note-color-frame, coltitle=black, leftrule=.75mm]

æœ‰æ—¶æ•°æ®ä¼šä»¥æ›´ç‰¹æ®Šçš„æ–¹å¼å­˜å‚¨ï¼Œæ¯”å¦‚å•å…ƒæ ¼èƒŒæ™¯çš„é¢œè‰²ï¼Œæˆ–è€…æ–‡æœ¬æ˜¯å¦ä¸ºç²—ä½“ã€‚åœ¨
è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¼šå‘ç°
\href{https://nacnudus.github.io/tidyxl/}{tidyxl}åŒ…å¾ˆæœ‰ç”¨ã€‚è¯·
è®¿é—®\url{https://nacnudus.github.io/spreadsheet-munging-strategies/}
ä»¥è·å–æ›´å¤šå…³äºä» Excel å¤„ç†éè¡¨æ ¼æ•°æ®çš„ç­–ç•¥ã€‚

\end{tcolorbox}

\subsection{å†™å…¥Excel}\label{sec-writing-to-excel}

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå°çš„æ•°æ®æ¡†ï¼Œç„¶åå°†å…¶å†™å…¥Excelã€‚è¯·
æ³¨æ„ï¼Œ\texttt{item}æ˜¯ä¸€ä¸ªå› å­ï¼Œè€Œ\texttt{quantity}æ˜¯ä¸€ä¸ªæ•´æ•°ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bake\_sale }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{item     =} \FunctionTok{factor}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"brownie"}\NormalTok{, }\StringTok{"cupcake"}\NormalTok{, }\StringTok{"cookie"}\NormalTok{)),}
  \AttributeTok{quantity =} \FunctionTok{c}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{8}\NormalTok{)}
\NormalTok{)}

\NormalTok{bake\_sale}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 2}
\CommentTok{\#\textgreater{}   item    quantity}
\CommentTok{\#\textgreater{}   \textless{}fct\textgreater{}      \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 brownie       10}
\CommentTok{\#\textgreater{} 2 cupcake        5}
\CommentTok{\#\textgreater{} 3 cookie         8}
\end{Highlighting}
\end{Shaded}

æ‚¨å¯ä»¥ä½¿ç”¨ \href{https://docs.ropensci.org/writexl/}{writexl}åŒ…ä¸­çš„
\texttt{write\_xlsx()} å‡½æ•°å°†æ•°æ®ä½œä¸º Excel æ–‡ä»¶å†™å›åˆ°ç£ç›˜ä¸­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{write\_xlsx}\NormalTok{(bake\_sale, }\AttributeTok{path =} \StringTok{"data/bake{-}sale.xlsx"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

å›¾~\ref{fig-bake-sale-excel} å±•ç¤ºäº†åœ¨ Excel ä¸­æ•°æ®çš„æ ·å­ã€‚è¯·
æ³¨æ„ï¼Œåˆ—åå·²ç»è¢«åŒ…å«å¹¶åŠ ç²—äº†ã€‚è¿™ äº›å¯ä»¥é€šè¿‡å°† \texttt{col\_names} å’Œ
\texttt{format\_headers} å‚æ•°è®¾ç½®ä¸º \texttt{FALSE} æ¥å…³é—­ã€‚

\begin{figure}

\centering{

\includegraphics[width=3.06in,height=\textheight]{screenshots/import-spreadsheets-bake-sale.png}

}

\caption{\label{fig-bake-sale-excel}Spreadsheet called bake\_sale.xlsx
in Excel.}

\end{figure}%

å°±åƒä» CSV
è¯»å–æ•°æ®ä¸€æ ·ï¼Œå½“æˆ‘ä»¬é‡æ–°å°†æ•°æ®è¯»å…¥æ—¶ï¼Œæ•°æ®ç±»å‹çš„ä¿¡æ¯ä¼šä¸¢å¤±ã€‚è¿™
ä½¿å¾—Excelæ–‡ä»¶åœ¨ç¼“å­˜ä¸­é—´ç»“æœæ—¶ä¹Ÿä¸å¯é ã€‚å¯¹ äºæ›¿ä»£æ–¹æ¡ˆï¼Œè¯·å‚é˜…
å°èŠ‚~\ref{sec-writing-to-a-file}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/bake{-}sale.xlsx"}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 2}
\CommentTok{\#\textgreater{}   item    quantity}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}      \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 brownie       10}
\CommentTok{\#\textgreater{} 2 cupcake        5}
\CommentTok{\#\textgreater{} 3 cookie         8}
\end{Highlighting}
\end{Shaded}

\subsection{æ ¼å¼åŒ–è¾“å‡º}\label{ux683cux5f0fux5316ux8f93ux51fa}

writexlåŒ…æ˜¯ä¸€ä¸ªè½»é‡çº§çš„è§£å†³æ–¹æ¡ˆï¼Œç”¨äºç¼–å†™ç®€å•çš„Excelç”µå­è¡¨æ ¼ã€‚ä½†
å¦‚æœä½ å¯¹åœ¨ç”µå­è¡¨æ ¼å†…éƒ¨å†™å…¥å·¥ä½œè¡¨ä»¥åŠæ ·å¼è®¾ç½®ç­‰é¢å¤–åŠŸèƒ½æ„Ÿå…´è¶£ï¼Œé‚£ä¹ˆä½ å¯èƒ½éœ€è¦ä½¿ç”¨\href{https://ycphs.github.io/openxlsx}{openxlsx}åŒ…ã€‚æˆ‘
ä»¬ä¸ä¼šåœ¨è¿™é‡Œè¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨è¿™ä¸ªåŒ…ï¼Œä½†æˆ‘ä»¬å»ºè®®ä½ é˜…è¯»\url{https://ycphs.github.io/openxlsx/articles/Formatting.html}ï¼Œä»¥è·å¾—æœ‰å…³ä½¿ç”¨openxlsxä»Rå°†æ•°æ®å†™å…¥Excelçš„æ›´å¤šæ ¼å¼åŒ–åŠŸèƒ½çš„å¹¿æ³›è®¨è®ºã€‚

è¯·æ³¨æ„ï¼Œè¿™ä¸ªåŒ…ä¸æ˜¯tidyverseçš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤å®ƒçš„å‡½æ•°å’Œå·¥ä½œæµç¨‹å¯èƒ½ä¼šè®©ä½ æ„Ÿåˆ°é™Œç”Ÿã€‚ä¾‹
å¦‚ï¼Œå‡½æ•°åæ˜¯é©¼å³°å‘½åæ³•ï¼ˆcamelCaseï¼‰ï¼Œå¤šä¸ªå‡½æ•°ä¸èƒ½åœ¨ç®¡é“ä¸­ç»„åˆä½¿ç”¨ï¼Œå¹¶ä¸”å‚æ•°çš„é¡ºåºä¸tidyverseä¸­çš„ä¹ æƒ¯ä¸åŒã€‚ä¸
è¿‡ï¼Œè¿™æ²¡é—®é¢˜ã€‚éš
ç€ä½ çš„Rè¯­è¨€å­¦ä¹ å’Œä½¿ç”¨èŒƒå›´æ‰©å±•åˆ°æœ¬ä¹¦ä¹‹å¤–ï¼Œä½ å°†é‡åˆ°è®¸å¤šç”¨äºå®ç°Rä¸­ç‰¹å®šç›®æ ‡çš„RåŒ…çš„ä¸åŒä½¿ç”¨é£æ ¼ã€‚ç†Ÿ
æ‚‰æ–°åŒ…ä¸­ä½¿ç”¨çš„ç¼–ç é£æ ¼çš„ä¸€ä¸ªå¥½æ–¹æ³•æ˜¯è¿è¡Œå‡½æ•°æ–‡æ¡£ä¸­æä¾›çš„ç¤ºä¾‹ï¼Œä»¥äº†è§£è¯­æ³•å’Œè¾“å‡ºæ ¼å¼ï¼Œå¹¶é˜…è¯»å¯èƒ½éšåŒ…ä¸€èµ·æä¾›çš„ä»»ä½•è¯´æ˜æ–‡æ¡£ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-52}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  åœ¨Excelæ–‡ä»¶ä¸­åˆ›å»ºä»¥ä¸‹æ•°æ®é›†ï¼Œå¹¶å°†å…¶ä¿å­˜ä¸º\texttt{survey.xlsx}ã€‚æˆ–
  è€…ï¼Œä»\href{https://docs.google.com/spreadsheets/d/1yc5gL-a2OOBr8M7B3IsDNX5uR17vBHOyWZq6xSTG2G8}{è¿™é‡Œ}ä¸‹è½½ä¸ºExcelæ–‡ä»¶ã€‚

  \includegraphics[width=0.88in,height=\textheight]{screenshots/import-spreadsheets-survey.png}

  ç„¶åå°†å…¶è¯»å…¥Rï¼Œå…¶ä¸­\texttt{survey\_id}ä½œä¸ºå­—ç¬¦å˜é‡ï¼Œ\texttt{n\_pets}ä½œä¸ºæ•°å€¼å˜é‡ã€‚

\begin{verbatim}
#> # A tibble: 6 x 2
#>   survey_id n_pets
#>   <chr>      <dbl>
#> 1 1              0
#> 2 2              1
#> 3 3             NA
#> 4 4              2
#> 5 5              2
#> 6 6             NA
\end{verbatim}
\item
  åœ¨å¦ä¸€ä¸ªExcelæ–‡ä»¶ä¸­ï¼Œåˆ›å»ºä»¥ä¸‹æ•°æ®é›†å¹¶å°†å…¶ä¿å­˜ä¸º\texttt{roster.xlsx}ã€‚æˆ–
  è€…ï¼Œä»\href{https://docs.google.com/spreadsheets/d/1LgZ0Bkg9d_NK8uTdP2uHXm07kAlwx8-Ictf8NocebIE}{è¿™é‡Œ}ä¸‹è½½ä¸ºExcelæ–‡ä»¶ã€‚

  \includegraphics[width=0.85in,height=\textheight]{screenshots/import-spreadsheets-roster.png}

  ç„¶åï¼Œå°†å…¶è¯»å…¥Rã€‚ç”Ÿ æˆçš„æ•°æ®æ¡†å¸§åº”è¯¥ç§°ä¸º\texttt{roster}ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

\begin{verbatim}
#> # A tibble: 12 x 3
#>    group subgroup    id
#>    <dbl> <chr>    <dbl>
#>  1     1 A            1
#>  2     1 A            2
#>  3     1 A            3
#>  4     1 B            4
#>  5     1 B            5
#>  6     1 B            6
#>  7     1 B            7
#>  8     2 A            8
#>  9     2 A            9
#> 10     2 B           10
#> 11     2 B           11
#> 12     2 B           12
\end{verbatim}
\item
  åœ¨æ–°çš„Excelæ–‡ä»¶ä¸­ï¼Œåˆ›å»ºä»¥ä¸‹æ•°æ®é›†å¹¶å°†å…¶ä¿å­˜ä¸º\texttt{sale\ .xlsx}ã€‚æˆ–
  è€…ï¼Œä»\href{https://docs.google.com/spreadsheets/d/1oCqdXUNO8JR3Pca8fHfiz_WXWxMuZAp3YiYFaKze5V0}{è¿™é‡Œ}ä¸‹è½½ä¸ºExcelæ–‡ä»¶ã€‚

  \includegraphics[width=1.06in,height=\textheight]{screenshots/import-spreadsheets-sales.png}

  a. è¯»å–\texttt{sale\ .xlsx}å¹¶ä¿å­˜ä¸º\texttt{sales}ã€‚æ•°
  æ®æ¡†æ¶åº”è¯¥å¦‚ä¸‹æ‰€ç¤ºï¼Œä»¥\texttt{id}å’Œ\texttt{n}ä½œä¸ºåˆ—åï¼Œå…±æœ‰9è¡Œã€‚

\begin{verbatim}
#> # A tibble: 9 x 2
#>   id      n    
#>   <chr>   <chr>
#> 1 Brand 1 n    
#> 2 1234    8    
#> 3 8721    2    
#> 4 1822    3    
#> 5 Brand 2 n    
#> 6 3333    1    
#> 7 2156    3    
#> 8 3987    6    
#> 9 3216    5
\end{verbatim}

  b. è¿›ä¸€æ­¥ä¿®æ”¹\texttt{sales}ï¼Œè½¬æ¢ä¸ºä»¥ä¸‹æ•´é½æ ¼å¼ï¼Œå…¶ä¸­åŒ…å«ä¸‰åˆ—
  (\texttt{brand}ã€\texttt{id}å’Œ\texttt{n}) å’Œ7è¡Œæ•°æ®ã€‚æ³¨
  æ„\texttt{id}å’Œ\texttt{n}æ˜¯æ•°å­—ï¼Œ\texttt{brand}æ˜¯å­—ç¬¦å˜é‡ã€‚

\begin{verbatim}
#> # A tibble: 7 x 3
#>   brand      id     n
#>   <chr>   <dbl> <dbl>
#> 1 Brand 1  1234     8
#> 2 Brand 1  8721     2
#> 3 Brand 1  1822     3
#> 4 Brand 2  3333     1
#> 5 Brand 2  2156     3
#> 6 Brand 2  3987     6
#> 7 Brand 2  3216     5
\end{verbatim}
\item
  é‡æ–°åˆ›å»º\texttt{bake\_sale}æ•°æ®æ¡†ï¼Œä½¿ç”¨openxlsxåŒ…çš„\texttt{write.xlsx()}å‡½æ•°å°†å…¶å†™å…¥Excelæ–‡ä»¶ã€‚
\item
  åœ¨ ç« èŠ‚~\ref{sec-data-import}
  ä¸­ï¼Œä½ äº†è§£äº†\texttt{janitor::clean\_names()}å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†åˆ—åè½¬æ¢ä¸ºè›‡å½¢å¤§å°å†™ã€‚é˜…
  è¯»æœ¬èŠ‚å‰é¢ä»‹ç»çš„\texttt{students.xlsx}æ–‡ä»¶ï¼Œä½¿ç”¨è¯¥å‡½æ•°``æ¸…é™¤''åˆ—åã€‚
\item
  å¦‚æœå°è¯•ä½¿ç”¨\texttt{read\_xls()}è¯»å…¥æ‰©å±•åä¸º.\texttt{xlsx}çš„æ–‡ä»¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ
\end{enumerate}

\section{Googleè¡¨å•}\label{googleux8868ux5355}

Googleè¡¨å•æ˜¯å¦ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„ç”µå­è¡¨æ ¼ç¨‹åºã€‚å®ƒ æ˜¯å…è´¹çš„ï¼ŒåŸºäºç½‘ç»œã€‚å°±
åƒExcelä¸€æ ·ï¼Œåœ¨Googleè¡¨å•ä¸­ï¼Œæ•°æ®è¢«ç»„ç»‡åœ¨ç”µå­è¡¨æ ¼æ–‡ä»¶å†…çš„å·¥ä½œè¡¨ï¼ˆä¹Ÿç§°ä¸ºè¡¨å•ï¼‰ä¸­ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-16}

æœ¬èŠ‚ä¹Ÿå…³æ³¨ç”µå­è¡¨æ ¼ï¼Œä½†è¿™æ¬¡ä½ å°†ä½¿ç”¨\textbf{googlesheets4}åŒ…ä»Googleè¡¨å•ä¸­åŠ è½½æ•°æ®ã€‚è¿™
ä¸ªåŒ…ä¹Ÿä¸æ˜¯tidyverseçš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œä½ éœ€è¦æ˜ç¡®åŠ è½½å®ƒã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(googlesheets4)}
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

å…³äºåŒ…çš„åç§°çš„ç®€è¦è¯´æ˜ï¼šgooglesheets4ä½¿ç”¨\href{https://developers.google.com/sheets/api/}{Sheets
API v4}çš„v4ç‰ˆæœ¬æ¥ä¸ºGoogleè¡¨å•æä¾›Ræ¥å£ï¼Œå› æ­¤å¾—åã€‚

\subsection{å…¥é—¨}\label{ux5165ux95e8-1}

googlesheets4åŒ…çš„ä¸»è¦å‡½æ•°æ˜¯\texttt{read\_sheet()}ï¼Œå®ƒå¯ä»¥ä»URLæˆ–æ–‡ä»¶IDä¸­è¯»å–Googleè¡¨å•ã€‚è¿™
ä¸ªå‡½æ•°ä¹Ÿå«åš\texttt{range\_read()}ã€‚

æ‚¨è¿˜å¯ä»¥ä½¿ç”¨\texttt{gs4\_create()}æ¥åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„è¡¨å•ï¼Œæˆ–è€…ä½¿ç”¨\texttt{sheet\_write()}åŠå…¶ç›¸å…³å‡½æ•°å†™å…¥ç°æœ‰è¡¨å•ã€‚

åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸Exceléƒ¨åˆ†ç›¸åŒçš„æ•°æ®é›†ï¼Œä»¥çªå‡ºä»Excelå’ŒGoogleè¡¨å•è¯»å–æ•°æ®çš„å·¥ä½œæµç¨‹ä¹‹é—´çš„ç›¸ä¼¼æ€§å’Œå·®å¼‚ã€‚\texttt{r}
\texttt{eadxl}å’Œ\texttt{googlesheets4}åŒ…éƒ½æ—¨åœ¨æ¨¡ä»¿\texttt{readr}åŒ…çš„åŠŸèƒ½ï¼Œ\texttt{readr}åŒ…æä¾›äº†åœ¨
ç« èŠ‚~\ref{sec-data-import} è§æåˆ°çš„\texttt{read\_csv()}å‡½æ•°ã€‚å› 
æ­¤ï¼Œè®¸å¤šä»»åŠ¡å¯ä»¥ç®€å•åœ°é€šè¿‡ç”¨\texttt{read\_sheet()}æ›¿æ¢\texttt{read\_excel()}æ¥å®Œæˆã€‚ç„¶
è€Œï¼Œä½ ä¹Ÿä¼šçœ‹åˆ°Excelå’ŒGoogleè¡¨å•çš„è¡Œä¸ºå¹¶ä¸å®Œå…¨ç›¸åŒï¼Œå› æ­¤å…¶ä»–ä»»åŠ¡å¯èƒ½éœ€è¦å¯¹å‡½æ•°è°ƒç”¨è¿›è¡Œè¿›ä¸€æ­¥çš„æ›´æ–°ã€‚

\subsection{è¯»å–Googleè¡¨å•}\label{ux8bfbux53d6googleux8868ux5355}

å›¾~\ref{fig-students-googlesheets}
å±•ç¤ºäº†æˆ‘ä»¬å°†è¦è¯»å–åˆ°Rä¸­çš„ç”µå­è¡¨æ ¼åœ¨Googleè¡¨å•ä¸­çš„æ ·å­ã€‚è¿™
ä¸@fig-students-excel
ä¸­çš„æ•°æ®é›†ç›¸åŒï¼Œåªæ˜¯å®ƒè¢«å­˜å‚¨åœ¨Googleè¡¨å•ä¸­è€Œä¸æ˜¯Excelä¸­ã€‚

\begin{figure}

\centering{

\includegraphics[width=3.29in,height=\textheight]{screenshots/import-googlesheets-students.png}

}

\caption{\label{fig-students-googlesheets}Google Sheet called students
in a browser window.}

\end{figure}%

\texttt{read\_sheet()}çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦è¯»å–çš„æ–‡ä»¶çš„URLï¼Œå®ƒè¿”å›ä¸€ä¸ªtibble:\\
\url{https://docs.google.com/spreadsheets/d/1V1nPp1tzOuutXFLb3G9Eyxi3qxeEhnOXUzL5_BcCQ0w}.
è¿™äº›URLä½¿ç”¨èµ·æ¥å¹¶ä¸æ–¹ä¾¿ï¼Œå› æ­¤é€šå¸¸å¸Œæœ›é€šè¿‡å…¶IDæ¥æ ‡è¯†è¡¨å•ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{gs4\_deauth}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# students\_sheet\_id \textless{}{-} "1V1nPp1tzOuutXFLb3G9Eyxi3qxeEhnOXUzL5\_BcCQ0w"}
\CommentTok{\# students \textless{}{-} read\_sheet(students\_sheet\_id)}
\CommentTok{\# students}
\end{Highlighting}
\end{Shaded}

å°±åƒæˆ‘ä»¬ä½¿ç”¨\texttt{read\_excel()}ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä¸º\texttt{read\_sheet()}æä¾›åˆ—åã€\texttt{NA}å­—ç¬¦ä¸²å’Œåˆ—ç±»å‹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# students \textless{}{-} read\_sheet(}
\CommentTok{\#   students\_sheet\_id,}
\CommentTok{\#   col\_names = c("student\_id", "full\_name", "favourite\_food", "meal\_plan", "age"),}
\CommentTok{\#   skip = 1,}
\CommentTok{\#   na = c("", "N/A"),}
\CommentTok{\#   col\_types = "dcccc"}
\CommentTok{\# )}
\CommentTok{\# }
\CommentTok{\# students}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„ï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨çŸ­ä»£ç å¯¹åˆ—ç±»å‹è¿›è¡Œäº†ç¨å¾®ä¸åŒçš„å®šä¹‰ã€‚ä¾‹
å¦‚ï¼Œ``dcccc''ä»£è¡¨``double, character, character, character,
character''ã€‚

åŒæ ·ï¼Œä¹Ÿå¯ä»¥ä»Googleè¡¨å•ä¸­è¯»å–å•ä¸ªè¡¨å•ã€‚è®©
æˆ‘ä»¬ä»\href{https://pos.it/r4ds-penguins}{penguins Google
Sheet}ä¸­è¯»å–``Torgersen Island''è¡¨å•ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# penguins\_sheet\_id \textless{}{-} "1aFu8lnD\_g0yjF5O{-}K6SFgSEWiHPpgvFCF0NY9D6LXnY"}
\CommentTok{\# read\_sheet(penguins\_sheet\_id, sheet = "Torgersen Island")}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥ä½¿ç”¨\texttt{sheet\_names()}å‡½æ•°æ¥è·å–Googleè¡¨å•ä¸­æ‰€æœ‰è¡¨å•çš„åˆ—è¡¨ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# sheet\_names(penguins\_sheet\_id)}
\end{Highlighting}
\end{Shaded}

æœ€åï¼Œå°±åƒä½¿ç”¨\texttt{read\_excel()}ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨\texttt{read\_sheet()}ä¸­å®šä¹‰ä¸€ä¸ªèŒƒå›´æ¥è¯»å–Googleè¡¨å•çš„ä¸€éƒ¨åˆ†ã€‚è¯·
æ³¨æ„ï¼Œä¸‹é¢æˆ‘ä»¬è¿˜ä½¿ç”¨äº†\texttt{gs4\_example()}å‡½æ•°æ¥å®šä½ä¸\texttt{googlesheets4}åŒ…ä¸€èµ·æä¾›çš„ç¤ºä¾‹Googleè¡¨å•ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# deaths\_url \textless{}{-} gs4\_example("deaths")}
\CommentTok{\# deaths \textless{}{-} read\_sheet(deaths\_url, range = "A5:F15")}
\CommentTok{\# deaths}
\end{Highlighting}
\end{Shaded}

\subsection{å†™å…¥Googleè¡¨å•}\label{ux5199ux5165googleux8868ux5355}

æ‚¨å¯ä»¥ä½¿ç”¨\texttt{write\_sheet()}å‡½æ•°å°†Rä¸­çš„æ•°æ®å†™å…¥Googleè¡¨å•ã€‚ç¬¬
ä¸€ä¸ªå‚æ•°æ˜¯è¦å†™å…¥çš„æ•°æ®æ¡†ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¦å†™å…¥çš„Googleè¡¨å•çš„åç§°
(æˆ–å…¶ä»–æ ‡è¯†ç¬¦)ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# write\_sheet(bake\_sale, ss = "bake{-}sale")}
\end{Highlighting}
\end{Shaded}

å¦‚æœæ‚¨æƒ³å°†æ•°æ®å†™å…¥Googleè¡¨å•ä¸­çš„ç‰¹å®šè¡¨å•ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨\texttt{sheet}å‚æ•°æ¥æŒ‡å®šå®ƒã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# write\_sheet(bake\_sale, ss = "bake{-}sale", sheet = "Sales")}
\end{Highlighting}
\end{Shaded}

\subsection{èº«ä»½éªŒè¯}\label{ux8eabux4efdux9a8cux8bc1}

è™½ç„¶ä½ å¯ä»¥åœ¨æ²¡æœ‰ä½¿ç”¨Googleå¸æˆ·è¿›è¡Œèº«ä»½éªŒè¯çš„æƒ…å†µä¸‹ä½¿ç”¨\texttt{gs4\_deauth()}ä»å…¬å…±çš„Googleè¡¨å•ä¸­è¯»å–æ•°æ®ï¼Œä½†è¯»å–ç§æœ‰è¡¨å•æˆ–å†™å…¥è¡¨å•éœ€è¦èº«ä»½éªŒè¯ï¼Œä»¥ä¾¿googlesheets4
èƒ½å¤ŸæŸ¥çœ‹å’Œç®¡ç†æ‚¨çš„Googleè¡¨å•ã€‚

å½“ä½ å°è¯•è¯»å–éœ€è¦èº«ä»½éªŒè¯çš„è¡¨å•æ—¶ï¼Œgooglesheets4
ä¼šå¼•å¯¼ä½ è®¿é—®ä¸€ä¸ªç½‘é¡µï¼Œæç¤ºä½ ç™»å½•Googleå¸æˆ·å¹¶æˆäºˆæƒé™ï¼Œä»¥ä¾¿ä»£è¡¨ä½ ä½¿ç”¨Googleè¡¨å•è¿›è¡Œæ“ä½œã€‚ä½†
æ˜¯ï¼Œå¦‚æœä½ æƒ³æŒ‡å®šç‰¹å®šçš„Googleå¸æˆ·ã€èº«ä»½éªŒè¯èŒƒå›´ç­‰ï¼Œå¯ä»¥ä½¿ç”¨\texttt{gs4\_auth()}æ¥å®Œæˆï¼Œä¾‹å¦‚\texttt{gs4\_auth(email\ =\ "mine@example.com")}ï¼Œè¿™å°†å¼ºåˆ¶ä½¿ç”¨ä¸ç‰¹å®šç”µå­é‚®ä»¶å…³è”çš„ä»¤ç‰Œã€‚æœ‰
å…³èº«ä»½éªŒè¯çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œæˆ‘ä»¬å»ºè®®æ‚¨é˜…è¯»googlesheets4
çš„èº«ä»½éªŒè¯æ–‡æ¡£ï¼š\href{https://googlesheets4.tidyverse.org/articles/auth.html\%E3\%80\%82}{https://googlesheets4.tidyverse.org/articles/auth.html}
ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-53}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ä»Excelå’ŒGoogleè¡¨å•ä¸­è¯»å–æœ¬ç« å‰é¢æåˆ°çš„\texttt{students}æ•°æ®é›†ï¼Œä¸å‘\texttt{read\_excel()}å’Œ\texttt{read\_sheet()}å‡½æ•°æä¾›ä»»ä½•é¢å¤–çš„å‚æ•°ã€‚åœ¨
  Rä¸­ç”Ÿæˆçš„æ•°æ®æ¡†æ˜¯å¦å®Œå…¨ç›¸åŒï¼Ÿå¦‚ æœä¸åŒï¼Œå®ƒä»¬æœ‰ä½•ä¸åŒï¼Ÿ
\item
  ä» \url{https://pos.it/r4ds-survey}
  è¯»å–åä¸ºsurveyçš„Googleè¡¨å•ï¼Œå…¶ä¸­\texttt{survey\_id}ä½œä¸ºå­—ç¬¦å˜é‡ï¼Œ\texttt{n\_pets}ä½œä¸ºæ•°å€¼å˜é‡ã€‚
\item
  ä» \url{https://pos.it/r4ds-roster} è¯»å–åä¸ºrosterçš„Googleè¡¨å•ã€‚ç”Ÿ
  æˆçš„æ•°æ®æ¡†åº”å‘½åä¸º\texttt{roster}ï¼Œå¹¶åº”å¦‚ä¸‹æ‰€ç¤ºã€‚
\end{enumerate}

\section{å°ç»“}\label{ux5c0fux7ed3-19}

Microsoft Excelå’ŒGoogle Sheetsæ˜¯ä¸¤ä¸ªæœ€å—æ¬¢è¿çš„ç”µå­è¡¨æ ¼ç³»ç»Ÿã€‚èƒ½
å¤Ÿç›´æ¥ä»Rä¸å­˜å‚¨åœ¨Excelå’ŒGoogle
Sheetsæ–‡ä»¶ä¸­çš„æ•°æ®è¿›è¡Œäº¤äº’æ˜¯ä¸€é¡¹è¶…èƒ½åŠ›ï¼åœ¨
æœ¬ç« ä¸­ï¼Œä½ å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨readxlåŒ…ä¸­çš„\texttt{read\_excel()}å‡½æ•°ä»Excelç”µå­è¡¨æ ¼è¯»å–æ•°æ®åˆ°Rä¸­ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨googlesheets4åŒ…ä¸­çš„\texttt{read\_sheet()}å‡½æ•°ä»Google
Sheetsè¯»å–æ•°æ®ã€‚è¿™
äº›å‡½æ•°å½¼æ­¤ä¹‹é—´çš„å·¥ä½œæ–¹å¼éå¸¸ç›¸ä¼¼ï¼Œå¹¶ä¸”å…·æœ‰ç±»ä¼¼çš„å‚æ•°æ¥æŒ‡å®šåˆ—åã€NAå­—ç¬¦ä¸²ã€è¦è·³è¿‡çš„æ–‡ä»¶é¡¶éƒ¨çš„è¡Œç­‰ã€‚æ­¤
å¤–ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°éƒ½å…è®¸ä½ ä»ç”µå­è¡¨æ ¼ä¸­è¯»å–å•ä¸ªè¡¨å•ã€‚

å¦ä¸€æ–¹é¢ï¼Œå†™å…¥Excelæ–‡ä»¶éœ€è¦ä¸åŒçš„åŒ…å’Œå‡½æ•°ï¼ˆ\texttt{writexl::write\_xlsx()}ï¼‰ï¼Œè€Œä½ å¯ä»¥ä½¿ç”¨googlesheets4åŒ…çš„\texttt{write\_sheet()}å‡½æ•°å°†æ•°æ®å†™å…¥Google
Sheetsã€‚

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œä½ å°†å­¦ä¹ ä¸€ç§ä¸åŒçš„æ•°æ®æºä»¥åŠå¦‚ä½•å°†æ•°æ®ä»è¯¥æ•°æ®æºè¯»å–åˆ°Rä¸­ï¼šæ•°æ®åº“ã€‚

\chapter{æ•°æ®åº“}\label{sec-import-databases}

\section{å¼•è¨€}\label{ux5f15ux8a00-16}

å¤§é‡çš„æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œå› æ­¤çŸ¥é“å¦‚ä½•è®¿é—®è¿™äº›æ•°æ®è‡³å…³é‡è¦ã€‚æœ‰
æ—¶ä½ å¯ä»¥è¯·æ±‚ä»–äººä¸ºä½ ä¸‹è½½æ•°æ®åº“çš„ä¸€ä¸ªå¿«ç…§åˆ°\texttt{.csv}æ–‡ä»¶ä¸­ï¼Œä½†è¿™æ ·åšå¾ˆå¿«å°±ä¼šå˜å¾—éº»çƒ¦ï¼šæ¯æ¬¡ä½ éœ€è¦åšå‡ºæ›´æ”¹æ—¶ï¼Œä½ éƒ½éœ€è¦ä¸å¦ä¸€ä¸ªäººæ²Ÿé€šã€‚ä½ 
å¸Œæœ›èƒ½å¤Ÿåœ¨ä½ éœ€è¦æ—¶ç›´æ¥è®¿é—®æ•°æ®åº“æ¥è·å–æ‰€éœ€çš„æ•°æ®ã€‚

åœ¨æœ¬ç« ä¸­ï¼Œä½ å°†é¦–å…ˆå­¦ä¹ DBIåŒ…çš„åŸºç¡€çŸ¥è¯†ï¼šå¦‚ä½•ä½¿ç”¨å®ƒè¿æ¥åˆ°æ•°æ®åº“ï¼Œç„¶åä½¿ç”¨SQL\footnote{SQL
  è¯»ä½œ ``s''-``q''-``l'' æˆ–è€…è¯»ä½œ ``sequel''ã€‚} æŸ¥è¯¢æ£€ç´¢æ•°æ®ã€‚
SQLï¼Œå³\textbf{s}tructured \textbf{q}uery \textbf{l}anguage
(ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€)
çš„ç¼©å†™ï¼Œæ˜¯æ•°æ®åº“çš„é€šç”¨è¯­è¨€ï¼Œæ˜¯æ‰€æœ‰æ•°æ®ç§‘å­¦å®¶éƒ½éœ€è¦å­¦ä¹ çš„é‡è¦è¯­è¨€ã€‚
ä¸è¿‡ï¼Œæˆ‘ä»¬ä¸ä¼šä»SQLå¼€å§‹ï¼Œè€Œæ˜¯æ•™ä½ ä½¿ç”¨dbplyrï¼Œå®ƒå¯ä»¥å°†ä½ çš„dplyrä»£ç è½¬æ¢ä¸ºSQLã€‚
æˆ‘ä»¬å°†ä½¿ç”¨è¿™ç§æ–¹æ³•æ¥æ•™ä½ SQLçš„ä¸€äº›æœ€é‡è¦çš„ç‰¹æ€§ã€‚
åˆ°æœ¬ç« ç»“æŸæ—¶ä½ æˆ–è®¸ä¸ä¼šæˆä¸ºSQLå¤§å¸ˆï¼Œä½†ä½ èƒ½å¤Ÿè¯†åˆ«æœ€é‡è¦çš„ç»„ä»¶å¹¶ç†è§£å®ƒä»¬çš„ä½œç”¨ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-17}

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»DBIå’Œdbplyrã€‚D
BIæ˜¯ä¸€ä¸ªä½çº§æ¥å£ï¼Œç”¨äºè¿æ¥åˆ°æ•°æ®åº“å¹¶æ‰§è¡ŒSQLè¯­å¥ï¼›è€Œdbplyræ˜¯ä¸€ä¸ªé«˜çº§æ¥å£ï¼Œå®ƒå°†ä½ çš„dplyrä»£ç è½¬æ¢ä¸ºSQLæŸ¥è¯¢ï¼Œç„¶åä½¿ç”¨DBIæ¥æ‰§è¡Œè¿™äº›æŸ¥è¯¢ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(DBI)}
\FunctionTok{library}\NormalTok{(dbplyr)}
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\section{æ•°æ®åº“åŸºç¡€}\label{ux6570ux636eux5e93ux57faux7840}

åœ¨æœ€ç®€å•çš„å±‚é¢ä¸Šï¼Œä½ å¯ä»¥å°†æ•°æ®åº“è§†ä¸ºæ•°æ®æ¡†çš„é›†åˆï¼Œåœ¨æ•°æ®åº“æœ¯è¯­ä¸­ç§°ä¸ºè¡¨
(\textbf{tables})ã€‚ä¸
æ•°æ®æ¡†ä¸€æ ·ï¼Œæ•°æ®åº“çš„è¡¨æ˜¯ç”±å‘½ååˆ—ç»„æˆçš„é›†åˆï¼Œåˆ—ä¸­çš„æ¯ä¸ªå€¼éƒ½æ˜¯ç›¸åŒçš„ç±»å‹ã€‚æ•°
æ®æ¡†å’Œæ•°æ®åº“è¡¨ä¹‹é—´å­˜åœ¨ä¸‰ä¸ªä¸»è¦å·®å¼‚ï¼š

\begin{itemize}
\tightlist
\item
  æ•°æ®åº“è¡¨å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œå¯ä»¥ä»»æ„å¤§ã€‚è€Œæ•°æ®æ¡†å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä¸”æœ¬è´¨ä¸Šå­˜åœ¨é™åˆ¶ï¼ˆå°½ç®¡è¿™ä¸ªé™åˆ¶å¯¹äºè®¸å¤šé—®é¢˜æ¥è¯´ä»ç„¶è¶³å¤Ÿå¤§ï¼‰ã€‚
\item
  æ•°æ®åº“è¡¨å‡ ä¹æ€»æ˜¯æœ‰ç´¢å¼•ã€‚å°±åƒä¹¦çš„ç´¢å¼•ä¸€æ ·ï¼Œæ•°æ®åº“ç´¢å¼•ä½¿å¾—å¯ä»¥å¿«é€Ÿåœ°æ‰¾åˆ°æ„Ÿå…´è¶£çš„è¡Œï¼Œè€Œæ— éœ€æŸ¥çœ‹æ¯ä¸€è¡Œã€‚æ•°æ®æ¡†å’Œtibblesæ²¡æœ‰ç´¢å¼•ï¼Œä½†data.tablesæœ‰ï¼Œè¿™ä¹Ÿæ˜¯å®ƒä»¬å¦‚æ­¤å¿«é€Ÿçš„åŸå› ä¹‹ä¸€ã€‚
\item
  å¤§å¤šæ•°ç»å…¸æ•°æ®åº“éƒ½ä¼˜åŒ–ä¸ºå¿«é€Ÿæ”¶é›†æ•°æ®ï¼Œè€Œä¸æ˜¯åˆ†æç°æœ‰æ•°æ®ã€‚è¿™äº›æ•°æ®åº“è¢«ç§°ä¸ºè¡Œå¼æ•°æ®åº“ï¼Œå› ä¸ºå®ƒä»¬æŒ‰è¡Œå­˜å‚¨æ•°æ®ï¼Œè€Œä¸æ˜¯åƒRé‚£æ ·æŒ‰åˆ—å­˜å‚¨ã€‚æœ€è¿‘ï¼Œå·²ç»å¼€å‘å‡ºäº†è®¸å¤šåˆ—å¼æ•°æ®åº“ï¼Œè¿™äº›æ•°æ®åº“ä½¿åˆ†æç°æœ‰æ•°æ®å˜å¾—æ›´å¿«ã€‚
\end{itemize}

æ•°æ®åº“ç”±æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰è¿è¡Œï¼ŒDBMSæœ‰ä¸‰ç§åŸºæœ¬å½¢å¼ï¼š

\begin{itemize}
\tightlist
\item
  å®¢æˆ·ç«¯-æœåŠ¡å™¨ï¼šDBMSåœ¨åŠŸèƒ½å¼ºå¤§çš„ä¸­å¤®æœåŠ¡å™¨ä¸Šè¿è¡Œï¼Œä½ å¯ä»¥ä»ä½ çš„ç”µè„‘ï¼ˆå®¢æˆ·ç«¯ï¼‰è¿æ¥åˆ°å®ƒã€‚å®ƒä»¬éå¸¸é€‚åˆåœ¨ç»„ç»‡å†…ä¸å¤šäººå…±äº«æ•°æ®ã€‚æµè¡Œçš„å®¢æˆ·ç«¯-æœåŠ¡å™¨DBMSåŒ…æ‹¬PostgreSQLã€MariaDBã€SQL
  Serverå’ŒOracleç­‰ã€‚
\item
  äº‘DBMSï¼šå¦‚Snowflakeã€Amazonçš„RedShiftå’ŒGoogleçš„BigQueryï¼Œç±»ä¼¼äºå®¢æˆ·ç«¯-æœåŠ¡å™¨DBMSï¼Œä½†å®ƒä»¬åœ¨äº‘ç«¯è¿è¡Œã€‚è¿™æ„å‘³ç€å®ƒä»¬å¯ä»¥è½»æ¾åœ°å¤„ç†éå¸¸å¤§çš„æ•°æ®é›†ï¼Œå¹¶å¯ä»¥æ ¹æ®éœ€è¦è‡ªåŠ¨æä¾›æ›´å¤šçš„è®¡ç®—èµ„æºã€‚
\item
  è¿›ç¨‹å†…DBMSï¼šå¦‚SQLiteæˆ–duckdbï¼Œå®Œå…¨åœ¨ä½ çš„ç”µè„‘ä¸Šè¿è¡Œã€‚å½“ä½ æ˜¯ä¸»è¦ç”¨æˆ·æ—¶ï¼Œå®ƒä»¬éå¸¸é€‚åˆå¤„ç†å¤§å‹æ•°æ®é›†ã€‚
\end{itemize}

\section{è¿æ¥æ•°æ®åº“}\label{ux8fdeux63a5ux6570ux636eux5e93}

è¦ä»Rè¿æ¥åˆ°æ•°æ®åº“ï¼Œéœ€è¦ä½¿ç”¨ä¸€å¯¹è½¯ä»¶åŒ…ï¼š

\begin{itemize}
\tightlist
\item
  ç»å¸¸ä½¿ç”¨çš„\texttt{DBI} (\textbf{d}ata\textbf{b}ase
  \textbf{i}nterface)åŒ…ï¼Œå› ä¸ºå®ƒæä¾›äº†ä¸€ç»„é€šç”¨å‡½æ•°ï¼Œç”¨äºè¿æ¥åˆ°æ•°æ®åº“ã€ä¸Šä¼ æ•°æ®ã€è¿è¡ŒSQLæŸ¥è¯¢ç­‰ã€‚
\item
  ä¸€ä¸ªé’ˆå¯¹ä½ è¦è¿æ¥çš„DBMSå®šåˆ¶çš„åŒ…ï¼Œè¿™ä¸ªåŒ…å°†é€šç”¨çš„DBIå‘½ä»¤è½¬æ¢ä¸ºDBMSæ‰€éœ€çš„ç‰¹å®šå‘½ä»¤ã€‚é€šå¸¸æ¯ä¸ªDBMSéƒ½æœ‰ä¸€ä¸ªè¿™æ ·çš„åŒ…ï¼Œä¾‹å¦‚\texttt{RPostgres}ç”¨äºPostgreSQLï¼Œ\texttt{RMariaDB}ç”¨äºMySQLã€‚
\end{itemize}

å¦‚æœæ‰¾ä¸åˆ°é’ˆå¯¹ä½ çš„DBMSçš„ç‰¹å®šåŒ…ï¼Œä½ é€šå¸¸å¯ä»¥ä½¿ç”¨\texttt{odbc}åŒ…ä½œä¸ºæ›¿ä»£ã€‚\texttt{o}
\texttt{dbc}ä½¿ç”¨è®¸å¤šDBMSéƒ½æ”¯æŒçš„ODBCåè®®ã€‚ä½†
æ˜¯ï¼Œ\texttt{odbc}éœ€è¦æ›´å¤šçš„è®¾ç½®ï¼Œå› ä¸ºä½ è¿˜éœ€è¦å®‰è£…ä¸€ä¸ªODBCé©±åŠ¨ç¨‹åºï¼Œå¹¶å‘Šè¯‰\texttt{odbc}åŒ…åœ¨å“ªé‡Œæ‰¾åˆ°å®ƒã€‚

å…·ä½“æ¥è¯´ï¼Œä½ ä½¿ç”¨\texttt{DBI::dbConnect()}åˆ›å»ºä¸€ä¸ªæ•°æ®åº“è¿æ¥ã€‚ç¬¬
ä¸€ä¸ªå‚æ•°é€‰æ‹©DBMS\footnote{é€šå¸¸ï¼Œè¿™æ˜¯ä½ ä»å®¢æˆ·ç«¯åŒ…ä¸­å”¯ä¸€éœ€è¦ä½¿ç”¨çš„å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬å»ºè®®ä½¿ç”¨\texttt{::}æ¥æå–è¿™ä¸ªå‡½æ•°ï¼Œè€Œä¸æ˜¯ä½¿ç”¨\texttt{library()}æ¥åŠ è½½å®Œæ•´çš„è½¯ä»¶åŒ…ã€‚}ï¼Œç„¶åç¬¬äºŒä¸ªåŠåç»­å‚æ•°æè¿°å¦‚ä½•è¿æ¥åˆ°å®ƒ
(å³å®ƒåœ¨å“ªé‡Œä»¥åŠä½ éœ€è¦è®¿é—®å®ƒçš„å‡­æ®)ã€‚ ä»¥ä¸‹ä»£ç å±•ç¤ºäº†å‡ ä¸ªå…¸å‹çš„ä¾‹å­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{con }\OtherTok{\textless{}{-}}\NormalTok{ DBI}\SpecialCharTok{::}\FunctionTok{dbConnect}\NormalTok{(}
\NormalTok{  RMariaDB}\SpecialCharTok{::}\FunctionTok{MariaDB}\NormalTok{(), }
  \AttributeTok{username =} \StringTok{"root"}\NormalTok{,}
  \AttributeTok{password =} \StringTok{"702177gqb"}
\NormalTok{)}
\NormalTok{con }\OtherTok{\textless{}{-}}\NormalTok{ DBI}\SpecialCharTok{::}\FunctionTok{dbConnect}\NormalTok{(}
\NormalTok{  RPostgres}\SpecialCharTok{::}\FunctionTok{Postgres}\NormalTok{(), }
  \AttributeTok{hostname =} \StringTok{"databases.mycompany.com"}\NormalTok{, }
  \AttributeTok{port =} \DecValTok{1234}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

è¿æ¥çš„å…·ä½“ç»†èŠ‚åœ¨ä¸åŒçš„DBMSä¹‹é—´å·®å¼‚å¾ˆå¤§ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•åœ¨è¿™é‡Œæ¶µç›–æ‰€æœ‰ç»†èŠ‚ã€‚è¿™
æ„å‘³ç€ä½ éœ€è¦è‡ªå·±è¿›è¡Œä¸€äº›ç ”ç©¶ã€‚é€š
å¸¸ï¼Œä½ å¯ä»¥è¯¢é—®ä½ å›¢é˜Ÿä¸­çš„å…¶ä»–æ•°æ®ç§‘å­¦å®¶ï¼Œæˆ–è€…ä¸ä½ çš„DBAï¼ˆæ•°æ®åº“ç®¡ç†å‘˜ï¼‰äº¤è°ˆã€‚åˆ
å§‹è®¾ç½®é€šå¸¸éœ€è¦ä¸€äº›è°ƒè¯•ï¼ˆä¹Ÿè®¸è¿˜éœ€è¦ä¸€äº›ç½‘ç»œæœç´¢ï¼‰æ‰èƒ½æ­£ç¡®å®Œæˆï¼Œä½†é€šå¸¸ä½ åªéœ€è¦åšä¸€æ¬¡è¿™æ ·çš„è®¾ç½®ã€‚

\subsection{åœ¨è¿™æœ¬ä¹¦ä¸­}\label{ux5728ux8fd9ux672cux4e66ux4e2d}

ä¸ºäº†è¿™æœ¬ä¹¦è®¾ç½®å®¢æˆ·ç«¯-æœåŠ¡å™¨æˆ–äº‘DBMSä¼šæ˜¯ä¸€ä¸ªç¹ççš„è¿‡ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä½¿ç”¨å®Œå…¨é©»ç•™åœ¨RåŒ…\texttt{duckdb}ä¸­çš„è¿›ç¨‹å†…DBMSã€‚ç”±
äº\texttt{DBI}çš„é­”åŠ›ï¼Œä½¿ç”¨\texttt{duckdb}ä¸å…¶ä»–DBMSä¹‹é—´çš„å”¯ä¸€åŒºåˆ«åœ¨äºå°†å¦‚ä½•è¿æ¥åˆ°æ•°æ®åº“ã€‚è¿™
ä½¿å¾—å®ƒéå¸¸é€‚åˆç”¨äºæ•™å­¦ï¼Œå› ä¸ºä½ å¯ä»¥è½»æ¾åœ°è¿è¡Œæ­¤ä»£ç ï¼Œå¹¶ä¸”å¯ä»¥å°†æ‰€å­¦åˆ°çš„çŸ¥è¯†è½»æ¾åœ°åº”ç”¨åˆ°å…¶ä»–åœ°æ–¹ã€‚

è¿æ¥åˆ°\texttt{duckdb}ç‰¹åˆ«ç®€å•ï¼Œå› ä¸ºé»˜è®¤è®¾ç½®ä¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶æ•°æ®åº“ï¼Œå½“ä½ é€€å‡ºRæ—¶è¯¥æ•°æ®åº“ä¼šè¢«åˆ é™¤ã€‚è¿™
å¯¹äºå­¦ä¹ æ¥è¯´éå¸¸æ£’ï¼Œå› ä¸ºå®ƒä¿è¯äº†ä½ æ¯æ¬¡é‡å¯Ræ—¶éƒ½ä¼šä»ä¸€ä¸ªå¹²å‡€çš„çŠ¶æ€å¼€å§‹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{con }\OtherTok{\textless{}{-}}\NormalTok{ DBI}\SpecialCharTok{::}\FunctionTok{dbConnect}\NormalTok{(duckdb}\SpecialCharTok{::}\FunctionTok{duckdb}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

duckdb æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½æ•°æ®åº“ï¼Œä¸“ä¸ºæ•°æ®ç§‘å­¦å®¶çš„éœ€æ±‚è€Œè®¾è®¡ã€‚æˆ‘
ä»¬åœ¨è¿™é‡Œä½¿ç”¨å®ƒæ˜¯å› ä¸ºå®ƒä¸Šæ‰‹éå¸¸ç®€å•ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¤Ÿä»¥æé«˜çš„é€Ÿåº¦å¤„ç†æ•°åäº¿å­—èŠ‚çš„æ•°æ®ã€‚å¦‚
æœä½ æƒ³åœ¨çœŸå®çš„æ•°æ®åˆ†æé¡¹ç›®ä¸­ä½¿ç”¨
duckdbï¼Œä½ è¿˜éœ€è¦æä¾›\texttt{dbdir}å‚æ•°æ¥åˆ›å»ºä¸€ä¸ªæŒä¹…çš„æ•°æ®åº“ï¼Œå¹¶å‘Šè¯‰
duckdb åœ¨å“ªé‡Œä¿å­˜å®ƒã€‚å‡ è®¾ä½ æ­£åœ¨ä½¿ç”¨ä¸€ä¸ªé¡¹ç›®
(å¦‚@sec-workflow-scripts-projects)ï¼Œå°†å…¶å­˜å‚¨åœ¨å½“å‰é¡¹ç›®çš„ \texttt{duckdb}
ç›®å½•ä¸‹æ˜¯ä¸€ä¸ªåˆç†çš„é€‰æ‹©ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{con }\OtherTok{\textless{}{-}}\NormalTok{ DBI}\SpecialCharTok{::}\FunctionTok{dbConnect}\NormalTok{(duckdb}\SpecialCharTok{::}\FunctionTok{duckdb}\NormalTok{(), }\AttributeTok{dbdir =} \StringTok{"duckdb"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{åŠ è½½æ•°æ®}\label{sec-load-data}

æ—¢ç„¶è¿™æ˜¯ä¸€ä¸ªæ–°çš„æ•°æ®åº“ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ·»åŠ ä¸€äº›æ•°æ®ã€‚åœ¨
è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä½¿ç”¨\texttt{DBI::dbWriteTable()}å‡½æ•°ä»\texttt{ggplot2}åŒ…ä¸­æ·»åŠ \texttt{mpg}å’Œ\texttt{diamonds}æ•°æ®é›†ã€‚\texttt{d}
\texttt{bWriteTable()}å‡½æ•°çš„æœ€ç®€å•ç”¨æ³•éœ€è¦ä¸‰ä¸ªå‚æ•°ï¼šä¸€ä¸ªæ•°æ®åº“è¿æ¥ã€åœ¨æ•°æ®åº“ä¸­è¦åˆ›å»ºçš„è¡¨çš„åç§°ä»¥åŠä¸€ä¸ªæ•°æ®æ¡†ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dbWriteTable}\NormalTok{(con, }\StringTok{"mpg"}\NormalTok{, ggplot2}\SpecialCharTok{::}\NormalTok{mpg)}
\FunctionTok{dbWriteTable}\NormalTok{(con, }\StringTok{"diamonds"}\NormalTok{, ggplot2}\SpecialCharTok{::}\NormalTok{diamonds)}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ åœ¨ä¸€ä¸ªå®é™…é¡¹ç›®ä¸­ä½¿ç”¨
duckdbï¼Œæˆ‘ä»¬å¼ºçƒˆæ¨èä½ å­¦ä¹ \texttt{duckdb\_read\_csv()}å’Œ\texttt{duckdb\_register\_arrow()}ã€‚è¿™
ä¸¤ä¸ªå‡½æ•°ä¸ºä½ æä¾›äº†å¼ºå¤§ä¸”é«˜æ•ˆçš„æ–¹å¼ï¼Œå¯ä»¥ç›´æ¥å°†æ•°æ®å¿«é€ŸåŠ è½½åˆ°
duckdbä¸­ï¼Œè€Œæ— éœ€é¦–å…ˆå°†æ•°æ®åŠ è½½åˆ° R ä¸­ã€‚åœ¨ å°èŠ‚~\ref{sec-save-database}
æˆ‘ä»¬è¿˜å°†å±•ç¤ºä¸€ç§æœ‰ç”¨çš„æŠ€æœ¯ï¼Œç”¨äºå°†å¤šä¸ªæ–‡ä»¶åŠ è½½åˆ°æ•°æ®åº“ä¸­ã€‚

\subsection{DBIåŸºç¡€}\label{dbiux57faux7840}

ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨å…¶ä»–ä¸€äº›DBIå‡½æ•°æ¥æ£€æŸ¥æ•°æ®æ˜¯å¦æ­£ç¡®åŠ è½½ï¼š\texttt{dbListTables()}å‡½æ•°åˆ—å‡ºäº†æ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨ï¼Œè€Œ\texttt{dbReadTable()}å‡½æ•°åˆ™æ£€ç´¢è¡¨çš„å†…å®¹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dbListTables}\NormalTok{(con)}
\CommentTok{\#\textgreater{} [1] "diamonds" "mpg"}

\NormalTok{con }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{dbReadTable}\NormalTok{(}\StringTok{"diamonds"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{as\_tibble}\NormalTok{()}
\CommentTok{\#\textgreater{} \# A tibble: 53,940 x 10}
\CommentTok{\#\textgreater{}   carat cut       color clarity depth table price     x     y     z}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}fct\textgreater{}     \textless{}fct\textgreater{} \textless{}fct\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}int\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1  0.23 Ideal     E     SI2      61.5    55   326  3.95  3.98  2.43}
\CommentTok{\#\textgreater{} 2  0.21 Premium   E     SI1      59.8    61   326  3.89  3.84  2.31}
\CommentTok{\#\textgreater{} 3  0.23 Good      E     VS1      56.9    65   327  4.05  4.07  2.31}
\CommentTok{\#\textgreater{} 4  0.29 Premium   I     VS2      62.4    58   334  4.2   4.23  2.63}
\CommentTok{\#\textgreater{} 5  0.31 Good      J     SI2      63.3    58   335  4.34  4.35  2.75}
\CommentTok{\#\textgreater{} 6  0.24 Very Good J     VVS2     62.8    57   336  3.94  3.96  2.48}
\CommentTok{\#\textgreater{} \# i 53,934 more rows}
\end{Highlighting}
\end{Shaded}

\texttt{dbReadTable()}å‡½æ•°è¿”å›ä¸€ä¸ª\texttt{data.frame}ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨\texttt{as\_tibble()}å‡½æ•°å°†å…¶è½¬æ¢ä¸º\texttt{tibble}ï¼Œä»¥ä¾¿è¾“å‡ºæ›´ç¾è§‚ã€‚

å¦‚æœä½ å·²ç»ç†Ÿæ‚‰
SQLï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{dbGetQuery()}å‡½æ•°æ¥æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢å¹¶è·å–ç»“æœï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sql }\OtherTok{\textless{}{-}} \StringTok{"}
\StringTok{  SELECT carat, cut, clarity, color, price }
\StringTok{  FROM diamonds }
\StringTok{  WHERE price \textgreater{} 15000}
\StringTok{"}
\FunctionTok{as\_tibble}\NormalTok{(}\FunctionTok{dbGetQuery}\NormalTok{(con, sql))}
\CommentTok{\#\textgreater{} \# A tibble: 1,655 x 5}
\CommentTok{\#\textgreater{}   carat cut       clarity color price}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}fct\textgreater{}     \textless{}fct\textgreater{}   \textless{}fct\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  1.54 Premium   VS2     E     15002}
\CommentTok{\#\textgreater{} 2  1.19 Ideal     VVS1    F     15005}
\CommentTok{\#\textgreater{} 3  2.1  Premium   SI1     I     15007}
\CommentTok{\#\textgreater{} 4  1.69 Ideal     SI1     D     15011}
\CommentTok{\#\textgreater{} 5  1.5  Very Good VVS2    G     15013}
\CommentTok{\#\textgreater{} 6  1.73 Very Good VS1     G     15014}
\CommentTok{\#\textgreater{} \# i 1,649 more rows}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ ä¹‹å‰ä»æœªè§è¿‡SQLï¼Œä¸ç”¨æ‹…å¿ƒï¼å¾ˆ å¿«ä½ å°±ä¼šäº†è§£æ›´å¤šå…³äºå®ƒçš„çŸ¥è¯†ã€‚å¦‚
æœä»”ç»†é˜…è¯»ï¼Œä½ å¯èƒ½ä¼šçŒœå‡ºå®ƒæ˜¯ä»\texttt{diamonds}æ•°æ®é›†ä¸­é€‰æ‹©äº†äº”åˆ—ï¼Œå¹¶ä¸”åªé€‰æ‹©äº†\texttt{price}å¤§äº15,000çš„æ‰€æœ‰è¡Œã€‚

\section{dbplyråŸºç¡€}\label{dbplyrux57faux7840}

æ—¢ç„¶æˆ‘ä»¬å·²ç»è¿æ¥åˆ°æ•°æ®åº“å¹¶åŠ è½½äº†ä¸€äº›æ•°æ®ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¼€å§‹å­¦ä¹ dbplyräº†ã€‚d
bplyræ˜¯dplyrçš„ä¸€ä¸ªåç«¯
(\textbf{backend})ï¼Œè¿™æ„å‘³ç€ä½ ä»ç„¶ç¼–å†™dplyrä»£ç ï¼Œä½†åç«¯ä¼šä»¥ä¸åŒçš„æ–¹å¼æ‰§è¡Œå®ƒã€‚åœ¨
è¿™é‡Œï¼Œdbplyrå°†dplyrä»£ç è½¬æ¢ä¸ºSQLï¼›å…¶ä»–åç«¯åŒ…æ‹¬\href{https://dtplyr.tidyverse.org}{dtplyr}ï¼Œå®ƒå°†ä»£ç è½¬æ¢ä¸º\href{https://r-datatable.com}{data.table}ï¼Œä»¥åŠ\href{https://multidplyr.tidyverse.org}{multidplyr}ï¼Œå®ƒä¼šåœ¨å¤šä¸ªæ ¸å¿ƒä¸Šæ‰§è¡Œä½ çš„ä»£ç ã€‚

è¦ä½¿ç”¨dbplyrï¼Œä½ é¦–å…ˆå¿…é¡»ä½¿ç”¨\texttt{tbl()}å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªä»£è¡¨æ•°æ®åº“è¡¨çš„å¯¹è±¡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds\_db }\OtherTok{\textless{}{-}} \FunctionTok{tbl}\NormalTok{(con, }\StringTok{"diamonds"}\NormalTok{)}
\NormalTok{diamonds\_db}
\CommentTok{\#\textgreater{} \# Source:   table\textless{}diamonds\textgreater{} [?? x 10]}
\CommentTok{\#\textgreater{} \# Database: DuckDB v0.10.1 [root@Darwin 23.5.0:R 4.3.3/:memory:]}
\CommentTok{\#\textgreater{}   carat cut       color clarity depth table price     x     y     z}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}fct\textgreater{}     \textless{}fct\textgreater{} \textless{}fct\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}int\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1  0.23 Ideal     E     SI2      61.5    55   326  3.95  3.98  2.43}
\CommentTok{\#\textgreater{} 2  0.21 Premium   E     SI1      59.8    61   326  3.89  3.84  2.31}
\CommentTok{\#\textgreater{} 3  0.23 Good      E     VS1      56.9    65   327  4.05  4.07  2.31}
\CommentTok{\#\textgreater{} 4  0.29 Premium   I     VS2      62.4    58   334  4.2   4.23  2.63}
\CommentTok{\#\textgreater{} 5  0.31 Good      J     SI2      63.3    58   335  4.34  4.35  2.75}
\CommentTok{\#\textgreater{} 6  0.24 Very Good J     VVS2     62.8    57   336  3.94  3.96  2.48}
\CommentTok{\#\textgreater{} \# i more rows}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, titlerule=0mm, breakable, colback=white, opacityback=0, bottomtitle=1mm, colbacktitle=quarto-callout-note-color!10!white, toptitle=1mm, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{æ³¨è®°}, arc=.35mm, left=2mm, opacitybacktitle=0.6, rightrule=.15mm, bottomrule=.15mm, colframe=quarto-callout-note-color-frame, coltitle=black, leftrule=.75mm]

ä¸æ•°æ®åº“äº¤äº’æœ‰å¦å¤–ä¸¤ç§å¸¸è§æ–¹å¼ã€‚é¦–
å…ˆï¼Œè®¸å¤šä¼ä¸šæ•°æ®åº“éƒ½éå¸¸å¤§ï¼Œå› æ­¤ä½ éœ€è¦æŸç§å±‚æ¬¡ç»“æ„æ¥ä¿æŒæ‰€æœ‰è¡¨çš„ç»„ç»‡æœ‰åºã€‚åœ¨
è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½éœ€è¦æä¾›ä¸€ä¸ªæ¨¡å¼ï¼ˆschemaï¼‰ï¼Œæˆ–è€…ä¸€ä¸ªç›®å½•ï¼ˆcatalogï¼‰å’Œä¸€ä¸ªæ¨¡å¼ï¼ˆschemaï¼‰ï¼Œä»¥ä¾¿é€‰æ‹©ä½ æ„Ÿå…´è¶£çš„è¡¨ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds\_db }\OtherTok{\textless{}{-}} \FunctionTok{tbl}\NormalTok{(con, }\FunctionTok{in\_schema}\NormalTok{(}\StringTok{"sales"}\NormalTok{, }\StringTok{"diamonds"}\NormalTok{))}
\NormalTok{diamonds\_db }\OtherTok{\textless{}{-}} \FunctionTok{tbl}\NormalTok{(con, }\FunctionTok{in\_catalog}\NormalTok{(}\StringTok{"north\_america"}\NormalTok{, }\StringTok{"sales"}\NormalTok{, }\StringTok{"diamonds"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

å…¶ä»–æ—¶å€™ï¼Œä½ å¯èƒ½æƒ³ä»¥è‡ªå·±çš„SQLæŸ¥è¯¢ä½œä¸ºèµ·ç‚¹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds\_db }\OtherTok{\textless{}{-}} \FunctionTok{tbl}\NormalTok{(con, }\FunctionTok{sql}\NormalTok{(}\StringTok{"SELECT * FROM diamonds"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

è¿™ä¸ªå¯¹è±¡æ˜¯æœ‰æƒ°æ€§çš„ï¼›å½“ä½ åœ¨å®ƒä¸Šé¢ä½¿ç”¨dplyrå‡½æ•°æ—¶ï¼Œdplyrä¸ä¼šæ‰§è¡Œä»»ä½•æ“ä½œï¼Œå®ƒåªæ˜¯è®°å½•ä½ æƒ³è¦æ‰§è¡Œçš„æ“ä½œåºåˆ—ï¼Œå¹¶ä¸”åªåœ¨éœ€è¦æ—¶æ‰æ‰§è¡Œå®ƒä»¬ã€‚ä¾‹
å¦‚ï¼Œçœ‹ä¸‹é¢çš„ç®¡é“ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{big\_diamonds\_db }\OtherTok{\textless{}{-}}\NormalTok{ diamonds\_db }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(price }\SpecialCharTok{\textgreater{}} \DecValTok{15000}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(carat}\SpecialCharTok{:}\NormalTok{clarity, price)}

\NormalTok{big\_diamonds\_db}
\CommentTok{\#\textgreater{} \# Source:   SQL [?? x 5]}
\CommentTok{\#\textgreater{} \# Database: DuckDB v0.10.1 [root@Darwin 23.5.0:R 4.3.3/:memory:]}
\CommentTok{\#\textgreater{}   carat cut       color clarity price}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}fct\textgreater{}     \textless{}fct\textgreater{} \textless{}fct\textgreater{}   \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  1.54 Premium   E     VS2     15002}
\CommentTok{\#\textgreater{} 2  1.19 Ideal     F     VVS1    15005}
\CommentTok{\#\textgreater{} 3  2.1  Premium   I     SI1     15007}
\CommentTok{\#\textgreater{} 4  1.69 Ideal     D     SI1     15011}
\CommentTok{\#\textgreater{} 5  1.5  Very Good G     VVS2    15013}
\CommentTok{\#\textgreater{} 6  1.73 Very Good G     VS1     15014}
\CommentTok{\#\textgreater{} \# i more rows}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥çœ‹å‡ºè¿™ä¸ªå¯¹è±¡ä»£è¡¨ä¸€ä¸ªæ•°æ®åº“æŸ¥è¯¢ï¼Œå› ä¸ºå®ƒåœ¨é¡¶éƒ¨è¾“å‡ºDBMSçš„åç§°ï¼Œè™½ç„¶å®ƒå‘Šè¯‰ä½ åˆ—æ•°ï¼Œä½†å®ƒé€šå¸¸ä¸çŸ¥é“è¡Œæ•°ã€‚å› 
ä¸ºæŸ¥æ‰¾æ€»è¡Œæ•°é€šå¸¸éœ€è¦æ‰§è¡Œå®Œæ•´çš„æŸ¥è¯¢ï¼Œè¿™æ˜¯æˆ‘ä»¬è¯•å›¾é¿å…çš„ã€‚

ä½ å¯ä»¥é€šè¿‡dplyrå‡½æ•°\texttt{show\_query()}æ¥æŸ¥çœ‹ç”Ÿæˆçš„SQLä»£ç ã€‚å¦‚
æœä½ äº†è§£dplyrï¼Œè¿™æ˜¯ä¸€ä¸ªå­¦ä¹ SQLçš„å¥½æ–¹æ³•ï¼ç¼–
å†™ä¸€äº›dplyrä»£ç ï¼Œè®©dbplyrå°†å…¶è½¬æ¢ä¸ºSQLï¼Œç„¶åå°è¯•ç†è§£è¿™ä¸¤ç§è¯­è¨€æ˜¯å¦‚ä½•å¯¹åº”çš„ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{big\_diamonds\_db }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT carat, cut, color, clarity, price}
\CommentTok{\#\textgreater{} FROM diamonds}
\CommentTok{\#\textgreater{} WHERE (price \textgreater{} 15000.0)}
\end{Highlighting}
\end{Shaded}

è¦å°†æ‰€æœ‰æ•°æ®è¿”å›åˆ°Rä¸­ï¼Œè°ƒç”¨\texttt{collect()}å‡½æ•°ã€‚åœ¨
å¹•åï¼Œè¿™ä¸ªå‡½æ•°ä¼šç”ŸæˆSQLè¯­å¥ï¼Œè°ƒç”¨\texttt{dbGetQuery()}æ¥è·å–æ•°æ®ï¼Œç„¶åå°†ç»“æœè½¬æ¢ä¸ºä¸€ä¸ªtibbleï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{big\_diamonds }\OtherTok{\textless{}{-}}\NormalTok{ big\_diamonds\_db }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{collect}\NormalTok{()}
\NormalTok{big\_diamonds}
\CommentTok{\#\textgreater{} \# A tibble: 1,655 x 5}
\CommentTok{\#\textgreater{}   carat cut       color clarity price}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}fct\textgreater{}     \textless{}fct\textgreater{} \textless{}fct\textgreater{}   \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  1.54 Premium   E     VS2     15002}
\CommentTok{\#\textgreater{} 2  1.19 Ideal     F     VVS1    15005}
\CommentTok{\#\textgreater{} 3  2.1  Premium   I     SI1     15007}
\CommentTok{\#\textgreater{} 4  1.69 Ideal     D     SI1     15011}
\CommentTok{\#\textgreater{} 5  1.5  Very Good G     VVS2    15013}
\CommentTok{\#\textgreater{} 6  1.73 Very Good G     VS1     15014}
\CommentTok{\#\textgreater{} \# i 1,649 more rows}
\end{Highlighting}
\end{Shaded}

é€šå¸¸ï¼Œä½ ä¼šä½¿ç”¨dbplyrä»æ•°æ®åº“ä¸­é€‰æ‹©ä½ æƒ³è¦çš„æ•°æ®ï¼Œåˆ©ç”¨ä¸‹é¢æè¿°çš„è½¬æ¢æ¥è¿›è¡ŒåŸºæœ¬çš„ç­›é€‰å’Œèšåˆã€‚ç„¶
åï¼Œå½“ä½ å‡†å¤‡å¥½ä½¿ç”¨Rç‰¹æœ‰çš„å‡½æ•°æ¥åˆ†ææ•°æ®æ—¶ï¼Œä½ ä¼šä½¿ç”¨\texttt{collect()}å‡½æ•°å°†æ•°æ®æ”¶é›†åˆ°å†…å­˜ä¸­ä½œä¸ºä¸€ä¸ªtibbleï¼Œå¹¶ç»§ç»­ç”¨çº¯Rä»£ç è¿›è¡Œå·¥ä½œã€‚

\section{SQL}\label{sql}

æœ¬ç« çš„å…¶ä½™éƒ¨åˆ†å°†é€šè¿‡dbplyrçš„è§†è§’å‘ä½ ä»‹ç»ä¸€äº›SQLçŸ¥è¯†ã€‚è™½
ç„¶è¿™æ˜¯ä¸€ç§éä¼ ç»Ÿçš„SQLå…¥é—¨æ–¹å¼ï¼Œä½†æˆ‘ä»¬å¸Œæœ›å®ƒèƒ½è®©ä½ å¿«é€ŸæŒæ¡åŸºç¡€çŸ¥è¯†ã€‚å¹¸
è¿çš„æ˜¯ï¼Œå¦‚æœä½ äº†è§£dplyrï¼Œä½ å°±å·²ç»ç«™åœ¨äº†ä¸€ä¸ªå¯ä»¥å¿«é€Ÿå­¦ä¹ SQLçš„èµ·ç‚¹ä¸Šï¼Œå› ä¸ºå¾ˆå¤šæ¦‚å¿µéƒ½æ˜¯ç›¸åŒçš„ã€‚

æˆ‘ä»¬å°†ä½¿ç”¨nycflights13åŒ…ä¸­çš„ä¸¤ä¸ªè€æœ‹å‹ \texttt{flights}å’Œ\texttt{planes}
æ¥æ¢ç´¢dplyrå’ŒSQLä¹‹é—´çš„å…³ç³»ã€‚è¿™
äº›æ•°æ®é›†å¾ˆå®¹æ˜“å¯¼å…¥åˆ°æˆ‘ä»¬çš„å­¦ä¹ æ•°æ®åº“ä¸­ï¼Œå› ä¸ºdbplyræä¾›äº†ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥å°†nycflights13ä¸­çš„è¡¨å¤åˆ¶åˆ°æˆ‘ä»¬çš„æ•°æ®åº“ä¸­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dbplyr}\SpecialCharTok{::}\FunctionTok{copy\_nycflights13}\NormalTok{(con)}
\CommentTok{\#\textgreater{} Creating table: airlines}
\CommentTok{\#\textgreater{} Creating table: airports}
\CommentTok{\#\textgreater{} Creating table: flights}
\CommentTok{\#\textgreater{} Creating table: planes}
\CommentTok{\#\textgreater{} Creating table: weather}
\NormalTok{flights }\OtherTok{\textless{}{-}} \FunctionTok{tbl}\NormalTok{(con, }\StringTok{"flights"}\NormalTok{)}
\NormalTok{planes }\OtherTok{\textless{}{-}} \FunctionTok{tbl}\NormalTok{(con, }\StringTok{"planes"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{SQLåŸºç¡€}\label{sqlux57faux7840}

SQLçš„é¡¶å±‚ç»„ä»¶è¢«ç§°ä¸ºè¯­å¥ (\textbf{statements})ã€‚å¸¸
è§çš„è¯­å¥åŒ…æ‹¬ç”¨äºå®šä¹‰æ–°è¡¨çš„\texttt{CREATE}ã€ç”¨äºæ·»åŠ æ•°æ®çš„\texttt{INSERT}å’Œç”¨äºæ£€ç´¢æ•°æ®çš„\texttt{SELECT}ã€‚æˆ‘
ä»¬å°†ä¸“æ³¨äº\texttt{SELECT}è¯­å¥ï¼Œä¹Ÿç§°ä¸ºæŸ¥è¯¢
(\textbf{queries})ï¼Œå› ä¸ºä½œä¸ºæ•°æ®ç§‘å­¦å®¶ï¼Œä½ å‡ ä¹åªä¼šä½¿ç”¨å®ƒä»¬ã€‚

ä¸€ä¸ªæŸ¥è¯¢ç”±å­å¥ç»„æˆã€‚æœ‰
äº”ä¸ªé‡è¦çš„å­å¥ï¼š\texttt{SELECT}ã€\texttt{FROM}ã€\texttt{WHERE}ã€\texttt{ORDER\ BY}å’Œ\texttt{GROUP\ BY}ã€‚æ¯
ä¸ªæŸ¥è¯¢éƒ½å¿…é¡»æœ‰\texttt{SELECT}\footnote{ä»¤äººå›°æƒ‘çš„æ˜¯ï¼Œæ ¹æ®ä¸Šä¸‹æ–‡ï¼Œ\texttt{SELECT}æ—¢å¯ä»¥æ˜¯è¯­å¥ä¹Ÿå¯ä»¥æ˜¯å­å¥ã€‚ä¸º
  äº†é¿å…è¿™ç§æ··æ·†ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šä½¿ç”¨\texttt{SELECT}æŸ¥è¯¢è€Œä¸æ˜¯\texttt{SELECT}è¯­å¥ã€‚}å’Œ\texttt{FROM}\footnote{ä»æŠ€æœ¯ä¸Šæ¥è¯´ï¼Œåªæœ‰\texttt{SELECT}æ˜¯å¿…éœ€çš„ï¼Œå› ä¸ºä½ å¯ä»¥ç¼–å†™åƒ\texttt{SELECT\ 1+1}è¿™æ ·çš„æŸ¥è¯¢æ¥è¿›è¡ŒåŸºæœ¬çš„è®¡ç®—ã€‚ä½†
  å¦‚æœä½ æƒ³è¦å¤„ç†æ•°æ®ï¼ˆä½ æ€»æ˜¯è¿™æ ·åšçš„ï¼ï¼‰ï¼Œä½ ä¹Ÿéœ€è¦ä¸€ä¸ª\texttt{FROM}å­å¥ã€‚}å­å¥ï¼Œæœ€ç®€å•çš„æŸ¥è¯¢æ˜¯\texttt{SELECT\ *\ FROM\ table}ï¼Œå®ƒä»æŒ‡å®šçš„è¡¨ä¸­é€‰æ‹©æ‰€æœ‰åˆ—
ã€‚è¿™å°±æ˜¯dbplyrä¸ºä¸€ä¸ªæœªç»ä¿®æ”¹çš„è¡¨ç”Ÿæˆçš„å†…å®¹ ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT *}
\CommentTok{\#\textgreater{} FROM flights}
\NormalTok{planes }\SpecialCharTok{|\textgreater{}} \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT *}
\CommentTok{\#\textgreater{} FROM planes}
\end{Highlighting}
\end{Shaded}

\texttt{WHERE}å’Œ\texttt{ORDER\ BY}æ§åˆ¶å“ªäº›è¡Œè¢«åŒ…æ‹¬åœ¨å†…ä»¥åŠå®ƒä»¬çš„æ’åºæ–¹å¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(dest }\SpecialCharTok{==} \StringTok{"IAH"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{arrange}\NormalTok{(dep\_delay) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT flights.*}
\CommentTok{\#\textgreater{} FROM flights}
\CommentTok{\#\textgreater{} WHERE (dest = \textquotesingle{}IAH\textquotesingle{})}
\CommentTok{\#\textgreater{} ORDER BY dep\_delay}
\end{Highlighting}
\end{Shaded}

\texttt{GROUP\ BY} å°†æŸ¥è¯¢è½¬æ¢ä¸ºæ‘˜è¦æ±‡æ€»ï¼Œå¯¼è‡´å‘ç”Ÿèšåˆï¼šconverts the
query to a summary, causing aggregation to happen:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(dest) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{dep\_delay =} \FunctionTok{mean}\NormalTok{(dep\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT dest, AVG(dep\_delay) AS dep\_delay}
\CommentTok{\#\textgreater{} FROM flights}
\CommentTok{\#\textgreater{} GROUP BY dest}
\end{Highlighting}
\end{Shaded}

dplyrçš„åŠ¨è¯å’ŒSELECTå­å¥ä¹‹é—´æœ‰ä¸¤ä¸ªé‡è¦çš„åŒºåˆ«ï¼š

\begin{itemize}
\tightlist
\item
  åœ¨SQLä¸­ï¼Œå¤§å°å†™ä¸æ•æ„Ÿï¼šä½ å¯ä»¥å†™\texttt{select}ã€\texttt{SELECT}ï¼Œç”šè‡³æ˜¯\texttt{SeLeCt}ã€‚åœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬å°†åšæŒä½¿ç”¨å¸¸è§çš„çº¦å®šï¼Œå°†SQLå…³é”®å­—å¤§å†™ä»¥åŒºåˆ«äºè¡¨åæˆ–å˜é‡åã€‚
\item
  åœ¨SQLä¸­ï¼Œé¡ºåºå¾ˆé‡è¦ï¼šä½ å¿…é¡»å§‹ç»ˆæŒ‰ç…§\texttt{SELECT}ã€\texttt{FROM}ã€\texttt{WHERE}ã€\texttt{GROUP\ BY}ã€\texttt{ORDER\ BY}çš„é¡ºåºç¼–å†™å­å¥ã€‚ä»¤äººå›°æƒ‘çš„æ˜¯ï¼Œè¿™ä¸ªé¡ºåºå¹¶ä¸åŒ¹é…å­å¥å®é™…è¯„ä¼°çš„é¡ºåºï¼Œå®é™…çš„é¡ºåºæ˜¯é¦–å…ˆ\texttt{FROM}ï¼Œç„¶åæ˜¯\texttt{WHERE}ï¼Œ\texttt{GROUP\ BY}ï¼Œ\texttt{SELECT}ï¼Œæœ€åæ˜¯\texttt{ORDER\ BY}ã€‚
\end{itemize}

ä»¥ä¸‹éƒ¨åˆ†å°†æ›´è¯¦ç»†åœ°æ¢è®¨æ¯ä¸ªå­å¥ã€‚

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, titlerule=0mm, breakable, colback=white, opacityback=0, bottomtitle=1mm, colbacktitle=quarto-callout-note-color!10!white, toptitle=1mm, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{æ³¨è®°}, arc=.35mm, left=2mm, opacitybacktitle=0.6, rightrule=.15mm, bottomrule=.15mm, colframe=quarto-callout-note-color-frame, coltitle=black, leftrule=.75mm]

è¯·æ³¨æ„ï¼Œå°½ç®¡SQLæ˜¯ä¸€ä¸ªæ ‡å‡†ï¼Œä½†å®ƒéå¸¸å¤æ‚ï¼Œæ²¡æœ‰å“ªä¸ªæ•°æ®åº“èƒ½å¤Ÿå®Œå…¨éµå¾ªå®ƒã€‚å°½
ç®¡æœ¬ä¹¦å…³æ³¨çš„ä¸»è¦ç»„ä»¶åœ¨ä¸åŒçš„DBMSä¹‹é—´éå¸¸ç›¸ä¼¼ï¼Œä½†ä»å­˜åœ¨è®¸å¤šç»†å¾®çš„å·®å¼‚ã€‚å¹¸
è¿çš„æ˜¯ï¼Œdbplyrå¯ä»¥ç”¨æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ä¸ºä¸åŒçš„æ•°æ®åº“ç”Ÿæˆä¸åŒçš„ç¿»è¯‘ã€‚å®ƒ
å¹¶ä¸å®Œç¾ï¼Œä½†æ­£åœ¨ä¸æ–­æ”¹è¿›ï¼Œå¦‚æœä½ é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥åœ¨\href{https://github.com/tidyverse/dbplyr/issues/}{GitHub}ä¸Šæäº¤ä¸€ä¸ªé—®é¢˜æ¥å¸®åŠ©æˆ‘ä»¬åšå¾—æ›´å¥½ã€‚

\end{tcolorbox}

\subsection{SELECT}\label{select}

\texttt{SELECT}å­å¥æ˜¯æŸ¥è¯¢çš„æ”¯æŸ±ï¼Œæ‰§è¡Œä¸\texttt{select()},
\texttt{mutate()}, \texttt{rename()}, \texttt{relocate()}
ä»¥åŠä½ å°†åœ¨ä¸‹ä¸€èŠ‚å­¦åˆ°çš„\texttt{summarize()}ç›¸åŒçš„å·¥ä½œã€‚

\texttt{select()}, \texttt{rename()} å’Œ \texttt{relocate()}
åœ¨SQLçš„\texttt{SELECT}ä¸­æœ‰éå¸¸ç›´æ¥çš„å¯¹åº”å…³ç³»ï¼Œå› ä¸ºå®ƒä»¬åªæ˜¯å½±å“åˆ—å‡ºç°çš„ä½ç½®ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰åŠå…¶åç§°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{planes }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(tailnum, type, manufacturer, model, year) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT tailnum, "type", manufacturer, model, "year"}
\CommentTok{\#\textgreater{} FROM planes}

\NormalTok{planes }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(tailnum, type, manufacturer, model, year) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{rename}\NormalTok{(}\AttributeTok{year\_built =}\NormalTok{ year) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT tailnum, "type", manufacturer, model, "year" AS year\_built}
\CommentTok{\#\textgreater{} FROM planes}

\NormalTok{planes }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(tailnum, type, manufacturer, model, year) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{relocate}\NormalTok{(manufacturer, model, }\AttributeTok{.before =}\NormalTok{ type) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT tailnum, manufacturer, model, "type", "year"}
\CommentTok{\#\textgreater{} FROM planes}
\end{Highlighting}
\end{Shaded}

è¿™ä¸ªä¾‹å­è¿˜å±•ç¤ºäº†SQLå¦‚ä½•è¿›è¡Œé‡å‘½åã€‚åœ¨
SQLæœ¯è¯­ä¸­é‡å‘½åè¢«ç§°ä¸ºåˆ«åï¼ˆ\textbf{aliasing}ï¼‰ï¼Œå¹¶é€šè¿‡\texttt{AS}å…³é”®å­—æ¥å®Œæˆã€‚è¯·
æ³¨æ„ï¼Œä¸\texttt{mutate()}ä¸åŒï¼Œæ—§åç§°åœ¨å·¦ä¾§ï¼Œæ–°åç§°åœ¨å³ä¾§ã€‚

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, titlerule=0mm, breakable, colback=white, opacityback=0, bottomtitle=1mm, colbacktitle=quarto-callout-note-color!10!white, toptitle=1mm, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{æ³¨è®°}, arc=.35mm, left=2mm, opacitybacktitle=0.6, rightrule=.15mm, bottomrule=.15mm, colframe=quarto-callout-note-color-frame, coltitle=black, leftrule=.75mm]

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œè¯·æ³¨æ„``year''å’Œ``type''è¢«åŒå¼•å·æ‹¬èµ·æ¥äº†ã€‚è¿™
æ˜¯å› ä¸ºè¿™äº›æ˜¯duckdbä¸­çš„ä¿ç•™å­— (\textbf{reserved
words})ï¼Œæ‰€ä»¥dbplyrå°†å®ƒä»¬ç”¨å¼•å·æ‹¬èµ·æ¥ä»¥é¿å…åˆ—/è¡¨åä¸SQLè¿ç®—ç¬¦ä¹‹é—´çš„ä»»ä½•æ½œåœ¨æ··æ·†ã€‚

å½“ä¸å…¶ä»–æ•°æ®åº“ä¸€èµ·å·¥ä½œæ—¶ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°æ¯ä¸ªå˜é‡åéƒ½è¢«å¼•ç”¨äº†ï¼Œå› ä¸ºåªæœ‰å°‘æ•°å‡ ä¸ªå®¢æˆ·ç«¯åŒ…ï¼ˆå¦‚duckdbï¼‰çŸ¥é“æ‰€æœ‰çš„ä¿ç•™å­—æ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥å®ƒä»¬ä¸ºäº†å®‰å…¨èµ·è§ï¼Œå°†æ‰€æœ‰å†…å®¹éƒ½åŠ ä¸Šå¼•å·ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{SELECT} \OtherTok{"tailnum"}\NormalTok{, }\OtherTok{"type"}\NormalTok{, }\OtherTok{"manufacturer"}\NormalTok{, }\OtherTok{"model"}\NormalTok{, }\OtherTok{"year"}
\KeywordTok{FROM} \OtherTok{"planes"}
\end{Highlighting}
\end{Shaded}

å…¶ä»–ä¸€äº›æ•°æ®åº“ç³»ç»Ÿä½¿ç”¨åå¼•å·ä»£æ›¿å¼•å·:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{SELECT}\NormalTok{ \textasciigrave{}tailnum\textasciigrave{}, \textasciigrave{}type\textasciigrave{}, \textasciigrave{}manufacturer\textasciigrave{}, \textasciigrave{}model\textasciigrave{}, \textasciigrave{}year\textasciigrave{}}
\KeywordTok{FROM}\NormalTok{ \textasciigrave{}planes\textasciigrave{}}
\end{Highlighting}
\end{Shaded}

\end{tcolorbox}

\texttt{mutate()}çš„è½¬æ¢åŒæ ·ç›´æ¥ï¼šæ¯ä¸ªå˜é‡éƒ½æˆä¸º\texttt{SELECT}ä¸­çš„ä¸€ä¸ªæ–°è¡¨è¾¾å¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{speed =}\NormalTok{ distance }\SpecialCharTok{/}\NormalTok{ (air\_time }\SpecialCharTok{/} \DecValTok{60}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT flights.*, distance / (air\_time / 60.0) AS speed}
\CommentTok{\#\textgreater{} FROM flights}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å°†åœ¨ å°èŠ‚~\ref{sec-sql-expressions} è®¨è®ºå•ä¸ªç»„ä»¶ (å¦‚\texttt{/})
çš„è½¬æ¢ã€‚

\subsection{FROM}\label{from}

\texttt{FROM}å­å¥å®šä¹‰æ•°æ®æºã€‚è¿™
ä¸€æ®µæ—¶é—´ä½ ä¼šå¾ˆæ— è¶£ï¼Œå› ä¸ºæˆ‘ä»¬åªæ˜¯åœ¨ç”¨å•è¡¨ã€‚åœ¨
å­¦ä¹ è¿æ¥å‡½æ•°ä¹‹åï¼Œä½ å°†çœ‹åˆ°æ›´å¤æ‚çš„ç¤ºä¾‹ã€‚

\subsection{GROUP BY}\label{group-by}

\texttt{group\_by()}è¢«è½¬æ¢æˆ \texttt{GROUP\ BY}\footnote{è¿™å¹¶éå·§åˆ:dplyrå‡½æ•°åç§°çš„çµæ„Ÿæ¥è‡ªSQLå­å¥ã€‚}
å­å¥ï¼Œè€Œ\texttt{summarize()}è¢«è½¬æ¢æˆ \texttt{SELECT} å­å¥ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds\_db }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(cut) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{avg\_price =} \FunctionTok{mean}\NormalTok{(price, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT cut, COUNT(*) AS n, AVG(price) AS avg\_price}
\CommentTok{\#\textgreater{} FROM diamonds}
\CommentTok{\#\textgreater{} GROUP BY cut}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å°†å›å¤´åœ¨ å°èŠ‚~\ref{sec-sql-expressions} è®¨è®º
\texttt{n()}å’Œ\texttt{mean()}çš„è½¬æ¢æ˜¯å¦‚ä½•è¿›è¡Œçš„ã€‚

\subsection{WHERE}\label{where}

\texttt{filter()} è½¬æ¢æˆ \texttt{WHERE} å­å¥:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(dest }\SpecialCharTok{==} \StringTok{"IAH"} \SpecialCharTok{|}\NormalTok{ dest }\SpecialCharTok{==} \StringTok{"HOU"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT flights.*}
\CommentTok{\#\textgreater{} FROM flights}
\CommentTok{\#\textgreater{} WHERE (dest = \textquotesingle{}IAH\textquotesingle{} OR dest = \textquotesingle{}HOU\textquotesingle{})}

\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(arr\_delay }\SpecialCharTok{\textgreater{}} \DecValTok{0} \SpecialCharTok{\&}\NormalTok{ arr\_delay }\SpecialCharTok{\textless{}} \DecValTok{20}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT flights.*}
\CommentTok{\#\textgreater{} FROM flights}
\CommentTok{\#\textgreater{} WHERE (arr\_delay \textgreater{} 0.0 AND arr\_delay \textless{} 20.0)}
\end{Highlighting}
\end{Shaded}

è¿™é‡Œæœ‰å‡ ä¸ªé‡è¦çš„ç»†èŠ‚éœ€è¦æ³¨æ„ï¼š

\begin{itemize}
\tightlist
\item
  \texttt{\textbar{}} å˜æˆäº† \texttt{OR}ï¼Œ è€Œ \texttt{\&} å˜æˆäº†
  \texttt{AND}.
\item
  SQL ä½¿ç”¨ \texttt{=} è¿›è¡Œæ¯”è¾ƒï¼Œè€Œä¸æ˜¯ \texttt{==}ã€‚SQL
  æ²¡æœ‰èµ‹å€¼æ“ä½œï¼Œæ‰€ä»¥åœ¨è¿™æ–¹é¢æ²¡æœ‰æ··æ·†çš„å¯èƒ½æ€§ã€‚
\item
  SQL åªä½¿ç”¨å•å¼•å· \texttt{\textquotesingle{}\textquotesingle{}}
  æ¥æ ‡è¯†å­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯åŒå¼•å· \texttt{""}ã€‚åœ¨ SQL ä¸­ï¼ŒåŒå¼•å· \texttt{""}
  ç”¨äºæ ‡è¯†å˜é‡ï¼Œç±»ä¼¼äº R ä¸­çš„åå¼•å·
  \texttt{\textasciigrave{}\textasciigrave{}}ã€‚
\end{itemize}

å¦ä¸€ä¸ªæœ‰ç”¨çš„ SQL æ“ä½œç¬¦æ˜¯ \texttt{IN}ï¼Œå®ƒä¸ R ä¸­çš„ \texttt{\%in\%}
éå¸¸æ¥è¿‘ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(dest }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"IAH"}\NormalTok{, }\StringTok{"HOU"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT flights.*}
\CommentTok{\#\textgreater{} FROM flights}
\CommentTok{\#\textgreater{} WHERE (dest IN (\textquotesingle{}IAH\textquotesingle{}, \textquotesingle{}HOU\textquotesingle{}))}
\end{Highlighting}
\end{Shaded}

SQL ä½¿ç”¨ \texttt{NULL} è€Œä¸æ˜¯ \texttt{NA}ã€‚\texttt{N} \texttt{ULL}
çš„è¡Œä¸ºä¸ \texttt{NA} ç±»ä¼¼ã€‚ä¸»
è¦åŒºåˆ«åœ¨äºè™½ç„¶å®ƒä»¬åœ¨æ¯”è¾ƒå’Œç®—æœ¯è¿ç®—ä¸­å…·æœ‰``ä¼ æŸ“æ€§''ï¼Œä½†åœ¨æ±‡æ€»æ—¶å®ƒä»¬ä¼šè¢«é™é»˜åœ°åˆ é™¤ã€‚å½“
ä½ ç¬¬ä¸€æ¬¡é‡åˆ°è¿™ç§è¡Œä¸ºæ—¶ï¼Œdbplyr ä¼šæé†’ä½ æ³¨æ„è¿™ä¸€ç‚¹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(dest) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{delay =} \FunctionTok{mean}\NormalTok{(arr\_delay))}
\CommentTok{\#\textgreater{} Warning: Missing values are always removed in SQL aggregation functions.}
\CommentTok{\#\textgreater{} Use \textasciigrave{}na.rm = TRUE\textasciigrave{} to silence this warning}
\CommentTok{\#\textgreater{} This warning is displayed once every 8 hours.}
\CommentTok{\#\textgreater{} \# Source:   SQL [?? x 2]}
\CommentTok{\#\textgreater{} \# Database: DuckDB v0.10.1 [root@Darwin 23.5.0:R 4.3.3/:memory:]}
\CommentTok{\#\textgreater{}   dest  delay}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 IAH    4.24}
\CommentTok{\#\textgreater{} 2 MDW   12.4 }
\CommentTok{\#\textgreater{} 3 CLT    7.36}
\CommentTok{\#\textgreater{} 4 CAK   19.7 }
\CommentTok{\#\textgreater{} 5 HOU    7.18}
\CommentTok{\#\textgreater{} 6 PHX    2.10}
\CommentTok{\#\textgreater{} \# i more rows}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº \texttt{NULL} æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä½ å¯èƒ½ä¼šå–œæ¬¢ Markus
Winand çš„ã€Š\href{https://modern-sql.com/concept/three-valued-logic}{The
Three-Valued Logic of SQL}ã€‹ã€‚

é€šå¸¸ï¼Œä½ å¯ä»¥ä½¿ç”¨åœ¨ R ä¸­ç”¨äºå¤„ç† \texttt{NA} çš„å‡½æ•°æ¥å¤„ç† \texttt{NULL}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(dep\_delay)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT flights.*}
\CommentTok{\#\textgreater{} FROM flights}
\CommentTok{\#\textgreater{} WHERE (NOT((dep\_delay IS NULL)))}
\end{Highlighting}
\end{Shaded}

è¿™ä¸ª SQL æŸ¥è¯¢å±•ç¤ºäº† dbplyr çš„ä¸€ä¸ªç¼ºç‚¹ï¼šè™½ç„¶ SQL
æ˜¯æ­£ç¡®çš„ï¼Œä½†å®ƒå¹¶ä¸åƒä½ æ‰‹åŠ¨ç¼–å†™æ—¶é‚£æ ·ç®€å•ã€‚åœ¨
è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥å»æ‰æ‹¬å·ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªæ›´æ˜“è¯»çš„ç‰¹æ®Šæ“ä½œç¬¦ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{WHERE} \OtherTok{"dep\_delay"} \KeywordTok{IS} \KeywordTok{NOT} \KeywordTok{NULL}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„ï¼Œå¦‚æœä½ å¯¹ä¸€ä¸ªé€šè¿‡\texttt{summarize()}åˆ›å»ºçš„å˜é‡è¿›è¡Œ\texttt{filter()}æ“ä½œï¼Œdbplyr
ä¼šç”Ÿæˆä¸€ä¸ª \texttt{HAVING} å­å¥ï¼Œè€Œä¸æ˜¯ \texttt{WHERE} å­å¥ã€‚è¿™ æ˜¯ SQL
çš„ä¸€ä¸ªç‰¹æ€§ï¼š\texttt{WHERE} å­å¥åœ¨ \texttt{SELECT} å’Œ \texttt{GROUP\ BY}
ä¹‹å‰è¯„ä¼°ï¼Œæ‰€ä»¥ SQL éœ€è¦å¦ä¸€ä¸ªåœ¨ä¹‹åè¯„ä¼°çš„å­å¥ï¼Œè¿™å°±æ˜¯ \texttt{HAVING}
å­å¥ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds\_db }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(cut) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{n =} \FunctionTok{n}\NormalTok{()) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(n }\SpecialCharTok{\textgreater{}} \DecValTok{100}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT cut, COUNT(*) AS n}
\CommentTok{\#\textgreater{} FROM diamonds}
\CommentTok{\#\textgreater{} GROUP BY cut}
\CommentTok{\#\textgreater{} HAVING (COUNT(*) \textgreater{} 100.0)}
\end{Highlighting}
\end{Shaded}

\subsection{ORDER BY}\label{order-by}

å¯¹è¡Œè¿›è¡Œæ’åºæ¶‰åŠä»\texttt{arrange()}åˆ°\texttt{ORDER\ BY}å­å¥çš„ç›´æ¥è½¬æ¢ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{arrange}\NormalTok{(year, month, day, }\FunctionTok{desc}\NormalTok{(dep\_delay)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT flights.*}
\CommentTok{\#\textgreater{} FROM flights}
\CommentTok{\#\textgreater{} ORDER BY "year", "month", "day", dep\_delay DESC}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„\texttt{desc()}æ˜¯å¦‚ä½•è¢«è½¬æ¢æˆ\texttt{DESC}çš„ï¼šè¿™æ˜¯è®¸å¤šç›´æ¥å—åˆ°SQLå¯å‘çš„dplyrå‡½æ•°ä¹‹ä¸€ã€‚

\subsection{å­æŸ¥è¯¢ (Subqueries)}\label{ux5b50ux67e5ux8be2-subqueries}

æœ‰æ—¶ï¼Œæ— æ³•å°†dplyrç®¡é“è½¬æ¢æˆå•ä¸ª\texttt{SELECT}è¯­å¥ï¼Œè¿™æ—¶å°±éœ€è¦ä½¿ç”¨å­æŸ¥è¯¢ã€‚å­
æŸ¥è¯¢åªæ˜¯åœ¨\texttt{FROM}å­å¥ä¸­ç”¨ä½œæ•°æ®æºï¼Œè€Œä¸æ˜¯é€šå¸¸çš„è¡¨ã€‚

dbplyré€šå¸¸ä½¿ç”¨å­æŸ¥è¯¢æ¥å…‹æœSQLçš„é™åˆ¶ã€‚ä¾‹
å¦‚ï¼Œ\texttt{SELECT}å­å¥ä¸­çš„è¡¨è¾¾å¼ä¸èƒ½å¼•ç”¨åˆšåˆšåˆ›å»ºçš„åˆ—ã€‚è¿™
æ„å‘³ç€ä»¥ä¸‹ï¼ˆæ„šè ¢çš„ï¼‰dplyrç®¡é“éœ€è¦åˆ†ä¸¤æ­¥è¿›è¡Œï¼šç¬¬ä¸€ä¸ªï¼ˆå†…éƒ¨ï¼‰æŸ¥è¯¢è®¡ç®—\texttt{year1}ï¼Œç„¶åç¬¬äºŒä¸ªï¼ˆå¤–éƒ¨ï¼‰æŸ¥è¯¢å¯ä»¥è®¡ç®—\texttt{year2}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{year1 =}\NormalTok{ year }\SpecialCharTok{+} \DecValTok{1}\NormalTok{,}
    \AttributeTok{year2 =}\NormalTok{ year1 }\SpecialCharTok{+} \DecValTok{1}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT q01.*, year1 + 1.0 AS year2}
\CommentTok{\#\textgreater{} FROM (}
\CommentTok{\#\textgreater{}   SELECT flights.*, "year" + 1.0 AS year1}
\CommentTok{\#\textgreater{}   FROM flights}
\CommentTok{\#\textgreater{} ) q01}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ è¯•å›¾å¯¹åˆšåˆšåˆ›å»ºçš„å˜é‡è¿›è¡Œ\texttt{filter()}æ“ä½œï¼Œä½ ä¹Ÿä¼šé‡åˆ°è¿™ä¸ªé—®é¢˜ã€‚è¯·
è®°ä½ï¼Œå°½ç®¡\texttt{WHERE}åœ¨\texttt{SELECT}ä¹‹åç¼–å†™ï¼Œä½†å®ƒæ˜¯åœ¨\texttt{SELECT}ä¹‹å‰è¯„ä¼°çš„ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªï¼ˆæ„šè ¢çš„ï¼‰ä¾‹å­ä¸­æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå­æŸ¥è¯¢ã€‚

You'll also see this if you attempted to \texttt{filter()} a variable
that you just created. Remember, even though \texttt{WHERE} is written
after \texttt{SELECT}, it's evaluated before it, so we need a subquery
in this (silly) example:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{year1 =}\NormalTok{ year }\SpecialCharTok{+} \DecValTok{1}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(year1 }\SpecialCharTok{==} \DecValTok{2014}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT q01.*}
\CommentTok{\#\textgreater{} FROM (}
\CommentTok{\#\textgreater{}   SELECT flights.*, "year" + 1.0 AS year1}
\CommentTok{\#\textgreater{}   FROM flights}
\CommentTok{\#\textgreater{} ) q01}
\CommentTok{\#\textgreater{} WHERE (year1 = 2014.0)}
\end{Highlighting}
\end{Shaded}

æœ‰æ—¶ï¼Œdbplyr
ä¼šåœ¨ä¸éœ€è¦å­æŸ¥è¯¢çš„æƒ…å†µä¸‹åˆ›å»ºå­æŸ¥è¯¢ï¼Œå› ä¸ºå®ƒè¿˜ä¸çŸ¥é“å¦‚ä½•ä¼˜åŒ–è¿™ç§è½¬æ¢ã€‚éš
ç€æ—¶é—´çš„æ¨ç§»ï¼Œdbplyr
çš„æ”¹è¿›ä¼šä½¿è¿™ç§æƒ…å†µè¶Šæ¥è¶Šå°‘ï¼Œä½†å¯èƒ½æ°¸è¿œä¸ä¼šå®Œå…¨æ¶ˆå¤±ã€‚

\subsection{Joins}\label{joins}

å¦‚æœä½ ç†Ÿæ‚‰dplyrçš„è¿æ¥ï¼ˆjoinsï¼‰ï¼Œé‚£ä¹ˆSQLçš„è¿æ¥æ˜¯éå¸¸ç›¸ä¼¼çš„ã€‚ä¸‹
é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{left\_join}\NormalTok{(planes }\SpecialCharTok{|\textgreater{}} \FunctionTok{rename}\NormalTok{(}\AttributeTok{year\_built =}\NormalTok{ year), }\AttributeTok{by =} \StringTok{"tailnum"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{show\_query}\NormalTok{()}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT}
\CommentTok{\#\textgreater{}   flights.*,}
\CommentTok{\#\textgreater{}   planes."year" AS year\_built,}
\CommentTok{\#\textgreater{}   "type",}
\CommentTok{\#\textgreater{}   manufacturer,}
\CommentTok{\#\textgreater{}   model,}
\CommentTok{\#\textgreater{}   engines,}
\CommentTok{\#\textgreater{}   seats,}
\CommentTok{\#\textgreater{}   speed,}
\CommentTok{\#\textgreater{}   engine}
\CommentTok{\#\textgreater{} FROM flights}
\CommentTok{\#\textgreater{} LEFT JOIN planes}
\CommentTok{\#\textgreater{}   ON (flights.tailnum = planes.tailnum)}
\end{Highlighting}
\end{Shaded}

è¿™é‡Œéœ€è¦æ³¨æ„çš„ä¸»è¦æ˜¯è¯­æ³•ï¼šSQL è¿æ¥ä½¿ç”¨ \texttt{FROM}
å­å¥çš„å­å¥æ¥å¼•å…¥å…¶ä»–è¡¨ï¼Œå¹¶ä½¿ç”¨ \texttt{ON} æ¥å®šä¹‰è¡¨ä¹‹é—´çš„å…³ç³»ã€‚

dplyr ä¸­è¿™äº›å‡½æ•°çš„å‘½åä¸ SQL å¦‚æ­¤ç´§å¯†ç›¸å…³ï¼Œä»¥è‡³äºä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°çŒœå‡º
\texttt{inner\_join()}ã€\texttt{right\_join()} å’Œ \texttt{full\_join()}
çš„ç­‰æ•ˆ SQL è¯­å¥ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{SELECT}\NormalTok{ flights.}\OperatorTok{*}\NormalTok{, }\OtherTok{"type"}\NormalTok{, manufacturer, model, engines, seats, speed}
\KeywordTok{FROM}\NormalTok{ flights}
\KeywordTok{INNER} \KeywordTok{JOIN}\NormalTok{ planes }\KeywordTok{ON}\NormalTok{ (flights.tailnum }\OperatorTok{=}\NormalTok{ planes.tailnum)}

\KeywordTok{SELECT}\NormalTok{ flights.}\OperatorTok{*}\NormalTok{, }\OtherTok{"type"}\NormalTok{, manufacturer, model, engines, seats, speed}
\KeywordTok{FROM}\NormalTok{ flights}
\KeywordTok{RIGHT} \KeywordTok{JOIN}\NormalTok{ planes }\KeywordTok{ON}\NormalTok{ (flights.tailnum }\OperatorTok{=}\NormalTok{ planes.tailnum)}

\KeywordTok{SELECT}\NormalTok{ flights.}\OperatorTok{*}\NormalTok{, }\OtherTok{"type"}\NormalTok{, manufacturer, model, engines, seats, speed}
\KeywordTok{FROM}\NormalTok{ flights}
\KeywordTok{FULL} \KeywordTok{JOIN}\NormalTok{ planes }\KeywordTok{ON}\NormalTok{ (flights.tailnum }\OperatorTok{=}\NormalTok{ planes.tailnum)}
\end{Highlighting}
\end{Shaded}

å½“ä»æ•°æ®åº“ä¸­å¤„ç†æ•°æ®æ—¶ï¼Œä½ å¯èƒ½éœ€è¦å¾ˆå¤šè¿æ¥æ“ä½œã€‚è¿™
æ˜¯å› ä¸ºæ•°æ®åº“è¡¨é€šå¸¸ä»¥é«˜åº¦è§„èŒƒåŒ–çš„å½¢å¼å­˜å‚¨ï¼Œå…¶ä¸­æ¯ä¸ª``äº‹å®''éƒ½å­˜å‚¨åœ¨å•ä¸ªä½ç½®ï¼Œä¸ºäº†ä¿æŒå®Œæ•´çš„æ•°æ®é›†ä»¥ä¾›åˆ†æï¼Œä½ éœ€è¦éå†ç”±ä¸»é”®å’Œå¤–é”®è¿æ¥çš„å¤æ‚è¡¨ç½‘ç»œã€‚å¦‚
æœä½ é‡åˆ°è¿™ç§æƒ…å†µï¼ŒTobias Schieferdeckerã€Kirill MÃ¼ller å’Œ Darko Bergant
å¼€å‘çš„ \href{https://cynkra.github.io/dm/}{dm} åŒ…å°†æ˜¯ä¸€ä¸ªæ•‘æ˜Ÿã€‚å®ƒ
å¯ä»¥ä½¿ç”¨ DBA
é€šå¸¸æä¾›çš„çº¦æŸè‡ªåŠ¨ç¡®å®šè¡¨ä¹‹é—´çš„è¿æ¥ï¼Œå¯è§†åŒ–è¿™äº›è¿æ¥ä»¥ä¾¿ä½ å¯ä»¥çœ‹åˆ°å‘ç”Ÿäº†ä»€ä¹ˆï¼Œå¹¶ç”Ÿæˆä½ éœ€è¦çš„è¿æ¥æ¥å°†ä¸€ä¸ªè¡¨è¿æ¥åˆ°å¦ä¸€ä¸ªè¡¨ã€‚

\subsection{å…¶ä»–å‡½æ•°}\label{ux5176ux4ed6ux51fdux6570}

dbplyr
è¿˜ç¿»è¯‘äº†å…¶ä»–å‡½æ•°ï¼Œå¦‚\texttt{distinct()}ã€\texttt{slice\_*()}ã€å’Œ\texttt{intersect()}
ä»¥åŠè¶Šæ¥è¶Šå¤šçš„ tidyr
å‡½æ•°ï¼Œå¦‚\texttt{pivot\_longer()}å’Œ\texttt{pivot\_wider()}ã€‚æŸ¥
çœ‹å½“å‰å¯ç”¨çš„å®Œæ•´é›†åˆçš„æœ€ç®€å•æ–¹æ³•æ˜¯è®¿é—® dbplyr
ç½‘ç«™ï¼š\href{https://dbplyr.tidyverse.org/reference/\%E3\%80\%82}{https://dbplyr.tidyverse.org/reference/}
ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-54}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \texttt{distinct()} è¢«è½¬æ¢æˆä»€ä¹ˆï¼Ÿ é‚£ä¹ˆ\texttt{head()}å‘¢ï¼Ÿ
\item
  è§£é‡Šä¸‹é¢æ¯ä¸ªSQLæŸ¥è¯¢çš„ä½œç”¨ï¼Œå¹¶å°è¯•ä½¿ç”¨dbplyré‡æ–°åˆ›å»ºå®ƒä»¬ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{SELECT} \OperatorTok{*} 
\KeywordTok{FROM}\NormalTok{ flights}
\KeywordTok{WHERE}\NormalTok{ dep\_delay }\OperatorTok{\textless{}}\NormalTok{ arr\_delay}

\KeywordTok{SELECT} \OperatorTok{*}\NormalTok{, distance }\OperatorTok{/}\NormalTok{ (air\_time }\OperatorTok{/} \DecValTok{60}\NormalTok{) }\KeywordTok{AS}\NormalTok{ speed}
\KeywordTok{FROM}\NormalTok{ flights}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{å‡½æ•°è½¬æ¢}\label{sec-sql-expressions}

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨äº† dplyr å‡½æ•°å¦‚ä½•è¢«è½¬æ¢æˆæŸ¥è¯¢çš„å­å¥ã€‚ç°
åœ¨æˆ‘ä»¬å°†ç¨å¾®æ·±å…¥ä¸€äº›ï¼Œè®¨è®ºä¸å•ä¸ªåˆ—ä¸€èµ·å·¥ä½œçš„ R
å‡½æ•°çš„è½¬æ¢ï¼Œä¾‹å¦‚ï¼Œå½“ä½ åœ¨\texttt{summarize()}ä¸­ä½¿ç”¨\texttt{mean(x)}æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

ä¸ºäº†å¸®åŠ©æˆ‘ä»¬äº†è§£æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å‡ ä¸ªè¾…åŠ©å‡½æ•°æ¥è¿è¡Œ\texttt{summarize()}æˆ–\texttt{mutate()}å¹¶æ˜¾ç¤ºç”Ÿæˆçš„
SQLã€‚è¿™ å°†ä½¿æ¢ç´¢ä¸€äº›å˜ä½“ä»¥åŠæ±‡æ€»å’Œè½¬æ¢å¦‚ä½•ä¸åŒå˜å¾—æ›´åŠ å®¹æ˜“ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{summarize\_query }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, ...) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{summarize}\NormalTok{(...) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{show\_query}\NormalTok{()}
\NormalTok{\}}
\NormalTok{mutate\_query }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, ...) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{mutate}\NormalTok{(..., }\AttributeTok{.keep =} \StringTok{"none"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{show\_query}\NormalTok{()}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

è®©æˆ‘ä»¬æ·±å…¥ä¸€äº›æ±‡æ€»ï¼æŸ¥
çœ‹ä¸‹é¢çš„ä»£ç ï¼Œä½ ä¼šæ³¨æ„åˆ°ä¸€äº›æ±‡æ€»å‡½æ•°ï¼Œå¦‚\texttt{mean()}ï¼Œå…¶è½¬æ¢ç›¸å¯¹ç®€å•ï¼Œè€Œå…¶ä»–ä¸€äº›å‡½æ•°ï¼Œå¦‚\texttt{median()}åˆ™å¤æ‚å¾—å¤šã€‚è¿™
ç§å¤æ‚æ€§é€šå¸¸å‡ºç°åœ¨ç»Ÿè®¡å­¦ä¸­å¸¸è§ä½†åœ¨æ•°æ®åº“ä¸­ä¸å¤ªå¸¸è§çš„æ“ä½œä¸­ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(year, month, day) }\SpecialCharTok{|\textgreater{}}  
  \FunctionTok{summarize\_query}\NormalTok{(}
    \AttributeTok{mean =} \FunctionTok{mean}\NormalTok{(arr\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{median =} \FunctionTok{median}\NormalTok{(arr\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \textasciigrave{}summarise()\textasciigrave{} has grouped output by "year" and "month". You can override}
\CommentTok{\#\textgreater{} using the \textasciigrave{}.groups\textasciigrave{} argument.}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT}
\CommentTok{\#\textgreater{}   "year",}
\CommentTok{\#\textgreater{}   "month",}
\CommentTok{\#\textgreater{}   "day",}
\CommentTok{\#\textgreater{}   AVG(arr\_delay) AS mean,}
\CommentTok{\#\textgreater{}   PERCENTILE\_CONT(0.5) WITHIN GROUP (ORDER BY arr\_delay) AS median}
\CommentTok{\#\textgreater{} FROM flights}
\CommentTok{\#\textgreater{} GROUP BY "year", "month", "day"}
\end{Highlighting}
\end{Shaded}

å½“åœ¨\texttt{mutate()}å†…éƒ¨ä½¿ç”¨æ±‡æ€»å‡½æ•°æ—¶ï¼Œå…¶è½¬æ¢ä¼šå˜å¾—æ›´åŠ å¤æ‚ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦å˜æˆæ‰€è°“çš„çª—å£
(\textbf{window}) å‡½æ•°ã€‚åœ¨ SQL
ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨èšåˆå‡½æ•°åé¢æ·»åŠ \texttt{OVER}æ¥å°†å…¶è½¬å˜ä¸ºçª—å£å‡½æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(year, month, day) }\SpecialCharTok{|\textgreater{}}  
  \FunctionTok{mutate\_query}\NormalTok{(}
    \AttributeTok{mean =} \FunctionTok{mean}\NormalTok{(arr\_delay, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT}
\CommentTok{\#\textgreater{}   "year",}
\CommentTok{\#\textgreater{}   "month",}
\CommentTok{\#\textgreater{}   "day",}
\CommentTok{\#\textgreater{}   AVG(arr\_delay) OVER (PARTITION BY "year", "month", "day") AS mean}
\CommentTok{\#\textgreater{} FROM flights}
\end{Highlighting}
\end{Shaded}

åœ¨ SQL
ä¸­ï¼Œ\texttt{GROUP\ BY}å­å¥ä¸“é—¨ç”¨äºæ±‡æ€»ï¼Œå› æ­¤ä½ å¯ä»¥çœ‹åˆ°åˆ†ç»„å·²ç»ä»\texttt{PARTITION\ BY}å‚æ•°ç§»åŠ¨åˆ°äº†\texttt{OVER}å­å¥ä¸­ã€‚

çª—å£å‡½æ•°åŒ…æ‹¬æ‰€æœ‰å‘å‰æˆ–å‘åæŸ¥çœ‹çš„å‡½æ•°ï¼Œå¦‚\texttt{lead()}å’Œ\texttt{lag()}ï¼Œå®ƒä»¬åˆ†åˆ«æŸ¥çœ‹``å‰ä¸€ä¸ª''æˆ–``åä¸€ä¸ª''å€¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(dest) }\SpecialCharTok{|\textgreater{}}  
  \FunctionTok{arrange}\NormalTok{(time\_hour) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate\_query}\NormalTok{(}
    \AttributeTok{lead =} \FunctionTok{lead}\NormalTok{(arr\_delay),}
    \AttributeTok{lag =} \FunctionTok{lag}\NormalTok{(arr\_delay)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT}
\CommentTok{\#\textgreater{}   dest,}
\CommentTok{\#\textgreater{}   LEAD(arr\_delay, 1, NULL) OVER (PARTITION BY dest ORDER BY time\_hour) AS lead,}
\CommentTok{\#\textgreater{}   LAG(arr\_delay, 1, NULL) OVER (PARTITION BY dest ORDER BY time\_hour) AS lag}
\CommentTok{\#\textgreater{} FROM flights}
\CommentTok{\#\textgreater{} ORDER BY time\_hour}
\end{Highlighting}
\end{Shaded}

åœ¨è¿™é‡Œï¼Œå¯¹æ•°æ®è¿›è¡Œ\texttt{arrange()}æ’åºæ˜¯å¾ˆé‡è¦çš„ï¼Œå› ä¸º SQL
è¡¨æ²¡æœ‰å›ºæœ‰çš„é¡ºåºã€‚äº‹
å®ä¸Šï¼Œå¦‚æœä¸ä½¿ç”¨\texttt{arrange()}ï¼Œä½ å¯èƒ½ä¼šæ¯æ¬¡å¾—åˆ°ä¸åŒé¡ºåºçš„è¡Œï¼è¯·
æ³¨æ„ï¼Œå¯¹äºçª—å£å‡½æ•°æ’åºä¿¡æ¯æ˜¯é‡å¤çš„ï¼šä¸»æŸ¥è¯¢çš„ \texttt{ORDER\ BY}
å­å¥ä¸ä¼šè‡ªåŠ¨åº”ç”¨äºçª—å£å‡½æ•°ã€‚

å¦ä¸€ä¸ªé‡è¦çš„ SQL å‡½æ•°æ˜¯ \texttt{CASE\ WHEN}ã€‚å®ƒ
è¢«ç”¨ä½œ\texttt{if\_else()}å’Œ\texttt{case\_when()}çš„ç¿»è¯‘ï¼Œè¿™ä¸¤ä¸ª dplyr
å‡½æ•°ç›´æ¥å—åˆ°å®ƒçš„å¯å‘ã€‚è¿™ é‡Œæœ‰å‡ ä¸ªç®€å•çš„ä¾‹å­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate\_query}\NormalTok{(}
    \AttributeTok{description =} \FunctionTok{if\_else}\NormalTok{(arr\_delay }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{, }\StringTok{"delayed"}\NormalTok{, }\StringTok{"on{-}time"}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT CASE WHEN (arr\_delay \textgreater{} 0.0) THEN \textquotesingle{}delayed\textquotesingle{} WHEN NOT (arr\_delay \textgreater{} 0.0) THEN \textquotesingle{}on{-}time\textquotesingle{} }\RegionMarkerTok{END}\CommentTok{ AS description}
\CommentTok{\#\textgreater{} FROM flights}
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate\_query}\NormalTok{(}
    \AttributeTok{description =} 
      \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{        arr\_delay }\SpecialCharTok{\textless{}} \SpecialCharTok{{-}}\DecValTok{5} \SpecialCharTok{\textasciitilde{}} \StringTok{"early"}\NormalTok{, }
\NormalTok{        arr\_delay }\SpecialCharTok{\textless{}} \DecValTok{5} \SpecialCharTok{\textasciitilde{}} \StringTok{"on{-}time"}\NormalTok{,}
\NormalTok{        arr\_delay }\SpecialCharTok{\textgreater{}=} \DecValTok{5} \SpecialCharTok{\textasciitilde{}} \StringTok{"late"}
\NormalTok{      )}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT CASE}
\CommentTok{\#\textgreater{} WHEN (arr\_delay \textless{} {-}5.0) THEN \textquotesingle{}early\textquotesingle{}}
\CommentTok{\#\textgreater{} WHEN (arr\_delay \textless{} 5.0) THEN \textquotesingle{}on{-}time\textquotesingle{}}
\CommentTok{\#\textgreater{} WHEN (arr\_delay \textgreater{}= 5.0) THEN \textquotesingle{}late\textquotesingle{}}
\CommentTok{\#\textgreater{} }\RegionMarkerTok{END}\CommentTok{ AS description}
\CommentTok{\#\textgreater{} FROM flights}
\end{Highlighting}
\end{Shaded}

\texttt{CASE\ WHEN} ä¹Ÿç”¨äºä¸€äº›æ²¡æœ‰ä» R åˆ° SQL ç›´æ¥ç¿»è¯‘çš„å‡½æ•°ã€‚\texttt{c}
\texttt{ut()}å‡½æ•°å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate\_query}\NormalTok{(}
    \AttributeTok{description =}  \FunctionTok{cut}\NormalTok{(}
\NormalTok{      arr\_delay, }
      \AttributeTok{breaks =} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\ConstantTok{Inf}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{5}\NormalTok{, }\DecValTok{5}\NormalTok{, }\ConstantTok{Inf}\NormalTok{), }
      \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"early"}\NormalTok{, }\StringTok{"on{-}time"}\NormalTok{, }\StringTok{"late"}\NormalTok{)}
\NormalTok{    )}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \textless{}SQL\textgreater{}}
\CommentTok{\#\textgreater{} SELECT CASE}
\CommentTok{\#\textgreater{} WHEN (arr\_delay \textless{}= {-}5.0) THEN \textquotesingle{}early\textquotesingle{}}
\CommentTok{\#\textgreater{} WHEN (arr\_delay \textless{}= 5.0) THEN \textquotesingle{}on{-}time\textquotesingle{}}
\CommentTok{\#\textgreater{} WHEN (arr\_delay \textgreater{} 5.0) THEN \textquotesingle{}late\textquotesingle{}}
\CommentTok{\#\textgreater{} }\RegionMarkerTok{END}\CommentTok{ AS description}
\CommentTok{\#\textgreater{} FROM flights}
\end{Highlighting}
\end{Shaded}

dbplyr è¿˜è½¬æ¢äº†å¸¸è§çš„å­—ç¬¦ä¸²å’Œæ—¥æœŸ-æ—¶é—´å¤„ç†å‡½æ•°ï¼Œä½ å¯ä»¥åœ¨
\texttt{vignette("translation-function",\ package\ =\ "dbplyr")}
äº†è§£åˆ°æ›´å¤šä¿¡æ¯ã€‚d bplyr çš„è½¬æ¢å½“ç„¶ä¸æ˜¯å®Œç¾çš„ï¼Œè€Œä¸”è¿˜æœ‰å¾ˆå¤š R
å‡½æ•°å°šæœªè¢«è½¬æ¢ï¼Œä½† dbplyr
åœ¨æ¶µç›–ä½ å¤§éƒ¨åˆ†æ—¶é—´éƒ½ä¼šä½¿ç”¨çš„å‡½æ•°æ–¹é¢åšå¾—ç›¸å½“å‡ºè‰²ã€‚

\section{å°ç»“}\label{ux5c0fux7ed3-20}

åœ¨æœ¬ç« ä¸­ï¼Œä½ å­¦ä¹ äº†å¦‚ä½•ä»æ•°æ®åº“ä¸­è®¿é—®æ•°æ®ã€‚æˆ‘ ä»¬ä¸“æ³¨äº dbplyrï¼Œå®ƒæ˜¯ä¸€ä¸ª
dplyr çš„``åç«¯''ï¼Œå…è®¸ä½ ç¼–å†™ä½ ç†Ÿæ‚‰çš„ dplyr ä»£ç å¹¶è‡ªåŠ¨å°†å…¶è½¬æ¢ä¸º SQLã€‚æˆ‘
ä»¬åˆ©ç”¨è¿™ç§è½¬æ¢æ¥æ•™ä½ ä¸€ç‚¹ SQLï¼›å­¦ä¹ ä¸€äº› SQL æ˜¯å¾ˆé‡è¦çš„ï¼Œå› ä¸º SQL
æ˜¯æœ€å¸¸ç”¨äºå¤„ç†æ•°æ®çš„è¯­è¨€ï¼Œäº†è§£ä¸€äº› SQL å°†ä½¿ä½ æ›´å®¹æ˜“ä¸å…¶ä»–ä¸ä½¿ç”¨ R
çš„æ•°æ®ä¸“ä¸šäººå£«äº¤æµã€‚å¦‚ æœä½ å·²ç»å®Œæˆäº†æœ¬ç« å¹¶å¸Œæœ›äº†è§£æ›´å¤šå…³äº SQL
çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªæ¨èï¼š

\begin{itemize}
\item
  RenÃ©e M.P. Teate çš„ã€Š\href{https://sqlfordatascientists.com}{SQL for
  Data Scientists}ã€‹æ˜¯ä¸€æœ¬ä¸“é—¨ä¸ºæ•°æ®ç§‘å­¦å®¶è®¾è®¡çš„ SQL
  å…¥é—¨ä¹¦ç±ï¼ŒåŒ…å«äº†ä½ åœ¨çœŸå®ç»„ç»‡ä¸­å¯èƒ½é‡åˆ°çš„é«˜åº¦äº’è”æ•°æ®çš„ç¤ºä¾‹ã€‚
\item
  Anthony DeBarros çš„ã€Š\href{https://www.practicalsql.com}{Practical
  SQL}ã€‹æ˜¯ä»æ•°æ®è®°è€…ï¼ˆä¸“æ³¨äºè®²è¿°å¼•äººå…¥èƒœæ•…äº‹çš„æ•°æ®ç§‘å­¦å®¶ï¼‰çš„è§’åº¦ç¼–å†™çš„ï¼Œå¹¶è¯¦ç»†ä»‹ç»äº†å¦‚ä½•å°†æ•°æ®å¯¼å…¥æ•°æ®åº“ä»¥åŠè¿è¡Œè‡ªå·±çš„
  DBMSã€‚
\end{itemize}

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ ä½¿ç”¨å¦ä¸€ä¸ª dplyr åç«¯æ¥å¤„ç†å¤§æ•°æ®ï¼šarrowã€‚A rrow
ä¸“ä¸ºå¤„ç†ç£ç›˜ä¸Šçš„å¤§æ–‡ä»¶è€Œè®¾è®¡ï¼Œæ˜¯æ•°æ®åº“çš„å¤©ç„¶è¡¥å……ã€‚

\chapter{Arrow}\label{sec-arrow}

\section{å¼•è¨€}\label{ux5f15ux8a00-17}

CSV æ–‡ä»¶è®¾è®¡å¾—æ˜“äºäººç±»é˜…è¯»ã€‚å®ƒ
ä»¬æ˜¯ä¸€ç§å¾ˆå¥½çš„äº¤æ¢æ ¼å¼ï¼Œå› ä¸ºå®ƒä»¬éå¸¸ç®€å•ï¼Œå¹¶ä¸”å¯ä»¥è¢«ä»»ä½•å·¥å…·è¯»å–ã€‚ä½† æ˜¯
CSV æ–‡ä»¶å¹¶ä¸æ˜¯éå¸¸é«˜æ•ˆï¼Œä½ éœ€è¦åšå¾ˆå¤šå·¥ä½œæ‰èƒ½å°†æ•°æ®è¯»å…¥ Rã€‚åœ¨
æœ¬ç« ä¸­ï¼Œä½ å°†äº†è§£ä¸€ä¸ªå¼ºå¤§çš„æ›¿ä»£æ–¹æ¡ˆï¼š\href{https://parquet.apache.org/}{parquet}
æ ¼å¼ï¼Œè¿™æ˜¯ä¸€ç§åŸºäºå¼€æ”¾æ ‡å‡†çš„å¤§æ•°æ®ç³»ç»Ÿå¹¿æ³›ä½¿ç”¨çš„æ ¼å¼ã€‚

æˆ‘ä»¬å°†æŠŠ parquet æ–‡ä»¶ä¸ \href{https://arrow.apache.org}{Apache Arrow}
é…å¯¹ä½¿ç”¨ï¼ŒApache Arrow
æ˜¯ä¸€ä¸ªä¸ºå¤§å‹æ•°æ®é›†çš„é«˜æ•ˆåˆ†æå’Œä¼ è¾“è€Œè®¾è®¡çš„å¤šè¯­è¨€å·¥å…·ç®±ã€‚æˆ‘ ä»¬å°†é€šè¿‡
\href{https://arrow.apache.org/docs/r/}{arrow} åŒ…æ¥ä½¿ç”¨ Apache
Arrowï¼Œå®ƒæä¾›äº†ä¸€ä¸ª dplyr åç«¯ï¼Œå…è®¸ä½ ä½¿ç”¨ç†Ÿæ‚‰çš„ dplyr
è¯­æ³•æ¥åˆ†æå¤§äºå†…å­˜çš„æ•°æ®é›†ã€‚ä½œ ä¸ºä¸€ä¸ªé¢å¤–çš„ä¼˜åŠ¿ï¼Œarrow
æå…¶å¿«é€Ÿï¼šä½ å°†åœ¨æœ¬ç« åé¢çœ‹åˆ°ä¸€äº›ç¤ºä¾‹ã€‚

arrow å’Œ dbplyr éƒ½æä¾›äº† dplyr
åç«¯ï¼Œæ‰€ä»¥ä½ å¯èƒ½ä¼šæƒ³çŸ¥é“ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å“ªä¸€ä¸ªã€‚åœ¨
è®¸å¤šæƒ…å†µä¸‹ï¼Œè¿™ä¸ªé€‰æ‹©å·²ç»ä¸ºä½ åšå‡ºäº†ï¼Œå› ä¸ºæ•°æ®å·²ç»å­˜å‚¨åœ¨æ•°æ®åº“ä¸­æˆ– parquet
æ–‡ä»¶ä¸­ï¼Œä½ ä¼šæƒ³è¦ä¿æŒç°çŠ¶è¿›è¡Œå·¥ä½œã€‚ä½† æ˜¯å¦‚æœä½ ä»è‡ªå·±çš„æ•°æ®ï¼ˆå¯èƒ½æ˜¯ CSV
æ–‡ä»¶ï¼‰å¼€å§‹ï¼Œä½ å¯ä»¥å°†å…¶åŠ è½½åˆ°æ•°æ®åº“ä¸­æˆ–å°†å…¶è½¬æ¢ä¸º parquetã€‚ä¸€
èˆ¬æ¥è¯´ï¼Œå¾ˆéš¾çŸ¥é“å“ªç§æ–¹æ³•æ•ˆæœæœ€å¥½ï¼Œæ‰€ä»¥åœ¨åˆ†æçš„æ—©æœŸé˜¶æ®µï¼Œæˆ‘ä»¬é¼“åŠ±ä½ å°è¯•ä¸¤è€…ï¼Œå¹¶é€‰æ‹©æœ€é€‚åˆä½ çš„é‚£ä¸€ç§ã€‚

ï¼ˆç‰¹åˆ«æ„Ÿè°¢ Danielle Navarro è´¡çŒ®äº†æœ¬ç« çš„åˆå§‹ç‰ˆæœ¬ã€‚ï¼‰

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-18}

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­ä½¿ç”¨ tidyverseï¼Œç‰¹åˆ«æ˜¯ dplyrï¼Œä½†æˆ‘ä»¬å°†å®ƒä¸ arrow
åŒ…ç»“åˆä½¿ç”¨ï¼Œarrow åŒ…æ˜¯ä¸“é—¨ä¸ºå¤„ç†å¤§æ•°æ®è€Œè®¾è®¡çš„ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(arrow)}
\end{Highlighting}
\end{Shaded}

åœ¨æœ¬ç« çš„åé¢éƒ¨åˆ†ï¼Œæˆ‘ä»¬è¿˜å°†çœ‹åˆ° arrow å’Œ duckdb
ä¹‹é—´çš„ä¸€äº›è”ç³»ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦ä½¿ç”¨ dbplyr å’Œ duckdbã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(dbplyr, }\AttributeTok{warn.conflicts =} \ConstantTok{FALSE}\NormalTok{)}
\FunctionTok{library}\NormalTok{(duckdb)}
\CommentTok{\#\textgreater{} Loading required package: DBI}
\end{Highlighting}
\end{Shaded}

\section{è·å–æ•°æ®}\label{ux83b7ux53d6ux6570ux636e}

æˆ‘ä»¬é¦–å…ˆè·å–ä¸€ä¸ªå€¼å¾—ä½¿ç”¨è¿™äº›å·¥å…·çš„æ•°æ®é›†ï¼šè¥¿é›…å›¾å…¬å…±å›¾ä¹¦é¦†çš„å›¾ä¹¦å€Ÿé˜…æ•°æ®é›†ï¼Œå¯ä»¥åœ¨çº¿è·å–ï¼Œåœ°å€ä¸º
\href{https://data.seattle.gov/Community/Checkouts-by-Title/tmmm-ytt6}{data.seattle.gov/Community/Checkouts-by-Title/tmmm-ytt6}ã€‚è¿™
ä¸ªæ•°æ®é›†åŒ…å«äº† 41,389,465 è¡Œæ•°æ®ï¼Œè®°å½•äº†ä» 2005 å¹´ 4 æœˆåˆ° 2022 å¹´ 10
æœˆæ¯ä¸ªæœˆæ¯æœ¬ä¹¦çš„å€Ÿé˜…æ¬¡æ•°ã€‚

ä»¥ä¸‹ä»£ç å°†ä¸ºä½ è·å–æ•°æ®çš„ç¼“å­˜å‰¯æœ¬ã€‚æ•° æ®æ˜¯ä¸€ä¸ª 9GB çš„ CSV
æ–‡ä»¶ï¼Œå› æ­¤ä¸‹è½½éœ€è¦ä¸€äº›æ—¶é—´ã€‚æˆ‘ å¼ºçƒˆæ¨èä½¿ç”¨
\texttt{curl::multi\_download()}
æ¥è·å–éå¸¸å¤§çš„æ–‡ä»¶ï¼Œå› ä¸ºå®ƒæ­£æ˜¯ä¸ºæ­¤ç›®çš„è€Œæ„å»ºçš„ï¼šå®ƒæä¾›äº†ä¸€ä¸ªè¿›åº¦æ¡ï¼Œå¹¶ä¸”å¦‚æœä¸‹è½½ä¸­æ–­ï¼Œå®ƒå¯ä»¥æ¢å¤ä¸‹è½½ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dir.create}\NormalTok{(}\StringTok{"data"}\NormalTok{, }\AttributeTok{showWarnings =} \ConstantTok{FALSE}\NormalTok{)}

\NormalTok{curl}\SpecialCharTok{::}\FunctionTok{multi\_download}\NormalTok{(}
  \StringTok{"https://r4ds.s3.us{-}west{-}2.amazonaws.com/seattle{-}library{-}checkouts.csv"}\NormalTok{,}
  \StringTok{"data/seattle{-}library{-}checkouts.csv"}\NormalTok{,}
  \AttributeTok{resume =} \ConstantTok{TRUE}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{æ‰“å¼€æ•°æ®é›†}\label{ux6253ux5f00ux6570ux636eux96c6}

é¦–å…ˆæ¥æŸ¥çœ‹ä¸€ä¸‹æ•°æ®ã€‚ç”± äºè¯¥æ–‡ä»¶æœ‰
9GBï¼Œè¶³å¤Ÿå¤§ï¼Œå› æ­¤æˆ‘ä»¬å¯èƒ½ä¸æƒ³å°†æ•´ä¸ªæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚ä¸€
ä¸ªå¾ˆå¥½çš„ç»éªŒæ³•åˆ™æ˜¯ï¼Œä½ é€šå¸¸å¸Œæœ›è‡³å°‘æœ‰æ•°æ®å¤§å°ä¸¤å€çš„å†…å­˜ï¼Œè€Œè®¸å¤šç¬”è®°æœ¬ç”µè„‘çš„å†…å­˜å®¹é‡ä¸Šé™ä¸º16GBã€‚è¿™
æ„å‘³ç€æˆ‘ä»¬è¦é¿å…ä½¿ç”¨ \texttt{read\_csv()}ï¼Œè€Œæ˜¯ä½¿ç”¨
\texttt{arrow::open\_dataset()}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{seattle\_csv }\OtherTok{\textless{}{-}} \FunctionTok{open\_dataset}\NormalTok{(}
  \AttributeTok{sources =} \StringTok{"data/seattle{-}library{-}checkouts.csv"}\NormalTok{, }
  \AttributeTok{col\_types =} \FunctionTok{schema}\NormalTok{(}\AttributeTok{ISBN =} \FunctionTok{string}\NormalTok{()),}
  \AttributeTok{format =} \StringTok{"csv"}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

è¿è¡Œè¿™æ®µä»£ç æ—¶å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ\texttt{o} \texttt{pen\_dataset()}
ä¼šæ‰«æå‡ åƒè¡Œæ•°æ®ä»¥ç¡®å®šæ•°æ®é›†çš„ç»“æ„ã€‚\texttt{I} \texttt{SBN} åˆ—åœ¨å‰
80,000 è¡Œä¸­åŒ…å«ç©ºå€¼ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»æŒ‡å®šåˆ—ç±»å‹ä»¥å¸®åŠ© arrow ç¡®å®šæ•°æ®ç»“æ„ã€‚ä¸€
æ—¦ \texttt{open\_dataset()}
æ‰«æäº†æ•°æ®ï¼Œå®ƒå°±ä¼šè®°å½•æ‰€å‘ç°çš„å†…å®¹å¹¶åœæ­¢ï¼›åªæœ‰å½“ä½ ç‰¹åˆ«è¯·æ±‚æ—¶ï¼Œå®ƒæ‰ä¼šè¿›ä¸€æ­¥è¯»å–å…¶ä»–è¡Œã€‚å¦‚
æœæˆ‘ä»¬è¾“å‡º\texttt{seattle\_csv}ï¼Œæ‰€çœ‹åˆ°çš„æ­£æ˜¯è¿™äº›å…ƒæ•°æ®ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{seattle\_csv}
\CommentTok{\#\textgreater{} FileSystemDataset with 1 csv file}
\CommentTok{\#\textgreater{} UsageClass: string}
\CommentTok{\#\textgreater{} CheckoutType: string}
\CommentTok{\#\textgreater{} MaterialType: string}
\CommentTok{\#\textgreater{} CheckoutYear: int64}
\CommentTok{\#\textgreater{} CheckoutMonth: int64}
\CommentTok{\#\textgreater{} Checkouts: int64}
\CommentTok{\#\textgreater{} Title: string}
\CommentTok{\#\textgreater{} ISBN: string}
\CommentTok{\#\textgreater{} Creator: string}
\CommentTok{\#\textgreater{} Subjects: string}
\CommentTok{\#\textgreater{} Publisher: string}
\CommentTok{\#\textgreater{} PublicationYear: string}
\end{Highlighting}
\end{Shaded}

è¾“å‡ºçš„ç¬¬ä¸€è¡Œå‘Šè¯‰ä½  \texttt{seattle\_csv} ä½œä¸ºå•ä¸ª CSV
æ–‡ä»¶å­˜å‚¨åœ¨æœ¬åœ°ç£ç›˜ä¸Šï¼›å®ƒåªä¼šåœ¨éœ€è¦æ—¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚è¾“ å‡ºçš„å…¶ä½™éƒ¨åˆ†å‘Šè¯‰ä½ 
arrow ä¸ºæ¯ä¸€åˆ—æ¨æ–­å‡ºçš„åˆ—ç±»å‹ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ \texttt{glimpse()} æ¥æŸ¥çœ‹å®é™…å†…å®¹ã€‚è¿™ ä¼šæ˜¾ç¤ºå¤§çº¦æœ‰ 4100
ä¸‡è¡Œå’Œ 12 åˆ—ï¼Œå¹¶å±•ç¤ºä¸€äº›å€¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{seattle\_csv }\SpecialCharTok{|\textgreater{}} \FunctionTok{glimpse}\NormalTok{()}
\CommentTok{\#\textgreater{} FileSystemDataset with 1 csv file}
\CommentTok{\#\textgreater{} 129,967 rows x 12 columns}
\CommentTok{\#\textgreater{} $ UsageClass      \textless{}string\textgreater{} "Physical", "Physical", "Digital", "Physical", "Ph\textasciitilde{}}
\CommentTok{\#\textgreater{} $ CheckoutType    \textless{}string\textgreater{} "Horizon", "Horizon", "OverDrive", "Horizon", "Hor\textasciitilde{}}
\CommentTok{\#\textgreater{} $ MaterialType    \textless{}string\textgreater{} "BOOK", "BOOK", "EBOOK", "BOOK", "SOUNDDISC", "BOO\textasciitilde{}}
\CommentTok{\#\textgreater{} $ CheckoutYear     \textless{}int64\textgreater{} 2016, 2016, 2016, 2016, 2016, 2016, 2016, 2016, 20\textasciitilde{}}
\CommentTok{\#\textgreater{} $ CheckoutMonth    \textless{}int64\textgreater{} 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,\textasciitilde{}}
\CommentTok{\#\textgreater{} $ Checkouts        \textless{}int64\textgreater{} 1, 1, 1, 1, 1, 1, 1, 1, 4, 1, 1, 2, 3, 2, 1, 3, 2,\textasciitilde{}}
\CommentTok{\#\textgreater{} $ Title           \textless{}string\textgreater{} "Super rich : a guide to having it all / Russell S\textasciitilde{}}
\CommentTok{\#\textgreater{} $ ISBN            \textless{}string\textgreater{} "", "", "", "", "", "", "", "", "", "", "", "", ""\textasciitilde{}}
\CommentTok{\#\textgreater{} $ Creator         \textless{}string\textgreater{} "Simmons, Russell", "Barclay, James, 1965{-}", "Tim \textasciitilde{}}
\CommentTok{\#\textgreater{} $ Subjects        \textless{}string\textgreater{} "Self realization, Conduct of life, Attitude Psych\textasciitilde{}}
\CommentTok{\#\textgreater{} $ Publisher       \textless{}string\textgreater{} "Gotham Books,", "Pyr,", "Random House, Inc.", "Di\textasciitilde{}}
\CommentTok{\#\textgreater{} $ PublicationYear \textless{}string\textgreater{} "c2011.", "2010", "2015", "2005", "c2004.", "c2005\textasciitilde{}}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å¯ä»¥å¼€å§‹ä½¿ç”¨ dplyr çš„å‡½æ•°æ¥æ“ä½œè¿™ä¸ªæ•°æ®é›†ï¼Œä½¿ç”¨ \texttt{collect()}
æ¥å¼ºåˆ¶ arrow æ‰§è¡Œè®¡ç®—å¹¶è¿”å›ä¸€äº›æ•°æ®ã€‚ä¾‹
å¦‚ï¼Œä»¥ä¸‹ä»£ç ä¼šå‘Šè¯‰æˆ‘ä»¬æ¯å¹´å›¾ä¹¦çš„æ€»å€Ÿé˜…æ¬¡æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{seattle\_csv }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(CheckoutYear) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{Checkouts =} \FunctionTok{sum}\NormalTok{(Checkouts)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{arrange}\NormalTok{(CheckoutYear) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{collect}\NormalTok{()}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 2}
\CommentTok{\#\textgreater{}   CheckoutYear Checkouts}
\CommentTok{\#\textgreater{}          \textless{}int\textgreater{}     \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1         2016    411739}
\CommentTok{\#\textgreater{} 2         2022         1}
\end{Highlighting}
\end{Shaded}

ç”±äºä½¿ç”¨äº†arrowï¼Œè¿™æ®µä»£ç æ— è®ºåŸºç¡€æ•°æ®é›†æœ‰å¤šå¤§éƒ½èƒ½æ­£å¸¸å·¥ä½œã€‚ä½†
ç›®å‰çš„è¿è¡Œé€Ÿåº¦ç›¸å½“æ…¢ï¼šåœ¨ Hadley çš„ç”µè„‘ä¸Šï¼Œè¿è¡Œè¿™æ®µä»£ç å¤§çº¦éœ€è¦ 10 ç§’ã€‚è€ƒ
è™‘åˆ°æˆ‘ä»¬å¤„ç†çš„æ•°æ®é‡ï¼Œè¿™ä¸ç®—å¤ªæ…¢ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ‡æ¢åˆ°æ›´å¥½çš„æ ¼å¼æ¥ä½¿å…¶æ›´å¿«ã€‚

\section{parquet æ ¼å¼}\label{sec-parquet}

ä¸ºäº†è®©è¿™äº›æ•°æ®æ›´æ˜“äºå¤„ç†ï¼Œæˆ‘ä»¬å°†åˆ‡æ¢åˆ° parquet
æ–‡ä»¶æ ¼å¼ï¼Œå¹¶å°†å…¶æ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶ã€‚æ¥ ä¸‹æ¥çš„éƒ¨åˆ†å°†é¦–å…ˆå‘ä½ ä»‹ç» parquet
å’Œåˆ†åŒºï¼Œç„¶åå°†æˆ‘ä»¬å­¦åˆ°çš„çŸ¥è¯†åº”ç”¨äºè¥¿é›…å›¾å›¾ä¹¦é¦†æ•°æ®ã€‚

To make this data easier to work with, let's switch to the parquet file
format and split it up into multiple files. The following sections will
first introduce you to parquet and partitioning, and then apply what we
learned to the Seattle library data.

\subsection{parquet çš„ä¼˜åŠ¿}\label{parquet-ux7684ux4f18ux52bf}

å’Œ CSV ä¸€æ ·ï¼Œparquet
ç”¨äºçŸ©å½¢æ•°æ®ï¼Œä½†å®ƒä¸æ˜¯ä»»ä½•æ–‡ä»¶ç¼–è¾‘å™¨éƒ½å¯ä»¥è¯»å–çš„æ–‡æœ¬æ ¼å¼ï¼Œè€Œæ˜¯ä¸€ä¸ªä¸“é—¨ä¸ºå¤§æ•°æ®éœ€æ±‚è®¾è®¡çš„è‡ªå®šä¹‰äºŒè¿›åˆ¶æ ¼å¼ã€‚è¿™
æ„å‘³ç€ï¼š

\begin{itemize}
\tightlist
\item
  parquet æ–‡ä»¶é€šå¸¸æ¯”ç­‰æ•ˆçš„ CSV æ–‡ä»¶å°ã€‚Parquet
  ä¾èµ–äº\href{https://parquet.apache.org/docs/file-format/data-pages/encodings/}{efficient
  encodings}æ¥å‡å°æ–‡ä»¶å¤§å°ï¼Œå¹¶æ”¯æŒæ–‡ä»¶å‹ç¼©ã€‚è¿™æœ‰åŠ©äºä½¿ parquet
  æ–‡ä»¶æ›´å¿«ï¼Œå› ä¸ºä»ç£ç›˜ç§»åŠ¨åˆ°å†…å­˜çš„æ•°æ®æ›´å°‘ã€‚
\item
  parquet æ–‡ä»¶å…·æœ‰ä¸°å¯Œçš„ç±»å‹ç³»ç»Ÿã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ å°èŠ‚~\ref{sec-col-types}
  è®¨è®ºçš„é‚£æ ·ï¼ŒCSV æ–‡ä»¶ä¸æä¾›æœ‰å…³åˆ—ç±»å‹çš„ä»»ä½•ä¿¡æ¯ã€‚ä¾‹å¦‚CSV é˜…è¯»å™¨å¿…é¡»çŒœæµ‹
  \texttt{"08-10-2022"} æ˜¯å¦åº”è¢«è§£æä¸ºå­—ç¬¦ä¸²æˆ–æ—¥æœŸã€‚ç›¸åï¼Œparquet
  æ–‡ä»¶ä»¥å°†æ•°æ®ä¸å…¶ç±»å‹ä¸€èµ·è®°å½•çš„æ–¹å¼å­˜å‚¨æ•°æ®ã€‚
\item
  parquet æ–‡ä»¶æ˜¯``é¢å‘åˆ—çš„''ã€‚è¿™æ„å‘³ç€å®ƒä»¬æ˜¯æŒ‰åˆ—ç»„ç»‡çš„ï¼Œç±»ä¼¼äº R
  çš„æ•°æ®æ¡†ã€‚ä¸æŒ‰è¡Œç»„ç»‡çš„ CSV
  æ–‡ä»¶ç›¸æ¯”ï¼Œè¿™é€šå¸¸ä¼šå¯¼è‡´æ•°æ®åˆ†æä»»åŠ¡å…·æœ‰æ›´å¥½çš„æ€§èƒ½ã€‚
\item
  parquet
  æ–‡ä»¶æ˜¯``åˆ†å—çš„''ï¼Œè¿™ä½¿å¾—å¯ä»¥åœ¨åŒä¸€æ—¶é—´å¤„ç†æ–‡ä»¶çš„ä¸åŒéƒ¨åˆ†ï¼Œå¦‚æœå¹¸è¿çš„è¯ï¼Œç”šè‡³å¯ä»¥å®Œå…¨è·³è¿‡ä¸€äº›å—ã€‚
\end{itemize}

Parquet æ–‡ä»¶æœ‰ä¸€ä¸ªä¸»è¦ç¼ºç‚¹ï¼šå®ƒä»¬ä¸å†æ˜¯``äººç±»å¯è¯»''çš„ï¼Œå³å¦‚æœä½ ä½¿ç”¨
\texttt{readr::read\_file()} æŸ¥çœ‹ Parquet æ–‡ä»¶ï¼Œä½ å°†åªèƒ½çœ‹åˆ°ä¸€å †ä¹±ç ã€‚

\subsection{åˆ†åŒº}\label{ux5206ux533a}

éšç€æ•°æ®é›†å˜å¾—è¶Šæ¥è¶Šå¤§ï¼Œå°†æ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­å˜å¾—è¶Šæ¥è¶Šå›°éš¾ï¼Œè€Œä¸”å°†å¤§å‹æ•°æ®é›†æ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶é€šå¸¸å¾ˆæœ‰ç”¨ã€‚å½“
è¿™ç§ç»“æ„åŒ–æ“ä½œè¿›è¡Œå¾—è¶³å¤Ÿæ™ºèƒ½æ—¶ï¼Œè¿™ç§ç­–ç•¥å¯ä»¥æ˜¾è‘—æé«˜æ€§èƒ½ï¼Œå› ä¸ºè®¸å¤šåˆ†æåªéœ€è¦æ–‡ä»¶çš„ä¸€ä¸ªå­é›†ã€‚

å…³äºå¦‚ä½•å¯¹ä½ çš„æ•°æ®é›†è¿›è¡Œåˆ†åŒºï¼Œæ²¡æœ‰ä¸¥æ ¼çš„è§„å®šï¼šç»“æœå°†å–å†³äºä½ çš„æ•°æ®ã€è®¿é—®æ¨¡å¼ä»¥åŠè¯»å–æ•°æ®çš„ç³»ç»Ÿã€‚åœ¨
æ‰¾åˆ°é€‚åˆä½ çš„ç†æƒ³åˆ†åŒºä¹‹å‰ï¼Œå¯èƒ½éœ€è¦è¿›è¡Œä¸€äº›å®éªŒã€‚ä½œ ä¸ºç²—ç•¥çš„æŒ‡å¯¼ï¼Œarrow
å»ºè®®é¿å…ä½¿ç”¨å°äº 20MB å’Œå¤§äº 2GB çš„æ–‡ä»¶ï¼Œå¹¶é¿å…äº§ç”Ÿè¶…è¿‡ 10,000
ä¸ªæ–‡ä»¶çš„åˆ†åŒºã€‚ä½ 
è¿˜åº”è¯¥å°è¯•æŒ‰ä½ ç­›é€‰çš„å˜é‡è¿›è¡Œåˆ†åŒºï¼›å¦‚ä½ ç¨åå°†çœ‹åˆ°çš„é‚£æ ·ï¼Œè¿™å…è®¸ arrow
ä»…è¯»å–ç›¸å…³æ–‡ä»¶ï¼Œä»è€ŒèŠ‚çœå¤§é‡å·¥ä½œã€‚

\subsection{é‡å†™è¥¿é›…å›¾å›¾ä¹¦é¦†æ•°æ®}\label{ux91cdux5199ux897fux96c5ux56feux56feux4e66ux9986ux6570ux636e}

è®©æˆ‘ä»¬å°†è¿™äº›æƒ³æ³•åº”ç”¨äºè¥¿é›…å›¾å›¾ä¹¦é¦†æ•°æ®ï¼Œä»¥äº†è§£å®ƒä»¬åœ¨å®é™…æ“ä½œä¸­çš„è¡¨ç°ã€‚æˆ‘
ä»¬å°†æŒ‰ \texttt{CheckoutYear}
è¿›è¡Œåˆ†åŒºï¼Œå› ä¸ºæŸäº›åˆ†æå¯èƒ½åªæƒ³æŸ¥çœ‹æœ€è¿‘çš„æ•°æ®ï¼Œå¹¶ä¸”æŒ‰å¹´ä»½åˆ†åŒºå¯ä»¥äº§ç”Ÿ 18
ä¸ªå¤§å°åˆç†çš„å—ã€‚

ä¸ºäº†é‡å†™æ•°æ®ï¼Œæˆ‘ä»¬ä½¿ç”¨ \texttt{dplyr::group\_by()} å®šä¹‰åˆ†åŒºï¼Œç„¶åä½¿ç”¨
\texttt{arrow::write\_dataset()} å°†åˆ†åŒºä¿å­˜åˆ°ç›®å½•ä¸­ã€‚\texttt{w}
\texttt{rite\_dataset()}
æœ‰ä¸¤ä¸ªé‡è¦å‚æ•°ï¼šä¸€ä¸ªæ˜¯ç”¨äºåˆ›å»ºæ–‡ä»¶çš„ç›®å½•ï¼Œä¸€ä¸ªæ˜¯å°†ä½¿ç”¨çš„æ–‡ä»¶æ ¼å¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pq\_path }\OtherTok{\textless{}{-}} \StringTok{"data/seattle{-}library{-}checkouts"}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{seattle\_csv }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(CheckoutYear) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{write\_dataset}\NormalTok{(}\AttributeTok{path =}\NormalTok{ pq\_path, }\AttributeTok{format =} \StringTok{"parquet"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

è¿™å¤§çº¦éœ€è¦ä¸€åˆ†é’Ÿæ¥è¿è¡Œï¼›æ­£å¦‚æˆ‘ä»¬ç¨åå°†çœ‹åˆ°çš„ï¼Œè¿™æ˜¯ä¸€é¡¹åˆå§‹æŠ•èµ„ï¼Œé€šè¿‡ä½¿æœªæ¥çš„æ“ä½œå˜å¾—æ›´å¿«è€Œå¾—åˆ°å›æŠ¥ã€‚

è®©æˆ‘ä»¬æ¥çœ‹çœ‹åˆšåˆšç”Ÿæˆäº†ä»€ä¹ˆï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{files =} \FunctionTok{list.files}\NormalTok{(pq\_path, }\AttributeTok{recursive =} \ConstantTok{TRUE}\NormalTok{),}
  \AttributeTok{size\_MB =} \FunctionTok{file.size}\NormalTok{(}\FunctionTok{file.path}\NormalTok{(pq\_path, files)) }\SpecialCharTok{/} \DecValTok{1024}\SpecialCharTok{\^{}}\DecValTok{2}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 2}
\CommentTok{\#\textgreater{}   files                             size\_MB}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}                               \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 CheckoutYear=2016/part{-}0.parquet 14.0    }
\CommentTok{\#\textgreater{} 2 CheckoutYear=2022/part{-}0.parquet  0.00434}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬åŸæœ¬ 9GB çš„ CSV æ–‡ä»¶å·²ç»è¢«é‡å†™ä¸º 18 ä¸ª parquet æ–‡ä»¶ã€‚è¿™
äº›æ–‡ä»¶åé‡‡ç”¨äº† \href{https://hive.apache.org}{Apache
Hive}é¡¹ç›®ä½¿ç”¨çš„``è‡ªæè¿°''çº¦å®šã€‚H ive
é£æ ¼çš„åˆ†åŒºä½¿ç”¨``key=value''çº¦å®šæ¥å‘½åæ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥æ­£å¦‚ä½ çŒœæµ‹çš„é‚£æ ·ï¼Œåä¸º
\texttt{CheckoutYear=2005} çš„ç›®å½•åŒ…å«äº†æ‰€æœ‰ \texttt{CheckoutYear} ä¸º
2005 çš„æ•°æ®ã€‚æ¯ ä¸ªæ–‡ä»¶çš„å¤§å°åœ¨ 100MB åˆ° 300MB ä¹‹é—´ï¼Œæ€»å¤§å°ç°åœ¨å¤§çº¦æ˜¯
4GBï¼Œç•¥å¤šäºåŸå§‹ CSV æ–‡ä»¶å¤§å°çš„ä¸€åŠã€‚è¿™ æ˜¯æˆ‘ä»¬æ‰€æœŸæœ›çš„ï¼Œå› ä¸º parquet
æ˜¯ä¸€ç§æ›´åŠ é«˜æ•ˆçš„æ ¼å¼ã€‚

\section{ä½¿ç”¨ dplyr ä¸ arrow}\label{ux4f7fux7528-dplyr-ux4e0e-arrow}

ç°åœ¨æˆ‘ä»¬å·²ç»åˆ›å»ºäº†è¿™äº› parquet æ–‡ä»¶ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å†æ¬¡è¯»å–å®ƒä»¬ã€‚æˆ‘
ä»¬å†æ¬¡ä½¿ç”¨ \texttt{open\_dataset()}ï¼Œä½†è¿™æ¬¡æˆ‘ä»¬ç»™å®ƒæä¾›ä¸€ä¸ªç›®å½•ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{seattle\_pq }\OtherTok{\textless{}{-}} \FunctionTok{open\_dataset}\NormalTok{(pq\_path)}
\end{Highlighting}
\end{Shaded}

ç°åœ¨æˆ‘ä»¬å¯ä»¥ç¼–å†™æˆ‘ä»¬çš„ dplyr ç®¡é“äº†ã€‚ä¾‹
å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—è¿‡å»äº”å¹´å†…æ¯ä¸ªæœˆå€Ÿå‡ºçš„ä¹¦ç±æ€»æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{query }\OtherTok{\textless{}{-}}\NormalTok{ seattle\_pq }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(CheckoutYear }\SpecialCharTok{\textgreater{}=} \DecValTok{2018}\NormalTok{, MaterialType }\SpecialCharTok{==} \StringTok{"BOOK"}\NormalTok{) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(CheckoutYear, CheckoutMonth) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{TotalCheckouts =} \FunctionTok{sum}\NormalTok{(Checkouts)) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{arrange}\NormalTok{(CheckoutYear, CheckoutMonth)}
\end{Highlighting}
\end{Shaded}

ä¸º arrow æ•°æ®ç¼–å†™ dplyr ä»£ç çš„æ¦‚å¿µä¸ ç« èŠ‚~\ref{sec-import-databases}
ä¸­çš„dbplyr ç±»ä¼¼ï¼šä½ ç¼–å†™ dplyr ä»£ç ï¼Œè¿™äº›ä»£ç ä¼šè‡ªåŠ¨è½¬æ¢ä¸º Apache Arrow
C++ åº“èƒ½å¤Ÿç†è§£çš„æŸ¥è¯¢ï¼Œç„¶ååœ¨è°ƒç”¨ \texttt{collect()} æ—¶æ‰§è¡Œã€‚å¦‚
æœæˆ‘ä»¬è¾“å‡ºæŸ¥è¯¢å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€äº›å…³äºæ‰§è¡Œæ—¶æˆ‘ä»¬æœŸæœ› Arrow
è¿”å›çš„ä¿¡æ¯ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{query}
\CommentTok{\#\textgreater{} FileSystemDataset (query)}
\CommentTok{\#\textgreater{} CheckoutYear: int32}
\CommentTok{\#\textgreater{} CheckoutMonth: int64}
\CommentTok{\#\textgreater{} TotalCheckouts: int64}
\CommentTok{\#\textgreater{} }
\CommentTok{\#\textgreater{} * Grouped by CheckoutYear}
\CommentTok{\#\textgreater{} * Sorted by CheckoutYear [asc], CheckoutMonth [asc]}
\CommentTok{\#\textgreater{} See $.data for the source Arrow object}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨\texttt{collect()}æ¥è·å–ç»“æœ:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{query }\SpecialCharTok{|\textgreater{}} \FunctionTok{collect}\NormalTok{()}
\CommentTok{\#\textgreater{} \# A tibble: 0 x 3}
\CommentTok{\#\textgreater{} \# Groups:   CheckoutYear [0]}
\CommentTok{\#\textgreater{} \# i 3 variables: CheckoutYear \textless{}int\textgreater{}, CheckoutMonth \textless{}int\textgreater{},}
\CommentTok{\#\textgreater{} \#   TotalCheckouts \textless{}int\textgreater{}}
\end{Highlighting}
\end{Shaded}

ä¸ dbplyr ä¸€æ ·ï¼Œarrow åªç†è§£æŸäº› R
è¡¨è¾¾å¼ï¼Œå› æ­¤ä½ å¯èƒ½æ— æ³•ç¼–å†™ä¸é€šå¸¸å®Œå…¨ä¸€æ ·çš„ä»£ç ã€‚ä½†
æ˜¯ï¼Œæ‰€æ”¯æŒçš„æ“ä½œå’Œå‡½æ•°åˆ—è¡¨ç›¸å½“å¹¿æ³›ä¸”ä¸æ–­æ‰©å±•ï¼›æ‚¨å¯ä»¥åœ¨\texttt{?acero}ä¸­æ‰¾åˆ°å½“å‰æ”¯æŒçš„å‡½æ•°çš„å®Œæ•´åˆ—è¡¨ã€‚

\subsection{æ€§èƒ½}\label{sec-parquet-fast}

è®©æˆ‘ä»¬å¿«é€Ÿçœ‹ä¸€ä¸‹ä» CSV åˆ‡æ¢åˆ° parquet å¯¹æ€§èƒ½çš„å½±å“ã€‚é¦–
å…ˆï¼Œè®©æˆ‘ä»¬è®¡ç®—ä¸€ä¸‹å½“æ•°æ®ä½œä¸ºå•ä¸ªå¤§å‹ CSV å­˜å‚¨æ—¶ï¼Œè®¡ç®— 2021
å¹´æ¯ä¸ªæœˆå€Ÿå‡ºçš„ä¹¦ç±æ•°é‡æ‰€éœ€çš„æ—¶é—´ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{seattle\_csv }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(CheckoutYear }\SpecialCharTok{==} \DecValTok{2021}\NormalTok{, MaterialType }\SpecialCharTok{==} \StringTok{"BOOK"}\NormalTok{) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(CheckoutMonth) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{TotalCheckouts =} \FunctionTok{sum}\NormalTok{(Checkouts)) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(CheckoutMonth)) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{collect}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{system.time}\NormalTok{()}
\CommentTok{\#\textgreater{}    user  system elapsed }
\CommentTok{\#\textgreater{}   0.052   0.003   0.052}
\end{Highlighting}
\end{Shaded}

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨æ•°æ®é›†çš„æ–°ç‰ˆæœ¬ï¼Œå…¶ä¸­è¥¿é›…å›¾å›¾ä¹¦é¦†çš„å€Ÿé˜…æ•°æ®å·²ç»è¢«åˆ†åŒºä¸º
18 ä¸ªè¾ƒå°çš„ parquet æ–‡ä»¶ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{seattle\_pq }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(CheckoutYear }\SpecialCharTok{==} \DecValTok{2021}\NormalTok{, MaterialType }\SpecialCharTok{==} \StringTok{"BOOK"}\NormalTok{) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(CheckoutMonth) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{TotalCheckouts =} \FunctionTok{sum}\NormalTok{(Checkouts)) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(CheckoutMonth)) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{collect}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{system.time}\NormalTok{()}
\CommentTok{\#\textgreater{}    user  system elapsed }
\CommentTok{\#\textgreater{}   0.014   0.000   0.014}
\end{Highlighting}
\end{Shaded}

å¤§çº¦100å€æ€§èƒ½çš„æå‡å¯å½’å› äºä¸¤ä¸ªå› ç´ ï¼šå¤šæ–‡ä»¶åˆ†åŒºå’Œå•ä¸ªæ–‡ä»¶çš„æ ¼å¼ï¼š

\begin{itemize}
\tightlist
\item
  åˆ†åŒºæé«˜äº†æ€§èƒ½ï¼Œå› ä¸ºè¿™ä¸ªæŸ¥è¯¢ä½¿ç”¨ \texttt{CheckoutYear\ ==\ 2021}
  æ¥ç­›é€‰æ•°æ®ï¼Œè€Œ arrow è¶³å¤Ÿæ™ºèƒ½ï¼Œèƒ½å¤Ÿè¯†åˆ«å‡ºå®ƒåªéœ€è¦è¯»å– 18 ä¸ª parquet
  æ–‡ä»¶ä¸­çš„ 1 ä¸ªã€‚
\item
  parquet
  æ ¼å¼æé«˜äº†æ€§èƒ½ï¼Œå› ä¸ºå®ƒå°†æ•°æ®ä»¥å¯ä»¥ç›´æ¥è¯»å…¥å†…å­˜çš„äºŒè¿›åˆ¶æ ¼å¼å­˜å‚¨ã€‚åˆ—å¼æ ¼å¼å’Œä¸°å¯Œçš„å…ƒæ•°æ®æ„å‘³ç€
  arrow
  åªéœ€è¦è¯»å–æŸ¥è¯¢ä¸­å®é™…ä½¿ç”¨çš„å››åˆ—ï¼ˆ\texttt{CheckoutYear}ã€\texttt{MaterialType}ã€\texttt{CheckoutMonth}
  å’Œ \texttt{Checkouts}ï¼‰ã€‚
\end{itemize}

è¿™ç§æ€§èƒ½ä¸Šçš„å·¨å¤§å·®å¼‚è¯´æ˜ä¸ºä»€ä¹ˆå°†å¤§å‹ CSV è½¬æ¢ä¸º parquet æ˜¯å€¼å¾—çš„ï¼

\subsection{ä½¿ç”¨duckdbä¸arrow}\label{ux4f7fux7528duckdbux4e0earrow}

parquet å’Œ arrow
çš„æœ€åä¸€ä¸ªä¼˜åŠ¿æ˜¯ï¼Œé€šè¿‡è°ƒç”¨\texttt{arrow::to\_duckdb()}å¯ä»¥éå¸¸è½»æ¾åœ°å°†arrow
æ•°æ®é›†è½¬æ¢ä¸º DuckDB æ•°æ®åº“ï¼ˆ å‚è§ ç« èŠ‚~\ref{sec-import-databases} ï¼‰ã€‚

There's one last advantage of parquet and arrow --- it's very easy to
turn an arrow dataset into a DuckDB database
(ç« èŠ‚~\ref{sec-import-databases}) by calling
\texttt{arrow::to\_duckdb()}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{seattle\_pq }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{to\_duckdb}\NormalTok{() }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{filter}\NormalTok{(CheckoutYear }\SpecialCharTok{\textgreater{}=} \DecValTok{2018}\NormalTok{, MaterialType }\SpecialCharTok{==} \StringTok{"BOOK"}\NormalTok{) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{group\_by}\NormalTok{(CheckoutYear) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{TotalCheckouts =} \FunctionTok{sum}\NormalTok{(Checkouts)) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{arrange}\NormalTok{(}\FunctionTok{desc}\NormalTok{(CheckoutYear)) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{collect}\NormalTok{()}
\CommentTok{\#\textgreater{} Warning: Missing values are always removed in SQL aggregation functions.}
\CommentTok{\#\textgreater{} Use \textasciigrave{}na.rm = TRUE\textasciigrave{} to silence this warning}
\CommentTok{\#\textgreater{} This warning is displayed once every 8 hours.}
\CommentTok{\#\textgreater{} \# A tibble: 0 x 2}
\CommentTok{\#\textgreater{} \# i 2 variables: CheckoutYear \textless{}int\textgreater{}, TotalCheckouts \textless{}dbl\textgreater{}}
\end{Highlighting}
\end{Shaded}

\texttt{to\_duckdb()}çš„å·§å¦™ä¹‹å¤„åœ¨äºï¼Œè¿™ç§è½¬æ¢ä¸æ¶‰åŠä»»ä½•å†…å­˜å¤åˆ¶ï¼Œå¹¶ä½“ç°äº†
arrow ç”Ÿæ€ç³»ç»Ÿçš„ç›®æ ‡ï¼šå®ç°ä»ä¸€ä¸ªè®¡ç®—ç¯å¢ƒåˆ°å¦ä¸€ä¸ªè®¡ç®—ç¯å¢ƒçš„æ— ç¼è¿‡æ¸¡ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-55}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  æ‰¾å‡ºæ¯å¹´æœ€å—æ¬¢è¿çš„ä¹¦ã€‚
\item
  è¥¿é›…å›¾å›¾ä¹¦é¦†ç³»ç»Ÿä¸­å“ªä½ä½œè€…çš„ä¹¦æœ€å¤šï¼Ÿ
\item
  åœ¨è¿‡å»çš„10å¹´é‡Œï¼Œçº¸è´¨ä¹¦ä¸ç”µå­ä¹¦çš„å€Ÿé˜…æƒ…å†µæ˜¯å¦‚ä½•å˜åŒ–çš„ï¼Ÿ
\end{enumerate}

\section{å°ç»“}\label{ux5c0fux7ed3-21}

åœ¨æœ¬ç« ä¸­ï¼Œä½ å·²ç»åˆæ­¥äº†è§£äº†arrowåŒ…ï¼Œå®ƒæä¾›äº†ç”¨äºå¤„ç†å¤§å‹ç£ç›˜ä¸Šæ•°æ®é›†çš„
dplyr åç«¯ã€‚å®ƒ å¯ä»¥å¤„ç† CSV æ–‡ä»¶ï¼Œä½†å¦‚æœæ‚¨å°†æ•°æ®è½¬æ¢ä¸º parquet
æ ¼å¼ï¼Œå®ƒä¼šå¿«å¾—å¤šã€‚P arquet
æ˜¯ä¸€ç§äºŒè¿›åˆ¶æ•°æ®æ ¼å¼ï¼Œä¸“ä¸ºç°ä»£è®¡ç®—æœºä¸Šçš„æ•°æ®åˆ†æè€Œè®¾è®¡ã€‚ä¸ CSV
ç›¸æ¯”ï¼Œèƒ½å¤Ÿå¤„ç† parquet
æ–‡ä»¶çš„å·¥å…·è¦å°‘å¾—å¤šï¼Œä½†å…¶åˆ†åŒºã€å‹ç¼©å’Œåˆ—å¼å­˜å‚¨ç»“æ„ä½¿å¾—åˆ†ææ›´åŠ é«˜æ•ˆã€‚

æ¥ä¸‹æ¥ï¼Œæ‚¨å°†å­¦ä¹ å…³äºç¬¬ä¸€ä¸ªéçŸ©å½¢æ•°æ®æºçš„çŸ¥è¯†ï¼Œæ‚¨å°†ä½¿ç”¨ tidyr
åŒ…æä¾›çš„å·¥å…·æ¥å¤„ç†å®ƒã€‚æˆ‘ ä»¬å°†é‡ç‚¹å…³æ³¨æ¥è‡ª JSON
æ–‡ä»¶çš„æ•°æ®ï¼Œä½†ä¸€èˆ¬åŸåˆ™é€‚ç”¨äºä»»ä½•æ¥æºçš„æ ‘çŠ¶æ•°æ®ã€‚

\chapter{å±‚æ¬¡æ•°æ®}\label{sec-rectangling}

\section{å¼•è¨€}\label{ux5f15ux8a00-18}

åœ¨è¿™ä¸€ç« ä¸­ï¼Œä½ å°†å­¦ä¹ æ•°æ®è§„æ•´ (\textbf{data} \textbf{rectangling})
çš„è‰ºæœ¯ï¼šå°†æœ¬è´¨ä¸Šå…·æœ‰å±‚æ¬¡ç»“æ„æˆ–æ ‘å½¢ç»“æ„çš„æ•°æ®è½¬æ¢ä¸ºç”±è¡Œå’Œåˆ—ç»„æˆçš„çŸ©å½¢æ•°æ®æ¡†ã€‚è¿™
ä¸€ç‚¹éå¸¸é‡è¦ï¼Œå› ä¸ºå±‚æ¬¡ç»“æ„æ•°æ®éå¸¸æ™®éï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†æ¥è‡ªç½‘ç»œçš„æ•°æ®æ—¶ã€‚

ä¸ºäº†å­¦ä¹ æ•°æ®è§„æ•´ï¼Œä½ é¦–å…ˆéœ€è¦äº†è§£åˆ—è¡¨ï¼Œè¿™ç§æ•°æ®ç»“æ„ä½¿å¾—å±‚æ¬¡ç»“æ„æ•°æ®æˆä¸ºå¯èƒ½ã€‚æ¥
ç€ï¼Œä½ å°†å­¦ä¹ ä¸¤ä¸ªå…³é”®çš„\texttt{tidyr}åŒ…å‡½æ•°ï¼š\texttt{tidyr::unnest\_longer()}å’Œ\texttt{tidyr::unnest\_wider()}ã€‚ç„¶
åï¼Œæˆ‘ä»¬å°†å‘ä½ å±•ç¤ºå‡ ä¸ªæ¡ˆä¾‹ç ”ç©¶ï¼Œåå¤ä½¿ç”¨è¿™äº›ç®€å•çš„å‡½æ•°æ¥è§£å†³å®é™…é—®é¢˜ã€‚æœ€
åï¼Œæˆ‘ä»¬å°†è®¨è®ºJSONï¼Œå®ƒæ˜¯å±‚æ¬¡æ•°æ®é›†æœ€å¸¸è§çš„æ¥æºï¼Œä¹Ÿæ˜¯ç½‘ç»œä¸Šæ•°æ®äº¤æ¢çš„ä¸€ç§å¸¸è§æ ¼å¼ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-19}

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨tidyverseæ ¸å¿ƒæˆå‘˜ä¹‹ä¸€çš„tidyråŒ…ä¸­çš„è®¸å¤šå‡½æ•°ã€‚æˆ‘
ä»¬è¿˜å°†ä½¿ç”¨repurrrsiveæ¥æä¾›ä¸€äº›æœ‰è¶£çš„æ•°æ®é›†ä»¥è¿›è¡Œè§„æ•´ç»ƒä¹ ï¼Œæœ€åæˆ‘ä»¬å°†ä½¿ç”¨jsonliteæ¥å°†JSONæ–‡ä»¶è¯»å–ä¸ºRä¸­çš„åˆ—è¡¨ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(repurrrsive)}
\FunctionTok{library}\NormalTok{(jsonlite)}
\end{Highlighting}
\end{Shaded}

\section{åˆ—è¡¨}\label{ux5217ux8868}

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å·²ç»ä½¿ç”¨åŒ…å«ç®€å•å‘é‡ï¼ˆå¦‚æ•´æ•°ã€æ•°å­—ã€å­—ç¬¦ã€æ—¥æœŸ-æ—¶é—´ä»¥åŠå› å­ï¼‰çš„æ•°æ®æ¡†è¿›è¡Œäº†å·¥ä½œã€‚è¿™
äº›å‘é‡ä¹‹æ‰€ä»¥ç®€å•ï¼Œæ˜¯å› ä¸ºå®ƒä»¬æ˜¯åŒè´¨çš„ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ç›¸åŒçš„æ•°æ®ç±»å‹ã€‚å¦‚
æœæƒ³åœ¨åŒä¸€å‘é‡ä¸­å­˜å‚¨ä¸åŒç±»å‹çš„å…ƒç´ ï¼Œä½ å°†éœ€è¦ä¸€ä¸ªåˆ—è¡¨ï¼Œä½¿ç”¨\texttt{list()}å‡½æ•°æ¥åˆ›å»ºå®ƒã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x1 }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{, }\StringTok{"a"}\NormalTok{, }\ConstantTok{TRUE}\NormalTok{)}
\NormalTok{x1}
\CommentTok{\#\textgreater{} [[1]]}
\CommentTok{\#\textgreater{} [1] 1 2 3 4}
\CommentTok{\#\textgreater{} }
\CommentTok{\#\textgreater{} [[2]]}
\CommentTok{\#\textgreater{} [1] "a"}
\CommentTok{\#\textgreater{} }
\CommentTok{\#\textgreater{} [[3]]}
\CommentTok{\#\textgreater{} [1] TRUE}
\end{Highlighting}
\end{Shaded}

ç»™åˆ—è¡¨çš„å…ƒç´ æˆ–å­é¡¹å‘½åé€šå¸¸å¾ˆæ–¹ä¾¿ï¼Œæ‚¨å¯ä»¥åƒç»™tibbleçš„åˆ—å‘½åä¸€æ ·è¿›è¡Œæ­¤æ“ä½œï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x2 }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\AttributeTok{a =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\AttributeTok{b =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\AttributeTok{c =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{)}
\NormalTok{x2}
\CommentTok{\#\textgreater{} $a}
\CommentTok{\#\textgreater{} [1] 1 2}
\CommentTok{\#\textgreater{} }
\CommentTok{\#\textgreater{} $b}
\CommentTok{\#\textgreater{} [1] 1 2 3}
\CommentTok{\#\textgreater{} }
\CommentTok{\#\textgreater{} $c}
\CommentTok{\#\textgreater{} [1] 1 2 3 4}
\end{Highlighting}
\end{Shaded}

å³ä½¿å¯¹äºè¿™äº›éå¸¸ç®€å•çš„åˆ—è¡¨ï¼Œè¾“å‡ºä¹Ÿä¼šå ç”¨ç›¸å½“å¤šçš„ç©ºé—´ã€‚ä¸€
ä¸ªæœ‰ç”¨çš„æ›¿ä»£æ–¹æ³•æ˜¯\texttt{str()}å‡½æ•°ï¼Œå®ƒç”Ÿæˆç»“æ„çš„ç´§å‡‘æ˜¾ç¤ºï¼Œå‡å°‘å¯¹å†…å®¹çš„å¼ºè°ƒï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(x1)}
\CommentTok{\#\textgreater{} List of 3}
\CommentTok{\#\textgreater{}  $ : int [1:4] 1 2 3 4}
\CommentTok{\#\textgreater{}  $ : chr "a"}
\CommentTok{\#\textgreater{}  $ : logi TRUE}
\FunctionTok{str}\NormalTok{(x2)}
\CommentTok{\#\textgreater{} List of 3}
\CommentTok{\#\textgreater{}  $ a: int [1:2] 1 2}
\CommentTok{\#\textgreater{}  $ b: int [1:3] 1 2 3}
\CommentTok{\#\textgreater{}  $ c: int [1:4] 1 2 3 4}
\end{Highlighting}
\end{Shaded}

æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œ\texttt{str()}åœ¨å•ç‹¬çš„è¡Œä¸Šæ˜¾ç¤ºåˆ—è¡¨çš„æ¯ä¸ªå…ƒç´ ã€‚å¦‚
æœå…ƒç´ æœ‰åç§°ï¼Œå®ƒä¼šå…ˆæ˜¾ç¤ºåç§°
(å¦‚æœæœ‰)ï¼Œç„¶åæ˜¯ç±»å‹çš„ç¼©å†™ï¼Œç„¶åæ˜¯å‰å‡ ä¸ªå€¼ã€‚

\subsection{åˆ†å±‚}\label{ux5206ux5c42}

åˆ—è¡¨å¯ä»¥åŒ…å«ä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬å…¶ä»–åˆ—è¡¨ã€‚
è¿™ä½¿å¾—å®ƒä»¬é€‚åˆè¡¨ç¤ºå±‚æ¬¡(æ ‘çŠ¶)ç»“æ„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x3 }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\FunctionTok{list}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\FunctionTok{list}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{))}
\FunctionTok{str}\NormalTok{(x3)}
\CommentTok{\#\textgreater{} List of 2}
\CommentTok{\#\textgreater{}  $ :List of 2}
\CommentTok{\#\textgreater{}   ..$ : num 1}
\CommentTok{\#\textgreater{}   ..$ : num 2}
\CommentTok{\#\textgreater{}  $ :List of 2}
\CommentTok{\#\textgreater{}   ..$ : num 3}
\CommentTok{\#\textgreater{}   ..$ : num 4}
\end{Highlighting}
\end{Shaded}

è¿™ä¸\texttt{c()}å‡½æ•°æ˜æ˜¾ä¸åŒï¼Œå› ä¸º\texttt{c()}ç”Ÿæˆçš„æ˜¯ä¸€ä¸ªæ‰å¹³åŒ–çš„å‘é‡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{c}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] 1 2 3 4}

\NormalTok{x4 }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FunctionTok{list}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\FunctionTok{list}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{))}
\FunctionTok{str}\NormalTok{(x4)}
\CommentTok{\#\textgreater{} List of 4}
\CommentTok{\#\textgreater{}  $ : num 1}
\CommentTok{\#\textgreater{}  $ : num 2}
\CommentTok{\#\textgreater{}  $ : num 3}
\CommentTok{\#\textgreater{}  $ : num 4}
\end{Highlighting}
\end{Shaded}

åˆ—è¡¨å˜å¾—æ›´å¤æ‚ï¼Œ\texttt{str()}å°±ä¼šå˜å¾—æ›´æœ‰ç”¨ï¼Œå› ä¸ºå®ƒèƒ½è®©ä½ ä¸€çœ¼å°±çœ‹åˆ°å±‚æ¬¡ç»“æ„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x5 }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}\DecValTok{1}\NormalTok{, }\FunctionTok{list}\NormalTok{(}\DecValTok{2}\NormalTok{, }\FunctionTok{list}\NormalTok{(}\DecValTok{3}\NormalTok{, }\FunctionTok{list}\NormalTok{(}\DecValTok{4}\NormalTok{, }\FunctionTok{list}\NormalTok{(}\DecValTok{5}\NormalTok{)))))}
\FunctionTok{str}\NormalTok{(x5)}
\CommentTok{\#\textgreater{} List of 2}
\CommentTok{\#\textgreater{}  $ : num 1}
\CommentTok{\#\textgreater{}  $ :List of 2}
\CommentTok{\#\textgreater{}   ..$ : num 2}
\CommentTok{\#\textgreater{}   ..$ :List of 2}
\CommentTok{\#\textgreater{}   .. ..$ : num 3}
\CommentTok{\#\textgreater{}   .. ..$ :List of 2}
\CommentTok{\#\textgreater{}   .. .. ..$ : num 4}
\CommentTok{\#\textgreater{}   .. .. ..$ :List of 1}
\CommentTok{\#\textgreater{}   .. .. .. ..$ : num 5}
\end{Highlighting}
\end{Shaded}

å½“åˆ—è¡¨å˜å¾—æ›´å¤§å’Œæ›´å¤æ‚æ—¶ï¼Œ\texttt{str()}æœ€ç»ˆä¼šå¼€å§‹å¤±æ•ˆï¼Œè¿™æ—¶ä½ éœ€è¦åˆ‡æ¢åˆ°\texttt{View()}\footnote{è¿™æ˜¯RStudioçš„ä¸€ä¸ªç‰¹æ€§ã€‚}ã€‚
å›¾~\ref{fig-view-collapsed} å±•ç¤ºäº†è°ƒç”¨\texttt{View(x5)}çš„ç»“æœã€‚
æŸ¥çœ‹å™¨é¦–å…ˆåªæ˜¾ç¤ºåˆ—è¡¨çš„é¡¶å±‚ï¼Œä½†ä½ å¯ä»¥äº¤äº’åœ°å±•å¼€ä»»ä½•å…ƒç´ ä»¥æŸ¥çœ‹æ›´å¤šå†…å®¹ï¼Œå¦‚
å›¾~\ref{fig-view-expand-1} æ‰€ç¤ºã€‚ RStudio
è¿˜ä¼šæ˜¾ç¤ºä½ éœ€è¦è®¿é—®è¯¥å…ƒç´ çš„ä»£ç ï¼Œå¦‚ å›¾~\ref{fig-view-expand-2} æ‰€ç¤ºã€‚
æˆ‘ä»¬å°†åœ¨ å°èŠ‚~\ref{sec-subset-one} æŸ¥çœ‹è¿™æ®µä»£ç æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

\begin{figure}

\centering{

\includegraphics[width=6.68in,height=\textheight]{screenshots/View-1.png}

}

\caption{\label{fig-view-collapsed}The RStudio view lets you
interactively explore a complex list. The viewer opens showing only the
top level of the list.}

\end{figure}%

\begin{figure}

\centering{

\includegraphics[width=6.68in,height=\textheight]{screenshots/View-2.png}

}

\caption{\label{fig-view-expand-1}Clicking on the rightward facing
triangle expands that component of the list so that you can also see its
children.}

\end{figure}%

\begin{figure}

\centering{

\includegraphics[width=6.68in,height=\textheight]{screenshots/View-3.png}

}

\caption{\label{fig-view-expand-2}You can repeat this operation as many
times as needed to get to the data you're interested in. Note the
bottom-left corner: if you click an element of the list, RStudio will
give you the subsetting code needed to access it, in this case
\texttt{x5{[}{[}2{]}{]}{[}{[}2{]}{]}{[}{[}2{]}{]}}.}

\end{figure}%

\subsection{åˆ—è¡¨åˆ—}\label{ux5217ux8868ux5217}

åˆ—è¡¨ä¹Ÿå¯å­˜åœ¨äºtibbleä¸­ï¼Œæˆ‘ä»¬ç§°å…¶ä¸ºåˆ—è¡¨åˆ— (list-columns)ã€‚
åˆ—è¡¨åˆ—å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬å…è®¸ä½ å°†é€šå¸¸ä¸å±äºtibbleçš„å¯¹è±¡æ”¾ç½®åœ¨å…¶ä¸­ã€‚ç‰¹
åˆ«æ˜¯ï¼Œåœ¨ \href{https://www.tidymodels.org}{tidymodels}
ç”Ÿæ€ç³»ç»Ÿä¸­åˆ—è¡¨åˆ—è¢«å¹¿æ³›ä½¿ç”¨ï¼Œå› ä¸ºå®ƒä»¬å…è®¸ä½ åœ¨æ•°æ®æ¡†ä¸­å­˜å‚¨æ¨¡å‹çš„è¾“å‡ºæˆ–é‡é‡‡æ ·ç­‰æ•°æ®ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªåˆ—è¡¨åˆ—çš„ç®€å•ç¤ºä¾‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{x =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }
  \AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"b"}\NormalTok{),}
  \AttributeTok{z =} \FunctionTok{list}\NormalTok{(}\FunctionTok{list}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\FunctionTok{list}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{))}
\NormalTok{)}
\NormalTok{df}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 3}
\CommentTok{\#\textgreater{}       x y     z         }
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}chr\textgreater{} \textless{}list\textgreater{}    }
\CommentTok{\#\textgreater{} 1     1 a     \textless{}list [2]\textgreater{}}
\CommentTok{\#\textgreater{} 2     2 b     \textless{}list [3]\textgreater{}}
\end{Highlighting}
\end{Shaded}

ä»£ç ä¸­çš„åˆ—è¡¨æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«ä¹‹å¤„ï¼Œå®ƒä»¬çš„è¡Œä¸ºå’Œå…¶ä»–åˆ—ä¸€æ ·:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(x }\SpecialCharTok{==} \DecValTok{1}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 3}
\CommentTok{\#\textgreater{}       x y     z         }
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}chr\textgreater{} \textless{}list\textgreater{}    }
\CommentTok{\#\textgreater{} 1     1 a     \textless{}list [2]\textgreater{}}
\end{Highlighting}
\end{Shaded}

å¤„ç†åˆ—è¡¨åˆ—æ¯”è¾ƒå›°éš¾ï¼Œè¿™æ˜¯å› ä¸ºåˆ©ç”¨åˆ—è¡¨è¿›è¡Œè®¡ç®—é€šå¸¸å°±æ¯”è¾ƒå›°éš¾ï¼›æˆ‘ä»¬å°†ä¼šåœ¨
ç« èŠ‚~\ref{sec-iteration} å›åˆ°è¿™ä¸ªè¯é¢˜ã€‚åœ¨
æœ¬ç« ï¼Œæˆ‘ä»¬å°†ä¸“æ³¨äºå°†åˆ—è¡¨åˆ—å±•å¼€ä¸ºå¸¸è§„å˜é‡ï¼Œè¿™æ ·ä½ å°±å¯ä»¥ä½¿ç”¨ç°æœ‰çš„å·¥å…·æ¥å¤„ç†å®ƒä»¬ã€‚

é»˜è®¤çš„è¾“å‡ºæ–¹æ³•åªæ˜¯æ˜¾ç¤ºå†…å®¹çš„å¤§è‡´æ±‡æ€»ã€‚åˆ—
è¡¨åˆ—å¯èƒ½éå¸¸å¤æ‚ï¼Œå› æ­¤æ²¡æœ‰å¾ˆå¥½çš„è¾“å‡ºæ–¹å¼ã€‚å¦‚
æœä½ æƒ³æŸ¥çœ‹å®ƒï¼Œéœ€è¦å•ç‹¬æå–å‡ºåˆ—è¡¨åˆ—ï¼Œå¹¶åº”ç”¨ä½ å·²ç»å­¦è¿‡çš„æŸç§æ–¹æ³•ï¼Œæ¯”å¦‚\texttt{df\ \textbar{}\textgreater{}\ pull(z)\ \textbar{}\textgreater{}\ str()}
æˆ–
\texttt{df\ \textbar{}\textgreater{}\ pull(z)\ \textbar{}\textgreater{}\ View()}ã€‚

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, titlerule=0mm, breakable, colback=white, opacityback=0, bottomtitle=1mm, colbacktitle=quarto-callout-note-color!10!white, toptitle=1mm, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{åŸºç¡€ R}, arc=.35mm, left=2mm, opacitybacktitle=0.6, rightrule=.15mm, bottomrule=.15mm, colframe=quarto-callout-note-color-frame, coltitle=black, leftrule=.75mm]

å¯ä»¥å°†åˆ—è¡¨æ”¾å…¥æ•°æ®æ¡†çš„æŸä¸€åˆ—ä¸­ï¼Œä½†è¿™æ ·åšä¼šæ¯”è¾ƒç¹çï¼Œå› ä¸º\texttt{data.frame()}å‡½æ•°å°†åˆ—è¡¨è§†ä¸ºåˆ—çš„åˆ—è¡¨:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{x =} \FunctionTok{list}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }\DecValTok{3}\SpecialCharTok{:}\DecValTok{5}\NormalTok{))}
\CommentTok{\#\textgreater{}   x.1.3 x.3.5}
\CommentTok{\#\textgreater{} 1     1     3}
\CommentTok{\#\textgreater{} 2     2     4}
\CommentTok{\#\textgreater{} 3     3     5}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥é€šè¿‡å°†åˆ—è¡¨å°è£…åœ¨\texttt{I()}å‡½æ•°ä¸­æ¥å¼ºåˆ¶\texttt{data.frame()}å°†åˆ—è¡¨è§†ä¸ºè¡Œçš„åˆ—è¡¨ï¼Œä½†è¿™æ ·å¾—åˆ°çš„ç»“æœè¾“å‡ºæ•ˆæœå¹¶ä¸å¥½ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data.frame}\NormalTok{(}
  \AttributeTok{x =} \FunctionTok{I}\NormalTok{(}\FunctionTok{list}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{, }\DecValTok{3}\SpecialCharTok{:}\DecValTok{5}\NormalTok{)), }
  \AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\StringTok{"1, 2"}\NormalTok{, }\StringTok{"3, 4, 5"}\NormalTok{)}
\NormalTok{)}
\CommentTok{\#\textgreater{}         x       y}
\CommentTok{\#\textgreater{} 1    1, 2    1, 2}
\CommentTok{\#\textgreater{} 2 3, 4, 5 3, 4, 5}
\end{Highlighting}
\end{Shaded}

ä½¿ç”¨tibbleä¸­çš„åˆ—è¡¨åˆ—æ›´ä¸ºç®€å•ï¼Œå› ä¸ºtibble()å°†åˆ—è¡¨è§†ä¸ºå‘é‡ï¼Œå¹¶ä¸”è¾“å‡ºæ–¹æ³•ä¹Ÿæ˜¯ä¸“é—¨ä¸ºå¤„ç†åˆ—è¡¨è€Œè®¾è®¡çš„ã€‚

\end{tcolorbox}

\section{\texorpdfstring{\textbf{è§£åµŒå¥—}}{è§£åµŒå¥—}}\label{ux89e3ux5d4cux5957}

ç°åœ¨ä½ å·²ç»å­¦ä¹ äº†åˆ—è¡¨å’Œåˆ—è¡¨åˆ—çš„åŸºç¡€çŸ¥è¯†ï¼Œè®©æˆ‘ä»¬æ¥æ¢ç´¢å¦‚ä½•å°†å®ƒä»¬è½¬å›ä¸ºå¸¸è§„çš„è¡Œå’Œåˆ—ã€‚åœ¨
è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä½¿ç”¨éå¸¸ç®€å•çš„ç¤ºä¾‹æ•°æ®æ¥å¸®åŠ©ä½ ç†è§£åŸºæœ¬æ¦‚å¿µï¼›åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†åˆ‡æ¢åˆ°çœŸå®çš„æ•°æ®ã€‚

åˆ—è¡¨åˆ—é€šå¸¸æœ‰ä¸¤ç§åŸºæœ¬å½¢å¼ï¼šå‘½åå’Œæœªå‘½åã€‚å½“
å…ƒç´ è¢«å‘½åæ—¶ï¼Œå®ƒä»¬å¾€å¾€åœ¨æ¯ä¸€è¡Œä¸­éƒ½æœ‰ç›¸åŒçš„åç§°ã€‚ä¾‹
å¦‚ï¼Œåœ¨\texttt{df1}ä¸­ï¼Œåˆ—è¡¨åˆ—\texttt{y}çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½æœ‰ä¸¤ä¸ªåä¸º\texttt{a}å’Œ\texttt{b}çš„å…ƒç´ ã€‚å‘½
åçš„åˆ—è¡¨åˆ—è‡ªç„¶åœ°è¢«è§£åµŒå¥— (unnest)
ä¸ºåˆ—ï¼šæ¯ä¸ªå‘½åçš„å…ƒç´ éƒ½ä¼šå˜æˆä¸€ä¸ªæ–°çš„å‘½ååˆ—ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df1 }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{x, }\SpecialCharTok{\textasciitilde{}}\NormalTok{y,}
  \DecValTok{1}\NormalTok{, }\FunctionTok{list}\NormalTok{(}\AttributeTok{a =} \DecValTok{11}\NormalTok{, }\AttributeTok{b =} \DecValTok{12}\NormalTok{),}
  \DecValTok{2}\NormalTok{, }\FunctionTok{list}\NormalTok{(}\AttributeTok{a =} \DecValTok{21}\NormalTok{, }\AttributeTok{b =} \DecValTok{22}\NormalTok{),}
  \DecValTok{3}\NormalTok{, }\FunctionTok{list}\NormalTok{(}\AttributeTok{a =} \DecValTok{31}\NormalTok{, }\AttributeTok{b =} \DecValTok{32}\NormalTok{),}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

å½“å…ƒç´ æœªè¢«å‘½åæ—¶ï¼Œå…ƒç´ çš„æ•°é‡å¾€å¾€å› è¡Œè€Œå¼‚ã€‚ä¾‹
å¦‚ï¼Œåœ¨\texttt{df2}ä¸­ï¼Œåˆ—è¡¨åˆ—\texttt{y}çš„å…ƒç´ æœªè¢«å‘½åï¼Œä¸”é•¿åº¦ä»ä¸€åˆ°ä¸‰ä¸ç­‰ã€‚æœª
å‘½åçš„åˆ—è¡¨åˆ—è‡ªç„¶ä¼šè§£åµŒå¥—ä¸ºè¡Œï¼šä½ ä¼šä¸ºæ¯ä¸ªå…ƒç´ å¾—åˆ°ä¸€è¡Œã€‚

\begin{Shaded}
\begin{Highlighting}[]

\NormalTok{df2 }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{x, }\SpecialCharTok{\textasciitilde{}}\NormalTok{y,}
  \DecValTok{1}\NormalTok{, }\FunctionTok{list}\NormalTok{(}\DecValTok{11}\NormalTok{, }\DecValTok{12}\NormalTok{, }\DecValTok{13}\NormalTok{),}
  \DecValTok{2}\NormalTok{, }\FunctionTok{list}\NormalTok{(}\DecValTok{21}\NormalTok{),}
  \DecValTok{3}\NormalTok{, }\FunctionTok{list}\NormalTok{(}\DecValTok{31}\NormalTok{, }\DecValTok{32}\NormalTok{),}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\texttt{tidyr}åŒ…ä¸ºè¿™ä¸¤ç§æƒ…å†µæä¾›äº†ä¸¤ä¸ªå‡½æ•°ï¼š\texttt{unnest\_wider()}å’Œ\texttt{unnest\_longer()}ã€‚ä»¥
ä¸‹éƒ¨åˆ†å°†è§£é‡Šå®ƒä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

\subsection{\texorpdfstring{\texttt{unnest\_wider()}}{unnest\_wider()}}\label{unnest_wider}

å½“æ¯ä¸€è¡Œéƒ½æœ‰ç›¸åŒæ•°é‡ä¸”åç§°ç›¸åŒçš„å…ƒç´ æ—¶ï¼Œå°±åƒ\texttt{df1}ä¸€æ ·ï¼Œå¾ˆè‡ªç„¶åœ°å°†æ¯ä¸ªç»„ä»¶æ”¾å…¥å®ƒè‡ªå·±çš„åˆ—ä¸­ï¼Œè¿™å¯ä»¥é€šè¿‡ä½¿ç”¨\texttt{unnest\_wider()}æ¥å®ç°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df1 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(y)}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 3}
\CommentTok{\#\textgreater{}       x     a     b}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1    11    12}
\CommentTok{\#\textgreater{} 2     2    21    22}
\CommentTok{\#\textgreater{} 3     3    31    32}
\end{Highlighting}
\end{Shaded}

é»˜è®¤æƒ…å†µä¸‹ï¼Œæ–°åˆ—çš„åç§°ä»…æ¥è‡ªåˆ—è¡¨å…ƒç´ çš„åç§°ï¼Œä½†ä½ å¯ä»¥ä½¿ç”¨\texttt{names\_sep}å‚æ•°æ¥è¯·æ±‚å°†åˆ—åå’Œå…ƒç´ åç»„åˆèµ·æ¥ã€‚è¿™
åœ¨æ¶ˆé™¤é‡å¤åç§°çš„æ­§ä¹‰æ—¶å¾ˆæœ‰ç”¨ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df1 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(y, }\AttributeTok{names\_sep =} \StringTok{"\_"}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 3}
\CommentTok{\#\textgreater{}       x   y\_a   y\_b}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1    11    12}
\CommentTok{\#\textgreater{} 2     2    21    22}
\CommentTok{\#\textgreater{} 3     3    31    32}
\end{Highlighting}
\end{Shaded}

\subsection{\texorpdfstring{\texttt{unnest\_longer()}}{unnest\_longer()}}\label{unnest_longer}

å½“æ¯ä¸€è¡Œéƒ½åŒ…å«ä¸€ä¸ªæœªå‘½åçš„åˆ—è¡¨æ—¶ï¼Œæœ€è‡ªç„¶çš„åšæ³•æ˜¯å°†æ¯ä¸ªå…ƒç´ æ”¾å…¥å®ƒè‡ªå·±çš„è¡Œä¸­ï¼Œè¿™å¯ä»¥é€šè¿‡ä½¿ç”¨\texttt{unnest\_longer()}æ¥å®ç°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df2 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_longer}\NormalTok{(y)}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 2}
\CommentTok{\#\textgreater{}       x     y}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1    11}
\CommentTok{\#\textgreater{} 2     1    12}
\CommentTok{\#\textgreater{} 3     1    13}
\CommentTok{\#\textgreater{} 4     2    21}
\CommentTok{\#\textgreater{} 5     3    31}
\CommentTok{\#\textgreater{} 6     3    32}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„ï¼Œå¯¹äº\texttt{y}ä¸­çš„æ¯ä¸ªå…ƒç´ \texttt{x}éƒ½è¢«é‡å¤äº†ï¼šæˆ‘ä»¬ä¸ºåˆ—è¡¨åˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½è¾“å‡ºäº†ä¸€è¡Œã€‚ä½†
æ˜¯ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªå…ƒç´ æ˜¯ç©ºçš„ï¼Œå°±åƒä¸‹é¢çš„ä¾‹å­é‚£æ ·ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df6 }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{x, }\SpecialCharTok{\textasciitilde{}}\NormalTok{y,}
  \StringTok{"a"}\NormalTok{, }\FunctionTok{list}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{),}
  \StringTok{"b"}\NormalTok{, }\FunctionTok{list}\NormalTok{(}\DecValTok{3}\NormalTok{),}
  \StringTok{"c"}\NormalTok{, }\FunctionTok{list}\NormalTok{()}
\NormalTok{)}
\NormalTok{df6 }\SpecialCharTok{|\textgreater{}} \FunctionTok{unnest\_longer}\NormalTok{(y)}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 2}
\CommentTok{\#\textgreater{}   x         y}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 a         1}
\CommentTok{\#\textgreater{} 2 a         2}
\CommentTok{\#\textgreater{} 3 b         3}
\end{Highlighting}
\end{Shaded}

åœ¨è¾“å‡ºä¸­ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°é›¶è¡Œï¼Œæ‰€ä»¥é‚£ä¸€è¡Œå®é™…ä¸Šä¼šæ¶ˆå¤±ã€‚å¦‚
æœä½ æƒ³è¦ä¿ç•™é‚£ä¸€è¡Œï¼Œå¯ä»¥åœ¨\texttt{y}ä¸­æ·»åŠ \texttt{NA}ï¼Œå¹¶è®¾ç½®\texttt{keep\_empty\ =\ TRUE}ã€‚

We get zero rows in the output, so the row effectively disappears. If
you want to preserve that row, adding \texttt{NA} in \texttt{y}, set
\texttt{keep\_empty\ =\ TRUE}.

\subsection{ç±»å‹ä¸ä¸€è‡´}\label{ux7c7bux578bux4e0dux4e00ux81f4}

å¦‚æœä½ è§£åµŒå¥—ä¸€ä¸ªåŒ…å«ä¸åŒç±»å‹å‘é‡çš„åˆ—è¡¨åˆ—ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä¾‹
å¦‚ï¼Œè€ƒè™‘ä»¥ä¸‹æ•°æ®é›†ï¼Œå…¶ä¸­åˆ—è¡¨åˆ—\texttt{y}åŒ…å«ä¸¤ä¸ªæ•°å­—ã€ä¸€ä¸ªå­—ç¬¦å’Œä¸€ä¸ªé€»è¾‘å€¼ï¼Œå®ƒä»¬é€šå¸¸ä¸èƒ½æ··åˆåœ¨åŒä¸€ä¸ªåˆ—ä¸­ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df4 }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{x, }\SpecialCharTok{\textasciitilde{}}\NormalTok{y,}
  \StringTok{"a"}\NormalTok{, }\FunctionTok{list}\NormalTok{(}\DecValTok{1}\NormalTok{),}
  \StringTok{"b"}\NormalTok{, }\FunctionTok{list}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\ConstantTok{TRUE}\NormalTok{, }\DecValTok{5}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\texttt{unnest\_longer()}æ€»æ˜¯ä¿æŒåˆ—é›†ä¸å˜ï¼ŒåŒæ—¶æ”¹å˜è¡Œæ•°ã€‚é‚£
ä¹ˆè¿™æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ\texttt{u}
\texttt{nnest\_longer()}æ˜¯å¦‚ä½•åœ¨ä¿æŒ\texttt{y}ä¸­æ‰€æœ‰å†…å®¹çš„åŒæ—¶äº§ç”Ÿäº”è¡Œçš„å‘¢ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df4 }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_longer}\NormalTok{(y)}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 2}
\CommentTok{\#\textgreater{}   x     y        }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}list\textgreater{}   }
\CommentTok{\#\textgreater{} 1 a     \textless{}dbl [1]\textgreater{}}
\CommentTok{\#\textgreater{} 2 b     \textless{}chr [1]\textgreater{}}
\CommentTok{\#\textgreater{} 3 b     \textless{}lgl [1]\textgreater{}}
\CommentTok{\#\textgreater{} 4 b     \textless{}dbl [1]\textgreater{}}
\end{Highlighting}
\end{Shaded}

å¦‚ä½ æ‰€è§ï¼Œè¾“å‡ºåŒ…å«äº†ä¸€ä¸ªåˆ—è¡¨åˆ—ï¼Œä½†åˆ—è¡¨åˆ—çš„æ¯ä¸ªå…ƒç´ éƒ½åŒ…å«ä¸€ä¸ªå•ä¸€å…ƒç´ ã€‚å› 
ä¸º\texttt{unnest\_longer()}ä¸èƒ½æ‰¾åˆ°ä¸€ä¸ªé€šç”¨çš„å‘é‡ç±»å‹ï¼Œæ‰€ä»¥å®ƒä¿ç•™äº†åˆ—è¡¨åˆ—ä¸­çš„åŸå§‹ç±»å‹ã€‚ä½ 
å¯èƒ½ä¼šæƒ³ï¼Œè¿™æ˜¯å¦è¿åäº†åˆ—ä¸­æ¯ä¸ªå…ƒç´ éƒ½å¿…é¡»æ˜¯ç›¸åŒç±»å‹çš„è§„åˆ™ã€‚å…¶
å®å¹¶æ²¡æœ‰ï¼šæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œå°½ç®¡å®ƒä»¬çš„å†…å®¹ç±»å‹ä¸åŒã€‚

å¤„ç†ä¸ä¸€è‡´çš„ç±»å‹æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ï¼Œå…·ä½“ç»†èŠ‚å–å†³äºé—®é¢˜çš„æœ¬è´¨å’Œä½ çš„ç›®æ ‡ï¼Œä½†ä½ æœ€æœ‰å¯èƒ½éœ€è¦æ¥è‡ª
ç« èŠ‚~\ref{sec-iteration} çš„å·¥å…·ã€‚

\subsection{å…¶ä»–å‡½æ•°}\label{ux5176ux4ed6ux51fdux6570-1}

tidyrè¿˜æœ‰ä¸€äº›å…¶ä»–æœ‰ç”¨çš„è§„æ•´å‡½æ•°ï¼Œæˆ‘ä»¬ä¸æ‰“ç®—åœ¨æœ¬ä¹¦ä¸­ä»‹ç»ï¼š

\begin{itemize}
\tightlist
\item
  \texttt{unnest\_auto()}æ ¹æ®åˆ—è¡¨åˆ—çš„ç»“æ„è‡ªåŠ¨é€‰æ‹©ä½¿ç”¨\texttt{unnest\_longer()}è¿˜æ˜¯\texttt{unnest\_wider()}ã€‚è¿™å¯¹äºå¿«é€Ÿæ¢ç´¢éå¸¸æœ‰ç”¨ï¼Œä½†æœ€ç»ˆä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œå› ä¸ºå®ƒä¸ä¼šè¿«ä½¿ä½ äº†è§£ä½ çš„æ•°æ®ç»“æ„ï¼Œå¹¶ä¸”ä¼šè®©ä½ çš„ä»£ç æ›´éš¾ç†è§£ã€‚
\item
  \texttt{unnest()}åŒæ—¶æ‰©å±•è¡Œå’Œåˆ—ã€‚å½“ä½ æœ‰ä¸€ä¸ªåˆ—è¡¨åˆ—ï¼Œå®ƒåŒ…å«äºŒç»´ç»“æ„ï¼ˆå¦‚æ•°æ®æ¡†ï¼‰æ—¶ï¼Œè¿™ä¸ªå‡½æ•°å¾ˆæœ‰ç”¨ï¼Œè™½ç„¶ä½ åœ¨æœ¬ä¹¦ä¸­çœ‹ä¸åˆ°è¿™ç§æƒ…å†µï¼Œä½†å¦‚æœä½ ä½¿ç”¨
  \href{https://www.tmwr.org/base-r.html\#combining-base-r-models-and-the-tidyverse}{tidymodels}
  ç”Ÿæ€ç³»ç»Ÿï¼Œå¯èƒ½ä¼šé‡åˆ°å®ƒã€‚
\end{itemize}

äº†è§£è¿™äº›å‡½æ•°æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œå› ä¸ºå½“ä½ åœ¨é˜…è¯»å…¶ä»–äººä»£ç æˆ–è‡ªå·±è§£å†³ä¸€äº›ä¸å¤ªå¸¸è§çš„æ•°æ®è§„æ•´æŒ‘æˆ˜æ—¶å¯èƒ½ä¼šé‡åˆ°å®ƒä»¬ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-56}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  å½“ä½ å¯¹åƒ\texttt{df2}è¿™æ ·çš„æœªå‘½ååˆ—è¡¨åˆ—ä½¿ç”¨\texttt{unnest\_wider()}æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿç°
  åœ¨éœ€è¦å“ªä¸ªå‚æ•°ï¼Ÿç¼º å¤±å€¼ä¼šå¦‚ä½•å¤„ç†ï¼Ÿ
\item
  å½“ä½ å¯¹åƒ\texttt{df1}è¿™æ ·çš„å‘½ååˆ—è¡¨åˆ—ä½¿ç”¨\texttt{unnest\_longer()}æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿè¾“
  å‡ºä¸­ä½ ä¼šå¾—åˆ°å“ªäº›é¢å¤–çš„ä¿¡æ¯ï¼Ÿå¦‚ ä½•æŠ‘åˆ¶è¿™äº›é¢å¤–çš„ä¿¡æ¯ï¼Ÿ
\item
  ä½ ä¼šæ—¶ä¸æ—¶åœ°é‡åˆ°åŒ…å«å¤šä¸ªåˆ—è¡¨åˆ—ä¸”å€¼ç›¸äº’å¯¹åº”çš„æ•°æ®æ¡†ã€‚ä¾‹
  å¦‚ï¼Œåœ¨ä»¥ä¸‹æ•°æ®æ¡†ä¸­\texttt{y}å’Œ\texttt{z}çš„å€¼æ˜¯å¯¹åº”çš„ï¼ˆå³æ¯è¡Œä¸­\texttt{y}å’Œ\texttt{z}çš„é•¿åº¦æ€»æ˜¯ç›¸åŒï¼Œ\texttt{y}çš„ç¬¬ä¸€ä¸ªå€¼å¯¹åº”äº\texttt{z}çš„ç¬¬ä¸€ä¸ªå€¼ï¼‰ã€‚å¦‚
  æœä½ å¯¹è¿™ä¸ªæ•°æ®æ¡†è¿ç»­ä½¿ç”¨ä¸¤æ¬¡\texttt{unnest\_longer()}è°ƒç”¨ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå¦‚
  ä½•ä¿æŒ\texttt{x}å’Œ\texttt{y}ä¹‹é—´çš„å…³ç³»ï¼Ÿ( æç¤º: ä»”ç»†é˜…è¯»æ–‡æ¡£)ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df4 }\OtherTok{\textless{}{-}} \FunctionTok{tribble}\NormalTok{(}
  \SpecialCharTok{\textasciitilde{}}\NormalTok{x, }\SpecialCharTok{\textasciitilde{}}\NormalTok{y, }\SpecialCharTok{\textasciitilde{}}\NormalTok{z,}
  \StringTok{"a"}\NormalTok{, }\FunctionTok{list}\NormalTok{(}\StringTok{"y{-}a{-}1"}\NormalTok{, }\StringTok{"y{-}a{-}2"}\NormalTok{), }\FunctionTok{list}\NormalTok{(}\StringTok{"z{-}a{-}1"}\NormalTok{, }\StringTok{"z{-}a{-}2"}\NormalTok{),}
  \StringTok{"b"}\NormalTok{, }\FunctionTok{list}\NormalTok{(}\StringTok{"y{-}b{-}1"}\NormalTok{, }\StringTok{"y{-}b{-}2"}\NormalTok{, }\StringTok{"y{-}b{-}3"}\NormalTok{), }\FunctionTok{list}\NormalTok{(}\StringTok{"z{-}b{-}1"}\NormalTok{, }\StringTok{"z{-}b{-}2"}\NormalTok{, }\StringTok{"z{-}b{-}3"}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{æ¡ˆä¾‹ç ”ç©¶}\label{ux6848ux4f8bux7814ux7a76}

æˆ‘ä»¬ä¸Šé¢ä½¿ç”¨çš„ç®€å•ç¤ºä¾‹ä¸çœŸå®æ•°æ®ä¹‹é—´çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼ŒçœŸå®æ•°æ®é€šå¸¸åŒ…å«å¤šä¸ªåµŒå¥—çº§åˆ«ï¼Œè¿™éœ€è¦å¤šæ¬¡è°ƒç”¨\texttt{unnest\_longer()}å’Œ/æˆ–\texttt{unnest\_wider()}ã€‚ä¸º
äº†å±•ç¤ºè¿™ä¸€ç‚¹ï¼Œæœ¬èŠ‚å°†é€šè¿‡ä½¿ç”¨\texttt{repurrrsive}åŒ…ä¸­çš„æ•°æ®é›†è§£å†³ä¸‰ä¸ªçœŸå®çš„è§„æ•´æŒ‘æˆ˜ã€‚

\subsection{å¾ˆå®½çš„æ•°æ®}\label{ux5f88ux5bbdux7684ux6570ux636e}

æˆ‘ä»¬å°†ä»\texttt{gh\_repos}å¼€å§‹ã€‚è¿™ æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«ä½¿ç”¨GitHub
APIæ£€ç´¢çš„ä¸€ç»„GitHubå­˜å‚¨åº“çš„æ•°æ®ã€‚å®ƒ
æ˜¯ä¸€ä¸ªæ·±åº¦åµŒå¥—çš„åˆ—è¡¨ï¼Œå› æ­¤åœ¨æœ¬ä¹¦ä¸­å¾ˆéš¾å±•ç¤ºå…¶ç»“æ„ï¼›æˆ‘ä»¬å»ºè®®åœ¨ç»§ç»­ä¹‹å‰ï¼Œä½ è‡ªå·±ä½¿ç”¨\texttt{View(gh\_repos)}ç¨å¾®æ¢ç´¢ä¸€ä¸‹ã€‚

\texttt{gh\_repos}æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œä½†æˆ‘ä»¬çš„å·¥å…·å¤„ç†çš„æ˜¯åˆ—è¡¨åˆ—ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆå°†å…¶æ”¾å…¥ä¸€ä¸ªtibbleä¸­ã€‚æˆ‘
ä»¬å°†å…¶åˆ—å‘½åä¸º\texttt{json}ï¼Œç¨åæˆ‘ä»¬ä¼šè§£é‡ŠåŸå› ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{repos }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{json =}\NormalTok{ gh\_repos)}
\NormalTok{repos}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 1}
\CommentTok{\#\textgreater{}   json       }
\CommentTok{\#\textgreater{}   \textless{}list\textgreater{}     }
\CommentTok{\#\textgreater{} 1 \textless{}list [30]\textgreater{}}
\CommentTok{\#\textgreater{} 2 \textless{}list [30]\textgreater{}}
\CommentTok{\#\textgreater{} 3 \textless{}list [30]\textgreater{}}
\CommentTok{\#\textgreater{} 4 \textless{}list [26]\textgreater{}}
\CommentTok{\#\textgreater{} 5 \textless{}list [30]\textgreater{}}
\CommentTok{\#\textgreater{} 6 \textless{}list [30]\textgreater{}}
\end{Highlighting}
\end{Shaded}

è¿™ä¸ªtibbleåŒ…å«6è¡Œï¼Œæ¯ä¸€è¡Œå¯¹åº”\texttt{gh\_repos}çš„ä¸€ä¸ªå…ƒç´ ã€‚æ¯
ä¸€è¡ŒåŒ…å«ä¸€ä¸ªæœªå‘½åçš„åˆ—è¡¨ï¼Œè¯¥åˆ—è¡¨åŒ…å«26è¡Œæˆ–30è¡Œã€‚ç”±
äºè¿™äº›åˆ—è¡¨æ˜¯æœªå‘½åçš„ï¼Œæˆ‘ä»¬å°†é¦–å…ˆä½¿ç”¨\texttt{unnest\_longer()}å°†æ¯ä¸ªå­å…ƒç´ æ”¾åœ¨å®ƒè‡ªå·±çš„è¡Œä¸­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{repos }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_longer}\NormalTok{(json)}
\CommentTok{\#\textgreater{} \# A tibble: 176 x 1}
\CommentTok{\#\textgreater{}   json             }
\CommentTok{\#\textgreater{}   \textless{}list\textgreater{}           }
\CommentTok{\#\textgreater{} 1 \textless{}named list [68]\textgreater{}}
\CommentTok{\#\textgreater{} 2 \textless{}named list [68]\textgreater{}}
\CommentTok{\#\textgreater{} 3 \textless{}named list [68]\textgreater{}}
\CommentTok{\#\textgreater{} 4 \textless{}named list [68]\textgreater{}}
\CommentTok{\#\textgreater{} 5 \textless{}named list [68]\textgreater{}}
\CommentTok{\#\textgreater{} 6 \textless{}named list [68]\textgreater{}}
\CommentTok{\#\textgreater{} \# i 170 more rows}
\end{Highlighting}
\end{Shaded}

ä¹ä¸€çœ‹ï¼Œæƒ…å†µä¼¼ä¹å¹¶æ²¡æœ‰æ”¹å–„ï¼šè™½ç„¶æˆ‘ä»¬æœ‰äº†æ›´å¤šçš„è¡Œï¼ˆä»6è¡Œå¢åŠ åˆ°176è¡Œï¼‰ï¼Œä½†\texttt{json}ä¸­çš„æ¯ä¸ªå…ƒç´ ä»ç„¶æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚ç„¶
è€Œï¼Œæœ‰ä¸€ä¸ªé‡è¦çš„åŒºåˆ«ï¼šç°åœ¨æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªå‘½ååˆ—è¡¨ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{unnest\_wider()}å°†æ¯ä¸ªå…ƒç´ æ”¾å…¥å®ƒè‡ªå·±çš„åˆ—ä¸­ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{repos }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_longer}\NormalTok{(json) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(json) }
\CommentTok{\#\textgreater{} \# A tibble: 176 x 68}
\CommentTok{\#\textgreater{}         id name        full\_name         owner        private html\_url       }
\CommentTok{\#\textgreater{}      \textless{}int\textgreater{} \textless{}chr\textgreater{}       \textless{}chr\textgreater{}             \textless{}list\textgreater{}       \textless{}lgl\textgreater{}   \textless{}chr\textgreater{}          }
\CommentTok{\#\textgreater{} 1 61160198 after       gaborcsardi/after \textless{}named list\textgreater{} FALSE   https://github\textasciitilde{}}
\CommentTok{\#\textgreater{} 2 40500181 argufy      gaborcsardi/argu\textasciitilde{} \textless{}named list\textgreater{} FALSE   https://github\textasciitilde{}}
\CommentTok{\#\textgreater{} 3 36442442 ask         gaborcsardi/ask   \textless{}named list\textgreater{} FALSE   https://github\textasciitilde{}}
\CommentTok{\#\textgreater{} 4 34924886 baseimports gaborcsardi/base\textasciitilde{} \textless{}named list\textgreater{} FALSE   https://github\textasciitilde{}}
\CommentTok{\#\textgreater{} 5 61620661 citest      gaborcsardi/cite\textasciitilde{} \textless{}named list\textgreater{} FALSE   https://github\textasciitilde{}}
\CommentTok{\#\textgreater{} 6 33907457 clisymbols  gaborcsardi/clis\textasciitilde{} \textless{}named list\textgreater{} FALSE   https://github\textasciitilde{}}
\CommentTok{\#\textgreater{} \# i 170 more rows}
\CommentTok{\#\textgreater{} \# i 62 more variables: description \textless{}chr\textgreater{}, fork \textless{}lgl\textgreater{}, url \textless{}chr\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

è¿™ä¸ªæ–¹æ³•å¥æ•ˆäº†ï¼Œä½†ç»“æœæœ‰ç‚¹ä»¤äººçœ¼èŠ±ç¼­ä¹±ï¼šåˆ—å¤ªå¤šäº†ï¼Œtibbleç”šè‡³æ²¡æœ‰å…¨éƒ¨è¾“å‡ºï¼æˆ‘
ä»¬å¯ä»¥ç”¨\texttt{names()}å‡½æ•°æŸ¥çœ‹æ‰€æœ‰åˆ—ï¼›è¿™é‡Œæˆ‘ä»¬æŸ¥çœ‹å‰10åˆ—ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{repos }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_longer}\NormalTok{(json) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(json) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{names}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{head}\NormalTok{(}\DecValTok{10}\NormalTok{)}
\CommentTok{\#\textgreater{}  [1] "id"          "name"        "full\_name"   "owner"       "private"    }
\CommentTok{\#\textgreater{}  [6] "html\_url"    "description" "fork"        "url"         "forks\_url"}
\end{Highlighting}
\end{Shaded}

è®©æˆ‘ä»¬æŒ‘é€‰ä¸€äº›çœ‹èµ·æ¥å¾ˆæœ‰è¶£çš„:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{repos }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_longer}\NormalTok{(json) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(json) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(id, full\_name, owner, description)}
\CommentTok{\#\textgreater{} \# A tibble: 176 x 4}
\CommentTok{\#\textgreater{}         id full\_name               owner             description             }
\CommentTok{\#\textgreater{}      \textless{}int\textgreater{} \textless{}chr\textgreater{}                   \textless{}list\textgreater{}            \textless{}chr\textgreater{}                   }
\CommentTok{\#\textgreater{} 1 61160198 gaborcsardi/after       \textless{}named list [17]\textgreater{} Run Code in the Backgro\textasciitilde{}}
\CommentTok{\#\textgreater{} 2 40500181 gaborcsardi/argufy      \textless{}named list [17]\textgreater{} Declarative function ar\textasciitilde{}}
\CommentTok{\#\textgreater{} 3 36442442 gaborcsardi/ask         \textless{}named list [17]\textgreater{} Friendly CLI interactio\textasciitilde{}}
\CommentTok{\#\textgreater{} 4 34924886 gaborcsardi/baseimports \textless{}named list [17]\textgreater{} Do we get warnings for \textasciitilde{}}
\CommentTok{\#\textgreater{} 5 61620661 gaborcsardi/citest      \textless{}named list [17]\textgreater{} Test R package and repo\textasciitilde{}}
\CommentTok{\#\textgreater{} 6 33907457 gaborcsardi/clisymbols  \textless{}named list [17]\textgreater{} Unicode symbols for CLI\textasciitilde{}}
\CommentTok{\#\textgreater{} \# i 170 more rows}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥åˆ©ç”¨è¿™ä¸ªä¿¡æ¯åæ¨\texttt{gh\_repos}çš„ç»“æ„ï¼šæ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªGitHubç”¨æˆ·ï¼ŒåŒ…å«ä»–ä»¬åˆ›å»ºçš„æœ€å¤š30ä¸ªGitHubå­˜å‚¨åº“çš„åˆ—è¡¨ã€‚

\texttt{owner}æ˜¯å¦ä¸€ä¸ªåˆ—è¡¨åˆ—ï¼Œå› ä¸ºå®ƒåŒ…å«äº†ä¸€ä¸ªå‘½ååˆ—è¡¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{unnest\_wider()}æ¥è·å–è¿™äº›å€¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{repos }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_longer}\NormalTok{(json) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(json) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(id, full\_name, owner, description) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(owner)}
\CommentTok{\#\textgreater{} Error in \textasciigrave{}unnest\_wider()\textasciigrave{}:}
\CommentTok{\#\textgreater{} ! Can\textquotesingle{}t duplicate names between the affected columns and the original}
\CommentTok{\#\textgreater{}   data.}
\CommentTok{\#\textgreater{} x These names are duplicated:}
\CommentTok{\#\textgreater{}   i \textasciigrave{}id\textasciigrave{}, from \textasciigrave{}owner\textasciigrave{}.}
\CommentTok{\#\textgreater{} i Use \textasciigrave{}names\_sep\textasciigrave{} to disambiguate using the column name.}
\CommentTok{\#\textgreater{} i Or use \textasciigrave{}names\_repair\textasciigrave{} to specify a repair strategy.}
\end{Highlighting}
\end{Shaded}

å‘ƒï¼Œè¿™ä¸ªåˆ—è¡¨åˆ—ä¹ŸåŒ…å«ä¸€ä¸ª\texttt{id}åˆ—ï¼Œè€Œæˆ‘ä»¬ä¸èƒ½åœ¨åŒä¸€æ•°æ®æ¡†ä¸­æœ‰ä¸¤ä¸ª\texttt{id}åˆ—ã€‚æ­£
å¦‚å»ºè®®çš„é‚£æ ·ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨\texttt{names\_sep}æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{repos }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_longer}\NormalTok{(json) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(json) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(id, full\_name, owner, description) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(owner, }\AttributeTok{names\_sep =} \StringTok{"\_"}\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 176 x 20}
\CommentTok{\#\textgreater{}         id full\_name               owner\_login owner\_id owner\_avatar\_url     }
\CommentTok{\#\textgreater{}      \textless{}int\textgreater{} \textless{}chr\textgreater{}                   \textless{}chr\textgreater{}          \textless{}int\textgreater{} \textless{}chr\textgreater{}                }
\CommentTok{\#\textgreater{} 1 61160198 gaborcsardi/after       gaborcsardi   660288 https://avatars.gith\textasciitilde{}}
\CommentTok{\#\textgreater{} 2 40500181 gaborcsardi/argufy      gaborcsardi   660288 https://avatars.gith\textasciitilde{}}
\CommentTok{\#\textgreater{} 3 36442442 gaborcsardi/ask         gaborcsardi   660288 https://avatars.gith\textasciitilde{}}
\CommentTok{\#\textgreater{} 4 34924886 gaborcsardi/baseimports gaborcsardi   660288 https://avatars.gith\textasciitilde{}}
\CommentTok{\#\textgreater{} 5 61620661 gaborcsardi/citest      gaborcsardi   660288 https://avatars.gith\textasciitilde{}}
\CommentTok{\#\textgreater{} 6 33907457 gaborcsardi/clisymbols  gaborcsardi   660288 https://avatars.gith\textasciitilde{}}
\CommentTok{\#\textgreater{} \# i 170 more rows}
\CommentTok{\#\textgreater{} \# i 15 more variables: owner\_gravatar\_id \textless{}chr\textgreater{}, owner\_url \textless{}chr\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

è¿™ç»™å‡ºäº†å¦ä¸€ä¸ªå®½æ•°æ®é›†ï¼Œä½†ä½ å¯ä»¥æ„Ÿè§‰åˆ°\texttt{owner}ä¼¼ä¹åŒ…å«äº†å¾ˆå¤šå…³äº``æ‹¥æœ‰''å­˜å‚¨åº“çš„äººçš„é¢å¤–æ•°æ®ã€‚

\subsection{å…³ç³»å‹æ•°æ®}\label{ux5173ux7cfbux578bux6570ux636e}

åµŒå¥—æ•°æ®æœ‰æ—¶è¢«ç”¨äºè¡¨ç¤ºåˆ†æ•£åœ¨å¤šä¸ªæ•°æ®æ¡†ä¸­çš„æ•°æ®ã€‚ä¾‹
å¦‚ï¼Œ\texttt{got\_chars}åŒ…å«æœ‰å…³åœ¨ã€ŠæƒåŠ›çš„æ¸¸æˆã€‹ä¹¦ç±å’Œç”µè§†å‰§ä¸­å‡ºç°çš„è§’è‰²æ•°æ®ã€‚å’Œ
\texttt{gh\_repos}ä¸€æ ·ï¼Œå®ƒæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆå°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªtibbleçš„åˆ—è¡¨åˆ—ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{chars }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{json =}\NormalTok{ got\_chars)}
\NormalTok{chars}
\CommentTok{\#\textgreater{} \# A tibble: 30 x 1}
\CommentTok{\#\textgreater{}   json             }
\CommentTok{\#\textgreater{}   \textless{}list\textgreater{}           }
\CommentTok{\#\textgreater{} 1 \textless{}named list [18]\textgreater{}}
\CommentTok{\#\textgreater{} 2 \textless{}named list [18]\textgreater{}}
\CommentTok{\#\textgreater{} 3 \textless{}named list [18]\textgreater{}}
\CommentTok{\#\textgreater{} 4 \textless{}named list [18]\textgreater{}}
\CommentTok{\#\textgreater{} 5 \textless{}named list [18]\textgreater{}}
\CommentTok{\#\textgreater{} 6 \textless{}named list [18]\textgreater{}}
\CommentTok{\#\textgreater{} \# i 24 more rows}
\end{Highlighting}
\end{Shaded}

\texttt{json}åˆ—åŒ…å«å…·æœ‰åç§°çš„å…ƒç´ ï¼Œå› æ­¤æˆ‘ä»¬é¦–å…ˆå°†å…¶æ‹“å®½ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{chars }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(json)}
\CommentTok{\#\textgreater{} \# A tibble: 30 x 18}
\CommentTok{\#\textgreater{}   url                    id name            gender culture    born           }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}               \textless{}int\textgreater{} \textless{}chr\textgreater{}           \textless{}chr\textgreater{}  \textless{}chr\textgreater{}      \textless{}chr\textgreater{}          }
\CommentTok{\#\textgreater{} 1 https://www.anapio\textasciitilde{}  1022 Theon Greyjoy   Male   "Ironborn" "In 278 AC or \textasciitilde{}}
\CommentTok{\#\textgreater{} 2 https://www.anapio\textasciitilde{}  1052 Tyrion Lannist\textasciitilde{} Male   ""         "In 273 AC, at\textasciitilde{}}
\CommentTok{\#\textgreater{} 3 https://www.anapio\textasciitilde{}  1074 Victarion Grey\textasciitilde{} Male   "Ironborn" "In 268 AC or \textasciitilde{}}
\CommentTok{\#\textgreater{} 4 https://www.anapio\textasciitilde{}  1109 Will            Male   ""         ""             }
\CommentTok{\#\textgreater{} 5 https://www.anapio\textasciitilde{}  1166 Areo Hotah      Male   "Norvoshi" "In 257 AC or \textasciitilde{}}
\CommentTok{\#\textgreater{} 6 https://www.anapio\textasciitilde{}  1267 Chett           Male   ""         "At Hag\textquotesingle{}s Mire"}
\CommentTok{\#\textgreater{} \# i 24 more rows}
\CommentTok{\#\textgreater{} \# i 12 more variables: died \textless{}chr\textgreater{}, alive \textless{}lgl\textgreater{}, titles \textless{}list\textgreater{}, ...}
\end{Highlighting}
\end{Shaded}

ç„¶åé€‰æ‹©å‡ åˆ—ä»¥ä¾¿æ›´å®¹æ˜“é˜…è¯»ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{characters }\OtherTok{\textless{}{-}}\NormalTok{ chars }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(json) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(id, name, gender, culture, born, died, alive)}
\NormalTok{characters}
\CommentTok{\#\textgreater{} \# A tibble: 30 x 7}
\CommentTok{\#\textgreater{}      id name              gender culture    born              died           }
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}chr\textgreater{}             \textless{}chr\textgreater{}  \textless{}chr\textgreater{}      \textless{}chr\textgreater{}             \textless{}chr\textgreater{}          }
\CommentTok{\#\textgreater{} 1  1022 Theon Greyjoy     Male   "Ironborn" "In 278 AC or 27\textasciitilde{} ""             }
\CommentTok{\#\textgreater{} 2  1052 Tyrion Lannister  Male   ""         "In 273 AC, at C\textasciitilde{} ""             }
\CommentTok{\#\textgreater{} 3  1074 Victarion Greyjoy Male   "Ironborn" "In 268 AC or be\textasciitilde{} ""             }
\CommentTok{\#\textgreater{} 4  1109 Will              Male   ""         ""                "In 297 AC, at\textasciitilde{}}
\CommentTok{\#\textgreater{} 5  1166 Areo Hotah        Male   "Norvoshi" "In 257 AC or be\textasciitilde{} ""             }
\CommentTok{\#\textgreater{} 6  1267 Chett             Male   ""         "At Hag\textquotesingle{}s Mire"   "In 299 AC, at\textasciitilde{}}
\CommentTok{\#\textgreater{} \# i 24 more rows}
\CommentTok{\#\textgreater{} \# i 1 more variable: alive \textless{}lgl\textgreater{}}
\end{Highlighting}
\end{Shaded}

è¯¥æ•°æ®é›†ä¹ŸåŒ…å«è®¸å¤šåˆ—è¡¨åˆ—:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{chars }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(json) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(id, }\FunctionTok{where}\NormalTok{(is.list))}
\CommentTok{\#\textgreater{} \# A tibble: 30 x 8}
\CommentTok{\#\textgreater{}      id titles    aliases    allegiances books     povBooks tvSeries playedBy}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}list\textgreater{}    \textless{}list\textgreater{}     \textless{}list\textgreater{}      \textless{}list\textgreater{}    \textless{}list\textgreater{}   \textless{}list\textgreater{}   \textless{}list\textgreater{}  }
\CommentTok{\#\textgreater{} 1  1022 \textless{}chr [2]\textgreater{} \textless{}chr [4]\textgreater{}  \textless{}chr [1]\textgreater{}   \textless{}chr [3]\textgreater{} \textless{}chr\textgreater{}    \textless{}chr\textgreater{}    \textless{}chr\textgreater{}   }
\CommentTok{\#\textgreater{} 2  1052 \textless{}chr [2]\textgreater{} \textless{}chr [11]\textgreater{} \textless{}chr [1]\textgreater{}   \textless{}chr [2]\textgreater{} \textless{}chr\textgreater{}    \textless{}chr\textgreater{}    \textless{}chr\textgreater{}   }
\CommentTok{\#\textgreater{} 3  1074 \textless{}chr [2]\textgreater{} \textless{}chr [1]\textgreater{}  \textless{}chr [1]\textgreater{}   \textless{}chr [3]\textgreater{} \textless{}chr\textgreater{}    \textless{}chr\textgreater{}    \textless{}chr\textgreater{}   }
\CommentTok{\#\textgreater{} 4  1109 \textless{}chr [1]\textgreater{} \textless{}chr [1]\textgreater{}  \textless{}NULL\textgreater{}      \textless{}chr [1]\textgreater{} \textless{}chr\textgreater{}    \textless{}chr\textgreater{}    \textless{}chr\textgreater{}   }
\CommentTok{\#\textgreater{} 5  1166 \textless{}chr [1]\textgreater{} \textless{}chr [1]\textgreater{}  \textless{}chr [1]\textgreater{}   \textless{}chr [3]\textgreater{} \textless{}chr\textgreater{}    \textless{}chr\textgreater{}    \textless{}chr\textgreater{}   }
\CommentTok{\#\textgreater{} 6  1267 \textless{}chr [1]\textgreater{} \textless{}chr [1]\textgreater{}  \textless{}NULL\textgreater{}      \textless{}chr [2]\textgreater{} \textless{}chr\textgreater{}    \textless{}chr\textgreater{}    \textless{}chr\textgreater{}   }
\CommentTok{\#\textgreater{} \# i 24 more rows}
\end{Highlighting}
\end{Shaded}

è®©æˆ‘ä»¬æ¢ç´¢\texttt{titles}åˆ—ã€‚å®ƒ
æ˜¯ä¸€ä¸ªæœªå‘½åçš„åˆ—è¡¨åˆ—ï¼Œå› æ­¤æˆ‘ä»¬å°†å®ƒå±•å¼€æˆè¡Œï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{chars }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(json) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(id, titles) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_longer}\NormalTok{(titles)}
\CommentTok{\#\textgreater{} \# A tibble: 59 x 2}
\CommentTok{\#\textgreater{}      id titles                                              }
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}chr\textgreater{}                                               }
\CommentTok{\#\textgreater{} 1  1022 Prince of Winterfell                                }
\CommentTok{\#\textgreater{} 2  1022 Lord of the Iron Islands (by law of the green lands)}
\CommentTok{\#\textgreater{} 3  1052 Acting Hand of the King (former)                    }
\CommentTok{\#\textgreater{} 4  1052 Master of Coin (former)                             }
\CommentTok{\#\textgreater{} 5  1074 Lord Captain of the Iron Fleet                      }
\CommentTok{\#\textgreater{} 6  1074 Master of the Iron Victory                          }
\CommentTok{\#\textgreater{} \# i 53 more rows}
\end{Highlighting}
\end{Shaded}

ä½ å¯èƒ½å¸Œæœ›çœ‹åˆ°è¿™ä¸ªæ•°æ®æ”¾åœ¨å®ƒè‡ªå·±çš„è¡¨ä¸­ï¼Œå› ä¸ºå½“éœ€è¦æ—¶å®ƒä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°ä¸è§’è‰²æ•°æ®è¿æ¥èµ·æ¥ã€‚æˆ‘
ä»¬æ¥åšè¿™ä¸ªæ“ä½œï¼Œè¿™éœ€è¦å¾ˆå°‘çš„æ¸…ç†å·¥ä½œï¼šç§»é™¤åŒ…å«ç©ºå­—ç¬¦ä¸²çš„è¡Œï¼Œå¹¶å°†\texttt{titles}é‡å‘½åä¸º\texttt{title}ï¼Œå› ä¸ºç°åœ¨æ¯è¡ŒåªåŒ…å«ä¸€ä¸ªæ ‡é¢˜ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{titles }\OtherTok{\textless{}{-}}\NormalTok{ chars }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(json) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(id, titles) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_longer}\NormalTok{(titles) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(titles }\SpecialCharTok{!=} \StringTok{""}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{rename}\NormalTok{(}\AttributeTok{title =}\NormalTok{ titles)}
\NormalTok{titles}
\CommentTok{\#\textgreater{} \# A tibble: 52 x 2}
\CommentTok{\#\textgreater{}      id title                                               }
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}chr\textgreater{}                                               }
\CommentTok{\#\textgreater{} 1  1022 Prince of Winterfell                                }
\CommentTok{\#\textgreater{} 2  1022 Lord of the Iron Islands (by law of the green lands)}
\CommentTok{\#\textgreater{} 3  1052 Acting Hand of the King (former)                    }
\CommentTok{\#\textgreater{} 4  1052 Master of Coin (former)                             }
\CommentTok{\#\textgreater{} 5  1074 Lord Captain of the Iron Fleet                      }
\CommentTok{\#\textgreater{} 6  1074 Master of the Iron Victory                          }
\CommentTok{\#\textgreater{} \# i 46 more rows}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥æƒ³è±¡ä¸ºæ¯ä¸€ä¸ªåˆ—è¡¨åˆ—åˆ›å»ºåƒè¿™æ ·çš„è¡¨ï¼Œç„¶åæ ¹æ®éœ€è¦ï¼Œä½¿ç”¨è¿æ¥æ“ä½œå°†å®ƒä»¬ä¸è§’è‰²æ•°æ®ç»“åˆèµ·æ¥ã€‚

\subsection{æ·±åº¦åµŒå¥—}\label{ux6df1ux5ea6ux5d4cux5957}

æˆ‘ä»¬å°†ä»¥ä¸€ä¸ªæ·±åº¦åµŒå¥—çš„åˆ—è¡¨åˆ—ä½œä¸ºè¿™äº›æ¡ˆä¾‹ç ”ç©¶çš„ç»“å°¾ï¼Œè¿™éœ€è¦åå¤ä½¿ç”¨\texttt{unnest\_wider()}å’Œ\texttt{unnest\_longer()}å‡½æ•°æ¥å±•å¼€ã€‚\texttt{g}
\texttt{maps\_cities}æ˜¯ä¸€ä¸ªåŒ…å«ä¸¤åˆ—çš„
tibbleï¼ŒåŒ…å«äº”ä¸ªåŸå¸‚åç§°ä»¥åŠä½¿ç”¨è°·æ­Œ\href{https://developers.google.com/maps/documentation/geocoding}{åœ°ç†ç¼–ç API}ç¡®å®šçš„åŸå¸‚ä½ç½®ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gmaps\_cities}
\CommentTok{\#\textgreater{} \# A tibble: 5 x 2}
\CommentTok{\#\textgreater{}   city       json            }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}      \textless{}list\textgreater{}          }
\CommentTok{\#\textgreater{} 1 Houston    \textless{}named list [2]\textgreater{}}
\CommentTok{\#\textgreater{} 2 Washington \textless{}named list [2]\textgreater{}}
\CommentTok{\#\textgreater{} 3 New York   \textless{}named list [2]\textgreater{}}
\CommentTok{\#\textgreater{} 4 Chicago    \textless{}named list [2]\textgreater{}}
\CommentTok{\#\textgreater{} 5 Arlington  \textless{}named list [2]\textgreater{}}
\end{Highlighting}
\end{Shaded}

\texttt{json}æ˜¯ä¸€ä¸ªå…·æœ‰å†…éƒ¨åç§°çš„åˆ—è¡¨åˆ—ï¼Œå› æ­¤æˆ‘ä»¬å…ˆä»\texttt{unnest\_wider()}å¼€å§‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gmaps\_cities }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(json)}
\CommentTok{\#\textgreater{} \# A tibble: 5 x 3}
\CommentTok{\#\textgreater{}   city       results    status}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}      \textless{}list\textgreater{}     \textless{}chr\textgreater{} }
\CommentTok{\#\textgreater{} 1 Houston    \textless{}list [1]\textgreater{} OK    }
\CommentTok{\#\textgreater{} 2 Washington \textless{}list [2]\textgreater{} OK    }
\CommentTok{\#\textgreater{} 3 New York   \textless{}list [1]\textgreater{} OK    }
\CommentTok{\#\textgreater{} 4 Chicago    \textless{}list [1]\textgreater{} OK    }
\CommentTok{\#\textgreater{} 5 Arlington  \textless{}list [2]\textgreater{} OK}
\end{Highlighting}
\end{Shaded}

è¿™ç»™æˆ‘ä»¬æä¾›äº† \texttt{status} å’Œ \texttt{results} ä¸¤ä¸ªå˜é‡ã€‚ç”±
äºå®ƒä»¬éƒ½æ˜¯\texttt{OK}çŠ¶æ€ï¼Œæ‰€ä»¥å¯ä»¥åˆ é™¤çŠ¶æ€åˆ—ï¼›åœ¨çœŸå®çš„åˆ†æä¸­ï¼Œä½ è¿˜å¸Œæœ›æ•è·æ‰€æœ‰\texttt{status\ !=\ "OK"}çš„è¡Œï¼Œå¹¶æ‰¾å‡ºå“ªé‡Œå‡ºäº†é—®é¢˜ã€‚\texttt{r}
\texttt{esults}æ˜¯ä¸€ä¸ªæœªå‘½åçš„åˆ—è¡¨ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–ä¸¤ä¸ªå…ƒç´ ï¼ˆæˆ‘ä»¬ç¨åä¼šçœ‹åˆ°åŸå› ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬å°†å®ƒå±•å¼€æˆè¡Œï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gmaps\_cities }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(json) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{status) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_longer}\NormalTok{(results)}
\CommentTok{\#\textgreater{} \# A tibble: 7 x 2}
\CommentTok{\#\textgreater{}   city       results         }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}      \textless{}list\textgreater{}          }
\CommentTok{\#\textgreater{} 1 Houston    \textless{}named list [5]\textgreater{}}
\CommentTok{\#\textgreater{} 2 Washington \textless{}named list [5]\textgreater{}}
\CommentTok{\#\textgreater{} 3 Washington \textless{}named list [5]\textgreater{}}
\CommentTok{\#\textgreater{} 4 New York   \textless{}named list [5]\textgreater{}}
\CommentTok{\#\textgreater{} 5 Chicago    \textless{}named list [5]\textgreater{}}
\CommentTok{\#\textgreater{} 6 Arlington  \textless{}named list [5]\textgreater{}}
\CommentTok{\#\textgreater{} \# i 1 more row}
\end{Highlighting}
\end{Shaded}

ç°åœ¨ \texttt{results} æ˜¯ä¸€ä¸ªå‘½åçš„åˆ—è¡¨, æ‰€ä»¥ä½¿ç”¨
\texttt{unnest\_wider()}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{locations }\OtherTok{\textless{}{-}}\NormalTok{ gmaps\_cities }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(json) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{status) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_longer}\NormalTok{(results) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(results)}
\NormalTok{locations}
\CommentTok{\#\textgreater{} \# A tibble: 7 x 6}
\CommentTok{\#\textgreater{}   city       address\_components formatted\_address   geometry        }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}      \textless{}list\textgreater{}             \textless{}chr\textgreater{}               \textless{}list\textgreater{}          }
\CommentTok{\#\textgreater{} 1 Houston    \textless{}list [4]\textgreater{}         Houston, TX, USA    \textless{}named list [4]\textgreater{}}
\CommentTok{\#\textgreater{} 2 Washington \textless{}list [2]\textgreater{}         Washington, USA     \textless{}named list [4]\textgreater{}}
\CommentTok{\#\textgreater{} 3 Washington \textless{}list [4]\textgreater{}         Washington, DC, USA \textless{}named list [4]\textgreater{}}
\CommentTok{\#\textgreater{} 4 New York   \textless{}list [3]\textgreater{}         New York, NY, USA   \textless{}named list [4]\textgreater{}}
\CommentTok{\#\textgreater{} 5 Chicago    \textless{}list [4]\textgreater{}         Chicago, IL, USA    \textless{}named list [4]\textgreater{}}
\CommentTok{\#\textgreater{} 6 Arlington  \textless{}list [4]\textgreater{}         Arlington, TX, USA  \textless{}named list [4]\textgreater{}}
\CommentTok{\#\textgreater{} \# i 1 more row}
\CommentTok{\#\textgreater{} \# i 2 more variables: place\_id \textless{}chr\textgreater{}, types \textless{}list\textgreater{}}
\end{Highlighting}
\end{Shaded}

ç°åœ¨æˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºä»€ä¹ˆä¸¤ä¸ªåŸå¸‚å¾—åˆ°äº†ä¸¤ä¸ªç»“æœï¼šåç››é¡¿å·ï¼ˆWashington
stateï¼‰å’Œåç››é¡¿ç‰¹åŒºï¼ˆWashington,
DCï¼‰éƒ½åŒ¹é…äº†åç››é¡¿ï¼Œè€Œé˜¿çµé¡¿ï¼ˆArlingtonï¼‰åˆ™åŒ¹é…äº†å¼—å‰å°¼äºšå·çš„é˜¿çµé¡¿ï¼ˆArlington,
Virginiaï¼‰å’Œå¾·å…‹è¨æ–¯å·çš„é˜¿çµé¡¿ï¼ˆArlington, Texasï¼‰ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥æœ‰å‡ ä¸ªä¸åŒçš„é€‰æ‹©ã€‚æˆ‘
ä»¬å¯èƒ½æƒ³è¦ç¡®å®šåŒ¹é…çš„ç¡®åˆ‡ä½ç½®ï¼Œè¿™äº›ä¿¡æ¯è¢«å­˜å‚¨åœ¨\texttt{geometry}åˆ—è¡¨åˆ—ä¸­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{locations }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(city, formatted\_address, geometry) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(geometry)}
\CommentTok{\#\textgreater{} \# A tibble: 7 x 6}
\CommentTok{\#\textgreater{}   city       formatted\_address   bounds           location     location\_type}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}      \textless{}chr\textgreater{}               \textless{}list\textgreater{}           \textless{}list\textgreater{}       \textless{}chr\textgreater{}        }
\CommentTok{\#\textgreater{} 1 Houston    Houston, TX, USA    \textless{}named list [2]\textgreater{} \textless{}named list\textgreater{} APPROXIMATE  }
\CommentTok{\#\textgreater{} 2 Washington Washington, USA     \textless{}named list [2]\textgreater{} \textless{}named list\textgreater{} APPROXIMATE  }
\CommentTok{\#\textgreater{} 3 Washington Washington, DC, USA \textless{}named list [2]\textgreater{} \textless{}named list\textgreater{} APPROXIMATE  }
\CommentTok{\#\textgreater{} 4 New York   New York, NY, USA   \textless{}named list [2]\textgreater{} \textless{}named list\textgreater{} APPROXIMATE  }
\CommentTok{\#\textgreater{} 5 Chicago    Chicago, IL, USA    \textless{}named list [2]\textgreater{} \textless{}named list\textgreater{} APPROXIMATE  }
\CommentTok{\#\textgreater{} 6 Arlington  Arlington, TX, USA  \textless{}named list [2]\textgreater{} \textless{}named list\textgreater{} APPROXIMATE  }
\CommentTok{\#\textgreater{} \# i 1 more row}
\CommentTok{\#\textgreater{} \# i 1 more variable: viewport \textless{}list\textgreater{}}
\end{Highlighting}
\end{Shaded}

è¿™ç»™æˆ‘ä»¬æä¾›äº†æ–°çš„\texttt{bounds}ï¼ˆä¸€ä¸ªçŸ©å½¢åŒºåŸŸï¼‰å’Œ\texttt{location}ï¼ˆä¸€ä¸ªç‚¹ï¼‰å˜é‡ã€‚æˆ‘
ä»¬å¯ä»¥å±•å¼€ä½ç½®åˆ—æ¥æŸ¥çœ‹çº¬åº¦ï¼ˆ\texttt{lat}ï¼‰å’Œç»åº¦ï¼ˆ\texttt{lng}ï¼‰ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{locations }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(city, formatted\_address, geometry) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(geometry) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(location)}
\CommentTok{\#\textgreater{} \# A tibble: 7 x 7}
\CommentTok{\#\textgreater{}   city       formatted\_address   bounds             lat    lng location\_type}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}      \textless{}chr\textgreater{}               \textless{}list\textgreater{}           \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{} \textless{}chr\textgreater{}        }
\CommentTok{\#\textgreater{} 1 Houston    Houston, TX, USA    \textless{}named list [2]\textgreater{}  29.8  {-}95.4 APPROXIMATE  }
\CommentTok{\#\textgreater{} 2 Washington Washington, USA     \textless{}named list [2]\textgreater{}  47.8 {-}121.  APPROXIMATE  }
\CommentTok{\#\textgreater{} 3 Washington Washington, DC, USA \textless{}named list [2]\textgreater{}  38.9  {-}77.0 APPROXIMATE  }
\CommentTok{\#\textgreater{} 4 New York   New York, NY, USA   \textless{}named list [2]\textgreater{}  40.7  {-}74.0 APPROXIMATE  }
\CommentTok{\#\textgreater{} 5 Chicago    Chicago, IL, USA    \textless{}named list [2]\textgreater{}  41.9  {-}87.6 APPROXIMATE  }
\CommentTok{\#\textgreater{} 6 Arlington  Arlington, TX, USA  \textless{}named list [2]\textgreater{}  32.7  {-}97.1 APPROXIMATE  }
\CommentTok{\#\textgreater{} \# i 1 more row}
\CommentTok{\#\textgreater{} \# i 1 more variable: viewport \textless{}list\textgreater{}}
\end{Highlighting}
\end{Shaded}

æå–è¾¹ç•Œéœ€è¦æ›´å¤šçš„æ­¥éª¤:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{locations }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(city, formatted\_address, geometry) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(geometry) }\SpecialCharTok{|\textgreater{}} 
  \CommentTok{\# focus on the variables of interest}
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{!}\NormalTok{location}\SpecialCharTok{:}\NormalTok{viewport) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{unnest\_wider}\NormalTok{(bounds)}
\CommentTok{\#\textgreater{} \# A tibble: 7 x 4}
\CommentTok{\#\textgreater{}   city       formatted\_address   northeast        southwest       }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}      \textless{}chr\textgreater{}               \textless{}list\textgreater{}           \textless{}list\textgreater{}          }
\CommentTok{\#\textgreater{} 1 Houston    Houston, TX, USA    \textless{}named list [2]\textgreater{} \textless{}named list [2]\textgreater{}}
\CommentTok{\#\textgreater{} 2 Washington Washington, USA     \textless{}named list [2]\textgreater{} \textless{}named list [2]\textgreater{}}
\CommentTok{\#\textgreater{} 3 Washington Washington, DC, USA \textless{}named list [2]\textgreater{} \textless{}named list [2]\textgreater{}}
\CommentTok{\#\textgreater{} 4 New York   New York, NY, USA   \textless{}named list [2]\textgreater{} \textless{}named list [2]\textgreater{}}
\CommentTok{\#\textgreater{} 5 Chicago    Chicago, IL, USA    \textless{}named list [2]\textgreater{} \textless{}named list [2]\textgreater{}}
\CommentTok{\#\textgreater{} 6 Arlington  Arlington, TX, USA  \textless{}named list [2]\textgreater{} \textless{}named list [2]\textgreater{}}
\CommentTok{\#\textgreater{} \# i 1 more row}
\end{Highlighting}
\end{Shaded}

ç„¶åï¼Œæˆ‘ä»¬é‡å‘½å \texttt{southwest}å’Œ
\texttt{northeast}ï¼ˆçŸ©å½¢çš„ä¸¤ä¸ªè§’ï¼‰ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨\texttt{names\_sep}æ¥åˆ›å»ºç®€çŸ­ä½†æœ‰æ„ä¹‰çš„åç§°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{locations }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(city, formatted\_address, geometry) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(geometry) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{!}\NormalTok{location}\SpecialCharTok{:}\NormalTok{viewport) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{unnest\_wider}\NormalTok{(bounds) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{rename}\NormalTok{(}\AttributeTok{ne =}\NormalTok{ northeast, }\AttributeTok{sw =}\NormalTok{ southwest) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(}\FunctionTok{c}\NormalTok{(ne, sw), }\AttributeTok{names\_sep =} \StringTok{"\_"}\NormalTok{) }
\CommentTok{\#\textgreater{} \# A tibble: 7 x 6}
\CommentTok{\#\textgreater{}   city       formatted\_address   ne\_lat ne\_lng sw\_lat sw\_lng}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}      \textless{}chr\textgreater{}                \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 Houston    Houston, TX, USA      30.1  {-}95.0   29.5  {-}95.8}
\CommentTok{\#\textgreater{} 2 Washington Washington, USA       49.0 {-}117.    45.5 {-}125. }
\CommentTok{\#\textgreater{} 3 Washington Washington, DC, USA   39.0  {-}76.9   38.8  {-}77.1}
\CommentTok{\#\textgreater{} 4 New York   New York, NY, USA     40.9  {-}73.7   40.5  {-}74.3}
\CommentTok{\#\textgreater{} 5 Chicago    Chicago, IL, USA      42.0  {-}87.5   41.6  {-}87.9}
\CommentTok{\#\textgreater{} 6 Arlington  Arlington, TX, USA    32.8  {-}97.0   32.6  {-}97.2}
\CommentTok{\#\textgreater{} \# i 1 more row}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„æˆ‘ä»¬æ˜¯å¦‚ä½•é€šè¿‡å‘\texttt{unnest\_wider()}æä¾›å˜é‡åå‘é‡æ¥åŒæ—¶å±•å¼€ä¸¤åˆ—çš„ã€‚

ä¸€æ—¦æ‰¾åˆ°äº†åˆ°è¾¾ä½ æ„Ÿå…´è¶£å…ƒç´ çš„è·¯å¾„ï¼Œä½ å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ªtidyrå‡½æ•°
\texttt{hoist()} æ¥ç›´æ¥æå–å®ƒä»¬ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{locations }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(city, formatted\_address, geometry) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{hoist}\NormalTok{(}
\NormalTok{    geometry,}
    \AttributeTok{ne\_lat =} \FunctionTok{c}\NormalTok{(}\StringTok{"bounds"}\NormalTok{, }\StringTok{"northeast"}\NormalTok{, }\StringTok{"lat"}\NormalTok{),}
    \AttributeTok{sw\_lat =} \FunctionTok{c}\NormalTok{(}\StringTok{"bounds"}\NormalTok{, }\StringTok{"southwest"}\NormalTok{, }\StringTok{"lat"}\NormalTok{),}
    \AttributeTok{ne\_lng =} \FunctionTok{c}\NormalTok{(}\StringTok{"bounds"}\NormalTok{, }\StringTok{"northeast"}\NormalTok{, }\StringTok{"lng"}\NormalTok{),}
    \AttributeTok{sw\_lng =} \FunctionTok{c}\NormalTok{(}\StringTok{"bounds"}\NormalTok{, }\StringTok{"southwest"}\NormalTok{, }\StringTok{"lng"}\NormalTok{),}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

å¦‚æœè¿™äº›æ¡ˆä¾‹ç ”ç©¶å·²ç»æ¿€èµ·äº†ä½ å¯¹æ›´å¤šçœŸå®ç”Ÿæ´»ä¸­æ•°æ®è§„æ•´åŒ–æ“ä½œçš„å…´è¶£ï¼Œä½ å¯ä»¥åœ¨\texttt{vignette("rectangling",\ package\ =\ "tidyr")}
ä¸­çœ‹åˆ°æ›´å¤šç¤ºä¾‹ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-57}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ç²—ç•¥ä¼°è®¡\texttt{gh\_repos}çš„åˆ›å»ºæ—¶é—´ã€‚ä¸º ä»€ä¹ˆä½ åªèƒ½ç²—ç•¥ä¼°è®¡æ—¥æœŸï¼Ÿ
\item
  \texttt{gh\_repo}çš„\texttt{owner}åˆ—åŒ…å«äº†å¾ˆå¤šé‡å¤çš„ä¿¡æ¯ï¼Œå› ä¸ºæ¯ä¸ªæ‹¥æœ‰è€…å¯ä»¥æœ‰å¤šä¸ªä»“åº“ã€‚ä½ 
  èƒ½æ„é€ ä¸€ä¸ª\texttt{owners}æ•°æ®æ¡†ï¼Œè®©å…¶ä¸­æ¯ä¸ªæ‹¥æœ‰è€…åªæœ‰ä¸€è¡Œå—ï¼Ÿ( æç¤º:
  \texttt{distinct()}å‡½æ•°èƒ½å¤„ç†åˆ—è¡¨åˆ—å—ï¼Ÿ)
\item
  æŒ‰ç…§ \texttt{titles}
  çš„æ­¥éª¤ä¸ºã€ŠæƒåŠ›çš„æ¸¸æˆã€‹è§’è‰²çš„aliasesã€allegiancesã€bookså’ŒTV
  seriesåˆ›å»ºç±»ä¼¼çš„è¡¨æ ¼ã€‚
\item
  é€è¡Œè§£é‡Šä»¥ä¸‹ä»£ç ã€‚ä¸º ä»€ä¹ˆå®ƒå¾ˆæœ‰è¶£ï¼Ÿä¸º
  ä»€ä¹ˆå®ƒå¯¹\texttt{got\_chars}æœ‰æ•ˆä½†å¯èƒ½ä¸é€‚ç”¨äºä¸€èˆ¬æƒ…å†µï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{tibble}\NormalTok{(}\AttributeTok{json =}\NormalTok{ got\_chars) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(json) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(id, }\FunctionTok{where}\NormalTok{(is.list)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_longer}\NormalTok{(}
    \FunctionTok{where}\NormalTok{(is.list), }
    \AttributeTok{names\_to =} \StringTok{"name"}\NormalTok{, }
    \AttributeTok{values\_to =} \StringTok{"value"}
\NormalTok{  ) }\SpecialCharTok{|\textgreater{}}  
  \FunctionTok{unnest\_longer}\NormalTok{(value)}
\end{Highlighting}
\end{Shaded}
\item
  åœ¨\texttt{gmaps\_cities}ä¸­ï¼Œ\texttt{address\_components}åŒ…å«çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Ÿä¸º
  ä»€ä¹ˆé•¿åº¦è¡Œä¸è¡Œä¹‹é—´çš„é•¿åº¦ä¸åŒï¼Ÿè¯· é€‚å½“åœ°å°†å…¶å±•å¼€ä»¥æ‰¾å‡ºç­”æ¡ˆã€‚ï¼ˆ
  æç¤º:\texttt{types}å­—æ®µä¼¼ä¹æ€»æ˜¯åŒ…å«ä¸¤ä¸ªå…ƒç´ ã€‚\texttt{unnest\_wider()}æ˜¯å¦æ¯”\texttt{unnest\_longer()}æ›´å®¹æ˜“å¤„ç†ï¼Ÿï¼‰
\end{enumerate}

\section{JSON}\label{json}

å‰é¢å„éƒ¨åˆ†çš„æ‰€æœ‰æ¡ˆä¾‹ç ”ç©¶éƒ½æ¥åŸå§‹çš„JSONæ•°æ®ã€‚J
SONæ˜¯\textbf{j}ava\textbf{s}cript \textbf{o}bject
\textbf{n}otationçš„ç¼©å†™ï¼Œæ˜¯å¤§å¤šæ•°Web APIè¿”å›æ•°æ®çš„æ–¹å¼ã€‚ç†
è§£å®ƒå¾ˆé‡è¦ï¼Œå› ä¸ºè™½ç„¶JSONå’ŒRçš„æ•°æ®ç±»å‹éå¸¸ç›¸ä¼¼ï¼Œä½†å®ƒä»¬ä¹‹é—´å¹¶æ²¡æœ‰å®Œç¾çš„1å¯¹1æ˜ å°„å…³ç³»ï¼Œæ‰€ä»¥å¦‚æœå‡ºç°é—®é¢˜ï¼Œäº†è§£ä¸€ç‚¹JSONæ˜¯æœ‰å¸®åŠ©çš„ã€‚

\subsection{æ•°æ®ç±»å‹}\label{ux6570ux636eux7c7bux578b-1}

JSON
æ˜¯ä¸€ç§ç®€å•çš„æ ¼å¼ï¼Œè®¾è®¡çš„ç›®çš„æ˜¯è®©æœºå™¨ï¼ˆè€Œéäººç±»ï¼‰èƒ½å¤Ÿè½»æ¾åœ°è¯»å–å’Œå†™å…¥ã€‚å®ƒ
æœ‰å…­ç§ä¸»è¦çš„æ•°æ®ç±»å‹ï¼Œå…¶ä¸­å››ç§æ˜¯æ ‡é‡ï¼š

\begin{itemize}
\tightlist
\item
  æœ€ç®€å•çš„ç±»å‹æ˜¯ \texttt{null}ï¼Œå®ƒä¸ R ä¸­çš„ \texttt{NA}
  è§’è‰²ç›¸åŒï¼Œè¡¨ç¤ºæ•°æ®çš„ç¼ºå¤±ã€‚
\item
  string ä¸ R ä¸­çš„å­—ç¬¦ä¸²éå¸¸ç›¸ä¼¼ï¼Œä½†å¿…é¡»å§‹ç»ˆä½¿ç”¨åŒå¼•å·ã€‚
\item
  number ä¸ R
  ä¸­çš„æ•°å­—ç±»ä¼¼ï¼šå®ƒä»¬å¯ä»¥ä½¿ç”¨æ•´æ•°ï¼ˆä¾‹å¦‚ï¼Œ123ï¼‰ã€å°æ•°ï¼ˆä¾‹å¦‚ï¼Œ123.45ï¼‰æˆ–ç§‘å­¦è®°æ•°æ³•ï¼ˆä¾‹å¦‚ï¼Œ1.23e3ï¼‰è¡¨ç¤ºã€‚JSON
  ä¸æ”¯æŒ \texttt{Inf}ã€\texttt{-Inf} æˆ– \texttt{NaN}ã€‚
\item
  boolean ä¸ R ä¸­çš„ \texttt{TRUE} å’Œ \texttt{FALSE} ç±»ä¼¼ï¼Œä½†ä½¿ç”¨å°å†™
  \texttt{true} å’Œ \texttt{false}ã€‚
\end{itemize}

JSON çš„å­—ç¬¦ä¸² (strings)ã€æ•°å­— (numbers) å’Œå¸ƒå°”å€¼ (booleans) ç›¸å½“æ¥è¿‘äº R
ä¸­çš„å­—ç¬¦ã€æ•°å€¼å’Œé€»è¾‘å‘é‡ã€‚ä¸» è¦åŒºåˆ«åœ¨äº JSON
çš„æ ‡é‡åªèƒ½è¡¨ç¤ºå•ä¸ªå€¼ï¼Œè¦è¡¨ç¤ºå¤šä¸ªå€¼ï¼Œä½ éœ€è¦ä½¿ç”¨å‰©ä¸‹çš„ä¸¤ç§ç±»å‹ä¹‹ä¸€ï¼šæ•°ç»„
(arrays) å’Œå¯¹è±¡ (objects)ã€‚

æ•°ç»„å’Œå¯¹è±¡éƒ½ä¸ R ä¸­çš„åˆ—è¡¨ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºå®ƒä»¬æ˜¯å¦æœ‰åå­—ã€‚æ•°
ç»„ç±»ä¼¼äºæœªå‘½åçš„åˆ—è¡¨ï¼Œä½¿ç”¨ \texttt{{[}{]}} è¡¨ç¤ºã€‚ä¾‹
å¦‚ï¼Œ\texttt{{[}1,\ 2,\ 3{]}}
æ˜¯ä¸€ä¸ªåŒ…å«ä¸‰ä¸ªæ•°å­—çš„æ•°ç»„ï¼Œ\texttt{{[}null,\ 1,\ "string",\ false{]}}
æ˜¯ä¸€ä¸ªåŒ…å«ç©ºå€¼ã€ä¸€ä¸ªæ•°å­—ã€ä¸€ä¸ªå­—ç¬¦ä¸²å’Œä¸€ä¸ªå¸ƒå°”å€¼çš„æ•°ç»„ã€‚å¯¹
è±¡ç±»ä¼¼äºå‘½åçš„åˆ—è¡¨ï¼Œä½¿ç”¨ \texttt{\{\}} è¡¨ç¤ºã€‚å ç§°ï¼ˆåœ¨ JSON
æœ¯è¯­ä¸­ç§°ä¸ºé”®ï¼‰æ˜¯å­—ç¬¦ä¸²ï¼Œå› æ­¤å¿…é¡»ç”¨å¼•å·æ‹¬èµ·æ¥ã€‚ä¾‹
å¦‚ï¼Œ\texttt{\{"x":\ 1,\ "y":\ 2\}} æ˜¯ä¸€ä¸ªå°† \texttt{x} æ˜ å°„åˆ°
1ã€\texttt{y} æ˜ å°„åˆ° 2 çš„å¯¹è±¡ã€‚

è¯·æ³¨æ„ï¼ŒJSON
æ²¡æœ‰ä»»ä½•åŸç”Ÿæ–¹å¼æ¥è¡¨ç¤ºæ—¥æœŸæˆ–æ—¥æœŸ-æ—¶é—´ï¼Œå› æ­¤å®ƒä»¬é€šå¸¸ä½œä¸ºå­—ç¬¦ä¸²å­˜å‚¨ï¼Œä½ éœ€è¦ä½¿ç”¨
\texttt{readr::parse\_date()} æˆ– \texttt{readr::parse\_datetime()}
å°†å®ƒä»¬è½¬æ¢ä¸ºæ­£ç¡®çš„æ•°æ®ç»“æ„ã€‚ç±» ä¼¼åœ°ï¼ŒJSON
ä¸­è¡¨ç¤ºæµ®ç‚¹æ•°çš„è§„åˆ™æœ‰äº›ä¸ç²¾ç¡®ï¼Œå› æ­¤æœ‰æ—¶ä½ ä¹Ÿä¼šå‘ç°æ•°å­—ä»¥å­—ç¬¦ä¸²å½¢å¼å­˜å‚¨ã€‚åœ¨
éœ€è¦æ—¶ï¼Œåº”ç”¨ \texttt{readr::parse\_double()} æ¥è·å–æ­£ç¡®çš„å˜é‡ç±»å‹ã€‚

\subsection{jsonlite}\label{jsonlite}

è¦å°† JSON è½¬æ¢ä¸º R æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨ Jeroen Ooms çš„
\texttt{jsonlite} åŒ…ã€‚æˆ‘ ä»¬å°†ä½¿ç”¨ jsonlite çš„ä¸¤ä¸ªå‡½æ•°
\texttt{read\_json()}å’Œ\texttt{parse\_json()}ã€‚åœ¨
å®é™…åº”ç”¨ä¸­ï¼Œä½ ä¼šä½¿ç”¨\texttt{read\_json()}ä»ç£ç›˜è¯»å– JSON æ–‡ä»¶ã€‚ä¾‹
å¦‚ï¼Œ\texttt{repurrsive}åŒ…ä¹Ÿæä¾›äº†\texttt{gh\_user}çš„æ•°æ®æºä½œä¸º JSON
æ–‡ä»¶ï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{read\_json()}æ¥è¯»å–å®ƒï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# A path to a json file inside the package:}
\FunctionTok{gh\_users\_json}\NormalTok{()}
\CommentTok{\#\textgreater{} [1] "/Library/Frameworks/R.framework/Versions/4.3{-}arm64/Resources/library/repurrrsive/extdata/gh\_users.json"}

\CommentTok{\# Read it with read\_json()}
\NormalTok{gh\_users2 }\OtherTok{\textless{}{-}} \FunctionTok{read\_json}\NormalTok{(}\FunctionTok{gh\_users\_json}\NormalTok{())}

\CommentTok{\# Check it\textquotesingle{}s the same as the data we were using previously}
\FunctionTok{identical}\NormalTok{(gh\_users, gh\_users2)}
\CommentTok{\#\textgreater{} [1] TRUE}
\end{Highlighting}
\end{Shaded}

åœ¨æœ¬ä¹¦ä¸­, æˆ‘ä»¬è¿˜å°†ä½¿ç”¨\texttt{parse\_json()}ï¼Œå› ä¸ºå®ƒæ¥å—ä¸€ä¸ªåŒ…å« JSON
çš„å­—ç¬¦ä¸²ï¼Œè¿™ä½¿å¾—å®ƒéå¸¸é€‚åˆç”Ÿæˆç®€å•çš„ç¤ºä¾‹ã€‚ä¸º äº†å¼€å§‹ï¼Œè¿™é‡Œæœ‰ä¸‰ä¸ªç®€å•çš„
JSON
æ•°æ®é›†ï¼Œé¦–å…ˆä»¥ä¸€ä¸ªæ•°å­—å¼€å§‹ï¼Œç„¶åå°†å‡ ä¸ªæ•°å­—æ”¾å…¥ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œæœ€åå°†è¯¥æ•°ç»„æ”¾å…¥ä¸€ä¸ªå¯¹è±¡ä¸­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(}\FunctionTok{parse\_json}\NormalTok{(}\StringTok{\textquotesingle{}1\textquotesingle{}}\NormalTok{))}
\CommentTok{\#\textgreater{}  int 1}
\FunctionTok{str}\NormalTok{(}\FunctionTok{parse\_json}\NormalTok{(}\StringTok{\textquotesingle{}[1, 2, 3]\textquotesingle{}}\NormalTok{))}
\CommentTok{\#\textgreater{} List of 3}
\CommentTok{\#\textgreater{}  $ : int 1}
\CommentTok{\#\textgreater{}  $ : int 2}
\CommentTok{\#\textgreater{}  $ : int 3}
\FunctionTok{str}\NormalTok{(}\FunctionTok{parse\_json}\NormalTok{(}\StringTok{\textquotesingle{}\{"x": [1, 2, 3]\}\textquotesingle{}}\NormalTok{))}
\CommentTok{\#\textgreater{} List of 1}
\CommentTok{\#\textgreater{}  $ x:List of 3}
\CommentTok{\#\textgreater{}   ..$ : int 1}
\CommentTok{\#\textgreater{}   ..$ : int 2}
\CommentTok{\#\textgreater{}   ..$ : int 3}
\end{Highlighting}
\end{Shaded}

\texttt{jsonlite}è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„å‡½æ•°å«åš\texttt{fromJSON()}ã€‚æˆ‘
ä»¬åœ¨è¿™é‡Œä¸ä½¿ç”¨å®ƒï¼Œå› ä¸ºå®ƒæ‰§è¡Œè‡ªåŠ¨ç®€åŒ–ï¼ˆ\texttt{simplifyVector\ =\ TRUE}ï¼‰ã€‚è¿™
åœ¨å¾ˆå¤šæƒ…å†µä¸‹éƒ½èƒ½å¾ˆå¥½åœ°å·¥ä½œï¼Œç‰¹åˆ«æ˜¯ç®€å•çš„æƒ…å†µï¼Œä½†æˆ‘ä»¬è®¤ä¸ºä½ è‡ªå·±è¿›è¡Œè§„æ•´åŒ–ï¼ˆå³å°†
JSON æ•°æ®è½¬æ¢æˆé€‚åˆ R
ä½¿ç”¨çš„æ ¼å¼ï¼‰ä¼šæ›´å¥½ï¼Œè¿™æ ·ä½ å°±èƒ½ç¡®åˆ‡åœ°çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆï¼Œå¹¶ä¸”èƒ½æ›´å®¹æ˜“åœ°å¤„ç†æœ€å¤æ‚çš„åµŒå¥—ç»“æ„ã€‚

\subsection{å¼€å§‹è§„æ•´åŒ–è¿‡ç¨‹}\label{ux5f00ux59cbux89c4ux6574ux5316ux8fc7ux7a0b}

åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒJSON
æ–‡ä»¶åŒ…å«ä¸€ä¸ªé¡¶å±‚æ•°ç»„ï¼Œå› ä¸ºå®ƒä»¬è¢«è®¾è®¡ä¸ºæä¾›å…³äºå¤šä¸ª``äº‹ç‰©''çš„æ•°æ®ï¼Œä¾‹å¦‚å¤šä¸ªé¡µé¢ã€å¤šæ¡è®°å½•æˆ–å¤šä¸ªç»“æœã€‚åœ¨
è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å°†ä½¿ç”¨\texttt{tibble(json)}å¼€å§‹ä½ çš„è§„æ•´åŒ–æ“ä½œï¼Œè¿™æ ·æ¯ä¸ªå…ƒç´ éƒ½ä¼šæˆä¸ºä¸€è¡Œï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{json }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}[}
\StringTok{  \{"name": "John", "age": 34\},}
\StringTok{  \{"name": "Susan", "age": 27\}}
\StringTok{]\textquotesingle{}}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{json =} \FunctionTok{parse\_json}\NormalTok{(json))}
\NormalTok{df}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 1}
\CommentTok{\#\textgreater{}   json            }
\CommentTok{\#\textgreater{}   \textless{}list\textgreater{}          }
\CommentTok{\#\textgreater{} 1 \textless{}named list [2]\textgreater{}}
\CommentTok{\#\textgreater{} 2 \textless{}named list [2]\textgreater{}}

\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(json)}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 2}
\CommentTok{\#\textgreater{}   name    age}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 John     34}
\CommentTok{\#\textgreater{} 2 Susan    27}
\end{Highlighting}
\end{Shaded}

åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼ŒJSON æ–‡ä»¶ç”±ä¸€ä¸ªå•ä¸€çš„é¡¶å±‚ JSON
å¯¹è±¡ç»„æˆï¼Œä»£è¡¨ä¸€ä¸ª``äº‹ç‰©''ã€‚åœ¨
è¿™ç§æƒ…å†µä¸‹ï¼Œä½ éœ€è¦åœ¨å°†å…¶æ”¾å…¥\texttt{tibble}ä¹‹å‰å…ˆå°†å…¶å°è£…åœ¨ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œä»¥å¯åŠ¨è§„æ•´åŒ–è¿‡ç¨‹ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{json }\OtherTok{\textless{}{-}} \StringTok{\textquotesingle{}\{}
\StringTok{  "status": "OK", }
\StringTok{  "results": [}
\StringTok{    \{"name": "John", "age": 34\},}
\StringTok{    \{"name": "Susan", "age": 27\}}
\StringTok{ ]}
\StringTok{\}}
\StringTok{\textquotesingle{}}
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{json =} \FunctionTok{list}\NormalTok{(}\FunctionTok{parse\_json}\NormalTok{(json)))}
\NormalTok{df}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 1}
\CommentTok{\#\textgreater{}   json            }
\CommentTok{\#\textgreater{}   \textless{}list\textgreater{}          }
\CommentTok{\#\textgreater{} 1 \textless{}named list [2]\textgreater{}}

\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(json) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_longer}\NormalTok{(results) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(results)}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 3}
\CommentTok{\#\textgreater{}   status name    age}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}  \textless{}chr\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 OK     John     34}
\CommentTok{\#\textgreater{} 2 OK     Susan    27}
\end{Highlighting}
\end{Shaded}

æˆ–è€…ï¼Œä½ å¯ä»¥æ·±å…¥åˆ°è§£æåçš„ JSON ä¸­ï¼Œä»ä½ çœŸæ­£å…³å¿ƒçš„éƒ¨åˆ†å¼€å§‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{results =} \FunctionTok{parse\_json}\NormalTok{(json)}\SpecialCharTok{$}\NormalTok{results)}
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{unnest\_wider}\NormalTok{(results)}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 2}
\CommentTok{\#\textgreater{}   name    age}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 John     34}
\CommentTok{\#\textgreater{} 2 Susan    27}
\end{Highlighting}
\end{Shaded}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-58}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  å°†ä¸‹é¢çš„\texttt{df\_col}å’Œ\texttt{df\_row}è¿›è¡Œè§„æ•´ã€‚å®ƒ
  ä»¬ä»£è¡¨äº†å°†æ•°æ®æ¡†ç¼–ç ä¸º JSON çš„ä¸¤ç§æ–¹å¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{json\_col }\OtherTok{\textless{}{-}} \FunctionTok{parse\_json}\NormalTok{(}\StringTok{\textquotesingle{}}
\StringTok{  \{}
\StringTok{    "x": ["a", "x", "z"],}
\StringTok{    "y": [10, null, 3]}
\StringTok{  \}}
\StringTok{\textquotesingle{}}\NormalTok{)}
\NormalTok{json\_row }\OtherTok{\textless{}{-}} \FunctionTok{parse\_json}\NormalTok{(}\StringTok{\textquotesingle{}}
\StringTok{  [}
\StringTok{    \{"x": "a", "y": 10\},}
\StringTok{    \{"x": "x", "y": null\},}
\StringTok{    \{"x": "z", "y": 3\}}
\StringTok{  ]}
\StringTok{\textquotesingle{}}\NormalTok{)}

\NormalTok{df\_col }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{json =} \FunctionTok{list}\NormalTok{(json\_col)) }
\NormalTok{df\_row }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{json =}\NormalTok{ json\_row)}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{å°ç»“}\label{ux5c0fux7ed3-22}

åœ¨æœ¬ç« ä¸­ï¼Œä½ å­¦ä¹ äº†åˆ—è¡¨æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•ä» JSON
æ–‡ä»¶ä¸­ç”Ÿæˆå®ƒä»¬ï¼Œä»¥åŠå¦‚ä½•å°†å®ƒä»¬è½¬æ¢ä¸ºçŸ©å½¢æ•°æ®æ¡†ã€‚ä»¤
äººæƒŠè®¶çš„æ˜¯ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸¤ä¸ªæ–°å‡½æ•°ï¼š\texttt{unnest\_longer()}å°†åˆ—è¡¨å…ƒç´ æ”¾å…¥è¡Œä¸­ï¼Œ\texttt{unnest\_wider()}å°†åˆ—è¡¨å…ƒç´ æ”¾å…¥åˆ—ä¸­ã€‚ä¸
è®ºåˆ—è¡¨åˆ—åµŒå¥—æœ‰å¤šæ·±ï¼Œä½ åªéœ€è¦åå¤è°ƒç”¨è¿™ä¸¤ä¸ªå‡½æ•°ã€‚

JSON æ˜¯ Web API è¿”å›çš„æœ€å¸¸è§çš„æ•°æ®æ ¼å¼ã€‚å¦‚ æœç½‘ç«™æ²¡æœ‰
APIï¼Œä½†ä½ å¯ä»¥åœ¨ç½‘ç«™ä¸Šçœ‹åˆ°ä½ æƒ³è¦çš„æ•°æ®ï¼Œé‚£è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿè¿™
å°±æ˜¯ä¸‹ä¸€ç« çš„ä¸»é¢˜ï¼šç½‘é¡µæŠ“å–ï¼Œä» HTML ç½‘é¡µä¸­æå–æ•°æ®ã€‚

\chapter{ç½‘é¡µæŠ“å–}\label{sec-scraping}

\section{å¼•è¨€}\label{ux5f15ux8a00-19}

æœ¬ç« å°†å‘æ‚¨ä»‹ç»ä½¿ç”¨ \href{https://rvest.tidyverse.org}{rvest}
è¿›è¡Œç½‘é¡µæŠ“å– (web scraping) çš„åŸºç¡€çŸ¥è¯†ã€‚ç½‘
é¡µæŠ“å–æ˜¯ä¸€ç§éå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œç”¨äºä»ç½‘é¡µä¸­æå–æ•°æ®ã€‚ä¸€ äº›ç½‘ç«™ä¼šæä¾›
APIï¼Œè¿™æ˜¯ä¸€ç»„ç»“æ„åŒ–çš„ HTTP è¯·æ±‚ï¼Œå…¶è¿”å›JSON æ ¼å¼çš„æ•°æ®ï¼Œä½ å¯ä»¥ä½¿ç”¨
ç« èŠ‚~\ref{sec-rectangling} ä¸­ä»‹ç»çš„è§„æ•´åŒ–æ–¹æ³•æ¥å¤„ç†è¿™äº›æ•°æ®ã€‚åœ¨
å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥ä½¿ç”¨ API\footnote{è®¸å¤šæµè¡Œçš„APIå·²ç»æœ‰CRANåŒ…æ¥å°è£…å®ƒä»¬ï¼Œæ‰€ä»¥è¯·å…ˆè¿›è¡Œä¸€äº›ç ”ç©¶ï¼}ï¼Œå› ä¸ºå®ƒé€šå¸¸ä¼šæä¾›æ›´å¯é çš„æ•°æ®ã€‚
ç„¶è€Œï¼Œä¸å¹¸çš„æ˜¯ï¼Œä½¿ç”¨ Web API ç¼–ç¨‹è¶…å‡ºäº†æœ¬ä¹¦çš„èŒƒå›´ã€‚
ç›¸åï¼Œæˆ‘ä»¬å°†æ•™æˆç½‘é¡µæŠ“å–æŠ€æœ¯ï¼Œè¿™æ˜¯ä¸€ç§æ— è®ºç½‘ç«™æ˜¯å¦æä¾› API
éƒ½é€‚ç”¨çš„æŠ€æœ¯ã€‚

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä¼šè®¨è®ºç½‘é¡µæŠ“å–çš„ä¼¦ç†é“å¾·å’Œåˆæ³•æ€§ï¼Œç„¶åå†æ·±å…¥æ¢è®¨ HTML
çš„åŸºç¡€çŸ¥è¯†ã€‚æ¥ ä¸‹æ¥ï¼Œå­¦ä¹  CSS
é€‰æ‹©å™¨çš„åŸºç¡€çŸ¥è¯†ï¼Œä»¥å®šä½é¡µé¢ä¸Šçš„ç‰¹å®šå…ƒç´ ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨\texttt{rvest}å‡½æ•°ä»
HTML çš„æ–‡æœ¬å’Œå±æ€§ä¸­æå–æ•°æ®å¹¶å°†å…¶å¯¼å…¥ R ã€‚ä¹‹
åï¼Œæˆ‘ä»¬å°†è®¨è®ºä¸€äº›æŠ€å·§ï¼Œä»¥ç¡®å®šä½ éœ€è¦é’ˆå¯¹è¦æŠ“å–çš„é¡µé¢ä½¿ç”¨å“ªä¸ª CSS
é€‰æ‹©å™¨ã€‚æœ€
åï¼Œæˆ‘ä»¬å°†é€šè¿‡å‡ ä¸ªæ¡ˆä¾‹ç ”ç©¶å’Œä¸€ä¸ªå…³äºåŠ¨æ€ç½‘ç«™çš„ç®€çŸ­è®¨è®ºæ¥ç»“æŸæœ¬ç« ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-20}

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨\texttt{rvest}æä¾›çš„å·¥å…·ã€‚\texttt{r}
\texttt{vest}æ˜¯\texttt{tidyverse}çš„ä¸€ä¸ªæˆå‘˜ï¼Œä½†ä¸æ˜¯æ ¸å¿ƒæˆå‘˜ï¼Œå› æ­¤ä½ éœ€è¦æ˜¾å¼åœ°åŠ è½½å®ƒã€‚æˆ‘
ä»¬è¿˜å°†åŠ è½½å®Œæ•´çš„\texttt{tidyverse}ï¼Œå› ä¸ºåœ¨æˆ‘ä»¬å¤„ç†å·²æŠ“å–çš„æ•°æ®æ—¶ï¼Œå®ƒé€šå¸¸ä¼šå¾ˆæœ‰ç”¨ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(rvest)}
\end{Highlighting}
\end{Shaded}

\section{ç½‘é¡µæŠ“å–çš„é“å¾·ä¸æ³•å¾‹}\label{ux7f51ux9875ux6293ux53d6ux7684ux9053ux5fb7ux4e0eux6cd5ux5f8b}

åœ¨æˆ‘ä»¬å¼€å§‹è®¨è®ºè¿›è¡Œç½‘é¡µæŠ“å–æ‰€éœ€çš„ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è®¨è®ºä½ æ˜¯å¦æœ‰æƒåˆæ³•ä¸”åˆä¹é“å¾·åœ°è¿™æ ·åšã€‚æ€»
çš„æ¥è¯´ï¼Œè¿™ä¸¤ä¸ªæ–¹é¢çš„æƒ…å†µéƒ½ç›¸å½“å¤æ‚ã€‚

åˆæ³•æ€§åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºä½ ä½åœ¨å“ªé‡Œã€‚ç„¶
è€Œï¼Œä½œä¸ºä¸€èˆ¬åŸåˆ™ï¼Œå¦‚æœæ•°æ®æ˜¯å…¬å¼€çš„ã€éä¸ªäººçš„å’ŒçœŸå®çš„ï¼Œé‚£ä¹ˆä½ å¯èƒ½æ˜¯å®‰å…¨çš„\footnote{æ˜¾ç„¶ï¼Œæˆ‘ä»¬ä¸æ˜¯å¾‹å¸ˆï¼Œè¿™ä¹Ÿä¸æ˜¯æ³•å¾‹å»ºè®®ã€‚ä½†
  è¿™æ˜¯æˆ‘ä»¬é˜…è¯»äº†å¤§é‡ç›¸å…³è¯é¢˜åèƒ½å¤Ÿç»™å‡ºçš„æœ€ä½³æ€»ç»“ã€‚}ã€‚
è¿™ä¸‰ä¸ªå› ç´ å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒä»¬ä¸ç½‘ç«™çš„æ¡æ¬¾å’Œæ¡ä»¶ã€ä¸ªäººèº«ä»½ä¿¡æ¯å’Œç‰ˆæƒæœ‰å…³ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹é¢è®¨è®ºã€‚

å¦‚æœæ•°æ®ä¸æ˜¯å…¬å¼€çš„ã€éä¸ªäººçš„æˆ–çœŸå®çš„ï¼Œæˆ–è€…ä½ æ˜¯ä¸“é—¨ä¸ºäº†èµšé’±è€ŒæŠ“å–è¿™äº›æ•°æ®ï¼Œé‚£ä¹ˆä½ éœ€è¦å’¨è¯¢å¾‹å¸ˆã€‚æœ€
é‡è¦çš„æ˜¯ï¼Œåœ¨ä»»ä½•æƒ…å†µä¸‹ä½ éƒ½åº”è¯¥å°Šé‡æ‰˜ç®¡ä½ æ­£åœ¨æŠ“å–çš„é¡µé¢çš„æœåŠ¡å™¨èµ„æºã€‚è¿™
æ„å‘³ç€å¦‚æœä½ æ­£åœ¨æŠ“å–è®¸å¤šé¡µé¢ï¼Œä½ åº”è¯¥ç¡®ä¿åœ¨æ¯ä¸ªè¯·æ±‚ä¹‹é—´ç¨å¾®ç­‰å¾…ä¸€ä¸‹ã€‚ä¸€
ä¸ªç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ Dmytro Perepolkin
çš„\href{https://dmi3kno.github.io/polite/}{\textbf{polite}}åŒ…ï¼Œå®ƒä¼šè‡ªåŠ¨åœ¨è¯·æ±‚ä¹‹é—´æš‚åœå¹¶ç¼“å­˜ç»“æœï¼Œè¿™æ ·ä½ å°±ä¸ä¼šä¸¤æ¬¡è¯·æ±‚ç›¸åŒçš„é¡µé¢ã€‚

\subsection{æœåŠ¡æ¡æ¬¾}\label{ux670dux52a1ux6761ux6b3e}

å¦‚æœä»”ç»†è§‚å¯Ÿï¼Œä½ ä¼šå‘ç°è®¸å¤šç½‘ç«™åœ¨é¡µé¢ä¸Šçš„æŸä¸ªä½ç½®åŒ…å«äº†ä¸€ä¸ª``æ¡æ¬¾å’Œæ¡ä»¶''æˆ–``æœåŠ¡æ¡æ¬¾''çš„é“¾æ¥ã€‚å¦‚
æœä½ ä»”ç»†é˜…è¯»è¯¥é¡µé¢ï¼Œé€šå¸¸ä¼šå‘ç°è¯¥ç½‘ç«™æ˜ç¡®ç¦æ­¢ç½‘é¡µæŠ“å–ã€‚è¿™
äº›é¡µé¢ä¼ä¸šå¾€å¾€ä¼šè¿›è¡Œæ³•å¾‹ä¸Šçš„``åœˆåœ°è¿åŠ¨''ï¼Œå¯¹å…¶æå‡ºéå¸¸å®½æ³›çš„æƒåˆ©ä¸»å¼ ã€‚åœ¨
å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œå°Šé‡è¿™äº›æœåŠ¡æ¡æ¬¾æ˜¯ä¸€ç§ç¤¼è²Œï¼Œä½†å¯¹ä»»ä½•å£°æ˜éƒ½åº”è¯¥æŒä¿ç•™æ€åº¦ã€‚

ç¾å›½æ³•é™¢æ™®éè®¤ä¸ºï¼Œä»…ä»…å°†æœåŠ¡æ¡æ¬¾æ”¾åœ¨ç½‘ç«™çš„é¡µè„šä¸è¶³ä»¥ä½¿ä½ å—åˆ°å®ƒä»¬çš„çº¦æŸï¼Œä¾‹å¦‚\href{https://en.wikipedia.org/wiki/HiQ_Labs_v._LinkedIn}{HiQ
Labs v. LinkedIn}ä¸€æ¡ˆã€‚ä¸€
èˆ¬æ¥è¯´ï¼Œè¦å—æœåŠ¡æ¡æ¬¾çš„çº¦æŸï¼Œä½ å¿…é¡»é‡‡å–ä¸€äº›æ˜ç¡®çš„è¡ŒåŠ¨ï¼Œå¦‚åˆ›å»ºè´¦æˆ·æˆ–å‹¾é€‰å¤é€‰æ¡†ã€‚è¿™
å°±æ˜¯ä¸ºä»€ä¹ˆæ•°æ®æ˜¯å¦å…¬å¼€å¾ˆé‡è¦ï¼›å¦‚æœä½ ä¸éœ€è¦è´¦æˆ·å°±å¯ä»¥è®¿é—®å®ƒä»¬ï¼Œé‚£ä¹ˆä½ ä¸å¤ªå¯èƒ½å—åˆ°æœåŠ¡æ¡æ¬¾çš„çº¦æŸã€‚ä½†
è¯·æ³¨æ„ï¼Œæ¬§æ´²çš„æƒ…å†µåˆ™æœ‰æ‰€ä¸åŒï¼Œæ³•é™¢è®¤ä¸ºå³ä½¿ä½ æ²¡æœ‰æ˜ç¡®è¡¨ç¤ºåŒæ„ï¼ŒæœåŠ¡æ¡æ¬¾ä¹Ÿæ˜¯æœ‰å¼ºåˆ¶æ€§çš„ã€‚

\subsection{ä¸ªäººä¿¡æ¯}\label{ux4e2aux4ebaux4fe1ux606f}

å³ä½¿æ•°æ®æ˜¯å…¬å¼€çš„ï¼Œä½ ä¹Ÿåº”è¯¥æå…¶å°å¿ƒåœ°æŠ“å–ä¸ªäººèº«ä»½ä¿¡æ¯ï¼Œå¦‚å§“åã€ç”µå­é‚®ä»¶åœ°å€ã€ç”µè¯å·ç ã€å‡ºç”Ÿæ—¥æœŸç­‰ã€‚æ¬§
æ´²å¯¹æ”¶é›†æˆ–å­˜å‚¨æ­¤ç±»æ•°æ®æœ‰ç‰¹åˆ«ä¸¥æ ¼çš„æ³•å¾‹
(\href{https://gdpr-info.eu/}{GDPR})ï¼Œæ— è®ºä½ ä½åœ¨å“ªé‡Œï¼Œä½ éƒ½æœ‰å¯èƒ½é™·å…¥é“å¾·å›°å¢ƒã€‚ä¾‹
å¦‚åœ¨2016å¹´æœ‰ç ”ç©¶äººå‘˜ä»çº¦ä¼šç½‘ç«™OkCupidä¸ŠæŠ“å–äº†çº¦7ä¸‡äººçš„å…¬å¼€ä¸ªäººä¿¡æ¯èµ„æ–™ï¼ˆå¦‚ç”¨æˆ·åã€å¹´é¾„ã€æ€§åˆ«ã€åœ°ç‚¹ç­‰ï¼‰ï¼Œå¹¶å…¬å¼€åœ°å‘å¸ƒäº†è¿™äº›æ•°æ®ï¼Œæ²¡æœ‰ä»»ä½•åŒ¿ååŒ–å°è¯•ã€‚è™½
ç„¶ç ”ç©¶äººå‘˜è®¤ä¸ºæ—¢ç„¶æ•°æ®å·²ç»æ˜¯å…¬å¼€çš„ï¼Œè¿™æ ·åšå°±æ²¡ä»€ä¹ˆé”™ï¼Œä½†æ˜¯ç”±äºå¯¹æ•°æ®é›†ä¸­å‘å¸ƒçš„ç”¨æˆ·èº«ä»½ä¿¡æ¯çš„ä¼¦ç†æ‹…å¿§ï¼Œè¿™é¡¹å·¥ä½œå—åˆ°äº†å¹¿æ³›è°´è´£ã€‚å¦‚
æœä½ çš„å·¥ä½œæ¶‰åŠæŠ“å–ä¸ªäººèº«ä»½ä¿¡æ¯ï¼Œæˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½ é˜…è¯»OkCupidç ”ç©¶\footnote{ã€Šè¿çº¿ã€‹æ‚å¿—å‘è¡¨äº†ä¸€ç¯‡å…³äºOkCupidç ”ç©¶çš„æ–‡ç« 
  \url{https://www.wired.com/2016/05/okcupid-study-reveals-perils-big-data-science}.}ä»¥åŠæ¶‰åŠè·å–å’Œå‘å¸ƒä¸ªäººèº«ä»½ä¿¡æ¯çš„ç±»ä¼¼ç ”ç©¶ï¼Œè¿™äº›ç ”ç©¶çš„ä¼¦ç†éƒ½å­˜åœ¨é—®é¢˜ã€‚

\subsection{ç‰ˆæƒ}\label{ux7248ux6743-1}

æœ€åï¼Œæ‚¨è¿˜éœ€è¦æ‹…å¿ƒç‰ˆæƒæ³•ã€‚ç‰ˆ
æƒæ³•å¾ˆå¤æ‚ï¼Œä½†å€¼å¾—ä¸€çœ‹çš„æ˜¯\href{https://www.law.cornell.edu/uscode/text/17/102}{ç¾å›½æ³•å¾‹}å¯¹å—ä¿æŠ¤å†…å®¹çš„æè¿°ï¼š``{[}\ldots{]}ä»¥ä»»ä½•æœ‰å½¢è¡¨è¾¾åª’ä»‹å›ºå®šçš„åŸåˆ›ä½œå“{[}\ldots{]}''ã€‚æ¥
ç€ï¼Œå®ƒæè¿°äº†å…¶é€‚ç”¨çš„å…·ä½“ç±»åˆ«ï¼Œå¦‚æ–‡å­¦ä½œå“ã€éŸ³ä¹ä½œå“ã€ç”µå½±ç­‰ã€‚å€¼
å¾—æ³¨æ„çš„æ˜¯ï¼Œæ•°æ®å¹¶ä¸å—ç‰ˆæƒä¿æŠ¤ï¼Œè¿™æ„å‘³ç€åªè¦ä½ åªæ”¶é›†äº‹å®ï¼Œç‰ˆæƒä¿æŠ¤å°±ä¸é€‚ç”¨ã€‚(
ä½†è¯·æ³¨æ„ï¼Œæ¬§æ´²æœ‰ä¸€ä¸ªå•ç‹¬çš„``\href{https://en.wikipedia.org/wiki/Database_right}{sui
generis}''æƒåˆ©æ¥ä¿æŠ¤æ•°æ®åº“ã€‚)

ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œåœ¨ç¾å›½ï¼Œé…æ–™è¡¨å’Œè¯´æ˜æ˜¯ä¸å—ç‰ˆæƒä¿æŠ¤çš„ï¼Œæ‰€ä»¥ç‰ˆæƒä¸èƒ½ç”¨æ¥ä¿æŠ¤é£Ÿè°±ã€‚ä½†
æ˜¯ï¼Œå¦‚æœè¯¥é£Ÿè°±åˆ—è¡¨ä¼´æœ‰å¤§é‡æ–°é¢–çš„æ–‡å­¦å†…å®¹ï¼Œé‚£ä¹ˆè¿™äº›å†…å®¹æ˜¯å—ç‰ˆæƒä¿æŠ¤çš„ã€‚è¿™
å°±æ˜¯ä¸ºä»€ä¹ˆå½“ä½ åœ¨ç½‘ä¸Šå¯»æ‰¾é£Ÿè°±æ—¶ï¼Œä¹‹å‰æ€»æ˜¯æœ‰é‚£ä¹ˆå¤šå†…å®¹ã€‚

å¦‚æœä½ ç¡®å®éœ€è¦æŠ“å–åŸåˆ›å†…å®¹ï¼ˆå¦‚æ–‡æœ¬æˆ–å›¾åƒï¼‰ï¼Œä½ å¯èƒ½ä»ç„¶å—åˆ°\href{https://en.wikipedia.org/wiki/Fair_use}{åˆç†ä½¿ç”¨åŸåˆ™}çš„ä¿æŠ¤ã€‚åˆ
ç†ä½¿ç”¨ä¸æ˜¯ä¸€ä¸ªä¸¥æ ¼çš„è§„åˆ™ï¼Œè€Œæ˜¯æƒè¡¡äº†å¤šä¸ªå› ç´ ã€‚å¦‚
æœä½ å‡ºäºç ”ç©¶æˆ–éå•†ä¸šç›®çš„æ”¶é›†æ•°æ®ï¼Œå¹¶ä¸”ä»…æŠ“å–æ‰€éœ€å†…å®¹ï¼Œé‚£ä¹ˆåˆç†ä½¿ç”¨åŸåˆ™æ›´å¯èƒ½é€‚ç”¨ã€‚

\section{HTMLåŸºç¡€}\label{htmlux57faux7840}

è¦æŠ“å–ç½‘é¡µï¼Œä½ é¦–å…ˆéœ€è¦ç¨å¾®äº†è§£HTML (\textbf{H}yper\textbf{T}ext
\textbf{M}arkup \textbf{L}anguage) ï¼Œä¸€ç§æè¿°ç½‘é¡µçš„è¯­è¨€ã€‚H TML
ä»£è¡¨è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼Œçœ‹èµ·æ¥åƒè¿™æ ·ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\DataTypeTok{\textless{}}\KeywordTok{html}\DataTypeTok{\textgreater{}}
\DataTypeTok{\textless{}}\KeywordTok{head}\DataTypeTok{\textgreater{}}
  \DataTypeTok{\textless{}}\KeywordTok{title}\DataTypeTok{\textgreater{}}\NormalTok{Page title}\DataTypeTok{\textless{}/}\KeywordTok{title}\DataTypeTok{\textgreater{}}
\DataTypeTok{\textless{}/}\KeywordTok{head}\DataTypeTok{\textgreater{}}
\DataTypeTok{\textless{}}\KeywordTok{body}\DataTypeTok{\textgreater{}}
  \DataTypeTok{\textless{}}\KeywordTok{h1}\OtherTok{ id}\OperatorTok{=}\StringTok{\textquotesingle{}first\textquotesingle{}}\DataTypeTok{\textgreater{}}\NormalTok{A heading}\DataTypeTok{\textless{}/}\KeywordTok{h1}\DataTypeTok{\textgreater{}}
  \DataTypeTok{\textless{}}\KeywordTok{p}\DataTypeTok{\textgreater{}}\NormalTok{Some text }\DecValTok{\&amp;} \DataTypeTok{\textless{}}\KeywordTok{b}\DataTypeTok{\textgreater{}}\NormalTok{some bold text.}\DataTypeTok{\textless{}/}\KeywordTok{b}\DataTypeTok{\textgreater{}\textless{}/}\KeywordTok{p}\DataTypeTok{\textgreater{}}
  \DataTypeTok{\textless{}}\KeywordTok{img}\OtherTok{ src}\OperatorTok{=}\StringTok{\textquotesingle{}myimg.png\textquotesingle{}}\OtherTok{ width}\OperatorTok{=}\StringTok{\textquotesingle{}100\textquotesingle{}}\OtherTok{ height}\OperatorTok{=}\StringTok{\textquotesingle{}100\textquotesingle{}}\DataTypeTok{\textgreater{}}
\DataTypeTok{\textless{}/}\KeywordTok{body}\DataTypeTok{\textgreater{}}
\end{Highlighting}
\end{Shaded}

HTMLå…·æœ‰ç”±å…ƒç´ å½¢æˆçš„å±‚æ¬¡ç»“æ„ï¼Œè¿™äº›å…ƒç´ åŒ…æ‹¬å¼€å§‹æ ‡ç­¾ï¼ˆä¾‹å¦‚ï¼Œ\texttt{\textless{}tag\textgreater{}}ï¼‰ã€å¯é€‰å±æ€§ï¼ˆ\texttt{id=\textquotesingle{}first\textquotesingle{}}ï¼‰ã€ç»“æŸæ ‡ç­¾\footnote{è®¸å¤šæ ‡ç­¾(åŒ…æ‹¬\texttt{\textless{}p\textgreater{}}å’Œ\texttt{\textless{}li\textgreater{}})ä¸éœ€è¦ç»“æŸæ ‡ç­¾ï¼Œä½†æˆ‘ä»¬è®¤ä¸ºæœ€å¥½åŒ…å«ç»“æŸæ ‡ç­¾ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥æ›´å®¹æ˜“åœ°æŸ¥çœ‹HTMLçš„ç»“æ„ã€‚}ï¼ˆå¦‚\texttt{\textless{}/tag\textgreater{}}ï¼‰å’Œå†…å®¹ï¼ˆå¼€å§‹æ ‡ç­¾å’Œç»“æŸæ ‡ç­¾ä¹‹é—´çš„æ‰€æœ‰å†…å®¹ï¼‰ã€‚

ç”±äº\texttt{\textless{}}å’Œ\texttt{\textgreater{}}ç”¨äºå¼€å§‹å’Œç»“æŸæ ‡ç­¾ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ä¹¦å†™å®ƒä»¬ã€‚ç›¸
åï¼Œä½ å¿…é¡»ä½¿ç”¨HTMLè½¬ä¹‰å­—ç¬¦\texttt{\&gt;} (å¤§äº)å’Œ\texttt{\&lt;}
(å°äº)ã€‚å¹¶
ä¸”å› ä¸ºè¿™äº›è½¬ä¹‰å­—ç¬¦ä½¿ç”¨äº†\&ï¼Œå¦‚æœä½ æƒ³è¦ä¸€ä¸ªå®é™…çš„\&ç¬¦å·ï¼Œä½ å¿…é¡»å°†å…¶è½¬ä¹‰ä¸º\texttt{\&amp;}ã€‚è™½
ç„¶å­˜åœ¨è®¸å¤šå¯èƒ½çš„HTMLè½¬ä¹‰å­—ç¬¦ï¼Œä½†ä½ ä¸éœ€è¦è¿‡åˆ†æ‹…å¿ƒå®ƒä»¬ï¼Œå› ä¸ºrvestä¼šè‡ªåŠ¨ä¸ºä½ å¤„ç†å®ƒä»¬ã€‚

ç½‘é¡µæŠ“å–ä¹‹æ‰€ä»¥å¯èƒ½ï¼Œæ˜¯å› ä¸ºå¤§å¤šæ•°åŒ…å«ä½ æƒ³è¦æŠ“å–çš„æ•°æ®çš„é¡µé¢é€šå¸¸éƒ½å…·æœ‰ä¸€è‡´çš„ç»“æ„ã€‚

\subsection{å…ƒç´ }\label{ux5143ux7d20}

HTMLæœ‰è¶…è¿‡100ä¸ªå…ƒç´ ã€‚å…¶ ä¸­æœ€é‡è¦çš„æ˜¯:

\begin{itemize}
\tightlist
\item
  æ¯ä¸ªHTMLé¡µé¢éƒ½å¿…é¡»ä½äº\texttt{\textless{}html\textgreater{}}å…ƒç´ ä¸­ï¼Œè¿˜å¿…é¡»åŒ…å«ä¸¤ä¸ªå­å…ƒç´ ï¼š\texttt{\textless{}head\textgreater{}}ï¼Œå…¶ä¸­åŒ…å«æ–‡æ¡£å…ƒæ•°æ®ï¼Œå¦‚é¡µé¢æ ‡é¢˜ï¼Œä»¥åŠ\texttt{\textless{}body\textgreater{}}ï¼Œå…¶ä¸­åŒ…å«ä½ åœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°çš„å†…å®¹ã€‚
\item
  è¯¸å¦‚\texttt{\textless{}h1\textgreater{}}
  (æ ‡é¢˜1)ã€\texttt{\textless{}section\textgreater{}}
  (éƒ¨åˆ†)ã€\texttt{\textless{}p\textgreater{}} (æ®µè½) å’Œ
  \texttt{\textless{}ol\textgreater{}} (æœ‰åºåˆ—è¡¨)
  ä¹‹ç±»çš„å—æ ‡ç­¾æ„æˆäº†é¡µé¢çš„æ•´ä½“ç»“æ„ã€‚
\item
  è¯¸å¦‚\texttt{\textless{}b\textgreater{}}
  (ç²—ä½“)ã€\texttt{\textless{}i\textgreater{}} (æ–œä½“) å’Œ
  \texttt{\textless{}a\textgreater{}} (é“¾æ¥)
  ä¹‹ç±»çš„å†…è”æ ‡ç­¾ç”¨ä»¥æ ¼å¼åŒ–å—æ ‡ç­¾å†…çš„æ–‡æœ¬ã€‚
\end{itemize}

å¦‚æœæ‚¨é‡åˆ°ä»æœªè§è¿‡çš„æ ‡ç­¾ï¼Œå¯ä»¥é€šè¿‡è°·æ­Œæœç´¢æ¥å‘ç°å®ƒçš„ä½œç”¨ã€‚å¦
ä¸€ä¸ªä¸é”™çš„èµ·ç‚¹æ˜¯
\href{https://developer.mozilla.org/en-US/docs/Web/HTML}{MDN Web
Docs}ï¼Œå®ƒæè¿°äº†ç½‘ç»œç¼–ç¨‹çš„å„ä¸ªæ–¹é¢ã€‚

å¤§å¤šæ•°å…ƒç´ éƒ½å¯ä»¥åœ¨å¼€å§‹å’Œç»“æŸæ ‡ç­¾ä¹‹é—´åŒ…å«å†…å®¹ã€‚è¿™
äº›å†…å®¹å¯ä»¥æ˜¯æ–‡æœ¬æˆ–å…¶ä»–å…ƒç´ ã€‚ä¾‹
å¦‚ï¼Œä»¥ä¸‹HTMLåŒ…å«ä¸€æ®µæ–‡æœ¬ï¼Œå…¶ä¸­ä¸€ä¸ªè¯ä¸ºç²—ä½“ã€‚

\begin{verbatim}
<p>
  Hi! My <b>name</b> is Hadley.
</p>
\end{verbatim}

ä¸Šé¢çš„\texttt{\textless{}p\textgreater{}}å…ƒç´ æœ‰ä¸€ä¸ªå­å…ƒç´ ï¼Œå³\texttt{\textless{}b\textgreater{}}å…ƒç´ ï¼Œ\texttt{\textless{}b\textgreater{}}å…ƒç´ æ²¡æœ‰å­å…ƒç´ ï¼Œä½†æ˜¯å®ƒæœ‰å†…å®¹
(æ–‡æœ¬``name'')ã€‚å­ å…ƒç´ æ˜¯å®ƒåŒ…å«çš„å…¶ä»–å…ƒç´ ã€‚

\subsection{å±æ€§}\label{ux5c5eux6027}

æ ‡ç­¾å¯ä»¥æœ‰å‘½åå±æ€§ï¼Œçœ‹èµ·æ¥åƒè¿™æ ·ï¼š\texttt{name1=\textquotesingle{}value1\textquotesingle{}\ name2=\textquotesingle{}value2\textquotesingle{}}ï¼Œå…¶ä¸­ä¸¤ä¸ªæœ€é‡è¦çš„å±æ€§æ˜¯\texttt{id}å’Œ\texttt{class}ï¼Œå®ƒä»¬ä¸
CSSï¼ˆå±‚å æ ·å¼è¡¨ï¼‰ä¸€èµ·ä½¿ç”¨ï¼Œä»¥æ§åˆ¶é¡µé¢çš„è§†è§‰å¤–è§‚ã€‚åœ¨
æŠ“å–é¡µé¢æ•°æ®æ—¶ï¼Œè¿™äº›å±æ€§é€šå¸¸å¾ˆæœ‰ç”¨ã€‚å±
æ€§ä¹Ÿç”¨äºè®°å½•é“¾æ¥çš„ç›®æ ‡ï¼ˆ\texttt{\textless{}a\textgreater{}}å…ƒç´ çš„\texttt{href}å±æ€§ï¼‰å’Œå›¾åƒçš„æ¥æºï¼ˆ\texttt{\textless{}img\textgreater{}}å…ƒç´ çš„\texttt{src}å±æ€§ï¼‰ã€‚

\section{æå–æ•°æ®}\label{ux63d0ux53d6ux6570ux636e}

è¦å¼€å§‹æŠ“å–æ•°æ®ï¼Œä½ éœ€è¦æŠ“å–çš„é¡µé¢çš„URLï¼Œè¿™é€šå¸¸å¯ä»¥ä»ä½ çš„ç½‘é¡µæµè§ˆå™¨ä¸­è¿›è¡Œå¤åˆ¶ã€‚ç„¶
åï¼Œä½¿ç”¨\texttt{read\_html()}å‡½æ•°å°†è¯¥é¡µé¢çš„HTMLè¯»å–åˆ°Rä¸­ã€‚è¿™
ä¼šè¿”å›ä¸€ä¸ª\texttt{xml\_document}\footnote{è¯¥ç±»æ¥è‡ª\href{https://xml2.r-lib.org}{xml2}åŒ…ã€‚x
  ml2æ˜¯ä¸€ç§åº•å±‚åŒ…ï¼Œå¯ä»¥åœ¨å…¶ä¸Šè¿›è¡Œæ„å»ºã€‚}
å¯¹è±¡ï¼Œä¹‹åä½ å°†ä½¿ç”¨\texttt{rvest}å‡½æ•°æ¥æ“ä½œè¿™ä¸ªå¯¹è±¡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{html }\OtherTok{\textless{}{-}} \FunctionTok{read\_html}\NormalTok{(}\StringTok{"http://rvest.tidyverse.org/"}\NormalTok{)}
\NormalTok{html}
\CommentTok{\#\textgreater{} \{html\_document\}}
\CommentTok{\#\textgreater{} \textless{}html lang="en"\textgreater{}}
\CommentTok{\#\textgreater{} [1] \textless{}head\textgreater{}\textbackslash{}n\textless{}meta http{-}equiv="Content{-}Type" content="text/html; charset=UT ...}
\CommentTok{\#\textgreater{} [2] \textless{}body\textgreater{}\textbackslash{}n    \textless{}a href="\#container" class="visually{-}hidden{-}focusable"\textgreater{}Ski ...}
\end{Highlighting}
\end{Shaded}

revestè¿˜åŒ…å«ä¸€ä¸ªå‡½æ•°ï¼Œå…è®¸ä½ ç¼–å†™å†…è”HTMLã€‚åœ¨
æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬ä¼šç”¨ä¸€äº›ç®€å•çš„ä¾‹å­æ¥è®²è§£å„ç§å‡½æ•°çš„å·¥ä½œåŸç†ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{html }\OtherTok{\textless{}{-}} \FunctionTok{minimal\_html}\NormalTok{(}\StringTok{"}
\StringTok{  \textless{}p\textgreater{}This is a paragraph\textless{}/p\textgreater{}}
\StringTok{  \textless{}ul\textgreater{}}
\StringTok{    \textless{}li\textgreater{}This is a bulleted list\textless{}/li\textgreater{}}
\StringTok{  \textless{}/ul\textgreater{}}
\StringTok{"}\NormalTok{)}
\NormalTok{html}
\CommentTok{\#\textgreater{} \{html\_document\}}
\CommentTok{\#\textgreater{} \textless{}html\textgreater{}}
\CommentTok{\#\textgreater{} [1] \textless{}head\textgreater{}\textbackslash{}n\textless{}meta http{-}equiv="Content{-}Type" content="text/html; charset=UT ...}
\CommentTok{\#\textgreater{} [2] \textless{}body\textgreater{}\textbackslash{}n\textless{}p\textgreater{}This is a paragraph\textless{}/p\textgreater{}\textbackslash{}n  \textless{}ul\textgreater{}\textbackslash{}n\textless{}li\textgreater{}This is a bulleted lis ...}
\end{Highlighting}
\end{Shaded}

ç°åœ¨å·²ç»æœ‰äº†ç”¨Rç¼–å†™çš„HTMLï¼Œæ˜¯æ—¶å€™æå–æ„Ÿå…´è¶£çš„æ•°æ®äº†ã€‚ä½ 
å°†é¦–å…ˆäº†è§£CSSé€‰æ‹©å™¨ï¼Œå®ƒå…è®¸ä½ è¯†åˆ«æ„Ÿå…´è¶£çš„å…ƒç´ å’Œç”¨äºä»ä¸­æå–æ•°æ®çš„rvest
å‡½æ•°ã€‚ç„¶ åæˆ‘ä»¬å°†ç®€è¦ä»‹ç»HTMLè¡¨ï¼Œå®ƒæœ‰ä¸€äº›ç‰¹æ®Šçš„å·¥å…·ã€‚

\subsection{æŸ¥æ‰¾å…ƒç´ }\label{ux67e5ux627eux5143ux7d20}

CSS æ˜¯å±‚å æ ·å¼è¡¨ï¼ˆCascading Style
Sheetsï¼‰çš„ç¼©å†™ï¼Œæ˜¯ä¸€ä¸ªå®šä¹‰HTMLæ–‡æ¡£è§†è§‰æ ·å¼çš„å·¥å…·ã€‚C
SSåŒ…å«äº†ä¸€ç§åœ¨é¡µé¢ä¸Šé€‰æ‹©å…ƒç´ çš„å°å‹è¯­è¨€ï¼Œç§°ä¸ºCSSé€‰æ‹©å™¨ (CSS selectors)ã€‚C
SSé€‰æ‹©å™¨å®šä¹‰äº†å®šä½HTMLå…ƒç´ çš„æ¨¡å¼ï¼Œå¯¹äºæŠ“å–æ•°æ®æ¥è¯´éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬æä¾›äº†ä¸€ç§ç®€æ´çš„æ–¹å¼æ¥æè¿°ä½ æƒ³è¦æå–å“ªäº›å…ƒç´ ã€‚

æˆ‘ä»¬å°†åœ¨ å°èŠ‚~\ref{sec-css-selectors}
æ›´è¯¦ç»†åœ°è®¨è®ºCSSé€‰æ‹©å™¨ï¼Œä½†å¹¸è¿çš„æ˜¯ï¼Œä½ åªéœ€è¦æŒæ¡ä»¥ä¸‹ä¸‰ç§é€‰æ‹©å™¨å°±å¯ä»¥èµ°å¾—å¾ˆè¿œäº†ï¼š

\begin{itemize}
\item
  \texttt{p} é€‰æ‹©æ‰€æœ‰ \texttt{\textless{}p\textgreater{}} å…ƒç´ ï¼›
\item
  \texttt{.title} é€‰æ‹©æ‰€æœ‰å¸¦æœ‰ç±»å ``title'' çš„å…ƒç´ ï¼›
\item
  \texttt{\#title} é€‰æ‹© \texttt{id} å±æ€§ç­‰äº ``title'' çš„å…ƒç´ ã€‚i d
  å±æ€§åœ¨æ–‡æ¡£å†…å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œå› æ­¤è¿™åªä¼šé€‰æ‹©ä¸€ä¸ªå…ƒç´ ã€‚
\end{itemize}

è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥å°è¯•ä¸€ä¸‹è¿™äº›é€‰æ‹©å™¨ï¼š:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{html }\OtherTok{\textless{}{-}} \FunctionTok{minimal\_html}\NormalTok{(}\StringTok{"}
\StringTok{  \textless{}h1\textgreater{}This is a heading\textless{}/h1\textgreater{}}
\StringTok{  \textless{}p id=\textquotesingle{}first\textquotesingle{}\textgreater{}This is a paragraph\textless{}/p\textgreater{}}
\StringTok{  \textless{}p class=\textquotesingle{}important\textquotesingle{}\textgreater{}This is an important paragraph\textless{}/p\textgreater{}}
\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

ä½¿ç”¨\texttt{html\_elements()}æ¥æŸ¥æ‰¾ä¸é€‰æ‹©å™¨åŒ¹é…çš„æ‰€æœ‰å…ƒç´ ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{html }\SpecialCharTok{|\textgreater{}} \FunctionTok{html\_elements}\NormalTok{(}\StringTok{"p"}\NormalTok{)}
\CommentTok{\#\textgreater{} \{xml\_nodeset (2)\}}
\CommentTok{\#\textgreater{} [1] \textless{}p id="first"\textgreater{}This is a paragraph\textless{}/p\textgreater{}}
\CommentTok{\#\textgreater{} [2] \textless{}p class="important"\textgreater{}This is an important paragraph\textless{}/p\textgreater{}}
\NormalTok{html }\SpecialCharTok{|\textgreater{}} \FunctionTok{html\_elements}\NormalTok{(}\StringTok{".important"}\NormalTok{)}
\CommentTok{\#\textgreater{} \{xml\_nodeset (1)\}}
\CommentTok{\#\textgreater{} [1] \textless{}p class="important"\textgreater{}This is an important paragraph\textless{}/p\textgreater{}}
\NormalTok{html }\SpecialCharTok{|\textgreater{}} \FunctionTok{html\_elements}\NormalTok{(}\StringTok{"\#first"}\NormalTok{)}
\CommentTok{\#\textgreater{} \{xml\_nodeset (1)\}}
\CommentTok{\#\textgreater{} [1] \textless{}p id="first"\textgreater{}This is a paragraph\textless{}/p\textgreater{}}
\end{Highlighting}
\end{Shaded}

å¦ä¸€ä¸ªé‡è¦çš„å‡½æ•°æ˜¯\texttt{html\_element()}ï¼Œå®ƒæ€»æ˜¯è¿”å›ä¸è¾“å…¥ç›¸åŒæ•°é‡çš„è¾“å‡ºã€‚å¦‚
æœä½ å°†å®ƒåº”ç”¨äºæ•´ä¸ªæ–‡æ¡£ï¼Œå®ƒå°†è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…çš„å…ƒç´ ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{html }\SpecialCharTok{|\textgreater{}} \FunctionTok{html\_element}\NormalTok{(}\StringTok{"p"}\NormalTok{)}
\CommentTok{\#\textgreater{} \{html\_node\}}
\CommentTok{\#\textgreater{} \textless{}p id="first"\textgreater{}}
\end{Highlighting}
\end{Shaded}

å½“ä½ ä½¿ç”¨ä¸åŒ¹é…ä»»ä½•å…ƒç´ çš„é€‰æ‹©å™¨æ—¶ï¼Œ\texttt{html\_element()}å’Œ\texttt{html\_elements()}ä¹‹é—´æœ‰ä¸€ä¸ªé‡è¦çš„åŒºåˆ«ã€‚\texttt{h}
\texttt{tml\_elements()}è¿”å›ä¸€ä¸ªé•¿åº¦ä¸º 0
çš„å‘é‡ï¼Œè€Œ\texttt{html\_element()}è¿”å›ä¸€ä¸ªç¼ºå¤±å€¼ã€‚è¿™
åœ¨ç¨åçš„å†…å®¹ä¸­ä¼šå˜å¾—é‡è¦ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{html }\SpecialCharTok{|\textgreater{}} \FunctionTok{html\_elements}\NormalTok{(}\StringTok{"b"}\NormalTok{)}
\CommentTok{\#\textgreater{} \{xml\_nodeset (0)\}}
\NormalTok{html }\SpecialCharTok{|\textgreater{}} \FunctionTok{html\_element}\NormalTok{(}\StringTok{"b"}\NormalTok{)}
\CommentTok{\#\textgreater{} \{xml\_missing\}}
\CommentTok{\#\textgreater{} \textless{}NA\textgreater{}}
\end{Highlighting}
\end{Shaded}

\subsection{åµŒå¥—é€‰æ‹©}\label{ux5d4cux5957ux9009ux62e9}

åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ ä¼šä¸€èµ·ä½¿ç”¨\texttt{html\_elements()}å’Œ\texttt{html\_element()}ã€‚é€š
å¸¸é¦–å…ˆä½¿ç”¨\texttt{html\_elements()}æ¥è¯†åˆ«å°†æˆä¸ºè§‚æµ‹å€¼çš„å…ƒç´ ï¼Œç„¶åä½¿ç”¨\texttt{html\_element()}æ¥æŸ¥æ‰¾å°†æˆä¸ºå˜é‡çš„å…ƒç´ ã€‚è®©
æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹çœ‹è¿™æ˜¯å¦‚ä½•æ“ä½œçš„ã€‚è¿™
é‡Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ— åºåˆ—è¡¨ï¼ˆ\texttt{\textless{}ul\textgreater{}}ï¼‰ï¼Œå…¶ä¸­æ¯ä¸ªåˆ—è¡¨é¡¹ï¼ˆ\texttt{\textless{}li\textgreater{}}ï¼‰éƒ½åŒ…å«ã€Šæ˜Ÿçƒå¤§æˆ˜ã€‹ä¸­å››ä¸ªè§’è‰²çš„ä¿¡æ¯ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{html }\OtherTok{\textless{}{-}} \FunctionTok{minimal\_html}\NormalTok{(}\StringTok{"}
\StringTok{  \textless{}ul\textgreater{}}
\StringTok{    \textless{}li\textgreater{}\textless{}b\textgreater{}C{-}3PO\textless{}/b\textgreater{} is a \textless{}i\textgreater{}droid\textless{}/i\textgreater{} that weighs \textless{}span class=\textquotesingle{}weight\textquotesingle{}\textgreater{}167 kg\textless{}/span\textgreater{}\textless{}/li\textgreater{}}
\StringTok{    \textless{}li\textgreater{}\textless{}b\textgreater{}R4{-}P17\textless{}/b\textgreater{} is a \textless{}i\textgreater{}droid\textless{}/i\textgreater{}\textless{}/li\textgreater{}}
\StringTok{    \textless{}li\textgreater{}\textless{}b\textgreater{}R2{-}D2\textless{}/b\textgreater{} is a \textless{}i\textgreater{}droid\textless{}/i\textgreater{} that weighs \textless{}span class=\textquotesingle{}weight\textquotesingle{}\textgreater{}96 kg\textless{}/span\textgreater{}\textless{}/li\textgreater{}}
\StringTok{    \textless{}li\textgreater{}\textless{}b\textgreater{}Yoda\textless{}/b\textgreater{} weighs \textless{}span class=\textquotesingle{}weight\textquotesingle{}\textgreater{}66 kg\textless{}/span\textgreater{}\textless{}/li\textgreater{}}
\StringTok{  \textless{}/ul\textgreater{}}
\StringTok{  "}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{html\_elements()}åˆ›å»ºä¸€ä¸ªå‘é‡ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ å¯¹åº”ä¸€ä¸ªä¸åŒçš„å­—ç¬¦:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{characters }\OtherTok{\textless{}{-}}\NormalTok{ html }\SpecialCharTok{|\textgreater{}} \FunctionTok{html\_elements}\NormalTok{(}\StringTok{"li"}\NormalTok{)}
\NormalTok{characters}
\CommentTok{\#\textgreater{} \{xml\_nodeset (4)\}}
\CommentTok{\#\textgreater{} [1] \textless{}li\textgreater{}\textbackslash{}n\textless{}b\textgreater{}C{-}3PO\textless{}/b\textgreater{} is a \textless{}i\textgreater{}droid\textless{}/i\textgreater{} that weighs \textless{}span class="weight"\textgreater{} ...}
\CommentTok{\#\textgreater{} [2] \textless{}li\textgreater{}\textbackslash{}n\textless{}b\textgreater{}R4{-}P17\textless{}/b\textgreater{} is a \textless{}i\textgreater{}droid\textless{}/i\textgreater{}\textbackslash{}n\textless{}/li\textgreater{}}
\CommentTok{\#\textgreater{} [3] \textless{}li\textgreater{}\textbackslash{}n\textless{}b\textgreater{}R2{-}D2\textless{}/b\textgreater{} is a \textless{}i\textgreater{}droid\textless{}/i\textgreater{} that weighs \textless{}span class="weight"\textgreater{} ...}
\CommentTok{\#\textgreater{} [4] \textless{}li\textgreater{}\textbackslash{}n\textless{}b\textgreater{}Yoda\textless{}/b\textgreater{} weighs \textless{}span class="weight"\textgreater{}66 kg\textless{}/span\textgreater{}\textbackslash{}n\textless{}/li\textgreater{}}
\end{Highlighting}
\end{Shaded}

è¦æå–æ¯ä¸ªè§’è‰²çš„åå­—ï¼Œæˆ‘ä»¬ä½¿ç”¨\texttt{html\_element()}ï¼Œå› ä¸ºå½“åº”ç”¨äº\texttt{html\_elements()}çš„è¾“å‡ºæ—¶ï¼Œå®ƒä¿è¯æ¯ä¸ªå…ƒç´ è¿”å›ä¸€ä¸ªå“åº”:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{characters }\SpecialCharTok{|\textgreater{}} \FunctionTok{html\_element}\NormalTok{(}\StringTok{"b"}\NormalTok{)}
\CommentTok{\#\textgreater{} \{xml\_nodeset (4)\}}
\CommentTok{\#\textgreater{} [1] \textless{}b\textgreater{}C{-}3PO\textless{}/b\textgreater{}}
\CommentTok{\#\textgreater{} [2] \textless{}b\textgreater{}R4{-}P17\textless{}/b\textgreater{}}
\CommentTok{\#\textgreater{} [3] \textless{}b\textgreater{}R2{-}D2\textless{}/b\textgreater{}}
\CommentTok{\#\textgreater{} [4] \textless{}b\textgreater{}Yoda\textless{}/b\textgreater{}}
\end{Highlighting}
\end{Shaded}

å¯¹äºåå­—æ¥è¯´ï¼Œ\texttt{html\_element()}å’Œ\texttt{html\_elements()}ä¹‹é—´çš„åŒºåˆ«å¹¶ä¸é‡è¦ï¼Œä½†å¯¹äºä½“é‡æ¥è¯´å°±å¾ˆé‡è¦äº†ã€‚æˆ‘
ä»¬æƒ³è¦ä¸ºæ¯ä¸ªè§’è‰²è·å–ä¸€ä¸ªä½“é‡ï¼Œå³ä½¿æ²¡æœ‰ä½“é‡çš„\texttt{\textless{}span\textgreater{}}æ ‡ç­¾ã€‚è¿™
æ­£æ˜¯\texttt{html\_element()}æ‰€åšçš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{characters }\SpecialCharTok{|\textgreater{}} \FunctionTok{html\_element}\NormalTok{(}\StringTok{".weight"}\NormalTok{)}
\CommentTok{\#\textgreater{} \{xml\_nodeset (4)\}}
\CommentTok{\#\textgreater{} [1] \textless{}span class="weight"\textgreater{}167 kg\textless{}/span\textgreater{}}
\CommentTok{\#\textgreater{} [2] NA}
\CommentTok{\#\textgreater{} [3] \textless{}span class="weight"\textgreater{}96 kg\textless{}/span\textgreater{}}
\CommentTok{\#\textgreater{} [4] \textless{}span class="weight"\textgreater{}66 kg\textless{}/span\textgreater{}}
\end{Highlighting}
\end{Shaded}

\texttt{html\_elements()}æŸ¥æ‰¾æ‰€æœ‰ä½œä¸º\texttt{characters}å­å…ƒç´ çš„ä½“é‡\texttt{\textless{}span\textgreater{}}æ ‡ç­¾ã€‚ä½†
è¿™æ ·çš„æ ‡ç­¾åªæœ‰ä¸‰ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬å¤±å»äº†åå­—å’Œä½“é‡ä¹‹é—´çš„å…³è”ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{characters }\SpecialCharTok{|\textgreater{}} \FunctionTok{html\_elements}\NormalTok{(}\StringTok{".weight"}\NormalTok{)}
\CommentTok{\#\textgreater{} \{xml\_nodeset (3)\}}
\CommentTok{\#\textgreater{} [1] \textless{}span class="weight"\textgreater{}167 kg\textless{}/span\textgreater{}}
\CommentTok{\#\textgreater{} [2] \textless{}span class="weight"\textgreater{}96 kg\textless{}/span\textgreater{}}
\CommentTok{\#\textgreater{} [3] \textless{}span class="weight"\textgreater{}66 kg\textless{}/span\textgreater{}}
\end{Highlighting}
\end{Shaded}

æ—¢ç„¶å·²ç»é€‰æ‹©äº†æ„Ÿå…´è¶£çš„å…ƒç´ ï¼Œæ¥ä¸‹æ¥éœ€è¦ä»æ–‡æœ¬å†…å®¹æˆ–æŸäº›å±æ€§ä¸­æå–æ•°æ®ã€‚

\subsection{æ–‡æœ¬å’Œå±æ€§}\label{ux6587ux672cux548cux5c5eux6027}

\texttt{html\_text2()}\footnote{rvest
  ä¹Ÿæä¾›äº†\texttt{html\_text()}å‡½æ•°ï¼Œä½†ä½ å‡ ä¹æ€»æ˜¯ä½¿ç”¨\texttt{html\_text2()}ï¼Œå› ä¸ºå®ƒåœ¨å°†åµŒå¥—çš„
  HTML è½¬æ¢ä¸ºæ–‡æœ¬æ–¹é¢åšå¾—æ›´å¥½ã€‚} æå–HTMLå…ƒç´ çš„çº¯æ–‡æœ¬å†…å®¹:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{characters }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{html\_element}\NormalTok{(}\StringTok{"b"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{html\_text2}\NormalTok{()}
\CommentTok{\#\textgreater{} [1] "C{-}3PO"  "R4{-}P17" "R2{-}D2"  "Yoda"}

\NormalTok{characters }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{html\_element}\NormalTok{(}\StringTok{".weight"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{html\_text2}\NormalTok{()}
\CommentTok{\#\textgreater{} [1] "167 kg" NA       "96 kg"  "66 kg"}
\end{Highlighting}
\end{Shaded}

æ³¨æ„ï¼Œä»»ä½•è½¬ä¹‰éƒ½å°†è¢«è‡ªåŠ¨å¤„ç†ï¼Œä½ åªä¼šåœ¨æºHTMLä¸­çœ‹åˆ°HTMLè½¬ä¹‰ï¼Œè€Œä¸ä¼šåœ¨rvestè¿”å›çš„æ•°æ®ä¸­çœ‹åˆ°ã€‚

\texttt{html\_attr()} ä»å±æ€§ä¸­æå–æ•°æ®:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{html }\OtherTok{\textless{}{-}} \FunctionTok{minimal\_html}\NormalTok{(}\StringTok{"}
\StringTok{  \textless{}p\textgreater{}\textless{}a href=\textquotesingle{}https://en.wikipedia.org/wiki/Cat\textquotesingle{}\textgreater{}cats\textless{}/a\textgreater{}\textless{}/p\textgreater{}}
\StringTok{  \textless{}p\textgreater{}\textless{}a href=\textquotesingle{}https://en.wikipedia.org/wiki/Dog\textquotesingle{}\textgreater{}dogs\textless{}/a\textgreater{}\textless{}/p\textgreater{}}
\StringTok{"}\NormalTok{)}

\NormalTok{html }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{html\_elements}\NormalTok{(}\StringTok{"p"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{html\_element}\NormalTok{(}\StringTok{"a"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{html\_attr}\NormalTok{(}\StringTok{"href"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "https://en.wikipedia.org/wiki/Cat" "https://en.wikipedia.org/wiki/Dog"}
\end{Highlighting}
\end{Shaded}

\texttt{html\_attr()}
æ€»æ˜¯è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å¦‚æœè¦æå–æ•°å­—æˆ–æ—¥æœŸï¼Œéœ€è¦åšä¸€äº›åå¤„ç†ã€‚

\subsection{è¡¨æ ¼}\label{ux8868ux683c}

å¦‚æœä½ å¾ˆå¹¸è¿ï¼Œä½ çš„æ•°æ®å·²ç»å­˜å‚¨åœ¨ HTML
è¡¨æ ¼ä¸­ï¼Œé‚£ä¹ˆåªéœ€è¦ä»è¯¥è¡¨æ ¼ä¸­è¯»å–æ•°æ®å³å¯ã€‚åœ¨
æµè§ˆå™¨ä¸­è¯†åˆ«è¡¨æ ¼é€šå¸¸å¾ˆç®€å•ï¼šå®ƒä¼šæœ‰ä¸€ä¸ªç”±è¡Œå’Œåˆ—ç»„æˆçš„çŸ©å½¢ç»“æ„ï¼Œä½ å¯ä»¥å°†å…¶å¤åˆ¶å¹¶ç²˜è´´åˆ°åƒ
Excel è¿™æ ·çš„å·¥å…·ä¸­ã€‚

HTML è¡¨æ ¼ç”±å››ä¸ªä¸»è¦å…ƒç´ ç»„æˆï¼š\texttt{\textless{}table\textgreater{}}
(è¡¨æ ¼)ã€\texttt{\textless{}tr\textgreater{}}
(è¡¨æ ¼è¡Œ)ã€\texttt{\textless{}th\textgreater{}} (è¡¨æ ¼æ ‡é¢˜)å’Œ
\texttt{\textless{}td\textgreater{}} (è¡¨æ ¼æ•°æ®)ã€‚ä¸‹
é¢æ˜¯ä¸€ä¸ªåŒ…å«ä¸¤åˆ—ä¸‰è¡Œçš„ç®€å• HTML è¡¨æ ¼ç¤ºä¾‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{html }\OtherTok{\textless{}{-}} \FunctionTok{minimal\_html}\NormalTok{(}\StringTok{"}
\StringTok{  \textless{}table class=\textquotesingle{}mytable\textquotesingle{}\textgreater{}}
\StringTok{    \textless{}tr\textgreater{}\textless{}th\textgreater{}x\textless{}/th\textgreater{}   \textless{}th\textgreater{}y\textless{}/th\textgreater{}\textless{}/tr\textgreater{}}
\StringTok{    \textless{}tr\textgreater{}\textless{}td\textgreater{}1.5\textless{}/td\textgreater{} \textless{}td\textgreater{}2.7\textless{}/td\textgreater{}\textless{}/tr\textgreater{}}
\StringTok{    \textless{}tr\textgreater{}\textless{}td\textgreater{}4.9\textless{}/td\textgreater{} \textless{}td\textgreater{}1.3\textless{}/td\textgreater{}\textless{}/tr\textgreater{}}
\StringTok{    \textless{}tr\textgreater{}\textless{}td\textgreater{}7.2\textless{}/td\textgreater{} \textless{}td\textgreater{}8.1\textless{}/td\textgreater{}\textless{}/tr\textgreater{}}
\StringTok{  \textless{}/table\textgreater{}}
\StringTok{  "}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

rvest æä¾›äº†ä¸€ä¸ª\texttt{html\_table()}å‡½æ•°æ¥è¯»å–è¿™ç§ç±»å‹çš„æ•°æ®ã€‚å®ƒ
è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«é¡µé¢ä¸Šæ‰¾åˆ°çš„æ¯ä¸ªè¡¨æ ¼çš„ä¸€ä¸ª tibbleã€‚ä½¿
ç”¨\texttt{html\_element()}æ¥è¯†åˆ«ä½ æƒ³è¦æå–çš„è¡¨æ ¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{html }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{html\_element}\NormalTok{(}\StringTok{".mytable"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{html\_table}\NormalTok{()}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 2}
\CommentTok{\#\textgreater{}       x     y}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1   1.5   2.7}
\CommentTok{\#\textgreater{} 2   4.9   1.3}
\CommentTok{\#\textgreater{} 3   7.2   8.1}
\end{Highlighting}
\end{Shaded}

è¯·æ³¨æ„ï¼Œ\texttt{x} å’Œ \texttt{y} å·²ç»è‡ªåŠ¨è¢«è½¬æ¢ä¸ºæ•°å­—ã€‚è¿™
ç§è‡ªåŠ¨è½¬æ¢å¹¶ä¸æ€»æ˜¯æœ‰æ•ˆï¼Œå› æ­¤åœ¨æ›´å¤æ‚çš„åœºæ™¯ä¸­ï¼Œä½ å¯èƒ½æƒ³é€šè¿‡è®¾ç½®
\texttt{convert\ =\ FALSE} æ¥å…³é—­å®ƒï¼Œç„¶åè¿›è¡Œè‡ªå·±çš„è½¬æ¢ã€‚

\section{æ‰¾åˆ°æ­£ç¡®çš„é€‰æ‹©å™¨}\label{sec-css-selectors}

ç¡®å®šæ•°æ®å¯¹åº”çš„é€‰æ‹©å™¨é€šå¸¸æ˜¯è¿™ä¸ªé—®é¢˜ä¸­æœ€å›°éš¾çš„éƒ¨åˆ†ã€‚ä½ 
é€šå¸¸éœ€è¦åšä¸€äº›å°è¯•æ¥æ‰¾åˆ°ä¸€ä¸ªæ—¢ç‰¹å¼‚ï¼ˆå³ä¸é€‰æ‹©ä½ ä¸å…³å¿ƒçš„å†…å®¹ï¼‰åˆæ•æ„Ÿï¼ˆå³é€‰æ‹©ä½ å…³å¿ƒçš„æ‰€æœ‰å†…å®¹ï¼‰çš„é€‰æ‹©å™¨ã€‚å¤§
é‡çš„å°è¯•å’Œé”™è¯¯æ˜¯è¿™ä¸ªè¿‡ç¨‹çš„æ­£å¸¸éƒ¨åˆ†ï¼æœ‰
ä¸¤ä¸ªä¸»è¦å·¥å…·å¯ä»¥å¸®åŠ©ä½ å®Œæˆè¿™ä¸ªè¿‡ç¨‹ï¼šSelectorGadget
å’Œæµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·ã€‚

\href{https://rvest.tidyverse.org/articles/selectorgadget.html}{SelectorGadget}
æ˜¯ä¸€ä¸ª JavaScript ä¹¦ç­¾å·¥å…·ï¼Œå®ƒåŸºäºä½ æä¾›çš„æ­£é¢å’Œåé¢ç¤ºä¾‹æ¥è‡ªåŠ¨ç”Ÿæˆ CSS
é€‰æ‹©å™¨ã€‚å®ƒ å¹¶ä¸æ€»æ˜¯æœ‰æ•ˆï¼Œä½†å½“å®ƒæˆåŠŸæ—¶ï¼Œå®ƒå°±åƒç¥å¥‡é­”æ³•ä¸€æ ·ï¼ä½ 
å¯ä»¥é€šè¿‡é˜…è¯»
\url{https://rvest.tidyverse.org/articles/selectorgadget.html} æˆ–è§‚çœ‹
Mine çš„è§†é¢‘ \hyperref[0]{https://www.youtube.com/watch?v=PetWV5g1Xsc}
æ¥å­¦ä¹ å¦‚ä½•å®‰è£…å’Œä½¿ç”¨ SelectorGadgetã€‚

æ¯ä¸ªç°ä»£æµè§ˆå™¨éƒ½å¸¦æœ‰ä¸€äº›å¼€å‘è€…å·¥å…·åŒ…ï¼Œä½†æˆ‘ä»¬æ¨èä½¿ç”¨
Chromeï¼Œå³ä½¿å®ƒä¸æ˜¯ä½ çš„å¸¸ç”¨æµè§ˆå™¨ã€‚å®ƒ
çš„ç½‘ç»œå¼€å‘è€…å·¥å…·æ˜¯æœ€å¥½çš„ï¼Œè€Œä¸”ç«‹å³å¯ç”¨ã€‚åœ¨
é¡µé¢ä¸Šçš„ä¸€ä¸ªå…ƒç´ ä¸Šå³é”®å•å‡»å¹¶é€‰æ‹©\texttt{Inspect}ï¼Œè¿™å°†æ‰“å¼€ä¸€ä¸ªå¯æ‰©å±•çš„å®Œæ•´
HTML é¡µé¢è§†å›¾ï¼Œä»¥ä½ åˆšåˆšç‚¹å‡»çš„å…ƒç´ ä¸ºä¸­å¿ƒã€‚ä½ 
å¯ä»¥ä½¿ç”¨å®ƒæ¥æ¢ç´¢é¡µé¢å¹¶äº†è§£å“ªäº›é€‰æ‹©å™¨å¯èƒ½æœ‰æ•ˆã€‚ç‰¹ åˆ«æ³¨æ„ class å’Œ id
å±æ€§ï¼Œå› ä¸ºè¿™äº›å±æ€§é€šå¸¸ç”¨äºå½¢æˆé¡µé¢çš„è§†è§‰ç»“æ„ï¼Œå› æ­¤æ˜¯æå–ä½ æ­£åœ¨å¯»æ‰¾çš„æ•°æ®çš„å¥½å·¥å…·ã€‚

åœ¨``å…ƒç´ ''è§†å›¾ä¸­ï¼Œä½ è¿˜å¯ä»¥å³é”®å•å‡»ä¸€ä¸ªå…ƒç´ å¹¶é€‰æ‹©\texttt{Copy\ as\ Selector}ä»¥ç”Ÿæˆä¸€ä¸ªå°†å”¯ä¸€æ ‡è¯†æ„Ÿå…´è¶£å…ƒç´ çš„é€‰æ‹©å™¨ã€‚

å¦‚æœ SelectorGadget æˆ– Chrome DevTools ç”Ÿæˆäº†ä½ ä¸ç†è§£çš„ CSS
é€‰æ‹©å™¨ï¼Œè¯·å°è¯•ä½¿ç”¨
\href{https://kittygiraudel.github.io/selectors-explained/}{Selectors
Explained}ï¼Œå®ƒå°† CSS é€‰æ‹©å™¨ç¿»è¯‘æˆç®€å•çš„è‹±è¯­ã€‚å¦‚
æœä½ å‘ç°è‡ªå·±ç»å¸¸è¿™æ ·åšï¼Œä½ å¯èƒ½æƒ³è¦æ›´æ·±å…¥åœ°äº†è§£ CSS é€‰æ‹©å™¨ã€‚æˆ‘
ä»¬æ¨èä½ ä»æœ‰è¶£çš„ \href{https://flukeout.github.io/}{CSS dinner}
æ•™ç¨‹å¼€å§‹ï¼Œç„¶åå‚è€ƒ
\href{https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors}{MDN
web docs}ã€‚

\section{æ•´åˆ}\label{ux6574ux5408}

è®©æˆ‘ä»¬å°†è¿™äº›å†…å®¹æ•´åˆèµ·æ¥ä»¥æŠ“å–ä¸€äº›ç½‘ç«™ã€‚è¿™
äº›ç¤ºä¾‹åœ¨ä½ è¿è¡Œå®ƒä»¬æ—¶å¯èƒ½ä¸å†æœ‰æ•ˆï¼Œè¿™æ˜¯ç½‘é¡µæŠ“å–çš„åŸºæœ¬æŒ‘æˆ˜ï¼›å¦‚æœç½‘ç«™çš„ç»“æ„å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦æ›´æ”¹ä½ çš„æŠ“å–ä»£ç ã€‚

\subsection{æ˜Ÿçƒå¤§æˆ˜}\label{ux661fux7403ux5927ux6218}

rveståœ¨\texttt{vignette("starwars")}ä¸­åŒ…å«ä¸€ä¸ªéå¸¸ç®€å•çš„ç¤ºä¾‹ã€‚è¿™
æ˜¯ä¸€ä¸ªç®€å•çš„é¡µé¢ï¼ŒHTML å†…å®¹å¾ˆå°‘ï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚æˆ‘
é¼“åŠ±ä½ ç°åœ¨å°±å¯¼èˆªåˆ°é‚£ä¸ªé¡µé¢ï¼Œå¹¶ä½¿ç”¨''Inspect Element''
æ¥æ£€æŸ¥ä¸€ä¸ªæ ‡é¢˜ï¼Œè¯¥æ ‡é¢˜æ˜¯æ˜Ÿçƒå¤§æˆ˜ç”µå½±çš„åç§°ã€‚ä½¿ ç”¨é”®ç›˜æˆ–é¼ æ ‡æ¢ç´¢ HTML
çš„å±‚æ¬¡ç»“æ„ï¼Œçœ‹çœ‹ä½ æ˜¯å¦èƒ½æ„Ÿè§‰åˆ°æ¯éƒ¨ç”µå½±ä½¿ç”¨çš„å…±äº«ç»“æ„ã€‚

ä½ åº”è¯¥èƒ½å¤Ÿçœ‹åˆ°æ¯éƒ¨ç”µå½±éƒ½æœ‰ä¸€ä¸ªå…±äº«çš„ç»“æ„ï¼Œçœ‹èµ·æ¥åƒè¿™æ ·ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\DataTypeTok{\textless{}}\KeywordTok{section}\DataTypeTok{\textgreater{}}
  \DataTypeTok{\textless{}}\KeywordTok{h2}\OtherTok{ data{-}id}\OperatorTok{=}\StringTok{"1"}\DataTypeTok{\textgreater{}}\NormalTok{The Phantom Menace}\DataTypeTok{\textless{}/}\KeywordTok{h2}\DataTypeTok{\textgreater{}}
  \DataTypeTok{\textless{}}\KeywordTok{p}\DataTypeTok{\textgreater{}}\NormalTok{Released: 1999{-}05{-}19}\DataTypeTok{\textless{}/}\KeywordTok{p}\DataTypeTok{\textgreater{}}
  \DataTypeTok{\textless{}}\KeywordTok{p}\DataTypeTok{\textgreater{}}\NormalTok{Director: }\DataTypeTok{\textless{}}\KeywordTok{span}\OtherTok{ class}\OperatorTok{=}\StringTok{"director"}\DataTypeTok{\textgreater{}}\NormalTok{George Lucas}\DataTypeTok{\textless{}/}\KeywordTok{span}\DataTypeTok{\textgreater{}\textless{}/}\KeywordTok{p}\DataTypeTok{\textgreater{}}
  
  \DataTypeTok{\textless{}}\KeywordTok{div}\OtherTok{ class}\OperatorTok{=}\StringTok{"crawl"}\DataTypeTok{\textgreater{}}
    \DataTypeTok{\textless{}}\KeywordTok{p}\DataTypeTok{\textgreater{}}\NormalTok{...}\DataTypeTok{\textless{}/}\KeywordTok{p}\DataTypeTok{\textgreater{}}
    \DataTypeTok{\textless{}}\KeywordTok{p}\DataTypeTok{\textgreater{}}\NormalTok{...}\DataTypeTok{\textless{}/}\KeywordTok{p}\DataTypeTok{\textgreater{}}
    \DataTypeTok{\textless{}}\KeywordTok{p}\DataTypeTok{\textgreater{}}\NormalTok{...}\DataTypeTok{\textless{}/}\KeywordTok{p}\DataTypeTok{\textgreater{}}
  \DataTypeTok{\textless{}/}\KeywordTok{div}\DataTypeTok{\textgreater{}}
\DataTypeTok{\textless{}/}\KeywordTok{section}\DataTypeTok{\textgreater{}}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å°†è¿™äº›æ•°æ®è½¬æ¢ä¸ºä¸€ä¸ªåŒ…å«7è¡Œçš„æ•°æ®æ¡†ï¼Œå˜é‡åŒ…æ‹¬
\texttt{title}ã€\texttt{year}ã€\texttt{director}å’Œ \texttt{intro}ã€‚é¦–
å…ˆï¼Œæˆ‘ä»¬å°†è¯»å–HTMLå¹¶æå–æ‰€æœ‰çš„\texttt{\textless{}section\textgreater{}}å…ƒç´ ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{url }\OtherTok{\textless{}{-}} \StringTok{"https://rvest.tidyverse.org/articles/starwars.html"}
\NormalTok{html }\OtherTok{\textless{}{-}} \FunctionTok{read\_html}\NormalTok{(url)}

\NormalTok{section }\OtherTok{\textless{}{-}}\NormalTok{ html }\SpecialCharTok{|\textgreater{}} \FunctionTok{html\_elements}\NormalTok{(}\StringTok{"section"}\NormalTok{)}
\NormalTok{section}
\CommentTok{\#\textgreater{} \{xml\_nodeset (7)\}}
\CommentTok{\#\textgreater{} [1] \textless{}section\textgreater{}\textless{}h2 data{-}id="1"\textgreater{}\textbackslash{}nThe Phantom Menace\textbackslash{}n\textless{}/h2\textgreater{}\textbackslash{}n\textless{}p\textgreater{}\textbackslash{}nReleased: 1 ...}
\CommentTok{\#\textgreater{} [2] \textless{}section\textgreater{}\textless{}h2 data{-}id="2"\textgreater{}\textbackslash{}nAttack of the Clones\textbackslash{}n\textless{}/h2\textgreater{}\textbackslash{}n\textless{}p\textgreater{}\textbackslash{}nReleased: ...}
\CommentTok{\#\textgreater{} [3] \textless{}section\textgreater{}\textless{}h2 data{-}id="3"\textgreater{}\textbackslash{}nRevenge of the Sith\textbackslash{}n\textless{}/h2\textgreater{}\textbackslash{}n\textless{}p\textgreater{}\textbackslash{}nReleased:  ...}
\CommentTok{\#\textgreater{} [4] \textless{}section\textgreater{}\textless{}h2 data{-}id="4"\textgreater{}\textbackslash{}nA New Hope\textbackslash{}n\textless{}/h2\textgreater{}\textbackslash{}n\textless{}p\textgreater{}\textbackslash{}nReleased: 1977{-}05{-}2 ...}
\CommentTok{\#\textgreater{} [5] \textless{}section\textgreater{}\textless{}h2 data{-}id="5"\textgreater{}\textbackslash{}nThe Empire Strikes Back\textbackslash{}n\textless{}/h2\textgreater{}\textbackslash{}n\textless{}p\textgreater{}\textbackslash{}nReleas ...}
\CommentTok{\#\textgreater{} [6] \textless{}section\textgreater{}\textless{}h2 data{-}id="6"\textgreater{}\textbackslash{}nReturn of the Jedi\textbackslash{}n\textless{}/h2\textgreater{}\textbackslash{}n\textless{}p\textgreater{}\textbackslash{}nReleased: 1 ...}
\CommentTok{\#\textgreater{} [7] \textless{}section\textgreater{}\textless{}h2 data{-}id="7"\textgreater{}\textbackslash{}nThe Force Awakens\textbackslash{}n\textless{}/h2\textgreater{}\textbackslash{}n\textless{}p\textgreater{}\textbackslash{}nReleased: 20 ...}
\end{Highlighting}
\end{Shaded}

è¿™è·å–äº†ä¸é¡µé¢ä¸Šæ‰¾åˆ°çš„ä¸ƒéƒ¨ç”µå½±ç›¸åŒ¹é…çš„ä¸ƒä¸ªå…ƒç´ ï¼Œè¿™è¡¨æ˜ä½¿ç”¨\texttt{section}ä½œä¸ºé€‰æ‹©å™¨æ˜¯åˆé€‚çš„ã€‚ç”±
äºæ•°æ®æ€»æ˜¯åœ¨æ–‡æœ¬ä¸­æ‰¾åˆ°ï¼Œæå–å•ä¸ªå…ƒç´ æ˜¯å¾ˆç›´æ¥çš„ï¼Œåªæ˜¯éœ€è¦æ‰¾åˆ°æ­£ç¡®çš„é€‰æ‹©å™¨ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{section }\SpecialCharTok{|\textgreater{}} \FunctionTok{html\_element}\NormalTok{(}\StringTok{"h2"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} \FunctionTok{html\_text2}\NormalTok{()}
\CommentTok{\#\textgreater{} [1] "The Phantom Menace"      "Attack of the Clones"   }
\CommentTok{\#\textgreater{} [3] "Revenge of the Sith"     "A New Hope"             }
\CommentTok{\#\textgreater{} [5] "The Empire Strikes Back" "Return of the Jedi"     }
\CommentTok{\#\textgreater{} [7] "The Force Awakens"}

\NormalTok{section }\SpecialCharTok{|\textgreater{}} \FunctionTok{html\_element}\NormalTok{(}\StringTok{".director"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} \FunctionTok{html\_text2}\NormalTok{()}
\CommentTok{\#\textgreater{} [1] "George Lucas"     "George Lucas"     "George Lucas"    }
\CommentTok{\#\textgreater{} [4] "George Lucas"     "Irvin Kershner"   "Richard Marquand"}
\CommentTok{\#\textgreater{} [7] "J. J. Abrams"}
\end{Highlighting}
\end{Shaded}

ä¸€æ—¦æˆ‘ä»¬å¯¹æ¯ä¸ªç»„ä»¶éƒ½å®Œæˆäº†è¿™äº›æ“ä½œï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†æ‰€æœ‰ç»“æœåŒ…è£…æˆä¸€ä¸ªtibbleï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{title =}\NormalTok{ section }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{html\_element}\NormalTok{(}\StringTok{"h2"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{html\_text2}\NormalTok{(),}
  \AttributeTok{released =}\NormalTok{ section }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{html\_element}\NormalTok{(}\StringTok{"p"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{html\_text2}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{str\_remove}\NormalTok{(}\StringTok{"Released: "}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{parse\_date}\NormalTok{(),}
  \AttributeTok{director =}\NormalTok{ section }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{html\_element}\NormalTok{(}\StringTok{".director"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{html\_text2}\NormalTok{(),}
  \AttributeTok{intro =}\NormalTok{ section }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{html\_element}\NormalTok{(}\StringTok{".crawl"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{html\_text2}\NormalTok{()}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 7 x 4}
\CommentTok{\#\textgreater{}   title                   released   director         intro                  }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}                   \textless{}date\textgreater{}     \textless{}chr\textgreater{}            \textless{}chr\textgreater{}                  }
\CommentTok{\#\textgreater{} 1 The Phantom Menace      1999{-}05{-}19 George Lucas     "Turmoil has engulfed \textasciitilde{}}
\CommentTok{\#\textgreater{} 2 Attack of the Clones    2002{-}05{-}16 George Lucas     "There is unrest in th\textasciitilde{}}
\CommentTok{\#\textgreater{} 3 Revenge of the Sith     2005{-}05{-}19 George Lucas     "War! The Republic is \textasciitilde{}}
\CommentTok{\#\textgreater{} 4 A New Hope              1977{-}05{-}25 George Lucas     "It is a period of civ\textasciitilde{}}
\CommentTok{\#\textgreater{} 5 The Empire Strikes Back 1980{-}05{-}17 Irvin Kershner   "It is a dark time for\textasciitilde{}}
\CommentTok{\#\textgreater{} 6 Return of the Jedi      1983{-}05{-}25 Richard Marquand "Luke Skywalker has re\textasciitilde{}}
\CommentTok{\#\textgreater{} \# i 1 more row}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å¯¹\texttt{released}è¿›è¡Œäº†ä¸€äº›é¢å¤–çš„å¤„ç†ï¼Œä»¥ä¾¿å¾—åˆ°ä¸€ä¸ªå˜é‡ï¼Œè¿™ä¸ªå˜é‡å°†åœ¨æˆ‘ä»¬åç»­çš„åˆ†æä¸­æ›´å®¹æ˜“ä½¿ç”¨ã€‚

\subsection{IMDB é¡¶çº§ç”µå½±}\label{imdb-ux9876ux7ea7ux7535ux5f71}

å¯¹äºä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œæˆ‘ä»¬å°†è§£å†³ä¸€ä¸ªç¨å¾®æ£˜æ‰‹ä¸€ç‚¹çš„é—®é¢˜ï¼Œå³ä»äº’è”ç½‘ç”µå½±æ•°æ®åº“ï¼ˆIMDbï¼‰ä¸­æå–å‰250éƒ¨ç”µå½±ã€‚åœ¨
æˆ‘ä»¬æ’°å†™æœ¬ç« æ—¶ï¼Œè¯¥é¡µé¢çœ‹èµ·æ¥åƒè¿™æ · å›¾~\ref{fig-scraping-imdb} ã€‚

\begin{figure}

\centering{

\includegraphics[width=4.35in,height=\textheight]{screenshots/scraping-imdb.png}

}

\caption{\label{fig-scraping-imdb}Screenshot of the IMDb top movies web
page taken on 2022-12-05.}

\end{figure}%

è¿™äº›æ•°æ®æœ‰ä¸€ä¸ªæ¸…æ™°çš„è¡¨æ ¼ç»“æ„ï¼Œæ‰€ä»¥å€¼å¾—ä»\texttt{html\_table()}å¼€å§‹:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# url \textless{}{-} "https://web.archive.org/web/20220201012049/https://www.imdb.com/chart/top/"}
\CommentTok{\# html \textless{}{-} read\_html(url)}
\CommentTok{\# }
\CommentTok{\# table \textless{}{-} html |\textgreater{} }
\CommentTok{\#   html\_element("table") |\textgreater{} }
\CommentTok{\#   html\_table()}
\CommentTok{\# table}
\end{Highlighting}
\end{Shaded}

è¿™åŒ…æ‹¬ä¸€äº›ç©ºåˆ—ï¼Œä½†æ€»ä½“ä¸Šå¾ˆå¥½åœ°æ•è·äº†è¡¨æ ¼ä¸­çš„ä¿¡æ¯ã€‚ç„¶
è€Œï¼Œä¸ºäº†ä½¿å®ƒæ›´å®¹æ˜“ä½¿ç”¨ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œæ›´å¤šçš„å¤„ç†ã€‚é¦–
å…ˆï¼Œæˆ‘ä»¬å°†é‡å‘½ååˆ—ä»¥ä¾¿äºæ“ä½œï¼Œå¹¶åˆ é™¤æ’åå’Œæ ‡é¢˜ä¸­çš„å¤šä½™ç©ºæ ¼ã€‚æˆ‘
ä»¬å°†ä½¿ç”¨\texttt{select()}ï¼ˆè€Œä¸æ˜¯\texttt{rename()}ï¼‰æ¥ä¸€æ­¥å®Œæˆè¿™ä¸¤ä¸ªåˆ—çš„é‡å‘½åå’Œé€‰æ‹©ã€‚ç„¶
åæˆ‘ä»¬å°†åˆ é™¤æ¢è¡Œç¬¦å’Œå¤šä½™çš„ç©ºæ ¼ï¼Œæ¥ç€ä½¿ç”¨\texttt{separate\_wider\_regex()}ï¼ˆæ¥è‡ª
å°èŠ‚~\ref{sec-extract-variables}
ï¼‰æ¥å°†æ ‡é¢˜ã€å¹´ä»½å’Œæ’åæå–åˆ°å®ƒä»¬è‡ªå·±çš„å˜é‡ä¸­ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ratings \textless{}{-} table |\textgreater{}}
\CommentTok{\#   select(}
\CommentTok{\#     rank\_title\_year = \textasciigrave{}Rank \& Title\textasciigrave{},}
\CommentTok{\#     rating = \textasciigrave{}IMDb Rating\textasciigrave{}}
\CommentTok{\#   ) |\textgreater{} }
\CommentTok{\#   mutate(}
\CommentTok{\#     rank\_title\_year = str\_replace\_all(rank\_title\_year, "\textbackslash{}n +", " ")}
\CommentTok{\#   ) |\textgreater{} }
\CommentTok{\#   separate\_wider\_regex(}
\CommentTok{\#     rank\_title\_year,}
\CommentTok{\#     patterns = c(}
\CommentTok{\#       rank = "\textbackslash{}\textbackslash{}d+", "\textbackslash{}\textbackslash{}. ",}
\CommentTok{\#       title = ".+", " +\textbackslash{}\textbackslash{}(",}
\CommentTok{\#       year = "\textbackslash{}\textbackslash{}d+", "\textbackslash{}\textbackslash{})"}
\CommentTok{\#     )}
\CommentTok{\#   )}
\CommentTok{\# ratings}
\end{Highlighting}
\end{Shaded}

å³ä½¿åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¤§éƒ¨åˆ†æ•°æ®éƒ½æ¥è‡ªè¡¨æ ¼å•å…ƒæ ¼ï¼ŒæŸ¥çœ‹åŸå§‹HTMLä»ç„¶æ˜¯æœ‰ä»·å€¼çš„ã€‚å¦‚
æœä½ è¿™æ ·åšï¼Œä½ ä¼šå‘ç°æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…¶ä¸­ä¸€ä¸ªå±æ€§æ¥æ·»åŠ ä¸€äº›é¢å¤–çš„æ•°æ®ã€‚è¿™
æ­£æ˜¯å€¼å¾—èŠ±ä¸€ç‚¹æ—¶é—´å»æ¢ç´¢é¡µé¢æºä»£ç çš„åŸå› ä¹‹ä¸€ï¼›ä½ å¯èƒ½ä¼šå‘ç°é¢å¤–çš„æ•°æ®ï¼Œæˆ–è€…æ‰¾åˆ°ç¨å¾®ç®€å•ä¸€äº›çš„è§£æè·¯å¾„ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{html }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{html\_elements}\NormalTok{(}\StringTok{"td strong"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{head}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{html\_attr}\NormalTok{(}\StringTok{"title"}\NormalTok{)}
\CommentTok{\#\textgreater{} character(0)}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸è¡¨æ ¼æ•°æ®ç»“åˆèµ·æ¥ï¼Œå¹¶å†æ¬¡åº”ç”¨\texttt{separate\_wider\_regex()}å‡½æ•°æ¥æå–æˆ‘ä»¬å…³å¿ƒçš„æ•°æ®éƒ¨åˆ†ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ratings |\textgreater{}}
\CommentTok{\#   mutate(}
\CommentTok{\#     rating\_n = html |\textgreater{} html\_elements("td strong") |\textgreater{} html\_attr("title")}
\CommentTok{\#   ) |\textgreater{} }
\CommentTok{\#   separate\_wider\_regex(}
\CommentTok{\#     rating\_n,}
\CommentTok{\#     patterns = c(}
\CommentTok{\#       "[0{-}9.]+ based on ",}
\CommentTok{\#       number = "[0{-}9,]+",}
\CommentTok{\#       " user ratings"}
\CommentTok{\#     )}
\CommentTok{\#   ) |\textgreater{} }
\CommentTok{\#   mutate(}
\CommentTok{\#     number = parse\_number(number)}
\CommentTok{\#   )}
\end{Highlighting}
\end{Shaded}

\section{åŠ¨æ€ç½‘ç«™}\label{ux52a8ux6001ux7f51ux7ad9}

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨çš„æ˜¯é‚£äº›\texttt{html\_elements()}è¿”å›ä½ åœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°çš„å†…å®¹çš„ç½‘ç«™ï¼Œå¹¶è®¨è®ºäº†å¦‚ä½•è§£æè¿™äº›è¿”å›çš„å†…å®¹ä»¥åŠå¦‚ä½•åœ¨æ•´é½çš„æ•°æ®æ¡†ä¸­ç»„ç»‡è¿™äº›ä¿¡æ¯ã€‚ç„¶
è€Œï¼Œæœ‰æ—¶ä½ ä¼šé‡åˆ°\texttt{html\_elements()}åŠå…¶ç›¸å…³å‡½æ•°è¿”å›çš„å†…å®¹ä¸ä½ åœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°çš„å†…å®¹æˆªç„¶ä¸åŒçš„æƒ…å†µã€‚åœ¨
å¾ˆå¤šæƒ…å†µä¸‹ï¼Œè¿™æ˜¯å› ä¸ºä½ è¯•å›¾æŠ“å–çš„æ˜¯ä½¿ç”¨javascriptåŠ¨æ€ç”Ÿæˆé¡µé¢å†…å®¹çš„ç½‘ç«™ã€‚è¿™
åœ¨ç›®å‰ä¸èƒ½ä¸\texttt{rvest}ä¸€èµ·å·¥ä½œï¼Œå› ä¸º\texttt{rvest}ä¸‹è½½çš„æ˜¯åŸå§‹çš„HTMLï¼Œå¹¶ä¸è¿è¡Œä»»ä½•javascriptã€‚

å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶æœ‰å¯èƒ½æŠ“å–è¿™äº›ç±»å‹çš„ç½‘ç«™ï¼Œä½†\texttt{rvest}éœ€è¦ä½¿ç”¨ä¸€ä¸ªæ›´å¤æ‚çš„è¿‡ç¨‹ï¼šå®Œå…¨æ¨¡æ‹Ÿç½‘ç»œæµè§ˆå™¨ï¼ŒåŒ…æ‹¬è¿è¡Œæ‰€æœ‰çš„javascriptã€‚åœ¨
æ’°å†™æœ¬æ–‡æ—¶ï¼Œè¿™ä¸€åŠŸèƒ½å°šæœªå¯ç”¨ï¼Œä½†è¿™æ˜¯æˆ‘ä»¬æ­£åœ¨ç§¯æå¼€å‘çš„å†…å®¹ï¼Œå¹¶ä¸”å¯èƒ½åœ¨ä½ é˜…è¯»æœ¬æ–‡æ—¶å·²ç»å¯ç”¨ã€‚å®ƒ
ä½¿ç”¨\href{https://rstudio.github.io/chromote/index.html}{chromote}
åŒ…ï¼Œè¯¥åŒ…å®é™…ä¸Šåœ¨åå°è¿è¡ŒChromeæµè§ˆå™¨ï¼Œå¹¶ä¸ºä½ æä¾›äº†ä¸ç½‘ç«™äº¤äº’çš„é¢å¤–å·¥å…·ï¼Œå°±åƒäººç±»ä¸€æ ·è¾“å…¥æ–‡æœ¬å’Œç‚¹å‡»æŒ‰é’®ã€‚æ›´
å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹\href{http://rvest.tidyverse.org/}{rvest website}ã€‚

\section{å°ç»“}\label{ux5c0fux7ed3-23}

åœ¨æœ¬ç« ä¸­ï¼Œä½ å­¦ä¹ äº†ä»ç½‘é¡µæŠ“å–æ•°æ®çš„åŸå› ã€ä¸ºä»€ä¹ˆä¸å¯ä»¥ä»¥åŠå¦‚ä½•æŠ“å–ã€‚é¦–
å…ˆï¼Œå­¦ä¹ äº†HTMLçš„åŸºç¡€çŸ¥è¯†ä»¥åŠå¦‚ä½•ä½¿ç”¨CSSé€‰æ‹©å™¨æ¥å¼•ç”¨ç‰¹å®šçš„å…ƒç´ ï¼Œç„¶åå­¦ä¹ äº†ä½¿ç”¨\texttt{rvest}åŒ…å°†HTMLä¸­çš„æ•°æ®å¯¼å…¥Rã€‚æ¥
ç€ï¼Œæˆ‘ä»¬é€šè¿‡ä¸¤ä¸ªæ¡ˆä¾‹ç ”ç©¶æ¥å±•ç¤ºç½‘é¡µæŠ“å–ï¼šä¸€ä¸ªæ›´ç®€å•çš„åœºæ™¯æ˜¯ä»\texttt{rvest}åŒ…ç½‘ç«™æŠ“å–å…³äºã€Šæ˜Ÿçƒå¤§æˆ˜ã€‹ç”µå½±çš„æ•°æ®ï¼Œä»¥åŠä¸€ä¸ªæ›´å¤æ‚çš„åœºæ™¯æ˜¯ä»IMDBæŠ“å–å‰250éƒ¨ç”µå½±çš„æ•°æ®ã€‚

ä»ç½‘é¡µä¸ŠæŠ“å–æ•°æ®çš„æŠ€æœ¯ç»†èŠ‚å¯èƒ½ä¼šå¾ˆå¤æ‚ï¼Œå°¤å…¶æ˜¯å½“å¤„ç†åŠ¨æ€ç”Ÿæˆçš„ç½‘ç«™æ—¶ï¼Œä½†æ³•å¾‹å’Œé“å¾·è€ƒè™‘å¯èƒ½æ›´ä¸ºå¤æ‚ã€‚åœ¨
ç€æ‰‹æŠ“å–æ•°æ®ä¹‹å‰ï¼Œä½ éœ€è¦å¯¹è¿™ä¸¤æ–¹é¢éƒ½æœ‰æ‰€äº†è§£ã€‚

ä½ å·²ç»å­¦ä¹ äº†å°†æ•°æ®ä»å…¶åŸå§‹ä½ç½®ï¼ˆç”µå­è¡¨æ ¼ã€æ•°æ®åº“ã€JSONæ–‡ä»¶å’Œç½‘ç«™ï¼‰ä»¥æ•´é½çš„å½¢å¼å¯¼å…¥Rä¸­çš„æŠ€æœ¯ï¼Œè¿™æ ‡å¿—ç€æˆ‘ä»¬å®Œæˆäº†æœ¬ä¹¦ä¸­å…³äºæ•°æ®å¯¼å…¥çš„å†…å®¹ã€‚ç°
åœ¨ï¼Œæ˜¯æ—¶å€™å°†ç›®å…‰æŠ•å‘ä¸€ä¸ªæ–°çš„ä¸»é¢˜äº†: å……åˆ†åˆ©ç”¨Rä½œä¸ºä¸€ç§ç¼–ç¨‹è¯­è¨€ã€‚

\part{ç¼–ç¨‹}

åœ¨è¿™æœ¬ä¹¦çš„è¿™ä¸€éƒ¨åˆ†ï¼Œä½ å°†æé«˜ä½ çš„ç¼–ç¨‹æŠ€èƒ½ã€‚ç¼–
ç¨‹æ˜¯ä¸€é¡¹è·¨é¢†åŸŸæŠ€èƒ½ï¼Œå¯¹äºæ‰€æœ‰æ•°æ®ç§‘å­¦å·¥ä½œéƒ½æ˜¯å¿…éœ€çš„ï¼šä½ å¿…é¡»ä½¿ç”¨è®¡ç®—æœºæ¥è¿›è¡Œæ•°æ®ç§‘å­¦å·¥ä½œï¼›ä½ ä¸èƒ½ä»…å‡­å¤§è„‘ã€é“…ç¬”å’Œçº¸æ¥å®Œæˆå®ƒã€‚

\begin{figure}

\centering{

\includegraphics[width=5.57in,height=\textheight]{diagrams/data-science/program.png}

}

\caption{\label{fig-ds-program}Programming is the water in which all the
other components swim.}

\end{figure}%

ç¼–ç¨‹äº§ç”Ÿä»£ç ï¼Œè€Œä»£ç æ˜¯ä¸€ç§æ²Ÿé€šå·¥å…·ã€‚æ˜¾
ç„¶ï¼Œä»£ç å‘Šè¯‰è®¡ç®—æœºä½ æƒ³è¦å®ƒåšä»€ä¹ˆã€‚ä½† å®ƒä¹Ÿå‘å…¶ä»–äººç±»ä¼ è¾¾äº†æ„ä¹‰ã€‚å°†
ä»£ç è§†ä¸ºæ²Ÿé€šçš„å·¥å…·å¾ˆé‡è¦ï¼Œå› ä¸ºä½ æ‰€åšçš„æ¯ä¸€ä¸ªé¡¹ç›®æœ¬è´¨ä¸Šéƒ½æ˜¯åä½œçš„ã€‚å³
ä½¿ä½ æ²¡æœ‰å’Œå…¶ä»–äººä¸€èµ·å·¥ä½œï¼Œä½ ä¹Ÿä¸€å®šä¼šå’Œæœªæ¥çš„è‡ªå·±ä¸€èµ·å·¥ä½œï¼ç¼–
å†™æ¸…æ™°çš„ä»£ç å¾ˆé‡è¦ï¼Œè¿™æ ·å…¶ä»–äººï¼ˆæ¯”å¦‚æœªæ¥çš„ä½ ï¼‰å°±èƒ½ç†è§£ä½ ä¸ºä»€ä¹ˆä»¥è¿™ç§æ–¹å¼è¿›è¡Œåˆ†æã€‚è¿™
æ„å‘³ç€æé«˜ç¼–ç¨‹æŠ€èƒ½ä¹Ÿæ¶‰åŠåˆ°æé«˜æ²Ÿé€šæŠ€å·§ã€‚éš
ç€æ—¶é—´çš„æ¨ç§»ï¼Œä½ å¸Œæœ›ä½ çš„ä»£ç ä¸ä»…æ›´å®¹æ˜“ç¼–å†™ï¼Œè€Œä¸”æ›´å®¹æ˜“è®©ä»–äººé˜…è¯»ã€‚

åœ¨æ¥ä¸‹æ¥çš„ä¸‰ç« ä¸­ï¼Œä½ å°†å­¦ä¹ æé«˜ç¼–ç¨‹æŠ€èƒ½çš„æ–¹æ³•ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  å¤åˆ¶ç²˜è´´æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œä½†ä½ åº”è¯¥é¿å…ä½¿ç”¨è¶…è¿‡ä¸¤æ¬¡ã€‚åœ¨
  ä»£ç ä¸­é‡å¤è‡ªå·±æ˜¯å¾ˆå±é™©çš„ï¼Œå› ä¸ºå®ƒå¾ˆå®¹æ˜“å¯¼è‡´é”™è¯¯å’Œä¸ä¸€è‡´ã€‚ç›¸ åï¼Œåœ¨
  ç« èŠ‚~\ref{sec-functions}
  ä¸­ä½ å°†å­¦ä¹ å¦‚ä½•ç¼–å†™\textbf{å‡½æ•°}ï¼Œè¿™äº›å‡½æ•°å¯ä»¥è®©ä½ æå–å‡ºé‡å¤çš„tidyverseä»£ç ï¼Œä»¥ä¾¿è½»æ¾åœ°é‡å¤ä½¿ç”¨ã€‚
\item
  å‡½æ•°å¯ä»¥æå–å‡ºé‡å¤çš„ä»£ç ï¼Œä½†ä½ ç»å¸¸éœ€è¦å¯¹ä¸åŒçš„è¾“å…¥é‡å¤ç›¸åŒçš„æ“ä½œã€‚ä½ 
  éœ€è¦è¿­ä»£å·¥å…·æ¥è®©ä½ ä¸€æ¬¡åˆä¸€æ¬¡åœ°åšç±»ä¼¼çš„äº‹æƒ…ã€‚è¿™
  äº›å·¥å…·åŒ…æ‹¬forå¾ªç¯å’Œå‡½æ•°å¼ç¼–ç¨‹ï¼Œä½ å°†åœ¨@sec-iteration å­¦ä¹ å®ƒä»¬ã€‚
\item
  å½“ä½ é˜…è¯»æ›´å¤šç”±ä»–äººç¼–å†™çš„ä»£ç æ—¶ï¼Œä½ ä¼šçœ‹åˆ°æ›´å¤šä¸ä½¿ç”¨tidyverseçš„ä»£ç ã€‚åœ¨
  ç« èŠ‚~\ref{sec-base-r}
  ä¸­ä½ å°†å­¦ä¹ ä¸€äº›åœ¨å®é™…æƒ…å†µä¸­ä½ ä¼šçœ‹åˆ°çš„æœ€é‡è¦çš„åŸºç¡€Rå‡½æ•°ã€‚
\end{enumerate}

è¿™äº›ç« èŠ‚çš„ç›®çš„æ˜¯æ•™ä½ æ•°æ®ç§‘å­¦æ‰€éœ€çš„æœ€åŸºæœ¬çš„ç¼–ç¨‹çŸ¥è¯†ã€‚ä¸€
æ—¦ä½ æŒæ¡äº†è¿™é‡Œçš„å†…å®¹ï¼Œæˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½ ç»§ç»­æŠ•èµ„äºä½ çš„ç¼–ç¨‹æŠ€èƒ½ã€‚æˆ‘
ä»¬å†™äº†ä¸¤æœ¬ä¹¦ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—å¾ˆæœ‰å¸®åŠ©ã€‚G arrett
Grolemundçš„ã€Š\href{https://rstudio-education.github.io/hopr/}{Hands on
Programming with
R}ã€‹æ˜¯ä¸€æœ¬ä»‹ç»Rä½œä¸ºç¼–ç¨‹è¯­è¨€çš„å…¥é—¨ä¹¦ç±ï¼Œå¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡å­¦ä¹ ç¼–ç¨‹è¯­è¨€ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚H
adley Wickhamçš„ã€Š\href{https://adv-r.hadley.nz/}{Advanced
R}ã€‹æ·±å…¥æ¢è®¨äº†Rç¼–ç¨‹è¯­è¨€çš„ç»†èŠ‚ï¼›å¦‚æœä½ å·²ç»æœ‰ç¼–ç¨‹ç»éªŒï¼Œå¹¶ä¸”å·²ç»æŒæ¡äº†è¿™äº›ç« èŠ‚ä¸­çš„æ€æƒ³ï¼Œé‚£ä¹ˆå®ƒæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹å’Œè¿›ä¸€æ­¥æå‡ç¼–ç¨‹èƒ½åŠ›çš„ç»ä½³é€‰æ‹©ã€‚

\chapter{å‡½æ•°}\label{sec-functions}

\section{å¼•è¨€}\label{ux5f15ux8a00-20}

æ•°æ®ç§‘å­¦å®¶æé«˜å½±å“åŠ›çš„ä¸€ç§æœ€ä½³æ–¹å¼å°±æ˜¯ç¼–å†™å‡½æ•°ã€‚å‡½
æ•°å…è®¸ä½ ä»¥ä¸€ç§æ›´å¼ºå¤§å’Œé€šç”¨çš„æ–¹å¼è‡ªåŠ¨åŒ–å¸¸è§ä»»åŠ¡ï¼Œè¿™æ¯”å¤åˆ¶ç²˜è´´æ›´ä¸ºé«˜æ•ˆã€‚ä¸
å¤åˆ¶ç²˜è´´ç›¸æ¯”ï¼Œç¼–å†™å‡½æ•°å…·æœ‰å››å¤§ä¼˜åŠ¿ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  å¯ä»¥ç»™å‡½æ•°èµ·ä¸€ä¸ªå¯Œæœ‰è¡¨ç°åŠ›çš„åå­—ï¼Œä½¿ä½ çš„ä»£ç æ›´å®¹æ˜“ç†è§£ã€‚
\item
  éšç€éœ€æ±‚çš„å˜åŒ–ï¼Œä½ åªéœ€è¦åœ¨ä¸€ä¸ªåœ°æ–¹æ›´æ–°ä»£ç ï¼Œè€Œä¸æ˜¯åœ¨å¤šä¸ªåœ°æ–¹ã€‚
\item
  æ¶ˆé™¤äº†åœ¨å¤åˆ¶ç²˜è´´æ—¶å¯èƒ½å‘ç”Ÿçš„å¶ç„¶é”™è¯¯
  (ä¾‹å¦‚åœ¨ä¸€ä¸ªåœ°æ–¹æ›´æ–°äº†å˜é‡åï¼Œä½†åœ¨å¦ä¸€ä¸ªåœ°æ–¹æ²¡æœ‰) ã€‚
\item
  ä½¿å¾—é¡¹ç›®ä¹‹é—´çš„å·¥ä½œé‡ç”¨å˜å¾—æ›´åŠ å®¹æ˜“ï¼Œéšç€æ—¶é—´æ¨ç§»æé«˜äº†ç”Ÿäº§æ•ˆç‡ã€‚
\end{enumerate}

ä¸€ä¸ªç»éªŒæ³•åˆ™æ˜¯ï¼šå½“ä½ å¤åˆ¶ç²˜è´´ä¸€å—ä»£ç è¶…è¿‡ä¸¤æ¬¡æ—¶ (å³ç°åœ¨æœ‰ä¸‰ä»½ç›¸åŒçš„ä»£ç )
å°±åº”è¯¥è€ƒè™‘ç¼–å†™ä¸€ä¸ªå‡½æ•°ã€‚åœ¨ æœ¬ç« ä¸­ï¼Œä½ å°†å­¦ä¹ ä¸‰ç§æœ‰ç”¨çš„å‡½æ•°ç±»å‹ï¼š

\begin{itemize}
\tightlist
\item
  å‘é‡å‡½æ•° æ¥å—ä¸€ä¸ªæˆ–å¤šä¸ªå‘é‡ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¿”å›ä¸€ä¸ªå‘é‡ä½œä¸ºè¾“å‡ºã€‚
\item
  æ•°æ®æ¡†å‡½æ•° æ¥å—ä¸€ä¸ªæ•°æ®æ¡†ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ•°æ®æ¡†ä½œä¸ºè¾“å‡ºã€‚
\item
  ç»˜å›¾å‡½æ•° æ¥å—ä¸€ä¸ªæ•°æ®æ¡†ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¿”å›ä¸€ä¸ªå›¾å½¢ä½œä¸ºè¾“å‡ºã€‚
\end{itemize}

æ¯ä¸ªéƒ¨åˆ†éƒ½åŒ…å«äº†è®¸å¤šç¤ºä¾‹ï¼Œä»¥å¸®åŠ©ä½ æ¦‚æ‹¬ä½ çœ‹åˆ°çš„æ¨¡å¼ã€‚æ²¡
æœ‰Twitterä¸Šæœ‹å‹ä»¬çš„å¸®åŠ©ï¼Œè¿™äº›ä¾‹å­æ˜¯ä¸å¯èƒ½å®ç°çš„ï¼Œæˆ‘ä»¬é¼“åŠ±ä½ ç‚¹å‡»è¯„è®ºä¸­çš„é“¾æ¥æŸ¥çœ‹åŸå§‹çµæ„Ÿæ¥æºã€‚ä½ 
å¯èƒ½è¿˜æƒ³é˜…è¯»å…³äº\href{https://twitter.com/hadleywickham/status/1571603361350164486}{general
functions}å’Œ\href{https://twitter.com/hadleywickham/status/1574373127349575680}{plotting
functions}çš„åŸå§‹æ¿€åŠ±æ¨æ–‡ï¼Œä»¥æŸ¥çœ‹æ›´å¤šçš„å‡½æ•°ç¤ºä¾‹ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-21}

æˆ‘ä»¬å°†æ•´ç†æ¥è‡ªtidyverseçš„å„ç§å‡½æ•°ã€‚åŒ
æ—¶ï¼Œæˆ‘ä»¬è¿˜å°†ä½¿ç”¨\texttt{nycflights13}æ•°æ®é›†ä½œä¸ºç†Ÿæ‚‰çš„æ•°æ®æºæ¥ä½¿ç”¨æˆ‘ä»¬çš„å‡½æ•°ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(nycflights13)}
\end{Highlighting}
\end{Shaded}

\section{å‘é‡å‡½æ•°}\label{ux5411ux91cfux51fdux6570}

æˆ‘ä»¬ä»å‘é‡å‡½æ•°å¼€å§‹:æ¥å—ä¸€ä¸ªæˆ–å¤šä¸ªå‘é‡å¹¶è¿”å›ä¸€ä¸ªå‘é‡ç»“æœçš„å‡½æ•°ã€‚ä¾‹
å¦‚ï¼Œè¯·çœ‹ä¸‹é¢çš„ä»£ç ã€‚å®ƒ æ˜¯åšä»€ä¹ˆçš„?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{a =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{5}\NormalTok{),}
  \AttributeTok{b =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{5}\NormalTok{),}
  \AttributeTok{c =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{5}\NormalTok{),}
  \AttributeTok{d =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{5}\NormalTok{),}
\NormalTok{)}

\NormalTok{df }\SpecialCharTok{|\textgreater{}} \FunctionTok{mutate}\NormalTok{(}
  \AttributeTok{a =}\NormalTok{ (a }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(a, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{/} 
\NormalTok{    (}\FunctionTok{max}\NormalTok{(a, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(a, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)),}
  \AttributeTok{b =}\NormalTok{ (b }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(b, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{/} 
\NormalTok{    (}\FunctionTok{max}\NormalTok{(b, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(a, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)),}
  \AttributeTok{c =}\NormalTok{ (c }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(c, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{/} 
\NormalTok{    (}\FunctionTok{max}\NormalTok{(c, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(c, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)),}
  \AttributeTok{d =}\NormalTok{ (d }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(d, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{/} 
\NormalTok{    (}\FunctionTok{max}\NormalTok{(d, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(d, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)),}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 5 x 4}
\CommentTok{\#\textgreater{}       a     b     c     d}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 0.339  2.59 0.291 0    }
\CommentTok{\#\textgreater{} 2 0.880  0    0.611 0.557}
\CommentTok{\#\textgreater{} 3 0      1.37 1     0.752}
\CommentTok{\#\textgreater{} 4 0.795  1.37 0     1    }
\CommentTok{\#\textgreater{} 5 1      1.34 0.580 0.394}
\end{Highlighting}
\end{Shaded}

ä½ å¯èƒ½èƒ½çŒœå‡ºè¿™æ®µä»£ç å°†æ¯ä¸€åˆ—é‡æ–°ç¼©æ”¾ï¼Œä½¿å…¶èŒƒå›´åœ¨0åˆ°1ä¹‹é—´ã€‚ä½†
ä½ æœ‰æ²¡æœ‰å‘ç°é”™è¯¯ï¼Ÿå½“
Hadleyå†™è¿™æ®µä»£ç æ—¶ï¼Œä»–åœ¨å¤åˆ¶ç²˜è´´æ—¶çŠ¯äº†ä¸€ä¸ªé”™è¯¯ï¼Œå¿˜è®°æŠŠå­—æ¯aæ”¹æˆbã€‚é˜²
æ­¢è¿™ç§é”™è¯¯æ˜¯å­¦ä¹ å¦‚ä½•ç¼–å†™å‡½æ•°çš„ä¸€ä¸ªéå¸¸å¥½çš„ç†ç”±ã€‚

\subsection{ç¼–å†™å‡½æ•°}\label{ux7f16ux5199ux51fdux6570}

è¦ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œä½ é¦–å…ˆéœ€è¦åˆ†æä½ çš„é‡å¤ä»£ç ï¼Œä»¥å¼„æ¸…æ¥šå“ªäº›éƒ¨åˆ†æ˜¯å›ºå®šçš„ï¼Œå“ªäº›éƒ¨åˆ†æ˜¯å˜åŒ–çš„ã€‚å¦‚
æœæˆ‘ä»¬æŠŠä¸Šé¢çš„ä»£ç ä»\texttt{mutate()}ä¸­æå–å‡ºæ¥ï¼Œå› ä¸ºæ¯æ¬¡é‡å¤ç°åœ¨éƒ½åœ¨ä¸€è¡Œä¸Šï¼Œæ‰€ä»¥æ›´å®¹æ˜“çœ‹å‡ºæ¨¡å¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(a }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(a, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{/}\NormalTok{ (}\FunctionTok{max}\NormalTok{(a, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(a, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}
\NormalTok{(b }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(b, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{/}\NormalTok{ (}\FunctionTok{max}\NormalTok{(b, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(b, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}
\NormalTok{(c }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(c, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{/}\NormalTok{ (}\FunctionTok{max}\NormalTok{(c, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(c, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}
\NormalTok{(d }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(d, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{/}\NormalTok{ (}\FunctionTok{max}\NormalTok{(d, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(d, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))  }
\end{Highlighting}
\end{Shaded}

ä¸ºäº†æ›´æ¸…æ¥šä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨\texttt{â–ˆ}æ¥æ›¿æ¢å˜åŒ–çš„ä½:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(â–ˆ }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(â–ˆ, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{/}\NormalTok{ (}\FunctionTok{max}\NormalTok{(â–ˆ, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(â–ˆ, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

è¦å°†å…¶è½¬æ¢ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œä½ éœ€è¦ä¸‰æ ·ä¸œè¥¿ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  ä¸€ä¸ªåç§°ã€‚è¿™é‡Œæˆ‘ä»¬å°†ä½¿ç”¨\texttt{rescale01}ï¼Œå› ä¸ºè¿™ä¸ªå‡½æ•°å°†å‘é‡é‡æ–°ç¼©æ”¾åˆ°0å’Œ1ä¹‹é—´ã€‚
\item
  å‚æ•°ã€‚å‚æ•°æ˜¯åœ¨å‡½æ•°è°ƒç”¨ä¸­å˜åŒ–çš„ä¸œè¥¿ï¼Œä¸Šé¢çš„åˆ†æå‘Šè¯‰æˆ‘ä»¬åªæœ‰ä¸€ä¸ªï¼Œå°†å®ƒå‘½åä¸º\texttt{x}ï¼Œå› ä¸ºè¿™æ˜¯æ•°å€¼å‘é‡çš„å¸¸è§„åç§°ã€‚
\item
  å‡½æ•°ä½“ã€‚å‡½æ•°ä½“æ˜¯åœ¨æ‰€æœ‰è°ƒç”¨ä¸­é‡å¤çš„ä»£ç ã€‚
\end{enumerate}

ç„¶åï¼Œä½ æŒ‰ç…§ä¸‹é¢çš„æ¨¡æ¿æ¥åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{name }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(arguments) \{}
\NormalTok{  body}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œå…¶ç»“æœæ˜¯ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rescale01 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{  (x }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{/}\NormalTok{ (}\FunctionTok{max}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{{-}} \FunctionTok{min}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

æ­¤æ—¶ï¼Œä½ å¯èƒ½ä¼šç”¨å‡ ä¸ªç®€å•çš„è¾“å…¥è¿›è¡Œæµ‹è¯•ï¼Œä»¥ç¡®ä¿ä½ å·²ç»æ­£ç¡®åœ°æ•æ‰åˆ°äº†é€»è¾‘ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rescale01}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{10}\NormalTok{, }\DecValTok{0}\NormalTok{, }\DecValTok{10}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] 0.0 0.5 1.0}
\FunctionTok{rescale01}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\DecValTok{5}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] 0.00 0.25 0.50   NA 1.00}
\end{Highlighting}
\end{Shaded}

ç„¶åä½ å¯ä»¥å°†\texttt{mutate()}çš„è°ƒç”¨é‡å†™ä¸º:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} \FunctionTok{mutate}\NormalTok{(}
  \AttributeTok{a =} \FunctionTok{rescale01}\NormalTok{(a),}
  \AttributeTok{b =} \FunctionTok{rescale01}\NormalTok{(b),}
  \AttributeTok{c =} \FunctionTok{rescale01}\NormalTok{(c),}
  \AttributeTok{d =} \FunctionTok{rescale01}\NormalTok{(d),}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 5 x 4}
\CommentTok{\#\textgreater{}       a     b     c     d}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 0.339 1     0.291 0    }
\CommentTok{\#\textgreater{} 2 0.880 0     0.611 0.557}
\CommentTok{\#\textgreater{} 3 0     0.530 1     0.752}
\CommentTok{\#\textgreater{} 4 0.795 0.531 0     1    }
\CommentTok{\#\textgreater{} 5 1     0.518 0.580 0.394}
\end{Highlighting}
\end{Shaded}

( ç« èŠ‚~\ref{sec-iteration},
ä½ å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨\texttt{across()}æ¥è¿›ä¸€æ­¥å‡å°‘é‡å¤ï¼Œè¿™æ ·ä½ åªéœ€è¦å†™\texttt{df\ \textbar{}\textgreater{}\ mutate(across(a:d,\ rescale01))}å°±å¯ä»¥äº†).

\subsection{æ”¹è¿›å‡½æ•°}\label{ux6539ux8fdbux51fdux6570}

ä½ å¯èƒ½æ³¨æ„åˆ°\texttt{rescale01()}å‡½æ•°åšäº†ä¸€äº›ä¸å¿…è¦çš„å·¥ä½œï¼Œä»¬ä¸éœ€è¦è®¡ç®—ä¸¤æ¬¡\texttt{min()}å’Œä¸€æ¬¡\texttt{max()}ï¼Œç›¸åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨\texttt{range()}å‡½æ•°åœ¨ä¸€æ­¥ä¸­åŒæ—¶è®¡ç®—å‡ºæœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rescale01 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{  rng }\OtherTok{\textless{}{-}} \FunctionTok{range}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  (x }\SpecialCharTok{{-}}\NormalTok{ rng[}\DecValTok{1}\NormalTok{]) }\SpecialCharTok{/}\NormalTok{ (rng[}\DecValTok{2}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ rng[}\DecValTok{1}\NormalTok{])}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

æˆ–è€…ï¼Œä½ å¯èƒ½è¯•å›¾åœ¨åŒ…å«æ— ç©·å¤§å€¼çš„å‘é‡ä¸Šå°è¯•è¿™ä¸ªå‡½æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{, }\ConstantTok{Inf}\NormalTok{)}
\FunctionTok{rescale01}\NormalTok{(x)}
\CommentTok{\#\textgreater{}  [1]   0   0   0   0   0   0   0   0   0   0 NaN}
\end{Highlighting}
\end{Shaded}

è¿™ä¸ªç»“æœä¸æ˜¯ç‰¹åˆ«æœ‰ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®©\texttt{range()}å‡½æ•°å¿½ç•¥æ— ç©·å¤§å€¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rescale01 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{  rng }\OtherTok{\textless{}{-}} \FunctionTok{range}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{finite =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{  (x }\SpecialCharTok{{-}}\NormalTok{ rng[}\DecValTok{1}\NormalTok{]) }\SpecialCharTok{/}\NormalTok{ (rng[}\DecValTok{2}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ rng[}\DecValTok{1}\NormalTok{])}
\NormalTok{\}}

\FunctionTok{rescale01}\NormalTok{(x)}
\CommentTok{\#\textgreater{}  [1] 0.0000000 0.1111111 0.2222222 0.3333333 0.4444444 0.5555556 0.6666667}
\CommentTok{\#\textgreater{}  [8] 0.7777778 0.8888889 1.0000000       Inf}
\end{Highlighting}
\end{Shaded}

è¿™äº›æ”¹å˜è¯´æ˜äº†å‡½æ•°çš„ä¸€ä¸ªé‡è¦å¥½å¤„ï¼šå› ä¸ºæˆ‘ä»¬æŠŠé‡å¤çš„ä»£ç ç§»åˆ°äº†å‡½æ•°ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åœ¨ä¸€ä¸ªåœ°æ–¹åšå‡ºæ”¹å˜ã€‚

\subsection{\texorpdfstring{\textbf{Mutate}
å‡½æ•°}{Mutate å‡½æ•°}}\label{mutate-ux51fdux6570}

æ—¢ç„¶ä½ å·²ç»æŒæ¡äº†å‡½æ•°çš„åŸºæœ¬æ¦‚å¿µï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸€ç³»åˆ—çš„ä¾‹å­ã€‚æˆ‘
ä»¬é¦–å…ˆä»``mutate''å‡½æ•°å¼€å§‹ï¼Œä¹Ÿå°±æ˜¯é‚£äº›åœ¨\texttt{mutate()}å’Œ\texttt{filter()}å†…éƒ¨å·¥ä½œå¾—å¾ˆå¥½çš„å‡½æ•°ï¼Œå› ä¸ºå®ƒä»¬è¿”å›çš„è¾“å‡ºé•¿åº¦ä¸è¾“å…¥ç›¸åŒã€‚

è®©æˆ‘ä»¬ä»\texttt{rescale01()}å‡½æ•°çš„ä¸€ä¸ªç®€å•å˜ä½“å¼€å§‹ã€‚ä¹Ÿ
è®¸ä½ æƒ³è®¡ç®—Zåˆ†æ•°ï¼Œå³å°†ä¸€ä¸ªå‘é‡é‡æ–°ç¼©æ”¾åˆ°å‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{z\_score }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{  (x }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)) }\SpecialCharTok{/} \FunctionTok{sd}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

æˆ–è€…ï¼Œä½ å¯èƒ½æƒ³è¦å°è£…ä¸€ä¸ªç®€å•çš„\texttt{case\_when()}ï¼Œå¹¶ç»™å®ƒä¸€ä¸ªæœ‰ç”¨çš„åå­—ã€‚ä¾‹
å¦‚ï¼Œè¿™ä¸ª\texttt{clamp()}å‡½æ•°ç¡®ä¿å‘é‡çš„æ‰€æœ‰å€¼éƒ½ä½äºæœ€å°å€¼å’Œæœ€å¤§å€¼ä¹‹é—´ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clamp }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x, min, max) \{}
  \FunctionTok{case\_when}\NormalTok{(}
\NormalTok{    x }\SpecialCharTok{\textless{}}\NormalTok{ min }\SpecialCharTok{\textasciitilde{}}\NormalTok{ min,}
\NormalTok{    x }\SpecialCharTok{\textgreater{}}\NormalTok{ max }\SpecialCharTok{\textasciitilde{}}\NormalTok{ max,}
    \AttributeTok{.default =}\NormalTok{ x}
\NormalTok{  )}
\NormalTok{\}}

\FunctionTok{clamp}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{, }\AttributeTok{min =} \DecValTok{3}\NormalTok{, }\AttributeTok{max =} \DecValTok{7}\NormalTok{)}
\CommentTok{\#\textgreater{}  [1] 3 3 3 4 5 6 7 7 7 7}
\end{Highlighting}
\end{Shaded}

å½“ç„¶ï¼Œå‡½æ•°ä¸ä»…ä»…éœ€è¦å¤„ç†æ•°å€¼å˜é‡ï¼Œä½ å¯èƒ½éœ€è¦è¿›è¡Œä¸€äº›é‡å¤çš„å­—ç¬¦ä¸²æ“ä½œã€‚æ¯”
å¦‚ï¼Œå¯èƒ½éœ€è¦å°†å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦è½¬æ¢ä¸ºå¤§å†™ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{first\_upper }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
  \FunctionTok{str\_sub}\NormalTok{(x, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{) }\OtherTok{\textless{}{-}} \FunctionTok{str\_to\_upper}\NormalTok{(}\FunctionTok{str\_sub}\NormalTok{(x, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\NormalTok{  x}
\NormalTok{\}}

\FunctionTok{first\_upper}\NormalTok{(}\StringTok{"hello"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "Hello"}
\end{Highlighting}
\end{Shaded}

æˆ–è€…ï¼Œä½ å¯èƒ½æƒ³åœ¨å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—ä¹‹å‰ï¼Œå»æ‰å…¶ä¸­çš„ç™¾åˆ†å·ã€é€—å·å’Œç¾å…ƒç¬¦å·ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# https://twitter.com/NVlabormarket/status/1571939851922198530}
\NormalTok{clean\_number }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
\NormalTok{  is\_pct }\OtherTok{\textless{}{-}} \FunctionTok{str\_detect}\NormalTok{(x, }\StringTok{"\%"}\NormalTok{)}
\NormalTok{  num }\OtherTok{\textless{}{-}}\NormalTok{ x }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{str\_remove\_all}\NormalTok{(}\StringTok{"\%"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{str\_remove\_all}\NormalTok{(}\StringTok{","}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{str\_remove\_all}\NormalTok{(}\FunctionTok{fixed}\NormalTok{(}\StringTok{"$"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{as.numeric}\NormalTok{()}
  \FunctionTok{if\_else}\NormalTok{(is\_pct, num }\SpecialCharTok{/} \DecValTok{100}\NormalTok{, num)}
\NormalTok{\}}

\FunctionTok{clean\_number}\NormalTok{(}\StringTok{"$12,300"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] 12300}
\FunctionTok{clean\_number}\NormalTok{(}\StringTok{"45\%"}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] 0.45}
\end{Highlighting}
\end{Shaded}

æœ‰æ—¶ï¼Œä½ çš„å‡½æ•°å°†ä¸“é—¨ç”¨äºæŸä¸ªæ•°æ®åˆ†ææ­¥éª¤ã€‚ä¾‹
å¦‚ï¼Œå¦‚æœä½ æœ‰ä¸€å †å˜é‡ï¼Œå®ƒä»¬å°†ç¼ºå¤±å€¼è®°å½•ä¸º997ã€998æˆ–999ï¼Œä½ å¯èƒ½æƒ³ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥å°†è¿™äº›å€¼æ›¿æ¢ä¸º\texttt{NA}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fix\_na }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
  \FunctionTok{if\_else}\NormalTok{(x }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\DecValTok{997}\NormalTok{, }\DecValTok{998}\NormalTok{, }\DecValTok{999}\NormalTok{), }\ConstantTok{NA}\NormalTok{, x)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬ä¸»è¦å…³æ³¨åªæ¥å—å•ä¸ªå‘é‡çš„ä¾‹å­ï¼Œå› ä¸ºæˆ‘ä»¬è®¤ä¸ºå®ƒä»¬æ˜¯æœ€å¸¸è§çš„ã€‚ä½†
æ˜¯ï¼Œä½ çš„å‡½æ•°æ²¡æœ‰ç†ç”±ä¸èƒ½æ¥å—å¤šä¸ªå‘é‡è¾“å…¥ã€‚

\subsection{æ±‡æ€»å‡½æ•°}\label{ux6c47ux603bux51fdux6570}

å¦ä¸€ç±»é‡è¦çš„å‘é‡å‡½æ•°æ˜¯æ±‡æ€»å‡½æ•° (summary
functions)ï¼Œè¿™äº›å‡½æ•°è¿”å›ä¸€ä¸ªå•ä¸€çš„å€¼ï¼Œç”¨äº\texttt{summarize()}å‡½æ•°ä¸­ã€‚æœ‰
æ—¶ï¼Œè¿™ä»…ä»…æ˜¯è®¾ç½®ä¸€ä¸¤ä¸ªé»˜è®¤å‚æ•°çš„é—®é¢˜ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{commas }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
  \FunctionTok{str\_flatten}\NormalTok{(x, }\AttributeTok{collapse =} \StringTok{", "}\NormalTok{, }\AttributeTok{last =} \StringTok{" and "}\NormalTok{)}
\NormalTok{\}}

\FunctionTok{commas}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"cat"}\NormalTok{, }\StringTok{"dog"}\NormalTok{, }\StringTok{"pigeon"}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] "cat, dog and pigeon"}
\end{Highlighting}
\end{Shaded}

æˆ–è€…ï¼Œä½ å¯èƒ½æƒ³å°è£…ä¸€ä¸ªç®€å•çš„è®¡ç®—ï¼Œæ¯”å¦‚å˜å¼‚ç³»æ•°ï¼Œå®ƒæ˜¯é€šè¿‡æ ‡å‡†å·®é™¤ä»¥å‡æ•°æ¥è®¡ç®—çš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cv }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{FALSE}\NormalTok{) \{}
  \FunctionTok{sd}\NormalTok{(x, }\AttributeTok{na.rm =}\NormalTok{ na.rm) }\SpecialCharTok{/} \FunctionTok{mean}\NormalTok{(x, }\AttributeTok{na.rm =}\NormalTok{ na.rm)}
\NormalTok{\}}

\FunctionTok{cv}\NormalTok{(}\FunctionTok{runif}\NormalTok{(}\DecValTok{100}\NormalTok{, }\AttributeTok{min =} \DecValTok{0}\NormalTok{, }\AttributeTok{max =} \DecValTok{50}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] 0.5196276}
\FunctionTok{cv}\NormalTok{(}\FunctionTok{runif}\NormalTok{(}\DecValTok{100}\NormalTok{, }\AttributeTok{min =} \DecValTok{0}\NormalTok{, }\AttributeTok{max =} \DecValTok{500}\NormalTok{))}
\CommentTok{\#\textgreater{} [1] 0.5652554}
\end{Highlighting}
\end{Shaded}

æˆ–è€…ä½ å¯èƒ½åªæ˜¯æƒ³é€šè¿‡ç»™å®ƒä¸€ä¸ªæ˜“äºè®°å¿†çš„åå­—æ¥è®©å¸¸è§çš„æ¨¡å¼æ›´å®¹æ˜“è¢«è®°ä½ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# https://twitter.com/gbganalyst/status/1571619641390252033}
\NormalTok{n\_missing }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
  \FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(x))}
\NormalTok{\} }
\end{Highlighting}
\end{Shaded}

ä½ è¿˜å¯ä»¥ç¼–å†™å…·æœ‰å¤šä¸ªå‘é‡è¾“å…¥çš„å‡½æ•°ã€‚ä¾‹
å¦‚ï¼Œä½ å¯èƒ½æƒ³è¦è®¡ç®—å¹³å‡ç»å¯¹ç™¾åˆ†æ¯”è¯¯å·®æ¥å¸®åŠ©ä½ æ¯”è¾ƒæ¨¡å‹é¢„æµ‹å€¼ä¸å®é™…å€¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# https://twitter.com/neilgcurrie/status/1571607727255834625}
\NormalTok{mape }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(actual, predicted) \{}
  \FunctionTok{sum}\NormalTok{(}\FunctionTok{abs}\NormalTok{((actual }\SpecialCharTok{{-}}\NormalTok{ predicted) }\SpecialCharTok{/}\NormalTok{ actual)) }\SpecialCharTok{/} \FunctionTok{length}\NormalTok{(actual)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{tcolorbox}[enhanced jigsaw, toprule=.15mm, titlerule=0mm, breakable, colback=white, opacityback=0, bottomtitle=1mm, colbacktitle=quarto-callout-note-color!10!white, toptitle=1mm, title=\textcolor{quarto-callout-note-color}{\faInfo}\hspace{0.5em}{RStudio}, arc=.35mm, left=2mm, opacitybacktitle=0.6, rightrule=.15mm, bottomrule=.15mm, colframe=quarto-callout-note-color-frame, coltitle=black, leftrule=.75mm]

å½“ä½ å¼€å§‹ç¼–å†™å‡½æ•°æ—¶ï¼Œæœ‰ä¸¤ä¸ªRStudioçš„å¿«æ·é”®éå¸¸æœ‰ç”¨ï¼š

\begin{itemize}
\item
  è¦æŸ¥æ‰¾ä½ å·²ç¼–å†™çš„å‡½æ•°çš„å®šä¹‰ï¼Œè¯·å°†å…‰æ ‡æ”¾åœ¨å‡½æ•°åä¸Šï¼Œç„¶åæŒ‰F2ï¼›
\item
  è¦å¿«é€Ÿè·³è½¬åˆ°æŸä¸ªå‡½æ•°ï¼Œè¯·æŒ‰Ctrl + .
  æ‰“å¼€æ¨¡ç³Šçš„æ–‡ä»¶å’Œå‡½æ•°æŸ¥æ‰¾å™¨ï¼Œå¹¶è¾“å…¥ä½ çš„å‡½æ•°åçš„å‰å‡ ä¸ªå­—æ¯ã€‚ä½ 
  è¿˜å¯ä»¥å¯¼èˆªåˆ°æ–‡ä»¶ã€Quartoéƒ¨åˆ†ç­‰ï¼Œè¿™ä½¿å®ƒæˆä¸ºä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„å¯¼èˆªå·¥å…·ã€‚
\end{itemize}

\end{tcolorbox}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-59}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ç»ƒä¹ å°†ä»¥ä¸‹ä»£ç ç‰‡æ®µè½¬æ¢ä¸ºå‡½æ•°ã€‚è€ƒ è™‘æ¯ä¸ªå‡½æ•°çš„ä½œç”¨ã€‚ä½  æ€ä¹ˆç§°å‘¼å®ƒï¼Ÿå®ƒ
  éœ€è¦å¤šå°‘ä¸ªå‚æ•°?

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(x))}
\FunctionTok{mean}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(y))}
\FunctionTok{mean}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(z))}

\NormalTok{x }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{y }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(y, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{z }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(z, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)}

\FunctionTok{round}\NormalTok{(x }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\FunctionTok{round}\NormalTok{(y }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(y, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\FunctionTok{round}\NormalTok{(z }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(z, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{) }\SpecialCharTok{*} \DecValTok{100}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\item
  åœ¨\texttt{rescale01()}å‡½æ•°çš„ç¬¬äºŒä¸ªç‰ˆæœ¬ä¸­ï¼Œæ— ç©·å€¼ä¿æŒä¸å˜ã€‚ä½ 
  èƒ½é‡å†™\texttt{rescale01()}å‡½æ•°ï¼Œä½¿å¾—\texttt{-Inf}è¢«æ˜ å°„åˆ°0ï¼Œè€Œ\texttt{Inf}è¢«æ˜ å°„åˆ°1å—ï¼Ÿ
\item
  ç»™å®šä¸€ä¸ªå‡ºç”Ÿæ—¥æœŸå‘é‡ï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥è®¡ç®—å¹´é¾„ (ä»¥å¹´ä¸ºå•ä½)ã€‚
\item
  ç¼–å†™ä½ è‡ªå·±çš„å‡½æ•°æ¥è®¡ç®—æ•°å€¼å‘é‡çš„æ–¹å·®å’Œååº¦ã€‚ä½ 
  å¯ä»¥åœ¨ç»´åŸºç™¾ç§‘æˆ–å…¶ä»–åœ°æ–¹æŸ¥æ‰¾è¿™äº›å®šä¹‰ã€‚
\item
  ç¼–å†™\texttt{both\_na()}å‡½æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªæ±‡æ€»å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸¤ä¸ªç›¸åŒé•¿åº¦çš„å‘é‡ï¼Œå¹¶è¿”å›ä¸¤ä¸ªå‘é‡ä¸­éƒ½æœ‰\texttt{NA}å€¼çš„ä½ç½®æ•°é‡ã€‚
\item
  é˜…è¯»æ–‡æ¡£æ¥äº†è§£ä»¥ä¸‹å‡½æ•°çš„ä½œç”¨ã€‚å°½ ç®¡å®ƒä»¬å¾ˆçŸ­ï¼Œä¸ºä»€ä¹ˆä»ç„¶å¾ˆæœ‰ç”¨ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{is\_directory }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
  \FunctionTok{file.info}\NormalTok{(x)}\SpecialCharTok{$}\NormalTok{isdir}
\NormalTok{\}}
\NormalTok{is\_readable }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) \{}
  \FunctionTok{file.access}\NormalTok{(x, }\DecValTok{4}\NormalTok{) }\SpecialCharTok{==} \DecValTok{0}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{æ•°æ®æ¡†å‡½æ•°}\label{ux6570ux636eux6846ux51fdux6570}

å‘é‡å‡½æ•°å¯¹äºä»dplyrå‡½æ•°ä¸­æå–é‡å¤ä»£ç å¾ˆæœ‰ç”¨ã€‚ä½†
æ˜¯ï¼Œä½ é€šå¸¸ä¼šé‡å¤è¿™äº›å‡½æ•°æœ¬èº«ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤§å‹ç®¡é“ä¸­ã€‚å½“
ä½ å‘ç°è‡ªå·±å¤šæ¬¡å¤åˆ¶å’Œç²˜è´´å¤šä¸ªå‡½æ•°æ—¶ï¼Œä½ å¯èƒ½ä¼šè€ƒè™‘ç¼–å†™ä¸€ä¸ªæ•°æ®æ¡†å‡½æ•°ã€‚æ•°
æ®æ¡†å‡½æ•°çš„å·¥ä½œæ–¹å¼ä¸dplyrå‡½æ•°ç±»ä¼¼ï¼šå®ƒä»¬å°†æ•°æ®æ¡†ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä¸€äº›é¢å¤–çš„å‚æ•°è¯´æ˜å¦‚ä½•å¤„ç†å®ƒï¼Œå¹¶è¿”å›ä¸€ä¸ªæ•°æ®æ¡†æˆ–å‘é‡ã€‚

ä¸ºäº†è®©ä½ ç¼–å†™ä¸€ä¸ªä½¿ç”¨dplyræ“ä½œå‡½æ•°çš„å‡½æ•°ï¼Œæˆ‘ä»¬å°†é¦–å…ˆå‘ä½ ä»‹ç»é—´æ¥å¼•ç”¨çš„é—®é¢˜ä»¥åŠå¦‚ä½•é€šè¿‡ä½¿ç”¨\texttt{\{\ \}}æ¥å…‹æœå®ƒã€‚æŒ
æ¡äº†è¿™äº›ç†è®ºä¹‹åï¼Œæˆ‘ä»¬å°†å‘ä½ å±•ç¤ºä¸€å †ç¤ºä¾‹æ¥è¯´æ˜ä½ å¯ä»¥ç”¨å®ƒåšä»€ä¹ˆã€‚

\subsection{é—´æ¥å¼•ç”¨å’Œæ•´é½è¯„ä¼°}\label{ux95f4ux63a5ux5f15ux7528ux548cux6574ux9f50ux8bc4ux4f30}

å½“ä½ å¼€å§‹ç¼–å†™ä½¿ç”¨dplyrå‡½æ•°çš„å‡½æ•°æ—¶ï¼Œä½ ä¼šå¾ˆå¿«é‡åˆ°é—´æ¥å¼•ç”¨ (indirection)
çš„é—®é¢˜ã€‚è®©
æˆ‘ä»¬ç”¨ä¸€ä¸ªéå¸¸ç®€å•çš„å‡½æ•°\texttt{grouped\_mean()}æ¥è¯´æ˜è¿™ä¸ªé—®é¢˜ã€‚è¿™
ä¸ªå‡½æ•°çš„ç›®çš„æ˜¯è®¡ç®—æŒ‰\texttt{group\_var}åˆ†ç»„å\texttt{mean\_var}çš„å‡æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{grouped\_mean }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, group\_var, mean\_var) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{group\_by}\NormalTok{(group\_var) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{summarize}\NormalTok{(}\FunctionTok{mean}\NormalTok{(mean\_var))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

å¦‚æœæˆ‘ä»¬å°è¯•ä½¿ç”¨å®ƒï¼Œå°±ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} \FunctionTok{grouped\_mean}\NormalTok{(cut, carat)}
\CommentTok{\#\textgreater{} Error in \textasciigrave{}group\_by()\textasciigrave{}:}
\CommentTok{\#\textgreater{} ! Must group by variables found in \textasciigrave{}.data\textasciigrave{}.}
\CommentTok{\#\textgreater{} x Column \textasciigrave{}group\_var\textasciigrave{} is not found.}
\end{Highlighting}
\end{Shaded}

ä¸ºäº†ä½¿é—®é¢˜æ›´æ¸…æ¥šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªåˆæˆçš„æ•°æ®æ¡†:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{mean\_var =} \DecValTok{1}\NormalTok{,}
  \AttributeTok{group\_var =} \StringTok{"g"}\NormalTok{,}
  \AttributeTok{group =} \DecValTok{1}\NormalTok{,}
  \AttributeTok{x =} \DecValTok{10}\NormalTok{,}
  \AttributeTok{y =} \DecValTok{100}
\NormalTok{)}

\NormalTok{df }\SpecialCharTok{|\textgreater{}} \FunctionTok{grouped\_mean}\NormalTok{(group, x)}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 2}
\CommentTok{\#\textgreater{}   group\_var \textasciigrave{}mean(mean\_var)\textasciigrave{}}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}                \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 g                        1}
\NormalTok{df }\SpecialCharTok{|\textgreater{}} \FunctionTok{grouped\_mean}\NormalTok{(group, y)}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 2}
\CommentTok{\#\textgreater{}   group\_var \textasciigrave{}mean(mean\_var)\textasciigrave{}}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}                \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 g                        1}
\end{Highlighting}
\end{Shaded}

æ— è®ºæˆ‘ä»¬å¦‚ä½•è°ƒç”¨\texttt{grouped\_mean()}å‡½æ•°ï¼Œå®ƒæ€»æ˜¯æ‰§è¡Œ\texttt{df\ \textbar{}\textgreater{}\ group\_by(group\_var)\ \textbar{}\textgreater{}\ summarize(mean(mean\_var))}ï¼Œè€Œä¸æ˜¯\texttt{df\ \textbar{}\textgreater{}\ group\_by(group)\ \textbar{}\textgreater{}\ summarize(mean(x))}æˆ–\texttt{df\ \textbar{}\textgreater{}\ group\_by(group)\ \textbar{}\textgreater{}\ summarize(mean(y))}ã€‚è¿™
æ˜¯ä¸€ä¸ªé—´æ¥æ€§çš„é—®é¢˜ï¼Œå®ƒäº§ç”Ÿçš„åŸå› æ˜¯\texttt{dplyr}ä½¿ç”¨æ•´é½è¯„ä¼°ï¼ˆtidy
evaluationï¼‰æ¥å…è®¸ä½ åœ¨ä¸ç»è¿‡ä»»ä½•ç‰¹æ®Šå¤„ç†çš„æƒ…å†µä¸‹å¼•ç”¨æ•°æ®æ¡†ä¸­çš„å˜é‡åã€‚

æ•´é½è¯„ä¼°åœ¨95\%çš„æƒ…å†µä¸‹éƒ½å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒä½¿ä½ çš„æ•°æ®åˆ†æéå¸¸ç®€æ´ï¼Œå› ä¸ºä½ æ°¸è¿œä¸éœ€è¦è¯´æ˜å˜é‡æ¥è‡ªå“ªä¸ªæ•°æ®æ¡†ï¼›ä»ä¸Šä¸‹æ–‡ä¸­å°±å¯ä»¥æ˜æ˜¾çœ‹å‡ºã€‚ç„¶
è€Œï¼Œæ•´é½è¯„ä¼°çš„ç¼ºç‚¹å‡ºç°åœ¨æˆ‘ä»¬æƒ³è¦å°†é‡å¤çš„tidyverseä»£ç å°è£…åˆ°å‡½æ•°ä¸­æ—¶ã€‚åœ¨
è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ–¹å¼æ¥å‘Šè¯‰\texttt{group\_by()}å’Œ\texttt{summarize()}ä¸è¦å°†\texttt{group\_var}å’Œ\texttt{mean\_var}å½“ä½œå˜é‡çš„åå­—ï¼Œè€Œæ˜¯æŸ¥çœ‹å®ƒä»¬å†…éƒ¨æˆ‘ä»¬å®é™…æƒ³è¦ä½¿ç”¨çš„å˜é‡ã€‚

æ•´é½è¯„ä¼°åŒ…æ‹¬ä¸€ä¸ªè§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ¡ˆï¼Œå«åš``æ‹¥æŠ±''ï¼ˆembracingï¼‰ã€‚æ‹¥
æŠ±ä¸€ä¸ªå˜é‡æ„å‘³ç€ç”¨èŠ±æ‹¬å·å°†å®ƒåŒ…è£¹èµ·æ¥ï¼Œä¾‹å¦‚\texttt{var}å˜æˆ\texttt{\{\ var\ \}}ã€‚æ‹¥
æŠ±ä¸€ä¸ªå˜é‡å‘Šè¯‰\texttt{dplyr}ä½¿ç”¨å‚æ•°å†…éƒ¨å­˜å‚¨çš„å€¼ï¼Œè€Œä¸æ˜¯å°†å‚æ•°ä½œä¸ºå­—é¢å˜é‡åã€‚ä¸€
ç§è®°ä½è¿™ç§æ“ä½œçš„æ–¹æ³•æ˜¯æƒ³è±¡\texttt{\{\ \}}æ˜¯å‘ä¸‹çœ‹ä¸€ä¸ªéš§é“ï¼Œ\texttt{\{\ var\ \}}ä¼šä½¿\texttt{dplyr}å‡½æ•°æŸ¥çœ‹\texttt{var}å†…éƒ¨çš„å†…å®¹ï¼Œè€Œä¸æ˜¯å¯»æ‰¾ä¸€ä¸ªåä¸º\texttt{var}çš„å˜é‡ã€‚

å› æ­¤ï¼Œä¸ºäº†è®©\texttt{grouped\_mean()}å‡½æ•°æ­£å¸¸å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦ç”¨\texttt{\{\ \}}å°†\texttt{group\_var}å’Œ\texttt{mean\_var}åŒ…å›´èµ·æ¥ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{grouped\_mean }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, group\_var, mean\_var) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{group\_by}\NormalTok{(\{\{ group\_var \}\}) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{summarize}\NormalTok{(}\FunctionTok{mean}\NormalTok{(\{\{ mean\_var \}\}))}
\NormalTok{\}}

\NormalTok{df }\SpecialCharTok{|\textgreater{}} \FunctionTok{grouped\_mean}\NormalTok{(group, x)}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 2}
\CommentTok{\#\textgreater{}   group \textasciigrave{}mean(x)\textasciigrave{}}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1        10}
\end{Highlighting}
\end{Shaded}

æˆåŠŸäº†!

\subsection{ä»€ä¹ˆæ—¶å€™æ‹¥æŠ±?}\label{sec-embracing}

å› æ­¤ï¼Œåœ¨ç¼–å†™æ•°æ®æ¡†å‡½æ•°æ—¶ï¼Œä¸»è¦æŒ‘æˆ˜åœ¨äºç¡®å®šå“ªäº›å‚æ•°éœ€è¦è¢«åŒ…å«ã€‚å¹¸
è¿çš„æ˜¯ï¼Œè¿™å¾ˆç®€å•ï¼Œå› ä¸ºä½ å¯ä»¥ä»æ–‡æ¡£ä¸­æ‰¾åˆ°ç­”æ¡ˆğŸ˜Šã€‚åœ¨
æ–‡æ¡£ä¸­ï¼Œæœ‰ä¸¤ä¸ªæœ¯è¯­ä¸æœ€å¸¸è§çš„æ•´é½è¯„ä¼°å­ç±»å‹ç›¸å¯¹åº”ï¼š

\begin{itemize}
\tightlist
\item
  æ•°æ®å±è”½ï¼ˆData-maskingï¼‰ï¼šè¿™ç”¨äºå¦‚\texttt{arrange()}ã€\texttt{filter()}å’Œ\texttt{summarize()}ç­‰å‡½æ•°ï¼Œå®ƒä»¬ä½¿ç”¨å˜é‡è¿›è¡Œè®¡ç®—ã€‚
\item
  æ•´é½é€‰æ‹©ï¼ˆTidy-selectionï¼‰ï¼šè¿™ç”¨äºå¦‚\texttt{select()}ã€\texttt{relocate()}å’Œ\texttt{rename()}ç­‰å‡½æ•°ï¼Œå®ƒä»¬ç”¨äºé€‰æ‹©å˜é‡ã€‚
\end{itemize}

å¯¹äºå“ªäº›å‚æ•°ä½¿ç”¨æ•´é½è¯„ä¼°ï¼Œä½ çš„ç›´è§‰åº”è¯¥è¶³ä»¥åº”å¯¹è®¸å¤šå¸¸è§å‡½æ•°------åªéœ€è€ƒè™‘ä½ æ˜¯å¦å¯ä»¥è®¡ç®—ï¼ˆä¾‹å¦‚ï¼Œ\texttt{x\ +\ 1}ï¼‰æˆ–é€‰æ‹©ï¼ˆä¾‹å¦‚ï¼Œ\texttt{a:x}ï¼‰ã€‚

åœ¨ä»¥ä¸‹éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†æ¢è®¨ä¸€æ—¦ä½ ç†è§£äº†æ‹¥æŠ±çš„æ¦‚å¿µåï¼Œä½ å¯èƒ½ä¼šç¼–å†™çš„å„ç§å®ç”¨å‡½æ•°ã€‚

\subsection{å¸¸è§ç”¨ä¾‹}\label{ux5e38ux89c1ux7528ux4f8b}

å¦‚æœä½ åœ¨è¿›è¡Œåˆæ­¥æ•°æ®æ¢ç´¢æ—¶ç»å¸¸æ‰§è¡Œç›¸åŒçš„æ±‡æ€»æ“ä½œï¼Œä½ å¯èƒ½ä¼šè€ƒè™‘å°†å®ƒä»¬å°è£…æˆä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{summary6 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(data, var) \{}
\NormalTok{  data }\SpecialCharTok{|\textgreater{}} \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{min =} \FunctionTok{min}\NormalTok{(\{\{ var \}\}, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{mean =} \FunctionTok{mean}\NormalTok{(\{\{ var \}\}, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{median =} \FunctionTok{median}\NormalTok{(\{\{ var \}\}, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{max =} \FunctionTok{max}\NormalTok{(\{\{ var \}\}, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{(),}
    \AttributeTok{n\_miss =} \FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(\{\{ var \}\})),}
    \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{  )}
\NormalTok{\}}

\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} \FunctionTok{summary6}\NormalTok{(carat)}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 6}
\CommentTok{\#\textgreater{}     min  mean median   max     n n\_miss}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}int\textgreater{}  \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1   0.2 0.798    0.7  5.01 53940      0}
\end{Highlighting}
\end{Shaded}

(æ¯å½“ä½ åœ¨è¾…åŠ©å‡½æ•°ä¸­å°è£…\texttt{summarize()}æ—¶ï¼Œæˆ‘ä»¬è®¤ä¸ºå°†\texttt{.groups\ =\ "drop"}è®¾ç½®ä¸ºé¿å…æ¶ˆæ¯å¹¶å°†æ•°æ®ä¿æŒåœ¨æœªåˆ†ç»„çŠ¶æ€æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚)

è¿™ä¸ªå‡½æ•°çš„ä¼˜ç‚¹åœ¨äºï¼Œå› ä¸ºå®ƒå°è£…äº†\texttt{summarize()}ï¼Œæ‰€ä»¥ä½ å¯ä»¥å¯¹åˆ†ç»„æ•°æ®ä½¿ç”¨å®ƒï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(cut) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summary6}\NormalTok{(carat)}
\CommentTok{\#\textgreater{} \# A tibble: 5 x 7}
\CommentTok{\#\textgreater{}   cut         min  mean median   max     n n\_miss}
\CommentTok{\#\textgreater{}   \textless{}ord\textgreater{}     \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}int\textgreater{}  \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 Fair       0.22 1.05    1     5.01  1610      0}
\CommentTok{\#\textgreater{} 2 Good       0.23 0.849   0.82  3.01  4906      0}
\CommentTok{\#\textgreater{} 3 Very Good  0.2  0.806   0.71  4    12082      0}
\CommentTok{\#\textgreater{} 4 Premium    0.2  0.892   0.86  4.01 13791      0}
\CommentTok{\#\textgreater{} 5 Ideal      0.2  0.703   0.54  3.5  21551      0}
\end{Highlighting}
\end{Shaded}

æ­¤å¤–ï¼Œç”±äºä¼ é€’ç»™\texttt{summarize}çš„å‚æ•°ä¹Ÿä½¿ç”¨æ•°æ®å±è”½ï¼Œè¿™æ„å‘³ç€\texttt{summary6()}å‡½æ•°ä¸­çš„\texttt{var}å‚æ•°ä¹Ÿä½¿ç”¨æ•°æ®å±è”½ã€‚è¿™
æ„å‘³ç€ä½ è¿˜å¯ä»¥å¯¹è®¡ç®—åçš„å˜é‡è¿›è¡Œæ±‡æ€»ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(cut) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summary6}\NormalTok{(}\FunctionTok{log10}\NormalTok{(carat))}
\CommentTok{\#\textgreater{} \# A tibble: 5 x 7}
\CommentTok{\#\textgreater{}   cut          min    mean  median   max     n n\_miss}
\CommentTok{\#\textgreater{}   \textless{}ord\textgreater{}      \textless{}dbl\textgreater{}   \textless{}dbl\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}int\textgreater{}  \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 Fair      {-}0.658 {-}0.0273  0      0.700  1610      0}
\CommentTok{\#\textgreater{} 2 Good      {-}0.638 {-}0.133  {-}0.0862 0.479  4906      0}
\CommentTok{\#\textgreater{} 3 Very Good {-}0.699 {-}0.164  {-}0.149  0.602 12082      0}
\CommentTok{\#\textgreater{} 4 Premium   {-}0.699 {-}0.125  {-}0.0655 0.603 13791      0}
\CommentTok{\#\textgreater{} 5 Ideal     {-}0.699 {-}0.225  {-}0.268  0.544 21551      0}
\end{Highlighting}
\end{Shaded}

è¦å¯¹å¤šä¸ªå˜é‡è¿›è¡Œæ±‡æ€»ï¼Œä½ éœ€è¦ç­‰åˆ° å°èŠ‚~\ref{sec-across}
ï¼Œåœ¨é‚£é‡Œä½ å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨\texttt{across()}å‡½æ•°ã€‚

å¦ä¸€ä¸ªæµè¡Œçš„\texttt{summarize()}è¾…åŠ©å‡½æ•°æ˜¯\texttt{count()}çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œå®ƒè¿˜ä¼šè®¡ç®—æ¯”ä¾‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# https://twitter.com/Diabb6/status/1571635146658402309}
\NormalTok{count\_prop }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, var, }\AttributeTok{sort =} \ConstantTok{FALSE}\NormalTok{) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}}
    \FunctionTok{count}\NormalTok{(\{\{ var \}\}, }\AttributeTok{sort =}\NormalTok{ sort) }\SpecialCharTok{|\textgreater{}}
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{prop =}\NormalTok{ n }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(n))}
\NormalTok{\}}

\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} \FunctionTok{count\_prop}\NormalTok{(clarity)}
\CommentTok{\#\textgreater{} \# A tibble: 8 x 3}
\CommentTok{\#\textgreater{}   clarity     n   prop}
\CommentTok{\#\textgreater{}   \textless{}ord\textgreater{}   \textless{}int\textgreater{}  \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 I1        741 0.0137}
\CommentTok{\#\textgreater{} 2 SI2      9194 0.170 }
\CommentTok{\#\textgreater{} 3 SI1     13065 0.242 }
\CommentTok{\#\textgreater{} 4 VS2     12258 0.227 }
\CommentTok{\#\textgreater{} 5 VS1      8171 0.151 }
\CommentTok{\#\textgreater{} 6 VVS2     5066 0.0939}
\CommentTok{\#\textgreater{} \# i 2 more rows}
\end{Highlighting}
\end{Shaded}

è¿™ä¸ªå‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼š\texttt{df}ã€\texttt{var} å’Œ \texttt{sort}ï¼Œå…¶ä¸­åªæœ‰
\texttt{var} éœ€è¦è¢«åŒ…å«åœ¨æ‹¬å·ä¸­ï¼Œå› ä¸ºå®ƒè¢«ä¼ é€’ç»™ count()
å‡½æ•°ï¼Œè¯¥å‡½æ•°å¯¹æ‰€æœ‰å˜é‡ä½¿ç”¨æ•°æ®å±è”½ã€‚è¯· æ³¨æ„ï¼Œæˆ‘ä»¬ä¸º \texttt{sort}
è®¾ç½®äº†ä¸€ä¸ªé»˜è®¤å€¼ï¼Œå› æ­¤å¦‚æœç”¨æˆ·ä¸æä¾›è‡ªå·±çš„å€¼ï¼Œå®ƒå°†é»˜è®¤ä¸º
\texttt{FALSE}ã€‚

æˆ–è€…ï¼Œä½ å¯èƒ½æƒ³ä¸ºæ•°æ®çš„å­é›†æ‰¾åˆ°ä¸€ä¸ªå˜é‡çš„å·²æ’åºçš„å”¯ä¸€å€¼ï¼Œè€Œä¸æ˜¯æä¾›ä¸€ä¸ªå˜é‡å’Œä¸€ä¸ªå€¼æ¥è¿›è¡Œç­›é€‰ï¼Œæˆ‘ä»¬å°†å…è®¸ç”¨æˆ·æä¾›ä¸€ä¸ªæ¡ä»¶ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{unique\_where }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, condition, var) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{filter}\NormalTok{(\{\{ condition \}\}) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{distinct}\NormalTok{(\{\{ var \}\}) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{arrange}\NormalTok{(\{\{ var \}\})}
\NormalTok{\}}

\CommentTok{\# Find all the destinations in December}
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} \FunctionTok{unique\_where}\NormalTok{(month }\SpecialCharTok{==} \DecValTok{12}\NormalTok{, dest)}
\CommentTok{\#\textgreater{} \# A tibble: 96 x 1}
\CommentTok{\#\textgreater{}   dest }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 ABQ  }
\CommentTok{\#\textgreater{} 2 ALB  }
\CommentTok{\#\textgreater{} 3 ATL  }
\CommentTok{\#\textgreater{} 4 AUS  }
\CommentTok{\#\textgreater{} 5 AVL  }
\CommentTok{\#\textgreater{} 6 BDL  }
\CommentTok{\#\textgreater{} \# i 90 more rows}
\end{Highlighting}
\end{Shaded}

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°† \texttt{condition} æ”¾åœ¨æ‹¬å·ä¸­ï¼Œå› ä¸ºå®ƒè¢«ä¼ é€’ç»™
\texttt{filter()} å‡½æ•°ï¼›è€Œ \texttt{var} è¢«æ”¾åœ¨æ‹¬å·ä¸­ï¼Œå› ä¸ºå®ƒè¢«ä¼ é€’ç»™
\texttt{distinct()} å’Œ \texttt{arrange()} å‡½æ•°ã€‚

æˆ‘ä»¬å·²ç»ä½¿æ‰€æœ‰è¿™äº›ç¤ºä¾‹éƒ½å°†æ•°æ®æ¡†ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä½†å¦‚æœä½ åå¤ä½¿ç”¨ç›¸åŒçš„æ•°æ®ï¼Œé‚£ä¹ˆå°†æ•°æ®ç¡¬ç¼–ç åˆ°å‡½æ•°ä¸­å¯èƒ½æ˜¯æœ‰æ„ä¹‰çš„ã€‚ä¾‹
å¦‚ï¼Œä¸‹é¢çš„å‡½æ•°æ€»æ˜¯ä¸ flights æ•°æ®é›†ä¸€èµ·å·¥ä½œï¼Œå¹¶ä¸”æ€»æ˜¯é€‰æ‹©
\texttt{time\_hour}ã€\texttt{carrier} å’Œ
\texttt{flight}ï¼Œå› ä¸ºå®ƒä»¬æ„æˆäº†å¤åˆä¸»é”®ï¼Œä½¿ä½ èƒ½å¤Ÿæ ‡è¯†ä¸€è¡Œã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{subset\_flights }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(rows, cols) \{}
\NormalTok{  flights }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{filter}\NormalTok{(\{\{ rows \}\}) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{select}\NormalTok{(time\_hour, carrier, flight, \{\{ cols \}\})}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\subsection{æ•°æ®å±è”½ä¸æ•´é½é€‰æ‹©}\label{ux6570ux636eux5c4fux853dux4e0eux6574ux9f50ux9009ux62e9}

æœ‰æ—¶ä½ æƒ³åœ¨ä½¿ç”¨æ•°æ®å±è”½çš„å‡½æ•°å†…éƒ¨é€‰æ‹©å˜é‡ã€‚ä¾‹
å¦‚ï¼Œä½ æƒ³ç¼–å†™ä¸€ä¸ªåä¸º\texttt{count\_missing()}çš„å‡½æ•°ï¼Œç”¨äºè®¡ç®—è¡Œä¸­ç¼ºå¤±è§‚æµ‹å€¼çš„æ•°é‡ã€‚ä½ 
å¯èƒ½ä¼šå°è¯•ç¼–å†™å¦‚ä¸‹å†…å®¹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{count\_missing }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, group\_vars, x\_var) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{group\_by}\NormalTok{(\{\{ group\_vars \}\}) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{summarize}\NormalTok{(}
      \AttributeTok{n\_miss =} \FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(\{\{ x\_var \}\})),}
      \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{    )}
\NormalTok{\}}

\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count\_missing}\NormalTok{(}\FunctionTok{c}\NormalTok{(year, month, day), dep\_time)}
\CommentTok{\#\textgreater{} Error in \textasciigrave{}group\_by()\textasciigrave{}:}
\CommentTok{\#\textgreater{} i In argument: \textasciigrave{}c(year, month, day)\textasciigrave{}.}
\CommentTok{\#\textgreater{} Caused by error:}
\CommentTok{\#\textgreater{} ! \textasciigrave{}c(year, month, day)\textasciigrave{} must be size 336776 or 1, not 1010328.}
\end{Highlighting}
\end{Shaded}

è¿™ä¸èµ·ä½œç”¨ï¼Œå› ä¸º\texttt{group\_by()}ä½¿ç”¨çš„æ˜¯æ•°æ®å±è”½ï¼Œè€Œä¸æ˜¯æ•´é½é€‰æ‹©ã€‚æˆ‘
ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨æ–¹ä¾¿çš„\texttt{pick()}å‡½æ•°æ¥ç»•è¿‡è¿™ä¸ªé—®é¢˜ï¼Œè¯¥å‡½æ•°å…è®¸ä½ åœ¨æ•°æ®å±è”½å‡½æ•°å†…éƒ¨ä½¿ç”¨æ•´é½é€‰æ‹©ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{count\_missing }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, group\_vars, x\_var) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{group\_by}\NormalTok{(}\FunctionTok{pick}\NormalTok{(\{\{ group\_vars \}\})) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{summarize}\NormalTok{(}
      \AttributeTok{n\_miss =} \FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(\{\{ x\_var \}\})),}
      \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{  )}
\NormalTok{\}}

\NormalTok{flights }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count\_missing}\NormalTok{(}\FunctionTok{c}\NormalTok{(year, month, day), dep\_time)}
\CommentTok{\#\textgreater{} \# A tibble: 365 x 4}
\CommentTok{\#\textgreater{}    year month   day n\_miss}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}  \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1  2013     1     1      4}
\CommentTok{\#\textgreater{} 2  2013     1     2      8}
\CommentTok{\#\textgreater{} 3  2013     1     3     10}
\CommentTok{\#\textgreater{} 4  2013     1     4      6}
\CommentTok{\#\textgreater{} 5  2013     1     5      3}
\CommentTok{\#\textgreater{} 6  2013     1     6      1}
\CommentTok{\#\textgreater{} \# i 359 more rows}
\end{Highlighting}
\end{Shaded}

\texttt{pick()}çš„å¦ä¸€ä¸ªæ–¹ä¾¿çš„ç”¨é€”æ˜¯åˆ¶ä½œäºŒç»´è®¡æ•°è¡¨ã€‚åœ¨
è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨è¡Œå’Œåˆ—ä¸­çš„æ‰€æœ‰å˜é‡è¿›è¡Œè®¡æ•°ï¼Œç„¶åä½¿ç”¨\texttt{pivot\_wider()}å°†è®¡æ•°é‡æ–°æ’åˆ—æˆç½‘æ ¼å½¢å¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# https://twitter.com/pollicipes/status/1571606508944719876}
\NormalTok{count\_wide }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(data, rows, cols) \{}
\NormalTok{  data }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{count}\NormalTok{(}\FunctionTok{pick}\NormalTok{(}\FunctionTok{c}\NormalTok{(\{\{ rows \}\}, \{\{ cols \}\}))) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{pivot\_wider}\NormalTok{(}
      \AttributeTok{names\_from =}\NormalTok{ \{\{ cols \}\}, }
      \AttributeTok{values\_from =}\NormalTok{ n,}
      \AttributeTok{names\_sort =} \ConstantTok{TRUE}\NormalTok{,}
      \AttributeTok{values\_fill =} \DecValTok{0}
\NormalTok{    )}
\NormalTok{\}}

\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} \FunctionTok{count\_wide}\NormalTok{(}\FunctionTok{c}\NormalTok{(clarity, color), cut)}
\CommentTok{\#\textgreater{} \# A tibble: 56 x 7}
\CommentTok{\#\textgreater{}   clarity color  Fair  Good \textasciigrave{}Very Good\textasciigrave{} Premium Ideal}
\CommentTok{\#\textgreater{}   \textless{}ord\textgreater{}   \textless{}ord\textgreater{} \textless{}int\textgreater{} \textless{}int\textgreater{}       \textless{}int\textgreater{}   \textless{}int\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 I1      D         4     8           5      12    13}
\CommentTok{\#\textgreater{} 2 I1      E         9    23          22      30    18}
\CommentTok{\#\textgreater{} 3 I1      F        35    19          13      34    42}
\CommentTok{\#\textgreater{} 4 I1      G        53    19          16      46    16}
\CommentTok{\#\textgreater{} 5 I1      H        52    14          12      46    38}
\CommentTok{\#\textgreater{} 6 I1      I        34     9           8      24    17}
\CommentTok{\#\textgreater{} \# i 50 more rows}
\end{Highlighting}
\end{Shaded}

è™½ç„¶æˆ‘ä»¬çš„ç¤ºä¾‹ä¸»è¦å…³æ³¨äº† dplyrï¼Œä½†æ•´é½è¯„ä¼°ä¹Ÿæ˜¯ tidyr çš„åŸºç¡€ã€‚å¦‚
æœä½ æŸ¥çœ‹\texttt{pivot\_wider()}çš„æ–‡æ¡£ï¼Œä½ ä¼šçœ‹åˆ°\texttt{names\_from}å‚æ•°ä½¿ç”¨äº†æ•´é½é€‰æ‹©ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-60}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ä½¿ç”¨æ¥è‡ªnycflights13çš„æ•°æ®é›†ï¼Œç¼–å†™å¦‚ä¸‹å‡½æ•°:

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \item
    æ‰¾åˆ°æ‰€æœ‰è¢«å–æ¶ˆçš„èˆªç­ (å³åˆ°è¾¾æ—¶é—´ä¸ºç©ºå€¼\texttt{is.na(arr\_time)})
    æˆ–å»¶è¯¯è¶…è¿‡ä¸€ä¸ªå°æ—¶çš„èˆªç­ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} \FunctionTok{filter\_severe}\NormalTok{()}
\end{Highlighting}
\end{Shaded}
  \item
    è®¡ç®—è¢«å–æ¶ˆçš„èˆªç­æ•°é‡ä»¥åŠå»¶è¯¯è¶…è¿‡ä¸€ä¸ªå°æ—¶çš„èˆªç­æ•°é‡ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} \FunctionTok{group\_by}\NormalTok{(dest) }\SpecialCharTok{|\textgreater{}} \FunctionTok{summarize\_severe}\NormalTok{()}
\end{Highlighting}
\end{Shaded}
  \item
    æ‰¾åˆ°æ‰€æœ‰è¢«å–æ¶ˆæˆ–å»¶è¯¯è¶…è¿‡ç”¨æˆ·æŒ‡å®šå°æ—¶æ•°çš„èˆªç­ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} \FunctionTok{filter\_severe}\NormalTok{(}\AttributeTok{hours =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
  \item
    æ ¹æ®ç”¨æˆ·æä¾›çš„å˜é‡ï¼Œæ±‡æ€»å¤©æ°”æ•°æ®ä»¥è®¡ç®—æœ€å°å€¼ã€å¹³å‡å€¼å’Œæœ€å¤§å€¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{weather }\SpecialCharTok{|\textgreater{}} \FunctionTok{summarize\_weather}\NormalTok{(temp)}
\end{Highlighting}
\end{Shaded}
  \item
    å°†ç”¨æˆ·æä¾›çš„ä½¿ç”¨æ—¶é’Ÿæ—¶é—´
    (ä¾‹å¦‚ï¼Œå‡ºå‘æ—¶é—´\texttt{dep\_time}ã€åˆ°è¾¾æ—¶é—´\texttt{arr\_time}ç­‰)
    çš„å˜é‡è½¬æ¢ä¸ºåè¿›åˆ¶æ—¶é—´ (å³å°æ—¶ + (åˆ†é’Ÿ / 60))ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{flights }\SpecialCharTok{|\textgreater{}} \FunctionTok{standardize\_time}\NormalTok{(sched\_dep\_time)}
\end{Highlighting}
\end{Shaded}
  \end{enumerate}
\item
  å¯¹äºä»¥ä¸‹æ¯ä¸ªå‡½æ•°ï¼Œåˆ—å‡ºæ‰€æœ‰ä½¿ç”¨æ•´é½è¯„ä¼°çš„å‚æ•°ï¼Œå¹¶æè¿°å®ƒä»¬æ˜¯å¦ä½¿ç”¨æ•°æ®å±è”½æˆ–æ•´é½é€‰æ‹©:
  \texttt{distinct()}, \texttt{count()}, \texttt{group\_by()},
  \texttt{rename\_with()}, \texttt{slice\_min()},
  \texttt{slice\_sample()}ã€‚
\item
  å°†ä»¥ä¸‹å‡½æ•°æ³›åŒ–ï¼Œä»¥ä¾¿ä½ å¯ä»¥æä¾›ä»»æ„æ•°é‡çš„å˜é‡è¿›è¡Œè®¡æ•°ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{count\_prop }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, var, }\AttributeTok{sort =} \ConstantTok{FALSE}\NormalTok{) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}}
    \FunctionTok{count}\NormalTok{(\{\{ var \}\}, }\AttributeTok{sort =}\NormalTok{ sort) }\SpecialCharTok{|\textgreater{}}
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{prop =}\NormalTok{ n }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(n))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{ç»˜å›¾å‡½æ•°}\label{ux7ed8ux56feux51fdux6570}

æœ‰æ—¶ä½ å¯èƒ½å¸Œæœ›è¿”å›ä¸€ä¸ªå›¾ï¼Œè€Œä¸æ˜¯è¿”å›ä¸€ä¸ªæ•°æ®æ¡†ã€‚å¹¸
è¿çš„æ˜¯ï¼Œä½ å¯ä»¥ä½¿ç”¨ggplot2ä¸­çš„ç›¸åŒæŠ€æœ¯ï¼Œå› ä¸º\texttt{aes()}æ˜¯ä¸€ä¸ªæ•°æ®å±è”½å‡½æ•°ã€‚ä¾‹
å¦‚ï¼Œå‡è®¾ä½ è¦åˆ¶ä½œå¾ˆå¤šç›´æ–¹å›¾ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \FloatTok{0.1}\NormalTok{)}

\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \FloatTok{0.05}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ èƒ½å°†è¿™ä¸ªå°è£…æˆä¸€ä¸ªç›´æ–¹å›¾å‡½æ•°ï¼Œé‚£ä¸æ˜¯å¾ˆå¥½å—ï¼Ÿä¸€
æ—¦ä½ çŸ¥é“\texttt{aes()}æ˜¯ä¸€ä¸ªæ•°æ®å±è”½å‡½æ•°ï¼Œå¹¶ä¸”ä½ éœ€è¦æ¥å—è¿™ä¸ªäº‹å®ï¼Œé‚£ä¹ˆè¿™æ˜“å¦‚åæŒã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{histogram }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, var, }\AttributeTok{binwidth =} \ConstantTok{NULL}\NormalTok{) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ \{\{ var \}\})) }\SpecialCharTok{+} 
    \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =}\NormalTok{ binwidth)}
\NormalTok{\}}

\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} \FunctionTok{histogram}\NormalTok{(carat, }\FloatTok{0.1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{functions_files/figure-pdf/unnamed-chunk-44-1.pdf}

è¯·æ³¨æ„ï¼Œ\texttt{histogram()}è¿”å›ä¸€ä¸ªggplot2å›¾ï¼Œè¿™æ„å‘³ç€å¦‚æœä½ æƒ³è¦çš„è¯ï¼Œä½ ä»ç„¶å¯ä»¥åœ¨ä¸Šé¢æ·»åŠ é¢å¤–çš„ç»„ä»¶ã€‚åª
æ˜¯è®°å¾—å°†\texttt{\textbar{}\textgreater{}}åˆ‡æ¢ä¸º\texttt{+}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{histogram}\NormalTok{(carat, }\FloatTok{0.1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Size (in carats)"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Number of diamonds"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{æ›´å¤šå˜é‡}\label{ux66f4ux591aux53d8ux91cf}

å‘ç»„åˆä¸­æ·»åŠ æ›´å¤šå˜é‡éå¸¸ç›´æ¥ã€‚ä¾‹
å¦‚ï¼Œä½ å¯èƒ½æƒ³è¦é€šè¿‡å åŠ ä¸€æ¡å¹³æ»‘çº¿å’Œä¸€æ¡ç›´çº¿æ¥è½»æ¾æŸ¥çœ‹æ•°æ®é›†æ˜¯å¦ä¸ºçº¿æ€§ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# https://twitter.com/tyler\_js\_smith/status/1574377116988104704}
\NormalTok{linearity\_check }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, x, y) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ \{\{ x \}\}, }\AttributeTok{y =}\NormalTok{ \{\{ y \}\})) }\SpecialCharTok{+}
    \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
    \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"loess"}\NormalTok{, }\AttributeTok{formula =}\NormalTok{ y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x, }\AttributeTok{color =} \StringTok{"red"}\NormalTok{, }\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{geom\_smooth}\NormalTok{(}\AttributeTok{method =} \StringTok{"lm"}\NormalTok{, }\AttributeTok{formula =}\NormalTok{ y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x, }\AttributeTok{color =} \StringTok{"blue"}\NormalTok{, }\AttributeTok{se =} \ConstantTok{FALSE}\NormalTok{) }
\NormalTok{\}}

\NormalTok{starwars }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(mass }\SpecialCharTok{\textless{}} \DecValTok{1000}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{linearity\_check}\NormalTok{(mass, height)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{functions_files/figure-pdf/unnamed-chunk-46-1.pdf}

æˆ–è€…ï¼Œå¯¹äºå¤§å‹æ•°æ®é›†çš„è¿‡åº¦ç»˜å›¾ï¼Œä½ å¯èƒ½æƒ³è¦ä½¿ç”¨å½©è‰²æ•£ç‚¹å›¾ä½œä¸ºæ›¿ä»£æ–¹æ¡ˆï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# https://twitter.com/ppaxisa/status/1574398423175921665}
\NormalTok{hex\_plot }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, x, y, z, }\AttributeTok{bins =} \DecValTok{20}\NormalTok{, }\AttributeTok{fun =} \StringTok{"mean"}\NormalTok{) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ \{\{ x \}\}, }\AttributeTok{y =}\NormalTok{ \{\{ y \}\}, }\AttributeTok{z =}\NormalTok{ \{\{ z \}\})) }\SpecialCharTok{+} 
    \FunctionTok{stat\_summary\_hex}\NormalTok{(}
      \FunctionTok{aes}\NormalTok{(}\AttributeTok{color =} \FunctionTok{after\_scale}\NormalTok{(fill)), }\CommentTok{\# make border same color as fill}
      \AttributeTok{bins =}\NormalTok{ bins, }
      \AttributeTok{fun =}\NormalTok{ fun,}
\NormalTok{    )}
\NormalTok{\}}

\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} \FunctionTok{hex\_plot}\NormalTok{(carat, price, depth)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{functions_files/figure-pdf/unnamed-chunk-47-1.pdf}

\subsection{ä¸tidyverseå…¶ä»–ç»„ä»¶ç»“åˆ}\label{ux4e0etidyverseux5176ux4ed6ux7ec4ux4ef6ux7ed3ux5408}

ä¸€äº›æœ€æœ‰ç”¨çš„è¾…åŠ©å·¥å…·å°†æ•°æ®å¤„ç†ä¸ggplot2ç»“åˆä½¿ç”¨ã€‚ä¾‹
å¦‚ï¼Œå¦‚æœä½ æƒ³è¦åˆ¶ä½œä¸€ä¸ªå‚ç›´æ¡å½¢å›¾ï¼Œå¹¶ä½¿ç”¨\texttt{fct\_infreq()}è‡ªåŠ¨æŒ‰é¢‘æ•°é¡ºåºå¯¹æ¡å½¢è¿›è¡Œæ’åºã€‚ç”±
äºæ¡å½¢å›¾æ˜¯å‚ç›´çš„ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦åè½¬é€šå¸¸çš„é¡ºåºï¼Œä»¥ä¾¿æœ€é«˜çš„å€¼ä½äºé¡¶éƒ¨ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sorted\_bars }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, var) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{mutate}\NormalTok{(\{\{ var \}\} }\SpecialCharTok{:}\ErrorTok{=} \FunctionTok{fct\_rev}\NormalTok{(}\FunctionTok{fct\_infreq}\NormalTok{(\{\{ var \}\})))  }\SpecialCharTok{|\textgreater{}}
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ \{\{ var \}\})) }\SpecialCharTok{+}
    \FunctionTok{geom\_bar}\NormalTok{()}
\NormalTok{\}}

\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} \FunctionTok{sorted\_bars}\NormalTok{(clarity)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{functions_files/figure-pdf/unnamed-chunk-48-1.pdf}

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨ä¸€ä¸ªæ–°çš„æ“ä½œç¬¦
\texttt{:=}ï¼ˆé€šå¸¸è¢«ç§°ä¸º``æµ·è±¡æ“ä½œç¬¦''ï¼‰ï¼Œå› ä¸ºæˆ‘ä»¬åŸºäºç”¨æˆ·æä¾›çš„æ•°æ®ç”Ÿæˆå˜é‡åã€‚å˜
é‡åæ”¾åœ¨ \texttt{=} çš„å·¦ä¾§ï¼Œä½† R
çš„è¯­æ³•ä¸å…è®¸é™¤äº†å•ä¸ªå­—é¢åç§°ä¹‹å¤–çš„ä»»ä½•ä¸œè¥¿æ”¾åœ¨ \texttt{=} çš„å·¦ä¾§ã€‚ä¸º
äº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨ç‰¹æ®Šæ“ä½œç¬¦ \texttt{:=}ï¼Œtidy è¯„ä¼°å°†å…¶è§†ä¸ºä¸
\texttt{=} å®Œå…¨ç›¸åŒã€‚

æˆ–è€…ï¼Œä½ å¯èƒ½æƒ³è¦è½»æ¾åœ°åªä¸ºæ•°æ®çš„ä¸€ä¸ªå­é›†ç»˜åˆ¶æ¡å½¢å›¾ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{conditional\_bars }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, condition, var) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{filter}\NormalTok{(\{\{ condition \}\}) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ \{\{ var \}\})) }\SpecialCharTok{+} 
    \FunctionTok{geom\_bar}\NormalTok{()}
\NormalTok{\}}

\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} \FunctionTok{conditional\_bars}\NormalTok{(cut }\SpecialCharTok{==} \StringTok{"Good"}\NormalTok{, clarity)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{functions_files/figure-pdf/unnamed-chunk-49-1.pdf}

ä½ ä¹Ÿå¯ä»¥å‘æŒ¥åˆ›é€ åŠ›ï¼Œä»¥å…¶ä»–æ–¹å¼æ˜¾ç¤ºæ•°æ®æ±‡æ€»ã€‚ä½ 
å¯ä»¥åœ¨\url{https://gist.github.com/GShotwell/b19ef520b6d56f61a830fabb3454965b}æ‰¾åˆ°ä¸€ä¸ªå¾ˆé…·çš„åº”ç”¨ï¼›å®ƒä½¿ç”¨åæ ‡è½´æ ‡ç­¾æ¥æ˜¾ç¤ºæœ€é«˜å€¼ã€‚éš
ç€ä½ å¯¹ggplot2çš„äº†è§£è¶Šæ¥è¶Šå¤šï¼Œä½ çš„å‡½æ•°åŠŸèƒ½å°†ä¼šç»§ç»­å¢å¼ºã€‚

æœ€åï¼Œæˆ‘ä»¬å°†ç”¨ä¸€ä¸ªæ›´å¤æ‚çš„æ¡ˆä¾‹æ¥ç»“æŸï¼šæ ‡è®°ä½ åˆ›å»ºçš„å›¾ã€‚

\subsection{æ ‡è®°}\label{ux6807ux8bb0}

è¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰å±•ç¤ºçš„ç›´æ–¹å›¾å‡½æ•°å—ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{histogram }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, var, }\AttributeTok{binwidth =} \ConstantTok{NULL}\NormalTok{) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ \{\{ var \}\})) }\SpecialCharTok{+} 
    \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =}\NormalTok{ binwidth)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿç”¨æ‰€ä½¿ç”¨çš„å˜é‡å’Œç»„è·æ¥æ ‡è®°è¾“å‡ºï¼Œé‚£ä¸æ˜¯å¾ˆå¥½å—ï¼Ÿè¦
åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸æ·±å…¥äº†è§£æ•´é½è¯„ä¼°ï¼Œå¹¶ä½¿ç”¨æˆ‘ä»¬å°šæœªæåŠçš„rlangåŒ…ä¸­çš„ä¸€ä¸ªå‡½æ•°ã€‚r
langæ˜¯ä¸€ä¸ªåº•å±‚åŒ…ï¼Œtidyverseä¸­çš„å‡ ä¹æ¯ä¸ªå…¶ä»–åŒ…éƒ½ä½¿ç”¨å®ƒï¼Œå› ä¸ºå®ƒå®ç°äº†æ•´é½è¯„ä¼°
(ä»¥åŠå…¶ä»–è®¸å¤šæœ‰ç”¨çš„å·¥å…·)ã€‚

ä¸ºäº†è§£å†³æ ‡è®°é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{rlang::englue()}ï¼ˆæ³¨æ„ï¼šå®é™…å‡½æ•°ååº”è¯¥æ˜¯\texttt{rlang::glue()}ï¼‰ã€‚å®ƒ
çš„å·¥ä½œåŸç†ç±»ä¼¼äº\texttt{str\_glue()}ï¼Œæ‰€ä»¥ä»»ä½•è¢«å¤§æ‹¬å·\texttt{\{\}}åŒ…è£¹çš„å€¼éƒ½ä¼šè¢«æ’å…¥åˆ°å­—ç¬¦ä¸²ä¸­ã€‚ä½†
å®ƒä¹Ÿç†è§£\texttt{\{\{\}\}}ï¼Œä¼šè‡ªåŠ¨æ’å…¥é€‚å½“çš„å˜é‡åï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{histogram }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, var, binwidth) \{}
\NormalTok{  label }\OtherTok{\textless{}{-}}\NormalTok{ rlang}\SpecialCharTok{::}\FunctionTok{englue}\NormalTok{(}\StringTok{"A histogram of \{\{var\}\} with binwidth \{binwidth\}"}\NormalTok{)}
  
\NormalTok{  df }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ \{\{ var \}\})) }\SpecialCharTok{+} 
    \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =}\NormalTok{ binwidth) }\SpecialCharTok{+} 
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =}\NormalTok{ label)}
\NormalTok{\}}

\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} \FunctionTok{histogram}\NormalTok{(carat, }\FloatTok{0.1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{functions_files/figure-pdf/unnamed-chunk-51-1.pdf}

ä½ å¯ä»¥åœ¨ggplot2å›¾çš„ä»»ä½•éœ€è¦æä¾›å­—ç¬¦ä¸²çš„åœ°æ–¹ä½¿ç”¨ç›¸åŒçš„æ–¹æ³•ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-61}

é€šè¿‡é€æ­¥å®æ–½ä»¥ä¸‹æ¯ä¸ªæ­¥éª¤ï¼Œæ„å»ºä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„ç»˜å›¾å‡½æ•°ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  ç»™å®šæ•°æ®é›†å’Œ\texttt{x}ã€\texttt{y}å˜é‡ï¼Œç»˜åˆ¶æ•£ç‚¹å›¾ã€‚
\item
  æ·»åŠ æœ€ä½³æ‹Ÿåˆçº¿ï¼ˆå³æ²¡æœ‰æ ‡å‡†è¯¯å·®çš„çº¿æ€§æ¨¡å‹ï¼‰ã€‚
\item
  æ·»åŠ æ ‡é¢˜ã€‚
\end{enumerate}

\section{é£æ ¼}\label{ux98ceux683c}

Rä¸å…³å¿ƒä½ çš„å‡½æ•°æˆ–å‚æ•°å«ä»€ä¹ˆï¼Œä½†è¿™äº›åç§°å¯¹äººä»¬æ¥è¯´éå¸¸é‡è¦ã€‚ç†
æƒ³æƒ…å†µä¸‹ï¼Œä½ çš„å‡½æ•°ååº”è¯¥ç®€çŸ­ï¼Œä½†åˆèƒ½æ¸…æ¥šåœ°è¡¨è¾¾å‡½æ•°çš„åŠŸèƒ½ã€‚è¿™ å¾ˆéš¾ï¼ä½†
æ¸…æ™°æ¯”ç®€çŸ­æ›´é‡è¦ï¼Œå› ä¸º RStudio
çš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ä½¿å¾—è¾“å…¥é•¿åç§°å˜å¾—ç›¸å¯¹å®¹æ˜“ã€‚

ä¸€èˆ¬æ¥è¯´ï¼Œå‡½æ•°ååº”è¯¥æ˜¯åŠ¨è¯ï¼Œå‚æ•°åº”è¯¥æ˜¯åè¯ã€‚ä½†
ä¹Ÿæœ‰ä¸€äº›ä¾‹å¤–ï¼šå¦‚æœå‡½æ•°è®¡ç®—çš„æ˜¯ä¸€ä¸ªéå¸¸çŸ¥åçš„åè¯
(æ¯”å¦‚\texttt{mean()}æ¯”\texttt{compute\_mean()}æ›´å¥½)ï¼Œæˆ–è€…è®¿é—®å¯¹è±¡çš„æŸä¸ªå±æ€§(æ¯”å¦‚\texttt{coef()}æ¯”\texttt{get\_coefficients()}æ›´å¥½)ï¼Œé‚£ä¹ˆä½¿ç”¨åè¯ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚è¯·
æ ¹æ®ä½ çš„æœ€ä½³åˆ¤æ–­æ¥å‘½åï¼Œå¦‚æœåæ¥å‘ç°æ›´å¥½çš„åç§°ï¼Œä¸è¦æ‹…å¿ƒé‡å‘½åå‡½æ•°ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Too short}
\FunctionTok{f}\NormalTok{()}

\CommentTok{\# Not a verb, or descriptive}
\FunctionTok{my\_awesome\_function}\NormalTok{()}

\CommentTok{\# Long, but clear}
\FunctionTok{impute\_missing}\NormalTok{()}
\FunctionTok{collapse\_years}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

R ä¹Ÿä¸å…³å¿ƒä½ åœ¨å‡½æ•°ä¸­ä½¿ç”¨ç©ºæ ¼çš„æ–¹å¼ï¼Œä½†æœªæ¥çš„è¯»è€…ä¼šå…³å¿ƒã€‚è¯·
ç»§ç»­éµå¾ª@sec-workflow-style ä¸­çš„è§„åˆ™ã€‚æ­¤
å¤–ï¼Œ\texttt{function()}åé¢åº”è¯¥å§‹ç»ˆè·Ÿç€èŠ±æ‹¬å·ï¼ˆ\texttt{\{\}}ï¼‰ï¼Œå¹¶ä¸”å…¶å†…å®¹åº”è¯¥é¢å¤–ç¼©è¿›ä¸¤ä¸ªç©ºæ ¼ã€‚è¿™
æ ·ï¼Œé€šè¿‡æµè§ˆå·¦ä¾§è¾¹è·ï¼Œå¯ä»¥æ›´å®¹æ˜“åœ°çœ‹åˆ°ä»£ç ä¸­çš„å±‚æ¬¡ç»“æ„ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Missing extra two spaces}
\NormalTok{density }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(color, facets, }\AttributeTok{binwidth =} \FloatTok{0.1}\NormalTok{) \{}
\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat, }\AttributeTok{y =} \FunctionTok{after\_stat}\NormalTok{(density), }\AttributeTok{color =}\NormalTok{ \{\{ color \}\})) }\SpecialCharTok{+}
  \FunctionTok{geom\_freqpoly}\NormalTok{(}\AttributeTok{binwidth =}\NormalTok{ binwidth) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\FunctionTok{vars}\NormalTok{(\{\{ facets \}\}))}
\NormalTok{\}}

\CommentTok{\# Pipe indented incorrectly}
\NormalTok{density }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(color, facets, }\AttributeTok{binwidth =} \FloatTok{0.1}\NormalTok{) \{}
\NormalTok{  diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat, }\AttributeTok{y =} \FunctionTok{after\_stat}\NormalTok{(density), }\AttributeTok{color =}\NormalTok{ \{\{ color \}\})) }\SpecialCharTok{+}
  \FunctionTok{geom\_freqpoly}\NormalTok{(}\AttributeTok{binwidth =}\NormalTok{ binwidth) }\SpecialCharTok{+}
  \FunctionTok{facet\_wrap}\NormalTok{(}\FunctionTok{vars}\NormalTok{(\{\{ facets \}\}))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬å»ºè®®åœ¨\texttt{\{\ \}}å†…éƒ¨æ·»åŠ é¢å¤–çš„ç©ºæ ¼ã€‚è¿™
ä½¿å¾—å¾ˆå®¹æ˜“çœ‹å‡ºå¼‚å¸¸çš„å‘ç”Ÿã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-62}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  é˜…è¯»ä¸‹é¢ä¸¤ä¸ªå‡½æ•°çš„æºä»£ç ï¼Œå¼„æ¸…æ¥šå®ƒä»¬çš„ä½œç”¨ï¼Œç„¶åé›†æ€å¹¿ç›Šæƒ³å‡ºæ›´å¥½çš„åå­—ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{f1 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(string, prefix) \{}
  \FunctionTok{str\_sub}\NormalTok{(string, }\DecValTok{1}\NormalTok{, }\FunctionTok{str\_length}\NormalTok{(prefix)) }\SpecialCharTok{==}\NormalTok{ prefix}
\NormalTok{\}}

\NormalTok{f3 }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x, y) \{}
  \FunctionTok{rep}\NormalTok{(y, }\AttributeTok{length.out =} \FunctionTok{length}\NormalTok{(x))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}
\item
  æ‹¿ä¸€ä¸ªä½ æœ€è¿‘å†™çš„å‡½æ•°ï¼ŒèŠ±5åˆ†é’Ÿå¤´è„‘é£æš´ä¸ºå®ƒå’Œå®ƒçš„å‚æ•°å–ä¸€ä¸ªæ›´å¥½çš„åå­—ã€‚
\item
  è®¨è®ºä¸€ä¸‹ä¸ºä»€ä¹ˆ\texttt{norm\_r()},\texttt{norm\_d()}ç­‰ä¼šæ¯”\texttt{rnorm()},\texttt{dnorm()}æ›´å¥½ï¼Œå¹¶åŒæ—¶è®¨è®ºç›¸åçš„è§‚ç‚¹ã€‚ç„¶
  åï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿è¿™äº›åç§°æ›´åŠ æ¸…æ™°ã€‚
\end{enumerate}

\section{å°ç»“}\label{ux5c0fux7ed3-24}

åœ¨æœ¬ç« ä¸­ï¼Œä½ å­¦ä¹ äº†å¦‚ä½•ä¸ºä¸‰ç§æœ‰ç”¨çš„åœºæ™¯ç¼–å†™å‡½æ•°ï¼šåˆ›å»ºå‘é‡ã€åˆ›å»ºæ•°æ®æ¡†æˆ–åˆ›å»ºå›¾å½¢ã€‚åœ¨
æ­¤è¿‡ç¨‹ä¸­ï¼Œä½ çœ‹åˆ°äº†è®¸å¤šç¤ºä¾‹ï¼Œå¸Œæœ›è¿™äº›ç¤ºä¾‹èƒ½å¤Ÿæ¿€å‘ä½ çš„åˆ›é€ åŠ›ï¼Œå¹¶ä¸ºä½ æä¾›ä¸€äº›å…³äºå‡½æ•°å¦‚ä½•å¸®åŠ©ä½ åˆ†æä»£ç çš„æƒ³æ³•ã€‚

æˆ‘ä»¬åªå‘ä½ å±•ç¤ºäº†å‡½æ•°çš„åŸºç¡€çŸ¥è¯†ï¼Œè¿˜æœ‰å¾ˆå¤šå†…å®¹éœ€è¦å­¦ä¹ ã€‚ä»¥
ä¸‹æ˜¯ä¸€äº›æ·±å…¥å­¦ä¹ çš„åœ°æ–¹ï¼š

\begin{itemize}
\tightlist
\item
  è¦äº†è§£æ›´å¤šå…³äºä½¿ç”¨æ•´é½è¯„ä¼°è¿›è¡Œç¼–ç¨‹çš„ä¿¡æ¯ï¼Œè¯·å‚é˜…
  \href{https://dplyr.tidyverse.org/articles/programming.html}{programming
  with dplyr} å’Œ
  \href{https://tidyr.tidyverse.org/articles/programming.html}{programming
  with tidyr} çš„æœ‰ç”¨æ–¹æ³•ï¼Œå¹¶åœ¨
  \href{https://rlang.r-lib.org/reference/topic-data-mask.html}{What is
  data-masking and why do I need \{\{?} ä¸­äº†è§£æ›´å¤šå…³äºç†è®ºçš„çŸ¥è¯†ã€‚
\item
  è¦äº†è§£æ›´å¤šå…³äºå‡å°‘ggplot2ä»£ç ä¸­é‡å¤æ€§çš„ä¿¡æ¯ï¼Œè¯·é˜…è¯»ggplot2ä¹¦ç±ä¸­çš„\href{https://ggplot2-book.org/programming.html}{Programming
  with ggplot2} ç« èŠ‚ã€‚
\item
  æœ‰å…³å‡½æ•°é£æ ¼çš„æ›´å¤šå»ºè®®ï¼Œè¯·å‚é˜…
  \href{https://style.tidyverse.org/functions.html}{tidyverse style
  guide}ã€‚
\end{itemize}

åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨è¿­ä»£ï¼Œå®ƒä¸ºä½ æä¾›äº†æ›´å¤šå‡å°‘ä»£ç é‡å¤æ€§çš„å·¥å…·ã€‚

\chapter{è¿­ä»£}\label{sec-iteration}

\section{å¼•è¨€}\label{ux5f15ux8a00-21}

åœ¨è¿™ä¸€ç« ä¸­ï¼Œä½ å°†å­¦ä¹ åˆ°ç”¨äºè¿­ä»£çš„å·¥å…·ï¼Œå³åœ¨ä¸åŒå¯¹è±¡ä¸Šé‡å¤æ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚R
è¯­è¨€ä¸­çš„è¿­ä»£é€šå¸¸çœ‹èµ·æ¥ä¸å…¶ä»–ç¼–ç¨‹è¯­è¨€æœ‰å¾ˆå¤§çš„ä¸åŒï¼Œå› ä¸ºRè¯­è¨€ä¸­çš„å¾ˆå¤šè¿­ä»£æ˜¯éšå¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥å…è´¹å¾—åˆ°å®ƒã€‚

ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³åœ¨Rä¸­å°†æ•°å€¼å‘é‡\texttt{x}ç¿»å€ï¼Œåªéœ€å†™\texttt{2\ *\ x}å³å¯ã€‚è€Œ
åœ¨å¤§å¤šæ•°å…¶ä»–è¯­è¨€ä¸­ï¼Œä½ å¯èƒ½éœ€è¦ä½¿ç”¨æŸç§å½¢å¼çš„forå¾ªç¯æ¥æ˜ç¡®åœ°å°†\texttt{x}çš„æ¯ä¸ªå…ƒç´ ç¿»å€ã€‚

æœ¬ä¹¦å·²ç»å‘ä½ ä»‹ç»äº†ä¸€äº›è™½å°ä½†åŠŸèƒ½å¼ºå¤§çš„å·¥å…·ï¼Œè¿™äº›å·¥å…·å¯ä»¥å¯¹å¤šä¸ª``äº‹ç‰©''æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼š

\begin{itemize}
\tightlist
\item
  \texttt{facet\_wrap()} å’Œ \texttt{facet\_grid()}
  ä¸ºæ¯ä¸ªå­é›†ç»˜åˆ¶ä¸€ä¸ªå›¾å½¢ï¼›
\item
  \texttt{group\_by()} åŠ ä¸Š \texttt{summarize()}
  ä¸ºæ¯ä¸ªå­é›†è®¡ç®—æ‘˜è¦ç»Ÿè®¡ç»Ÿè®¡é‡ï¼›
\item
  \texttt{unnest\_wider()} å’Œ \texttt{unnest\_longer()}
  ä¸ºåˆ—è¡¨åˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ åˆ›å»ºæ–°çš„è¡Œå’Œåˆ—ã€‚
\end{itemize}

ç°åœ¨æ˜¯æ—¶å€™å­¦ä¹ ä¸€äº›æ›´é€šç”¨çš„å·¥å…·äº†ï¼Œè¿™äº›å·¥å…·é€šå¸¸è¢«ç§°ä¸ºå‡½æ•°å¼ç¼–ç¨‹
(\textbf{functional programming})
å·¥å…·ï¼Œå› ä¸ºå®ƒä»¬å»ºç«‹åœ¨å°†å…¶ä»–å‡½æ•°ä½œä¸ºè¾“å…¥çš„å‡½æ•°ä¹‹ä¸Šã€‚å­¦
ä¹ å‡½æ•°å¼ç¼–ç¨‹å¯èƒ½ä¼šå˜å¾—æŠ½è±¡åŒ–ï¼Œä½†åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡å…³æ³¨ä¸‰ä¸ªå¸¸è§ä»»åŠ¡æ¥ä½¿å†…å®¹å…·ä½“åŒ–ï¼šä¿®æ”¹å¤šä¸ªåˆ—ã€è¯»å–å¤šä¸ªæ–‡ä»¶ä»¥åŠä¿å­˜å¤šä¸ªå¯¹è±¡ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-22}

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨ç”±dplyrå’Œpurrræä¾›çš„å·¥å…·ï¼Œå®ƒä»¬éƒ½æ˜¯tidyverseçš„æ ¸å¿ƒæˆå‘˜ã€‚ä½ 
ä¹‹å‰å·²ç»è§è¿‡dplyrï¼Œä½†\texttt{purrr}æ˜¯æ–°çš„ã€‚æˆ‘
ä»¬æœ¬ç« åªä¼šä½¿ç”¨purrrçš„å‡ ä¸ªå‡½æ•°ï¼Œä½†éšç€ä½ ç¼–ç¨‹æŠ€èƒ½çš„æé«˜ï¼Œå®ƒæ˜¯ä¸€ä¸ªéå¸¸å€¼å¾—æ¢ç´¢çš„åŒ…ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\section{ä¿®æ”¹å¤šåˆ—}\label{sec-across}

æƒ³è±¡ä¸€ä¸‹ä½ æœ‰ä¸€ä¸ªç®€å•çš„tibbleï¼Œä½ æƒ³è¦è®¡ç®—æ¯ä¸€åˆ—çš„è§‚å¯Ÿå€¼æ•°é‡ä»¥åŠæ¯ä¸€åˆ—çš„ä¸­ä½æ•°ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{a =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{),}
  \AttributeTok{b =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{),}
  \AttributeTok{c =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{),}
  \AttributeTok{d =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥ä½¿ç”¨å¤åˆ¶-ç²˜è´´:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} \FunctionTok{summarize}\NormalTok{(}
  \AttributeTok{n =} \FunctionTok{n}\NormalTok{(),}
  \AttributeTok{a =} \FunctionTok{median}\NormalTok{(a),}
  \AttributeTok{b =} \FunctionTok{median}\NormalTok{(b),}
  \AttributeTok{c =} \FunctionTok{median}\NormalTok{(c),}
  \AttributeTok{d =} \FunctionTok{median}\NormalTok{(d),}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 5}
\CommentTok{\#\textgreater{}       n      a      b       c     d}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{}  \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1    10 {-}0.246 {-}0.287 {-}0.0567 0.144}
\end{Highlighting}
\end{Shaded}

è¿™æ‰“ç ´äº†æˆ‘ä»¬çš„ç»éªŒæ³•åˆ™ï¼Œå³æ°¸è¿œä¸è¦å¤åˆ¶ç²˜è´´è¶…è¿‡ä¸¤æ¬¡ï¼Œä½ å¯ä»¥æƒ³è±¡ï¼Œå¦‚æœä½ æœ‰æ•°åç”šè‡³æ•°ç™¾åˆ—ï¼Œè¿™å°†å˜å¾—éå¸¸ç¹çã€‚ç›¸
åï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{across()}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} \FunctionTok{summarize}\NormalTok{(}
  \AttributeTok{n =} \FunctionTok{n}\NormalTok{(),}
  \FunctionTok{across}\NormalTok{(a}\SpecialCharTok{:}\NormalTok{d, median),}
\NormalTok{)}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 5}
\CommentTok{\#\textgreater{}       n      a      b       c     d}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{}  \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1    10 {-}0.246 {-}0.287 {-}0.0567 0.144}
\end{Highlighting}
\end{Shaded}

\texttt{across()}å‡½æ•°æœ‰ä¸‰ä¸ªç‰¹åˆ«é‡è¦çš„å‚æ•°ï¼Œæˆ‘ä»¬å°†åœ¨ä»¥ä¸‹éƒ¨åˆ†ä¸­è¯¦ç»†è®¨è®ºå®ƒä»¬ã€‚æ¯
æ¬¡ä½¿ç”¨\texttt{across()}æ—¶ï¼Œä½ éƒ½ä¼šä½¿ç”¨å‰ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°\texttt{.cols}æŒ‡å®šä½ æƒ³è¦éå†çš„åˆ—ï¼Œç¬¬äºŒä¸ªå‚æ•°\texttt{.fns}æŒ‡å®šè¦å¯¹æ¯ä¸€åˆ—æ‰§è¡Œçš„æ“ä½œã€‚å½“
ä½ éœ€è¦å¯¹è¾“å‡ºåˆ—çš„åç§°è¿›è¡Œé¢å¤–æ§åˆ¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨\texttt{.names}å‚æ•°ï¼Œè¿™åœ¨ä¸\texttt{mutate()}å‡½æ•°ä¸€èµ·ä½¿ç”¨\texttt{across()}æ—¶å°¤ä¸ºé‡è¦ã€‚æ­¤
å¤–ï¼Œæˆ‘ä»¬è¿˜å°†è®¨è®ºä¸¤ä¸ªé‡è¦çš„å˜ä½“\texttt{if\_any()}å’Œ\texttt{if\_all()}ï¼Œå®ƒä»¬ä¸\texttt{filter()}å‡½æ•°ä¸€èµ·å·¥ä½œã€‚

\subsection{\texorpdfstring{ä½¿ç”¨\texttt{.cols}é€‰æ‹©åˆ—}{ä½¿ç”¨.colsé€‰æ‹©åˆ—}}\label{ux4f7fux7528.colsux9009ux62e9ux5217}

\texttt{across()}å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°\texttt{.cols}ç”¨äºé€‰æ‹©è¦è¿›è¡Œè½¬æ¢çš„åˆ—ã€‚è¿™
ä¸\texttt{select()}å‡½æ•°çš„æŒ‡å®šæ–¹å¼ç›¸åŒï¼Œå› æ­¤ä½ å¯ä»¥ä½¿ç”¨åƒ\texttt{starts\_with()}å’Œ\texttt{ends\_with()}è¿™æ ·çš„å‡½æ•°ï¼Œæ ¹æ®åˆ—åæ¥é€‰æ‹©åˆ—ã€‚

æœ‰ä¸¤ç§é¢å¤–çš„é€‰æ‹©æŠ€æœ¯å¯¹äº\texttt{across()}ç‰¹åˆ«æœ‰ç”¨ï¼š\texttt{everything()}å’Œ\texttt{where()}ã€‚\texttt{e}
\texttt{verything()}å¾ˆç®€å•ï¼šå®ƒé€‰æ‹©æ‰€æœ‰ï¼ˆéåˆ†ç»„ï¼‰åˆ—ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{grp =} \FunctionTok{sample}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{10}\NormalTok{, }\AttributeTok{replace =} \ConstantTok{TRUE}\NormalTok{),}
  \AttributeTok{a =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{),}
  \AttributeTok{b =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{),}
  \AttributeTok{c =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{),}
  \AttributeTok{d =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{)}
\NormalTok{)}

\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(grp) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{everything}\NormalTok{(), median))}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 5}
\CommentTok{\#\textgreater{}     grp       a       b     c     d}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{}   \textless{}dbl\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1 {-}0.0935 {-}0.0163 0.363 0.364}
\CommentTok{\#\textgreater{} 2     2  0.312  {-}0.0576 0.208 0.565}
\end{Highlighting}
\end{Shaded}

æ³¨æ„ï¼Œåˆ†ç»„åˆ—ï¼ˆåœ¨æ­¤å¤„ä¸º
\texttt{grp}ï¼‰ä¸ä¼šè¢«åŒ…å«åœ¨\texttt{across()}ä¸­ï¼Œå› ä¸ºå®ƒä»¬åœ¨\texttt{summarize()}ä¸­ä¼šè¢«è‡ªåŠ¨ä¿ç•™ã€‚

\texttt{where()}å…è®¸ä½ æ ¹æ®åˆ—çš„ç±»å‹æ¥é€‰æ‹©åˆ—ï¼š

\begin{itemize}
\tightlist
\item
  \texttt{where(is.numeric)} é€‰æ‹©æ‰€æœ‰æ•°å€¼åˆ—ã€‚
\item
  \texttt{where(is.character)} é€‰æ‹©æ‰€æœ‰å­—ç¬¦ä¸²åˆ—ã€‚
\item
  \texttt{where(is.Date)} é€‰æ‹©æ‰€æœ‰æ—¥æœŸåˆ—ã€‚
\item
  \texttt{where(is.POSIXct)} é€‰æ‹©æ‰€æœ‰æ—¥æœŸæ—¶é—´åˆ—ã€‚
\item
  \texttt{where(is.logical)} é€‰æ‹©æ‰€æœ‰é€»è¾‘åˆ—ã€‚
\end{itemize}

å°±åƒå…¶ä»–é€‰æ‹©å™¨ä¸€æ ·ï¼Œä½ å¯ä»¥ä½¿ç”¨å¸ƒå°”ä»£æ•°å°†å®ƒä»¬ç»„åˆèµ·æ¥ã€‚ä¾‹ å¦‚
\texttt{!where(is.numeric)} é€‰æ‹©æ‰€æœ‰éæ•°å€¼åˆ—ï¼Œè€Œ
\texttt{starts\_with("a")\ \&\ where(is.logical)} é€‰æ‹©æ‰€æœ‰åç§°ä»¥ ``a''
å¼€å¤´çš„é€»è¾‘åˆ—ã€‚

\subsection{è°ƒç”¨å•ä¸ªå‡½æ•°}\label{ux8c03ux7528ux5355ux4e2aux51fdux6570}

\texttt{across()} çš„ç¬¬äºŒä¸ªå‚æ•°å®šä¹‰äº†å°†å¦‚ä½•è½¬æ¢æ¯ä¸€åˆ—ã€‚åœ¨
å¦‚ä¸Šæ‰€è¿°çš„ç®€å•ä¾‹å­ä¸­ï¼Œè¿™å°†æ˜¯ä¸€ä¸ªç°æœ‰çš„å‡½æ•°ã€‚è¿™ æ˜¯ R
è¯­è¨€çš„ä¸€ä¸ªéå¸¸ç‰¹åˆ«çš„åŠŸèƒ½ï¼šæˆ‘ä»¬å°†ä¸€ä¸ªå‡½æ•° (å¦‚
\texttt{median}ã€\texttt{mean}ã€\texttt{str\_flatten} ç­‰)
ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•° (å³\texttt{across})ã€‚è¿™ æ˜¯ä½¿ R
æˆä¸ºä¸€ç§å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€çš„ç‰¹æ€§ä¹‹ä¸€ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å°†è¿™ä¸ªå‡½æ•°ä¼ é€’ç»™\texttt{across()}ï¼Œå› æ­¤æ˜¯\texttt{across()}æ¥è°ƒç”¨å®ƒï¼Œæˆ‘ä»¬è‡ªå·±ä¸ç›´æ¥è°ƒç”¨å®ƒã€‚è¿™
æ„å‘³ç€å‡½æ•°ååé¢ä¸åº”è¯¥æœ‰æ‹¬å· \texttt{()}ã€‚å¦‚
æœä½ å¿˜è®°äº†è¿™ä¸€ç‚¹ï¼Œå°†ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(grp) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\FunctionTok{across}\NormalTok{(}\FunctionTok{everything}\NormalTok{(), }\FunctionTok{median}\NormalTok{()))}
\CommentTok{\#\textgreater{} Error in \textasciigrave{}summarize()\textasciigrave{}:}
\CommentTok{\#\textgreater{} i In argument: \textasciigrave{}across(everything(), median())\textasciigrave{}.}
\CommentTok{\#\textgreater{} Caused by error in \textasciigrave{}median.default()\textasciigrave{}:}
\CommentTok{\#\textgreater{} ! argument "x" is missing, with no default}
\end{Highlighting}
\end{Shaded}

å‡ºç°æ­¤é”™è¯¯æ˜¯å› ä¸ºä½ åœ¨æ²¡æœ‰è¾“å…¥çš„æƒ…å†µä¸‹è°ƒç”¨å‡½æ•°ï¼Œä¾‹å¦‚:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{median}\NormalTok{()}
\CommentTok{\#\textgreater{} Error in median.default(): argument "x" is missing, with no default}
\end{Highlighting}
\end{Shaded}

\subsection{è°ƒç”¨å¤šä¸ªå‡½æ•°}\label{ux8c03ux7528ux591aux4e2aux51fdux6570}

åœ¨æ›´å¤æ‚çš„æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½æƒ³è¦æä¾›é¢å¤–çš„å‚æ•°æˆ–æ‰§è¡Œå¤šä¸ªè½¬æ¢ã€‚è®©
æˆ‘ä»¬ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜è¿™ä¸ªé—®é¢˜ï¼šå¦‚æœæˆ‘ä»¬çš„æ•°æ®ä¸­æœ‰ä¸€äº›ç¼ºå¤±å€¼ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ\texttt{m}
\texttt{edian()}å‡½æ•°ä¼šä¼ æ’­è¿™äº›ç¼ºå¤±å€¼ï¼Œå¯¼è‡´æˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªæ¬¡ä¼˜çš„è¾“å‡ºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rnorm\_na }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(n, n\_na, }\AttributeTok{mean =} \DecValTok{0}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{) \{}
  \FunctionTok{sample}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(n }\SpecialCharTok{{-}}\NormalTok{ n\_na, }\AttributeTok{mean =}\NormalTok{ mean, }\AttributeTok{sd =}\NormalTok{ sd), }\FunctionTok{rep}\NormalTok{(}\ConstantTok{NA}\NormalTok{, n\_na)))}
\NormalTok{\}}

\NormalTok{df\_miss }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{a =} \FunctionTok{rnorm\_na}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{1}\NormalTok{),}
  \AttributeTok{b =} \FunctionTok{rnorm\_na}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{1}\NormalTok{),}
  \AttributeTok{c =} \FunctionTok{rnorm\_na}\NormalTok{(}\DecValTok{5}\NormalTok{, }\DecValTok{2}\NormalTok{),}
  \AttributeTok{d =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\NormalTok{)}
\NormalTok{df\_miss }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \FunctionTok{across}\NormalTok{(a}\SpecialCharTok{:}\NormalTok{d, median),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{()}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 5}
\CommentTok{\#\textgreater{}       a     b     c     d     n}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1    NA    NA    NA  1.15     5}
\end{Highlighting}
\end{Shaded}

å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿå°†\texttt{na.rm\ =\ TRUE}ä¼ é€’ç»™\texttt{median()}æ¥ç§»é™¤è¿™äº›ç¼ºå¤±å€¼ï¼Œé‚£å°†æ˜¯éå¸¸å¥½çš„ã€‚è¦
åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°å‡½æ•°ï¼Œè¯¥å‡½æ•°ä»¥æœŸæœ›çš„å‚æ•°è°ƒç”¨\texttt{median()}ï¼Œè€Œä¸æ˜¯ç›´æ¥è°ƒç”¨\texttt{median()}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_miss }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \FunctionTok{across}\NormalTok{(a}\SpecialCharTok{:}\NormalTok{d, }\ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{median}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{()}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 5}
\CommentTok{\#\textgreater{}       a     b      c     d     n}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 0.139 {-}1.11 {-}0.387  1.15     5}
\end{Highlighting}
\end{Shaded}

è¿™æ ·å†™æœ‰äº›å†—é•¿ï¼Œæ‰€ä»¥ R
æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„å¿«æ·æ–¹å¼ï¼šå¯¹äºè¿™ç§ä¸€æ¬¡æ€§æˆ–åŒ¿åå‡½æ•°\footnote{åŒ¿åï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬ä»æœªç”¨\texttt{\textless{}-}æ˜ç¡®ç»™å®ƒä¸€ä¸ªåç§°ã€‚ç¨‹
  åºå‘˜ç”¨æ¥ç§°å‘¼è¿™ç§å‡½æ•°çš„å¦ä¸€ä¸ªæœ¯è¯­æ˜¯``lambda å‡½æ•°''ã€‚}ï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{\textbackslash{}}\footnote{åœ¨æ—§ç‰ˆæœ¬çš„ä»£ç ä¸­ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°åƒ\texttt{\textasciitilde{}\ .x\ +\ 1}è¿™æ ·çš„è¯­æ³•ã€‚è¿™
  æ˜¯ç¼–å†™åŒ¿åå‡½æ•°çš„å¦ä¸€ç§æ–¹å¼ï¼Œä½†å®ƒåªèƒ½åœ¨ tidyverse
  å‡½æ•°å†…éƒ¨ä½¿ç”¨ï¼Œå¹¶ä¸”æ€»æ˜¯ä½¿ç”¨å˜é‡å\texttt{.x}ã€‚ç°
  åœ¨æˆ‘ä»¬æ¨èä½¿ç”¨åŸºç¡€è¯­æ³•ï¼Œå³\texttt{\textbackslash{}(x)\ x\ +\ 1}ã€‚}æ¥ä»£æ›¿\texttt{function}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_miss }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \FunctionTok{across}\NormalTok{(a}\SpecialCharTok{:}\NormalTok{d, \textbackslash{}(x) }\FunctionTok{median}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{()}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œ\texttt{across()}å®é™…ä¸Šéƒ½ä¼šå±•å¼€ä¸ºä»¥ä¸‹ä»£ç ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_miss }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{a =} \FunctionTok{median}\NormalTok{(a, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{b =} \FunctionTok{median}\NormalTok{(b, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{c =} \FunctionTok{median}\NormalTok{(c, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{d =} \FunctionTok{median}\NormalTok{(d, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{()}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

å½“æˆ‘ä»¬ä»\texttt{median()}ä¸­ç§»é™¤ç¼ºå¤±å€¼æ—¶ï¼ŒçŸ¥é“ç§»é™¤äº†å¤šå°‘å€¼ä¼šå¾ˆæœ‰ç”¨ã€‚æˆ‘
ä»¬å¯ä»¥é€šè¿‡å‘\texttt{across()}æä¾›ä¸¤ä¸ªå‡½æ•°æ¥æ‰¾å‡ºè¿™ä¸€ç‚¹ï¼šä¸€ä¸ªç”¨äºè®¡ç®—ä¸­ä½æ•°ï¼Œå¦ä¸€ä¸ªç”¨äºè®¡ç®—ç¼ºå¤±å€¼çš„æ•°é‡ã€‚ä½ 
å¯ä»¥é€šè¿‡å‘\texttt{.fns}æä¾›ä¸€ä¸ªå‘½ååˆ—è¡¨æ¥æä¾›å¤šä¸ªå‡½æ•°ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_miss }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \FunctionTok{across}\NormalTok{(a}\SpecialCharTok{:}\NormalTok{d, }\FunctionTok{list}\NormalTok{(}
      \AttributeTok{median =}\NormalTok{ \textbackslash{}(x) }\FunctionTok{median}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
      \AttributeTok{n\_miss =}\NormalTok{ \textbackslash{}(x) }\FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(x))}
\NormalTok{    )),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{()}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 9}
\CommentTok{\#\textgreater{}   a\_median a\_n\_miss b\_median b\_n\_miss c\_median c\_n\_miss d\_median d\_n\_miss}
\CommentTok{\#\textgreater{}      \textless{}dbl\textgreater{}    \textless{}int\textgreater{}    \textless{}dbl\textgreater{}    \textless{}int\textgreater{}    \textless{}dbl\textgreater{}    \textless{}int\textgreater{}    \textless{}dbl\textgreater{}    \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1    0.139        1    {-}1.11        1   {-}0.387        2     1.15        0}
\CommentTok{\#\textgreater{} \# i 1 more variable: n \textless{}int\textgreater{}}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ ä»”ç»†è§‚å¯Ÿï¼Œä½ å¯èƒ½ä¼šç›´è§‰åœ°è®¤ä¸ºåˆ—åæ˜¯ä½¿ç”¨ç±»ä¼¼\texttt{\{.col\}\_\{.fn\}}çš„
glue è§„èŒƒ(å°èŠ‚~\ref{sec-glue})
æ¥å‘½åçš„ï¼Œå…¶ä¸­\texttt{.col}æ˜¯åŸå§‹åˆ—çš„åç§°ï¼Œ\texttt{.fn}æ˜¯å‡½æ•°çš„åç§°ã€‚è¿™
å¹¶ä¸æ˜¯å·§åˆï¼æ­£
å¦‚ä½ å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­å­¦åˆ°çš„ï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{.names}å‚æ•°æ¥æä¾›ä½ è‡ªå·±çš„ glue
è§„èŒƒã€‚

\subsection{åˆ—å}\label{ux5217ux540d}

\texttt{across()}å‡½æ•°çš„ç»“æœæ˜¯æ ¹æ®\texttt{.names}å‚æ•°ä¸­æä¾›çš„è§„èŒƒæ¥å‘½åçš„ã€‚å¦‚
æœæˆ‘ä»¬æƒ³è¦å‡½æ•°çš„åå­—é¦–å…ˆå‡ºç°\footnote{å½“å‰ä¸èƒ½æ›´æ”¹åˆ—çš„é¡ºåºï¼Œä½†å¯ä»¥åœ¨äº‹åä½¿ç”¨\texttt{relocate()}æˆ–ç±»ä¼¼çš„æ–¹æ³•é‡æ–°æ’åºã€‚}ï¼Œå¯ä»¥è‡ªå·±æŒ‡å®šã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_miss }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \FunctionTok{across}\NormalTok{(}
\NormalTok{      a}\SpecialCharTok{:}\NormalTok{d,}
      \FunctionTok{list}\NormalTok{(}
        \AttributeTok{median =}\NormalTok{ \textbackslash{}(x) }\FunctionTok{median}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{),}
        \AttributeTok{n\_miss =}\NormalTok{ \textbackslash{}(x) }\FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(x))}
\NormalTok{      ),}
      \AttributeTok{.names =} \StringTok{"\{.fn\}\_\{.col\}"}
\NormalTok{    ),}
    \AttributeTok{n =} \FunctionTok{n}\NormalTok{(),}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 9}
\CommentTok{\#\textgreater{}   median\_a n\_miss\_a median\_b n\_miss\_b median\_c n\_miss\_c median\_d n\_miss\_d}
\CommentTok{\#\textgreater{}      \textless{}dbl\textgreater{}    \textless{}int\textgreater{}    \textless{}dbl\textgreater{}    \textless{}int\textgreater{}    \textless{}dbl\textgreater{}    \textless{}int\textgreater{}    \textless{}dbl\textgreater{}    \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1    0.139        1    {-}1.11        1   {-}0.387        2     1.15        0}
\CommentTok{\#\textgreater{} \# i 1 more variable: n \textless{}int\textgreater{}}
\end{Highlighting}
\end{Shaded}

\texttt{.names}å‚æ•°åœ¨ä½ ä½¿ç”¨\texttt{across()}ä¸\texttt{mutate()}ä¸€èµ·æ—¶ç‰¹åˆ«é‡è¦ã€‚é»˜
è®¤æƒ…å†µä¸‹ï¼Œ\texttt{across()}çš„è¾“å‡ºä¼šä½¿ç”¨ä¸è¾“å…¥ç›¸åŒçš„åç§°ã€‚è¿™
æ„å‘³ç€åœ¨\texttt{mutate()}å†…éƒ¨çš„\texttt{across(}~ä¼šæ›¿æ¢ç°æœ‰çš„åˆ—ã€‚ä¾‹å¦‚ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨\texttt{coalesce()}æ¥å°†
\texttt{NA} å€¼æ›¿æ¢ä¸º \texttt{0}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_miss }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \FunctionTok{across}\NormalTok{(a}\SpecialCharTok{:}\NormalTok{d, \textbackslash{}(x) }\FunctionTok{coalesce}\NormalTok{(x, }\DecValTok{0}\NormalTok{))}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 5 x 4}
\CommentTok{\#\textgreater{}        a      b      c     d}
\CommentTok{\#\textgreater{}    \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1  0.434 {-}1.25   0     1.60 }
\CommentTok{\#\textgreater{} 2  0     {-}1.43  {-}0.297 0.776}
\CommentTok{\#\textgreater{} 3 {-}0.156 {-}0.980  0     1.15 }
\CommentTok{\#\textgreater{} 4 {-}2.61  {-}0.683 {-}0.785 2.13 }
\CommentTok{\#\textgreater{} 5  1.11   0     {-}0.387 0.704}
\end{Highlighting}
\end{Shaded}

å¦‚æœæƒ³è¦åˆ›å»ºæ–°çš„åˆ—ï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{.names}å‚æ•°æ¥ä¸ºè¾“å‡ºæŒ‡å®šæ–°çš„åç§°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_miss }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \FunctionTok{across}\NormalTok{(a}\SpecialCharTok{:}\NormalTok{d, \textbackslash{}(x) }\FunctionTok{coalesce}\NormalTok{(x, }\DecValTok{0}\NormalTok{), }\AttributeTok{.names =} \StringTok{"\{.col\}\_na\_zero"}\NormalTok{)}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 5 x 8}
\CommentTok{\#\textgreater{}        a      b      c     d a\_na\_zero b\_na\_zero c\_na\_zero d\_na\_zero}
\CommentTok{\#\textgreater{}    \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1  0.434 {-}1.25  NA     1.60      0.434    {-}1.25      0         1.60 }
\CommentTok{\#\textgreater{} 2 NA     {-}1.43  {-}0.297 0.776     0        {-}1.43     {-}0.297     0.776}
\CommentTok{\#\textgreater{} 3 {-}0.156 {-}0.980 NA     1.15     {-}0.156    {-}0.980     0         1.15 }
\CommentTok{\#\textgreater{} 4 {-}2.61  {-}0.683 {-}0.785 2.13     {-}2.61     {-}0.683    {-}0.785     2.13 }
\CommentTok{\#\textgreater{} 5  1.11  NA     {-}0.387 0.704     1.11      0        {-}0.387     0.704}
\end{Highlighting}
\end{Shaded}

\subsection{ç­›é€‰}\label{ux7b5bux9009}

\texttt{across()}éå¸¸é€‚åˆä¸\texttt{summarize()}å’Œ\texttt{mutate()}ä¸€èµ·ä½¿ç”¨ï¼Œä½†æ˜¯ä¸\texttt{filter()}ä¸€èµ·ä½¿ç”¨æ—¶åˆ™æ˜¾å¾—ä¸å¤ªæ–¹ä¾¿ï¼Œå› ä¸ºä½ é€šå¸¸ä½¿ç”¨\texttt{\textbar{}}æˆ–\texttt{\&}æ¥ç»„åˆå¤šä¸ªæ¡ä»¶ã€‚æ˜¾
ç„¶ï¼Œ\texttt{across()}å¯ä»¥å¸®åŠ©åˆ›å»ºå¤šä¸ªé€»è¾‘åˆ—ï¼Œä½†æ¥ä¸‹æ¥æ€ä¹ˆåšå‘¢ï¼Ÿå› 
æ­¤ï¼Œdplyr
æä¾›äº†\texttt{across()}çš„ä¸¤ä¸ªå˜ä½“ï¼Œåˆ†åˆ«å«åš\texttt{if\_any()}å’Œ\texttt{if\_all()}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# same as df\_miss |\textgreater{} filter(is.na(a) | is.na(b) | is.na(c) | is.na(d))}
\NormalTok{df\_miss }\SpecialCharTok{|\textgreater{}} \FunctionTok{filter}\NormalTok{(}\FunctionTok{if\_any}\NormalTok{(a}\SpecialCharTok{:}\NormalTok{d, is.na))}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 4}
\CommentTok{\#\textgreater{}        a      b      c     d}
\CommentTok{\#\textgreater{}    \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1  0.434 {-}1.25  NA     1.60 }
\CommentTok{\#\textgreater{} 2 NA     {-}1.43  {-}0.297 0.776}
\CommentTok{\#\textgreater{} 3 {-}0.156 {-}0.980 NA     1.15 }
\CommentTok{\#\textgreater{} 4  1.11  NA     {-}0.387 0.704}

\CommentTok{\# same as df\_miss |\textgreater{} filter(is.na(a) \& is.na(b) \& is.na(c) \& is.na(d))}
\NormalTok{df\_miss }\SpecialCharTok{|\textgreater{}} \FunctionTok{filter}\NormalTok{(}\FunctionTok{if\_all}\NormalTok{(a}\SpecialCharTok{:}\NormalTok{d, is.na))}
\CommentTok{\#\textgreater{} \# A tibble: 0 x 4}
\CommentTok{\#\textgreater{} \# i 4 variables: a \textless{}dbl\textgreater{}, b \textless{}dbl\textgreater{}, c \textless{}dbl\textgreater{}, d \textless{}dbl\textgreater{}}
\end{Highlighting}
\end{Shaded}

\subsection{\texorpdfstring{å‡½æ•°ä¸­çš„
\texttt{across()}}{å‡½æ•°ä¸­çš„ across()}}\label{ux51fdux6570ux4e2dux7684-across}

\texttt{across()}åœ¨ç¼–ç¨‹æ—¶ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸ä½ å¯¹å¤šä¸ªåˆ—è¿›è¡Œæ“ä½œã€‚ä¾‹
å¦‚ï¼Œ\href{https://twitter.com/_wurli/status/1571836746899283969}{Jacob
Scott}
ä½¿ç”¨äº†ä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å°è£…äº†ä¸€ç»„\texttt{lubridate}å‡½æ•°ï¼Œç”¨äºå°†æ‰€æœ‰æ—¥æœŸåˆ—æ‰©å±•ä¸ºå¹´ã€æœˆå’Œæ—¥åˆ—ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{expand\_dates }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{mutate}\NormalTok{(}
      \FunctionTok{across}\NormalTok{(}\FunctionTok{where}\NormalTok{(is.Date), }\FunctionTok{list}\NormalTok{(}\AttributeTok{year =}\NormalTok{ year, }\AttributeTok{month =}\NormalTok{ month, }\AttributeTok{day =}\NormalTok{ mday))}
\NormalTok{    )}
\NormalTok{\}}

\NormalTok{df\_date }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{name =} \FunctionTok{c}\NormalTok{(}\StringTok{"Amy"}\NormalTok{, }\StringTok{"Bob"}\NormalTok{),}
  \AttributeTok{date =} \FunctionTok{ymd}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"2009{-}08{-}03"}\NormalTok{, }\StringTok{"2010{-}01{-}16"}\NormalTok{))}
\NormalTok{)}

\NormalTok{df\_date }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{expand\_dates}\NormalTok{()}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 5}
\CommentTok{\#\textgreater{}   name  date       date\_year date\_month date\_day}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{} \textless{}date\textgreater{}         \textless{}dbl\textgreater{}      \textless{}dbl\textgreater{}    \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 Amy   2009{-}08{-}03      2009          8        3}
\CommentTok{\#\textgreater{} 2 Bob   2010{-}01{-}16      2010          1       16}
\end{Highlighting}
\end{Shaded}

\texttt{across()}è¿˜ä½¿å¾—åœ¨ä¸€ä¸ªå‚æ•°ä¸­æä¾›å¤šä¸ªåˆ—å˜å¾—å®¹æ˜“ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä½¿ç”¨äº†æ•´é½é€‰æ‹©ï¼Œä½ åªéœ€è¦è®°ä½è¦æ‹¥æŠ±è¿™ä¸ªå‚æ•°ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨
å°èŠ‚~\ref{sec-embracing} æ‰€è®¨è®ºçš„ã€‚ä¾‹
å¦‚ï¼Œè¿™ä¸ªå‡½æ•°é»˜è®¤ä¼šè®¡ç®—æ•°å­—åˆ—çš„å‡æ•°ã€‚ä½†
æ˜¯ï¼Œé€šè¿‡æä¾›ç¬¬äºŒä¸ªå‚æ•°ï¼Œä½ å¯ä»¥é€‰æ‹©ä»…æ±‡æ€»é€‰å®šçš„åˆ—ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{summarize\_means }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, }\AttributeTok{summary\_vars =} \FunctionTok{where}\NormalTok{(is.numeric)) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{summarize}\NormalTok{(}
      \FunctionTok{across}\NormalTok{(\{\{ summary\_vars \}\}, \textbackslash{}(x) }\FunctionTok{mean}\NormalTok{(x, }\AttributeTok{na.rm =} \ConstantTok{TRUE}\NormalTok{)),}
      \AttributeTok{n =} \FunctionTok{n}\NormalTok{(),}
      \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{    )}
\NormalTok{\}}
\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(cut) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize\_means}\NormalTok{()}
\CommentTok{\#\textgreater{} \# A tibble: 5 x 9}
\CommentTok{\#\textgreater{}   cut       carat depth table price     x     y     z     n}
\CommentTok{\#\textgreater{}   \textless{}ord\textgreater{}     \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 Fair      1.05   64.0  59.1 4359.  6.25  6.18  3.98  1610}
\CommentTok{\#\textgreater{} 2 Good      0.849  62.4  58.7 3929.  5.84  5.85  3.64  4906}
\CommentTok{\#\textgreater{} 3 Very Good 0.806  61.8  58.0 3982.  5.74  5.77  3.56 12082}
\CommentTok{\#\textgreater{} 4 Premium   0.892  61.3  58.7 4584.  5.97  5.94  3.65 13791}
\CommentTok{\#\textgreater{} 5 Ideal     0.703  61.7  56.0 3458.  5.51  5.52  3.40 21551}

\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(cut) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize\_means}\NormalTok{(}\FunctionTok{c}\NormalTok{(carat, x}\SpecialCharTok{:}\NormalTok{z))}
\CommentTok{\#\textgreater{} \# A tibble: 5 x 6}
\CommentTok{\#\textgreater{}   cut       carat     x     y     z     n}
\CommentTok{\#\textgreater{}   \textless{}ord\textgreater{}     \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 Fair      1.05   6.25  6.18  3.98  1610}
\CommentTok{\#\textgreater{} 2 Good      0.849  5.84  5.85  3.64  4906}
\CommentTok{\#\textgreater{} 3 Very Good 0.806  5.74  5.77  3.56 12082}
\CommentTok{\#\textgreater{} 4 Premium   0.892  5.97  5.94  3.65 13791}
\CommentTok{\#\textgreater{} 5 Ideal     0.703  5.51  5.52  3.40 21551}
\end{Highlighting}
\end{Shaded}

\subsection{\texorpdfstring{ä¸ \texttt{pivot\_longer()}
æ¯”è¾ƒ}{ä¸ pivot\_longer() æ¯”è¾ƒ}}\label{ux4e0e-pivot_longer-ux6bd4ux8f83}

åœ¨ç»§ç»­ä¹‹å‰ï¼Œå€¼å¾—ä¸€æçš„æ˜¯\texttt{across()}å’Œ\texttt{pivot\_longer()}ä¹‹é—´çš„ä¸€ä¸ªæœ‰è¶£è”ç³»
(å°èŠ‚~\ref{sec-pivoting})ã€‚åœ¨
è®¸å¤šæƒ…å†µä¸‹è¦æ‰§è¡Œç›¸åŒçš„è®¡ç®—ï¼Œä½ é¦–å…ˆè¦é‡å¡‘æ•°æ®ï¼Œç„¶åæŒ‰ç»„(è€Œä¸æ˜¯æŒ‰åˆ—)æ‰§è¡Œæ“ä½œã€‚ä»¥
ä¸‹é¢è¿™ä¸ªå¤šå‡½æ•°æ€»æ±‡æ€»ä¾‹:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\FunctionTok{across}\NormalTok{(a}\SpecialCharTok{:}\NormalTok{d, }\FunctionTok{list}\NormalTok{(}\AttributeTok{median =}\NormalTok{ median, }\AttributeTok{mean =}\NormalTok{ mean)))}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 8}
\CommentTok{\#\textgreater{}   a\_median a\_mean b\_median b\_mean c\_median c\_mean d\_median d\_mean}
\CommentTok{\#\textgreater{}      \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1   0.0380  0.205  {-}0.0163 0.0910    0.260 0.0716    0.540  0.508}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†æ•°æ®é‡å¡‘ä¸ºé•¿æ ¼å¼ï¼Œç„¶åè¿›è¡Œæ±‡æ€»è®¡ç®—å¾—åˆ°ç›¸åŒçš„å€¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{long }\OtherTok{\textless{}{-}}\NormalTok{ df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_longer}\NormalTok{(a}\SpecialCharTok{:}\NormalTok{d) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(name) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}
    \AttributeTok{median =} \FunctionTok{median}\NormalTok{(value),}
    \AttributeTok{mean =} \FunctionTok{mean}\NormalTok{(value)}
\NormalTok{  )}
\NormalTok{long}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 3}
\CommentTok{\#\textgreater{}   name   median   mean}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}   \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 a      0.0380 0.205 }
\CommentTok{\#\textgreater{} 2 b     {-}0.0163 0.0910}
\CommentTok{\#\textgreater{} 3 c      0.260  0.0716}
\CommentTok{\#\textgreater{} 4 d      0.540  0.508}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ æƒ³è¦ä¸\texttt{across()}ç›¸åŒçš„ç»“æ„ï¼Œä½ å¯ä»¥å†æ¬¡é‡å¡‘:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{long }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_wider}\NormalTok{(}
    \AttributeTok{names\_from =}\NormalTok{ name,}
    \AttributeTok{values\_from =} \FunctionTok{c}\NormalTok{(median, mean),}
    \AttributeTok{names\_vary =} \StringTok{"slowest"}\NormalTok{,}
    \AttributeTok{names\_glue =} \StringTok{"\{name\}\_\{.value\}"}
\NormalTok{  )}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 8}
\CommentTok{\#\textgreater{}   a\_median a\_mean b\_median b\_mean c\_median c\_mean d\_median d\_mean}
\CommentTok{\#\textgreater{}      \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}  \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1   0.0380  0.205  {-}0.0163 0.0910    0.260 0.0716    0.540  0.508}
\end{Highlighting}
\end{Shaded}

äº†è§£è¿™ç§æŠ€æœ¯æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œå› ä¸ºæœ‰æ—¶ä½ ä¼šé‡åˆ°ç›®å‰æ— æ³•ä½¿ç”¨\texttt{across()}è§£å†³çš„é—®é¢˜ï¼šå½“æœ‰ä¸€ç»„åˆ—ï¼Œä½ æƒ³è¦åŒæ—¶å¯¹è¿™äº›åˆ—è¿›è¡Œè®¡ç®—æ—¶ã€‚ä¾‹
å¦‚ï¼Œå‡è®¾æˆ‘ä»¬çš„æ•°æ®æ¡†åŒæ—¶åŒ…å«å€¼å’Œæƒé‡ï¼Œå¹¶ä¸”æˆ‘ä»¬æƒ³è¦è®¡ç®—åŠ æƒå¹³å‡æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_paired }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{a\_val =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{),}
  \AttributeTok{a\_wts =} \FunctionTok{runif}\NormalTok{(}\DecValTok{10}\NormalTok{),}
  \AttributeTok{b\_val =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{),}
  \AttributeTok{b\_wts =} \FunctionTok{runif}\NormalTok{(}\DecValTok{10}\NormalTok{),}
  \AttributeTok{c\_val =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{),}
  \AttributeTok{c\_wts =} \FunctionTok{runif}\NormalTok{(}\DecValTok{10}\NormalTok{),}
  \AttributeTok{d\_val =} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{10}\NormalTok{),}
  \AttributeTok{d\_wts =} \FunctionTok{runif}\NormalTok{(}\DecValTok{10}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

ç›®å‰æ— æ³•ä½¿ç”¨\texttt{across()}\footnote{ä¹Ÿè®¸æœ‰ä¸€å¤©ä¼šæœ‰ï¼Œä½†ç›®å‰æˆ‘ä»¬è¿˜ä¸çŸ¥é“å¦‚ä½•å®ç°ã€‚}å®Œæˆè¿™ä¸ªæ“ä½œï¼Œä½†ä½¿ç”¨\texttt{pivot\_longer()}ç›¸å¯¹æ¥è¯´æ¯”è¾ƒç›´æ¥ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_long }\OtherTok{\textless{}{-}}\NormalTok{ df\_paired }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_longer}\NormalTok{(}
    \FunctionTok{everything}\NormalTok{(), }
    \AttributeTok{names\_to =} \FunctionTok{c}\NormalTok{(}\StringTok{"group"}\NormalTok{, }\StringTok{".value"}\NormalTok{), }
    \AttributeTok{names\_sep =} \StringTok{"\_"}
\NormalTok{  )}
\NormalTok{df\_long}
\CommentTok{\#\textgreater{} \# A tibble: 40 x 3}
\CommentTok{\#\textgreater{}   group    val   wts}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}  \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 a      0.715 0.518}
\CommentTok{\#\textgreater{} 2 b     {-}0.709 0.691}
\CommentTok{\#\textgreater{} 3 c      0.718 0.216}
\CommentTok{\#\textgreater{} 4 d     {-}0.217 0.733}
\CommentTok{\#\textgreater{} 5 a     {-}1.09  0.979}
\CommentTok{\#\textgreater{} 6 b     {-}0.209 0.675}
\CommentTok{\#\textgreater{} \# i 34 more rows}

\NormalTok{df\_long }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(group) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{mean =} \FunctionTok{weighted.mean}\NormalTok{(val, wts))}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 2}
\CommentTok{\#\textgreater{}   group    mean}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}   \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 a      0.126 }
\CommentTok{\#\textgreater{} 2 b     {-}0.0704}
\CommentTok{\#\textgreater{} 3 c     {-}0.360 }
\CommentTok{\#\textgreater{} 4 d     {-}0.248}
\end{Highlighting}
\end{Shaded}

å¦‚æœéœ€è¦ï¼Œæ‚¨å¯ä»¥å°†\texttt{pivot\_wider()}è¿”å›åˆ°åŸå§‹å½¢å¼ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-63}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  é€šè¿‡ä»¥ä¸‹æ–¹å¼ç»ƒä¹ ä½ çš„ \texttt{across()}æŠ€èƒ½ï¼š

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \item
    è®¡ç®—\texttt{palmerpenguins::penguins}æ•°æ®é›†ä¸­æ¯ä¸€åˆ—çš„å”¯ä¸€å€¼ä¸ªæ•°ã€‚
  \item
    è®¡ç®—\texttt{mtcars}ä¸­æ¯ä¸€åˆ—çš„å‡æ•°ã€‚
  \item
    æŒ‰\texttt{cut}ã€\texttt{clarity}å’Œ\texttt{color}å¯¹\texttt{diamonds}è¿›è¡Œåˆ†ç»„ï¼Œç„¶åè®¡ç®—æ¯ä¸ªæ•°å€¼åˆ—çš„è§‚æµ‹å€¼ä¸ªæ•°ä»¥åŠå‡æ•°ã€‚
  \end{enumerate}
\item
  å¦‚æœåœ¨\texttt{across()}ä¸­ä½¿ç”¨å‡½æ•°åˆ—è¡¨ä½†æ²¡æœ‰ä¸ºå®ƒä»¬å‘½åï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿè¾“
  å‡ºæ˜¯å¦‚ä½•å‘½åçš„ï¼Ÿ
\item
  è°ƒæ•´\texttt{expand\_dates()}å‡½æ•°ï¼Œä»¥ä¾¿åœ¨æ—¥æœŸåˆ—è¢«æ‰©å±•åè‡ªåŠ¨åˆ é™¤å®ƒä»¬ã€‚ä½ 
  éœ€è¦æ‹¥æŠ±ä»»ä½•å‚æ•°å—ï¼Ÿ
\item
  è§£é‡Šè¿™ä¸ªå‡½æ•°ä¸­ç®¡é“çš„æ¯ä¸€æ­¥éƒ½åšäº†ä»€ä¹ˆã€‚åˆ©
  ç”¨äº†\texttt{where()}çš„ä»€ä¹ˆç‰¹æ®ŠåŠŸèƒ½ï¼Ÿ

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{show\_missing }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df, group\_vars, }\AttributeTok{summary\_vars =} \FunctionTok{everything}\NormalTok{()) \{}
\NormalTok{  df }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{group\_by}\NormalTok{(}\FunctionTok{pick}\NormalTok{(\{\{ group\_vars \}\})) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{summarize}\NormalTok{(}
      \FunctionTok{across}\NormalTok{(\{\{ summary\_vars \}\}, \textbackslash{}(x) }\FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(x))),}
      \AttributeTok{.groups =} \StringTok{"drop"}
\NormalTok{    ) }\SpecialCharTok{|\textgreater{}}
    \FunctionTok{select}\NormalTok{(}\FunctionTok{where}\NormalTok{(\textbackslash{}(x) }\FunctionTok{any}\NormalTok{(x }\SpecialCharTok{\textgreater{}} \DecValTok{0}\NormalTok{)))}
\NormalTok{\}}
\NormalTok{nycflights13}\SpecialCharTok{::}\NormalTok{flights }\SpecialCharTok{|\textgreater{}} \FunctionTok{show\_missing}\NormalTok{(}\FunctionTok{c}\NormalTok{(year, month, day))}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{è¯»å–å¤šä¸ªæ–‡ä»¶}\label{ux8bfbux53d6ux591aux4e2aux6587ux4ef6}

åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œå­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨\texttt{dplyr::across()}å¯¹å¤šåˆ—é‡å¤è¿›è¡Œè½¬æ¢ã€‚åœ¨
æœ¬èŠ‚ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨\texttt{purrr::map()}å¯¹ç›®å½•ä¸­çš„æ¯ä¸ªæ–‡ä»¶æ‰§è¡ŒæŸé¡¹æ“ä½œã€‚è®©
æˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„åŠ¨æœºå¼€å§‹ï¼šå‡è®¾ä½ æœ‰ä¸€ä¸ªåŒ…å«å¤§é‡ Excel
è¡¨æ ¼çš„ç›®å½•\footnote{å¦‚æœä½ æœ‰ä¸€ä¸ªåŒ…å«ç›¸åŒæ ¼å¼ CSV æ–‡ä»¶çš„ç›®å½•ï¼Œä½ å¯ä»¥ä½¿ç”¨
  ç« èŠ‚~\ref{sec-import-spreadsheets} ä¸­çš„æ–¹æ³•ã€‚}ï¼Œä½ æƒ³è¦è¯»å–å®ƒä»¬ã€‚
å¯ä»¥ä½¿ç”¨å¤åˆ¶å’Œç²˜è´´çš„æ–¹å¼æ¥åšè¿™ä»¶äº‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data2019 }\OtherTok{\textless{}{-}}\NormalTok{ readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/y2019.xlsx"}\NormalTok{)}
\NormalTok{data2020 }\OtherTok{\textless{}{-}}\NormalTok{ readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/y2020.xlsx"}\NormalTok{)}
\NormalTok{data2021 }\OtherTok{\textless{}{-}}\NormalTok{ readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/y2021.xlsx"}\NormalTok{)}
\NormalTok{data2022 }\OtherTok{\textless{}{-}}\NormalTok{ readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/y2022.xlsx"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

ç„¶åå¯ä»¥ä½¿ç”¨\texttt{dplyr::bind\_rows()}å°†å®ƒä»¬åˆå¹¶åœ¨ä¸€èµ·ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data }\OtherTok{\textless{}{-}} \FunctionTok{bind\_rows}\NormalTok{(data2019, data2020, data2021, data2022)}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥æƒ³è±¡ï¼Œå¦‚æœæ–‡ä»¶æ•°é‡ä¸æ˜¯å››ä¸ªï¼Œè€Œæ˜¯æˆç™¾ä¸Šåƒä¸ªï¼Œé‚£ä¹ˆè¿™ä¸ªè¿‡ç¨‹å¾ˆå¿«å°±ä¼šå˜å¾—ç¹çã€‚ä»¥
ä¸‹éƒ¨åˆ†å°†å‘ä½ å±•ç¤ºå¦‚ä½•è‡ªåŠ¨åŒ–æ­¤ç±»ä»»åŠ¡ã€‚ä¸»
è¦æœ‰ä¸‰ä¸ªåŸºæœ¬æ­¥éª¤ï¼šä½¿ç”¨\texttt{list.files()}åˆ—å‡ºç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨\texttt{purrr::map()}å°†å®ƒä»¬è¯»å…¥åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œæ¥ç€ä½¿ç”¨\texttt{purrr::list\_rbind()}å°†å®ƒä»¬åˆå¹¶æˆä¸€ä¸ªå•ä¸€çš„æ•°æ®æ¡†ã€‚ä¹‹
åï¼Œæˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•å¤„ç†æ—¥ç›Šå¢åŠ çš„å¼‚è´¨æ€§æƒ…å†µï¼Œå³ä½ ä¸èƒ½å¯¹æ¯ä¸ªæ–‡ä»¶éƒ½æ‰§è¡Œå®Œå…¨ç›¸åŒçš„æ“ä½œã€‚

\subsection{åˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶}\label{ux5217ux51faux76eeux5f55ux4e2dux7684ux6587ux4ef6}

é¡¾åæ€ä¹‰ï¼Œ\texttt{list.files()}ä¼šåˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶ã€‚ä½ 
æ€»æ˜¯ä¼šä½¿ç”¨ä»¥ä¸‹ä¸‰ä¸ªå‚æ•°ï¼š

\begin{itemize}
\tightlist
\item
  ç¬¬ä¸€ä¸ªå‚æ•°\texttt{path}æ˜¯è¦æŸ¥æ‰¾çš„ç›®å½•ã€‚
\item
  \texttt{pattern}æ˜¯ä¸€ä¸ªç”¨äºè¿‡æ»¤æ–‡ä»¶åçš„æ­£åˆ™è¡¨è¾¾å¼ã€‚æœ€å¸¸è§çš„æ¨¡å¼æ˜¯ç±»ä¼¼\texttt{\textbackslash{}.xlsx\$}æˆ–\texttt{\textbackslash{}.csv\$}è¿™æ ·çš„è¡¨è¾¾å¼ï¼Œç”¨äºæŸ¥æ‰¾å…·æœ‰æŒ‡å®šæ‰©å±•åçš„æ‰€æœ‰æ–‡ä»¶ã€‚
\item
  \texttt{full.names}å†³å®šæ˜¯å¦åœ¨è¾“å‡ºä¸­åŒ…å«ç›®å½•åã€‚ä½ é€šå¸¸å¸Œæœ›è¿™ä¸ªå‚æ•°ä¸º\texttt{TRUE}ã€‚
\end{itemize}

ä¸ºäº†è®©æˆ‘ä»¬çš„åŠ¨æœºç¤ºä¾‹å…·ä½“åŒ–ï¼Œè¿™æœ¬ä¹¦åŒ…å«ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…å«æ¥è‡ª\texttt{gapminder}åŒ…çš„
12 ä¸ª Excel è¡¨æ ¼ã€‚æ¯ ä¸ªæ–‡ä»¶åŒ…å« 142 ä¸ªå›½å®¶æŸä¸€å¹´çš„æ•°æ®ã€‚æˆ‘
ä»¬å¯ä»¥é€šè¿‡é€‚å½“çš„\texttt{list.files()}è°ƒç”¨åˆ—å‡ºæ‰€æœ‰è¿™äº›æ–‡ä»¶ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{paths }\OtherTok{\textless{}{-}} \FunctionTok{list.files}\NormalTok{(}\StringTok{"data/gapminder"}\NormalTok{, }\AttributeTok{pattern =} \StringTok{"[.]xlsx$"}\NormalTok{, }\AttributeTok{full.names =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{paths}
\CommentTok{\#\textgreater{}  [1] "data/gapminder/1952.xlsx" "data/gapminder/1957.xlsx"}
\CommentTok{\#\textgreater{}  [3] "data/gapminder/1962.xlsx" "data/gapminder/1967.xlsx"}
\CommentTok{\#\textgreater{}  [5] "data/gapminder/1972.xlsx" "data/gapminder/1977.xlsx"}
\CommentTok{\#\textgreater{}  [7] "data/gapminder/1982.xlsx" "data/gapminder/1987.xlsx"}
\CommentTok{\#\textgreater{}  [9] "data/gapminder/1992.xlsx" "data/gapminder/1997.xlsx"}
\CommentTok{\#\textgreater{} [11] "data/gapminder/2002.xlsx" "data/gapminder/2007.xlsx"}
\end{Highlighting}
\end{Shaded}

\subsection{åˆ—è¡¨}\label{ux5217ux8868-1}

ç°åœ¨æˆ‘ä»¬æœ‰äº† 12 ä¸ªè·¯å¾„ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨\texttt{read\_excel()} 12 æ¬¡æ¥å¾—åˆ°
12 ä¸ªæ•°æ®æ¡†ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gapminder\_1952 }\OtherTok{\textless{}{-}}\NormalTok{ readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/gapminder/1952.xlsx"}\NormalTok{)}
\NormalTok{gapminder\_1957 }\OtherTok{\textless{}{-}}\NormalTok{ readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/gapminder/1957.xlsx"}\NormalTok{)}
\NormalTok{gapminder\_1962 }\OtherTok{\textless{}{-}}\NormalTok{ readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/gapminder/1962.xlsx"}\NormalTok{)}
\NormalTok{ ...,}
\NormalTok{gapminder\_2007 }\OtherTok{\textless{}{-}}\NormalTok{ readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/gapminder/2007.xlsx"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

ä½†æ˜¯å°†æ¯ä¸ªå·¥ä½œè¡¨æ”¾å…¥è‡ªå·±çš„å˜é‡ä¸­å°†ä½¿å¾—åœ¨åç»­çš„æ­¥éª¤ä¸­å¤„ç†å®ƒä»¬å˜å¾—å›°éš¾ã€‚ç›¸
åï¼Œå¦‚æœå°†å®ƒä»¬æ”¾å…¥ä¸€ä¸ªå•ç‹¬çš„å¯¹è±¡ä¸­ï¼Œå¤„ç†èµ·æ¥å°†æ›´åŠ æ–¹ä¾¿ã€‚åˆ—
è¡¨æ˜¯å®Œæˆè¿™é¡¹å·¥ä½œçš„å®Œç¾å·¥å…·ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{files }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
\NormalTok{  readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/gapminder/1952.xlsx"}\NormalTok{),}
\NormalTok{  readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/gapminder/1957.xlsx"}\NormalTok{),}
\NormalTok{  readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/gapminder/1962.xlsx"}\NormalTok{),}
\NormalTok{  ...,}
\NormalTok{  readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/gapminder/2007.xlsx"}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

æ—¢ç„¶å·²ç»å°†è¿™äº›æ•°æ®æ¡†æ”¾å…¥äº†ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œå¦‚ä½•ä»ä¸­å–å‡ºä¸€ä¸ªå‘¢ï¼Ÿå¯
ä»¥ä½¿ç”¨\texttt{files{[}{[}i{]}{]}}æ¥æå–ç¬¬\texttt{i}ä¸ªå…ƒç´ ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{files[[}\DecValTok{3}\NormalTok{]]}
\CommentTok{\#\textgreater{} \# A tibble: 142 x 5}
\CommentTok{\#\textgreater{}   country     continent lifeExp      pop gdpPercap}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}       \textless{}chr\textgreater{}       \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 Afghanistan Asia         32.0 10267083      853.}
\CommentTok{\#\textgreater{} 2 Albania     Europe       64.8  1728137     2313.}
\CommentTok{\#\textgreater{} 3 Algeria     Africa       48.3 11000948     2551.}
\CommentTok{\#\textgreater{} 4 Angola      Africa       34    4826015     4269.}
\CommentTok{\#\textgreater{} 5 Argentina   Americas     65.1 21283783     7133.}
\CommentTok{\#\textgreater{} 6 Australia   Oceania      70.9 10794968    12217.}
\CommentTok{\#\textgreater{} \# i 136 more rows}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å°†åœ¨ å°èŠ‚~\ref{sec-subset-one} ä¸­æ›´è¯¦ç»†åœ°è®¨è®º \texttt{{[}{[}} ã€‚

\subsection{\texorpdfstring{\texttt{purrr::map()} å’Œ
\texttt{list\_rbind()}}{purrr::map() å’Œ list\_rbind()}}\label{purrrmap-ux548c-list_rbind}

æ‰‹åŠ¨å°†è¿™äº›æ•°æ®æ¡†æ”¶é›†åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­çš„ä»£ç åŸºæœ¬ä¸Šå’Œé€ä¸ªè¯»å–æ–‡ä»¶çš„ä»£ç ä¸€æ ·ç¹çã€‚å¹¸
è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{purrr::map()}æ¥æ›´å¥½åœ°åˆ©ç”¨æˆ‘ä»¬çš„è·¯å¾„å‘é‡ã€‚\texttt{m}
\texttt{ap()}å‡½æ•°ä¸\texttt{across()}ç±»ä¼¼ï¼Œä½†\texttt{map()}æ˜¯å¯¹å‘é‡ä¸­çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯å¯¹æ•°æ®æ¡†ä¸­çš„æ¯åˆ—è¿›è¡Œæ“ä½œã€‚\texttt{m}
\texttt{ap(x,\ f)}æ˜¯ä»¥ä¸‹æ“ä½œçš„ç®€å†™ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{list}\NormalTok{(}
  \FunctionTok{f}\NormalTok{(x[[}\DecValTok{1}\NormalTok{]]),}
  \FunctionTok{f}\NormalTok{(x[[}\DecValTok{2}\NormalTok{]]),}
\NormalTok{  ...,}
  \FunctionTok{f}\NormalTok{(x[[n]])}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

æ‰€ä»¥å¯ä»¥ä½¿ç”¨\texttt{map()}æ¥è·å–ä¸€ä¸ªåŒ…å«12ä¸ªæ•°æ®æ¡†çš„åˆ—è¡¨:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{files }\OtherTok{\textless{}{-}} \FunctionTok{map}\NormalTok{(paths, readxl}\SpecialCharTok{::}\NormalTok{read\_excel)}
\FunctionTok{length}\NormalTok{(files)}
\CommentTok{\#\textgreater{} [1] 12}

\NormalTok{files[[}\DecValTok{1}\NormalTok{]]}
\CommentTok{\#\textgreater{} \# A tibble: 142 x 5}
\CommentTok{\#\textgreater{}   country     continent lifeExp      pop gdpPercap}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}       \textless{}chr\textgreater{}       \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 Afghanistan Asia         28.8  8425333      779.}
\CommentTok{\#\textgreater{} 2 Albania     Europe       55.2  1282697     1601.}
\CommentTok{\#\textgreater{} 3 Algeria     Africa       43.1  9279525     2449.}
\CommentTok{\#\textgreater{} 4 Angola      Africa       30.0  4232095     3521.}
\CommentTok{\#\textgreater{} 5 Argentina   Americas     62.5 17876956     5911.}
\CommentTok{\#\textgreater{} 6 Australia   Oceania      69.1  8691212    10040.}
\CommentTok{\#\textgreater{} \# i 136 more rows}
\end{Highlighting}
\end{Shaded}

(è¿™æ˜¯å¦ä¸€ç§æ•°æ®ç»“æ„ï¼Œä½¿ç”¨\texttt{str()}æ˜¾ç¤ºæ—¶å¯èƒ½ä¸ä¼šç‰¹åˆ«ç´§å‡‘ï¼Œå› æ­¤ä½ å¯èƒ½å¸Œæœ›å°†å…¶åŠ è½½åˆ°
RStudio ä¸­å¹¶ä½¿ç”¨\texttt{View()}æ¥æ£€æŸ¥å®ƒã€‚)

ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{purrr::list\_rbind()}å°†è¿™ä¸ªæ•°æ®æ¡†åˆ—è¡¨åˆå¹¶æˆä¸€ä¸ªå•ä¸€çš„æ•°æ®æ¡†ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{list\_rbind}\NormalTok{(files)}
\CommentTok{\#\textgreater{} \# A tibble: 1,704 x 5}
\CommentTok{\#\textgreater{}   country     continent lifeExp      pop gdpPercap}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}       \textless{}chr\textgreater{}       \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 Afghanistan Asia         28.8  8425333      779.}
\CommentTok{\#\textgreater{} 2 Albania     Europe       55.2  1282697     1601.}
\CommentTok{\#\textgreater{} 3 Algeria     Africa       43.1  9279525     2449.}
\CommentTok{\#\textgreater{} 4 Angola      Africa       30.0  4232095     3521.}
\CommentTok{\#\textgreater{} 5 Argentina   Americas     62.5 17876956     5911.}
\CommentTok{\#\textgreater{} 6 Australia   Oceania      69.1  8691212    10040.}
\CommentTok{\#\textgreater{} \# i 1,698 more rows}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ç®¡é“ä¸­åŒæ—¶è¿›è¡Œè¿™ä¸¤æ­¥:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{paths }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{map}\NormalTok{(readxl}\SpecialCharTok{::}\NormalTok{read\_excel) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{list\_rbind}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

å¦‚æœæƒ³å‘\texttt{read\_excel()}ä¼ é€’é¢å¤–çš„å‚æ•°æ€ä¹ˆåŠï¼Ÿæˆ‘
ä»¬å¯ä»¥ä½¿ç”¨ä¸\texttt{across()}ç›¸åŒçš„æ–¹æ³•ã€‚ä¾‹
å¦‚ï¼Œä½¿ç”¨\texttt{n\_max\ =\ 1}æ¥æŸ¥çœ‹æ•°æ®çš„å‰å‡ è¡Œé€šå¸¸å¾ˆæœ‰ç”¨ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{paths }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{map}\NormalTok{(\textbackslash{}(path) readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(path, }\AttributeTok{n\_max =} \DecValTok{1}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{list\_rbind}\NormalTok{()}
\CommentTok{\#\textgreater{} \# A tibble: 12 x 5}
\CommentTok{\#\textgreater{}   country     continent lifeExp      pop gdpPercap}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}       \textless{}chr\textgreater{}       \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 Afghanistan Asia         28.8  8425333      779.}
\CommentTok{\#\textgreater{} 2 Afghanistan Asia         30.3  9240934      821.}
\CommentTok{\#\textgreater{} 3 Afghanistan Asia         32.0 10267083      853.}
\CommentTok{\#\textgreater{} 4 Afghanistan Asia         34.0 11537966      836.}
\CommentTok{\#\textgreater{} 5 Afghanistan Asia         36.1 13079460      740.}
\CommentTok{\#\textgreater{} 6 Afghanistan Asia         38.4 14880372      786.}
\CommentTok{\#\textgreater{} \# i 6 more rows}
\end{Highlighting}
\end{Shaded}

è¿™ä¸ªå¾ˆæ˜æ˜¾ç¼ºå°‘äº†ä¸€äº›ä¸œè¥¿ï¼šæ²¡æœ‰\texttt{year}åˆ—ï¼Œå› ä¸ºè¿™ä¸ªå€¼è®°å½•åœ¨è·¯å¾„ä¸­ï¼Œè€Œä¸æ˜¯å•ä¸ªæ–‡ä»¶ä¸­ã€‚æ¥
ä¸‹æ¥æˆ‘ä»¬å°†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

\subsection{è·¯å¾„ä¸­çš„æ•°æ®}\label{sec-data-in-the-path}

æœ‰æ—¶ï¼Œæ–‡ä»¶åæœ¬èº«å°±æ˜¯æ•°æ®çš„ä¸€éƒ¨åˆ†ã€‚åœ¨
è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ–‡ä»¶ååŒ…å«äº†å¹´ä»½ï¼Œè€Œè¿™ä¸ªå¹´ä»½å¹¶æ²¡æœ‰åœ¨å•ä¸ªæ–‡ä»¶ä¸­è¢«è®°å½•ã€‚è¦
å°†è¿™ä¸€åˆ—æ·»åŠ åˆ°æœ€ç»ˆçš„æ•°æ®æ¡†ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åšä¸¤ä»¶äº‹ï¼š

é¦–å…ˆï¼Œæˆ‘ä»¬ç»™è·¯å¾„å‘é‡å‘½åã€‚æœ€
ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨\texttt{set\_names()}ï¼Œè¯¥å‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªå‡½æ•°ã€‚åœ¨
è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨\texttt{basename()}å‡½æ•°ä»å®Œæ•´è·¯å¾„ä¸­æå–ä»…åŒ…å«æ–‡ä»¶åçš„éƒ¨åˆ†ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{paths }\SpecialCharTok{|\textgreater{}} \FunctionTok{set\_names}\NormalTok{(basename) }
\CommentTok{\#\textgreater{}                  1952.xlsx                  1957.xlsx }
\CommentTok{\#\textgreater{} "data/gapminder/1952.xlsx" "data/gapminder/1957.xlsx" }
\CommentTok{\#\textgreater{}                  1962.xlsx                  1967.xlsx }
\CommentTok{\#\textgreater{} "data/gapminder/1962.xlsx" "data/gapminder/1967.xlsx" }
\CommentTok{\#\textgreater{}                  1972.xlsx                  1977.xlsx }
\CommentTok{\#\textgreater{} "data/gapminder/1972.xlsx" "data/gapminder/1977.xlsx" }
\CommentTok{\#\textgreater{}                  1982.xlsx                  1987.xlsx }
\CommentTok{\#\textgreater{} "data/gapminder/1982.xlsx" "data/gapminder/1987.xlsx" }
\CommentTok{\#\textgreater{}                  1992.xlsx                  1997.xlsx }
\CommentTok{\#\textgreater{} "data/gapminder/1992.xlsx" "data/gapminder/1997.xlsx" }
\CommentTok{\#\textgreater{}                  2002.xlsx                  2007.xlsx }
\CommentTok{\#\textgreater{} "data/gapminder/2002.xlsx" "data/gapminder/2007.xlsx"}
\end{Highlighting}
\end{Shaded}

è¿™äº›åç§°ä¼šè‡ªåŠ¨è¢«æ‰€æœ‰\texttt{map}å‡½æ•°ä¿ç•™ï¼Œå› æ­¤æ•°æ®æ¡†åˆ—è¡¨å°†å…·æœ‰ç›¸åŒçš„åç§°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{files }\OtherTok{\textless{}{-}}\NormalTok{ paths }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{set\_names}\NormalTok{(basename) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{map}\NormalTok{(readxl}\SpecialCharTok{::}\NormalTok{read\_excel)}
\end{Highlighting}
\end{Shaded}

è¿™ä½¿å¾—å¯¹\texttt{map()}çš„è°ƒç”¨ç®€å†™ä¸º:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{files }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \StringTok{"1952.xlsx"} \OtherTok{=}\NormalTok{ readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/gapminder/1952.xlsx"}\NormalTok{),}
  \StringTok{"1957.xlsx"} \OtherTok{=}\NormalTok{ readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/gapminder/1957.xlsx"}\NormalTok{),}
  \StringTok{"1962.xlsx"} \OtherTok{=}\NormalTok{ readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/gapminder/1962.xlsx"}\NormalTok{),}
\NormalTok{  ...,}
  \StringTok{"2007.xlsx"} \OtherTok{=}\NormalTok{ readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(}\StringTok{"data/gapminder/2007.xlsx"}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨\texttt{{[}{[}}æŒ‰åç§°æå–å…ƒç´ :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{files[[}\StringTok{"1962.xlsx"}\NormalTok{]]}
\CommentTok{\#\textgreater{} \# A tibble: 142 x 5}
\CommentTok{\#\textgreater{}   country     continent lifeExp      pop gdpPercap}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}       \textless{}chr\textgreater{}       \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 Afghanistan Asia         32.0 10267083      853.}
\CommentTok{\#\textgreater{} 2 Albania     Europe       64.8  1728137     2313.}
\CommentTok{\#\textgreater{} 3 Algeria     Africa       48.3 11000948     2551.}
\CommentTok{\#\textgreater{} 4 Angola      Africa       34    4826015     4269.}
\CommentTok{\#\textgreater{} 5 Argentina   Americas     65.1 21283783     7133.}
\CommentTok{\#\textgreater{} 6 Australia   Oceania      70.9 10794968    12217.}
\CommentTok{\#\textgreater{} \# i 136 more rows}
\end{Highlighting}
\end{Shaded}

ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨\texttt{list\_rbind()}çš„\texttt{names\_to}å‚æ•°æ¥å‘Šè¯‰å®ƒå°†åç§°ä¿å­˜åˆ°ä¸€ä¸ªåä¸º\texttt{year}çš„æ–°åˆ—ä¸­ï¼Œå¹¶ä½¿ç”¨\texttt{readr::parse\_number()}ä»å­—ç¬¦ä¸²ä¸­æå–æ•°å­—ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{paths }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{set\_names}\NormalTok{(basename) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{map}\NormalTok{(readxl}\SpecialCharTok{::}\NormalTok{read\_excel) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{list\_rbind}\NormalTok{(}\AttributeTok{names\_to =} \StringTok{"year"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{year =} \FunctionTok{parse\_number}\NormalTok{(year))}
\CommentTok{\#\textgreater{} \# A tibble: 1,704 x 6}
\CommentTok{\#\textgreater{}    year country     continent lifeExp      pop gdpPercap}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}chr\textgreater{}       \textless{}chr\textgreater{}       \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1  1952 Afghanistan Asia         28.8  8425333      779.}
\CommentTok{\#\textgreater{} 2  1952 Albania     Europe       55.2  1282697     1601.}
\CommentTok{\#\textgreater{} 3  1952 Algeria     Africa       43.1  9279525     2449.}
\CommentTok{\#\textgreater{} 4  1952 Angola      Africa       30.0  4232095     3521.}
\CommentTok{\#\textgreater{} 5  1952 Argentina   Americas     62.5 17876956     5911.}
\CommentTok{\#\textgreater{} 6  1952 Australia   Oceania      69.1  8691212    10040.}
\CommentTok{\#\textgreater{} \# i 1,698 more rows}
\end{Highlighting}
\end{Shaded}

åœ¨æ›´å¤æ‚çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½æœ‰å…¶ä»–å˜é‡å­˜å‚¨åœ¨ç›®å½•åä¸­ï¼Œæˆ–è€…æ–‡ä»¶åå¯èƒ½åŒ…å«å¤šä¸ªæ•°æ®éƒ¨åˆ†ã€‚åœ¨
è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨\texttt{set\_names()}ï¼ˆä¸å¸¦ä»»ä½•å‚æ•°ï¼‰æ¥è®°å½•å®Œæ•´è·¯å¾„ï¼Œç„¶åä½¿ç”¨\texttt{tidyr::separate\_wider\_delim()}å’Œç›¸å…³å‡½æ•°å°†å®ƒä»¬è½¬æ¢ä¸ºæœ‰ç”¨çš„åˆ—ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{paths }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{set\_names}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{map}\NormalTok{(readxl}\SpecialCharTok{::}\NormalTok{read\_excel) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{list\_rbind}\NormalTok{(}\AttributeTok{names\_to =} \StringTok{"year"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{separate\_wider\_delim}\NormalTok{(year, }\AttributeTok{delim =} \StringTok{"/"}\NormalTok{, }\AttributeTok{names =} \FunctionTok{c}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\StringTok{"dir"}\NormalTok{, }\StringTok{"file"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{separate\_wider\_delim}\NormalTok{(file, }\AttributeTok{delim =} \StringTok{"."}\NormalTok{, }\AttributeTok{names =} \FunctionTok{c}\NormalTok{(}\StringTok{"file"}\NormalTok{, }\StringTok{"ext"}\NormalTok{))}
\CommentTok{\#\textgreater{} \# A tibble: 1,704 x 8}
\CommentTok{\#\textgreater{}   dir       file  ext   country     continent lifeExp      pop gdpPercap}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}     \textless{}chr\textgreater{} \textless{}chr\textgreater{} \textless{}chr\textgreater{}       \textless{}chr\textgreater{}       \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 gapminder 1952  xlsx  Afghanistan Asia         28.8  8425333      779.}
\CommentTok{\#\textgreater{} 2 gapminder 1952  xlsx  Albania     Europe       55.2  1282697     1601.}
\CommentTok{\#\textgreater{} 3 gapminder 1952  xlsx  Algeria     Africa       43.1  9279525     2449.}
\CommentTok{\#\textgreater{} 4 gapminder 1952  xlsx  Angola      Africa       30.0  4232095     3521.}
\CommentTok{\#\textgreater{} 5 gapminder 1952  xlsx  Argentina   Americas     62.5 17876956     5911.}
\CommentTok{\#\textgreater{} 6 gapminder 1952  xlsx  Australia   Oceania      69.1  8691212    10040.}
\CommentTok{\#\textgreater{} \# i 1,698 more rows}
\end{Highlighting}
\end{Shaded}

\subsection{ä¿å­˜å·¥ä½œ}\label{ux4fddux5b58ux5de5ux4f5c}

æ—¢ç„¶ä½ å·²ç»å®Œæˆäº†æ‰€æœ‰è¿™äº›è¾›è‹¦çš„å·¥ä½œï¼Œå¾—åˆ°äº†ä¸€ä¸ªæ•´é½çš„æ•°æ®æ¡†ï¼Œç°åœ¨æ˜¯ä¿å­˜å·¥ä½œæˆæœçš„å¥½æ—¶æœºäº†ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{gapminder }\OtherTok{\textless{}{-}}\NormalTok{ paths }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{set\_names}\NormalTok{(basename) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{map}\NormalTok{(readxl}\SpecialCharTok{::}\NormalTok{read\_excel) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{list\_rbind}\NormalTok{(}\AttributeTok{names\_to =} \StringTok{"year"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{year =} \FunctionTok{parse\_number}\NormalTok{(year))}

\FunctionTok{write\_csv}\NormalTok{(gapminder, }\StringTok{"gapminder.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

å½“ä½ å°†æ¥å†æ¬¡é‡åˆ°è¿™ä¸ªé—®é¢˜æ—¶ï¼Œä½ å¯ä»¥è¯»å–ä¸€ä¸ªå•ç‹¬çš„ csv æ–‡ä»¶ã€‚å¯¹
äºå¤§å‹çš„å’Œæ›´ä¸°å¯Œçš„æ•°æ®é›†ï¼Œä½¿ç”¨ parquet å¯èƒ½æ˜¯æ¯” \texttt{.csv}
æ›´å¥½çš„é€‰æ‹©ï¼Œæ­£å¦‚åœ¨ å°èŠ‚~\ref{sec-parquet} ä¸­è®¨è®ºçš„é‚£æ ·ã€‚

å¦‚æœä½ åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­å·¥ä½œï¼Œæˆ‘ä»¬å»ºè®®ä½ å°†æ‰§è¡Œè¿™ç§æ•°æ®å‡†å¤‡å·¥ä½œçš„æ–‡ä»¶å‘½åä¸ºç±»ä¼¼
\texttt{0-cleanup.R} çš„åå­—ã€‚æ–‡ ä»¶åä¸­çš„ \texttt{0}
è¡¨ç¤ºè¿™åº”è¯¥åœ¨å…¶ä»–ä»»ä½•äº‹æƒ…ä¹‹å‰è¿è¡Œã€‚

å¦‚æœä½ çš„è¾“å…¥æ•°æ®æ–‡ä»¶éšç€æ—¶é—´çš„æ¨ç§»è€Œå‘ç”Ÿå˜åŒ–ï¼Œä½ å¯èƒ½éœ€è¦è€ƒè™‘å­¦ä¹ ä¸€ä¸ªå·¥å…·ï¼Œå¦‚
\href{https://docs.ropensci.org/targets/}{targets}ï¼Œæ¥è®¾ç½®ä½ çš„æ•°æ®æ¸…ç†ä»£ç ï¼Œä»¥ä¾¿åœ¨è¾“å…¥æ–‡ä»¶ä¹‹ä¸€è¢«ä¿®æ”¹æ—¶è‡ªåŠ¨é‡æ–°è¿è¡Œã€‚

\subsection{å¤šä¸ªç®€å•è¿­ä»£}\label{ux591aux4e2aux7b80ux5355ux8fedux4ee3}

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åªæ˜¯ç›´æ¥ä»ç£ç›˜åŠ è½½äº†æ•°æ®ï¼Œå¹¶å¹¸è¿åœ°å¾—åˆ°äº†ä¸€ä¸ªæ•´é½çš„æ•°æ®é›†ã€‚åœ¨
å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ éœ€è¦åšä¸€äº›é¢å¤–çš„æ•´ç†å·¥ä½œï¼Œæœ‰ä¸¤ä¸ªåŸºæœ¬é€‰é¡¹ï¼šä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¤æ‚çš„å‡½æ•°è¿›è¡Œä¸€è½®è¿­ä»£ï¼Œæˆ–è€…ä½¿ç”¨ç®€å•çš„å‡½æ•°è¿›è¡Œå¤šè½®è¿­ä»£ã€‚æ ¹
æ®æˆ‘ä»¬çš„ç»éªŒï¼Œå¤§å¤šæ•°äººé¦–å…ˆé€‰æ‹©ä¸€ä¸ªå¤æ‚çš„è¿­ä»£ï¼Œä½†é€šå¸¸ä½¿ç”¨å¤šä¸ªç®€å•è¿­ä»£ä¼šæ›´å¥½ã€‚

ä¾‹å¦‚ï¼Œå‡è®¾ä½ æƒ³è¯»å–ä¸€å †æ–‡ä»¶ï¼Œè¿‡æ»¤æ‰ç¼ºå¤±å€¼ï¼Œè¿›è¡Œé‡å¡‘ï¼Œç„¶ååˆå¹¶ã€‚è§£
å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªæ–¹æ³•æ˜¯ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥æ”¶ä¸€ä¸ªæ–‡ä»¶å¹¶æ‰§è¡Œæ‰€æœ‰è¿™äº›æ­¥éª¤ï¼Œç„¶åè°ƒç”¨\texttt{map()}ä¸€æ¬¡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{process\_file }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(path) \{}
\NormalTok{  df }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(path)}
  
\NormalTok{  df }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(id)) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{mutate}\NormalTok{(}\AttributeTok{id =} \FunctionTok{tolower}\NormalTok{(id)) }\SpecialCharTok{|\textgreater{}} 
    \FunctionTok{pivot\_longer}\NormalTok{(jan}\SpecialCharTok{:}\NormalTok{dec, }\AttributeTok{names\_to =} \StringTok{"month"}\NormalTok{)}
\NormalTok{\}}

\NormalTok{paths }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{map}\NormalTok{(process\_file) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{list\_rbind}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

æˆ–è€…ï¼Œä½ å¯ä»¥å¯¹æ¯ä¸ªæ–‡ä»¶æ‰§è¡Œ\texttt{process\_file()}ä¸­çš„æ¯ä¸ªæ­¥éª¤ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{paths }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{map}\NormalTok{(read\_csv) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{map}\NormalTok{(\textbackslash{}(df) df }\SpecialCharTok{|\textgreater{}} \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(id))) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{map}\NormalTok{(\textbackslash{}(df) df }\SpecialCharTok{|\textgreater{}} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{id =} \FunctionTok{tolower}\NormalTok{(id))) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{map}\NormalTok{(\textbackslash{}(df) df }\SpecialCharTok{|\textgreater{}} \FunctionTok{pivot\_longer}\NormalTok{(jan}\SpecialCharTok{:}\NormalTok{dec, }\AttributeTok{names\_to =} \StringTok{"month"}\NormalTok{)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{list\_rbind}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬æ¨èè¿™ç§æ–¹æ³•ï¼Œå› ä¸ºå®ƒé˜»æ­¢ä½ åœ¨ç§»åŠ¨åˆ°å…¶ä½™æ–‡ä»¶ä¹‹å‰åªå…³æ³¨ç¬¬ä¸€ä¸ªæ–‡ä»¶çš„æ­£ç¡®æ€§ã€‚é€š
è¿‡åœ¨æ•´ç†å’Œæ¸…æ´—æ•°æ®æ—¶è€ƒè™‘æ‰€æœ‰æ•°æ®ï¼Œä½ æ›´æœ‰å¯èƒ½ä»æ•´ä½“ä¸Šæ€è€ƒï¼Œå¹¶å¾—å‡ºæ›´é«˜è´¨é‡çš„ç»“æœã€‚

åœ¨è¿™ä¸ªç‰¹å®šçš„ä¾‹å­ä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ªä¼˜åŒ–ä½ å¯ä»¥åšï¼Œé‚£å°±æ˜¯æ›´æ—©åœ°å°†æ‰€æœ‰æ•°æ®æ¡†ç»‘å®šåœ¨ä¸€èµ·ã€‚ç„¶
åï¼Œä½ å¯ä»¥ä¾èµ–å¸¸è§„çš„ dplyr è¡Œä¸ºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{paths }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{map}\NormalTok{(read\_csv) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{list\_rbind}\NormalTok{() }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(id)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{id =} \FunctionTok{tolower}\NormalTok{(id)) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_longer}\NormalTok{(jan}\SpecialCharTok{:}\NormalTok{dec, }\AttributeTok{names\_to =} \StringTok{"month"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsection{å¼‚è´¨æ•°æ®}\label{ux5f02ux8d28ux6570ux636e}

ä¸å¹¸çš„æ˜¯ï¼Œæœ‰æ—¶æ— æ³•ç›´æ¥ä»\texttt{map()}è½¬åˆ°\texttt{list\_rbind()}ï¼Œå› ä¸ºæ•°æ®æ¡†çš„å¼‚è´¨æ€§å¤ªå¼ºï¼Œå¯¼è‡´\texttt{list\_rbind()}å¤±è´¥æˆ–äº§ç”Ÿäº†ä¸€ä¸ªä¸å¤ªæœ‰ç”¨çš„æ•°æ®æ¡†ã€‚åœ¨
è¿™ç§æƒ…å†µä¸‹ï¼Œä»åŠ è½½æ‰€æœ‰æ–‡ä»¶å¼€å§‹ä»ç„¶æ˜¯æœ‰ç”¨çš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{files }\OtherTok{\textless{}{-}}\NormalTok{ paths }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{map}\NormalTok{(readxl}\SpecialCharTok{::}\NormalTok{read\_excel) }
\end{Highlighting}
\end{Shaded}

ç„¶åï¼Œä¸€ä¸ªæœ‰ç”¨çš„ç­–ç•¥æ˜¯æ•è·æ•°æ®æ¡†çš„ç»“æ„ï¼Œä»¥ä¾¿ä½ å¯ä»¥ä½¿ç”¨æ•°æ®ç§‘å­¦æŠ€èƒ½æ¥æ¢ç´¢å®ƒã€‚è¿™
æ ·åšçš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ä¸‹é¢è¿™ä¸ª\texttt{df\_types}å‡½æ•°\footnote{æˆ‘ä»¬ä¸ä¼šè§£é‡Šè¿™ä¸ªå‡½æ•°æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä½†å¦‚æœä½ æŸ¥çœ‹æ‰€ä½¿ç”¨çš„å‡½æ•°çš„æ–‡æ¡£ï¼Œåº”è¯¥èƒ½å¤Ÿè‡ªå·±å¼„æ¸…æ¥šã€‚}ï¼Œå®ƒè¿”å›ä¸€ä¸ª
tibbleï¼Œå…¶ä¸­æ¯åˆ—å¯¹åº”ä¸€è¡Œï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_types }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df) \{}
  \FunctionTok{tibble}\NormalTok{(}
    \AttributeTok{col\_name =} \FunctionTok{names}\NormalTok{(df), }
    \AttributeTok{col\_type =} \FunctionTok{map\_chr}\NormalTok{(df, vctrs}\SpecialCharTok{::}\NormalTok{vec\_ptype\_full),}
    \AttributeTok{n\_miss =} \FunctionTok{map\_int}\NormalTok{(df, \textbackslash{}(x) }\FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(x)))}
\NormalTok{  )}
\NormalTok{\}}

\FunctionTok{df\_types}\NormalTok{(gapminder)}
\CommentTok{\#\textgreater{} \# A tibble: 6 x 3}
\CommentTok{\#\textgreater{}   col\_name  col\_type  n\_miss}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}     \textless{}chr\textgreater{}      \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1 year      double         0}
\CommentTok{\#\textgreater{} 2 country   character      0}
\CommentTok{\#\textgreater{} 3 continent character      0}
\CommentTok{\#\textgreater{} 4 lifeExp   double         0}
\CommentTok{\#\textgreater{} 5 pop       double         0}
\CommentTok{\#\textgreater{} 6 gdpPercap double         0}
\end{Highlighting}
\end{Shaded}

ç„¶åï¼Œä½ å¯ä»¥å°†è¿™ä¸ªå‡½æ•°åº”ç”¨äºæ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶å¯èƒ½è¿›è¡Œä¸€äº›é‡å¡‘æ“ä½œï¼Œä»¥ä¾¿æ›´å®¹æ˜“åœ°çœ‹åˆ°å·®å¼‚æ‰€åœ¨ã€‚ä¾‹
å¦‚ï¼Œè¿™å¯ä»¥å¾ˆå®¹æ˜“åœ°éªŒè¯æˆ‘ä»¬ä¸€ç›´åœ¨ä½¿ç”¨çš„ gapminder
ç”µå­è¡¨æ ¼æ˜¯å¦éƒ½æ˜¯åŒè´¨çš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{files }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{map}\NormalTok{(df\_types) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{list\_rbind}\NormalTok{(}\AttributeTok{names\_to =} \StringTok{"file\_name"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{n\_miss) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{names\_from =}\NormalTok{ col\_name, }\AttributeTok{values\_from =}\NormalTok{ col\_type)}
\CommentTok{\#\textgreater{} \# A tibble: 12 x 6}
\CommentTok{\#\textgreater{}   file\_name country   continent lifeExp pop    gdpPercap}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}     \textless{}chr\textgreater{}     \textless{}chr\textgreater{}     \textless{}chr\textgreater{}   \textless{}chr\textgreater{}  \textless{}chr\textgreater{}    }
\CommentTok{\#\textgreater{} 1 1952.xlsx character character double  double double   }
\CommentTok{\#\textgreater{} 2 1957.xlsx character character double  double double   }
\CommentTok{\#\textgreater{} 3 1962.xlsx character character double  double double   }
\CommentTok{\#\textgreater{} 4 1967.xlsx character character double  double double   }
\CommentTok{\#\textgreater{} 5 1972.xlsx character character double  double double   }
\CommentTok{\#\textgreater{} 6 1977.xlsx character character double  double double   }
\CommentTok{\#\textgreater{} \# i 6 more rows}
\end{Highlighting}
\end{Shaded}

å¦‚æœæ–‡ä»¶çš„æ ¼å¼æ˜¯å¼‚æ„çš„ï¼Œé‚£ä¹ˆåœ¨æˆåŠŸåˆå¹¶å®ƒä»¬ä¹‹å‰ï¼Œä½ å¯èƒ½éœ€è¦è¿›è¡Œæ›´å¤šçš„å¤„ç†ã€‚ä¸
å¹¸çš„æ˜¯ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†è®©ä½ è‡ªå·±å»è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†ä½ å¯èƒ½æƒ³è¦é˜…è¯»å…³äº\texttt{map\_if()}å’Œ\texttt{map\_at()}çš„ä¿¡æ¯ã€‚\texttt{m}
\texttt{ap\_if()}å…è®¸ä½ æ ¹æ®åˆ—è¡¨å…ƒç´ çš„å€¼æœ‰é€‰æ‹©åœ°ä¿®æ”¹å®ƒä»¬ï¼›\texttt{map\_at()}å…è®¸ä½ æ ¹æ®å…ƒç´ çš„åç§°æœ‰é€‰æ‹©åœ°ä¿®æ”¹å®ƒä»¬ã€‚

\subsection{å¤„ç†å¤±è´¥}\label{ux5904ux7406ux5931ux8d25}

æœ‰æ—¶ï¼Œä½ çš„æ•°æ®ç»“æ„å¯èƒ½æå…¶å¤æ‚ï¼Œä»¥è‡³äºä½ ç”šè‡³æ— æ³•ä½¿ç”¨å•ä¸ªå‘½ä»¤è¯»å–æ‰€æœ‰æ–‡ä»¶ã€‚ç„¶
åä½ å°±ä¼šé‡åˆ°\texttt{map()}çš„ä¸€ä¸ªç¼ºç‚¹ï¼šè¦ä¹ˆæ•´ä½“æˆåŠŸï¼Œè¦ä¹ˆæ•´ä½“å¤±è´¥ã€‚\texttt{m}
\texttt{ap()}è¦ä¹ˆæˆåŠŸåœ°è¯»å–ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ï¼Œè¦ä¹ˆå› ä¸ºé”™è¯¯è€Œå¤±è´¥ï¼Œä¸€ä¸ªæ–‡ä»¶éƒ½è¯»ä¸åˆ°ã€‚è¿™
æœ‰ç‚¹çƒ¦äººï¼šä¸ºä»€ä¹ˆä¸€ä¸ªå¤±è´¥å°±é˜»æ­¢ä½ è·å¾—å…¶ä»–æˆåŠŸå‘¢ï¼Ÿ

å¹¸è¿çš„æ˜¯ï¼Œ\texttt{purrr}æä¾›äº†ä¸€ä¸ªè¾…åŠ©å‡½æ•°\texttt{possibly()}æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\texttt{p}
\texttt{ossibly()}æ˜¯ä¸€ä¸ªå‡½æ•°æ“ä½œç¬¦ï¼šå®ƒæ¥å—ä¸€ä¸ªå‡½æ•°å¹¶è¿”å›ä¸€ä¸ªè¡Œä¸ºç»è¿‡ä¿®æ”¹è¿‡å‡½æ•°ã€‚å…·
ä½“æ¥è¯´ï¼Œ\texttt{possibly()}ä¼šå°†å‡½æ•°ä»é”™è¯¯æ”¹ä¸ºè¿”å›ä½ æŒ‡å®šçš„å€¼ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{files }\OtherTok{\textless{}{-}}\NormalTok{ paths }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{map}\NormalTok{(}\FunctionTok{possibly}\NormalTok{(\textbackslash{}(path) readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(path), }\ConstantTok{NULL}\NormalTok{))}

\NormalTok{data }\OtherTok{\textless{}{-}}\NormalTok{ files }\SpecialCharTok{|\textgreater{}} \FunctionTok{list\_rbind}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

è¿™ä¸ªåšæ³•åœ¨è¿™é‡Œç‰¹åˆ«æœ‰æ•ˆï¼Œå› ä¸º\texttt{list\_rbind()}ï¼ˆåƒè®¸å¤š tidyverse
å‡½æ•°ä¸€æ ·ï¼‰ä¼šè‡ªåŠ¨å¿½ç•¥ \texttt{NULL} å€¼ã€‚

ç°åœ¨ä½ å·²ç»æœ‰äº†æ‰€æœ‰å¯ä»¥è½»æ¾è¯»å–çš„æ•°æ®ï¼Œæ˜¯æ—¶å€™è§£å†³å›°éš¾çš„éƒ¨åˆ†äº†ï¼Œå³å¼„æ¸…æ¥šä¸ºä»€ä¹ˆä¸€äº›æ–‡ä»¶åŠ è½½å¤±è´¥ä»¥åŠè¯¥å¦‚ä½•å¤„ç†å®ƒä»¬ã€‚é¦–
å…ˆï¼Œè·å–é‚£äº›å¤±è´¥çš„æ–‡ä»¶çš„è·¯å¾„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{failed }\OtherTok{\textless{}{-}} \FunctionTok{map\_vec}\NormalTok{(files, is.null)}
\NormalTok{paths[failed]}
\CommentTok{\#\textgreater{} character(0)}
\end{Highlighting}
\end{Shaded}

ç„¶åé’ˆå¯¹æ¯ä¸ªå¤±è´¥çš„æ–‡ä»¶å†æ¬¡è°ƒç”¨å¯¼å…¥å‡½æ•°ï¼Œå¹¶æ‰¾å‡ºå“ªé‡Œå‡ºäº†é—®é¢˜ã€‚

\section{ä¿å­˜å¤šä¸ªè¾“å‡º}\label{ux4fddux5b58ux591aux4e2aux8f93ux51fa}

ä¸Šä¸€ä¸ªéƒ¨åˆ†å­¦ä¹ äº†\texttt{map()}å‡½æ•°ï¼Œå®ƒå¯¹äºå°†å¤šä¸ªæ–‡ä»¶è¯»å–åˆ°å•ä¸ªå¯¹è±¡ä¸­éå¸¸æœ‰ç”¨ã€‚åœ¨
æœ¬éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†æ¢è®¨ä¸€ä¸ªç›¸åçš„é—®é¢˜ï¼šä½ å¦‚ä½•èƒ½å°†ä¸€ä¸ªæˆ–å¤šä¸ª R
å¯¹è±¡ä¿å­˜åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ä¸­ï¼Ÿæˆ‘ ä»¬å°†é€šè¿‡ä¸‰ä¸ªä¾‹å­æ¥æ¢ç´¢è¿™ä¸ªæŒ‘æˆ˜ï¼š

\begin{itemize}
\tightlist
\item
  å°†å¤šä¸ªæ•°æ®æ¡†ä¿å­˜åˆ°ä¸€ä¸ªæ•°æ®åº“ä¸­ã€‚
\item
  å°†å¤šä¸ªæ•°æ®æ¡†ä¿å­˜åˆ°å¤šä¸ª \texttt{.csv} æ–‡ä»¶ä¸­ã€‚
\item
  å°†å¤šä¸ªå›¾ä¿å­˜åˆ°å¤šä¸ª \texttt{.png} æ–‡ä»¶ä¸­ã€‚
\end{itemize}

\subsection{å†™å…¥æ•°æ®åº“}\label{sec-save-database}

æœ‰æ—¶åœ¨åŒæ—¶å¤„ç†è®¸å¤šæ–‡ä»¶æ—¶ï¼Œä¸å¯èƒ½å°†æ‰€æœ‰æ•°æ®ä¸€æ¬¡æ€§åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå› æ­¤ä½ æ— æ³•ä½¿ç”¨\texttt{map(files,\ read\_csv)}ã€‚å¤„
ç†è¿™ä¸ªé—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯å°†æ•°æ®åŠ è½½åˆ°æ•°æ®åº“ä¸­ï¼Œè¿™æ ·ä½ å°±å¯ä»¥ä½¿ç”¨\texttt{dbplyr}ä»…è®¿é—®ä½ éœ€è¦çš„éƒ¨åˆ†ã€‚

å¦‚æœä½ å¾ˆå¹¸è¿ï¼Œä½ æ‰€ä½¿ç”¨çš„æ•°æ®åº“åŒ…ä¼šæä¾›ä¸€ä¸ªæ–¹ä¾¿çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—ä¸€ä¸ªè·¯å¾„å‘é‡å¹¶å°†å®ƒä»¬å…¨éƒ¨åŠ è½½åˆ°æ•°æ®åº“ä¸­ã€‚è¿™
å°±æ˜¯\texttt{duckdb}çš„\texttt{duckdb\_read\_csv()}å‡½æ•°çš„æƒ…å†µã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{con }\OtherTok{\textless{}{-}}\NormalTok{ DBI}\SpecialCharTok{::}\FunctionTok{dbConnect}\NormalTok{(duckdb}\SpecialCharTok{::}\FunctionTok{duckdb}\NormalTok{())}
\NormalTok{duckdb}\SpecialCharTok{::}\FunctionTok{duckdb\_read\_csv}\NormalTok{(con, }\StringTok{"gapminder"}\NormalTok{, paths)}
\end{Highlighting}
\end{Shaded}

è¿™ç§æ–¹æ³•åœ¨è¿™é‡Œä¼šå¾ˆæœ‰æ•ˆï¼Œä½†æˆ‘ä»¬æ²¡æœ‰ csv æ–‡ä»¶ï¼Œè€Œæ˜¯ Excel
ç”µå­è¡¨æ ¼ï¼Œæ‰€ä»¥å¿…é¡»``æ‰‹åŠ¨''è¿›è¡Œã€‚å½“
ä½ æœ‰ä¸€å †csvï¼Œè€Œä½ æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“æ²¡æœ‰ä¸€ä¸ªå‡½æ•°å¯ä»¥å°†å®ƒä»¬å…¨éƒ¨åŠ è½½è¿›æ¥æ—¶ï¼Œå­¦ä¹ æ‰‹å·¥æ“ä½œä¹Ÿä¼šå¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚

æˆ‘ä»¬éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªè¡¨æ¥å¡«å……æ•°æ®ã€‚æœ€
ç®€å•çš„æ–¹æ³•æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªæ¨¡æ¿ï¼Œå³ä¸€ä¸ªåŒ…å«æˆ‘ä»¬æƒ³è¦çš„æ‰€æœ‰åˆ—ä½†åªåŒ…å«æ ·æœ¬æ•°æ®çš„è™šæ‹Ÿæ•°æ®æ¡†ã€‚å¯¹
äº gapminder æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¯»å–å•ä¸ªæ–‡ä»¶å¹¶å‘å…¶æ·»åŠ å¹´ä»½æ¥åˆ›å»ºè¯¥æ¨¡æ¿ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{template }\OtherTok{\textless{}{-}}\NormalTok{ readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(paths[[}\DecValTok{1}\NormalTok{]])}
\NormalTok{template}\SpecialCharTok{$}\NormalTok{year }\OtherTok{\textless{}{-}} \DecValTok{1952}
\NormalTok{template}
\CommentTok{\#\textgreater{} \# A tibble: 142 x 6}
\CommentTok{\#\textgreater{}   country     continent lifeExp      pop gdpPercap  year}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}       \textless{}chr\textgreater{}       \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 Afghanistan Asia         28.8  8425333      779.  1952}
\CommentTok{\#\textgreater{} 2 Albania     Europe       55.2  1282697     1601.  1952}
\CommentTok{\#\textgreater{} 3 Algeria     Africa       43.1  9279525     2449.  1952}
\CommentTok{\#\textgreater{} 4 Angola      Africa       30.0  4232095     3521.  1952}
\CommentTok{\#\textgreater{} 5 Argentina   Americas     62.5 17876956     5911.  1952}
\CommentTok{\#\textgreater{} 6 Australia   Oceania      69.1  8691212    10040.  1952}
\CommentTok{\#\textgreater{} \# i 136 more rows}
\end{Highlighting}
\end{Shaded}

ç°åœ¨æˆ‘ä»¬å¯ä»¥è¿æ¥åˆ°æ•°æ®åº“ï¼Œå¹¶ä½¿ç”¨\texttt{DBI::dbCreateTable()}å°†æˆ‘ä»¬çš„æ¨¡æ¿è½¬æ¢ä¸ºæ•°æ®åº“è¡¨ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{con }\OtherTok{\textless{}{-}}\NormalTok{ DBI}\SpecialCharTok{::}\FunctionTok{dbConnect}\NormalTok{(duckdb}\SpecialCharTok{::}\FunctionTok{duckdb}\NormalTok{())}
\NormalTok{DBI}\SpecialCharTok{::}\FunctionTok{dbCreateTable}\NormalTok{(con, }\StringTok{"gapminder"}\NormalTok{, template)}
\end{Highlighting}
\end{Shaded}

\texttt{dbCreateTable()}å¹¶ä¸ä½¿ç”¨\texttt{template}ä¸­çš„æ•°æ®ï¼Œè€Œåªæ˜¯ä½¿ç”¨å˜é‡åå’Œç±»å‹ã€‚æ‰€
ä»¥å¦‚æœæˆ‘ä»¬ç°åœ¨æ£€æŸ¥\texttt{gapminder}è¡¨ï¼Œä½ ä¼šçœ‹åˆ°å®ƒæ˜¯ç©ºçš„ï¼Œä½†å®ƒå…·æœ‰æˆ‘ä»¬éœ€è¦çš„å˜é‡å’Œé¢„æœŸçš„ç±»å‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{con }\SpecialCharTok{|\textgreater{}} \FunctionTok{tbl}\NormalTok{(}\StringTok{"gapminder"}\NormalTok{)}
\CommentTok{\#\textgreater{} \# Source:   table\textless{}gapminder\textgreater{} [0 x 6]}
\CommentTok{\#\textgreater{} \# Database: DuckDB v0.10.1 [root@Darwin 23.5.0:R 4.3.3/:memory:]}
\CommentTok{\#\textgreater{} \# i 6 variables: country \textless{}chr\textgreater{}, continent \textless{}chr\textgreater{}, lifeExp \textless{}dbl\textgreater{}, pop \textless{}dbl\textgreater{},}
\CommentTok{\#\textgreater{} \#   gdpPercap \textless{}dbl\textgreater{}, year \textless{}dbl\textgreater{}}
\end{Highlighting}
\end{Shaded}

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶è·¯å¾„ï¼Œå°†å…¶è¯»å–åˆ° R
ä¸­ï¼Œå¹¶å°†ç»“æœæ·»åŠ åˆ°\texttt{gapminder}è¡¨ä¸­ã€‚æˆ‘
ä»¬å¯ä»¥é€šè¿‡å°†\texttt{read\_excel()}ä¸\texttt{DBI::dbAppendTable()}ç»“åˆä½¿ç”¨æ¥å®ç°è¿™ä¸€ç‚¹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{append\_file }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(path) \{}
\NormalTok{  df }\OtherTok{\textless{}{-}}\NormalTok{ readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(path)}
\NormalTok{  df}\SpecialCharTok{$}\NormalTok{year }\OtherTok{\textless{}{-}} \FunctionTok{parse\_number}\NormalTok{(}\FunctionTok{basename}\NormalTok{(path))}
  
\NormalTok{  DBI}\SpecialCharTok{::}\FunctionTok{dbAppendTable}\NormalTok{(con, }\StringTok{"gapminder"}\NormalTok{, df)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

ç°åœ¨æˆ‘ä»¬éœ€è¦å¯¹\texttt{paths}ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ä¸€æ¬¡\texttt{append\_file()}å‡½æ•°ã€‚è¿™
å½“ç„¶å¯ä»¥ä½¿ç”¨\texttt{map()}å‡½æ•°æ¥å®ç°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{paths }\SpecialCharTok{|\textgreater{}} \FunctionTok{map}\NormalTok{(append\_file)}
\end{Highlighting}
\end{Shaded}

ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸å…³å¿ƒ\texttt{append\_file()}çš„è¾“å‡ºï¼Œæ‰€ä»¥ä¸\texttt{map()}ç›¸æ¯”ï¼Œä½¿ç”¨\texttt{walk()}ç¨å¾®æ›´åˆé€‚ã€‚\texttt{w}
\texttt{alk()}çš„åŠŸèƒ½ä¸\texttt{map()}ç›¸åŒï¼Œä½†å®ƒä¼šä¸¢å¼ƒè¾“å‡ºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{paths }\SpecialCharTok{|\textgreater{}} \FunctionTok{walk}\NormalTok{(append\_file)}
\end{Highlighting}
\end{Shaded}

ç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹çœ‹è¡¨ä¸­æ˜¯å¦æœ‰æ‰€æœ‰çš„æ•°æ®:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{con }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{tbl}\NormalTok{(}\StringTok{"gapminder"}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{count}\NormalTok{(year)}
\CommentTok{\#\textgreater{} \# Source:   SQL [?? x 2]}
\CommentTok{\#\textgreater{} \# Database: DuckDB v0.10.1 [root@Darwin 23.5.0:R 4.3.3/:memory:]}
\CommentTok{\#\textgreater{}    year     n}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1  1977   142}
\CommentTok{\#\textgreater{} 2  1987   142}
\CommentTok{\#\textgreater{} 3  1967   142}
\CommentTok{\#\textgreater{} 4  2007   142}
\CommentTok{\#\textgreater{} 5  1952   142}
\CommentTok{\#\textgreater{} 6  1957   142}
\CommentTok{\#\textgreater{} \# i more rows}
\end{Highlighting}
\end{Shaded}

\subsection{ç¼–å†™csvæ–‡ä»¶}\label{ux7f16ux5199csvux6587ux4ef6}

å¦‚æœæˆ‘ä»¬æƒ³è¦ç¼–å†™å¤šä¸ª csv æ–‡ä»¶ (æ¯ä¸ªç»„ä¸€ä¸ª) ,
é‚£ä¹ˆåŒæ ·çš„åŸºæœ¬åŸåˆ™ä¹Ÿé€‚ç”¨ã€‚è®©
æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬æƒ³è¦è·å–\texttt{ggplot2::diamonds}æ•°æ®ï¼Œå¹¶ä¸ºæ¯ç§\texttt{clarity}ä¿å­˜ä¸€ä¸ª
csv æ–‡ä»¶ã€‚é¦– å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºè¿™äº›å•ç‹¬çš„æ•°æ®é›†ã€‚å¯
ä»¥é€šè¿‡å¤šç§æ–¹å¼åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½†æœ‰ä¸€ç§æˆ‘ä»¬ç‰¹åˆ«å–œæ¬¢çš„æ–¹æ³•ï¼š\texttt{group\_nest()}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{by\_clarity }\OtherTok{\textless{}{-}}\NormalTok{ diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_nest}\NormalTok{(clarity)}

\NormalTok{by\_clarity}
\CommentTok{\#\textgreater{} \# A tibble: 8 x 2}
\CommentTok{\#\textgreater{}   clarity               data}
\CommentTok{\#\textgreater{}   \textless{}ord\textgreater{}   \textless{}list\textless{}tibble[,9]\textgreater{}\textgreater{}}
\CommentTok{\#\textgreater{} 1 I1               [741 x 9]}
\CommentTok{\#\textgreater{} 2 SI2            [9,194 x 9]}
\CommentTok{\#\textgreater{} 3 SI1           [13,065 x 9]}
\CommentTok{\#\textgreater{} 4 VS2           [12,258 x 9]}
\CommentTok{\#\textgreater{} 5 VS1            [8,171 x 9]}
\CommentTok{\#\textgreater{} 6 VVS2           [5,066 x 9]}
\CommentTok{\#\textgreater{} \# i 2 more rows}
\end{Highlighting}
\end{Shaded}

è¿™ä¼šæä¾›ç»™æˆ‘ä»¬ä¸€ä¸ªæ–°çš„tibble ï¼Œå®ƒæœ‰å…«è¡Œä¸¤åˆ—ã€‚\texttt{c}
\texttt{larity}æ˜¯æˆ‘ä»¬çš„åˆ†ç»„å˜é‡ï¼Œè€Œ\texttt{data}æ˜¯ä¸€ä¸ªåˆ—è¡¨åˆ—ï¼Œå®ƒåŒ…å«æ¯ä¸ª\texttt{clarity}å€¼å¯¹åº”çš„ä¸€ä¸ªæ•°æ®æ¡†ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{by\_clarity}\SpecialCharTok{$}\NormalTok{data[[}\DecValTok{1}\NormalTok{]]}
\CommentTok{\#\textgreater{} \# A tibble: 741 x 9}
\CommentTok{\#\textgreater{}   carat cut       color depth table price     x     y     z}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}ord\textgreater{}     \textless{}ord\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}int\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1  0.32 Premium   E      60.9    58   345  4.38  4.42  2.68}
\CommentTok{\#\textgreater{} 2  1.17 Very Good J      60.2    61  2774  6.83  6.9   4.13}
\CommentTok{\#\textgreater{} 3  1.01 Premium   F      61.8    60  2781  6.39  6.36  3.94}
\CommentTok{\#\textgreater{} 4  1.01 Fair      E      64.5    58  2788  6.29  6.21  4.03}
\CommentTok{\#\textgreater{} 5  0.96 Ideal     F      60.7    55  2801  6.37  6.41  3.88}
\CommentTok{\#\textgreater{} 6  1.04 Premium   G      62.2    58  2801  6.46  6.41  4   }
\CommentTok{\#\textgreater{} \# i 735 more rows}
\end{Highlighting}
\end{Shaded}

åœ¨è¿™é‡Œï¼Œè®©æˆ‘ä»¬ä½¿ç”¨\texttt{mutate()}å’Œ\texttt{str\_glue()}åˆ›å»ºä¸€ä¸ªåˆ—æ¥ç»™å‡ºè¾“å‡ºæ–‡ä»¶çš„åç§°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{by\_clarity }\OtherTok{\textless{}{-}}\NormalTok{ by\_clarity }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{path =} \FunctionTok{str\_glue}\NormalTok{(}\StringTok{"diamonds{-}\{clarity\}.csv"}\NormalTok{))}

\NormalTok{by\_clarity}
\CommentTok{\#\textgreater{} \# A tibble: 8 x 3}
\CommentTok{\#\textgreater{}   clarity               data path             }
\CommentTok{\#\textgreater{}   \textless{}ord\textgreater{}   \textless{}list\textless{}tibble[,9]\textgreater{}\textgreater{} \textless{}glue\textgreater{}           }
\CommentTok{\#\textgreater{} 1 I1               [741 x 9] diamonds{-}I1.csv  }
\CommentTok{\#\textgreater{} 2 SI2            [9,194 x 9] diamonds{-}SI2.csv }
\CommentTok{\#\textgreater{} 3 SI1           [13,065 x 9] diamonds{-}SI1.csv }
\CommentTok{\#\textgreater{} 4 VS2           [12,258 x 9] diamonds{-}VS2.csv }
\CommentTok{\#\textgreater{} 5 VS1            [8,171 x 9] diamonds{-}VS1.csv }
\CommentTok{\#\textgreater{} 6 VVS2           [5,066 x 9] diamonds{-}VVS2.csv}
\CommentTok{\#\textgreater{} \# i 2 more rows}
\end{Highlighting}
\end{Shaded}

æ‰€ä»¥ï¼Œå¦‚æœè¦æ‰‹å·¥ä¿å­˜è¿™äº›æ•°æ®æ¡†ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·å†™:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{write\_csv}\NormalTok{(by\_clarity}\SpecialCharTok{$}\NormalTok{data[[}\DecValTok{1}\NormalTok{]], by\_clarity}\SpecialCharTok{$}\NormalTok{path[[}\DecValTok{1}\NormalTok{]])}
\FunctionTok{write\_csv}\NormalTok{(by\_clarity}\SpecialCharTok{$}\NormalTok{data[[}\DecValTok{2}\NormalTok{]], by\_clarity}\SpecialCharTok{$}\NormalTok{path[[}\DecValTok{2}\NormalTok{]])}
\FunctionTok{write\_csv}\NormalTok{(by\_clarity}\SpecialCharTok{$}\NormalTok{data[[}\DecValTok{3}\NormalTok{]], by\_clarity}\SpecialCharTok{$}\NormalTok{path[[}\DecValTok{3}\NormalTok{]])}
\NormalTok{...}
\FunctionTok{write\_csv}\NormalTok{(by\_clarity}\SpecialCharTok{$}\NormalTok{by\_clarity[[}\DecValTok{8}\NormalTok{]], by\_clarity}\SpecialCharTok{$}\NormalTok{path[[}\DecValTok{8}\NormalTok{]])}
\end{Highlighting}
\end{Shaded}

è¿™ä¸æˆ‘ä»¬ä¹‹å‰ä½¿ç”¨\texttt{map()}çš„æƒ…å†µç•¥æœ‰ä¸åŒï¼Œå› ä¸ºæœ‰ä¸¤ä¸ªå‚æ•°åœ¨å˜åŒ–ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªã€‚è¿™
æ„å‘³ç€æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–°å‡½æ•°\texttt{map2()}ï¼Œå®ƒåŒæ—¶æ”¹å˜ç¬¬ä¸€å’Œç¬¬äºŒä¸ªå‚æ•°ã€‚å› 
ä¸ºæˆ‘ä»¬åŒæ ·ä¸å…³å¿ƒè¾“å‡ºï¼Œæ‰€ä»¥æƒ³è¦ä½¿ç”¨\texttt{walk2()}è€Œä¸æ˜¯\texttt{map2()}ã€‚è¿™
ç»™äº†æˆ‘ä»¬ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{walk2}\NormalTok{(by\_clarity}\SpecialCharTok{$}\NormalTok{data, by\_clarity}\SpecialCharTok{$}\NormalTok{path, write\_csv)}
\end{Highlighting}
\end{Shaded}

\subsection{ä¿å­˜å›¾å½¢}\label{ux4fddux5b58ux56feux5f62}

æˆ‘ä»¬å¯ä»¥é‡‡ç”¨ç›¸åŒçš„åŸºæœ¬æ–¹æ³•æ¥åˆ›å»ºè®¸å¤šå›¾å½¢ã€‚è®©
æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥ç»˜åˆ¶æˆ‘ä»¬æƒ³è¦çš„å›¾å½¢:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carat\_histogram }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(df) \{}
  \FunctionTok{ggplot}\NormalTok{(df, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ carat)) }\SpecialCharTok{+} \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \FloatTok{0.1}\NormalTok{)  }
\NormalTok{\}}

\FunctionTok{carat\_histogram}\NormalTok{(by\_clarity}\SpecialCharTok{$}\NormalTok{data[[}\DecValTok{1}\NormalTok{]])}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{iteration_files/figure-pdf/unnamed-chunk-69-1.pdf}

ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{map()}æ¥åˆ›å»ºä¸€ä¸ªåŒ…å«å¤šä¸ªå›¾å½¢\footnote{ä½ å¯ä»¥è¾“å‡º\texttt{by\_clarity\$plot}æ¥å¾—åˆ°ä¸€ä¸ªç²—ç•¥çš„åŠ¨ç”»------ä½ ä¼šå¾—åˆ°\texttt{plots}ä¸­æ¯ä¸ªå…ƒç´ çš„ä¸€ä¸ªå›¾å½¢ã€‚æ³¨
  æ„ï¼šè¿™ç§æƒ…å†µå¹¶æ²¡æœ‰å‘ç”Ÿåœ¨æˆ‘èº«ä¸Šã€‚}åŠå…¶æœ€ç»ˆæ–‡ä»¶è·¯å¾„çš„åˆ—è¡¨ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{by\_clarity }\OtherTok{\textless{}{-}}\NormalTok{ by\_clarity }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{mutate}\NormalTok{(}
    \AttributeTok{plot =} \FunctionTok{map}\NormalTok{(data, carat\_histogram),}
    \AttributeTok{path =} \FunctionTok{str\_glue}\NormalTok{(}\StringTok{"clarity{-}\{clarity\}.png"}\NormalTok{)}
\NormalTok{  )}
\end{Highlighting}
\end{Shaded}

ç„¶åä½¿ç”¨\texttt{walk2()}å’Œ\texttt{ggsave()}æ¥ä¿å­˜æ¯ä¸ªå›¾å½¢:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{walk2}\NormalTok{(}
\NormalTok{  by\_clarity}\SpecialCharTok{$}\NormalTok{path,}
\NormalTok{  by\_clarity}\SpecialCharTok{$}\NormalTok{plot,}
\NormalTok{  \textbackslash{}(path, plot) }\FunctionTok{ggsave}\NormalTok{(path, plot, }\AttributeTok{width =} \DecValTok{6}\NormalTok{, }\AttributeTok{height =} \DecValTok{6}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

è¿™æ˜¯ä»¥ä¸‹å†…å®¹çš„ç®€å†™:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggsave}\NormalTok{(by\_clarity}\SpecialCharTok{$}\NormalTok{path[[}\DecValTok{1}\NormalTok{]], by\_clarity}\SpecialCharTok{$}\NormalTok{plot[[}\DecValTok{1}\NormalTok{]], }\AttributeTok{width =} \DecValTok{6}\NormalTok{, }\AttributeTok{height =} \DecValTok{6}\NormalTok{)}
\FunctionTok{ggsave}\NormalTok{(by\_clarity}\SpecialCharTok{$}\NormalTok{path[[}\DecValTok{2}\NormalTok{]], by\_clarity}\SpecialCharTok{$}\NormalTok{plot[[}\DecValTok{2}\NormalTok{]], }\AttributeTok{width =} \DecValTok{6}\NormalTok{, }\AttributeTok{height =} \DecValTok{6}\NormalTok{)}
\FunctionTok{ggsave}\NormalTok{(by\_clarity}\SpecialCharTok{$}\NormalTok{path[[}\DecValTok{3}\NormalTok{]], by\_clarity}\SpecialCharTok{$}\NormalTok{plot[[}\DecValTok{3}\NormalTok{]], }\AttributeTok{width =} \DecValTok{6}\NormalTok{, }\AttributeTok{height =} \DecValTok{6}\NormalTok{)}
\NormalTok{...}
\FunctionTok{ggsave}\NormalTok{(by\_clarity}\SpecialCharTok{$}\NormalTok{path[[}\DecValTok{8}\NormalTok{]], by\_clarity}\SpecialCharTok{$}\NormalTok{plot[[}\DecValTok{8}\NormalTok{]], }\AttributeTok{width =} \DecValTok{6}\NormalTok{, }\AttributeTok{height =} \DecValTok{6}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{å°ç»“}\label{ux5c0fux7ed3-25}

åœ¨è¿™ä¸€ç« ä¸­ï¼Œä½ å·²ç»çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨æ˜¾å¼è¿­ä»£æ¥è§£å†³åœ¨æ•°æ®ç§‘å­¦ä¸­ç»å¸¸é‡åˆ°çš„ä¸‰ä¸ªé—®é¢˜ï¼šæ“ä½œå¤šä¸ªåˆ—ã€è¯»å–å¤šä¸ªæ–‡ä»¶ä»¥åŠä¿å­˜å¤šä¸ªè¾“å‡ºã€‚ä½†
ä¸€èˆ¬æ¥è¯´ï¼Œè¿­ä»£æ˜¯ä¸€ç§è¶…èƒ½åŠ›ï¼šå¦‚æœä½ çŸ¥é“æ­£ç¡®çš„è¿­ä»£æ–¹æ³•ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°ä»è§£å†³ä¸€ä¸ªé—®é¢˜è½¬å˜ä¸ºè§£å†³æ‰€æœ‰é—®é¢˜ã€‚ä¸€
æ—¦ä½ æŒæ¡äº†æœ¬ç« ä¸­çš„æŠ€æœ¯ï¼Œæˆ‘ä»¬å¼ºçƒˆæ¨èä½ é€šè¿‡é˜…è¯»ã€ŠAdvanced Rã€‹çš„
\href{https://adv-r.hadley.nz/functionals.html}{Functionals chapter}
å¹¶æŸ¥é˜… \href{https://purrr.tidyverse.org}{purrr website} æ¥è¿›ä¸€æ­¥å­¦ä¹ ã€‚

å¦‚æœä½ å¯¹å…¶ä»–è¯­è¨€ä¸­çš„è¿­ä»£æœ‰æ‰€äº†è§£ï¼Œå¯èƒ½ä¼šæƒŠè®¶äºæˆ‘ä»¬æ²¡æœ‰è®¨è®º for å¾ªç¯ã€‚è¿™
æ˜¯å› ä¸º R
çš„æ•°æ®åˆ†æå¯¼å‘æ”¹å˜äº†æˆ‘ä»¬è¿­ä»£çš„æ–¹å¼ï¼šåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä¾é ç°æœ‰çš„ä¹ æƒ¯ç”¨æ³•æ¥å¯¹æ¯ä¸ªåˆ—æˆ–æ¯ä¸ªç»„æ‰§è¡ŒæŸäº›æ“ä½œã€‚è€Œ
å½“ä½ ä¸èƒ½è¿™æ ·åšæ—¶ï¼Œä½ é€šå¸¸å¯ä»¥ä½¿ç”¨åƒ\texttt{map()}è¿™æ ·çš„å‡½æ•°å¼ç¼–ç¨‹å·¥å…·æ¥å¯¹åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ æ‰§è¡ŒæŸäº›æ“ä½œã€‚ç„¶
è€Œï¼Œä½ å°†åœ¨åŸå§‹ä»£ç ä¸­çœ‹åˆ° for
å¾ªç¯ï¼Œå› æ­¤ä½ å°†åœ¨ä¸‹ä¸€ç« ä¸­å­¦ä¹ å®ƒä»¬ï¼Œå±Šæ—¶æˆ‘ä»¬å°†è®¨è®ºä¸€äº›é‡è¦çš„åŸºç¡€ R å·¥å…·ã€‚

\chapter{RåŸºç¡€å®ç”¨æŒ‡å—}\label{sec-base-r}

\section{å¼•è¨€}\label{ux5f15ux8a00-22}

åœ¨ç¼–ç¨‹éƒ¨åˆ†çš„ç»“å°¾ï¼Œæˆ‘ä»¬å°†å¿«é€Ÿä»‹ç»ä¸€äº›æœ€é‡è¦çš„åŸºç¡€Rå‡½æ•°ï¼Œè¿™äº›å‡½æ•°åœ¨æœ¬ä¹¦ä¸­å¹¶æ²¡æœ‰è®¨è®ºã€‚è¿™
äº›å·¥å…·åœ¨ä½ è¿›è¡Œæ›´å¤šç¼–ç¨‹æ—¶ä¼šç‰¹åˆ«æœ‰ç”¨ï¼Œå¹¶ä¸”ä¼šå¸®åŠ©ä½ é˜…è¯»åœ¨å®é™…é¡¹ç›®ä¸­é‡åˆ°çš„ä»£ç ã€‚

è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ—¶æœºæ¥æé†’ä½ ï¼Œtidyverseå¹¶ä¸æ˜¯è§£å†³æ•°æ®ç§‘å­¦é—®é¢˜çš„å”¯ä¸€æ–¹æ³•ã€‚æˆ‘
ä»¬åœ¨æœ¬ä¹¦ä¸­æ•™æˆtidyverseæ˜¯å› ä¸ºtidyverseåŒ…å…±äº«ä¸€ç§å…±åŒçš„è®¾è®¡ç†å¿µï¼Œå¢åŠ äº†å‡½æ•°ä¹‹é—´çš„ä¸€è‡´æ€§ï¼Œå¹¶ä½¿æ¯ä¸ªæ–°å‡½æ•°æˆ–åŒ…æ›´å®¹æ˜“å­¦ä¹ å’Œä½¿ç”¨ã€‚ä¸
ä½¿ç”¨åŸºç¡€Rå°±æ— æ³•ä½¿ç”¨tidyverseï¼Œå› æ­¤å®é™…ä¸Šæˆ‘ä»¬å·²ç»å‘ä½ ä»‹ç»äº†è®¸å¤šåŸºç¡€Rå‡½æ•°ï¼šä»\texttt{library()}æ¥åŠ è½½åŒ…ï¼Œåˆ°\texttt{sum()}å’Œ\texttt{mean()}ç”¨äºæ•°å€¼æ±‡æ€»ï¼Œåˆ°factorã€dateå’ŒPOSIXctæ•°æ®ç±»å‹ï¼Œå½“ç„¶è¿˜æœ‰æ‰€æœ‰åŸºæœ¬è¿ç®—ç¬¦å¦‚\texttt{+}ã€\texttt{-}ã€\texttt{/}ã€\texttt{*}ã€\texttt{\textbar{}}ã€\texttt{\&}å’Œ\texttt{ï¼}ã€‚åˆ°
ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰é‡ç‚¹å…³æ³¨åŸºç¡€Rå·¥ä½œæµç¨‹ï¼Œå› æ­¤æœ¬ç« æˆ‘ä»¬å°†é‡ç‚¹ä»‹ç»å…¶ä¸­çš„ä¸€äº›ã€‚

è¯»å®Œè¿™æœ¬ä¹¦åï¼Œä½ å°†å­¦ä¹ ä½¿ç”¨åŸºç¡€Rã€data.tableå’Œå…¶ä»–åŒ…æ¥è§£å†³ç›¸åŒé—®é¢˜çš„å…¶ä»–æ–¹æ³•ã€‚å½“
ä½ å¼€å§‹é˜…è¯»å…¶ä»–äººç¼–å†™çš„Rä»£ç æ—¶ï¼Œç‰¹åˆ«æ˜¯å¦‚æœä½ åœ¨ä½¿ç”¨StackOverflowæ—¶ï¼Œä½ æ— ç–‘ä¼šé‡åˆ°è¿™äº›å…¶ä»–æ–¹æ³•ã€‚ç¼–
å†™ä½¿ç”¨å¤šç§æ–¹æ³•çš„ä»£ç æ˜¯å®Œå…¨å¯ä»¥çš„ï¼Œä¸è¦è®©ä»»ä½•äººå‘Šè¯‰ä½ ä¸æ˜¯è¿™æ ·ï¼

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨å››ä¸ªå¤§ä¸»é¢˜ï¼šä½¿ç”¨\texttt{{[}}è¿›è¡Œå­é›†é€‰æ‹©ï¼Œä½¿ç”¨\texttt{{[}{[}}å’Œ\texttt{\$}è¿›è¡Œå­é›†é€‰æ‹©ï¼Œapplyå‡½æ•°æ—å’Œ\texttt{for}å¾ªç¯ã€‚æœ€
åï¼Œæˆ‘ä»¬å°†ç®€è¦è®¨è®ºä¸¤ä¸ªåŸºæœ¬çš„ç»˜å›¾å‡½æ•°ã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-23}

è¿™ä¸ªåŒ…ä¸“æ³¨äºRçš„åŸºç¡€åŠŸèƒ½ï¼Œå› æ­¤æ²¡æœ‰çœŸæ­£çš„å¿…è¦æ¡ä»¶ï¼Œä½†ä¸ºäº†è§£é‡Šä¸€äº›å·®å¼‚ï¼Œæˆ‘ä»¬å°†åŠ è½½tidyverseåŒ…ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\section{\texorpdfstring{åˆ©ç”¨ \texttt{{[}}
é€‰æ‹©å¤šä¸ªå…ƒç´ }{åˆ©ç”¨ {[} é€‰æ‹©å¤šä¸ªå…ƒç´ }}\label{sec-subset-many}

\texttt{{[}}ç”¨äºä»å‘é‡å’Œæ•°æ®æ¡†ä¸­æå–å­ç»„ä»¶ï¼Œå…¶è°ƒç”¨æ–¹å¼å¦‚\texttt{x{[}i{]}}æˆ–\texttt{x{[}i,\ j{]}}ã€‚åœ¨
æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å‘æ‚¨ä»‹ç»\texttt{{[}}çš„å¼ºå¤§åŠŸèƒ½ï¼Œé¦–å…ˆå±•ç¤ºå¦‚ä½•åœ¨å‘é‡ä¸­ä½¿ç”¨å®ƒï¼Œç„¶åå±•ç¤ºç›¸åŒçš„åŸç†å¦‚ä½•ç›´æ¥æ‰©å±•åˆ°äºŒç»´ï¼ˆ2dï¼‰ç»“æ„ï¼Œå¦‚æ•°æ®æ¡†ã€‚ä¹‹
åï¼Œæˆ‘ä»¬å°†é€šè¿‡å±•ç¤º\texttt{dplyr}ä¸­çš„å„ç§å‡½æ•°æ˜¯å¦‚ä½•ä½œä¸º\texttt{{[}}çš„ç‰¹æ®Šæƒ…å†µçš„ä¾‹å­æ¥å¸®åŠ©ä½ å·©å›ºè¿™äº›çŸ¥è¯†ã€‚

\subsection{å‘é‡å­é›†é€‰æ‹©}\label{ux5411ux91cfux5b50ux96c6ux9009ux62e9}

æœ‰äº”ç§ä¸»è¦çš„æ–¹å¼å¯ä»¥ç”¨æ¥å¯¹å‘é‡è¿›è¡Œå­é›†é€‰æ‹©ï¼Œå³å¯ä»¥åˆ©ç”¨ä½œä¸º\texttt{x{[}i{]}}ä¸­çš„\texttt{i}ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \textbf{æ­£æ•´æ•°å‘é‡}ã€‚ä½¿ ç”¨æ­£æ•´æ•°è¿›è¡Œå­é›†é€‰æ‹©ä¼šä¿ç•™è¿™äº›ä½ç½®ä¸Šçš„å…ƒç´ ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"one"}\NormalTok{, }\StringTok{"two"}\NormalTok{, }\StringTok{"three"}\NormalTok{, }\StringTok{"four"}\NormalTok{, }\StringTok{"five"}\NormalTok{)}
\NormalTok{x[}\FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{5}\NormalTok{)]}
\CommentTok{\#\textgreater{} [1] "three" "two"   "five"}
\end{Highlighting}
\end{Shaded}

  é€šè¿‡é‡å¤æŸä¸ªä½ç½®ï¼Œä½ å®é™…ä¸Šå¯ä»¥ç”Ÿæˆä¸€ä¸ªæ¯”è¾“å…¥æ›´é•¿çš„è¾“å‡ºï¼Œè¿™ä½¿å¾—``å­é›†é€‰æ‹©''è¿™ä¸ªæœ¯è¯­æœ‰ç‚¹åä¸å‰¯å®ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{2}\NormalTok{)]}
\CommentTok{\#\textgreater{} [1] "one"  "one"  "five" "five" "five" "two"}
\end{Highlighting}
\end{Shaded}
\item
  \textbf{è´Ÿæ•´æ•°å‘é‡}ã€‚ è´Ÿå€¼ä¼šåˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[}\FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{3}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{5}\NormalTok{)]}
\CommentTok{\#\textgreater{} [1] "two"  "four"}
\end{Highlighting}
\end{Shaded}
\item
  \textbf{é€»è¾‘å‘é‡}ã€‚ä½¿
  ç”¨é€»è¾‘å‘é‡è¿›è¡Œå­é›†é€‰æ‹©ä¼šä¿ç•™æ‰€æœ‰ä¸\texttt{TRUE}å€¼å¯¹åº”çš„å€¼ã€‚è¿™
  é€šå¸¸ä¸æ¯”è¾ƒå‡½æ•°ä¸€èµ·ä½¿ç”¨æ—¶éå¸¸æœ‰ç”¨ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{3}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{8}\NormalTok{, }\DecValTok{1}\NormalTok{, }\ConstantTok{NA}\NormalTok{)}

\CommentTok{\# All non{-}missing values of x}
\NormalTok{x[}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(x)]}
\CommentTok{\#\textgreater{} [1] 10  3  5  8  1}

\CommentTok{\# All even (or missing!) values of x}
\NormalTok{x[x }\SpecialCharTok{\%\%} \DecValTok{2} \SpecialCharTok{==} \DecValTok{0}\NormalTok{]}
\CommentTok{\#\textgreater{} [1] 10 NA  8 NA}
\end{Highlighting}
\end{Shaded}

  ä¸\texttt{filter()}ä¸åŒï¼Œ\texttt{NA} ç´¢å¼•ä¼šè¢«åŒ…å«åœ¨è¾“å‡ºä¸­ï¼Œå¹¶ä¸”ä»¥
  \texttt{NAs} çš„å½¢å¼å‡ºç°ã€‚
\item
  \textbf{å­—ç¬¦å‘é‡}ã€‚å¦‚
  æœä½ æœ‰ä¸€ä¸ªå‘½åçš„å‘é‡ï¼Œä½ å¯ä»¥ä½¿ç”¨å­—ç¬¦å‘é‡æ¥å¯¹å…¶è¿›è¡Œå­é›†é€‰æ‹©ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\AttributeTok{abc =} \DecValTok{1}\NormalTok{, }\AttributeTok{def =} \DecValTok{2}\NormalTok{, }\AttributeTok{xyz =} \DecValTok{5}\NormalTok{)}
\NormalTok{x[}\FunctionTok{c}\NormalTok{(}\StringTok{"xyz"}\NormalTok{, }\StringTok{"def"}\NormalTok{)]}
\CommentTok{\#\textgreater{} xyz def }
\CommentTok{\#\textgreater{}   5   2}
\end{Highlighting}
\end{Shaded}

  ä¸ä½¿ç”¨æ­£æ•´æ•°è¿›è¡Œå­é›†é€‰æ‹©ä¸€æ ·ï¼Œä½ å¯ä»¥ä½¿ç”¨å­—ç¬¦å‘é‡æ¥é‡å¤å•ä¸ªæ¡ç›®ã€‚
\item
  \textbf{ä¸æŒ‡å®šä»»ä½•å†…å®¹}ã€‚æœ€
  åä¸€ç§å­é›†é€‰æ‹©æ–¹å¼æ˜¯ä»€ä¹ˆéƒ½ä¸æŒ‡å®šï¼Œå³\texttt{x{[}{]}}ï¼Œè¿™å°†è¿”å›å®Œæ•´çš„\texttt{x}ã€‚è¿™
  å¯¹äºå‘é‡çš„å­é›†é€‰æ‹©æ¥è¯´å¹¶ä¸å®ç”¨ï¼Œä½†æ­£å¦‚æˆ‘ä»¬ç¨åä¼šçœ‹åˆ°çš„ï¼Œå½“å¯¹åƒ tibble
  è¿™æ ·çš„äºŒç»´ç»“æ„è¿›è¡Œå­é›†é€‰æ‹©æ—¶ï¼Œå®ƒæ˜¯å¾ˆæœ‰ç”¨çš„ã€‚
\end{enumerate}

\subsection{æ•°æ®æ¡†å­é›†é€‰æ‹©}\label{ux6570ux636eux6846ux5b50ux96c6ux9009ux62e9}

ä½ å¯ä»¥ä½¿ç”¨å¤šç§ä¸åŒçš„æ–¹å¼\footnote{é˜…è¯»\url{https://adv-r.hadley.nz/subsetting.html\#subset-multiple}æ¥äº†è§£å¦‚ä½•åƒå¯¹å¾…ä¸€ç»´å¯¹è±¡é‚£æ ·å¯¹æ•°æ®æ¡†è¿›è¡Œå­é›†é€‰æ‹©ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨çŸ©é˜µæ¥å¯¹å…¶è¿›è¡Œå­é›†é€‰æ‹©ã€‚}
å¯¹æ•°æ®æ¡†ä½¿ç”¨\texttt{{[}}ï¼Œä½†æœ€é‡è¦çš„æ–¹å¼æ˜¯ä½¿ç”¨\texttt{df{[}rows,\ cols{]}}æ¥ç‹¬ç«‹é€‰æ‹©è¡Œå’Œåˆ—ã€‚
è¿™é‡Œçš„\texttt{rows}å’Œ\texttt{cols}æ˜¯ä¸Šé¢æè¿°çš„å‘é‡ã€‚
ä¾‹å¦‚ï¼Œ\texttt{df{[}rows,\ {]}}å’Œ\texttt{df{[},\ cols{]}}åˆ†åˆ«åªé€‰æ‹©è¡Œæˆ–åˆ—ï¼Œé€šè¿‡ä¿ç•™å…¶ä»–ç»´åº¦çš„ç©ºå­é›†æ¥å®ç°ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›ç¤ºä¾‹:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{x =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }
  \AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"e"}\NormalTok{, }\StringTok{"f"}\NormalTok{), }
  \AttributeTok{z =} \FunctionTok{runif}\NormalTok{(}\DecValTok{3}\NormalTok{)}
\NormalTok{)}

\CommentTok{\# Select first row and second column}
\NormalTok{df[}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{]}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 1}
\CommentTok{\#\textgreater{}   y    }
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1 a}

\CommentTok{\# Select all rows and columns x and y}
\NormalTok{df[, }\FunctionTok{c}\NormalTok{(}\StringTok{"x"}\NormalTok{ , }\StringTok{"y"}\NormalTok{)]}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 2}
\CommentTok{\#\textgreater{}       x y    }
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}chr\textgreater{}}
\CommentTok{\#\textgreater{} 1     1 a    }
\CommentTok{\#\textgreater{} 2     2 e    }
\CommentTok{\#\textgreater{} 3     3 f}

\CommentTok{\# Select rows where \textasciigrave{}x\textasciigrave{} is greater than 1 and all columns}
\NormalTok{df[df}\SpecialCharTok{$}\NormalTok{x }\SpecialCharTok{\textgreater{}} \DecValTok{1}\NormalTok{, ]}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 3}
\CommentTok{\#\textgreater{}       x y         z}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}chr\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     2 e     0.834}
\CommentTok{\#\textgreater{} 2     3 f     0.601}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬ç¨åä¼šå›åˆ°\texttt{\$}ï¼Œä½†ä½ åº”è¯¥èƒ½å¤Ÿæ ¹æ®ä¸Šä¸‹æ–‡çŒœå‡º\texttt{df\$x}çš„ä½œç”¨ï¼šå®ƒä»\texttt{df}ä¸­æå–\texttt{x}å˜é‡ã€‚æˆ‘
ä»¬åœ¨è¿™é‡Œéœ€è¦ä½¿ç”¨å®ƒï¼Œå› ä¸º\texttt{{[}}ä¸ä½¿ç”¨æ•´é½è¯„ä¼°ï¼ˆtidy
evaluationï¼‰ï¼Œæ‰€ä»¥éœ€è¦æ˜ç¡®æŒ‡å®š\texttt{x}å˜é‡çš„æ¥æºã€‚

åœ¨\texttt{{[}}çš„ä½¿ç”¨ä¸Šï¼Œtibble å’Œæ•°æ®æ¡†ä¹‹é—´å­˜åœ¨é‡è¦çš„åŒºåˆ«ã€‚åœ¨
æœ¬ä¹¦ä¸­æˆ‘ä»¬ä¸»è¦ä½¿ç”¨äº†tibbleï¼Œå®ƒä»¬æ˜¯æ•°æ®æ¡†ï¼Œä½†è°ƒæ•´äº†ä¸€äº›è¡Œä¸ºä»¥ä½¿ä½ çš„å·¥ä½œæ›´åŠ è½»æ¾ã€‚åœ¨
å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥äº’æ¢ä½¿ç”¨``tibble''å’Œ``æ•°æ®æ¡†''ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬è¦ç‰¹åˆ«å…³æ³¨
R çš„å†…ç½®æ•°æ®æ¡†æ—¶ï¼Œæˆ‘ä»¬ä¼šå†™\texttt{data.frame}ã€‚å¦‚
æœ\texttt{df}æ˜¯ä¸€ä¸ª\texttt{data.frame}ï¼Œé‚£ä¹ˆ\texttt{df{[},\ cols{]}}ä¼šåœ¨\texttt{col}é€‰æ‹©å•ä¸ªåˆ—æ—¶è¿”å›ä¸€ä¸ªå‘é‡ï¼Œåœ¨é€‰æ‹©å¤šä¸ªåˆ—æ—¶è¿”å›ä¸€ä¸ªæ•°æ®æ¡†ã€‚å¦‚
æœ\texttt{df}æ˜¯ä¸€ä¸ª tibbleï¼Œé‚£ä¹ˆ\texttt{{[}}æ€»æ˜¯ä¼šè¿”å›ä¸€ä¸ª tibbleã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df1 }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{x =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)}
\NormalTok{df1[, }\StringTok{"x"}\NormalTok{]}
\CommentTok{\#\textgreater{} [1] 1 2 3}

\NormalTok{df2 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{x =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{)}
\NormalTok{df2[, }\StringTok{"x"}\NormalTok{]}
\CommentTok{\#\textgreater{} \# A tibble: 3 x 1}
\CommentTok{\#\textgreater{}       x}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{}}
\CommentTok{\#\textgreater{} 1     1}
\CommentTok{\#\textgreater{} 2     2}
\CommentTok{\#\textgreater{} 3     3}
\end{Highlighting}
\end{Shaded}

é¿å…æ•°æ®æ¡†ä¸­è¿™ç§æ¨¡ç³Šæ€§çš„ä¸€ä¸ªæ–¹æ³•æ˜¯æ˜ç¡®æŒ‡å®š\texttt{drop\ =\ FALSE}ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df1[, }\StringTok{"x"}\NormalTok{ , drop }\OtherTok{=} \ConstantTok{FALSE}\NormalTok{]}
\CommentTok{\#\textgreater{}   x}
\CommentTok{\#\textgreater{} 1 1}
\CommentTok{\#\textgreater{} 2 2}
\CommentTok{\#\textgreater{} 3 3}
\end{Highlighting}
\end{Shaded}

\subsection{dplyrç­‰æ•ˆå‡½æ•°}\label{dplyrux7b49ux6548ux51fdux6570}

æœ‰å‡ ä¸ªdplyrçš„å‡½æ•°æ˜¯ \texttt{{[}} çš„ç‰¹ä¾‹ï¼š

\begin{itemize}
\item
  \texttt{filter()}
  ç›¸å½“äºä½¿ç”¨ä¸€ä¸ªé€»è¾‘å‘é‡æ¥é€‰æ‹©è¡Œå­é›†ï¼ŒåŒæ—¶ç¡®ä¿æ’é™¤ç¼ºå¤±å€¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\ConstantTok{NA}\NormalTok{), }
  \AttributeTok{y =}\NormalTok{ letters[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{], }
  \AttributeTok{z =} \FunctionTok{runif}\NormalTok{(}\DecValTok{5}\NormalTok{)}
\NormalTok{)}
\NormalTok{df }\SpecialCharTok{|\textgreater{}} \FunctionTok{filter}\NormalTok{(x }\SpecialCharTok{\textgreater{}} \DecValTok{1}\NormalTok{)}

\CommentTok{\# same as}
\NormalTok{df[}\SpecialCharTok{!}\FunctionTok{is.na}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{x) }\SpecialCharTok{\&}\NormalTok{ df}\SpecialCharTok{$}\NormalTok{x }\SpecialCharTok{\textgreater{}} \DecValTok{1}\NormalTok{, ]}
\end{Highlighting}
\end{Shaded}

  åœ¨å®é™…åº”ç”¨ä¸­å¦ä¸€ç§å¸¸è§çš„æŠ€å·§æ˜¯ä½¿ç”¨\texttt{which()}å‡½æ•°ï¼Œå…¶æœ‰æ’é™¤ç¼ºå¤±å€¼çš„é™„å¸¦ä½œç”¨ï¼š\texttt{df{[}which(df\$x\ \textgreater{}\ 1),\ {]}}ã€‚
\item
  \texttt{arrange()}
  ç›¸å½“äºä½¿ç”¨æ•´æ•°å‘é‡æ¥é€‰æ‹©å­é›†è¡Œï¼Œè¿™ä¸ªæ•´æ•°å‘é‡é€šå¸¸æ˜¯é€šè¿‡\texttt{order()}å‡½æ•°åˆ›å»ºçš„ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} \FunctionTok{arrange}\NormalTok{(x, y)}

\CommentTok{\# same as}
\NormalTok{df[}\FunctionTok{order}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{x, df}\SpecialCharTok{$}\NormalTok{y), ]}
\end{Highlighting}
\end{Shaded}

  ä½ å¯ä»¥ä½¿ç”¨\texttt{order(decreasing\ =\ TRUE)}æ¥å°†æ‰€æœ‰åˆ—æŒ‰é™åºæ’åºï¼Œæˆ–è€…ä½¿ç”¨\texttt{-rank(col)}æ¥å•ç‹¬æŒ‰é™åºæ’åºæŸä¸€åˆ—ã€‚
\item
  \texttt{select()}å’Œ\texttt{relocate()}éƒ½ç±»ä¼¼äºä½¿ç”¨å­—ç¬¦å‘é‡æ¥é€‰æ‹©æˆ–é‡æ–°æ’åˆ—åˆ—

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} \FunctionTok{select}\NormalTok{(x, z)}

\CommentTok{\# same as}
\NormalTok{df[, }\FunctionTok{c}\NormalTok{(}\StringTok{"x"}\NormalTok{, }\StringTok{"z"}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}
\end{itemize}

åŸºç¡€Rè¿˜æä¾›äº†ä¸€ä¸ªå‡½æ•°\texttt{subset()}ï¼Œè¯¥å‡½æ•°ç»“åˆäº†\texttt{filter()}å’Œ\texttt{select()}\footnote{ä½†å®ƒä¸ä¼šä»¥ä¸åŒçš„æ–¹å¼å¤„ç†åˆ†ç»„æ•°æ®æ¡†ï¼Œå¹¶ä¸”å®ƒä¸æ”¯æŒå¦‚\texttt{starts\_with()}è¿™æ ·çš„é€‰æ‹©è¾…åŠ©å‡½æ•°ã€‚}çš„åŠŸèƒ½ï¼Œåä¸ºã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(x }\SpecialCharTok{\textgreater{}} \DecValTok{1}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{select}\NormalTok{(y, z)}
\CommentTok{\#\textgreater{} \# A tibble: 2 x 2}
\CommentTok{\#\textgreater{}   y           z}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}   \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 a     0.157  }
\CommentTok{\#\textgreater{} 2 b     0.00740}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# same as}
\NormalTok{df }\SpecialCharTok{|\textgreater{}} \FunctionTok{subset}\NormalTok{(x }\SpecialCharTok{\textgreater{}} \DecValTok{1}\NormalTok{, }\FunctionTok{c}\NormalTok{(y, z))}
\end{Highlighting}
\end{Shaded}

è¿™ä¸ªå‡½æ•°æ˜¯dplyrè¯­æ³•ä¸­è®¸å¤šéƒ¨åˆ†çš„çµæ„Ÿæ¥æºã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-64}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  åˆ›å»ºå‡½æ•°ï¼Œè¿™äº›å‡½æ•°ä»¥å‘é‡ä¸ºè¾“å…¥ï¼Œå¹¶è¿”å›:

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \tightlist
  \item
    å¶æ•°ä½ç½®ä¸Šçš„å…ƒç´ ï¼›
  \item
    é™¤äº†æœ€åä¸€ä¸ªå€¼ä»¥å¤–çš„æ‰€æœ‰å…ƒç´ ï¼›
  \item
    åªæœ‰å¶æ•° (ä¸”æ²¡æœ‰ç¼ºå¤±å€¼)ã€‚
  \end{enumerate}
\item
  ä¸ºä»€ä¹ˆ\texttt{x{[}-which(x\ \textgreater{}\ 0){]}}ä¸ç­‰åŒäº\texttt{x{[}x\ \textless{}=\ 0{]}}ï¼Ÿé˜…
  è¯»\texttt{which()}çš„æ–‡æ¡£å¹¶è¿›è¡Œä¸€äº›å®éªŒæ¥æ‰¾å‡ºåŸå› ã€‚
\end{enumerate}

\section{\texorpdfstring{ä½¿ç”¨\texttt{\$}å’Œ\texttt{{[}{[}}é€‰æ‹©å…ƒç´ }{ä½¿ç”¨\$å’Œ{[}{[}é€‰æ‹©å…ƒç´ }}\label{sec-subset-one}

\texttt{{[}}ç”¨äºé€‰æ‹©å¤šä¸ªå…ƒç´ ï¼Œå®ƒä¸\texttt{{[}{[}}å’Œ\texttt{\$}æ­é…ä½¿ç”¨ï¼Œåä¸¤è€…ç”¨äºæå–å•ä¸ªå…ƒç´ ã€‚åœ¨
æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ä½¿ç”¨\texttt{{[}{[}}å’Œ\texttt{\$}ä»æ•°æ®æ¡†ä¸­æå–åˆ—ï¼Œè®¨è®º\texttt{data.frames}å’Œtibbleä¹‹é—´çš„ä¸€äº›å…¶ä»–å·®å¼‚ï¼Œå¹¶å¼ºè°ƒå½“ä¸åˆ—è¡¨ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œ\texttt{{[}}å’Œ\texttt{{[}{[}}ä¹‹é—´çš„ä¸€äº›é‡è¦å·®å¼‚ã€‚

\subsection{æ•°æ®æ¡†}\label{ux6570ux636eux6846}

\texttt{{[}{[}}å’Œ\texttt{\$}å¯ç”¨äºä»æ•°æ®æ¡†ä¸­æå–åˆ—ã€‚\texttt{{[}}
\texttt{{[}}å¯ä»¥é€šè¿‡ä½ç½®æˆ–åç§°è¿›è¡Œè®¿é—®ï¼Œè€Œ\texttt{\$}ä¸“é—¨ç”¨äºé€šè¿‡åç§°è¿›è¡Œè®¿é—®ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tb }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}
  \AttributeTok{x =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{,}
  \AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\DecValTok{10}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{21}\NormalTok{)}
\NormalTok{)}

\CommentTok{\# by position}
\NormalTok{tb[[}\DecValTok{1}\NormalTok{]]}
\CommentTok{\#\textgreater{} [1] 1 2 3 4}

\CommentTok{\# by name}
\NormalTok{tb[[}\StringTok{"x"}\NormalTok{]]}
\CommentTok{\#\textgreater{} [1] 1 2 3 4}
\NormalTok{tb}\SpecialCharTok{$}\NormalTok{x}
\CommentTok{\#\textgreater{} [1] 1 2 3 4}
\end{Highlighting}
\end{Shaded}

å®ƒä»¬è¿˜å¯ä»¥ç”¨äºåˆ›å»ºæ–°åˆ—ï¼Œä¸R åŸºç¡€åŒ…ä¸­\texttt{mutate()}å‡½æ•°ç­‰ä»·ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tb}\SpecialCharTok{$}\NormalTok{z }\OtherTok{\textless{}{-}}\NormalTok{ tb}\SpecialCharTok{$}\NormalTok{x }\SpecialCharTok{+}\NormalTok{ tb}\SpecialCharTok{$}\NormalTok{y}
\NormalTok{tb}
\CommentTok{\#\textgreater{} \# A tibble: 4 x 3}
\CommentTok{\#\textgreater{}       x     y     z}
\CommentTok{\#\textgreater{}   \textless{}int\textgreater{} \textless{}dbl\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     1    10    11}
\CommentTok{\#\textgreater{} 2     2     4     6}
\CommentTok{\#\textgreater{} 3     3     1     4}
\CommentTok{\#\textgreater{} 4     4    21    25}
\end{Highlighting}
\end{Shaded}

é™¤äº†\texttt{transform()}ã€\texttt{with()}å’Œ\texttt{within()}ï¼Œè¿˜æœ‰å…¶ä»–å‡ ç§
R åŸºç¡€åŒ…ä¸­åˆ›å»ºæ–°åˆ—çš„æ–¹æ³•ã€‚H adley
åœ¨\url{https://gist.github.com/hadley/1986a273e384fb2d4d752c18ed71bedf}ä¸Šæ”¶é›†äº†ä¸€äº›ç¤ºä¾‹ã€‚

å½“è¿›è¡Œå¿«é€Ÿæ±‡æ€»æ—¶ï¼Œç›´æ¥ä½¿ç”¨\texttt{\$}ç¬¦å·æ˜¯å¾ˆæ–¹ä¾¿çš„ã€‚ä¾‹
å¦‚ï¼Œå¦‚æœä½ åªæƒ³æ‰¾åˆ°æœ€å¤§é’»çŸ³çš„å°ºå¯¸æˆ–è€…\texttt{cut}çš„å¯èƒ½å€¼ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰å¿…è¦ä½¿ç”¨\texttt{summarize()}å‡½æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{max}\NormalTok{(diamonds}\SpecialCharTok{$}\NormalTok{carat)}
\CommentTok{\#\textgreater{} [1] 5.01}

\FunctionTok{levels}\NormalTok{(diamonds}\SpecialCharTok{$}\NormalTok{cut)}
\CommentTok{\#\textgreater{} [1] "Fair"      "Good"      "Very Good" "Premium"   "Ideal"}
\end{Highlighting}
\end{Shaded}

\texttt{dplyr}ä¹Ÿæä¾›äº†ä¸€ä¸ªä¸\texttt{{[}{[}}æˆ–\texttt{\$}ç±»ä¼¼çš„ç­‰æ•ˆå‡½æ•°\texttt{pull()}ï¼Œè¿™åœ¨@sec-data-transform
æ²¡æœ‰æåˆ°ã€‚\texttt{p}
\texttt{ull()}æ¥æ”¶ä¸€ä¸ªå˜é‡åæˆ–å˜é‡ä½ç½®ï¼Œå¹¶ä»…è¿”å›è¯¥åˆ—ã€‚è¿™
æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç®¡é“æ“ä½œç¬¦æ¥é‡å†™ä¸Šé¢çš„ä»£ç ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} \FunctionTok{pull}\NormalTok{(carat) }\SpecialCharTok{|\textgreater{}} \FunctionTok{max}\NormalTok{()}
\CommentTok{\#\textgreater{} [1] 5.01}

\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} \FunctionTok{pull}\NormalTok{(cut) }\SpecialCharTok{|\textgreater{}} \FunctionTok{levels}\NormalTok{()}
\CommentTok{\#\textgreater{} [1] "Fair"      "Good"      "Very Good" "Premium"   "Ideal"}
\end{Highlighting}
\end{Shaded}

\subsection{Tibbles}\label{tibbles}

å½“æ¶‰åŠåˆ°\texttt{\$}æ—¶ï¼Œtibbleå’Œ\texttt{data.frame}ä¹‹é—´æœ‰å‡ ä¸ªé‡è¦åŒºåˆ«ã€‚æ•°
æ®æ¡†ä¼šåŒ¹é…ä»»ä½•å˜é‡åçš„å‰ç¼€ï¼ˆå³æ‰€è°“çš„éƒ¨åˆ†åŒ¹é…ï¼‰ï¼Œå¹¶ä¸”å¦‚æœæŸåˆ—ä¸å­˜åœ¨ä¹Ÿä¸ä¼šæŠ¥é”™ï¼š

There are a couple of important differences between tibbles and base
\texttt{data.frame}s when it comes to \texttt{\$}. Data frames match the
prefix of any variable names (so-called \textbf{partial matching}) and
don't complain if a column doesn't exist:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{x1 =} \DecValTok{1}\NormalTok{)}
\NormalTok{df}\SpecialCharTok{$}\NormalTok{x}
\CommentTok{\#\textgreater{} [1] 1}
\NormalTok{df}\SpecialCharTok{$}\NormalTok{z}
\CommentTok{\#\textgreater{} NULL}
\end{Highlighting}
\end{Shaded}

tibble
æ›´ä¸¥æ ¼ï¼šå®ƒåªç²¾ç¡®åŒ¹é…å˜é‡åï¼Œå¦‚æœè¯•å›¾è®¿é—®çš„åˆ—ä¸å­˜åœ¨ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªè­¦å‘Šï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tb }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{x1 =} \DecValTok{1}\NormalTok{)}

\NormalTok{tb}\SpecialCharTok{$}\NormalTok{x}
\CommentTok{\#\textgreater{} Warning: Unknown or uninitialised column: \textasciigrave{}x\textasciigrave{}.}
\CommentTok{\#\textgreater{} NULL}
\NormalTok{tb}\SpecialCharTok{$}\NormalTok{z}
\CommentTok{\#\textgreater{} Warning: Unknown or uninitialised column: \textasciigrave{}z\textasciigrave{}.}
\CommentTok{\#\textgreater{} NULL}
\end{Highlighting}
\end{Shaded}

å‡ºäºè¿™ä¸ªåŸå› ï¼Œæˆ‘ä»¬æœ‰æ—¶å¼€ç©ç¬‘è¯´ tibble
å¾ˆ``æ‡’æƒ°''å’Œ``æ˜“æ€’''ï¼šå®ƒä»¬åšçš„å°‘ä½†æŠ±æ€¨çš„å¤šã€‚

\subsection{åˆ—è¡¨}\label{ux5217ux8868-2}

\texttt{{[}{[}}å’Œ\texttt{\$}å¯¹äºå¤„ç†åˆ—è¡¨ä¹Ÿéå¸¸é‡è¦ï¼Œäº†è§£å®ƒä»¬ä¸\texttt{{[}}çš„åŒºåˆ«å¾ˆé‡è¦ã€‚è®©
æˆ‘ä»¬ç”¨ä¸€ä¸ªåä¸º\texttt{l}çš„åˆ—è¡¨ä¸¾ä¾‹è¯´æ˜è¿™äº›åŒºåˆ«ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{l }\OtherTok{\textless{}{-}} \FunctionTok{list}\NormalTok{(}
  \AttributeTok{a =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{, }
  \AttributeTok{b =} \StringTok{"a string"}\NormalTok{, }
  \AttributeTok{c =}\NormalTok{ pi, }
  \AttributeTok{d =} \FunctionTok{list}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{5}\NormalTok{)}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\item
  \texttt{{[}}ç”¨äºæå–å­åˆ—è¡¨ã€‚æ—  è®ºæå–å¤šå°‘ä¸ªå…ƒç´ ï¼Œç»“æœå§‹ç»ˆæ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(l[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{2}\NormalTok{])}
\CommentTok{\#\textgreater{} List of 2}
\CommentTok{\#\textgreater{}  $ a: int [1:3] 1 2 3}
\CommentTok{\#\textgreater{}  $ b: chr "a string"}

\FunctionTok{str}\NormalTok{(l[}\DecValTok{1}\NormalTok{])}
\CommentTok{\#\textgreater{} List of 1}
\CommentTok{\#\textgreater{}  $ a: int [1:3] 1 2 3}

\FunctionTok{str}\NormalTok{(l[}\DecValTok{4}\NormalTok{])}
\CommentTok{\#\textgreater{} List of 1}
\CommentTok{\#\textgreater{}  $ d:List of 2}
\CommentTok{\#\textgreater{}   ..$ : num {-}1}
\CommentTok{\#\textgreater{}   ..$ : num {-}5}
\end{Highlighting}
\end{Shaded}

  ä¸å‘é‡ä¸€æ ·ï¼Œä½ å¯ä»¥ä½¿ç”¨é€»è¾‘å‘é‡ã€æ•´æ•°å‘é‡æˆ–å­—ç¬¦å‘é‡æ¥è¿›è¡Œå­é›†é€‰æ‹©ã€‚
\item
  \texttt{{[}{[}}å’Œ\texttt{\$}ç”¨äºä»åˆ—è¡¨ä¸­æå–å•ä¸ªç»„ä»¶ã€‚å®ƒ
  ä»¬ä¼šä»åˆ—è¡¨ä¸­ç§»é™¤ä¸€å±‚å±‚æ¬¡ç»“æ„ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(l[[}\DecValTok{1}\NormalTok{]])}
\CommentTok{\#\textgreater{}  int [1:3] 1 2 3}

\FunctionTok{str}\NormalTok{(l[[}\DecValTok{4}\NormalTok{]])}
\CommentTok{\#\textgreater{} List of 2}
\CommentTok{\#\textgreater{}  $ : num {-}1}
\CommentTok{\#\textgreater{}  $ : num {-}5}

\FunctionTok{str}\NormalTok{(l}\SpecialCharTok{$}\NormalTok{a)}
\CommentTok{\#\textgreater{}  int [1:3] 1 2 3}
\end{Highlighting}
\end{Shaded}
\end{itemize}

\texttt{{[}}å’Œ\texttt{{[}{[}}ä¹‹é—´çš„åŒºåˆ«å¯¹äºåˆ—è¡¨æ¥è¯´ç‰¹åˆ«é‡è¦ï¼Œå› ä¸º\texttt{{[}{[}}ä¼šæ·±å…¥åˆ°åˆ—è¡¨ä¸­æå–å•ä¸ªå…ƒç´ ï¼Œè€Œ\texttt{{[}}åˆ™ä¼šè¿”å›ä¸€ä¸ªæ–°çš„ã€æ›´å°çš„åˆ—è¡¨ã€‚ä¸º
äº†å¸®åŠ©ä½ è®°ä½è¿™ä¸ªåŒºåˆ«ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹@fig-pepper ä¸­å±•ç¤ºçš„ä¸å¯»å¸¸çš„èƒ¡æ¤’ç“¶ã€‚å¦‚
æœè¿™ä¸ªèƒ¡æ¤’ç“¶ä»£è¡¨ä½ çš„åˆ—è¡¨èƒ¡æ¤’ç“¶ï¼Œé‚£ä¹ˆ\texttt{pepper{[}1{]}}å°±æ˜¯ä¸€ä¸ªåªåŒ…å«ä¸€åŒ…èƒ¡æ¤’çš„èƒ¡æ¤’ç“¶ã€‚\texttt{p}
\texttt{epper{[}2{]}}çœ‹èµ·æ¥ä¼šä¸€æ ·ï¼Œä½†ä¼šåŒ…å«ç¬¬äºŒåŒ…èƒ¡æ¤’ã€‚\texttt{p}
\texttt{epper{[}1:2{]}}åˆ™æ˜¯ä¸€ä¸ªåŒ…å«ä¸¤åŒ…èƒ¡æ¤’çš„èƒ¡æ¤’ç“¶ã€‚è€Œ
\texttt{pepper{[}{[}1{]}{]}}åˆ™ä¼šæå–å‡ºèƒ¡æ¤’åŒ…æœ¬èº«ã€‚

\begin{figure}

\centering{

\includegraphics[width=1\textwidth,height=\textheight]{diagrams/pepper.png}

}

\caption{\label{fig-pepper}(Left) A pepper shaker that Hadley once found
in his hotel room. (Middle) \texttt{pepper{[}1{]}}. (Right)
\texttt{pepper{[}{[}1{]}{]}}}

\end{figure}%

åŒæ ·çš„åŸåˆ™ä¹Ÿé€‚ç”¨äºæ•°æ®æ¡†ä½¿ç”¨ä¸€ç»´è¿ç®—ç¬¦\texttt{{[}}æ—¶ï¼š\texttt{df{[}"x"{]}}è¿”å›ä¸€ä¸ªå•åˆ—çš„æ•°æ®æ¡†ï¼Œè€Œ\texttt{df{[}{[}"x"{]}{]}}è¿”å›ä¸€ä¸ªå‘é‡ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-65}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  å½“ä½ ä½¿ç”¨\texttt{{[}{[}}è¿ç®—ç¬¦å’Œä¸€ä¸ªå¤§äºå‘é‡é•¿åº¦çš„æ­£æ•´æ•°æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿå½“
  ä½ ä½¿ç”¨ä¸å­˜åœ¨çš„åç§°è¿›è¡Œå­é›†é€‰æ‹©æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ
\item
  \texttt{pepper{[}{[}1{]}{]}{[}1{]}}ä¼šæ˜¯ä»€ä¹ˆï¼Ÿ\texttt{p}
  \texttt{epper{[}{[}1{]}{]}{[}{[}1{]}{]}}åˆæ˜¯ä»€ä¹ˆï¼Ÿ
\end{enumerate}

\section{applyå®¶æ—}\label{applyux5bb6ux65cf}

åœ¨ ç« èŠ‚~\ref{sec-iteration},
ä½ å­¦ä¹ äº†å¦‚\texttt{dplyr::across()}å’Œæ˜ å°„å®¶æ—ï¼ˆmap
familyï¼‰å‡½æ•°è¿™æ ·çš„tidyverseè¿­ä»£æŠ€æœ¯ã€‚åœ¨
è¿™ä¸€èŠ‚ä¸­ï¼Œä½ å°†å­¦ä¹ å®ƒä»¬çš„ç­‰æ•ˆå‡½æ•°ï¼Œå³åº”ç”¨å®¶æ—ï¼ˆapply familyï¼‰å‡½æ•°ã€‚åœ¨
è¿™ä¸ªå‰æä¸‹ï¼Œapplyå’Œmapæ˜¯åŒä¹‰è¯ï¼Œå› ä¸º``å°†å‡½æ•°æ˜ å°„åˆ°å‘é‡çš„æ¯ä¸ªå…ƒç´ ''çš„å¦ä¸€ç§è¯´æ³•å°±æ˜¯``å°†å‡½æ•°åº”ç”¨åˆ°å‘é‡çš„æ¯ä¸ªå…ƒç´ ''ã€‚åœ¨
è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä¸ºä½ å¿«é€Ÿæ¦‚è¿°è¿™ä¸ªå®¶æ—ï¼Œä»¥ä¾¿ä½ åœ¨å®é™…ä½¿ç”¨ä¸­è¯†åˆ«å®ƒä»¬ã€‚

è¿™ä¸ªå®¶æ—ä¸­æœ€é‡è¦çš„æˆå‘˜æ˜¯\texttt{lapply()}ï¼Œå®ƒä¸\texttt{purrr::map()}\footnote{å®ƒåªæ˜¯ç¼ºå°‘ä¸€äº›ä¾¿åˆ©çš„åŠŸèƒ½ï¼Œæ¯”å¦‚è¿›åº¦æ¡ï¼Œä»¥åŠåœ¨å‘ç”Ÿé”™è¯¯æ—¶æŠ¥å‘Šå“ªä¸ªå…ƒç´ å¯¼è‡´äº†é—®é¢˜ã€‚}éå¸¸ç›¸ä¼¼ã€‚
äº‹å®ä¸Šï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨\texttt{map()}çš„ä»»ä½•é«˜çº§åŠŸèƒ½ï¼Œæ‰€ä»¥ä½ å¯ä»¥å°†@sec-iteration
ä¸­çš„æ¯ä¸ª\texttt{map()}è°ƒç”¨æ›¿æ¢ä¸º\texttt{lapply()}ã€‚

åœ¨åŸºç¡€Rä¸­æ²¡æœ‰ä¸\texttt{across()}å®Œå…¨ç­‰æ•ˆçš„å‡½æ•°ï¼Œä½†ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨\texttt{lapply()}å’Œ\texttt{{[}}æ¥æ¥è¿‘è¿™ä¸ªæ•ˆæœã€‚è¿™
ç§æ“ä½œå¯è¡Œæ˜¯å› ä¸ºåœ¨åº•å±‚ï¼Œæ•°æ®æ¡†æ˜¯åˆ—çš„åˆ—è¡¨ï¼Œå› æ­¤å¯¹æ•°æ®æ¡†è°ƒç”¨\texttt{lapply()}ä¼šå°†å‡½æ•°åº”ç”¨åˆ°æ¯ä¸€åˆ—ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{a =} \DecValTok{1}\NormalTok{, }\AttributeTok{b =} \DecValTok{2}\NormalTok{, }\AttributeTok{c =} \StringTok{"a"}\NormalTok{, }\AttributeTok{d =} \StringTok{"b"}\NormalTok{, }\AttributeTok{e =} \DecValTok{4}\NormalTok{)}

\CommentTok{\# First find numeric columns}
\NormalTok{num\_cols }\OtherTok{\textless{}{-}} \FunctionTok{sapply}\NormalTok{(df, is.numeric)}
\NormalTok{num\_cols}
\CommentTok{\#\textgreater{}     a     b     c     d     e }
\CommentTok{\#\textgreater{}  TRUE  TRUE FALSE FALSE  TRUE}

\CommentTok{\# Then transform each column with lapply() then replace the original values}
\NormalTok{df[, num\_cols] }\OtherTok{\textless{}{-}} \FunctionTok{lapply}\NormalTok{(df[, num\_cols, }\AttributeTok{drop =} \ConstantTok{FALSE}\NormalTok{], \textbackslash{}(x) x }\SpecialCharTok{*} \DecValTok{2}\NormalTok{)}
\NormalTok{df}
\CommentTok{\#\textgreater{} \# A tibble: 1 x 5}
\CommentTok{\#\textgreater{}       a     b c     d         e}
\CommentTok{\#\textgreater{}   \textless{}dbl\textgreater{} \textless{}dbl\textgreater{} \textless{}chr\textgreater{} \textless{}chr\textgreater{} \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1     2     4 a     b         8}
\end{Highlighting}
\end{Shaded}

ä¸Šé¢çš„ä»£ç ä½¿ç”¨äº†ä¸€ä¸ªæ–°å‡½æ•°\texttt{sapply()}ã€‚å®ƒ
ä¸\texttt{lapply()}ç±»ä¼¼ï¼Œä½†å®ƒæ€»æ˜¯è¯•å›¾ç®€åŒ–ç»“æœï¼Œè¿™å°±æ˜¯å…¶åç§°ä¸­\texttt{s}çš„ç”±æ¥ï¼Œè¿™é‡Œå®ƒäº§ç”Ÿäº†ä¸€ä¸ªé€»è¾‘å‘é‡è€Œä¸æ˜¯åˆ—è¡¨ã€‚æˆ‘
ä»¬ä¸å»ºè®®åœ¨ç¼–ç¨‹ä¸­ä½¿ç”¨å®ƒï¼Œå› ä¸ºç®€åŒ–å¯èƒ½ä¼šå¤±è´¥å¹¶ç»™å‡ºæ„å¤–çš„ç±»å‹ï¼Œä½†åœ¨äº¤äº’å¼ä½¿ç”¨ä¸­é€šå¸¸æ²¡é—®é¢˜ã€‚\texttt{p}
\texttt{urrr}åŒ…ä¸­æœ‰ä¸€ä¸ªç±»ä¼¼çš„å‡½æ•°å«åš\texttt{map\_vec()}ï¼Œæˆ‘ä»¬åœ¨@sec-iteration
ä¸­æ²¡æœ‰æåˆ°å®ƒã€‚

åŸºç¡€Ræä¾›äº†ä¸€ä¸ªæ›´ä¸¥æ ¼çš„\texttt{sapply()}ç‰ˆæœ¬ï¼Œå«åš\texttt{vapply()}ï¼Œå³vector
applyçš„ç¼©å†™ã€‚å®ƒ
æ¥å—ä¸€ä¸ªé¢å¤–çš„å‚æ•°æ¥æŒ‡å®šé¢„æœŸçš„ç±»å‹ï¼Œç¡®ä¿æ— è®ºè¾“å…¥å¦‚ä½•ï¼Œç®€åŒ–æ€»æ˜¯ä»¥ç›¸åŒçš„æ–¹å¼è¿›è¡Œã€‚ä¾‹
å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¸Šé¢çš„\texttt{sapply()}è°ƒç”¨æ›¿æ¢ä¸º\texttt{vapply()}ï¼Œå…¶ä¸­æˆ‘ä»¬æŒ‡å®šæˆ‘ä»¬æœŸæœ›\texttt{is.numeric()}è¿”å›ä¸€ä¸ªé•¿åº¦ä¸º1çš„é€»è¾‘å‘é‡ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{vapply}\NormalTok{(df, is.numeric, }\FunctionTok{logical}\NormalTok{(}\DecValTok{1}\NormalTok{))}
\CommentTok{\#\textgreater{}     a     b     c     d     e }
\CommentTok{\#\textgreater{}  TRUE  TRUE FALSE FALSE  TRUE}
\end{Highlighting}
\end{Shaded}

å½“\texttt{sapply()}å’Œ\texttt{vapply()}åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨æ—¶ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«éå¸¸é‡è¦ï¼ˆå› ä¸ºè¿™å¯¹å‡½æ•°å¯¹ä¸å¯»å¸¸è¾“å…¥çš„é²æ£’æ€§æœ‰å¾ˆå¤§å½±å“ï¼‰ï¼Œä½†åœ¨æ•°æ®åˆ†æä¸­é€šå¸¸å¹¶ä¸é‡è¦ã€‚

applyå®¶æ—ä¸­çš„å¦ä¸€ä¸ªé‡è¦æˆå‘˜æ˜¯\texttt{tapply()}ï¼Œå®ƒç”¨äºè®¡ç®—å•ä¸ªåˆ†ç»„æ±‡æ€»ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{diamonds }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{group\_by}\NormalTok{(cut) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{price =} \FunctionTok{mean}\NormalTok{(price))}
\CommentTok{\#\textgreater{} \# A tibble: 5 x 2}
\CommentTok{\#\textgreater{}   cut       price}
\CommentTok{\#\textgreater{}   \textless{}ord\textgreater{}     \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 Fair      4359.}
\CommentTok{\#\textgreater{} 2 Good      3929.}
\CommentTok{\#\textgreater{} 3 Very Good 3982.}
\CommentTok{\#\textgreater{} 4 Premium   4584.}
\CommentTok{\#\textgreater{} 5 Ideal     3458.}

\FunctionTok{tapply}\NormalTok{(diamonds}\SpecialCharTok{$}\NormalTok{price, diamonds}\SpecialCharTok{$}\NormalTok{cut, mean)}
\CommentTok{\#\textgreater{}      Fair      Good Very Good   Premium     Ideal }
\CommentTok{\#\textgreater{}  4358.758  3928.864  3981.760  4584.258  3457.542}
\end{Highlighting}
\end{Shaded}

ä¸å¹¸çš„æ˜¯ï¼Œ\texttt{tapply()}å°†å…¶ç»“æœè¿”å›ä¸ºä¸€ä¸ªå‘½åå‘é‡ï¼Œå¦‚æœä½ æƒ³è¦å°†å¤šä¸ªæ±‡æ€»å’Œåˆ†ç»„å˜é‡æ”¶é›†åˆ°ä¸€ä¸ªæ•°æ®æ¡†ä¸­ï¼Œè¿™éœ€è¦è¿›è¡Œä¸€äº›å¤„ç†ï¼ˆå½“ç„¶ï¼Œä¸è¿™æ ·åšåªä½¿ç”¨ç‹¬ç«‹çš„å‘é‡è¿›è¡Œæ“ä½œä¹Ÿæ˜¯å¯èƒ½çš„ï¼Œä½†æ ¹æ®æˆ‘ä»¬çš„ç»éªŒï¼Œè¿™åªä¼šå»¶è¯¯å·¥ä½œï¼‰ã€‚å¦‚
æœä½ æƒ³çŸ¥é“å¦‚ä½•ä½¿ç”¨\texttt{tapply()}æˆ–å…¶ä»–åŸºç¡€æŠ€å·§æ¥æ‰§è¡Œå…¶ä»–åˆ†ç»„æ±‡æ€»ï¼ŒHadley
åœ¨
\href{https://gist.github.com/hadley/c430501804349d382ce90754936ab8ec}{in
a gist}ä¸­æ”¶é›†äº†ä¸€äº›æŠ€å·§ã€‚

åº”ç”¨å®¶æ—çš„æœ€åä¸€ä¸ªæˆå‘˜æ˜¯æ ‡é¢˜ä¸­çš„\texttt{apply()}ï¼Œå®ƒç”¨äºçŸ©é˜µå’Œæ•°ç»„ã€‚ç‰¹
åˆ«è¦æ³¨æ„\texttt{apply(df,\ 2,\ something)}ï¼Œè¿™æ˜¯ä½¿ç”¨\texttt{lapply(df,\ something)}çš„ä¸€ç§ç¼“æ…¢ä¸”å¯èƒ½å±é™©çš„æ–¹å¼ã€‚è¿™
åœ¨æ•°æ®ç§‘å­¦ä¸­å¾ˆå°‘å‡ºç°ï¼Œå› ä¸ºæˆ‘ä»¬é€šå¸¸ä½¿ç”¨æ•°æ®æ¡†è€Œä¸æ˜¯çŸ©é˜µã€‚

\section{\texorpdfstring{\texttt{for}
å¾ªç¯}{for å¾ªç¯}}\label{for-ux5faaux73af}

\texttt{for}å¾ªç¯æ˜¯è¿­ä»£çš„åŸºæœ¬æ¨¡å—ã€‚æ— 
è®ºæ˜¯\texttt{apply}å®¶æ—è¿˜æ˜¯\texttt{map}å®¶æ—ï¼Œåœ¨å†…éƒ¨éƒ½æ˜¯åŸºäº\texttt{for}å¾ªç¯æ¥å®ç°çš„ã€‚\texttt{f}
\texttt{or}å¾ªç¯æ˜¯å¼ºå¤§ä¸”é€šç”¨çš„å·¥å…·ï¼Œå¯¹äºæƒ³è¦æˆä¸ºæ›´æœ‰ç»éªŒçš„Rç¨‹åºå‘˜æ¥è¯´ï¼Œå­¦ä¹ å®ƒä»¬æ˜¯éå¸¸é‡è¦çš„ã€‚ä¸€
ä¸ª\texttt{for}å¾ªç¯çš„åŸºæœ¬ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (element }\ControlFlowTok{in}\NormalTok{ vector) \{}
  \CommentTok{\# do something with element}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\texttt{for}å¾ªç¯æœ€ç›´æ¥çš„ç”¨é€”æ˜¯å®ç°ä¸\texttt{walk()}ç›¸åŒçš„æ•ˆæœï¼šå¯¹åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨æŸä¸ªå¸¦æœ‰å‰¯ä½œç”¨çš„å‡½æ•°ã€‚ä¾‹
å¦‚åœ¨@sec-save-database ä¸­ä¸ä½¿ç”¨\texttt{walk()}å‡½æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{paths }\SpecialCharTok{|\textgreater{}} \FunctionTok{walk}\NormalTok{(append\_file)}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ \texttt{for} å¾ªç¯:

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (path }\ControlFlowTok{in}\NormalTok{ paths) \{}
  \FunctionTok{append\_file}\NormalTok{(path)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ æƒ³ä¿å­˜\texttt{for}å¾ªç¯çš„è¾“å‡ºï¼Œäº‹æƒ…ä¼šå˜å¾—ç¨å¾®å¤æ‚ä¸€äº›ï¼Œæ¯”å¦‚åƒæˆ‘ä»¬åœ¨@sec-iteration
æ‰€åšçš„é‚£æ ·ï¼Œè¯»å–ä¸€ä¸ªç›®å½•ä¸­æ‰€æœ‰çš„Excelæ–‡ä»¶ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{paths }\OtherTok{\textless{}{-}} \FunctionTok{dir}\NormalTok{(}\StringTok{"data/gapminder"}\NormalTok{, }\AttributeTok{pattern =} \StringTok{"}\SpecialCharTok{\textbackslash{}\textbackslash{}}\StringTok{.xlsx$"}\NormalTok{, }\AttributeTok{full.names =} \ConstantTok{TRUE}\NormalTok{)}
\NormalTok{files }\OtherTok{\textless{}{-}} \FunctionTok{map}\NormalTok{(paths, readxl}\SpecialCharTok{::}\NormalTok{read\_excel)}
\end{Highlighting}
\end{Shaded}

ä½ å¯ä»¥ä½¿ç”¨å‡ ç§ä¸åŒçš„æŠ€å·§ï¼Œä½†æˆ‘ä»¬å»ºè®®ä¸€å¼€å§‹å°±æ˜ç¡®è¾“å‡ºå°†æ˜¯ä»€ä¹ˆæ ·çš„ã€‚åœ¨
è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æƒ³è¦ä¸€ä¸ªä¸è·¯å¾„åˆ—è¡¨é•¿åº¦ç›¸åŒçš„åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨\texttt{vector()}å‡½æ•°æ¥åˆ›å»ºå®ƒã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{files }\OtherTok{\textless{}{-}} \FunctionTok{vector}\NormalTok{(}\StringTok{"list"}\NormalTok{, }\FunctionTok{length}\NormalTok{(paths))}
\end{Highlighting}
\end{Shaded}

ç„¶åï¼Œæˆ‘ä»¬å°†ä¸å†ç›´æ¥è¿­ä»£\texttt{paths}çš„å…ƒç´ ï¼Œè€Œæ˜¯è¿­ä»£å®ƒä»¬çš„ç´¢å¼•ï¼Œä½¿ç”¨\texttt{seq\_along()}å‡½æ•°ä¸ºæ¯ä¸ª\texttt{paths}çš„å…ƒç´ ç”Ÿæˆä¸€ä¸ªç´¢å¼•ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{seq\_along}\NormalTok{(paths)}
\CommentTok{\#\textgreater{}  [1]  1  2  3  4  5  6  7  8  9 10 11 12}
\end{Highlighting}
\end{Shaded}

ä½¿ç”¨ç´¢å¼•å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒå…è®¸æˆ‘ä»¬å°†è¾“å…¥ä¸­çš„æ¯ä¸ªä½ç½®ä¸è¾“å‡ºä¸­çš„ç›¸åº”ä½ç½®é“¾æ¥èµ·æ¥:

\begin{Shaded}
\begin{Highlighting}[]
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \FunctionTok{seq\_along}\NormalTok{(paths)) \{}
\NormalTok{  files[[i]] }\OtherTok{\textless{}{-}}\NormalTok{ readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(paths[[i]])}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

è¦å°†å¤šä¸ªtibbleåˆ—è¡¨åˆå¹¶æˆä¸€ä¸ªå•ä¸€çš„tibbleï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{do.call()}+\texttt{rbind()}å‡½æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{do.call}\NormalTok{(rbind, files)}
\CommentTok{\#\textgreater{} \# A tibble: 1,704 x 5}
\CommentTok{\#\textgreater{}   country     continent lifeExp      pop gdpPercap}
\CommentTok{\#\textgreater{}   \textless{}chr\textgreater{}       \textless{}chr\textgreater{}       \textless{}dbl\textgreater{}    \textless{}dbl\textgreater{}     \textless{}dbl\textgreater{}}
\CommentTok{\#\textgreater{} 1 Afghanistan Asia         28.8  8425333      779.}
\CommentTok{\#\textgreater{} 2 Albania     Europe       55.2  1282697     1601.}
\CommentTok{\#\textgreater{} 3 Algeria     Africa       43.1  9279525     2449.}
\CommentTok{\#\textgreater{} 4 Angola      Africa       30.0  4232095     3521.}
\CommentTok{\#\textgreater{} 5 Argentina   Americas     62.5 17876956     5911.}
\CommentTok{\#\textgreater{} 6 Australia   Oceania      69.1  8691212    10040.}
\CommentTok{\#\textgreater{} \# i 1,698 more rows}
\end{Highlighting}
\end{Shaded}

ä¸å…¶åœ¨éå†è¿‡ç¨‹ä¸­åˆ›å»ºä¸€ä¸ªåˆ—è¡¨å¹¶ä¿å­˜ç»“æœï¼Œä¸€ä¸ªæ›´ç®€å•çš„æ–¹æ³•æ˜¯é€æ­¥æ„å»ºæ•°æ®æ¡†ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{out }\OtherTok{\textless{}{-}} \ConstantTok{NULL}
\ControlFlowTok{for}\NormalTok{ (path }\ControlFlowTok{in}\NormalTok{ paths) \{}
\NormalTok{  out }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(out, readxl}\SpecialCharTok{::}\FunctionTok{read\_excel}\NormalTok{(path))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

æˆ‘ä»¬æ¨èé¿å…è¿™ç§æ¨¡å¼ï¼Œå› ä¸ºå½“å‘é‡å¾ˆé•¿æ—¶å®ƒå¯èƒ½ä¼šå˜å¾—éå¸¸æ…¢ï¼Œè¿™å°±æ˜¯forå¾ªç¯å¾ˆæ…¢è¿™ç§è¯¯è§£æŒç»­å­˜åœ¨çš„æ¥æºã€‚å®
é™…ä¸Šforå¾ªç¯æœ¬èº«å¹¶ä¸æ…¢ï¼Œä½†è¿­ä»£åœ°å¢é•¿å‘é‡å´å¾ˆæ…¢ã€‚

\section{ç»˜å›¾}\label{ux7ed8ux56fe}

è®¸å¤šä¸ä½¿ç”¨tidyverseçš„Rç”¨æˆ·æ›´å–œæ¬¢ä½¿ç”¨ggplot2è¿›è¡Œç»˜å›¾ï¼Œå› ä¸ºå®ƒæœ‰ä¸€äº›æœ‰ç”¨çš„ç‰¹æ€§ï¼Œå¦‚åˆç†çš„é»˜è®¤å€¼ã€è‡ªåŠ¨å›¾ä¾‹å’Œç°ä»£å¤–è§‚ã€‚ç„¶
è€Œï¼ŒåŸºç¡€Rç»˜å›¾å‡½æ•°ä»ç„¶å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬éå¸¸ç®€æ´ï¼Œåªéœ€è¾“å…¥å¾ˆå°‘çš„ä»£ç å°±å¯ä»¥è¿›è¡ŒåŸºæœ¬çš„æ¢ç´¢æ€§ç»˜å›¾ã€‚

ä½ åœ¨å®é™…ä½¿ç”¨ä¸­ä¼šé‡åˆ°ä¸¤ç§ä¸»è¦çš„åŸºç¡€ç»˜å›¾ç±»å‹ï¼šæ•£ç‚¹å›¾å’Œç›´æ–¹å›¾ï¼Œå®ƒä»¬åˆ†åˆ«ä½¿ç”¨\texttt{plot()}å’Œ\texttt{hist()}å‡½æ•°ç”Ÿæˆã€‚ä¸‹
é¢æ˜¯ä¸€ä¸ªæ¥è‡ª\texttt{diamonds}æ•°æ®é›†çš„å¿«é€Ÿç¤ºä¾‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Left}
\FunctionTok{hist}\NormalTok{(diamonds}\SpecialCharTok{$}\NormalTok{carat)}

\CommentTok{\# Right}
\FunctionTok{plot}\NormalTok{(diamonds}\SpecialCharTok{$}\NormalTok{carat, diamonds}\SpecialCharTok{$}\NormalTok{price)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{base-R_files/figure-pdf/unnamed-chunk-38-1.png}\end{minipage}%
%
\begin{minipage}{0.50\linewidth}
\includegraphics[width=12.5in,height=\textheight]{base-R_files/figure-pdf/unnamed-chunk-38-2.png}\end{minipage}%

\end{figure}%

æ³¨æ„ï¼ŒåŸºæœ¬ç»˜å›¾å‡½æ•°ä¸å‘é‡ä¸€èµ·å·¥ä½œï¼Œå› æ­¤éœ€è¦ä½¿ç”¨\texttt{\$}æˆ–å…¶ä»–æŠ€å·§å°†åˆ—ä»æ•°æ®æ¡†æ¶ä¸­æå–å‡ºæ¥ã€‚

\section{å°ç»“}\label{ux5c0fux7ed3-26}

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å‘ä½ å±•ç¤ºäº†ä¸€äº›ç”¨äºå­é›†é€‰æ‹©å’Œè¿­ä»£çš„åŸºç¡€Rå‡½æ•°ã€‚ä¸
æœ¬ä¹¦ä¸­å…¶ä»–åœ°æ–¹è®¨è®ºçš„æ–¹æ³•ç›¸æ¯”ï¼Œè¿™äº›å‡½æ•°å¾€å¾€å…·æœ‰æ›´å¤šçš„``å‘é‡''é£å‘³è€Œä¸æ˜¯``æ•°æ®æ¡†''é£å‘³ï¼Œå› ä¸ºåŸºç¡€Rå‡½æ•°å€¾å‘äºæ¥å—å•ç‹¬çš„å‘é‡ï¼Œè€Œä¸æ˜¯æ•°æ®æ¡†å’ŒæŸäº›åˆ—è§„èŒƒã€‚è¿™
é€šå¸¸ä½¿ç¼–ç¨‹å˜å¾—æ›´å®¹æ˜“ï¼Œå› æ­¤å½“ä½ ç¼–å†™æ›´å¤šå‡½æ•°å¹¶å¼€å§‹ç¼–å†™è‡ªå·±çš„åŒ…æ—¶ï¼Œå®ƒå˜å¾—æ›´åŠ é‡è¦ã€‚

æœ¬ç« æ ‡å¿—ç€æœ¬ä¹¦ç¼–ç¨‹éƒ¨åˆ†çš„ç»“æŸã€‚ä½ 
åœ¨æˆä¸ºä¸ä»…æ˜¯ä½¿ç”¨Rçš„æ•°æ®ç§‘å­¦å®¶ï¼Œè€Œä¸”æ˜¯èƒ½å¤Ÿç”¨Rç¼–ç¨‹çš„æ•°æ®ç§‘å­¦å®¶çš„é“è·¯ä¸Šè¿ˆå‡ºäº†åšå®çš„ä¸€æ­¥ã€‚æˆ‘
ä»¬å¸Œæœ›è¿™äº›ç« èŠ‚å·²ç»æ¿€å‘äº†å¯¹ä½ ç¼–ç¨‹çš„å…´è¶£ï¼Œå¹¶æœŸå¾…ä½ åœ¨è¿™æœ¬ä¹¦ä¹‹å¤–å­¦ä¹ æ›´å¤šçŸ¥è¯†ã€‚

\part{äº¤æµ}

åˆ°ç›®å‰ä¸ºæ­¢ä½ å·²ç»å­¦ä¹ äº†å°†æ•°æ®å¯¼å…¥Rçš„å·¥å…·ï¼Œå°†æ•°æ®æ•´ç†æˆä¾¿äºåˆ†æçš„å½¢å¼ï¼Œç„¶åé€šè¿‡è½¬æ¢å’Œå¯è§†åŒ–æ¥ç†è§£æ•°æ®ã€‚ä½†
æ˜¯ï¼Œé™¤éä½ èƒ½å¤Ÿå‘å…¶ä»–äººè§£é‡Šä½ çš„åˆ†æï¼Œå¦åˆ™æ— è®ºä½ çš„åˆ†æå¤šä¹ˆå‡ºè‰²éƒ½æ²¡æœ‰æ„ä¹‰ï¼šä½ éœ€è¦äº¤æµä½ çš„ç»“æœã€‚

\begin{figure}

\centering{

\includegraphics[width=5.57in,height=\textheight]{diagrams/data-science/communicate.png}

}

\caption{\label{fig-ds-communicate}Communication is the final part of
the data science process; if you can't communicate your results to other
humans, it doesn't matter how great your analysis is.}

\end{figure}%

æ¥ä¸‹æ¥çš„ä¸¤ç« ä¸»é¢˜æ˜¯äº¤æµï¼š

\begin{itemize}
\item
  åœ¨@sec-quarto
  ä¸­ï¼Œä½ å°†äº†è§£Quartoï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºæ•´åˆæ–‡å­—ã€ä»£ç å’Œç»“æœçš„å·¥å…·ã€‚ä½ 
  å¯ä»¥ä½¿ç”¨Quartoè¿›è¡Œåˆ†æå¸ˆä¹‹é—´çš„äº¤æµï¼Œä»¥åŠåˆ†æå¸ˆä¸å†³ç­–è€…ä¹‹é—´çš„äº¤æµã€‚å¾—
  ç›ŠäºQuartoæ ¼å¼çš„å¼ºå¤§åŠŸèƒ½ï¼Œä½ ç”šè‡³å¯ä»¥ä½¿ç”¨åŒä¸€ä»½æ–‡æ¡£æ¥å®Œæˆè¿™ä¸¤ä¸ªç›®çš„ã€‚
\item
  åœ¨ ç« èŠ‚~\ref{sec-quarto-formats} ä¸­,
  ä½ å°†äº†è§£ä½¿ç”¨Quartoå¯ä»¥ç”Ÿæˆçš„å…¶ä»–è®¸å¤šä¸åŒç§ç±»çš„è¾“å‡ºï¼ŒåŒ…æ‹¬ä»ªè¡¨æ¿ã€ç½‘ç«™å’Œä¹¦ç±ã€‚
\end{itemize}

è¿™äº›ç« èŠ‚ä¸»è¦å…³æ³¨äº¤æµçš„æŠ€æœ¯æœºåˆ¶ï¼Œè€Œä¸æ˜¯å°†ä½ çš„æƒ³æ³•ä¼ è¾¾ç»™å…¶ä»–äººçš„çœŸæ­£éš¾é¢˜ã€‚ç„¶
è€Œï¼Œå…³äºäº¤æµçš„å…¶ä»–å¾ˆå¤šå¥½ä¹¦ï¼Œæˆ‘ä»¬å°†åœ¨æ¯ç« ç»“å°¾å¤„å‘ä½ æ¨èã€‚

\chapter{Quarto}\label{sec-quarto}

\section{å¼•è¨€}\label{ux5f15ux8a00-23}

Quarto ä¸ºæ•°æ®ç§‘å­¦æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„åˆ›ä½œæ¡†æ¶ï¼Œç»“åˆäº†ä½ çš„ä»£ç ã€ç»“æœå’Œæ–‡å­—ã€‚Q
uarto æ–‡æ¡£å®Œå…¨å¯é‡ç°ï¼Œå¹¶æ”¯æŒæ•°åç§è¾“å‡ºæ ¼å¼ï¼Œå¦‚ PDFã€Word
æ–‡ä»¶å’Œæ¼”ç¤ºæ–‡ç¨¿ç­‰ã€‚

Quarto æ–‡ä»¶è®¾è®¡æœ‰ä¸‰ç§ç”¨é€”ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ä¸å†³ç­–è€…äº¤æµï¼Œä»–ä»¬å¸Œæœ›å…³æ³¨ç»“è®ºï¼Œè€Œä¸æ˜¯åˆ†æèƒŒåçš„ä»£ç ï¼›
\item
  ä¸å…¶ä»–æ•°æ®ç§‘å­¦å®¶ï¼ˆåŒ…æ‹¬æœªæ¥çš„ä½ ï¼ï¼‰åˆä½œï¼Œä»–ä»¬æ—¢å¯¹ä½ çš„ç»“è®ºæ„Ÿå…´è¶£ï¼Œä¹Ÿå¯¹ä½ å¦‚ä½•å¾—å‡ºè¿™äº›ç»“è®ºï¼ˆå³ä»£ç ï¼‰æ„Ÿå…´è¶£ï¼›
\item
  ä½œä¸ºå¼€å±•æ•°æ®ç§‘å­¦çš„ç¯å¢ƒï¼Œä½œä¸ºç°ä»£å®éªŒå®¤çš„ç¬”è®°æœ¬ï¼Œä½ ä¸ä»…å¯ä»¥è®°å½•ä½ åšäº†ä»€ä¹ˆï¼Œè¿˜å¯ä»¥è®°å½•ä½ å½“æ—¶çš„æƒ³æ³•ã€‚
\end{enumerate}

Quarto æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œç•Œé¢å·¥å…·ï¼Œè€Œä¸æ˜¯ R åŒ…ã€‚è¿™ æ„å‘³ç€é€šå¸¸æ— æ³•é€šè¿‡
\texttt{?} æ¥è·å–å¸®åŠ©ã€‚ç›¸ åï¼Œå½“ä½ é˜…è¯»æœ¬ç« å†…å®¹å¹¶åœ¨å°†æ¥ä½¿ç”¨ Quarto
æ—¶ï¼Œæ‚¨åº”è¯¥å‚è€ƒ\href{https://quarto.org}{Quartoæ–‡æ¡£}ã€‚

å¦‚æœä½ æ˜¯ R Markdown ç”¨æˆ·ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—Quartoå¬èµ·æ¥å¾ˆåƒ R Markdownã€‚æ²¡
é”™ï¼Q uarto å°† R Markdown ç”Ÿæ€ç³»ç»Ÿä¸­è®¸å¤šåŒ…ï¼ˆå¦‚
rmarkdownã€bookdownã€distillã€xaringan
ç­‰ï¼‰çš„åŠŸèƒ½ç»Ÿä¸€åˆ°ä¸€ä¸ªä¸€è‡´çš„ç³»ç»Ÿä¸­ï¼Œå¹¶é€šè¿‡åŸç”Ÿæ”¯æŒ Pythonã€Julia
ç­‰å¤šç§ç¼–ç¨‹è¯­è¨€ï¼ˆåŒ…æ‹¬Rï¼‰æ¥æ‰©å±•å…¶åŠŸèƒ½ã€‚åœ¨ æŸç§ç¨‹åº¦ä¸Šï¼ŒQuarto
åæ˜ äº†è¿‡å»åå¤šå¹´æ¥æ‰©å±•å’Œæ”¯æŒ R Markdown ç”Ÿæ€ç³»ç»Ÿçš„æ‰€æœ‰ç»éªŒã€‚

\subsection{å¿…è¦æ¡ä»¶}\label{ux5fc5ux8981ux6761ux4ef6-24}

ä½ éœ€è¦ä½¿ç”¨ Quarto å‘½ä»¤è¡Œç•Œé¢ï¼ˆQuarto
CLIï¼‰ï¼Œä½†ä½ ä¸éœ€è¦æ˜¾å¼åœ°å®‰è£…æˆ–åŠ è½½å®ƒï¼Œå› ä¸ºå½“éœ€è¦æ—¶RStudio
ä¼šè‡ªåŠ¨å®Œæˆè¿™ä¸¤é¡¹æ“ä½œã€‚

You need the Quarto command line interface (Quarto CLI), but you don't
need to explicitly install it or load it, as RStudio automatically does
both when needed.

\section{Quarto åŸºç¡€}\label{quarto-ux57faux7840}

ä¸‹é¢æ˜¯ä¸€ä¸ªQuartoæ–‡ä»¶ï¼Œä¸€ä¸ªæ‰©å±•åä¸º\texttt{.qmd}çš„çº¯æ–‡æœ¬æ–‡ä»¶:

\begin{verbatim}
---
title: "Diamond sizes"
date: 2022-09-12
format: html
---

```{r}
#| label: setup
#| include: false

library(tidyverse)

smaller <- diamonds |> 
  filter(carat <= 2.5)
```

We have data about `r nrow(diamonds)` diamonds.
Only `r nrow(diamonds) - nrow(smaller)` are larger than 2.5 carats.
The distribution of the remainder is shown below:

```{r}
#| label: plot-smaller-diamonds
#| echo: false

smaller |> 
  ggplot(aes(x = carat)) + 
  geom_freqpoly(binwidth = 0.01)
```
\end{verbatim}

å®ƒåŒ…å«ä¸‰ç§é‡è¦ç±»å‹çš„å†…å®¹:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  ç”¨\texttt{-\/-\/-}åŒ…å›´çš„\textbf{YAML}å¤´éƒ¨ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰ï¼›
\item
  ç”¨
  \texttt{\textasciigrave{}\textasciigrave{}\textasciigrave{}}åŒ…å›´çš„\textbf{Rä»£ç å—}ï¼›
\item
  ä¸ç®€å•æ–‡æœ¬æ ¼å¼ï¼ˆå¦‚\texttt{\#\ heading}~å’Œ~\texttt{\_italics\_}ï¼‰æ··åˆçš„æ–‡æœ¬ã€‚
\end{enumerate}

å›¾~\ref{fig-diamond-sizes-notebook} å±•ç¤ºäº†åœ¨ RStudio ç¬”è®°æœ¬ç•Œé¢ä¸­çš„
\texttt{.qmd} æ–‡æ¡£ï¼Œå…¶ä¸­ä»£ç å’Œè¾“å‡ºäº¤é”™æ˜¾ç¤ºã€‚ä½ 
å¯ä»¥é€šè¿‡ç‚¹å‡»è¿è¡Œå›¾æ ‡ï¼ˆå®ƒä½äºä»£ç å—é¡¶éƒ¨çš„ä½ç½®ï¼Œçœ‹èµ·æ¥åƒä¸€ä¸ªæ’­æ”¾æŒ‰é’®ï¼‰æ¥è¿è¡Œæ¯ä¸ªä»£ç å—ï¼Œæˆ–è€…é€šè¿‡æŒ‰ä¸‹
Cmd/Ctrl + Shift + Enter æ¥è¿è¡Œã€‚R Studio
æ‰§è¡Œä»£ç ï¼Œå¹¶å°†ç»“æœæ˜¾ç¤ºåœ¨ä»£ç æ—è¾¹ã€‚

\begin{figure}

\centering{

\includegraphics[width=0.9\textwidth,height=\textheight]{quarto/diamond-sizes-notebook.png}

}

\caption{\label{fig-diamond-sizes-notebook}A Quarto document in RStudio.
Code and output interleaved in the document, with the plot output
appearing right underneath the code.}

\end{figure}%

å¦‚æœä½ ä¸å–œæ¬¢åœ¨æ–‡æ¡£ä¸­çœ‹åˆ°å›¾è¡¨å’Œè¾“å‡ºï¼Œè€Œæ˜¯æ›´æƒ³ä½¿ç”¨ RStudio
çš„``æ§åˆ¶å°''å’Œ``ç»˜å›¾''é¢æ¿ï¼Œä½ å¯ä»¥ç‚¹å‡»''Render''
æ—è¾¹çš„é½¿è½®å›¾æ ‡ï¼Œå¹¶åˆ‡æ¢åˆ°''Chunk Output in Console''ï¼Œå¦‚
å›¾~\ref{fig-diamond-sizes-console-output} æ‰€ç¤ºã€‚

\begin{figure}

\centering{

\includegraphics[width=0.9\textwidth,height=\textheight]{quarto/diamond-sizes-console-output.png}

}

\caption{\label{fig-diamond-sizes-console-output}A Quarto document in
RStudio with the plot output in the Plots pane.}

\end{figure}%

è¦ç”Ÿæˆä¸€ä¸ªåŒ…å«æ‰€æœ‰æ–‡æœ¬ã€ä»£ç å’Œç»“æœçš„å®Œæ•´æŠ¥å‘Šï¼Œè¯·ç‚¹å‡»``Render''æˆ–æŒ‰ä¸‹
Cmd/Ctrl + Shift + Kã€‚ä½ 
ä¹Ÿå¯ä»¥é€šè¿‡ç¼–ç¨‹æ–¹å¼ä½¿ç”¨\texttt{quarto::quarto\_render("diamond-sizes.qmd")}æ¥å®Œæˆè¿™ä¸€æ“ä½œã€‚è¿™
å°†åœ¨æŸ¥çœ‹å™¨é¢æ¿ä¸­æ˜¾ç¤ºæŠ¥å‘Šï¼Œå¦‚å›¾@fig-diamond-sizes-report
æ‰€ç¤ºï¼Œå¹¶åˆ›å»ºä¸€ä¸ªHTMLæ–‡ä»¶ã€‚

\begin{figure}

\centering{

\includegraphics[width=0.9\textwidth,height=\textheight]{quarto/diamond-sizes-report.png}

}

\caption{\label{fig-diamond-sizes-report}A Quarto document in RStudio
with the rendered document in the Viewer pane.}

\end{figure}%

å½“ä½ æ¸²æŸ“ï¼ˆrenderï¼‰æ–‡æ¡£æ—¶ï¼ŒQuarto å°†\texttt{.qmd}æ–‡ä»¶å‘é€ç»™
\textbf{knitr}ï¼ˆ\href{https://yihui.org/knitr/\%EF\%BC\%89\%EF\%BC\%8Cknitr}{https://yihui.org/knitr/}ï¼‰\textbf{ï¼Œ}knitræ‰§è¡Œæ‰€æœ‰çš„ä»£ç å—å¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„
markdownï¼ˆ\texttt{.md}ï¼‰æ–‡æ¡£ï¼Œè¿™ä¸ªæ–‡æ¡£åŒ…å«äº†ä»£ç åŠå…¶è¾“å‡ºã€‚éš åï¼Œç”±
knitr ç”Ÿæˆçš„ markdown æ–‡ä»¶ä¼šè¢«
pandocï¼ˆ\href{https://pandoc.xn--org}{https://pandoc.org}ï¼‰å¤„ç†ï¼Œpandocè´Ÿè´£åˆ›å»ºæœ€ç»ˆçš„æ–‡ä»¶ã€‚è¿™
ä¸ªè¿‡ç¨‹åœ¨ å›¾~\ref{fig-quarto-flow} ä¸­æœ‰å±•ç¤ºã€‚è¿™
ç§ä¸¤æ­¥å·¥ä½œæµç¨‹çš„ä¼˜åŠ¿åœ¨äºå¯ä»¥åˆ›å»ºéå¸¸å¹¿æ³›çš„è¾“å‡ºæ ¼å¼ï¼Œè¿™å°†åœ¨@sec-quarto-formats
ä¸­å­¦ä¹ ã€‚

\begin{figure}

\centering{

\includegraphics[width=0.75\textwidth,height=\textheight]{images/quarto-flow.png}

}

\caption{\label{fig-quarto-flow}Diagram of Quarto workflow from qmd, to
knitr, to md, to pandoc, to output in PDF, MS Word, or HTML formats.}

\end{figure}%

è¦å¼€å§‹ä½¿ç”¨ä½ è‡ªå·±çš„\texttt{.qmd}æ–‡ä»¶ï¼Œè¯·åœ¨èœå•æ ä¸­é€‰æ‹©\emph{File
\textgreater{} New File \textgreater{} Quarto Document\ldots{}}ã€‚R
Studio
å°†å¯åŠ¨ä¸€ä¸ªå‘å¯¼ï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥é¢„å…ˆå¡«å……ä½ çš„æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä¸€äº›æœ‰ç”¨çš„å†…å®¹ï¼Œä»¥æé†’ä½ 
Quarto çš„å…³é”®åŠŸèƒ½æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

ä»¥ä¸‹éƒ¨åˆ†å°†æ›´è¯¦ç»†åœ°ä»‹ç» Quarto æ–‡æ¡£çš„ä¸‰ä¸ªç»„æˆéƒ¨åˆ†ï¼šmarkdown
æ–‡æœ¬ã€ä»£ç å—å’Œ YAML å¤´éƒ¨ä¿¡æ¯ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-66}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  ä½¿ç”¨\emph{File \textgreater{} New File \textgreater{} Quarto
  Document}æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ Quarto æ–‡æ¡£ã€‚é˜… è¯»è¯´æ˜ã€‚ç»ƒ
  ä¹ å•ç‹¬è¿è¡Œå„ä¸ªä»£ç å—ã€‚ç„¶
  åç‚¹å‡»é€‚å½“çš„æŒ‰é’®æˆ–ä½¿ç”¨ç›¸åº”çš„é”®ç›˜å¿«æ·é”®æ¥æ¸²æŸ“æ–‡æ¡£ã€‚éªŒ
  è¯ä½ æ˜¯å¦å¯ä»¥ä¿®æ”¹ä»£ç ï¼Œé‡æ–°è¿è¡Œå®ƒï¼Œå¹¶æŸ¥çœ‹ä¿®æ”¹åçš„è¾“å‡ºï¼›
\item
  ä¸ºä¸‰ç§å†…ç½®æ ¼å¼ï¼ˆHTMLã€PDF å’Œ Wordï¼‰ä¸­çš„æ¯ä¸€ç§åˆ›å»ºä¸€ä¸ªæ–°çš„ Quarto
  æ–‡æ¡£ã€‚æ¸² æŸ“è¿™ä¸‰ä¸ªæ–‡æ¡£ã€‚è¾“ å‡ºçš„å†…å®¹æœ‰ä»€ä¹ˆä¸åŒï¼Ÿè¾“
  å…¥çš„å†…å®¹æœ‰ä»€ä¹ˆä¸åŒï¼Ÿï¼ˆ å¦‚æœéœ€è¦æ„å»º PDF è¾“å‡ºï¼Œä½ å¯èƒ½éœ€è¦å®‰è£… LaTeX ---
  å¦‚æœéœ€è¦ï¼ŒRStudio ä¼šæç¤ºä½ ã€‚ï¼‰
\end{enumerate}

\section{å¯è§†åŒ–ç¼–è¾‘å™¨}\label{ux53efux89c6ux5316ux7f16ux8f91ux5668}

RStudio ä¸­çš„å¯è§†åŒ–ç¼–è¾‘å™¨ä¸º Quarto
æ–‡æ¡£çš„ç¼–å†™æä¾›äº†ä¸€ä¸ª``æ‰€è§å³æ‰€å¾—''ï¼ˆ\href{https://en.wikipedia.org/wiki/WYSIWYM}{WYSIWYM}ï¼‰çš„ç•Œé¢ã€‚å®
é™…ä¸Šï¼ŒQuarto æ–‡æ¡£ï¼ˆ\texttt{.qmd}æ–‡ä»¶ï¼‰ä¸­çš„æ–‡æœ¬éƒ¨åˆ†ä½¿ç”¨ Markdown
ç¼–å†™ï¼ŒMarkdown æ˜¯ä¸€å¥—è½»é‡çº§çš„æ–‡æœ¬æ–‡ä»¶æ ¼å¼çº¦å®šã€‚Q uarto ä½¿ç”¨çš„æ˜¯ Pandoc
markdownï¼ˆMarkdown çš„ä¸€ä¸ªç¨æœ‰æ‰©å±•çš„ç‰ˆæœ¬ï¼ŒQuarto
èƒ½å¤Ÿç†è§£ï¼‰ï¼ŒåŒ…æ‹¬è¡¨æ ¼ã€å¼•æ–‡ã€äº¤å‰å¼•ç”¨ã€è„šæ³¨ã€divs/spansã€å®šä¹‰åˆ—è¡¨ã€å±æ€§ã€åŸå§‹
HTML/TeX ç­‰ï¼Œå¹¶æ”¯æŒæ‰§è¡Œä»£ç å•å…ƒæ ¼å’ŒæŸ¥çœ‹å®ƒä»¬çš„å†…è”è¾“å‡ºã€‚å°½ ç®¡ Markdown
çš„è®¾è®¡åˆè¡·æ˜¯æ˜“äºè¯»å†™ï¼Œå¦‚ä½ åœ¨@sec-source-editor
ä¸­æ‰€è§ï¼Œå­¦ä¹ æ–°çš„è¯­æ³•ä»ç„¶æ˜¯å¿…è¦çš„ã€‚å›  æ­¤ï¼Œå¦‚æœä½ ä¸ç†Ÿæ‚‰åƒ \texttt{.qmd}
æ–‡ä»¶è¿™æ ·çš„è®¡ç®—æ–‡æ¡£ï¼Œä½†æœ‰ä½¿ç”¨ Google Docs æˆ– MS Word ç­‰å·¥å…·çš„ç»éªŒï¼Œé‚£ä¹ˆåœ¨
RStudio ä¸­ä½¿ç”¨ Quarto çš„æœ€ç®€å•æ–¹æ³•å°±æ˜¯ä½¿ç”¨å¯è§†åŒ–ç¼–è¾‘å™¨ã€‚

åœ¨å¯è§†åŒ–ç¼–è¾‘å™¨ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨èœå•æ ä¸Šçš„æŒ‰é’®æ¥æ’å…¥å›¾ç‰‡ã€è¡¨æ ¼ã€äº¤å‰å¼•ç”¨ç­‰ï¼Œæˆ–è€…ä½¿ç”¨é€šç”¨å¿«æ·é”®\textless kbd\textgreaterâŒ˜\textless/kbd\textgreater+\textless kbd\textgreater/\textless/kbd\textgreaterï¼ˆMacï¼‰æˆ–~\textless kbd\textgreater Ctrl\textless/kbd\textgreater+\textless kbd\textgreater/\textless/kbd\textgreaterï¼ˆWindows/Linuxï¼‰æ¥æ’å…¥å‡ ä¹ä»»ä½•å†…å®¹ã€‚å¦‚
æœä½ åœ¨è¡Œçš„å¼€å¤´ï¼ˆå¦‚ å›¾~\ref{fig-visual-editor}
æ‰€ç¤ºï¼‰ï¼Œä½ ä¹Ÿå¯ä»¥åªè¾“å…¥\textless kbd\textgreater/\textless/kbd\textgreater æ¥è°ƒç”¨è¿™ä¸ªå¿«æ·é”®ã€‚

\begin{figure}

\centering{

\includegraphics[width=0.75\textwidth,height=\textheight]{quarto/quarto-visual-editor.png}

}

\caption{\label{fig-visual-editor}Quarto visual editor.}

\end{figure}%

ä½¿ç”¨å¯è§†åŒ–ç¼–è¾‘å™¨æ’å…¥å›¾ç‰‡å’Œè‡ªå®šä¹‰å›¾ç‰‡çš„æ˜¾ç¤ºæ–¹å¼ä¹Ÿå¾ˆæ–¹ä¾¿ã€‚ä½ 
å¯ä»¥ç›´æ¥ä»å‰ªè´´æ¿ä¸­å°†å›¾ç‰‡ç²˜è´´åˆ°å¯è§†åŒ–ç¼–è¾‘å™¨ä¸­ï¼ˆRStudio
ä¼šåœ¨é¡¹ç›®ç›®å½•ä¸­æ”¾ç½®è¯¥å›¾ç‰‡çš„ä¸€ä¸ªå‰¯æœ¬å¹¶é“¾æ¥åˆ°å®ƒï¼‰ï¼Œæˆ–è€…ä½ å¯ä»¥ä½¿ç”¨å¯è§†åŒ–ç¼–è¾‘å™¨çš„\emph{Insert
\textgreater{} Figure / Image}èœå•æ¥æµè§ˆä½ æƒ³è¦æ’å…¥çš„å›¾ç‰‡æˆ–ç²˜è´´å…¶ URLã€‚æ­¤
å¤–ï¼Œä½¿ç”¨ç›¸åŒçš„èœå•ï¼Œä½ è¿˜å¯ä»¥è°ƒæ•´å›¾ç‰‡çš„å¤§å°ã€æ·»åŠ æ ‡é¢˜ã€æ›¿ä»£æ–‡æœ¬å’Œé“¾æ¥ã€‚

å¯è§†åŒ–ç¼–è¾‘å™¨è¿˜æœ‰è®¸å¤šå…¶ä»–æˆ‘ä»¬æ²¡æœ‰åœ¨æ­¤åˆ—ä¸¾çš„åŠŸèƒ½ï¼Œéšç€ä½ ä½¿ç”¨å®ƒè¿›è¡Œæ–‡æ¡£ç¼–å†™çš„ç»éªŒå¢åŠ ï¼Œä½ å¯èƒ½ä¼šå‘ç°è¿™äº›åŠŸèƒ½å¾ˆæœ‰ç”¨ã€‚

æœ€é‡è¦çš„æ˜¯ï¼Œè™½ç„¶å¯è§†åŒ–ç¼–è¾‘å™¨ä»¥æ ¼å¼åŒ–æ–¹å¼æ˜¾ç¤ºä½ çš„å†…å®¹ï¼Œä½†å®é™…ä¸Šï¼Œå®ƒæ˜¯ä»¥çº¯
Markdown
æ ¼å¼ä¿å­˜ä½ çš„å†…å®¹çš„ï¼Œä½ å¯ä»¥åœ¨å¯è§†åŒ–å’Œæºä»£ç ç¼–è¾‘å™¨ä¹‹é—´æ¥å›åˆ‡æ¢ï¼Œä»¥ä½¿ç”¨ä»»ä¸€å·¥å…·æŸ¥çœ‹å’Œç¼–è¾‘ä½ çš„å†…å®¹ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-67}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  ä½¿ç”¨å¯è§†åŒ–ç¼–è¾‘å™¨é‡æ–°åˆ›å»º å›¾~\ref{fig-visual-editor} ä¸­çš„æ–‡æ¡£ã€‚
\item
  ä½¿ç”¨å¯è§†åŒ–ç¼–è¾‘å™¨ï¼Œé€šè¿‡\emph{Insert}èœå•ç„¶åé€‰æ‹©\emph{insert
  anything}å·¥å…·æ¥æ’å…¥ä¸€ä¸ªä»£ç å—ã€‚
\item
  ä½¿ç”¨å¯è§†åŒ–ç¼–è¾‘å™¨ï¼Œæ‰¾å‡ºå¦‚ä½•ï¼š

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \tightlist
  \item
    æ·»åŠ è„šæ³¨ã€‚
  \item
    æ·»åŠ æ°´å¹³çº¿ã€‚
  \item
    æ·»åŠ å—å¼•ç”¨ã€‚
  \end{enumerate}
\item
  åœ¨å¯è§†åŒ–ç¼–è¾‘å™¨ä¸­ï¼Œè½¬åˆ°\emph{Insert \textgreater{}
  Citation}å¹¶æ’å…¥ä¸€ç¯‡åä¸º``\href{https://joss.theoj.org/papers/10.21105/joss.01686}{Welcome
  to the Tidyverse}''çš„è®ºæ–‡çš„å¼•æ–‡ï¼Œä½¿ç”¨å…¶ DOIï¼ˆæ•°å­—å¯¹è±¡æ ‡è¯†ç¬¦ï¼‰ï¼Œå³
  \href{https://doi.org/10.21105/joss.01686}{10.21105/joss.01686}ã€‚æ¸²æŸ“æ–‡æ¡£å¹¶è§‚å¯Ÿå¼•æ–‡åœ¨æ–‡æ¡£ä¸­çš„æ˜¾ç¤ºæ–¹å¼ã€‚ä½ çš„æ–‡æ¡£çš„
  YAML éƒ¨åˆ†å‘ç”Ÿäº†ä»€ä¹ˆå˜åŒ–ï¼Ÿ
\end{enumerate}

\section{æºä»£ç ç¼–è¾‘å™¨}\label{sec-source-editor}

ä½ ä¹Ÿå¯ä»¥åœ¨ RStudio çš„æºä»£ç ç¼–è¾‘å™¨ä¸­ç¼–è¾‘ Quarto
æ–‡æ¡£ï¼Œè€Œæ— éœ€å¯è§†åŒ–ç¼–è¾‘å™¨çš„å¸®åŠ©ã€‚è™½ ç„¶å¯è§†åŒ–ç¼–è¾‘å™¨å¯¹äºä¹ æƒ¯ä½¿ç”¨ Google
Docs ç­‰å·¥å…·ç¼–å†™æ–‡æ¡£çš„äººæ¥è¯´ä¼šæ„Ÿè§‰å¾ˆç†Ÿæ‚‰ï¼Œä½†æºä»£ç ç¼–è¾‘å™¨å¯¹äºæœ‰ç»éªŒçš„ R
è„šæœ¬æˆ– R Markdown æ–‡æ¡£ç¼–å†™è€…æ¥è¯´ä¹Ÿä¼šæ„Ÿè§‰ç†Ÿæ‚‰ã€‚æº ä»£ç ç¼–è¾‘å™¨åœ¨è°ƒè¯•ä»»ä½•
Quarto è¯­æ³•é”™è¯¯æ—¶ä¹Ÿéå¸¸æœ‰ç”¨ï¼Œå› ä¸ºé€šå¸¸åœ¨çº¯æ–‡æœ¬ä¸­æ›´å®¹æ˜“å‘ç°è¿™äº›é”™è¯¯ã€‚

ä¸‹é¢çš„æŒ‡å—å±•ç¤ºäº†å¦‚ä½•åœ¨æºä»£ç ç¼–è¾‘å™¨ä¸­ä½¿ç”¨ Pandoc çš„ Markdown æ¥ç¼–å†™
Quarto æ–‡æ¡£ã€‚

\begin{verbatim}
## Text formatting

*italic* **bold** ~~strikeout~~ `code`

superscript^2^ subscript~2~

[underline]{.underline} [small caps]{.smallcaps}

## Headings

# 1st Level Header

## 2nd Level Header

### 3rd Level Header

## Lists

-   Bulleted list item 1

-   Item 2

    -   Item 2a

    -   Item 2b

1.  Numbered list item 1

2.  Item 2.
    The numbers are incremented automatically in the output.

## Links and images

<http://example.com>

[linked phrase](http://example.com)

![optional caption text](quarto.png){fig-alt="Quarto logo and the word quarto spelled in small case letters"}

## Tables

| First Header | Second Header |
|--------------|---------------|
| Content Cell | Content Cell  |
| Content Cell | Content Cell  |
\end{verbatim}

å­¦ä¹ è¿™äº›çš„æœ€ä½³æ–¹æ³•å°±æ˜¯å»å°è¯•ä½¿ç”¨å®ƒä»¬ã€‚è¿™
å¯èƒ½éœ€è¦å‡ å¤©çš„æ—¶é—´ï¼Œä½†å¾ˆå¿«å°±ä¼šå˜å¾—é©¾è½»å°±ç†Ÿï¼Œä½ ç”šè‡³ä¸éœ€è¦å†å»æ€è€ƒå®ƒä»¬ã€‚å¦‚
æœä½ å¿˜è®°äº†ï¼Œå¯ä»¥é€šè¿‡\emph{Help \textgreater{} Markdown Quick Reference}
æ¥æŸ¥çœ‹æ–¹ä¾¿çš„å‚è€ƒè¡¨ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-68}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  é€šè¿‡åˆ›å»ºä¸€ä¸ªç®€çŸ­çš„ç®€å†æ¥å®è·µä½ æ‰€å­¦åˆ°çš„å†…å®¹ã€‚ç®€
  å†çš„æ ‡é¢˜åº”è¯¥æ˜¯ä½ çš„åå­—ï¼Œå¹¶ä¸”åº”è¯¥åŒ…æ‹¬ï¼ˆè‡³å°‘ï¼‰æ•™è‚²æˆ–å·¥ä½œç»å†çš„æ ‡é¢˜ã€‚æ¯
  ä¸ªéƒ¨åˆ†éƒ½åº”è¯¥åŒ…å«ä¸€ä¸ªä»¥é¡¹ç›®ç¬¦å·åˆ—å‡ºçš„å·¥ä½œæˆ–å­¦ä½åˆ—è¡¨ã€‚ç”¨ ç²—ä½“çªå‡ºå¹´ä»½ã€‚
\item
  ä½¿ç”¨æºç¼–è¾‘å™¨å’ŒMarkdownå¿«é€Ÿå‚è€ƒæŒ‡å—ï¼Œå¼„æ¸…æ¥šå¦‚ä½•ï¼š

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \tightlist
  \item
    æ·»åŠ è„šæ³¨ã€‚
  \item
    æ·»åŠ æ°´å¹³çº¿ã€‚
  \item
    æ·»åŠ å—å¼•ç”¨ã€‚
  \end{enumerate}
\item
  å°†\hyperref[0]{https://github.com/hadley/r4ds/tree/main/quarto}ä¸­
  \texttt{diamond-sizes.qmd} çš„å†…å®¹å¤åˆ¶å¹¶ç²˜è´´åˆ°æœ¬åœ°çš„ R Quarto
  æ–‡æ¡£ä¸­ã€‚æ£€
  æŸ¥æ˜¯å¦å¯ä»¥è¿è¡Œå®ƒï¼Œç„¶ååœ¨é¢‘ç‡å¤šè¾¹å½¢ä¹‹åæ·»åŠ æè¿°å…¶æœ€æ˜¾è‘—ç‰¹å¾çš„æ–‡æœ¬ã€‚
\item
  åœ¨ Google Docs æˆ– MS Word
  ä¸­åˆ›å»ºä¸€ä¸ªæ–‡æ¡£ï¼ˆæˆ–æ‰¾åˆ°ä½ ä¹‹å‰åˆ›å»ºçš„æ–‡æ¡£ï¼‰ï¼Œå…¶ä¸­åŒ…å«ä¸€äº›å†…å®¹ï¼Œå¦‚æ ‡é¢˜ã€è¶…é“¾æ¥ã€æ ¼å¼åŒ–çš„æ–‡æœ¬ç­‰ã€‚å¤
  åˆ¶è¿™ä¸ªæ–‡æ¡£çš„å†…å®¹ï¼Œå¹¶ç²˜è´´åˆ° Quarto æ–‡æ¡£çš„å¯è§†åŒ–ç¼–è¾‘å™¨ä¸­ã€‚ç„¶
  åï¼Œåˆ‡æ¢åˆ°æºä»£ç ç¼–è¾‘å™¨å¹¶æ£€æŸ¥æºä»£ç ã€‚
\end{enumerate}

\section{ä»£ç å—}\label{ux4ee3ux7801ux5757}

è¦åœ¨Quartoæ–‡æ¡£ä¸­è¿è¡Œä»£ç ï¼Œéœ€è¦æ’å…¥ä¸€ä¸ªå—ã€‚æœ‰ ä¸‰ç§æ–¹æ³•:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  é”®ç›˜å¿«æ·é”® Cmd + Option + I / Ctrl + Alt + Iã€‚
\item
  ç¼–è¾‘å™¨å·¥å…·æ ä¸­çš„InsertæŒ‰é’®å›¾æ ‡ã€‚
\item
  é€šè¿‡æ‰‹åŠ¨é”®å…¥ä»£ç å—åˆ†éš”ç¬¦
  \texttt{\textasciigrave{}\textasciigrave{}\textasciigrave{}\{r\}} and
  \texttt{\textasciigrave{}\textasciigrave{}\textasciigrave{}}.
\end{enumerate}

æˆ‘ä»¬å»ºè®®ä½ å­¦ä¹ é”®ç›˜å¿«æ·é”®ã€‚ä» é•¿è¿œæ¥çœ‹ï¼Œè¿™å°†èŠ‚çœä½ å¾ˆå¤šæ—¶é—´!

ä½ å¯ä»¥ç»§ç»­ä½¿ç”¨ä½ å·²çŸ¥å¹¶å–œçˆ±çš„é”®ç›˜å¿«æ·é”®æ¥è¿è¡Œä»£ç ï¼šCmd/Ctrl + Enterã€‚ç„¶
è€Œï¼Œä»£ç å—ç°åœ¨æœ‰ä¸€ä¸ªæ–°çš„é”®ç›˜å¿«æ·é”®ï¼šCmd/Ctrl + Shift +
Enterï¼Œè¿™ä¸ªå¿«æ·é”®ä¼šè¿è¡Œä»£ç å—ä¸­çš„æ‰€æœ‰ä»£ç ã€‚ä½ 
å¯ä»¥æŠŠä»£ç å—æƒ³è±¡æˆä¸€ä¸ªå‡½æ•°ã€‚ä¸€
ä¸ªä»£ç å—åº”è¯¥æ˜¯ç›¸å¯¹ç‹¬ç«‹çš„ï¼Œå¹¶ä¸”ä¸“æ³¨äºä¸€ä¸ªå•ä¸€çš„ä»»åŠ¡ã€‚

ä»¥ä¸‹éƒ¨åˆ†æè¿°äº†ä»£ç å—å¤´éƒ¨ï¼Œå®ƒç”±\texttt{\textasciigrave{}\textasciigrave{}\textasciigrave{}\{r\}}å¼€å§‹ï¼Œåé¢è·Ÿç€ä¸€ä¸ªå¯é€‰çš„ä»£ç å—æ ‡ç­¾å’Œå„ç§å…¶ä»–ä»£ç å—é€‰é¡¹ï¼Œæ¯ä¸ªé€‰é¡¹éƒ½åœ¨å®ƒä»¬è‡ªå·±çš„è¡Œä¸Šï¼Œå¹¶ç”¨\texttt{\#\textbar{}}æ ‡è®°ã€‚

\subsection{å—æ ‡ç­¾}\label{ux5757ux6807ux7b7e}

å—å¯ä»¥è¢«èµ‹äºˆä¸€ä¸ªå¯é€‰çš„æ ‡ç­¾ï¼Œä¾‹å¦‚:

\begin{Shaded}
\begin{Highlighting}[]
\InformationTok{\textasciigrave{}\textasciigrave{}\textasciigrave{}\{r\}}
\InformationTok{\#| label: simple{-}addition}

\InformationTok{1 + 1}
\InformationTok{\textasciigrave{}\textasciigrave{}\textasciigrave{}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
#> [1] 2
\end{verbatim}

è¿™æœ‰ä¸‰ä¸ªå¥½å¤„ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  æ‚¨å¯ä»¥é€šè¿‡è„šæœ¬ç¼–è¾‘å™¨å·¦ä¸‹è§’çš„ä¸‹æ‹‰ä»£ç å¯¼èˆªå™¨æ›´è½»æ¾åœ°å¯¼èˆªåˆ°ç‰¹å®šçš„ä»£ç å—ï¼š

  \includegraphics[width=0.3\textwidth,height=\textheight]{screenshots/quarto-chunk-nav.png}
\item
  ä»£ç å—äº§ç”Ÿçš„å›¾å½¢å°†å…·æœ‰æœ‰ç”¨çš„åç§°ï¼Œä½¿å¾—åœ¨å…¶ä»–åœ°æ–¹ä½¿ç”¨å®ƒä»¬æ›´åŠ æ–¹ä¾¿ã€‚æ›´
  å¤šä¿¡æ¯è¯·å‚è§@sec-figures ã€‚
\item
  ä½ å¯ä»¥è®¾ç½®ç¼“å­˜ä»£ç å—çš„ç½‘ç»œï¼Œä»¥é¿å…åœ¨æ¯æ¬¡è¿è¡Œæ—¶é‡æ–°æ‰§è¡Œè€—æ—¶çš„è®¡ç®—ã€‚æ›´
  å¤šä¿¡æ¯è¯·å‚è§@sec-caching ã€‚
\end{enumerate}

æ‚¨çš„ä»£ç å—æ ‡ç­¾åº”è¯¥ç®€çŸ­ä½†å¯Œæœ‰å¯å‘æ€§ï¼Œå¹¶ä¸”ä¸åº”è¯¥åŒ…å«ç©ºæ ¼ã€‚æˆ‘
ä»¬å»ºè®®ä½¿ç”¨è¿å­—ç¬¦ï¼ˆ\texttt{-}ï¼‰æ¥åˆ†éš”å•è¯ï¼ˆè€Œä¸æ˜¯ä¸‹åˆ’çº¿\texttt{\_}ï¼‰ï¼Œå¹¶é¿å…åœ¨ä»£ç å—æ ‡ç­¾ä¸­ä½¿ç”¨å…¶ä»–ç‰¹æ®Šå­—ç¬¦ã€‚

ä½ é€šå¸¸å¯ä»¥éšæ„æ ‡è®°ä½ çš„ä»£ç å—ï¼Œä½†æœ‰ä¸€ä¸ªä»£ç å—åç§°å…·æœ‰ç‰¹æ®Šè¡Œä¸ºï¼š\texttt{setup}ã€‚å½“
ä½ åœ¨ç¬”è®°æœ¬æ¨¡å¼ä¸‹æ—¶ï¼Œåä¸º\texttt{setup}çš„ä»£ç å—å°†è‡ªåŠ¨è¿è¡Œä¸€æ¬¡ï¼Œå¹¶ä¸”åœ¨è¿è¡Œä»»ä½•å…¶ä»–ä»£ç ä¹‹å‰ã€‚

æ­¤å¤–ï¼Œä»£ç å—æ ‡ç­¾ä¸èƒ½é‡å¤ï¼Œæ¯ä¸ªä»£ç å—æ ‡ç­¾éƒ½å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚

\subsection{å—é€‰é¡¹}\label{ux5757ux9009ux9879}

ä»£ç å—çš„è¾“å‡ºå¯ä»¥é€šè¿‡æä¾›ç»™ä»£ç å—å¤´éƒ¨çš„å­—æ®µé€‰é¡¹è¿›è¡Œè‡ªå®šä¹‰ã€‚k nitr
æä¾›äº†è¿‘ 60 ä¸ªé€‰é¡¹ï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥å®šåˆ¶ä½ çš„ä»£ç å—ã€‚è¿™
é‡Œæˆ‘ä»¬å°†ä»‹ç»ç»å¸¸ä½¿ç”¨çš„æœ€é‡è¦çš„ä»£ç å—é€‰é¡¹ã€‚ä½ 
å¯ä»¥åœ¨\url{https://yihui.org/knitr/options}æŸ¥çœ‹å®Œæ•´çš„é€‰é¡¹åˆ—è¡¨ã€‚

æœ€é‡è¦çš„ä¸€ç»„é€‰é¡¹æ§åˆ¶ä½ çš„ä»£ç å—æ˜¯å¦è¢«æ‰§è¡Œä»¥åŠå“ªäº›ç»“æœè¢«æ’å…¥åˆ°æœ€ç»ˆçš„æŠ¥å‘Šä¸­ï¼š

\texttt{eval:\ false}
é˜»æ­¢ä»£ç è¢«è¯„ä¼°ï¼ˆæ˜¾ç„¶ï¼Œå¦‚æœä»£ç æ²¡æœ‰è¢«è¿è¡Œï¼Œå°±ä¸ä¼šç”Ÿæˆç»“æœï¼‰ã€‚è¿™
å¯¹äºæ˜¾ç¤ºç¤ºä¾‹ä»£ç æˆ–ç¦ç”¨ä¸€å¤§å—ä»£ç è€Œä¸å¿…é€è¡Œæ³¨é‡Šå¾ˆæœ‰ç”¨ã€‚

\texttt{include:\ false} ä¼šè¿è¡Œä»£ç ï¼Œä½†åœ¨æœ€ç»ˆæ–‡æ¡£ä¸­ä¸æ˜¾ç¤ºä»£ç æˆ–ç»“æœã€‚ä½¿
ç”¨æ­¤é€‰é¡¹æ¥è®¾ç½®ä½ ä¸æƒ³åœ¨æŠ¥å‘Šä¸­æ˜¾ç¤ºçš„ä»£ç ã€‚

\texttt{echo:\ false} é˜»æ­¢ä»£ç å‡ºç°åœ¨æœ€ç»ˆæ–‡ä»¶ä¸­ï¼Œä½†ç»“æœä»ç„¶æ˜¾ç¤ºã€‚å½“
ç¼–å†™é¢å‘ä¸æƒ³çœ‹åˆ°åº•å±‚ R ä»£ç çš„è¯»è€…çš„æŠ¥å‘Šæ—¶ï¼Œè¯·ä½¿ç”¨æ­¤é€‰é¡¹ã€‚

\texttt{message:\ false}æˆ–\texttt{warning:\ false}
é˜»æ­¢æ¶ˆæ¯æˆ–è­¦å‘Šå‡ºç°åœ¨æœ€ç»ˆæ–‡ä»¶ä¸­ã€‚

\texttt{results:\ hide} éšè—æ‰“å°è¾“å‡ºï¼›\texttt{fig.show:\ hide}
éšè—å›¾å½¢ã€‚

\texttt{error:\ true} å³ä½¿ä»£ç è¿”å›é”™è¯¯ä¹Ÿç»§ç»­æ¸²æŸ“ã€‚è¿™
å¾ˆå°‘æ˜¯ä½ å¸Œæœ›åœ¨æŠ¥å‘Šçš„æœ€ç»ˆç‰ˆæœ¬ä¸­åŒ…æ‹¬çš„å†…å®¹ï¼Œä½†å¦‚æœä½ éœ€è¦è°ƒè¯• \texttt{.qmd}
æ–‡ä»¶å†…éƒ¨åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Œå®ƒä¼šéå¸¸æœ‰ç”¨ã€‚å¦‚ æœä½ æ­£åœ¨æ•™æˆ R
å¹¶æƒ³æ•…æ„åŒ…å«ä¸€ä¸ªé”™è¯¯ï¼Œå®ƒä¹Ÿå¾ˆæœ‰ç”¨ã€‚é»˜
è®¤æƒ…å†µä¸‹ï¼Œ\texttt{error:\ false}ä¼šåœ¨æ–‡æ¡£ä¸­å‡ºç°å•ä¸ªé”™è¯¯æ—¶å¯¼è‡´æ¸²æŸ“å¤±è´¥ã€‚

è¿™äº›ä»£ç å—é€‰é¡¹ä¸­çš„æ¯ä¸€ä¸ªéƒ½æ·»åŠ åˆ°ä»£ç å—çš„å¤´éƒ¨ï¼Œè·Ÿåœ¨\texttt{\#\textbar{}}åé¢ï¼Œä¾‹å¦‚ï¼Œåœ¨ä¸‹é¢çš„ä»£ç å—ä¸­ï¼Œç”±äº\texttt{eval}è®¾ç½®ä¸º\texttt{false}ï¼Œç»“æœä¸ä¼šè¢«æ‰“å°å‡ºæ¥ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\InformationTok{\textasciigrave{}\textasciigrave{}\textasciigrave{}\{r\}}
\InformationTok{\#| label: simple{-}multiplication}
\InformationTok{\#| eval: false}

\InformationTok{2 * 2}
\InformationTok{\textasciigrave{}\textasciigrave{}\textasciigrave{}}
\end{Highlighting}
\end{Shaded}

ä¸‹è¡¨æ€»ç»“äº†æ¯ä¸ªé€‰é¡¹æŠ‘åˆ¶çš„è¾“å‡ºç±»å‹:

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.2432}}
  >{\centering\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1351}}
  >{\centering\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1486}}
  >{\centering\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1081}}
  >{\centering\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.0946}}
  >{\centering\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1351}}
  >{\centering\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1351}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Option
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Run code
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Show code
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Output
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Plots
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Messages
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
Warnings
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\texttt{eval:\ false} & X & & X & X & X & X \\
\texttt{include:\ false} & & X & X & X & X & X \\
\texttt{echo:\ false} & & X & & & & \\
\texttt{results:\ hide} & & & X & & & \\
\texttt{fig-show:\ hide} & & & & X & & \\
\texttt{message:\ false} & & & & & X & \\
\texttt{warning:\ false} & & & & & & X \\
\end{longtable}

\subsection{å…¨å±€é€‰é¡¹}\label{ux5168ux5c40ux9009ux9879}

éšç€ä½ æ›´æ·±å…¥åœ°ä½¿ç”¨
knitrï¼Œä½ ä¼šå‘ç°ä¸€äº›é»˜è®¤çš„ä»£ç å—é€‰é¡¹å¹¶ä¸ç¬¦åˆä½ çš„éœ€æ±‚ï¼Œä½ æƒ³è¦æ”¹å˜å®ƒä»¬ã€‚

ä½ å¯ä»¥é€šè¿‡åœ¨æ–‡æ¡£çš„ YAML
éƒ¨åˆ†ä¸‹çš„\texttt{execute}ä¸­æ·»åŠ é¦–é€‰é€‰é¡¹æ¥å®ç°è¿™ä¸€ç‚¹ã€‚ä¾‹
å¦‚å¦‚æœä½ æ­£åœ¨ä¸ºä¸éœ€è¦çœ‹åˆ°ä½ çš„ä»£ç ä½†åªéœ€è¦çœ‹åˆ°ä½ çš„ç»“æœå’Œå™è¿°çš„å—ä¼—å‡†å¤‡æŠ¥å‘Šï¼Œä½ å¯èƒ½ä¼šåœ¨æ–‡æ¡£çº§åˆ«è®¾ç½®\texttt{echo:\ false}ã€‚è¿™
å°†é»˜è®¤éšè—ä»£ç ï¼Œå› æ­¤åªæ˜¾ç¤ºä½ æ•…æ„é€‰æ‹©æ˜¾ç¤ºçš„ä»£ç å—ï¼ˆä½¿ç”¨\texttt{echo:\ true}ï¼‰ã€‚ä½ 
å¯èƒ½ä¼šè€ƒè™‘è®¾ç½®\texttt{message:\ false}å’Œ\texttt{warning:\ false}ï¼Œä½†è¿™ä¼šä½¿å¾—è°ƒè¯•é—®é¢˜å˜å¾—æ›´åŠ å›°éš¾ï¼Œå› ä¸ºä½ åœ¨æœ€ç»ˆæ–‡æ¡£ä¸­çœ‹ä¸åˆ°ä»»ä½•æ¶ˆæ¯ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{title}\KeywordTok{:}\AttributeTok{ }\StringTok{"My report"}
\FunctionTok{execute}\KeywordTok{:}
\AttributeTok{  }\FunctionTok{echo}\KeywordTok{:}\AttributeTok{ }\CharTok{false}
\end{Highlighting}
\end{Shaded}

ç”±äº Quarto è¢«è®¾è®¡ä¸ºæ”¯æŒå¤šç§è¯­è¨€ï¼ˆé€‚ç”¨äº R ã€Pythonä»¥åŠ Julia
ç­‰ï¼‰ï¼Œå› æ­¤åœ¨æ–‡æ¡£æ‰§è¡Œçº§åˆ«å¹¶éæ‰€æœ‰ knitr
é€‰é¡¹éƒ½å¯ç”¨ï¼Œå› ä¸ºå…¶ä¸­ä¸€äº›é€‰é¡¹ä»…é€‚ç”¨äº knitr è€Œä¸é€‚ç”¨äº Quarto
ç”¨äºè¿è¡Œå…¶ä»–è¯­è¨€ä»£ç çš„å…¶ä»–å¼•æ“ï¼ˆå¦‚Jupyterï¼‰ã€‚ç„¶ è€Œä½ ä»ç„¶å¯ä»¥åœ¨ knitr
å­—æ®µä¸‹çš„\texttt{opts\_chunk}ä¸­ä¸ºä½ çš„æ–‡æ¡£è®¾ç½®è¿™äº›é€‰é¡¹ä½œä¸ºå…¨å±€é€‰é¡¹ã€‚ä¾‹
å¦‚ï¼Œåœ¨ç¼–å†™ä¹¦ç±å’Œæ•™ç¨‹æ—¶ï¼Œæˆ‘ä»¬è®¾ç½®ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{title}\KeywordTok{:}\AttributeTok{ }\StringTok{"Tutorial"}
\FunctionTok{knitr}\KeywordTok{:}
\AttributeTok{  }\FunctionTok{opts\_chunk}\KeywordTok{:}
\AttributeTok{    }\FunctionTok{comment}\KeywordTok{:}\AttributeTok{ }\StringTok{"\#\textgreater{}"}
\AttributeTok{    }\FunctionTok{collapse}\KeywordTok{:}\AttributeTok{ }\CharTok{true}
\end{Highlighting}
\end{Shaded}

è¿™ä½¿ç”¨äº†æˆ‘ä»¬é¦–é€‰çš„æ³¨é‡Šæ ¼å¼ï¼Œå¹¶ç¡®ä¿ä»£ç å’Œè¾“å‡ºç´§å¯†åœ°äº¤ç»‡åœ¨ä¸€èµ·ã€‚

\subsection{å†…è”ä»£ç }\label{ux5185ux8054ux4ee3ux7801}

è¿˜æœ‰ä¸€ç§å°† R ä»£ç åµŒå…¥ Quarto
æ–‡æ¡£çš„æ–¹æ³•ï¼šç›´æ¥åœ¨æ–‡æœ¬ä¸­ä½¿ç”¨\texttt{\textasciigrave{}r\ \textasciigrave{}}ã€‚å¦‚
æœä½ åœ¨æ–‡æœ¬ä¸­æåˆ°æ•°æ®çš„å±æ€§ï¼Œè¿™ä¼šéå¸¸æœ‰ç”¨ã€‚ä¾‹
å¦‚ï¼Œæœ¬ç« å¼€å¤´ä½¿ç”¨çš„ç¤ºä¾‹æ–‡æ¡£ä¸­æœ‰ï¼š

\begin{quote}
æˆ‘ä»¬æœ‰å…³äº\texttt{\textasciigrave{}r\ nrow(diamonds)\textasciigrave{}}é¢—é’»çŸ³çš„æ•°æ®ã€‚åª
æœ‰\texttt{\textasciigrave{}r\ nrow(diamonds)\ -\ nrow(smaller)\textasciigrave{}}é¢—é’»çŸ³å¤§äº
2.5 å…‹æ‹‰ã€‚å‰© ä½™çš„åˆ†å¸ƒå¦‚ä¸‹æ‰€ç¤ºï¼š
\end{quote}

å½“æŠ¥å‘Šè¢«æ¸²æŸ“æ—¶ï¼Œè¿™äº›è®¡ç®—çš„ç»“æœä¼šè¢«æ’å…¥åˆ°æ–‡æœ¬ä¸­ï¼š

\begin{quote}
æˆ‘ä»¬æœ‰å…³äº 53940 é¢—é’»çŸ³çš„æ•°æ®ã€‚åª æœ‰ 126 é¢—é’»çŸ³å¤§äº 2.5 å…‹æ‹‰ã€‚å‰©
ä½™çš„åˆ†å¸ƒå¦‚ä¸‹æ‰€ç¤ºï¼š
\end{quote}

åœ¨å°†æ•°å­—æ’å…¥æ–‡æœ¬æ—¶ï¼Œ\texttt{format()}æ˜¯ä½ çš„å¥½å¸®æ‰‹ã€‚å®ƒ
å…è®¸ä½ è®¾ç½®æ•°å­—çš„ä½æ•°ï¼Œä»¥ä¾¿ä½ ä¸ä¼šæ‰“å°å‡ºè’è°¬çš„ç²¾åº¦ï¼Œè¿˜å¯ä»¥è®¾ç½®åƒä½åˆ†éš”ç¬¦ï¼ˆ\texttt{big.mark}ï¼‰ä»¥ä½¿æ•°å­—æ›´å®¹æ˜“é˜…è¯»ã€‚ä½ 
å¯ä»¥å°†è¿™äº›åŠŸèƒ½ç»„åˆæˆä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{comma }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{format}\NormalTok{(x, }\AttributeTok{digits =} \DecValTok{2}\NormalTok{, }\AttributeTok{big.mark =} \StringTok{","}\NormalTok{)}
\FunctionTok{comma}\NormalTok{(}\DecValTok{3452345}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "3,452,345"}
\FunctionTok{comma}\NormalTok{(.}\DecValTok{12358124331}\NormalTok{)}
\CommentTok{\#\textgreater{} [1] "0.12"}
\end{Highlighting}
\end{Shaded}

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-69}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  æ·»åŠ ä¸€èŠ‚æ¥æ¢è®¨é’»çŸ³çš„å°ºå¯¸å¦‚ä½•éšåˆ‡å‰²ã€é¢œè‰²å’Œå‡€åº¦è€Œå˜åŒ–ã€‚å‡
  è®¾ä½ æ­£åœ¨ä¸ºä¸æ‡‚Rçš„äººç¼–å†™æŠ¥å‘Šï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ªä»£ç å—ä¸Šè®¾ç½®\texttt{echo:\ false}ï¼Œè€Œæ˜¯è®¾ç½®ä¸€ä¸ªå…¨å±€é€‰é¡¹ã€‚
\item
  ä»
  \url{https://github.com/hadley/r4ds/tree/main/quarto}ä¸‹è½½\texttt{diamond-sizes.qmd}ã€‚åœ¨
  æ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªéƒ¨åˆ†æ¥æè¿°æœ€å¤§çš„20é¢—é’»çŸ³ï¼ŒåŒ…æ‹¬ä¸€ä¸ªæ˜¾ç¤ºå®ƒä»¬æœ€é‡è¦å±æ€§çš„è¡¨æ ¼ã€‚
\item
  ä¿®æ”¹\texttt{diamonds-sizes.qmd}æ–‡ä»¶ï¼Œä½¿ç”¨\texttt{label\_comma()}å‡½æ•°æ¥ç”Ÿæˆæ ¼å¼ä¼˜ç¾çš„è¾“å‡ºã€‚åŒ
  æ—¶ï¼Œä¹Ÿè¦åŒ…å«å¤§äº2.5å…‹æ‹‰çš„é’»çŸ³çš„ç™¾åˆ†æ¯”ã€‚
\end{enumerate}

\section{å›¾å½¢}\label{sec-figures}

Quarto æ–‡æ¡£ä¸­çš„å›¾å½¢å¯ä»¥åµŒå…¥ï¼ˆä¾‹å¦‚PNG æˆ– JPEG
æ–‡ä»¶ï¼‰æˆ–ä½œä¸ºä»£ç å—çš„ç»“æœç”Ÿæˆã€‚

è¦ä»å¤–éƒ¨æ–‡ä»¶åµŒå…¥å›¾åƒï¼Œä½ å¯ä»¥åœ¨ RStudio çš„å¯è§†åŒ–ç¼–è¾‘å™¨ä¸­ä½¿ç”¨\emph{Insert}
èœå•å¹¶é€‰æ‹©\emph{Figure / Image}ã€‚è¿™
å°†å¼¹å‡ºä¸€ä¸ªèœå•ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­æµè§ˆè¦æ’å…¥çš„å›¾åƒï¼Œå¹¶ä¸ºå…¶æ·»åŠ æ›¿ä»£æ–‡æœ¬æˆ–æ ‡é¢˜ï¼Œå¹¶è°ƒæ•´å…¶å¤§å°ã€‚åœ¨
å¯è§†åŒ–ç¼–è¾‘å™¨ä¸­ï¼Œä½ è¿˜å¯ä»¥ç›´æ¥ä»å‰ªè´´æ¿ä¸­ç²˜è´´å›¾åƒåˆ°æ–‡æ¡£ä¸­ï¼ŒRStudio
å°†åœ¨æ‚¨çš„é¡¹ç›®æ–‡ä»¶å¤¹ä¸­æ”¾ç½®è¯¥å›¾åƒçš„å‰¯æœ¬ã€‚

å¦‚æœä½ åŒ…å«ä¸€ä¸ªç”Ÿæˆå›¾å½¢çš„ä»£ç å—ï¼ˆä¾‹å¦‚åŒ…å« \texttt{ggplot()}
è°ƒç”¨ï¼‰ï¼Œç”Ÿæˆçš„å›¾å½¢å°†è‡ªåŠ¨åŒ…å«åœ¨æ‚¨çš„ Quarto æ–‡æ¡£ä¸­ã€‚

\subsection{å›¾å½¢å¤§å°è°ƒæ•´}\label{ux56feux5f62ux5927ux5c0fux8c03ux6574}

Quarto ä¸­åˆ¶å›¾çš„æœ€å¤§æŒ‘æˆ˜åœ¨äºä½¿ä½ çš„å›¾å½¢å…·æœ‰åˆé€‚çš„å°ºå¯¸å’Œå½¢çŠ¶ã€‚æ§
åˆ¶å›¾å½¢å¤§å°çš„é€‰é¡¹ä¸»è¦æœ‰äº”ä¸ªï¼š\texttt{fig-width}ã€\texttt{fig-height}ã€\texttt{fig-asp}ã€\texttt{out-width}
å’Œ \texttt{out-height}ã€‚å›¾ åƒå¤§å°è°ƒæ•´å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œå› ä¸ºå­˜åœ¨ä¸¤ç§å°ºå¯¸ï¼ˆR
åˆ›å»ºçš„å›¾å½¢å¤§å°å’Œå®ƒåœ¨è¾“å‡ºæ–‡æ¡£ä¸­æ’å…¥çš„å¤§å°ï¼‰ï¼Œä»¥åŠå¤šç§æŒ‡å®šå°ºå¯¸çš„æ–¹å¼ï¼ˆå³é«˜åº¦ã€å®½åº¦å’Œå®½é«˜æ¯”ï¼šä¸‰è€…é€‰äºŒï¼‰ã€‚

æˆ‘ä»¬æ¨èäº”ä¸ªé€‰é¡¹ä¸­çš„ä¸‰ä¸ªï¼š

\begin{itemize}
\item
  å¦‚æœå›¾å½¢å…·æœ‰ä¸€è‡´çš„å®½åº¦ï¼Œåˆ™å›¾å½¢åœ¨è§†è§‰ä¸Šä¼šæ›´åŠ èµå¿ƒæ‚¦ç›®ã€‚ä¸º
  æ­¤ï¼Œè¯·åœ¨é»˜è®¤è®¾ç½®ä¸­è®¾ç½® \texttt{fig-width}: 6ï¼ˆ6 è‹±å¯¸ï¼‰å’Œ
  \texttt{fig-asp}: 0.618ï¼ˆé»„é‡‘æ¯”ä¾‹ï¼‰ã€‚ç„¶ ååœ¨å•ç‹¬çš„ä»£ç å—ä¸­ä»…è°ƒæ•´
  \texttt{fig-asp}ã€‚
\item
  ä½¿ç”¨ \texttt{out-width}
  æ§åˆ¶è¾“å‡ºå¤§å°ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºè¾“å‡ºæ–‡æ¡£ä¸»ä½“å®½åº¦çš„ç™¾åˆ†æ¯”ã€‚æˆ‘ ä»¬å»ºè®®å°†
  \texttt{out-width} è®¾ç½®ä¸º``\texttt{70\%}''å¹¶å°† \texttt{fig-align}
  è®¾ç½®ä¸º\texttt{center}ã€‚

  è¿™æ ·åšæ—¢ç»™å›¾å½¢æä¾›äº†è¶³å¤Ÿçš„ç©ºé—´ï¼Œåˆä¸ä¼šå ç”¨å¤ªå¤šç©ºé—´ã€‚
\item
  è¦å°†å¤šä¸ªå›¾å½¢æ”¾åœ¨åŒä¸€è¡Œä¸­ï¼Œè¯·å°† \texttt{layout-ncol} è®¾ç½®ä¸º
  2ï¼ˆä¸¤ä¸ªå›¾å½¢ï¼‰ã€3ï¼ˆä¸‰ä¸ªå›¾å½¢ï¼‰ç­‰ã€‚å¦‚ æœ \texttt{layout-ncol} ä¸º
  2ï¼Œè¿™å°†æœ‰æ•ˆåœ°å°†æ¯ä¸ªå›¾å½¢çš„ \texttt{out-width} è®¾ç½®ä¸º``50\%''ï¼Œå¦‚æœ
  \texttt{layout-ncol} ä¸º 3ï¼Œåˆ™è®¾ç½®ä¸º``33\%''ï¼Œä¾æ­¤ç±»æ¨ã€‚æ ¹
  æ®ä½ æƒ³è¦è¯´æ˜çš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œæ˜¾ç¤ºæ•°æ®æˆ–æ˜¾ç¤ºå›¾å½¢å˜åŒ–ï¼‰ï¼Œå¯èƒ½è¿˜éœ€è¦è°ƒæ•´
  \texttt{fig-width}ï¼Œå¦‚ä¸‹æ‰€è¿°ã€‚
\end{itemize}

å¦‚æœæ‚¨å‘ç°éœ€è¦çœ¯èµ·çœ¼ç›æ‰èƒ½é˜…è¯»å›¾å½¢ä¸­çš„æ–‡æœ¬ï¼Œåˆ™éœ€è¦è°ƒæ•´
\texttt{fig-width}ã€‚å¦‚ æœ \texttt{fig-width}
å¤§äºå›¾å½¢åœ¨æœ€ç»ˆæ–‡æ¡£ä¸­å‘ˆç°çš„å¤§å°ï¼Œåˆ™æ–‡æœ¬å°†å¤ªå°ï¼›å¦‚æœ \texttt{fig-width}
è¾ƒå°ï¼Œåˆ™æ–‡æœ¬å°†å¤ªå¤§ã€‚æ‚¨ é€šå¸¸éœ€è¦è¿›è¡Œä¸€äº›å°è¯•ï¼Œä»¥ç¡®å®š \texttt{fig-width}
ä¸æ–‡æ¡£ä¸­æœ€ç»ˆå®½åº¦çš„æ­£ç¡®æ¯”ä¾‹ã€‚ä¸º äº†è¯´æ˜è¿™ä¸€ç‚¹ï¼Œä»¥ä¸‹ä¸‰ä¸ªå›¾å½¢çš„
\texttt{fig-width} åˆ†åˆ«ä¸º 4ã€6 å’Œ 8ï¼š

\includegraphics[width=0.5\textwidth,height=\textheight]{quarto_files/figure-pdf/unnamed-chunk-15-1.pdf}

\includegraphics[width=0.5\textwidth,height=\textheight]{quarto_files/figure-pdf/unnamed-chunk-16-1.pdf}

\includegraphics[width=0.5\textwidth,height=\textheight]{quarto_files/figure-pdf/unnamed-chunk-17-1.pdf}

å¦‚æœä½ æƒ³ç¡®ä¿æ‰€æœ‰å›¾ä¸­çš„å­—ä½“å¤§å°ä¸€è‡´ï¼Œæ¯æ¬¡è®¾ç½®\texttt{out-width}æ—¶ï¼Œä½ ä¹Ÿéœ€è¦è°ƒæ•´\texttt{fig-width}ä»¥ä¿æŒä¸é»˜è®¤\texttt{out-width}çš„ç›¸åŒæ¯”ä¾‹ã€‚ä¾‹
å¦‚ï¼Œå¦‚æœä½ çš„é»˜è®¤\texttt{fig-width}æ˜¯6ï¼Œ\texttt{out-width}æ˜¯``70\%''ï¼Œå½“ä½ å°†\texttt{out-width}è®¾ç½®ä¸º``50\%''æ—¶ï¼Œä½ éœ€è¦å°†\texttt{fig-width}
è®¾ç½®ä¸º4.3ï¼ˆ6 * 0.5 / 0.7ï¼‰ã€‚

å›¾å½¢å¤§å°è°ƒæ•´å’Œç¼©æ”¾æ—¢æ˜¯ä¸€é—¨è‰ºæœ¯ä¹Ÿæ˜¯ä¸€é—¨ç§‘å­¦ï¼Œè¦åšåˆ°å‡†ç¡®æ— è¯¯å¯èƒ½éœ€è¦åå¤å°è¯•å’Œä¿®æ”¹ã€‚ä½ 
å¯ä»¥åœ¨\href{https://www.tidyverse.org/blog/2020/08/taking-control-of-plot-scaling/}{taking
control of plot scaling blog post}ä¸­äº†è§£æ›´å¤šå…³äºå›¾å½¢å¤§å°è°ƒæ•´çš„ä¿¡æ¯ã€‚

\subsection{å…¶ä»–é‡è¦é€‰é¡¹}\label{ux5176ux4ed6ux91cdux8981ux9009ux9879}

åœ¨æœ¬ä¹¦ä¸­ï¼Œå½“å°†ä»£ç å’Œæ–‡æœ¬æ··åˆä½¿ç”¨æ—¶ï¼Œä½ å¯ä»¥è®¾ç½®\texttt{fig-show:\ hold}ä»¥ä¾¿åœ¨ä»£ç ä¹‹åæ˜¾ç¤ºå›¾å½¢ã€‚è¿™
æ ·åšçš„å¦ä¸€ä¸ªç§¯ææ•ˆæœæ˜¯ï¼Œå³è¿«ä½¿ä½ å°†å¤§å—çš„ä»£ç ä¸å…¶æ³¨é‡Šåˆ†å¼€ï¼Œä»è€Œæé«˜ä»£ç çš„å¯è¯»æ€§ã€‚

è¦ç»™å›¾è¡¨æ·»åŠ æ ‡é¢˜ï¼Œè¯·ä½¿ç”¨\texttt{fig-cap}ã€‚åœ¨ Quarto
ä¸­ï¼Œè¿™å°†ä½¿å›¾ä»å†…è”å˜ä¸º``æµ®åŠ¨''ã€‚

å¦‚æœä½ æ­£åœ¨ç”Ÿæˆ PDF è¾“å‡ºï¼Œé»˜è®¤çš„å›¾å½¢ç±»å‹æ˜¯ PDFã€‚è¿™
æ˜¯ä¸€ä¸ªå¥½çš„é»˜è®¤è®¾ç½®ï¼Œå› ä¸º PDF æ˜¯é«˜è´¨é‡çš„çŸ¢é‡å›¾å½¢ã€‚ä½†
æ˜¯ï¼Œå¦‚æœä½ æ˜¾ç¤ºæ•°åƒä¸ªç‚¹ï¼Œå®ƒä»¬å¯èƒ½ä¼šäº§ç”Ÿéå¸¸å¤§ä¸”ç¼“æ…¢çš„å›¾å½¢ã€‚åœ¨
è¿™ç§æƒ…å†µä¸‹ï¼Œè®¾ç½®\texttt{fig-format:\ "png"}ä»¥å¼ºåˆ¶ä½¿ç”¨ PNG æ ¼å¼ã€‚è™½ ç„¶
PNG çš„è´¨é‡ç¨ä½ï¼Œä½†ä¼šæ›´åŠ ç´§å‡‘ã€‚

ç»™ç”Ÿæˆå›¾å½¢çš„ä»£ç å—å‘½åæ˜¯ä¸ªå¥½ä¸»æ„ï¼Œå³ä½¿ä½ ä¸ç»å¸¸ä¸ºå…¶ä»–ä»£ç å—è´´æ ‡ç­¾ã€‚ä»£
ç å—æ ‡ç­¾ç”¨äºåœ¨ç£ç›˜ä¸Šç”Ÿæˆå›¾å½¢æ–‡ä»¶çš„åç§°ï¼Œå› æ­¤å‘½åä½ çš„ä»£ç å—ä¼šä½¿åœ¨å…¶ä»–æƒ…å†µä¸‹é€‰æ‹©å›¾å½¢å¹¶é‡å¤ä½¿ç”¨å˜å¾—æ›´åŠ å®¹æ˜“ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³å¿«é€Ÿå°†ä¸€ä¸ªå›¾å½¢æ”¾å…¥ç”µå­é‚®ä»¶ä¸­ï¼‰ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-70}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  åœ¨å¯è§†åŒ–ç¼–è¾‘å™¨ä¸­æ‰“å¼€ \texttt{diamond-sizes.qmd}
  æ–‡ä»¶ï¼Œæ‰¾åˆ°ä¸€é¢—é’»çŸ³çš„å›¾ç‰‡ï¼Œå¤åˆ¶å¹¶ç²˜è´´åˆ°æ–‡æ¡£ä¸­ã€‚åŒå‡»å›¾ç‰‡å¹¶æ·»åŠ æ ‡é¢˜ã€‚è°ƒæ•´å›¾ç‰‡å¤§å°å¹¶æ¸²æŸ“ä½ çš„æ–‡æ¡£ã€‚è§‚å¯Ÿå›¾ç‰‡æ˜¯å¦‚ä½•ä¿å­˜åœ¨ä½ å½“å‰çš„å·¥ä½œç›®å½•ä¸­çš„ã€‚
\item
  ç¼–è¾‘ \texttt{diamond-sizes.qmd} ä¸­ç”Ÿæˆå›¾å½¢çš„ä»£ç å—æ ‡ç­¾ï¼Œä½¿å…¶ä»¥
  \texttt{fig-} ä¸ºå‰ç¼€ï¼Œå¹¶ä½¿ç”¨ chunk é€‰é¡¹ \texttt{fig-cap}
  ä¸ºå›¾å½¢æ·»åŠ æ ‡é¢˜ã€‚ç„¶åï¼Œç¼–è¾‘ä»£ç å—ä¸Šæ–¹çš„æ–‡æœ¬ï¼Œä½¿ç”¨\emph{Insert
  \textgreater{} Cross Reference}æ¥æ·»åŠ å¯¹è¯¥å›¾å½¢çš„äº¤å‰å¼•ç”¨ã€‚
\item
  ä½¿ç”¨ä»¥ä¸‹ chunk
  é€‰é¡¹é€ä¸€æ›´æ”¹å›¾å½¢å¤§å°ï¼Œæ¸²æŸ“ä½ çš„æ–‡æ¡£å¹¶æè¿°å›¾å½¢æ˜¯å¦‚ä½•å˜åŒ–çš„ã€‚

  \begin{enumerate}
  \def\labelenumii{\alph{enumii}.}
  \item
    \texttt{fig-width:\ 10}
  \item
    \texttt{fig-height:\ 3}
  \item
    \texttt{out-width:\ "100\%"}
  \item
    \texttt{out-width:\ "20\%"}
  \end{enumerate}
\end{enumerate}

\section{è¡¨æ ¼}\label{ux8868ux683c-1}

ä¸å›¾å½¢ç±»ä¼¼ï¼Œä½ å¯ä»¥åœ¨ Quarto æ–‡æ¡£ä¸­åŒ…å«ä¸¤ç§ç±»å‹çš„è¡¨æ ¼ã€‚å®ƒ ä»¬å¯ä»¥æ˜¯ä½ åœ¨
Quarto æ–‡æ¡£ä¸­ç›´æ¥åˆ›å»ºçš„ Markdown è¡¨æ ¼ï¼ˆä½¿ç”¨\emph{Insert
Table}èœå•ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯ä»£ç å—æ‰§è¡Œç»“æœç”Ÿæˆçš„è¡¨æ ¼ã€‚åœ¨
æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹å…³æ³¨åè€…ï¼Œå³é€šè¿‡è®¡ç®—ç”Ÿæˆçš„è¡¨æ ¼ã€‚

é»˜è®¤æƒ…å†µä¸‹ï¼ŒQuarto ä¼šä»¥ä½ åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°çš„æ–¹å¼æ˜¾ç¤ºæ•°æ®æ¡†å’ŒçŸ©é˜µï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mtcars[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{, ]}
\CommentTok{\#\textgreater{}                    mpg cyl disp  hp drat    wt  qsec vs am gear carb}
\CommentTok{\#\textgreater{} Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4}
\CommentTok{\#\textgreater{} Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4}
\CommentTok{\#\textgreater{} Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1}
\CommentTok{\#\textgreater{} Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1}
\CommentTok{\#\textgreater{} Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2}
\end{Highlighting}
\end{Shaded}

å¦‚æœä½ å¸Œæœ›æ•°æ®ä»¥å…¶ä»–çš„æ ¼å¼æ˜¾ç¤ºï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{knitr::kable()}å‡½æ•°ã€‚ä¸‹
é¢çš„ä»£ç ç”Ÿæˆäº†@tbl-kable ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{knitr}\SpecialCharTok{::}\FunctionTok{kable}\NormalTok{(mtcars[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{, ], )}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.2609}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0725}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0580}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0725}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0580}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0725}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0870}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0870}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0435}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0435}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0725}}
  >{\raggedleft\arraybackslash}p{(\columnwidth - 22\tabcolsep) * \real{0.0725}}@{}}

\caption{\label{tbl-kable}A knitr kable.}

\tabularnewline

\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
mpg
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
cyl
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
disp
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
hp
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
drat
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
wt
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
qsec
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
vs
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
am
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
gear
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedleft
carb
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Mazda RX4 & 21.0 & 6 & 160 & 110 & 3.90 & 2.620 & 16.46 & 0 & 1 & 4 &
4 \\
Mazda RX4 Wag & 21.0 & 6 & 160 & 110 & 3.90 & 2.875 & 17.02 & 0 & 1 & 4
& 4 \\
Datsun 710 & 22.8 & 4 & 108 & 93 & 3.85 & 2.320 & 18.61 & 1 & 1 & 4 &
1 \\
Hornet 4 Drive & 21.4 & 6 & 258 & 110 & 3.08 & 3.215 & 19.44 & 1 & 0 & 3
& 1 \\
Hornet Sportabout & 18.7 & 8 & 360 & 175 & 3.15 & 3.440 & 17.02 & 0 & 0
& 3 & 2 \\

\end{longtable}

æŸ¥é˜…\texttt{?knitr::kable}çš„æ–‡æ¡£ä»¥äº†è§£ä½ å¯ä»¥è‡ªå®šä¹‰è¡¨æ ¼çš„å…¶ä»–æ–¹å¼ã€‚å¯¹
äºæ›´æ·±å…¥çš„è‡ªå®šä¹‰ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨
\textbf{gt}ã€\textbf{huxtable}ã€\textbf{reactable}ã€\textbf{kableExtra}ã€\textbf{xtable}ã€\textbf{stargazer}ã€\textbf{pander}ã€\textbf{tables}
å’Œ \textbf{ascii} è¿™äº›åŒ…ã€‚æ¯ ä¸ªåŒ…éƒ½æä¾›äº†ä¸€ç»„å·¥å…·ï¼Œç”¨äºä» R
ä»£ç ä¸­è¿”å›æ ¼å¼åŒ–çš„è¡¨æ ¼ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-71}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  åœ¨å¯è§†åŒ–ç¼–è¾‘å™¨ä¸­æ‰“å¼€ \texttt{diamond-sizes.qmd}
  æ–‡ä»¶ï¼Œæ’å…¥ä¸€ä¸ªä»£ç å—ï¼Œå¹¶ä½¿ç”¨\texttt{knitr::kable()}æ·»åŠ ä¸€ä¸ªè¡¨æ ¼ï¼Œæ˜¾ç¤º
  \texttt{diamonds} æ•°æ®æ¡†çš„å‰ 5 è¡Œã€‚
\item
  ä½¿ç”¨~\texttt{gt::gt()}~æ¥æ˜¾ç¤ºç›¸åŒçš„è¡¨æ ¼ã€‚
\item
  ä¸ºä»£ç å—æ·»åŠ ä¸€ä¸ªä»¥ \texttt{tbl-} ä¸ºå‰ç¼€çš„æ ‡ç­¾ï¼Œå¹¶ä½¿ç”¨ chunk é€‰é¡¹
  \texttt{tbl-cap}
  ä¸ºè¡¨æ ¼æ·»åŠ æ ‡é¢˜ã€‚ç„¶åï¼Œç¼–è¾‘ä»£ç å—ä¸Šæ–¹çš„æ–‡æœ¬ï¼Œä½¿ç”¨\emph{Insert
  \textgreater{} Cross Reference}ä¸ºè¡¨æ ¼æ·»åŠ äº¤å‰å¼•ç”¨ã€‚
\end{enumerate}

\section{ç¼“å­˜}\label{sec-caching}

é€šå¸¸ï¼Œæ¯æ¬¡æ¸²æŸ“æ–‡æ¡£æ—¶éƒ½ä¼šä»å¤´å¼€å§‹ï¼Œå®Œå…¨ä¸ä¾èµ–ä¹‹å‰çš„ä»»ä½•çŠ¶æ€ã€‚è¿™
å¯¹äºå¯é‡å¤æ€§æ¥è¯´å¾ˆæ£’ï¼Œå› ä¸ºå®ƒç¡®ä¿ä½ å·²ç»å°†æ‰€æœ‰é‡è¦çš„è®¡ç®—éƒ½è®°å½•åœ¨ä»£ç ä¸­ã€‚ä½†
æ˜¯ï¼Œå¦‚æœä½ æœ‰ä¸€äº›éœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½å®Œæˆçš„è®¡ç®—ï¼Œè¿™å¯èƒ½ä¼šå¾ˆä»¤äººå¤´ç–¼ã€‚è§£
å†³æ–¹æ¡ˆæ˜¯è®¾ç½®\texttt{cache:\ true}ã€‚

ä½ å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ YAML é€‰é¡¹åœ¨æ–‡æ¡£çº§åˆ«å¯ç”¨ Knitr
ç¼“å­˜ï¼Œä»¥ç¼“å­˜æ–‡æ¡£ä¸­æ‰€æœ‰è®¡ç®—çš„ç»“æœï¼š

\begin{Shaded}
\begin{Highlighting}[]
\PreprocessorTok{{-}{-}{-}}
\FunctionTok{title}\KeywordTok{:}\AttributeTok{ }\StringTok{"My Document"}
\FunctionTok{execute}\KeywordTok{:}\AttributeTok{ }
\AttributeTok{  }\FunctionTok{cache}\KeywordTok{:}\AttributeTok{ }\CharTok{true}
\PreprocessorTok{{-}{-}{-}}
\end{Highlighting}
\end{Shaded}

ä½ ä¹Ÿå¯ä»¥åœ¨å—çº§åˆ«å¯ç”¨ç¼“å­˜ï¼Œä»¥ä¾¿åœ¨ç‰¹å®šå—ä¸­ç¼“å­˜è®¡ç®—ç»“æœ:

\begin{Shaded}
\begin{Highlighting}[]
\InformationTok{\textasciigrave{}\textasciigrave{}\textasciigrave{}\{r\}}
\InformationTok{\#| cache: true}

\InformationTok{\# code for lengthy computation...}
\InformationTok{\textasciigrave{}\textasciigrave{}\textasciigrave{}}
\end{Highlighting}
\end{Shaded}

è®¾ç½®åï¼Œè¿™å°†æŠŠä»£ç å—çš„è¾“å‡ºä¿å­˜åˆ°ç£ç›˜ä¸Šä¸€ä¸ªç‰¹åˆ«å‘½åçš„æ–‡ä»¶ä¸­ã€‚åœ¨
åç»­çš„è¿è¡Œä¸­ï¼Œknitr
ä¼šæ£€æŸ¥ä»£ç æ˜¯å¦å‘ç”Ÿäº†æ”¹å˜ï¼Œå¦‚æœæ²¡æœ‰æ”¹å˜ï¼Œå®ƒå°†é‡ç”¨ç¼“å­˜çš„ç»“æœã€‚

ä½¿ç”¨ç¼“å­˜ç³»ç»Ÿæ—¶éœ€è¦è°¨æ…ï¼Œå› ä¸ºé»˜è®¤æƒ…å†µä¸‹å®ƒä»…åŸºäºä»£ç æœ¬èº«è€Œä¸æ˜¯å…¶ä¾èµ–é¡¹ã€‚ä¾‹
å¦‚ï¼Œè¿™é‡Œçš„ \texttt{processed\_data} ä»£ç å—ä¾èµ–äº \texttt{raw-data}
ä»£ç å—ï¼š

\begin{verbatim}
``` {{r}}
#| label: raw-data
#| cache: true

rawdata <- readr::read_csv("a_very_large_file.csv")
```
\end{verbatim}

\begin{verbatim}
``` {{r}}
#| label: processed_data
#| cache: true

processed_data <- rawdata |> 
  filter(!is.na(import_var)) |> 
  mutate(new_variable = complicated_transformation(x, y, z))
```
\end{verbatim}

ç¼“å­˜ \texttt{processed\_data} ä»£ç å—æ„å‘³ç€ï¼Œå¦‚æœ dplyr
ç®¡é“å‘ç”Ÿäº†æ”¹å˜ï¼Œå®ƒå°†ä¼šé‡æ–°è¿è¡Œï¼Œä½†å¦‚æœ \texttt{read\_csv()}
è°ƒç”¨å‘ç”Ÿäº†æ”¹å˜ï¼Œå®ƒåˆ™ä¸ä¼šé‡æ–°è¿è¡Œã€‚ä½  å¯ä»¥é€šè¿‡ \texttt{dependson} chunk
é€‰é¡¹æ¥é¿å…è¿™ä¸ªé—®é¢˜ï¼š

\begin{verbatim}
``` {{r}}
#| label: processed-data
#| cache: true
#| dependson: "raw-data"

processed_data <- rawdata |> 
  filter(!is.na(import_var)) |> 
  mutate(new_variable = complicated_transformation(x, y, z))
```
\end{verbatim}

\texttt{dependson}åº”è¯¥åŒ…å«ä¸€ä¸ªå­—ç¬¦å‘é‡ï¼ŒåŒ…å«ç¼“å­˜ä»£ç å—æ‰€ä¾èµ–çš„æ¯ä¸ªä»£ç å—çš„åç§°ã€‚æ¯
å½“ knitr æ£€æµ‹åˆ°å…¶ä¸­ä¸€ä¸ªä¾èµ–é¡¹å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒå°±ä¼šæ›´æ–°ç¼“å­˜ä»£ç å—çš„ç»“æœã€‚

è¯·æ³¨æ„ï¼Œå¦‚æœ\texttt{a\_very\_large\_file.csv}æ–‡ä»¶å‘ç”Ÿå˜åŒ–ï¼Œä»£ç å—å°†ä¸ä¼šæ›´æ–°ï¼Œå› ä¸º
knitr ç¼“å­˜åªè·Ÿè¸ª\texttt{.qmd}æ–‡ä»¶å†…çš„å˜åŒ–ã€‚å¦‚
æœä½ ä¹Ÿæƒ³è·Ÿè¸ªè¯¥æ–‡ä»¶çš„æ›´æ”¹ï¼Œä½ å¯ä»¥ä½¿ç”¨\texttt{cache.extra}é€‰é¡¹ã€‚è¿™
æ˜¯ä¸€ä¸ªä»»æ„çš„ R è¡¨è¾¾å¼ï¼Œå½“å…¶å‘ç”Ÿå˜åŒ–æ—¶ä¼šä½¿ç¼“å­˜å¤±æ•ˆã€‚ä¸€
ä¸ªå¾ˆå¥½çš„å‡½æ•°æ˜¯\texttt{file.mtime()}ï¼šå®ƒè¿”å›æ–‡ä»¶æœ€åä¸€æ¬¡ä¿®æ”¹çš„æ—¶é—´ã€‚ç„¶
åä½ å¯ä»¥è¿™æ ·å†™ï¼š

\begin{verbatim}
``` {{r}}
#| label: raw-data
#| cache: true
#| cache.extra: !expr file.mtime("a_very_large_file.csv")

rawdata <- readr::read_csv("a_very_large_file.csv")
```
\end{verbatim}

æˆ‘ä»¬éµå¾ªäº†
\href{https://twitter.com/drob/status/738786604731490304}{David
Robinson}
çš„å»ºè®®æ¥å‘½åè¿™äº›ä»£ç å—ï¼šæ¯ä¸ªä»£ç å—éƒ½ä»¥å®ƒæ‰€åˆ›å»ºçš„ä¸»è¦å¯¹è±¡å‘½åã€‚è¿™
ä½¿å¾—ç†è§£\texttt{dependson}è§„èŒƒå˜å¾—æ›´åŠ å®¹æ˜“ã€‚

éšç€ä½ çš„ç¼“å­˜ç­–ç•¥é€æ¸å˜å¾—æ›´åŠ å¤æ‚ï¼Œå®šæœŸä½¿ç”¨\texttt{knitr::clean\_cache()}æ¸…é™¤æ‰€æœ‰ç¼“å­˜æ˜¯ä¸€ä¸ªæ˜æ™ºçš„é€‰æ‹©ã€‚

\subsection{ç»ƒä¹ }\label{ux7ec3ux4e60-72}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  å»ºç«‹ä¸€ä¸ªä»£ç å—çš„ç½‘ç»œï¼Œå…¶ä¸­ d ä¾èµ–äº c å’Œ bï¼Œè€Œ b å’Œ c éƒ½ä¾èµ–äº
  aã€‚è®©æ¯ä¸ªä»£ç å—éƒ½è¾“å‡º\texttt{lubridate::now()}ï¼Œè®¾ç½®\texttt{cache:\ true}ï¼Œç„¶åéªŒè¯ä½ å¯¹ç¼“å­˜çš„ç†è§£ã€‚
\end{enumerate}

\section{æ•…éšœæ’é™¤}\label{ux6545ux969cux6392ux9664}

Quarto æ–‡æ¡£çš„æ•…éšœæ’é™¤å¯èƒ½ä¼šå¾ˆæœ‰æŒ‘æˆ˜æ€§ï¼Œå› ä¸ºä½ ä¸å†å¤„äºäº¤äº’å¼çš„ R
ç¯å¢ƒä¸­ï¼Œéœ€è¦å­¦ä¹ ä¸€äº›æ–°çš„æŠ€å·§ã€‚æ­¤ å¤–ï¼Œé”™è¯¯å¯èƒ½æ˜¯ç”±äº Quarto
æ–‡æ¡£æœ¬èº«çš„é—®é¢˜ï¼Œæˆ–è€…æ˜¯ç”±äº Quarto æ–‡æ¡£ä¸­çš„ R ä»£ç å¼•èµ·çš„ã€‚

åœ¨åŒ…å«ä»£ç å—çš„æ–‡æ¡£ä¸­ï¼Œä¸€ä¸ªå¸¸è§çš„é”™è¯¯æ˜¯é‡å¤çš„å—æ ‡ç­¾ï¼Œè¿™åœ¨ä½ çš„å·¥ä½œæµç¨‹æ¶‰åŠå¤åˆ¶å’Œç²˜è´´ä»£ç å—æ—¶å°¤å…¶æ™®éã€‚è¦
è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ åªéœ€è¦æ›´æ”¹å…¶ä¸­ä¸€ä¸ªé‡å¤çš„æ ‡ç­¾ã€‚

å¦‚æœé”™è¯¯æ˜¯ç”±äºæ–‡æ¡£ä¸­çš„ R
ä»£ç å¼•èµ·çš„ï¼Œä½ åº”è¯¥é¦–å…ˆå°è¯•åœ¨äº¤äº’å¼ä¼šè¯ä¸­é‡ç°é—®é¢˜ã€‚é‡ å¯ Rï¼Œç„¶åRun all
chunksï¼Œå¯ä»¥ä»Code èœå•ä¸‹çš„Run regionè¿›è¡Œï¼Œæˆ–è€…ä½¿ç”¨å¿«æ·é”® Ctrl + Alt +
Rã€‚å¦‚
æœä½ å¹¸è¿çš„è¯ï¼Œè¿™å°†é‡ç°é—®é¢˜ï¼Œä½ å°±å¯ä»¥åœ¨äº¤äº’å¼ç¯å¢ƒä¸­å¼„æ¸…æ¥šå‘ç”Ÿäº†ä»€ä¹ˆã€‚

å¦‚æœè¿™ä¸èµ·ä½œç”¨ï¼Œä½ çš„äº¤äº’å¼ç¯å¢ƒå’Œ Quarto ç¯å¢ƒä¹‹é—´ä¸€å®šå­˜åœ¨æŸç§å·®å¼‚ã€‚ä½ 
éœ€è¦ç³»ç»Ÿåœ°æ¢ç´¢è¿™äº›é€‰é¡¹ã€‚æœ€ å¸¸è§çš„å·®å¼‚æ˜¯å·¥ä½œç›®å½•ï¼šQuarto
çš„å·¥ä½œç›®å½•æ˜¯å®ƒæ‰€åœ¨çš„ç›®å½•ã€‚é€š
è¿‡åœ¨å—ä¸­åŒ…å«\texttt{getwd()}æ¥æ£€æŸ¥å·¥ä½œç›®å½•æ˜¯å¦ç¬¦åˆä½ çš„é¢„æœŸã€‚

æ¥ä¸‹æ¥ï¼Œé›†æ€å¹¿ç›Šæ‰€æœ‰å¯èƒ½å¯¼è‡´é”™è¯¯çš„åŸå› ã€‚ä½  éœ€è¦ç³»ç»Ÿåœ°æ£€æŸ¥è¿™äº›è®¾ç½®åœ¨ä½ çš„
R ä¼šè¯å’Œ Quarto ä¼šè¯ä¸­æ˜¯å¦ç›¸åŒã€‚æœ€
ç®€å•çš„æ–¹æ³•æ˜¯è®¾ç½®å‡ºé—®é¢˜çš„å—çš„\texttt{error:\ true}ï¼Œç„¶åä½¿ç”¨\texttt{print()}å’Œ\texttt{str()}æ¥æ£€æŸ¥è®¾ç½®æ˜¯å¦ç¬¦åˆä½ çš„é¢„æœŸã€‚

\section{YAML}\label{yaml}

ä½ å¯ä»¥é€šè¿‡è°ƒæ•´ YAML å¤´éƒ¨çš„å‚æ•°æ¥æ§åˆ¶è®¸å¤šå…¶ä»–``æ•´ä¸ªæ–‡æ¡£''çš„è®¾ç½®ã€‚ä½ 
å¯èƒ½ä¼šå¥½å¥‡ YAML ä»£è¡¨ä»€ä¹ˆï¼šå®ƒæ˜¯``YAML Ain't Markup Language''ï¼ˆYAML
ä¸æ˜¯æ ‡è®°è¯­è¨€ï¼‰çš„ç¼©å†™ï¼Œæ—¨åœ¨ä»¥äººç±»æ˜“äºè¯»å†™çš„æ–¹å¼è¡¨ç¤ºå±‚æ¬¡ç»“æ„æ•°æ®ã€‚Q uarto
ä½¿ç”¨ YAML æ¥æ§åˆ¶è¾“å‡ºçš„è®¸å¤šç»†èŠ‚ã€‚åœ¨
è¿™é‡Œï¼Œæˆ‘ä»¬å°†è®¨è®ºå…¶ä¸­çš„ä¸‰ä¸ªï¼šè‡ªåŒ…å«æ–‡æ¡£ã€æ–‡æ¡£å‚æ•°å’Œå‚è€ƒæ–‡çŒ®ã€‚

\subsection{è‡ªåŒ…å«}\label{ux81eaux5305ux542b}

HTML æ–‡æ¡£é€šå¸¸æœ‰è®¸å¤šå¤–éƒ¨ä¾èµ–é¡¹ï¼ˆå¦‚å›¾åƒã€CSS æ ·å¼è¡¨å’ŒJavaScript ç­‰ï¼‰ã€‚é»˜
è®¤æƒ…å†µä¸‹Quarto ä¼šå°†è¿™äº›ä¾èµ–é¡¹æ”¾ç½®åœ¨ä¸ä½ çš„ \texttt{.qmd} æ–‡ä»¶ç›¸åŒç›®å½•ä¸‹çš„
\_files æ–‡ä»¶å¤¹ä¸­ã€‚å¦‚ æœä½ åœ¨ä¸€ä¸ªæ‰˜ç®¡å¹³å°ä¸Šå‘å¸ƒ HTML
æ–‡ä»¶ï¼ˆä¾‹å¦‚QuartoPubï¼Œ\url{https://quartopub.com/}ï¼‰ï¼Œè¯¥ç›®å½•ä¸­çš„ä¾èµ–é¡¹ä¼šéšä½ çš„æ–‡æ¡£ä¸€èµ·å‘å¸ƒï¼Œå› æ­¤åœ¨å‘å¸ƒçš„æŠ¥å‘Šä¸­æ˜¯å¯ç”¨çš„ã€‚ç„¶
è€Œï¼Œå¦‚æœä½ æƒ³æŠŠæŠ¥å‘Šé€šè¿‡ç”µå­é‚®ä»¶å‘é€ç»™åŒäº‹ï¼Œä½ å¯èƒ½ä¼šæ›´å–œæ¬¢ä¸€ä¸ªå•ä¸€çš„ã€è‡ªåŒ…å«çš„HTML
æ–‡æ¡£ï¼Œè¯¥æ–‡æ¡£åµŒå…¥äº†å…¶æ‰€æœ‰ä¾èµ–é¡¹ã€‚ä½  å¯ä»¥é€šè¿‡æŒ‡å®š \texttt{embed-resources}
é€‰é¡¹æ¥å®ç°è¿™ä¸€ç‚¹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{format}\KeywordTok{:}
\AttributeTok{  }\FunctionTok{html}\KeywordTok{:}
\AttributeTok{    }\FunctionTok{embed{-}resources}\KeywordTok{:}\AttributeTok{ }\CharTok{true}
\end{Highlighting}
\end{Shaded}

ç”Ÿæˆçš„æ–‡ä»¶å°†æ˜¯è‡ªåŒ…å«çš„ï¼Œå› æ­¤å®ƒä¸éœ€è¦ä»»ä½•å¤–éƒ¨æ–‡ä»¶ï¼Œä¹Ÿä¸éœ€è¦äº’è”ç½‘è¿æ¥å°±å¯ä»¥è¢«æµè§ˆå™¨æ­£ç¡®æ˜¾ç¤ºã€‚

\subsection{å‚æ•°}\label{ux53c2ux6570}

Quarto
æ–‡æ¡£å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ï¼Œè¿™äº›å‚æ•°çš„å€¼å¯ä»¥åœ¨ä½ æ¸²æŸ“æŠ¥å‘Šæ—¶è®¾ç½®ã€‚å½“
ä½ æƒ³è¦ä½¿ç”¨ä¸åŒçš„å…³é”®è¾“å…¥å€¼é‡æ–°æ¸²æŸ“ç›¸åŒçš„æŠ¥å‘Šæ—¶ï¼Œå‚æ•°ä¼šå¾ˆæœ‰ç”¨ã€‚ä¾‹
å¦‚ï¼Œä½ å¯èƒ½éœ€è¦ä¸ºæ¯ä¸ªåˆ†åº—ç”Ÿæˆé”€å”®æŠ¥å‘Šï¼ŒæŒ‰å­¦ç”Ÿç”Ÿæˆè€ƒè¯•æˆç»©ï¼Œæˆ–æŒ‰å›½å®¶ç”Ÿæˆäººå£ç»Ÿè®¡æ±‡æ€»ã€‚è¦
å£°æ˜ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ï¼Œè¯·ä½¿ç”¨ \texttt{params} å­—æ®µã€‚

è¿™ä¸ªç¤ºä¾‹ä½¿ç”¨äº†ä¸€ä¸ªåä¸º \texttt{my\_class}
çš„å‚æ•°æ¥ç¡®å®šè¦æ˜¾ç¤ºå“ªç§ç±»å‹çš„æ±½è½¦ï¼š

\begin{verbatim}
---
format: html
params:
  my_class: "suv"
---

```{r}
#| label: setup
#| include: false

library(tidyverse)

class <- mpg |> filter(class == params$my_class)
```

# Fuel economy for `r params$my_class`s

```{r}
#| message: false

ggplot(class, aes(x = displ, y = hwy)) + 
  geom_point() + 
  geom_smooth(se = FALSE)
```
\end{verbatim}

å¦‚ä½ æ‰€è§ï¼Œå‚æ•°åœ¨ä»£ç å—ä¸­ä½œä¸ºåä¸º\texttt{params}çš„åªè¯»åˆ—è¡¨å¯ç”¨ã€‚

ä½ å¯ä»¥ç›´æ¥åœ¨ YAML å¤´éƒ¨å†™å…¥åŸå­å‘é‡ã€‚ä½ 
ä¹Ÿå¯ä»¥é€šè¿‡åœ¨å‚æ•°å€¼å‰æ·»åŠ \texttt{!expr}æ¥è¿è¡Œä»»æ„çš„ R è¡¨è¾¾å¼ã€‚è¿™
æ˜¯æŒ‡å®šæ—¥æœŸ/æ—¶é—´å‚æ•°çš„å¥½æ–¹æ³•ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{params}\KeywordTok{:}
\AttributeTok{  }\FunctionTok{start}\KeywordTok{:}\AttributeTok{ !expr lubridate::ymd("2015{-}01{-}01")}
\AttributeTok{  }\FunctionTok{snapshot}\KeywordTok{:}\AttributeTok{ !expr lubridate::ymd\_hms("2015{-}01{-}01 12:30:00")}
\end{Highlighting}
\end{Shaded}

\subsection{å‚è€ƒæ–‡çŒ®å’Œå¼•æ–‡}\label{ux53c2ux8003ux6587ux732eux548cux5f15ux6587}

Quarto å¯ä»¥è‡ªåŠ¨ä»¥å¤šç§æ ·å¼ç”Ÿæˆå¼•æ–‡å’Œå‚è€ƒæ–‡çŒ®ã€‚å°† å¼•æ–‡å’Œå‚è€ƒæ–‡çŒ®æ·»åŠ åˆ°
Quarto æ–‡æ¡£çš„æœ€ç›´æ¥æ–¹æ³•æ˜¯ä½¿ç”¨ RStudio ä¸­çš„å¯è§†åŒ–ç¼–è¾‘å™¨ã€‚

è¦ä½¿ç”¨å¯è§†åŒ–ç¼–è¾‘å™¨æ·»åŠ å¼•æ–‡ï¼Œè¯·è½¬åˆ°\emph{Insert} \textgreater{}
\emph{Citation}ã€‚å¼• æ–‡å¯ä»¥ä»å¤šç§æ¥æºæ’å…¥ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \href{https://quarto.org/docs/visual-editor/technical.html\#citations-from-dois}{DOI}ï¼ˆæ–‡æ¡£å¯¹è±¡æ ‡è¯†ç¬¦ï¼‰å¼•ç”¨ã€‚
\item
  \href{https://quarto.org/docs/visual-editor/technical.html\#citations-from-zotero}{Zotero}
  ä¸ªäººæˆ–ç¾¤ç»„åº“ã€‚
\item
  \href{https://www.crossref.org/}{Crossref},
  \href{https://datacite.org/}{DataCite}, æˆ–
  \href{https://pubmed.ncbi.nlm.nih.gov/}{PubMed}. çš„æœç´¢ã€‚
\item
  ä½ çš„æ–‡æ¡£å‚è€ƒæ–‡çŒ®ï¼ˆä½äºæ–‡æ¡£ç›®å½•ä¸­çš„ \texttt{.bib} æ–‡ä»¶ï¼‰
\end{enumerate}

åœ¨å¹•åï¼Œå¯è§†åŒ–æ¨¡å¼ä½¿ç”¨ Pandoc æ ‡å‡†çš„ Markdown
å¼•æ–‡è¡¨ç¤ºæ³•ï¼ˆä¾‹å¦‚ï¼Œ\texttt{{[}@citation{]}}ï¼‰ã€‚

å¦‚æœä½ ä½¿ç”¨å‰ä¸‰ç§æ–¹æ³•ä¸­çš„ä»»ä½•ä¸€ç§æ·»åŠ å¼•æ–‡ï¼Œå¯è§†åŒ–ç¼–è¾‘å™¨å°†è‡ªåŠ¨ä¸ºä½ åˆ›å»ºä¸€ä¸ª
\texttt{bibliography.bib} æ–‡ä»¶ï¼Œå¹¶å°†å¼•ç”¨æ·»åŠ åˆ°å…¶ä¸­ã€‚å®ƒ è¿˜ä¼šåœ¨æ–‡æ¡£çš„ YAML
ä¸­æ·»åŠ ä¸€ä¸ª \texttt{bibliography} å­—æ®µã€‚éš
ç€ä½ æ·»åŠ æ›´å¤šçš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–‡ä»¶å°†ä¼šå¡«å……å®ƒä»¬çš„å¼•æ–‡ã€‚ä½ 
è¿˜å¯ä»¥ä½¿ç”¨è®¸å¤šå¸¸è§çš„å‚è€ƒæ–‡çŒ®æ ¼å¼ï¼ˆåŒ…æ‹¬
BibLaTeXã€BibTeXã€EndNoteã€Medlineï¼‰ç›´æ¥ç¼–è¾‘æ­¤æ–‡ä»¶ã€‚

è¦åœ¨æºä»£ç ç¼–è¾‘å™¨ä¸­çš„ .qmd æ–‡ä»¶ä¸­åˆ›å»ºå¼•æ–‡ï¼Œè¯·ä½¿ç”¨ç”± `@'
åŠ ä¸Šæ¥è‡ªå‚è€ƒæ–‡çŒ®æ–‡ä»¶çš„å¼•æ–‡æ ‡è¯†ç¬¦ç»„æˆçš„é”®ã€‚ç„¶ åå°†å¼•æ–‡æ”¾åœ¨æ–¹æ‹¬å·ä¸­ã€‚ä»¥
ä¸‹æ˜¯ä¸€äº›ç¤ºä¾‹ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{Separate multiple citations with a }\InformationTok{\textasciigrave{};\textasciigrave{}}\NormalTok{: Blah blah }\CommentTok{[}\OtherTok{@smith04; @doe99}\CommentTok{]}\NormalTok{.}

\NormalTok{You can add arbitrary comments inside the square brackets: }
\NormalTok{Blah blah }\CommentTok{[}\OtherTok{see @doe99, pp. 33{-}35; also @smith04, ch. 1}\CommentTok{]}\NormalTok{.}

\NormalTok{Remove the square brackets to create an in{-}text citation: @smith04 }
\NormalTok{says blah, or @smith04 }\CommentTok{[}\OtherTok{p. 33}\CommentTok{]}\NormalTok{ says blah.}

\NormalTok{Add a }\InformationTok{\textasciigrave{}{-}\textasciigrave{}}\NormalTok{ before the citation to suppress the author\textquotesingle{}s name: }
\NormalTok{Smith says blah }\CommentTok{[}\OtherTok{{-}@smith04}\CommentTok{]}\NormalTok{.}
\end{Highlighting}
\end{Shaded}

å½“ Quarto
æ¸²æŸ“ä½ çš„æ–‡ä»¶æ—¶ï¼Œå®ƒä¼šåœ¨ä½ çš„æ–‡æ¡£æœ«å°¾æ„å»ºå¹¶é™„åŠ ä¸€ä¸ªå‚è€ƒæ–‡çŒ®åˆ—è¡¨ã€‚è¿™
ä¸ªå‚è€ƒæ–‡çŒ®åˆ—è¡¨å°†åŒ…å«æ¥è‡ªä½ çš„å‚è€ƒæ–‡çŒ®æ–‡ä»¶çš„æ¯ä¸ªå¼•ç”¨ï¼Œä½†å®ƒä¸ä¼šåŒ…å«ç« èŠ‚æ ‡é¢˜ã€‚å› 
æ­¤ï¼Œå¸¸è§çš„åšæ³•æ˜¯åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä¸€ä¸ªå‚è€ƒæ–‡çŒ®çš„ç« èŠ‚æ ‡é¢˜ï¼Œå¦‚
\texttt{\#\ References} æˆ– \texttt{\#\ Bibliography}ã€‚

ä½ å¯ä»¥é€šè¿‡åœ¨ \texttt{csl} å­—æ®µä¸­å¼•ç”¨
CSLï¼ˆå¼•æ–‡æ ·å¼è¯­è¨€ï¼‰æ–‡ä»¶æ¥æ”¹å˜ä½ çš„å¼•æ–‡å’Œå‚è€ƒæ–‡çŒ®çš„æ ·å¼ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{bibliography}\KeywordTok{:}\AttributeTok{ rmarkdown.bib}
\FunctionTok{csl}\KeywordTok{:}\AttributeTok{ apa.csl}
\end{Highlighting}
\end{Shaded}

ä¸å‚è€ƒæ–‡çŒ®å­—æ®µä¸€æ ·ï¼Œä½ çš„ csl æ–‡ä»¶åº”è¯¥åŒ…å«è¯¥æ–‡ä»¶çš„è·¯å¾„ã€‚åœ¨ è¿™é‡Œï¼Œæˆ‘ä»¬å‡è®¾
csl æ–‡ä»¶ä¸ .qmd æ–‡ä»¶ä½äºåŒä¸€ç›®å½•ä¸‹ã€‚ä½ 
å¯ä»¥åœ¨\url{https://github.com/citation-style-language/styles}æ‰¾åˆ°å¸¸è§å‚è€ƒæ–‡çŒ®æ ·å¼çš„
CSL æ ·å¼æ–‡ä»¶ã€‚

\section{å·¥ä½œæµç¨‹}\label{ux5de5ux4f5cux6d41ux7a0b}

ä¹‹å‰ï¼Œæˆ‘ä»¬è®¨è®ºäº†åœ¨æ§åˆ¶å°ä¸­äº¤äº’å¼å·¥ä½œï¼Œç„¶ååœ¨è„šæœ¬ç¼–è¾‘å™¨ä¸­æ•è·æœ‰æ•ˆä»£ç çš„åŸºæœ¬å·¥ä½œæµç¨‹ã€‚Q
uarto
å°†æ§åˆ¶å°å’Œè„šæœ¬ç¼–è¾‘å™¨ç»“åˆåœ¨ä¸€èµ·ï¼Œæ¨¡ç³Šäº†äº¤äº’å¼æ¢ç´¢å’Œé•¿æœŸä»£ç æ•è·ä¹‹é—´çš„ç•Œé™ã€‚ä½ 
å¯ä»¥åœ¨ä»£ç å—ä¸­å¿«é€Ÿè¿­ä»£ï¼Œä½¿ç”¨ Cmd/Ctrl + Shift + Enter
è¿›è¡Œç¼–è¾‘å’Œé‡æ–°æ‰§è¡Œã€‚å½“ ä½ æ»¡æ„æ—¶ï¼Œä½ å¯ä»¥ç»§ç»­å¹¶å¼€å§‹ä¸€ä¸ªæ–°çš„ä»£ç å—ã€‚

Quarto ä¹Ÿéå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒå°†æ–‡æœ¬å’Œä»£ç ç´§å¯†åœ°ç»“åˆåœ¨ä¸€èµ·ã€‚è¿™
ä½¿å¾—å®ƒæˆä¸ºäº†ä¸€ä¸ªå‡ºè‰²çš„\textbf{åˆ†æç¬”è®°æœ¬}ï¼ˆanalysis
notebookï¼‰ï¼Œå› ä¸ºå®ƒå…è®¸ä½ å¼€å‘ä»£ç å¹¶è®°å½•ä½ çš„æƒ³æ³•ã€‚åˆ†
æç¬”è®°æœ¬ä¸ç‰©ç†ç§‘å­¦ä¸­çš„ç»å…¸å®éªŒç¬”è®°æœ¬æœ‰è®¸å¤šç›¸åŒçš„ç›®æ ‡ã€‚å®ƒ ï¼š

\begin{itemize}
\tightlist
\item
  è®°å½•äº†ä½ åšäº†ä»€ä¹ˆä»¥åŠä¸ºä»€ä¹ˆè¿™ä¹ˆåšã€‚æ— è®ºä½ çš„è®°å¿†åŠ›æœ‰å¤šå¥½ï¼Œå¦‚æœä½ ä¸è®°å½•ä½ çš„æ“ä½œï¼Œæ€»æœ‰ä¸€å¤©ä½ ä¼šå¿˜è®°é‡è¦çš„ç»†èŠ‚ã€‚æŠŠå®ƒä»¬å†™ä¸‹æ¥ï¼Œè¿™æ ·ä½ å°±ä¸ä¼šå¿˜è®°äº†ï¼
\item
  æ”¯æŒä¸¥è°¨çš„æ€ç»´ã€‚å¦‚æœä½ åœ¨è¿›è¡Œè¿‡ç¨‹ä¸­è®°å½•ä½ çš„æƒ³æ³•å¹¶ç»§ç»­åæ€å®ƒä»¬ï¼Œä½ æ›´æœ‰å¯èƒ½å¾—å‡ºå¼ºæœ‰åŠ›çš„åˆ†æã€‚è¿™ä¹Ÿä¼šåœ¨ä½ æœ€ç»ˆæ’°å†™åˆ†æå¹¶ä¸ä»–äººåˆ†äº«æ—¶èŠ‚çœä½ çš„æ—¶é—´ã€‚
\item
  å¸®åŠ©ä»–äººç†è§£ä½ çš„å·¥ä½œã€‚å¾ˆå°‘æœ‰äººä¼šå•ç‹¬è¿›è¡Œæ•°æ®åˆ†æï¼Œä½ é€šå¸¸ä¼šä½œä¸ºå›¢é˜Ÿçš„ä¸€éƒ¨åˆ†å·¥ä½œã€‚å®éªŒç¬”è®°æœ¬æœ‰åŠ©äºä½ ä¸åŒäº‹æˆ–å®éªŒå®¤ä¼™ä¼´åˆ†äº«ä½ æ‰€åšçš„å·¥ä½œä»¥åŠä¸ºä»€ä¹ˆè¿™ä¹ˆåšã€‚
\end{itemize}

å¦‚ä½•æœ‰æ•ˆä½¿ç”¨å®éªŒç¬”è®°æœ¬çš„å¤§éƒ¨åˆ†å¥½å»ºè®®ä¹Ÿé€‚ç”¨äºåˆ†æç¬”è®°æœ¬ã€‚æˆ‘
ä»¬æ ¹æ®è‡ªå·±çš„ç»éªŒå’Œ Colin Purrington
å…³äºå®éªŒç¬”è®°æœ¬çš„å»ºè®®ï¼ˆ\url{https://colinpurrington.com/tips/lab-notebooks}ï¼‰ï¼Œæå‡ºä»¥ä¸‹å»ºè®®ï¼š

\begin{itemize}
\item
  ç¡®ä¿æ¯ä¸ªç¬”è®°æœ¬éƒ½æœ‰ä¸€ä¸ªæè¿°æ€§çš„æ ‡é¢˜ã€ä¸€ä¸ªå¼•äººæ³¨ç›®çš„æ–‡ä»¶åä»¥åŠä¸€ä¸ªç®€è¦æè¿°åˆ†æç›®æ ‡çš„ç¬¬ä¸€æ®µã€‚
\item
  ä½¿ç”¨ YAML å¤´éƒ¨ä¸­çš„æ—¥æœŸå­—æ®µæ¥è®°å½•ä½ å¼€å§‹åœ¨è¯¥ç¬”è®°æœ¬ä¸Šå·¥ä½œçš„æ—¥æœŸï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{date}\KeywordTok{:}\AttributeTok{ 2016{-}08{-}23}
\end{Highlighting}
\end{Shaded}

  ä½¿ç”¨ ISO8601 YYYY-MM-DD æ ¼å¼æ¥ç¡®ä¿æ²¡æœ‰æ­§ä¹‰ã€‚å³
  ä½¿ä½ é€šå¸¸ä¸è¿™æ ·å†™æ—¥æœŸï¼Œä¹Ÿè¯·ä½¿ç”¨è¿™ç§æ ¼å¼ï¼
\item
  å¦‚æœä½ åœ¨ä¸€ä¸ªåˆ†ææƒ³æ³•ä¸ŠèŠ±è´¹äº†å¾ˆå¤šæ—¶é—´ï¼Œä½†å®ƒæœ€ç»ˆæ˜¯æ¡æ­»èƒ¡åŒï¼Œä¸è¦åˆ é™¤å®ƒï¼å†™
  ä¸€æ®µç®€çŸ­çš„è¯´æ˜è§£é‡Šä¸ºä»€ä¹ˆå®ƒå¤±è´¥äº†ï¼Œå¹¶æŠŠå®ƒç•™åœ¨ç¬”è®°æœ¬é‡Œã€‚è¿™
  å°†æœ‰åŠ©äºä½ åœ¨æœªæ¥å†æ¬¡è¿›è¡Œè¯¥åˆ†ææ—¶é¿å…èµ°è¿›ç›¸åŒçš„æ­»èƒ¡åŒã€‚
\item
  é€šå¸¸ï¼Œæœ€å¥½åœ¨ R ä¹‹å¤–è¿›è¡Œæ•°æ®è¾“å…¥ã€‚ä½†
  å¦‚æœä½ ç¡®å®éœ€è¦è®°å½•ä¸€å°æ®µæ•°æ®ï¼Œè¯·ä½¿ç”¨\texttt{tibble::tribble()}æ¸…æ™°åœ°å¸ƒå±€å®ƒã€‚
\item
  å¦‚æœä½ å‘ç°æ•°æ®æ–‡ä»¶ä¸­å­˜åœ¨é”™è¯¯ï¼Œæ°¸è¿œä¸è¦ç›´æ¥ä¿®æ”¹å®ƒï¼Œè€Œæ˜¯ç¼–å†™ä»£ç æ¥çº æ­£è¯¥å€¼ã€‚è¯´
  æ˜ä½ ä¸ºä½•è¿›è¡Œæ­¤ä¿®å¤ã€‚
\item
  åœ¨ä¸€å¤©ç»“æŸå‰ï¼Œç¡®ä¿ä½ å¯ä»¥æ¸²æŸ“ç¬”è®°æœ¬ã€‚å¦‚
  æœä½ åœ¨ä½¿ç”¨ç¼“å­˜ï¼Œè¯·ç¡®ä¿æ¸…é™¤ç¼“å­˜ã€‚è¿™
  æ ·ï¼Œå½“ä»£ç ä»ç„¶åœ¨ä½ è„‘æµ·ä¸­æ—¶ï¼Œä½ å°±å¯ä»¥ä¿®å¤ä»»ä½•é—®é¢˜ã€‚
\item
  å¦‚æœä½ æƒ³è®©ä½ çš„ä»£ç åœ¨é•¿è¿œæ¥çœ‹æ˜¯å¯é‡å¤çš„ï¼ˆå³ä½ å¯ä»¥åœ¨æœªæ¥å‡ ä¸ªæœˆæˆ–å‡ å¹´å†…å›æ¥è¿è¡Œå®ƒï¼‰ï¼Œä½ éœ€è¦è·Ÿè¸ªä½ çš„ä»£ç æ‰€ä½¿ç”¨çš„åŒ…çš„ç‰ˆæœ¬ã€‚ä¸€
  ç§ä¸¥æ ¼çš„æ–¹æ³•æ˜¯ä½¿ç”¨\texttt{renv}ï¼ˆ\url{https://rstudio.github.io/renv/index.html}ï¼‰ï¼Œå®ƒå°†åŒ…å­˜å‚¨åœ¨ä½ çš„é¡¹ç›®ç›®å½•ä¸­ã€‚ä¸€
  ä¸ªå¿«é€Ÿè€Œç®€å•çš„æ–¹æ³•æ˜¯åŒ…å«ä¸€ä¸ªè¿è¡Œ\texttt{sessionInfo()}çš„ä»£ç å—------è™½ç„¶è¿™ä¸ä¼šè®©ä½ è½»æ¾åœ°é‡æ–°åˆ›å»ºä»Šå¤©çš„åŒ…ï¼Œä½†è‡³å°‘ä½ ä¼šçŸ¥é“å®ƒä»¬æ˜¯ä»€ä¹ˆã€‚
\item
  åœ¨ä½ çš„èŒä¸šç”Ÿæ¶¯ä¸­ï¼Œä½ å°†åˆ›å»ºå¾ˆå¤šã€å¾ˆå¤šã€å¾ˆå¤šçš„åˆ†æç¬”è®°æœ¬ã€‚ä½ 
  å°†å¦‚ä½•ç»„ç»‡å®ƒä»¬ä»¥ä¾¿å°†æ¥èƒ½å¤Ÿå†æ¬¡æ‰¾åˆ°å®ƒä»¬ï¼Ÿæˆ‘
  ä»¬å»ºè®®å°†å®ƒä»¬å­˜å‚¨åœ¨å•ç‹¬çš„é¡¹ç›®ä¸­ï¼Œå¹¶æƒ³å‡ºä¸€ä¸ªå¥½çš„å‘½åæ–¹æ¡ˆã€‚
\end{itemize}

\section{å°ç»“}\label{ux5c0fux7ed3-27}

åœ¨è¿™ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å‘ä½ ä»‹ç»äº†Quartoï¼Œç”¨äºç¼–å†™å’Œå‘å¸ƒå¯é‡å¤è®¡ç®—çš„æ–‡æ¡£ï¼Œè¿™äº›æ–‡æ¡£å°†ä½ çš„ä»£ç å’Œæ–‡æœ¬èåˆåœ¨ä¸€èµ·ã€‚ä½ 
å­¦ä¹ äº†å¦‚ä½•åœ¨RStudioä¸­ä½¿ç”¨å¯è§†åŒ–ç¼–è¾‘å™¨æˆ–æºä»£ç ç¼–è¾‘å™¨ç¼–å†™Quartoæ–‡æ¡£ï¼Œäº†è§£äº†ä»£ç å—çš„å·¥ä½œåŸç†ä»¥åŠå¦‚ä½•ä¸ºå®ƒä»¬å®šåˆ¶é€‰é¡¹ï¼Œå¦‚ä½•åœ¨Quartoæ–‡æ¡£ä¸­åŒ…å«å›¾å½¢å’Œè¡¨æ ¼ï¼Œä»¥åŠè®¡ç®—çš„ç¼“å­˜é€‰é¡¹ã€‚æ­¤
å¤–ï¼Œä½ è¿˜å­¦ä¹ äº†å¦‚ä½•è°ƒæ•´YAMLå¤´éƒ¨é€‰é¡¹ä»¥åˆ›å»ºè‡ªåŒ…å«æˆ–å‚æ•°åŒ–æ–‡æ¡£ï¼Œä»¥åŠå¦‚ä½•åŒ…å«å¼•æ–‡å’Œå‚è€ƒä¹¦ç›®ã€‚æˆ‘
ä»¬è¿˜ä¸ºæ‚¨æä¾›äº†ä¸€äº›æ•…éšœæ’é™¤å’Œå·¥ä½œæµç¨‹æç¤ºã€‚

è™½ç„¶è¿™ä¸ªä»‹ç»åº”è¯¥è¶³ä»¥è®©æ‚¨å¼€å§‹ä½¿ç”¨Quartoï¼Œä½†è¿˜æœ‰å¾ˆå¤šéœ€è¦å­¦ä¹ çš„å†…å®¹ã€‚Q
uartoä»ç„¶ç›¸å¯¹å¹´è½»ï¼Œå¹¶ä¸”ä»åœ¨å¿«é€Ÿå‘å±•ã€‚è¦
äº†è§£æœ€æ–°çš„åˆ›æ–°åŠ¨æ€ï¼Œæœ€å¥½çš„åœ°æ–¹æ˜¯Quartoçš„å®˜æ–¹ç½‘ç«™\href{https://quarto.org/}{https://quarto.org}
ã€‚

è¿™é‡Œæœ‰ä¸¤ä¸ªæˆ‘ä»¬æœªæ¶µç›–çš„é‡è¦ä¸»é¢˜ï¼šåä½œä»¥åŠå¦‚ä½•å‡†ç¡®åœ°å‘å…¶ä»–äººäº¤æµä½ çš„æƒ³æ³•ã€‚å
ä½œæ˜¯ç°ä»£æ•°æ®ç§‘å­¦ä¸­è‡³å…³é‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œé€šè¿‡ä½¿ç”¨åƒGitå’ŒGitHubè¿™æ ·çš„ç‰ˆæœ¬æ§åˆ¶å·¥å…·ï¼Œæ‚¨å¯ä»¥ä½¿è‡ªå·±çš„ç”Ÿæ´»æ›´åŠ è½»æ¾ã€‚æˆ‘
ä»¬æ¨èã€ŠHappy Git with Rã€‹ï¼Œè¿™æ˜¯ä¸€æœ¬ç”±Rç”¨æˆ·Jenny
Bryanç¼–å†™çš„å…³äºGitå’ŒGitHubçš„å‹å¥½å…¥é—¨æŒ‡å—ã€‚è¿™
æœ¬ä¹¦åœ¨çº¿å…è´¹æä¾›ï¼š\url{https://happygitwithr.com} ã€‚

æˆ‘ä»¬ä¹Ÿæ²¡æœ‰æåŠä¸ºäº†æ¸…æ™°äº¤æµä½ çš„åˆ†æç»“æœï¼Œä½ åº”è¯¥å®é™…å†™äº›ä»€ä¹ˆã€‚ä¸º
äº†æ”¹è¿›ä½ çš„å†™ä½œï¼Œæˆ‘ä»¬å¼ºçƒˆæ¨èæ‚¨é˜…è¯»Joseph M. Williams \& Joseph
Bizupçš„ã€Š\href{https://www.amazon.com/Style-Lessons-Clarity-Grace-12th/dp/0134080416}{\emph{Style:
Lessons in Clarity and Grace}}ã€‹æˆ–George
Gopençš„ã€Š\href{https://www.amazon.com/Sense-Structure-Writing-Readers-Perspective/dp/0205296327}{\emph{The
Sense of Structure: Writing from the Reader's Perspective}}ã€‹ã€‚è¿™
ä¸¤æœ¬ä¹¦éƒ½å°†å¸®åŠ©ä½ ç†è§£å¥å­å’Œæ®µè½çš„ç»“æ„ï¼Œå¹¶ä¸ºä½ æä¾›ä½¿ä½ çš„å†™ä½œæ›´åŠ æ¸…æ™°çš„å·¥å…·ã€‚ï¼ˆ
å¦‚æœè´­ä¹°æ–°ä¹¦ï¼Œè¿™äº›ä¹¦ç›¸å½“æ˜‚è´µï¼Œä½†å®ƒä»¬è¢«è®¸å¤šè‹±è¯­è¯¾ç¨‹ä½¿ç”¨ï¼Œæ‰€ä»¥æœ‰å¾ˆå¤šä¾¿å®œçš„äºŒæ‰‹ä¹¦å¯ä¾›é€‰æ‹©ã€‚ï¼‰George
Gopenè¿˜åœ¨ä»–çš„ç½‘ç«™\url{https://www.georgegopen.com/litigation-articles.html}ä¸Šå‘è¡¨äº†ä¸€ç³»åˆ—å…³äºå†™ä½œçš„çŸ­æ–‡ã€‚è¿™
äº›æ–‡ç« è™½ç„¶é¢å‘å¾‹å¸ˆï¼Œä½†å‡ ä¹æ‰€æœ‰å†…å®¹ä¹Ÿé€‚ç”¨äºæ•°æ®ç§‘å­¦å®¶ã€‚

\chapter{Quarto æ ¼å¼}\label{sec-quarto-formats}

\section{å¼•è¨€}\label{ux5f15ux8a00-24}

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å·²ç»çœ‹åˆ°Quartoç”¨äºç”ŸæˆHTMLæ–‡æ¡£ã€‚æœ¬
ç« ç®€è¦æ¦‚è¿°äº†ä½ å¯ä»¥ä½¿ç”¨Quartoç”Ÿæˆå…¶ä»–å¤šç§ç±»å‹çš„è¾“å‡ºã€‚

è®¾ç½®æ–‡æ¡£çš„è¾“å‡ºæœ‰ä¸¤ç§æ–¹å¼ï¼š

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  æ°¸ä¹…åœ°ï¼Œä¿®æ”¹YAMLå¤´éƒ¨ä¿¡æ¯:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{title}\KeywordTok{:}\AttributeTok{ }\StringTok{"Diamond sizes"}
\FunctionTok{format}\KeywordTok{:}\AttributeTok{ html}
\end{Highlighting}
\end{Shaded}
\item
  æš‚æ—¶åœ°ï¼Œæ‰‹åŠ¨è°ƒç”¨ \texttt{quarto::quarto\_render()}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{quarto}\SpecialCharTok{::}\FunctionTok{quarto\_render}\NormalTok{(}\StringTok{"diamond{-}sizes.qmd"}\NormalTok{, }\AttributeTok{output\_format =} \StringTok{"docx"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  å¦‚æœä½ å¸Œæœ›ä»¥ç¼–ç¨‹æ–¹å¼ç”Ÿæˆå¤šç§ç±»å‹çš„è¾“å‡ºï¼Œè¿™æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œå› ä¸º\texttt{output\_format}å‚æ•°ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå€¼çš„åˆ—è¡¨ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{quarto}\SpecialCharTok{::}\FunctionTok{quarto\_render}\NormalTok{(}\StringTok{"diamond{-}sizes.qmd"}\NormalTok{, }\AttributeTok{output\_format =} \FunctionTok{c}\NormalTok{(}\StringTok{"docx"}\NormalTok{, }\StringTok{"pdf"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}
\end{enumerate}

\section{è¾“å‡ºé€‰é¡¹}\label{ux8f93ux51faux9009ux9879}

Quarto æä¾›äº†å¹¿æ³›çš„è¾“å‡ºæ ¼å¼é€‰æ‹©ã€‚æ‚¨
å¯ä»¥åœ¨\url{https://quarto.org/docs/output-formats/all-formats.html}æ‰¾åˆ°å®Œæ•´çš„åˆ—è¡¨ã€‚è®¸
å¤šæ ¼å¼å…±äº«ä¸€äº›è¾“å‡ºé€‰é¡¹ï¼ˆä¾‹å¦‚\texttt{toc:\ true}
ç”¨äºåŒ…å«ç›®å½•ï¼‰ï¼Œä½†å…¶ä»–é€‰é¡¹æ˜¯ç‰¹å®šäºæŸç§æ ¼å¼çš„ï¼ˆä¾‹å¦‚ï¼Œ\texttt{code-fold:\ true}
å°†ä»£ç å—æŠ˜å æˆä¸€ä¸ª\texttt{\textless{}details\textgreater{}}æ ‡ç­¾ç”¨äº HTML
è¾“å‡ºï¼Œä»¥ä¾¿ç”¨æˆ·æŒ‰éœ€æ˜¾ç¤ºï¼Œè¿™åœ¨ PDF æˆ– Word æ–‡æ¡£ä¸­ä¸é€‚ç”¨ï¼‰ã€‚

è¦è¦†ç›–é»˜è®¤é€‰é¡¹ï¼Œä½ éœ€è¦ä½¿ç”¨æ‰©å±•çš„\texttt{format}å­—æ®µã€‚ä¾‹
å¦‚ï¼Œå¦‚æœä½ æƒ³å‘ˆç°ä¸€ä¸ªå¸¦æœ‰æµ®åŠ¨ç›®å½•çš„ \texttt{html}ï¼Œä½ åº”è¯¥ä½¿ç”¨ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{format}\KeywordTok{:}
\AttributeTok{  }\FunctionTok{html}\KeywordTok{:}
\AttributeTok{    }\FunctionTok{toc}\KeywordTok{:}\AttributeTok{ }\CharTok{true}
\AttributeTok{    }\FunctionTok{toc\_float}\KeywordTok{:}\AttributeTok{ }\CharTok{true}
\end{Highlighting}
\end{Shaded}

ä½ ç”šè‡³å¯ä»¥é€šè¿‡æä¾›ä¸€ä¸ªæ ¼å¼åˆ—è¡¨æ¥å‘ˆç°å¤šä¸ªè¾“å‡º:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{format}\KeywordTok{:}
\AttributeTok{  }\FunctionTok{html}\KeywordTok{:}
\AttributeTok{    }\FunctionTok{toc}\KeywordTok{:}\AttributeTok{ }\CharTok{true}
\AttributeTok{    }\FunctionTok{toc\_float}\KeywordTok{:}\AttributeTok{ }\CharTok{true}
\AttributeTok{  }\FunctionTok{pdf}\KeywordTok{:}\AttributeTok{ default}
\AttributeTok{  }\FunctionTok{docx}\KeywordTok{:}\AttributeTok{ default}
\end{Highlighting}
\end{Shaded}

å¦‚æœä¸æƒ³è¦†ç›–ä»»ä½•é»˜è®¤é€‰é¡¹ï¼Œè¯·æ³¨æ„ç‰¹æ®Šçš„è¯­æ³•ï¼ˆ\texttt{pdf:\ default}ï¼‰

è¦åœ¨ä¸€ä¸ªæ–‡æ¡£çš„ YAML
ä¸­æŒ‡å®šçš„æ‰€æœ‰æ ¼å¼ä¸Šè¿›è¡Œæ¸²æŸ“ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨\texttt{output\_format\ =\ "all"}ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{quarto}\SpecialCharTok{::}\FunctionTok{quarto\_render}\NormalTok{(}\StringTok{"diamond{-}sizes.qmd"}\NormalTok{, }\AttributeTok{output\_format =} \StringTok{"all"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{æ–‡æ¡£}\label{ux6587ux6863}

å‰ä¸€ç« ä¸»è¦ä»‹ç»äº†é»˜è®¤çš„ \texttt{html} è¾“å‡ºã€‚åŸº
äºè¿™ä¸€ä¸»é¢˜ï¼Œæœ‰å‡ ç§åŸºæœ¬çš„å˜ä½“å¯ä»¥ç”Ÿæˆä¸åŒç±»å‹çš„æ–‡æ¡£ã€‚ä¾‹ å¦‚ï¼š

The previous chapter focused on the default \texttt{html} output. There
are several basic variations on that theme, generating different types
of documents. For example:

\begin{itemize}
\tightlist
\item
  \texttt{pdf} ä½¿ç”¨ LaTeXï¼ˆä¸€ä¸ªå¼€æºçš„æ–‡æ¡£æ’ç‰ˆç³»ç»Ÿï¼‰ç”Ÿæˆ PDF
  æ–‡æ¡£ï¼Œä½ éœ€è¦å…ˆå®‰è£…å®ƒã€‚å¦‚æœæ‚¨å°šæœªå®‰è£…ï¼ŒRStudio ä¼šæç¤ºä½ ã€‚
\item
  \texttt{docx} ç”¨äºç”Ÿæˆ Microsoft Word (\texttt{.docx}) æ–‡æ¡£ã€‚
\item
  \texttt{odt} ç”¨äºç”Ÿæˆ OpenDocument Text (\texttt{.odt}) æ–‡æ¡£ã€‚
\item
  \texttt{rtf} ç”¨äºç”Ÿæˆ Rich Text Format (\texttt{.rtf}) æ–‡æ¡£ã€‚
\item
  \texttt{gfm} ç”¨äºç”Ÿæˆ GitHub Flavored Markdown (\texttt{.md}) æ–‡æ¡£ã€‚
\item
  \texttt{ipynb} ç”¨äºç”Ÿæˆ Jupyter Notebooks (\texttt{.ipynb})ã€‚
\end{itemize}

è¯·è®°ä½ï¼Œå½“ä½ ç”Ÿæˆæ–‡æ¡£ä»¥ä¸å†³ç­–è€…å…±äº«æ—¶ï¼Œæ‚¨å¯ä»¥é€šè¿‡åœ¨æ–‡æ¡£çš„ YAML
ä¸­è®¾ç½®å…¨å±€é€‰é¡¹æ¥å…³é—­ä»£ç çš„é»˜è®¤æ˜¾ç¤ºï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{execute}\KeywordTok{:}
\AttributeTok{  }\FunctionTok{echo}\KeywordTok{:}\AttributeTok{ }\CharTok{false}
\end{Highlighting}
\end{Shaded}

å¯¹äº
\texttt{html}æ–‡æ¡£ï¼Œå¦ä¸€ä¸ªé€‰é¡¹æ˜¯é»˜è®¤éšè—ä»£ç å—ï¼Œä½†å¯ä»¥é€šè¿‡ç‚¹å‡»æ¥æ˜¾ç¤ºå®ƒä»¬ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{format}\KeywordTok{:}
\AttributeTok{  }\FunctionTok{html}\KeywordTok{:}
\AttributeTok{    }\FunctionTok{code}\KeywordTok{:}\AttributeTok{ }\CharTok{true}
\end{Highlighting}
\end{Shaded}

\section{æ¼”ç¤ºæ–‡ç¨¿}\label{ux6f14ux793aux6587ux7a3f}

ä½ è¿˜å¯ä»¥ä½¿ç”¨ Quarto æ¥åˆ¶ä½œæ¼”ç¤ºæ–‡ç¨¿ã€‚è™½ ç„¶ä¸ Keynote æˆ– PowerPoint
è¿™æ ·çš„å·¥å…·ç›¸æ¯”ï¼Œä½ åœ¨è§†è§‰æ§åˆ¶ä¸Šä¼šå—åˆ°ä¸€äº›é™åˆ¶ï¼Œä½†è‡ªåŠ¨å°† R
ä»£ç çš„ç»“æœæ’å…¥åˆ°æ¼”ç¤ºæ–‡ç¨¿ä¸­å¯ä»¥èŠ‚çœå¤§é‡æ—¶é—´ã€‚åˆ¶
ä½œæ¼”ç¤ºæ–‡ç¨¿çš„æ–¹æ³•æ˜¯å°†æ‚¨çš„å†…å®¹åˆ’åˆ†ä¸ºå¹»ç¯ç‰‡ï¼Œæ¯ä¸ªäºŒçº§ï¼ˆ\texttt{\#\#}ï¼‰æ ‡é¢˜éƒ½ä¼šå¼€å§‹ä¸€ä¸ªæ–°çš„å¹»ç¯ç‰‡ã€‚æ­¤
å¤–ï¼Œä¸€çº§ï¼ˆ\texttt{\#}ï¼‰æ ‡é¢˜è¡¨ç¤ºå¸¦æœ‰æ ‡é¢˜å¹»ç¯ç‰‡çš„æ–°éƒ¨åˆ†çš„å¼€å§‹ï¼Œè¯¥æ ‡é¢˜å¹»ç¯ç‰‡é»˜è®¤å±…ä¸­æ˜¾ç¤ºåœ¨å±å¹•ä¸­å¤®ã€‚

Quartoæ”¯æŒå¤šç§æ”¯æŒå¤šç§æ¼”ç¤ºæ–‡ç¨¿æ ¼å¼ï¼ŒåŒ…æ‹¬:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  \texttt{revealjs} - ä½¿ç”¨revealjsçš„HTML æ¼”ç¤ºæ–‡ç¨¿
\item
  \texttt{pptx} - PowerPointæ¼”ç¤ºæ–‡ç¨¿
\item
  \texttt{beamer} - ä½¿ç”¨ LaTeX Beamer çš„ PDF æ¼”ç¤ºæ–‡ç¨¿
\end{enumerate}

æ‚¨å¯ä»¥åœ¨\href{https://quarto.org/docs/presentations/}{https://quarto.org/docs/presentations}é˜…è¯»æœ‰å…³ä½¿ç”¨Quartoåˆ›å»ºæ¼”ç¤ºæ–‡ç¨¿çš„æ›´å¤šä¿¡æ¯ã€‚

\section{äº¤äº’æ€§}\label{ux4ea4ux4e92ux6027}

ä¸ä»»ä½• HTML æ–‡æ¡£ä¸€æ ·ï¼Œä½¿ç”¨ Quarto åˆ›å»ºçš„ HTML
æ–‡æ¡£ä¹Ÿå¯ä»¥åŒ…å«äº¤äº’å¼ç»„ä»¶ã€‚åœ¨ è¿™é‡Œï¼Œæˆ‘ä»¬ä»‹ç»ä¸¤ç§åœ¨ Quarto
æ–‡æ¡£ä¸­åŒ…å«äº¤äº’æ€§çš„é€‰é¡¹ï¼šhtmlwidgets å’Œ Shinyã€‚

\subsection{htmlwidgets}\label{htmlwidgets}

HTML æ˜¯ä¸€ç§äº¤äº’å¼æ ¼å¼ï¼Œä½ å¯ä»¥åˆ©ç”¨ htmlwidgets çš„äº¤äº’æ€§ï¼Œhtmlwidgets æ˜¯ R
å‡½æ•°ï¼Œç”¨äºç”Ÿæˆäº¤äº’å¼çš„ HTML å¯è§†åŒ–ã€‚ä¾‹ å¦‚ï¼Œè¯·çœ‹ä¸‹é¢çš„ leaflet åœ°å›¾ã€‚å¦‚
æœåœ¨ç½‘é¡µä¸ŠæŸ¥çœ‹æ­¤é¡µé¢ï¼Œä½ å¯ä»¥æ‹–åŠ¨åœ°å›¾ã€æ”¾å¤§ç¼©å°ç­‰ã€‚æ˜¾
ç„¶ï¼Œä½ æ— æ³•åœ¨ä¹¦ä¸­è¿™æ ·åšï¼Œæ‰€ä»¥ Quarto ä¼šè‡ªåŠ¨ä¸ºä½ æ’å…¥ä¸€ä¸ªé™æ€çš„å±å¹•æˆªå›¾ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(leaflet)}
\FunctionTok{leaflet}\NormalTok{() }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{setView}\NormalTok{(}\FloatTok{174.764}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{36.877}\NormalTok{, }\AttributeTok{zoom =} \DecValTok{16}\NormalTok{) }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{addTiles}\NormalTok{() }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{addMarkers}\NormalTok{(}\FloatTok{174.764}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{36.877}\NormalTok{, }\AttributeTok{popup =} \StringTok{"Maungawhau"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\includegraphics[width=18.75in,height=\textheight]{quarto-formats_files/figure-pdf/unnamed-chunk-5-1.pdf}

htmlwidgets çš„å¥½å¤„æ˜¯ï¼Œä½ ä¸éœ€è¦äº†è§£ä»»ä½•å…³äº HTML æˆ– JavaScript
çš„çŸ¥è¯†å°±å¯ä»¥ä½¿ç”¨å®ƒä»¬ã€‚æ‰€ æœ‰çš„ç»†èŠ‚éƒ½è¢«å°è£…åœ¨åŒ…å†…éƒ¨ï¼Œæ‰€ä»¥ä½ ä¸éœ€è¦æ‹…å¿ƒã€‚

æœ‰å¾ˆå¤šåŒ…éƒ½æä¾›äº†htmlwidgetsï¼ŒåŒ…æ‹¬ï¼š

\begin{itemize}
\tightlist
\item
  \href{https://rstudio.github.io/dygraphs}{dygraphs}
  ç”¨äºäº¤äº’å¼æ—¶é—´åºåˆ—å¯è§†åŒ–ã€‚
\item
  \href{https://rstudio.github.io/DT/}{DT} ç”¨äºäº¤äº’å¼è¡¨æ ¼ã€‚
\item
  \href{https://bwlewis.github.io/rthreejs}{threejs} ç”¨äºäº¤äº’å¼ 3D
  ç»˜å›¾ã€‚
\item
  \href{https://bwlewis.github.io/rthreejs}{threejs}
  ç”¨äºå›¾å½¢ï¼ˆå¦‚æµç¨‹å›¾å’Œç®€å•çš„èŠ‚ç‚¹é“¾æ¥å›¾ï¼‰ã€‚
\end{itemize}

è¦äº†è§£æ›´å¤šå…³äº htmlwidgets
çš„ä¿¡æ¯ï¼Œå¹¶æŸ¥çœ‹æä¾›å®ƒä»¬çš„åŒ…çš„å®Œæ•´åˆ—è¡¨ï¼Œè¯·è®¿é—®\href{https://www.htmlwidgets.org./}{https://www.htmlwidgets.org}
ã€‚

\subsection{Shiny}\label{shiny}

htmlwidgets æä¾›å®¢æˆ·ç«¯äº¤äº’æ€§ï¼Œæ‰€æœ‰çš„äº¤äº’éƒ½å‘ç”Ÿåœ¨æµè§ˆå™¨ä¸­ï¼Œä¸ R æ— å…³ã€‚å½“
ç„¶è¿™å¾ˆå¥½ï¼Œå› ä¸ºä½ å¯ä»¥åˆ†å‘ HTML æ–‡ä»¶è€Œæ— éœ€ä¸ R å»ºç«‹ä»»ä½•è¿æ¥ã€‚ç„¶
è€Œï¼Œè¿™ä»æ ¹æœ¬ä¸Šé™åˆ¶äº†ä½ å¯ä»¥ä½¿ç”¨ HTML å’Œ JavaScript å®ç°çš„åŠŸèƒ½ã€‚å¦
ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨ shinyï¼Œè¿™æ˜¯ä¸€ä¸ªå…è®¸ä½ ä½¿ç”¨ R ä»£ç è€Œä¸æ˜¯ JavaScript
åˆ›å»ºäº¤äº’æ€§çš„åŒ…ã€‚

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{title}\KeywordTok{:}\AttributeTok{ }\StringTok{"Shiny Web App"}
\FunctionTok{format}\KeywordTok{:}\AttributeTok{ html}
\FunctionTok{server}\KeywordTok{:}\AttributeTok{ shiny}
\end{Highlighting}
\end{Shaded}

ç„¶åä½ å¯ä»¥ä½¿ç”¨''input''å‡½æ•°å‘æ–‡æ¡£ä¸­æ·»åŠ äº¤äº’å¼ç»„ä»¶:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(shiny)}

\FunctionTok{textInput}\NormalTok{(}\StringTok{"name"}\NormalTok{, }\StringTok{"What is your name?"}\NormalTok{)}
\FunctionTok{numericInput}\NormalTok{(}\StringTok{"age"}\NormalTok{, }\StringTok{"How old are you?"}\NormalTok{, }\ConstantTok{NA}\NormalTok{, }\AttributeTok{min =} \DecValTok{0}\NormalTok{, }\AttributeTok{max =} \DecValTok{150}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics[width=2.17in,height=\textheight]{quarto/quarto-shiny.png}

æ­¤å¤–ï¼Œä½ è¿˜éœ€è¦ä¸€ä¸ªå¸¦æœ‰ chunk
é€‰é¡¹\texttt{context:\ server}çš„ä»£ç å—ï¼Œå…¶ä¸­åŒ…å«éœ€è¦åœ¨ Shiny
æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ä»£ç ã€‚

ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨\texttt{input\$name}å’Œ\texttt{input\$age}æ¥å¼•ç”¨è¿™äº›å€¼ï¼Œå¹¶ä¸”å½“è¿™äº›å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä½¿ç”¨å®ƒä»¬çš„ä»£ç å°†è‡ªåŠ¨é‡æ–°è¿è¡Œã€‚

ç”±äº Shiny äº¤äº’æ˜¯åœ¨æœåŠ¡å™¨ç«¯å‘ç”Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•åœ¨è¿™é‡Œå‘ä½ å±•ç¤ºä¸€ä¸ªå®æ—¶çš„
Shiny åº”ç”¨ã€‚è¿™ æ„å‘³ç€ä½ å¯ä»¥åœ¨ä¸äº†è§£ JavaScript
çš„æƒ…å†µä¸‹ç¼–å†™äº¤äº’å¼åº”ç”¨ï¼Œä½†æ˜¯ä½ éœ€è¦ä¸€ä¸ªæœåŠ¡å™¨æ¥è¿è¡Œå®ƒä»¬ã€‚è¿™
å¼•å…¥äº†ä¸€ä¸ªé€»è¾‘é—®é¢˜ï¼šShiny åº”ç”¨éœ€è¦ä¸€ä¸ª Shiny æœåŠ¡å™¨æ‰èƒ½åœ¨çº¿è¿è¡Œã€‚å½“
ä½ åœ¨è‡ªå·±çš„è®¡ç®—æœºä¸Šè¿è¡Œ Shiny åº”ç”¨æ—¶ï¼ŒShiny ä¼šè‡ªåŠ¨ä¸ºä½ è®¾ç½®ä¸€ä¸ª Shiny
æœåŠ¡å™¨ï¼Œä½†å¦‚æœä½ æƒ³åœ¨çº¿å‘å¸ƒè¿™ç§äº¤äº’æ€§ï¼Œåˆ™éœ€è¦ä¸€ä¸ªé¢å‘å…¬ä¼—çš„ Shiny
æœåŠ¡å™¨ã€‚è¿™ æ˜¯ Shiny çš„åŸºæœ¬æƒè¡¡ï¼šä½ å¯ä»¥åœ¨ Shiny æ–‡æ¡£ä¸­æ‰§è¡Œä»»ä½•å¯ä»¥åœ¨ R
ä¸­æ‰§è¡Œçš„æ“ä½œï¼Œä½†å®ƒéœ€è¦æœ‰äººè¿è¡Œ Rã€‚

è¦æ·±å…¥äº†è§£ Shinyï¼Œæˆ‘ä»¬å»ºè®®æ‚¨é˜…è¯» Hadley Wickham çš„ã€Šç²¾é€š
Shinyã€‹ï¼Œç½‘å€ä¸ºï¼š\href{https://mastering-shiny.org./}{https://mastering-shiny.org}ã€‚

\section{ç½‘ç«™å’Œä¹¦ç±}\label{ux7f51ux7ad9ux548cux4e66ux7c4d}

é€šè¿‡ä¸€äº›é¢å¤–çš„åŸºç¡€è®¾æ–½ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Quarto ç”Ÿæˆå®Œæ•´çš„ç½‘ç«™æˆ–ä¹¦ç±ï¼š

\begin{itemize}
\item
  å°†æ‚¨çš„\texttt{.qmd}æ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„ç›®å½•ä¸­ã€‚\texttt{i}
  \texttt{ndex.qmd}å°†æˆä¸ºä¸»é¡µã€‚
\item
  æ·»åŠ ä¸€ä¸ªåä¸º\texttt{\_quarto.yml}çš„ YAML
  æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä¸ºç½‘ç«™æä¾›å¯¼èˆªã€‚åœ¨ æ­¤æ–‡ä»¶ä¸­ï¼Œå°†é¡¹ç›®ç±»å‹è®¾ç½®ä¸º
  \texttt{book}ï¼ˆä¹¦ç±ï¼‰æˆ– \texttt{website}ï¼ˆç½‘ç«™ï¼‰ï¼Œä¾‹å¦‚ï¼š

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{project}\KeywordTok{:}
\AttributeTok{  }\FunctionTok{type}\KeywordTok{:}\AttributeTok{ book}
\end{Highlighting}
\end{Shaded}
\end{itemize}

ä¾‹å¦‚ï¼Œä»¥ä¸‹\texttt{\_quarto.yml}æ–‡ä»¶ä»ä¸‰ä¸ªæºæ–‡ä»¶åˆ›å»ºäº†ä¸€ä¸ªç½‘ç«™ï¼š\texttt{index.qmd}ï¼ˆä¸»é¡µï¼‰ã€\texttt{viridis-colors.qmd}å’Œ\texttt{terrain-colors.qmd}ã€‚

\begin{verbatim}
project:
  type: website

website:
  title: "A website on color scales"
  navbar:
    left:
      - href: index.qmd
        text: Home
      - href: viridis-colors.qmd
        text: Viridis colors
      - href: terrain-colors.qmd
        text: Terrain colors
\end{verbatim}

å¯¹äºä¹¦ç±ï¼Œæ‚¨éœ€è¦çš„\texttt{\_quarto.yml}æ–‡ä»¶çš„ç»“æ„éå¸¸ç›¸ä¼¼ã€‚ä»¥
ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªåŒ…å«å››ä¸ªç« èŠ‚çš„ä¹¦ç±ï¼Œå¹¶å°†å…¶æ¸²æŸ“ä¸ºä¸‰ç§ä¸åŒçš„è¾“å‡ºæ ¼å¼ï¼ˆ\texttt{html}ã€\texttt{pdf}
å’Œ \texttt{epub}ï¼‰ã€‚åŒ æ ·åœ°ï¼Œæºæ–‡ä»¶æ˜¯\texttt{.qmd}æ–‡ä»¶ã€‚

\begin{verbatim}
project:
  type: book

book:
  title: "A book on color scales"
  author: "Jane Coloriste"
  chapters:
    - index.qmd
    - intro.qmd
    - viridis-colors.qmd
    - terrain-colors.qmd

format:
  html:
    theme: cosmo
  pdf: default
  epub: default
\end{verbatim}

æˆ‘ä»¬å»ºè®®æ‚¨ä¸ºç½‘ç«™å’Œä¹¦ç±ä½¿ç”¨ RStudio é¡¹ç›®ã€‚åŸº
äº\texttt{\_quarto.yml}æ–‡ä»¶ï¼ŒRStudio å°†è¯†åˆ«æ‚¨æ­£åœ¨å¤„ç†çš„é¡¹ç›®ç±»å‹ï¼Œå¹¶åœ¨
IDE
ä¸­æ·»åŠ ä¸€ä¸ª``Build''é€‰é¡¹å¡ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥æ¸²æŸ“å’Œé¢„è§ˆæ‚¨çš„ç½‘ç«™å’Œä¹¦ç±ã€‚åŒ
æ—¶ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨\texttt{quarto::quarto\_render()}æ¥æ¸²æŸ“ç½‘ç«™å’Œä¹¦ç±ã€‚

æœ‰å…³ Quarto ç½‘ç«™çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—®\url{https://quarto.org/docs/websites}
ï¼›æœ‰å…³ä¹¦ç±çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—®~\href{https://quarto.org/docs/books\%E3\%80\%82}{https://quarto.org/docs/books}ã€‚

\section{å…¶ä»–æ ¼å¼}\label{ux5176ux4ed6ux683cux5f0f}

Quartoæä¾›äº†æ›´å¤šçš„è¾“å‡ºæ ¼å¼:

\begin{itemize}
\item
  ä½ å¯ä»¥ä½¿ç”¨Quarto æœŸåˆŠæ¨¡æ¿æ’°å†™æœŸåˆŠæ–‡ç« :
  \url{https://quarto.org/docs/journals/templates.html}ã€‚
\item
  ä½ å¯ä»¥å°† Quarto æ–‡æ¡£è¾“å‡ºä¸º Jupyter ç¬”è®°æœ¬ï¼Œé€‰é¡¹
  \texttt{format:\ ipynb}:
  \url{https://quarto.org/docs/reference/formats/ipynb.html}ã€‚
\end{itemize}

åœ¨ \url{https://quarto.org/docs/output-formats/all-formats.html}
ä¸Šä½ å¯ä»¥æŸ¥çœ‹æ›´å¤šè¾“å‡ºæ ¼å¼çš„åˆ—è¡¨ã€‚

\section{å°ç»“}\label{ux5c0fux7ed3-28}

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬ä¸ºä½ å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Quarto
ä»¥å„ç§å½¢å¼å±•ç¤ºä½ çš„æˆæœï¼Œä»é™æ€å’Œäº¤äº’å¼æ–‡æ¡£åˆ°æ¼”ç¤ºæ–‡ç¨¿ï¼Œå†åˆ°ç½‘ç«™å’Œä¹¦ç±ã€‚

ä¸ºäº†æ›´æ·±å…¥åœ°äº†è§£å¦‚ä½•ä»¥è¿™äº›ä¸åŒå½¢å¼æœ‰æ•ˆåœ°äº¤æµï¼Œæˆ‘ä»¬æ¨èä»¥ä¸‹èµ„æºï¼š

\begin{itemize}
\tightlist
\item
  è¦æé«˜ä½ çš„æ¼”è®²æŠ€å·§ï¼Œè¯·å°è¯•é˜…è¯»ã€Š\href{https://presentationpatterns.com/}{Presentation
  Patterns}ã€‹ä¸€ä¹¦ï¼Œä½œè€…æ˜¯ Neal Fordã€Matthew McCollough å’Œ Nathaniel
  Schuttaã€‚è¯¥ä¹¦æä¾›äº†ä¸€ç³»åˆ—æœ‰æ•ˆçš„æ¨¡å¼ï¼ˆä½æ°´å¹³å’Œé«˜æ°´å¹³ï¼‰ï¼Œä½ å¯ä»¥åº”ç”¨è¿™äº›æ¨¡å¼æ¥æ”¹è¿›ä½ çš„æ¼”è®²ã€‚
\item
  å¦‚æœæ‚¨è¿›è¡Œå­¦æœ¯æ¼”è®²ï¼Œæ‚¨å¯èƒ½ä¼šå–œæ¬¢
  \href{https://github.com/jtleek/talkguide}{Leek group guide to giving
  talks}ã€‚
\item
  æˆ‘ä»¬è¿˜æ²¡æœ‰äº²è‡ªå­¦ä¹ è¿‡ï¼Œä½†æˆ‘ä»¬å¬è¯´è¿‡ Matt McGarrity
  çš„å…¬å…±æ¼”è®²åœ¨çº¿è¯¾ç¨‹è¯„ä»·å¾ˆå¥½ï¼š\href{https://www.coursera.org/learn/public-speaking\%E3\%80\%82}{https://www.coursera.org/learn/public-speaking}ã€‚
\item
  å¦‚æœä½ æ­£åœ¨åˆ›å»ºè®¸å¤šä»ªè¡¨æ¿ï¼Œè¯·åŠ¡å¿…é˜…è¯» Stephen Few
  çš„ã€Š\href{https://www.amazon.com/Information-Dashboard-Design-Effective-Communication/dp/0596100167}{Information
  Dashboard Design: The Effective Visual Communication of
  Data}ã€‹ä¸€ä¹¦ã€‚å®ƒå°†å¸®åŠ©ä½ åˆ›å»ºçœŸæ­£æœ‰ç”¨çš„ä»ªè¡¨æ¿ï¼Œè€Œä¸ä»…ä»…æ˜¯çœ‹èµ·æ¥æ¼‚äº®ã€‚
\item
  æœ‰æ•ˆåœ°äº¤æµä½ çš„æƒ³æ³•é€šå¸¸å—ç›Šäºä¸€äº›å›¾å½¢è®¾è®¡çŸ¥è¯†ã€‚Robin Williams
  çš„ã€Š\href{https://www.amazon.com/Non-Designers-Design-Book-4th/dp/0133966151}{The
  Non-Designer's Design Book}ã€‹æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚
\end{itemize}


\backmatter

\end{document}
